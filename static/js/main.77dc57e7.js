/*! For license information please see main.77dc57e7.js.LICENSE.txt */
(()=>{var e={155:e=>{"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},166:(e,t,n)=>{"use strict";var r,i,o=n(4823),s=n(498),a=o.process,l=o.Deno,c=a&&a.versions||l&&l.version,u=c&&c.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},191:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler");Symbol.for("react.provider");var a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.view_transition"),f=Symbol.for("react.client.reference");function m(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case s:case o:case u:case d:case g:return e;default:switch(e=e&&e.$$typeof){case l:case c:case p:case h:case a:return e;default:return t}}case r:return t}}}t.Hy=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===s||e===o||e===u||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===p||e.$$typeof===h||e.$$typeof===l||e.$$typeof===a||e.$$typeof===c||e.$$typeof===f||void 0!==e.getModuleId)}},219:(e,t,n)=>{"use strict";var r=n(3763),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return r.isMemo(e)?s:a[e.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,g=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(g){var i=p(n);i&&i!==g&&e(t,i,r)}var s=u(n);d&&(s=s.concat(d(n)));for(var a=l(t),f=l(n),m=0;m<s.length;++m){var v=s[m];if(!o[v]&&(!r||!r[v])&&(!f||!f[v])&&(!a||!a[v])){var w=h(n,v);try{c(t,v,w)}catch(b){}}}}return t}},253:(e,t,n)=>{"use strict";var r=n(9519),i=n(8084);e.exports=r&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},327:(e,t,n)=>{"use strict";var r=n(3192),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},466:(e,t,n)=>{"use strict";var r=n(9344);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},498:(e,t,n)=>{"use strict";var r=n(4823).navigator,i=r&&r.userAgent;e.exports=i?String(i):""},579:(e,t,n)=>{"use strict";e.exports=n(2799)},816:(e,t,n)=>{"use strict";var r=n(5704);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},904:(e,t,n)=>{"use strict";var r=n(3542);e.exports=r("document","documentElement")},972:(e,t,n)=>{"use strict";var r=n(6774),i=n(2201),o=n(1591),s=function(e){return function(t,n,s){var a=r(t),l=o(a);if(0===l)return!e&&-1;var c,u=i(s,l);if(e&&n!==n){for(;l>u;)if((c=a[u++])!==c)return!0}else for(;l>u;u++)if((e||u in a)&&a[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},1178:(e,t,n)=>{"use strict";var r=n(7707),i=n(8084),o=n(5687),s=Object,a=r("".split);e.exports=i(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?a(e,""):s(e)}:s},1239:(e,t,n)=>{"use strict";var r=n(4706),i=n(5464),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not a function")}},1497:(e,t,n)=>{"use strict";var r=n(3218);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},1591:(e,t,n)=>{"use strict";var r=n(8249);e.exports=function(e){return r(e.length)}},1608:(e,t,n)=>{"use strict";var r=n(6821),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not an object")}},1659:(e,t,n)=>{"use strict";var r=n(7707);e.exports=r([].slice)},1709:(e,t,n)=>{"use strict";var r=n(4823),i=n(6464),o=n(4706),s=n(7192),a=n(498),l=n(1659),c=n(155),u=r.Function,d=/MSIE .\./.test(a)||"BUN"===s&&function(){var e=r.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return d?function(r,s){var a=c(arguments.length,1)>n,d=o(r)?r:u(r),h=a?l(arguments,n):[],p=a?function(){i(d,this,h)}:d;return t?e(p,s):e(p)}:e}},2201:(e,t,n)=>{"use strict";var r=n(466),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},2330:(e,t,n)=>{"use strict";var r=n(5043);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},o=r.useState,s=r.useEffect,a=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(r){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,u=r[1];return a(function(){i.value=n,i.getSnapshot=t,c(i)&&u({inst:i})},[e,n,t]),s(function(){return c(i)&&u({inst:i}),e(function(){c(i)&&u({inst:i})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},2345:(e,t,n)=>{"use strict";var r=n(9519),i=n(6164),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),l=a&&"something"===function(){}.name,c=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},2428:(e,t,n)=>{"use strict";var r,i,o,s=n(9279),a=n(4823),l=n(6821),c=n(9266),u=n(6164),d=n(5704),h=n(4658),p=n(3114),g="Object already initialized",f=a.TypeError,m=a.WeakMap;if(s||d.state){var v=d.state||(d.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,r=function(e,t){if(v.has(e))throw new f(g);return t.facade=e,v.set(e,t),t},i=function(e){return v.get(e)||{}},o=function(e){return v.has(e)}}else{var w=h("state");p[w]=!0,r=function(e,t){if(u(e,w))throw new f(g);return t.facade=e,c(e,w,t),t},i=function(e){return u(e,w)?e[w]:{}},o=function(e){return u(e,w)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw new f("Incompatible receiver, "+e+" required");return n}}}},2509:(e,t,n)=>{"use strict";var r=n(4850),i=n(4706),o=n(6821),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!o(a=r(n,e)))return a;if(i(n=e.valueOf)&&!o(a=r(n,e)))return a;if("string"!==t&&i(n=e.toString)&&!o(a=r(n,e)))return a;throw new s("Can't convert object to primitive value")}},2522:(e,t,n)=>{"use strict";var r=n(327),i=Object;e.exports=function(e){return i(r(e))}},2682:(e,t,n)=>{"use strict";var r=n(3542),i=n(7707),o=n(7251),s=n(6842),a=n(1608),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?l(t,n(e)):t}},2760:(e,t,n)=>{"use strict";var r=n(4823),i=n(6821),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},2799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},3036:(e,t,n)=>{"use strict";var r=n(4823),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},3114:e=>{"use strict";e.exports={}},3192:e=>{"use strict";e.exports=function(e){return null===e||void 0===e}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3326:(e,t,n)=>{"use strict";var r=n(9140),i=n(7970);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},3542:(e,t,n)=>{"use strict";var r=n(4823),i=n(4706);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},3572:(e,t,n)=>{"use strict";var r=n(9519),i=n(9704),o=n(253),s=n(1608),a=n(3326),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,d="enumerable",h="configurable",p="writable";t.f=r?o?function(e,t,n){if(s(e),t=a(t),s(n),"function"===typeof e&&"prototype"===t&&"value"in n&&p in n&&!n[p]){var r=u(e,t);r&&r[p]&&(e[t]=n.value,n={configurable:h in n?n[h]:r[h],enumerable:d in n?n[d]:r[d],writable:!1})}return c(e,t,n)}:c:function(e,t,n){if(s(e),t=a(t),s(n),i)try{return c(e,t,n)}catch(r){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},3763:(e,t,n)=>{"use strict";e.exports=n(4983)},4022:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},4030:(e,t,n)=>{"use strict";var r=n(166),i=n(8084),o=n(4823).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},4061:(e,t,n)=>{"use strict";var r=n(7707),i=n(6164),o=n(6774),s=n(972).indexOf,a=n(3114),l=r([].push);e.exports=function(e,t){var n,r=o(e),c=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&l(u,n);for(;t.length>c;)i(r,n=t[c++])&&(~s(u,n)||l(u,n));return u}},4111:(e,t,n)=>{"use strict";var r=n(4030);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},4234:(e,t,n)=>{"use strict";var r=n(7192);e.exports="NODE"===r},4288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function w(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},w.prototype=v.prototype;var C=b.prototype=new w;C.constructor=b,f(C,v.prototype),C.isPureReactComponent=!0;var y=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},x=Object.prototype.hasOwnProperty;function R(e,t,r,i,o,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(){}function P(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return P((u=e._init)(e._payload),t,i,o,s)}}if(u)return s=s(e),u=""===o?"."+k(e,0):o,y(s)?(i="",null!=u&&(i=u.replace(T,"$&/")+"/"),P(s,t,i,"",function(e){return e})):null!=s&&(E(s)&&(l=s,c=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+u,s=R(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var d,g=""===o?".":o+":";if(y(e))for(var f=0;f<e.length;f++)u+=P(o=e[f],t,i,a=g+k(o,f),s);else if("function"===typeof(f=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=p&&d[p]||d["@@iterator"])?d:null))for(e=f.call(e),f=0;!(o=e.next()).done;)u+=P(o=o.value,t,i,a=g+k(o,f++),s);else if("object"===a){if("function"===typeof e.then)return P(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(M,M):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var r=[],i=0;return P(e,r,"","",function(e){return t.call(n,e,i++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function F(){}t.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=f({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!x.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return R(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)x.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return R(e,o,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),i=S.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(F,D)}catch(o){D(o)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.0"},4291:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},4352:(e,t,n)=>{"use strict";var r=n(4823),i=n(816),o=n(6164),s=n(7899),a=n(4030),l=n(4111),c=r.Symbol,u=i("wks"),d=l?c.for||c:c&&c.withoutSetter||s;e.exports=function(e){return o(u,e)||(u[e]=a&&o(c,e)?c[e]:d("Symbol."+e)),u[e]}},4391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(7004)},4416:(e,t,n)=>{"use strict";var r=n(7707),i=n(8084),o=n(4706),s=n(6164),a=n(9519),l=n(2345).CONFIGURABLE,c=n(5167),u=n(2428),d=u.enforce,h=u.get,p=String,g=Object.defineProperty,f=r("".slice),m=r("".replace),v=r([].join),w=a&&!i(function(){return 8!==g(function(){},"length",{value:8}).length}),b=String(String).split("String"),C=e.exports=function(e,t,n){"Symbol("===f(p(t),0,7)&&(t="["+m(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||l&&e.name!==t)&&(a?g(e,"name",{value:t,configurable:!0}):e.name=t),w&&n&&s(n,"arity")&&e.length!==n.arity&&g(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&g(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var r=d(e);return s(r,"source")||(r.source=v(b,"string"==typeof t?t:"")),e};Function.prototype.toString=C(function(){return o(this)&&h(this).source||c(this)},"toString")},4647:(e,t,n)=>{"use strict";n(6023),n(9286)},4658:(e,t,n)=>{"use strict";var r=n(816),i=n(7899),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},4706:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports="undefined"==typeof t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},4823:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4850:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},4983:(e,t)=>{"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.suspense_list"):60120,f=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,w=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,C=n?Symbol.for("react.scope"):60119;function y(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case d:case o:case a:case s:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case m:case f:case l:return e;default:return t}}case i:return t}}}function S(e){return y(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=r,t.ForwardRef=h,t.Fragment=o,t.Lazy=m,t.Memo=f,t.Portal=i,t.Profiler=a,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||y(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return y(e)===c},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return y(e)===h},t.isFragment=function(e){return y(e)===o},t.isLazy=function(e){return y(e)===m},t.isMemo=function(e){return y(e)===f},t.isPortal=function(e){return y(e)===i},t.isProfiler=function(e){return y(e)===a},t.isStrictMode=function(e){return y(e)===s},t.isSuspense=function(e){return y(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===o||e===d||e===a||e===s||e===p||e===g||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===w||e.$$typeof===b||e.$$typeof===C||e.$$typeof===v)},t.typeOf=y},5043:(e,t,n)=>{"use strict";e.exports=n(4288)},5167:(e,t,n)=>{"use strict";var r=n(7707),i=n(4706),o=n(5704),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},5173:(e,t,n)=>{e.exports=n(1497)()},5214:(e,t,n)=>{"use strict";var r=n(9519),i=n(4850),o=n(4022),s=n(6369),a=n(6774),l=n(3326),c=n(6164),u=n(9704),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=l(t),u)try{return d(e,t)}catch(n){}if(c(e,t))return s(!i(o.f,e,t),e[t])}},5464:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},5551:(e,t,n)=>{"use strict";var r=n(4706),i=n(3572),o=n(4416),s=n(3036);e.exports=function(e,t,n,a){a||(a={});var l=a.enumerable,c=void 0!==a.name?a.name:t;if(r(n)&&o(n,c,a),a.global)l?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(l=!0):delete e[t]}catch(u){}l?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},5555:(e,t,n)=>{"use strict";var r=n(6164),i=n(2682),o=n(5214),s=n(3572);e.exports=function(e,t,n){for(var a=i(t),l=s.f,c=o.f,u=0;u<a.length;u++){var d=a[u];r(e,d)||n&&r(n,d)||l(e,d,c(t,d))}}},5687:(e,t,n)=>{"use strict";var r=n(7707),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},5704:(e,t,n)=>{"use strict";var r=n(7592),i=n(4823),o=n(3036),s="__core-js_shared__",a=e.exports=i[s]||o(s,{});(a.versions||(a.versions=[])).push({version:"3.44.0",mode:r?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"})},5896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,g=!1,f=!1,m=!1,v=!1,w="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,C="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(m=!1,y(e),!f)if(null!==r(c))f=!0,R||(R=!0,x());else{var t=r(u);null!==t&&D(S,t.startTime-e)}}var x,R=!1,E=-1,T=5,k=-1;function M(){return!!v||!(t.unstable_now()-k<T)}function P(){if(v=!1,R){var e=t.unstable_now();k=e;var n=!0;try{e:{f=!1,m&&(m=!1,b(E),E=-1),g=!0;var o=p;try{t:{for(y(e),h=r(c);null!==h&&!(h.expirationTime>e&&M());){var s=h.callback;if("function"===typeof s){h.callback=null,p=h.priorityLevel;var a=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){h.callback=a,y(e),n=!0;break t}h===r(c)&&i(c),y(e)}else i(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&D(S,l.startTime-e),n=!1}}break e}finally{h=null,p=o,g=!1}n=void 0}}finally{n?x():R=!1}}}if("function"===typeof C)x=function(){C(P)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,A=I.port2;I.port1.onmessage=P,x=function(){A.postMessage(null)}}else x=function(){w(P,0)};function D(e,n){E=w(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(m?(b(E),E=-1):m=!0,D(S,o-s))):(e.sortIndex=a,n(c,e),f||g||(f=!0,R||(R=!0,x()))),e},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},5897:(e,t,n)=>{"use strict";var r=n(8084);e.exports=!r(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},6023:(e,t,n)=>{"use strict";var r=n(6715),i=n(4823),o=n(9464).clear;r({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==o},{clearImmediate:o})},6079:(e,t,n)=>{"use strict";var r=n(8084),i=n(4706),o=/#|\.prototype\./,s=function(e,t){var n=l[a(e)];return n===u||n!==c&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=s.data={},c=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},6164:(e,t,n)=>{"use strict";var r=n(7707),i=n(2522),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},6178:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(a(e,t))return!1;return!0}function c(e){return void 0===e}function u(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function d(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function h(e,t){var n,r=[],i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function p(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t,n,r){return Yn(e,t,n,r,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=f()),e._pf}function v(e){var t=null,r=!1,i=e._d&&!isNaN(e._d.getTime());return i&&(t=m(e),r=n.call(t.parsedDateParts,function(e){return null!=e}),i=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)),null!=Object.isFrozen&&Object.isFrozen(e)?i:(e._isValid=i,e._isValid)}function w(e){var t=g(NaN);return null!=e?p(m(t),e):m(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var b=r.momentProperties=[],C=!1;function y(e,t){var n,r,i,o=b.length;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=m(t)),c(t._locale)||(e._locale=t._locale),o>0)for(n=0;n<o;n++)c(i=t[r=b[n]])||(e[r]=i);return e}function S(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===C&&(C=!0,r.updateOffset(this),C=!1)}function x(e){return e instanceof S||null!=e&&null!=e._isAMomentObject}function R(e){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function E(e,t){var n=!0;return p(function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){var i,o,s,l=[],c=arguments.length;for(o=0;o<c;o++){if(i="","object"===typeof arguments[o]){for(s in i+="\n["+o+"] ",arguments[0])a(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];l.push(i)}R(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)},t)}var T,k={};function M(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),k[e]||(R(t),k[e]=!0)}function P(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function I(e){var t,n;for(n in e)a(e,n)&&(P(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function A(e,t){var n,r=p({},e);for(n in t)a(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},p(r[n],e[n]),p(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)a(e,n)&&!a(t,n)&&s(e[n])&&(r[n]=p({},r[n]));return r}function D(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,T=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)a(e,t)&&n.push(t);return n};var F={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function O(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return P(r)?r.call(t,n):r}function N(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var L=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,_=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},V={};function B(e,t,n,r){var i=r;"string"===typeof r&&(i=function(){return this[r]()}),e&&(V[e]=i),t&&(V[t[0]]=function(){return N(i.apply(this,arguments),t[1],t[2])}),n&&(V[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function W(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function z(e){var t,n,r=e.match(L);for(t=0,n=r.length;t<n;t++)V[r[t]]?r[t]=V[r[t]]:r[t]=W(r[t]);return function(t){var i,o="";for(i=0;i<n;i++)o+=P(r[i])?r[i].call(t,e):r[i];return o}}function j(e,t){return e.isValid()?(t=G(t,e.localeData()),H[t]=H[t]||z(t),H[t](e)):e.localeData().invalidDate()}function G(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(_.lastIndex=0;n>=0&&_.test(e);)e=e.replace(_,r),_.lastIndex=0,n-=1;return e}var $={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function U(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(L).map(function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e}).join(""),this._longDateFormat[e])}var K="Invalid date";function Y(){return this._invalidDate}var q="%d",X=/\d{1,2}/;function Q(e){return this._ordinal.replace("%d",e)}var J={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Z(e,t,n,r){var i=this._relativeTime[n];return P(i)?i(e,t,n,r):i.replace(/%d/i,e)}function ee(e,t){var n=this._relativeTime[e>0?"future":"past"];return P(n)?n(t):n.replace(/%s/i,t)}var te={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ne(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function re(e){var t,n,r={};for(n in e)a(e,n)&&(t=ne(n))&&(r[t]=e[n]);return r}var ie={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function oe(e){var t,n=[];for(t in e)a(e,t)&&n.push({unit:t,priority:ie[t]});return n.sort(function(e,t){return e.priority-t.priority}),n}var se,ae=/\d/,le=/\d\d/,ce=/\d{3}/,ue=/\d{4}/,de=/[+-]?\d{6}/,he=/\d\d?/,pe=/\d\d\d\d?/,ge=/\d\d\d\d\d\d?/,fe=/\d{1,3}/,me=/\d{1,4}/,ve=/[+-]?\d{1,6}/,we=/\d+/,be=/[+-]?\d+/,Ce=/Z|[+-]\d\d:?\d\d/gi,ye=/Z|[+-]\d\d(?::?\d\d)?/gi,Se=/[+-]?\d+(\.\d{1,3})?/,xe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Re=/^[1-9]\d?/,Ee=/^([1-9]\d|\d)/;function Te(e,t,n){se[e]=P(t)?t:function(e,r){return e&&n?n:t}}function ke(e,t){return a(se,e)?se[e](t._strict,t._locale):new RegExp(Me(e))}function Me(e){return Pe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i}))}function Pe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ie(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Ae(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=Ie(t)),n}se={};var De={};function Fe(e,t){var n,r,i=t;for("string"===typeof e&&(e=[e]),u(t)&&(i=function(e,n){n[t]=Ae(e)}),r=e.length,n=0;n<r;n++)De[e[n]]=i}function Oe(e,t){Fe(e,function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)})}function Ne(e,t,n){null!=t&&a(De,e)&&De[e](t,n._a,n,e)}function Le(e){return e%4===0&&e%100!==0||e%400===0}var _e=0,He=1,Ve=2,Be=3,We=4,ze=5,je=6,Ge=7,$e=8;function Ue(e){return Le(e)?366:365}B("Y",0,0,function(){var e=this.year();return e<=9999?N(e,4):"+"+e}),B(0,["YY",2],0,function(){return this.year()%100}),B(0,["YYYY",4],0,"year"),B(0,["YYYYY",5],0,"year"),B(0,["YYYYYY",6,!0],0,"year"),Te("Y",be),Te("YY",he,le),Te("YYYY",me,ue),Te("YYYYY",ve,de),Te("YYYYYY",ve,de),Fe(["YYYYY","YYYYYY"],_e),Fe("YYYY",function(e,t){t[_e]=2===e.length?r.parseTwoDigitYear(e):Ae(e)}),Fe("YY",function(e,t){t[_e]=r.parseTwoDigitYear(e)}),Fe("Y",function(e,t){t[_e]=parseInt(e,10)}),r.parseTwoDigitYear=function(e){return Ae(e)+(Ae(e)>68?1900:2e3)};var Ke,Ye=Xe("FullYear",!0);function qe(){return Le(this.year())}function Xe(e,t){return function(n){return null!=n?(Je(this,e,n),r.updateOffset(this,t),this):Qe(this,e)}}function Qe(e,t){if(!e.isValid())return NaN;var n=e._d,r=e._isUTC;switch(t){case"Milliseconds":return r?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return r?n.getUTCSeconds():n.getSeconds();case"Minutes":return r?n.getUTCMinutes():n.getMinutes();case"Hours":return r?n.getUTCHours():n.getHours();case"Date":return r?n.getUTCDate():n.getDate();case"Day":return r?n.getUTCDay():n.getDay();case"Month":return r?n.getUTCMonth():n.getMonth();case"FullYear":return r?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Je(e,t,n){var r,i,o,s,a;if(e.isValid()&&!isNaN(n)){switch(r=e._d,i=e._isUTC,t){case"Milliseconds":return void(i?r.setUTCMilliseconds(n):r.setMilliseconds(n));case"Seconds":return void(i?r.setUTCSeconds(n):r.setSeconds(n));case"Minutes":return void(i?r.setUTCMinutes(n):r.setMinutes(n));case"Hours":return void(i?r.setUTCHours(n):r.setHours(n));case"Date":return void(i?r.setUTCDate(n):r.setDate(n));case"FullYear":break;default:return}o=n,s=e.month(),a=29!==(a=e.date())||1!==s||Le(o)?a:28,i?r.setUTCFullYear(o,s,a):r.setFullYear(o,s,a)}}function Ze(e){return P(this[e=ne(e)])?this[e]():this}function et(e,t){if("object"===typeof e){var n,r=oe(e=re(e)),i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(P(this[e=ne(e)]))return this[e](t);return this}function tt(e,t){return(e%t+t)%t}function nt(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=tt(t,12);return e+=(t-n)/12,1===n?Le(e)?29:28:31-n%7%2}Ke=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},B("M",["MM",2],"Mo",function(){return this.month()+1}),B("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),B("MMMM",0,0,function(e){return this.localeData().months(this,e)}),Te("M",he,Re),Te("MM",he,le),Te("MMM",function(e,t){return t.monthsShortRegex(e)}),Te("MMMM",function(e,t){return t.monthsRegex(e)}),Fe(["M","MM"],function(e,t){t[He]=Ae(e)-1}),Fe(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[He]=i:m(n).invalidMonth=e});var rt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),it="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ot=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,st=xe,at=xe;function lt(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ot).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function ct(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ot.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ut(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=g([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ke.call(this._shortMonthsParse,s))?i:null:-1!==(i=Ke.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Ke.call(this._shortMonthsParse,s))||-1!==(i=Ke.call(this._longMonthsParse,s))?i:null:-1!==(i=Ke.call(this._longMonthsParse,s))||-1!==(i=Ke.call(this._shortMonthsParse,s))?i:null}function dt(e,t,n){var r,i,o;if(this._monthsParseExact)return ut.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=g([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ht(e,t){if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=Ae(t);else if(!u(t=e.localeData().monthsParse(t)))return e;var n=t,r=e.date();return r=r<29?r:Math.min(r,nt(e.year(),n)),e._isUTC?e._d.setUTCMonth(n,r):e._d.setMonth(n,r),e}function pt(e){return null!=e?(ht(this,e),r.updateOffset(this,!0),this):Qe(this,"Month")}function gt(){return nt(this.year(),this.month())}function ft(e){return this._monthsParseExact?(a(this,"_monthsRegex")||vt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=st),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function mt(e){return this._monthsParseExact?(a(this,"_monthsRegex")||vt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=at),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function vt(){function e(e,t){return t.length-e.length}var t,n,r,i,o=[],s=[],a=[];for(t=0;t<12;t++)n=g([2e3,t]),r=Pe(this.monthsShort(n,"")),i=Pe(this.months(n,"")),o.push(r),s.push(i),a.push(i),a.push(r);o.sort(e),s.sort(e),a.sort(e),this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function wt(e,t,n,r,i,o,s){var a;return e<100&&e>=0?(a=new Date(e+400,t,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,n,r,i,o,s),a}function bt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ct(e,t,n){var r=7+t-n;return-(7+bt(e,0,r).getUTCDay()-t)%7+r-1}function yt(e,t,n,r,i){var o,s,a=1+7*(t-1)+(7+n-r)%7+Ct(e,r,i);return a<=0?s=Ue(o=e-1)+a:a>Ue(e)?(o=e+1,s=a-Ue(e)):(o=e,s=a),{year:o,dayOfYear:s}}function St(e,t,n){var r,i,o=Ct(e.year(),t,n),s=Math.floor((e.dayOfYear()-o-1)/7)+1;return s<1?r=s+xt(i=e.year()-1,t,n):s>xt(e.year(),t,n)?(r=s-xt(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function xt(e,t,n){var r=Ct(e,t,n),i=Ct(e+1,t,n);return(Ue(e)-r+i)/7}function Rt(e){return St(e,this._week.dow,this._week.doy).week}B("w",["ww",2],"wo","week"),B("W",["WW",2],"Wo","isoWeek"),Te("w",he,Re),Te("ww",he,le),Te("W",he,Re),Te("WW",he,le),Oe(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=Ae(e)});var Et={dow:0,doy:6};function Tt(){return this._week.dow}function kt(){return this._week.doy}function Mt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Pt(e){var t=St(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function It(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function At(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Dt(e,t){return e.slice(t,7).concat(e.slice(0,t))}B("d",0,"do","day"),B("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),B("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),B("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),B("e",0,0,"weekday"),B("E",0,0,"isoWeekday"),Te("d",he),Te("e",he),Te("E",he),Te("dd",function(e,t){return t.weekdaysMinRegex(e)}),Te("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Te("dddd",function(e,t){return t.weekdaysRegex(e)}),Oe(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:m(n).invalidWeekday=e}),Oe(["d","e","E"],function(e,t,n,r){t[r]=Ae(e)});var Ft="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ot="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Nt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Lt=xe,_t=xe,Ht=xe;function Vt(e,t){var n=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Dt(n,this._week.dow):e?n[e.day()]:n}function Bt(e){return!0===e?Dt(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Wt(e){return!0===e?Dt(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function zt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=g([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ke.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ke.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._shortWeekdaysParse,s))||-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ke.call(this._shortWeekdaysParse,s))||-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Ke.call(this._minWeekdaysParse,s))||-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._shortWeekdaysParse,s))?i:null}function jt(e,t,n){var r,i,o;if(this._weekdaysParseExact)return zt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=g([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Gt(e){if(!this.isValid())return null!=e?this:NaN;var t=Qe(this,"Day");return null!=e?(e=It(e,this.localeData()),this.add(e-t,"d")):t}function $t(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ut(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=At(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Kt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=Lt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Yt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=_t),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function qt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ht),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xt(){function e(e,t){return t.length-e.length}var t,n,r,i,o,s=[],a=[],l=[],c=[];for(t=0;t<7;t++)n=g([2e3,1]).day(t),r=Pe(this.weekdaysMin(n,"")),i=Pe(this.weekdaysShort(n,"")),o=Pe(this.weekdays(n,"")),s.push(r),a.push(i),l.push(o),c.push(r),c.push(i),c.push(o);s.sort(e),a.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Qt(){return this.hours()%12||12}function Jt(){return this.hours()||24}function Zt(e,t){B(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}B("H",["HH",2],0,"hour"),B("h",["hh",2],0,Qt),B("k",["kk",2],0,Jt),B("hmm",0,0,function(){return""+Qt.apply(this)+N(this.minutes(),2)}),B("hmmss",0,0,function(){return""+Qt.apply(this)+N(this.minutes(),2)+N(this.seconds(),2)}),B("Hmm",0,0,function(){return""+this.hours()+N(this.minutes(),2)}),B("Hmmss",0,0,function(){return""+this.hours()+N(this.minutes(),2)+N(this.seconds(),2)}),Zt("a",!0),Zt("A",!1),Te("a",en),Te("A",en),Te("H",he,Ee),Te("h",he,Re),Te("k",he,Re),Te("HH",he,le),Te("hh",he,le),Te("kk",he,le),Te("hmm",pe),Te("hmmss",ge),Te("Hmm",pe),Te("Hmmss",ge),Fe(["H","HH"],Be),Fe(["k","kk"],function(e,t,n){var r=Ae(e);t[Be]=24===r?0:r}),Fe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),Fe(["h","hh"],function(e,t,n){t[Be]=Ae(e),m(n).bigHour=!0}),Fe("hmm",function(e,t,n){var r=e.length-2;t[Be]=Ae(e.substr(0,r)),t[We]=Ae(e.substr(r)),m(n).bigHour=!0}),Fe("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=Ae(e.substr(0,r)),t[We]=Ae(e.substr(r,2)),t[ze]=Ae(e.substr(i)),m(n).bigHour=!0}),Fe("Hmm",function(e,t,n){var r=e.length-2;t[Be]=Ae(e.substr(0,r)),t[We]=Ae(e.substr(r))}),Fe("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=Ae(e.substr(0,r)),t[We]=Ae(e.substr(r,2)),t[ze]=Ae(e.substr(i))});var nn=/[ap]\.?m?\.?/i,rn=Xe("Hours",!0);function on(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var sn,an={calendar:F,longDateFormat:$,invalidDate:K,ordinal:q,dayOfMonthOrdinalParse:X,relativeTime:J,months:rt,monthsShort:it,week:Et,weekdays:Ft,weekdaysMin:Nt,weekdaysShort:Ot,meridiemParse:nn},ln={},cn={};function un(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function dn(e){return e?e.toLowerCase().replace("_","-"):e}function hn(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=dn(e[o]).split("-")).length,n=(n=dn(e[o+1]))?n.split("-"):null;t>0;){if(r=gn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&un(i,n)>=t-1)break;t--}o++}return sn}function pn(e){return!(!e||!e.match("^[^/\\\\]*$"))}function gn(t){var n=null;if(void 0===ln[t]&&e&&e.exports&&pn(t))try{n=sn._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),fn(n)}catch(r){ln[t]=null}return ln[t]}function fn(e,t){var n;return e&&((n=c(t)?wn(e):mn(e,t))?sn=n:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),sn._abbr}function mn(e,t){if(null!==t){var n,r=an;if(t.abbr=e,null!=ln[e])M("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ln[e]._config;else if(null!=t.parentLocale)if(null!=ln[t.parentLocale])r=ln[t.parentLocale]._config;else{if(null==(n=gn(t.parentLocale)))return cn[t.parentLocale]||(cn[t.parentLocale]=[]),cn[t.parentLocale].push({name:e,config:t}),null;r=n._config}return ln[e]=new D(A(r,t)),cn[e]&&cn[e].forEach(function(e){mn(e.name,e.config)}),fn(e),ln[e]}return delete ln[e],null}function vn(e,t){if(null!=t){var n,r,i=an;null!=ln[e]&&null!=ln[e].parentLocale?ln[e].set(A(ln[e]._config,t)):(null!=(r=gn(e))&&(i=r._config),t=A(i,t),null==r&&(t.abbr=e),(n=new D(t)).parentLocale=ln[e],ln[e]=n),fn(e)}else null!=ln[e]&&(null!=ln[e].parentLocale?(ln[e]=ln[e].parentLocale,e===fn()&&fn(e)):null!=ln[e]&&delete ln[e]);return ln[e]}function wn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return sn;if(!o(e)){if(t=gn(e))return t;e=[e]}return hn(e)}function bn(){return T(ln)}function Cn(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[He]<0||n[He]>11?He:n[Ve]<1||n[Ve]>nt(n[_e],n[He])?Ve:n[Be]<0||n[Be]>24||24===n[Be]&&(0!==n[We]||0!==n[ze]||0!==n[je])?Be:n[We]<0||n[We]>59?We:n[ze]<0||n[ze]>59?ze:n[je]<0||n[je]>999?je:-1,m(e)._overflowDayOfYear&&(t<_e||t>Ve)&&(t=Ve),m(e)._overflowWeeks&&-1===t&&(t=Ge),m(e)._overflowWeekday&&-1===t&&(t=$e),m(e).overflow=t),e}var yn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xn=/Z|[+-]\d\d(?::?\d\d)?/,Rn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],En=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Tn=/^\/?Date\((-?\d+)/i,kn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Mn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Pn(e){var t,n,r,i,o,s,a=e._i,l=yn.exec(a)||Sn.exec(a),c=Rn.length,u=En.length;if(l){for(m(e).iso=!0,t=0,n=c;t<n;t++)if(Rn[t][1].exec(l[1])){i=Rn[t][0],r=!1!==Rn[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=u;t<n;t++)if(En[t][1].exec(l[3])){o=(l[2]||" ")+En[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(l[4]){if(!xn.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(o||"")+(s||""),Wn(e)}else e._isValid=!1}function In(e,t,n,r,i,o){var s=[An(e),it.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function An(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Dn(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Fn(e,t,n){return!e||Ot.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}function On(e,t,n){if(e)return Mn[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function Nn(e){var t,n=kn.exec(Dn(e._i));if(n){if(t=In(n[4],n[3],n[2],n[5],n[6],n[7]),!Fn(n[1],t,e))return;e._a=t,e._tzm=On(n[8],n[9],n[10]),e._d=bt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Ln(e){var t=Tn.exec(e._i);null===t?(Pn(e),!1===e._isValid&&(delete e._isValid,Nn(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function _n(e,t,n){return null!=e?e:null!=t?t:n}function Hn(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Vn(e){var t,n,r,i,o,s=[];if(!e._d){for(r=Hn(e),e._w&&null==e._a[Ve]&&null==e._a[He]&&Bn(e),null!=e._dayOfYear&&(o=_n(e._a[_e],r[_e]),(e._dayOfYear>Ue(o)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=bt(o,0,e._dayOfYear),e._a[He]=n.getUTCMonth(),e._a[Ve]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Be]&&0===e._a[We]&&0===e._a[ze]&&0===e._a[je]&&(e._nextDay=!0,e._a[Be]=0),e._d=(e._useUTC?bt:wt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Be]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(m(e).weekdayMismatch=!0)}}function Bn(e){var t,n,r,i,o,s,a,l,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(o=1,s=4,n=_n(t.GG,e._a[_e],St(qn(),1,4).year),r=_n(t.W,1),((i=_n(t.E,1))<1||i>7)&&(l=!0)):(o=e._locale._week.dow,s=e._locale._week.doy,c=St(qn(),o,s),n=_n(t.gg,e._a[_e],c.year),r=_n(t.w,c.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),r<1||r>xt(n,o,s)?m(e)._overflowWeeks=!0:null!=l?m(e)._overflowWeekday=!0:(a=yt(n,r,i,o,s),e._a[_e]=a.year,e._dayOfYear=a.dayOfYear)}function Wn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],m(e).empty=!0;var t,n,i,o,s,a,l,c=""+e._i,u=c.length,d=0;for(l=(i=G(e._f,e._locale).match(L)||[]).length,t=0;t<l;t++)o=i[t],(n=(c.match(ke(o,e))||[])[0])&&((s=c.substr(0,c.indexOf(n))).length>0&&m(e).unusedInput.push(s),c=c.slice(c.indexOf(n)+n.length),d+=n.length),V[o]?(n?m(e).empty=!1:m(e).unusedTokens.push(o),Ne(o,n,e)):e._strict&&!n&&m(e).unusedTokens.push(o);m(e).charsLeftOver=u-d,c.length>0&&m(e).unusedInput.push(c),e._a[Be]<=12&&!0===m(e).bigHour&&e._a[Be]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[Be]=zn(e._locale,e._a[Be],e._meridiem),null!==(a=m(e).era)&&(e._a[_e]=e._locale.erasConvertYear(a,e._a[_e])),Vn(e),Cn(e)}else Nn(e);else Pn(e)}function zn(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function jn(e){var t,n,r,i,o,s,a=!1,l=e._f.length;if(0===l)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<l;i++)o=0,s=!1,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Wn(t),v(t)&&(s=!0),o+=m(t).charsLeftOver,o+=10*m(t).unusedTokens.length,m(t).score=o,a?o<r&&(r=o,n=t):(null==r||o<r||s)&&(r=o,n=t,s&&(a=!0));p(e,n||t)}function Gn(e){if(!e._d){var t=re(e._i),n=void 0===t.day?t.date:t.day;e._a=h([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),Vn(e)}}function $n(e){var t=new S(Cn(Un(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Un(e){var t=e._i,n=e._f;return e._locale=e._locale||wn(e._l),null===t||void 0===n&&""===t?w({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),x(t)?new S(Cn(t)):(d(t)?e._d=t:o(n)?jn(e):n?Wn(e):Kn(e),v(e)||(e._d=null),e))}function Kn(e){var t=e._i;c(t)?e._d=new Date(r.now()):d(t)?e._d=new Date(t.valueOf()):"string"===typeof t?Ln(e):o(t)?(e._a=h(t.slice(0),function(e){return parseInt(e,10)}),Vn(e)):s(t)?Gn(e):u(t)?e._d=new Date(t):r.createFromInputFallback(e)}function Yn(e,t,n,r,i){var a={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&l(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=r,$n(a)}function qn(e,t,n,r){return Yn(e,t,n,r,!1)}r.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),r.ISO_8601=function(){},r.RFC_2822=function(){};var Xn=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:w()}),Qn=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=qn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:w()});function Jn(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return qn();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Zn(){return Jn("isBefore",[].slice.call(arguments,0))}function er(){return Jn("isAfter",[].slice.call(arguments,0))}var tr=function(){return Date.now?Date.now():+new Date},nr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rr(e){var t,n,r=!1,i=nr.length;for(t in e)if(a(e,t)&&(-1===Ke.call(nr,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[nr[n]]){if(r)return!1;parseFloat(e[nr[n]])!==Ae(e[nr[n]])&&(r=!0)}return!0}function ir(){return this._isValid}function or(){return Mr(NaN)}function sr(e){var t=re(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=rr(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*a*60*60,this._days=+s+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=wn(),this._bubble()}function ar(e){return e instanceof sr}function lr(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function cr(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&Ae(e[r])!==Ae(t[r]))&&s++;return s+o}function ur(e,t){B(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+N(~~(e/60),2)+t+N(~~e%60,2)})}ur("Z",":"),ur("ZZ",""),Te("Z",ye),Te("ZZ",ye),Fe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=hr(ye,e)});var dr=/([\+\-]|\d\d)/gi;function hr(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(dr)||["-",0,0])[1]+Ae(n[2]))?0:"+"===n[0]?r:-r}function pr(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(x(e)||d(e)?e.valueOf():qn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):qn(e).local()}function gr(e){return-Math.round(e._d.getTimezoneOffset())}function fr(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=hr(ye,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=gr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Fr(this,Mr(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:gr(this)}function mr(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function vr(e){return this.utcOffset(0,e)}function wr(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(gr(this),"m")),this}function br(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=hr(Ce,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Cr(e){return!!this.isValid()&&(e=e?qn(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function yr(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Sr(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return y(t,this),(t=Un(t))._a?(e=t._isUTC?g(t._a):qn(t._a),this._isDSTShifted=this.isValid()&&cr(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function xr(){return!!this.isValid()&&!this._isUTC}function Rr(){return!!this.isValid()&&this._isUTC}function Er(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Tr=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,kr=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Mr(e,t){var n,r,i,o=e,s=null;return ar(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(o={},t?o[t]=+e:o.milliseconds=+e):(s=Tr.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:Ae(s[Ve])*n,h:Ae(s[Be])*n,m:Ae(s[We])*n,s:Ae(s[ze])*n,ms:Ae(lr(1e3*s[je]))*n}):(s=kr.exec(e))?(n="-"===s[1]?-1:1,o={y:Pr(s[2],n),M:Pr(s[3],n),w:Pr(s[4],n),d:Pr(s[5],n),h:Pr(s[6],n),m:Pr(s[7],n),s:Pr(s[8],n)}):null==o?o={}:"object"===typeof o&&("from"in o||"to"in o)&&(i=Ar(qn(o.from),qn(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new sr(o),ar(e)&&a(e,"_locale")&&(r._locale=e._locale),ar(e)&&a(e,"_isValid")&&(r._isValid=e._isValid),r}function Pr(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ir(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ar(e,t){var n;return e.isValid()&&t.isValid()?(t=pr(t,e),e.isBefore(t)?n=Ir(e,t):((n=Ir(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Dr(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(M(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Fr(this,Mr(n,r),e),this}}function Fr(e,t,n,i){var o=t._milliseconds,s=lr(t._days),a=lr(t._months);e.isValid()&&(i=null==i||i,a&&ht(e,Qe(e,"Month")+a*n),s&&Je(e,"Date",Qe(e,"Date")+s*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&r.updateOffset(e,s||a))}Mr.fn=sr.prototype,Mr.invalid=or;var Or=Dr(1,"add"),Nr=Dr(-1,"subtract");function Lr(e){return"string"===typeof e||e instanceof String}function _r(e){return x(e)||d(e)||Lr(e)||u(e)||Vr(e)||Hr(e)||null===e||void 0===e}function Hr(e){var t,n,r=s(e)&&!l(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],c=o.length;for(t=0;t<c;t+=1)n=o[t],i=i||a(e,n);return r&&i}function Vr(e){var t=o(e),n=!1;return t&&(n=0===e.filter(function(t){return!u(t)&&Lr(e)}).length),t&&n}function Br(e){var t,n,r=s(e)&&!l(e),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)n=o[t],i=i||a(e,n);return r&&i}function Wr(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function zr(e,t){1===arguments.length&&(arguments[0]?_r(arguments[0])?(e=arguments[0],t=void 0):Br(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||qn(),i=pr(n,this).startOf("day"),o=r.calendarFormat(this,i)||"sameElse",s=t&&(P(t[o])?t[o].call(this,n):t[o]);return this.format(s||this.localeData().calendar(o,this,qn(n)))}function jr(){return new S(this)}function Gr(e,t){var n=x(e)?e:qn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function $r(e,t){var n=x(e)?e:qn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Ur(e,t,n,r){var i=x(e)?e:qn(e),o=x(t)?t:qn(t);return!!(this.isValid()&&i.isValid()&&o.isValid())&&("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(o,n):!this.isAfter(o,n))}function Kr(e,t){var n,r=x(e)?e:qn(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=ne(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Yr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function qr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Xr(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=pr(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=ne(t)){case"year":o=Qr(this,r)/12;break;case"month":o=Qr(this,r);break;case"quarter":o=Qr(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ie(o)}function Qr(e,t){if(e.date()<t.date())return-Qr(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Jr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Zr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?j(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):P(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",j(n,"Z")):j(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",r=o+'[")]',this.format(e+t+n+r)}function ti(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=j(this,e);return this.localeData().postformat(t)}function ni(e,t){return this.isValid()&&(x(e)&&e.isValid()||qn(e).isValid())?Mr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ri(e){return this.from(qn(),e)}function ii(e,t){return this.isValid()&&(x(e)&&e.isValid()||qn(e).isValid())?Mr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.to(qn(),e)}function si(e){var t;return void 0===e?this._locale._abbr:(null!=(t=wn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ai=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function li(){return this._locale}var ci=1e3,ui=60*ci,di=60*ui,hi=3506328*di;function pi(e,t){return(e%t+t)%t}function gi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-hi:new Date(e,t,n).valueOf()}function fi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-hi:Date.UTC(e,t,n)}function mi(e){var t,n;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?fi:gi,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=pi(t+(this._isUTC?0:this.utcOffset()*ui),di);break;case"minute":t=this._d.valueOf(),t-=pi(t,ui);break;case"second":t=this._d.valueOf(),t-=pi(t,ci)}return this._d.setTime(t),r.updateOffset(this,!0),this}function vi(e){var t,n;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?fi:gi,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=di-pi(t+(this._isUTC?0:this.utcOffset()*ui),di)-1;break;case"minute":t=this._d.valueOf(),t+=ui-pi(t,ui)-1;break;case"second":t=this._d.valueOf(),t+=ci-pi(t,ci)-1}return this._d.setTime(t),r.updateOffset(this,!0),this}function wi(){return this._d.valueOf()-6e4*(this._offset||0)}function bi(){return Math.floor(this.valueOf()/1e3)}function Ci(){return new Date(this.valueOf())}function yi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Si(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function xi(){return this.isValid()?this.toISOString():null}function Ri(){return v(this)}function Ei(){return p({},m(this))}function Ti(){return m(this).overflow}function ki(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Mi(e,t){var n,i,o,s=this._eras||wn("en")._eras;for(n=0,i=s.length;n<i;++n)switch("string"===typeof s[n].since&&(o=r(s[n].since).startOf("day"),s[n].since=o.valueOf()),typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":o=r(s[n].until).startOf("day").valueOf(),s[n].until=o.valueOf()}return s}function Pi(e,t,n){var r,i,o,s,a,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(o=l[r].name.toUpperCase(),s=l[r].abbr.toUpperCase(),a=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[r];break;case"NNNN":if(o===e)return l[r];break;case"NNNNN":if(a===e)return l[r]}else if([o,s,a].indexOf(e)>=0)return l[r]}function Ii(e,t){var n=e.since<=e.until?1:-1;return void 0===t?r(e.since).year():r(e.since).year()+(t-e.offset)*n}function Ai(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function Di(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Fi(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Oi(){var e,t,n,i,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(n=o[e].since<=o[e].until?1:-1,i=this.clone().startOf("day").valueOf(),o[e].since<=i&&i<=o[e].until||o[e].until<=i&&i<=o[e].since)return(this.year()-r(o[e].since).year())*n+o[e].offset;return this.year()}function Ni(e){return a(this,"_erasNameRegex")||zi.call(this),e?this._erasNameRegex:this._erasRegex}function Li(e){return a(this,"_erasAbbrRegex")||zi.call(this),e?this._erasAbbrRegex:this._erasRegex}function _i(e){return a(this,"_erasNarrowRegex")||zi.call(this),e?this._erasNarrowRegex:this._erasRegex}function Hi(e,t){return t.erasAbbrRegex(e)}function Vi(e,t){return t.erasNameRegex(e)}function Bi(e,t){return t.erasNarrowRegex(e)}function Wi(e,t){return t._eraYearOrdinalRegex||we}function zi(){var e,t,n,r,i,o=[],s=[],a=[],l=[],c=this.eras();for(e=0,t=c.length;e<t;++e)n=Pe(c[e].name),r=Pe(c[e].abbr),i=Pe(c[e].narrow),s.push(n),o.push(r),a.push(i),l.push(n),l.push(r),l.push(i);this._erasRegex=new RegExp("^("+l.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+a.join("|")+")","i")}function ji(e,t){B(0,[e,e.length],0,t)}function Gi(e){return Xi.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function $i(e){return Xi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ui(){return xt(this.year(),1,4)}function Ki(){return xt(this.isoWeekYear(),1,4)}function Yi(){var e=this.localeData()._week;return xt(this.year(),e.dow,e.doy)}function qi(){var e=this.localeData()._week;return xt(this.weekYear(),e.dow,e.doy)}function Xi(e,t,n,r,i){var o;return null==e?St(this,r,i).year:(t>(o=xt(e,r,i))&&(t=o),Qi.call(this,e,t,n,r,i))}function Qi(e,t,n,r,i){var o=yt(e,t,n,r,i),s=bt(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Ji(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}B("N",0,0,"eraAbbr"),B("NN",0,0,"eraAbbr"),B("NNN",0,0,"eraAbbr"),B("NNNN",0,0,"eraName"),B("NNNNN",0,0,"eraNarrow"),B("y",["y",1],"yo","eraYear"),B("y",["yy",2],0,"eraYear"),B("y",["yyy",3],0,"eraYear"),B("y",["yyyy",4],0,"eraYear"),Te("N",Hi),Te("NN",Hi),Te("NNN",Hi),Te("NNNN",Vi),Te("NNNNN",Bi),Fe(["N","NN","NNN","NNNN","NNNNN"],function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?m(n).era=i:m(n).invalidEra=e}),Te("y",we),Te("yy",we),Te("yyy",we),Te("yyyy",we),Te("yo",Wi),Fe(["y","yy","yyy","yyyy"],_e),Fe(["yo"],function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[_e]=n._locale.eraYearOrdinalParse(e,i):t[_e]=parseInt(e,10)}),B(0,["gg",2],0,function(){return this.weekYear()%100}),B(0,["GG",2],0,function(){return this.isoWeekYear()%100}),ji("gggg","weekYear"),ji("ggggg","weekYear"),ji("GGGG","isoWeekYear"),ji("GGGGG","isoWeekYear"),Te("G",be),Te("g",be),Te("GG",he,le),Te("gg",he,le),Te("GGGG",me,ue),Te("gggg",me,ue),Te("GGGGG",ve,de),Te("ggggg",ve,de),Oe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=Ae(e)}),Oe(["gg","GG"],function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)}),B("Q",0,"Qo","quarter"),Te("Q",ae),Fe("Q",function(e,t){t[He]=3*(Ae(e)-1)}),B("D",["DD",2],"Do","date"),Te("D",he,Re),Te("DD",he,le),Te("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),Fe(["D","DD"],Ve),Fe("Do",function(e,t){t[Ve]=Ae(e.match(he)[0])});var Zi=Xe("Date",!0);function eo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}B("DDD",["DDDD",3],"DDDo","dayOfYear"),Te("DDD",fe),Te("DDDD",ce),Fe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=Ae(e)}),B("m",["mm",2],0,"minute"),Te("m",he,Ee),Te("mm",he,le),Fe(["m","mm"],We);var to=Xe("Minutes",!1);B("s",["ss",2],0,"second"),Te("s",he,Ee),Te("ss",he,le),Fe(["s","ss"],ze);var no,ro,io=Xe("Seconds",!1);for(B("S",0,0,function(){return~~(this.millisecond()/100)}),B(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),B(0,["SSS",3],0,"millisecond"),B(0,["SSSS",4],0,function(){return 10*this.millisecond()}),B(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),B(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),B(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),B(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),B(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),Te("S",fe,ae),Te("SS",fe,le),Te("SSS",fe,ce),no="SSSS";no.length<=9;no+="S")Te(no,we);function oo(e,t){t[je]=Ae(1e3*("0."+e))}for(no="S";no.length<=9;no+="S")Fe(no,oo);function so(){return this._isUTC?"UTC":""}function ao(){return this._isUTC?"Coordinated Universal Time":""}ro=Xe("Milliseconds",!1),B("z",0,0,"zoneAbbr"),B("zz",0,0,"zoneName");var lo=S.prototype;function co(e){return qn(1e3*e)}function uo(){return qn.apply(null,arguments).parseZone()}function ho(e){return e}lo.add=Or,lo.calendar=zr,lo.clone=jr,lo.diff=Xr,lo.endOf=vi,lo.format=ti,lo.from=ni,lo.fromNow=ri,lo.to=ii,lo.toNow=oi,lo.get=Ze,lo.invalidAt=Ti,lo.isAfter=Gr,lo.isBefore=$r,lo.isBetween=Ur,lo.isSame=Kr,lo.isSameOrAfter=Yr,lo.isSameOrBefore=qr,lo.isValid=Ri,lo.lang=ai,lo.locale=si,lo.localeData=li,lo.max=Qn,lo.min=Xn,lo.parsingFlags=Ei,lo.set=et,lo.startOf=mi,lo.subtract=Nr,lo.toArray=yi,lo.toObject=Si,lo.toDate=Ci,lo.toISOString=Zr,lo.inspect=ei,"undefined"!==typeof Symbol&&null!=Symbol.for&&(lo[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lo.toJSON=xi,lo.toString=Jr,lo.unix=bi,lo.valueOf=wi,lo.creationData=ki,lo.eraName=Ai,lo.eraNarrow=Di,lo.eraAbbr=Fi,lo.eraYear=Oi,lo.year=Ye,lo.isLeapYear=qe,lo.weekYear=Gi,lo.isoWeekYear=$i,lo.quarter=lo.quarters=Ji,lo.month=pt,lo.daysInMonth=gt,lo.week=lo.weeks=Mt,lo.isoWeek=lo.isoWeeks=Pt,lo.weeksInYear=Yi,lo.weeksInWeekYear=qi,lo.isoWeeksInYear=Ui,lo.isoWeeksInISOWeekYear=Ki,lo.date=Zi,lo.day=lo.days=Gt,lo.weekday=$t,lo.isoWeekday=Ut,lo.dayOfYear=eo,lo.hour=lo.hours=rn,lo.minute=lo.minutes=to,lo.second=lo.seconds=io,lo.millisecond=lo.milliseconds=ro,lo.utcOffset=fr,lo.utc=vr,lo.local=wr,lo.parseZone=br,lo.hasAlignedHourOffset=Cr,lo.isDST=yr,lo.isLocal=xr,lo.isUtcOffset=Rr,lo.isUtc=Er,lo.isUTC=Er,lo.zoneAbbr=so,lo.zoneName=ao,lo.dates=E("dates accessor is deprecated. Use date instead.",Zi),lo.months=E("months accessor is deprecated. Use month instead",pt),lo.years=E("years accessor is deprecated. Use year instead",Ye),lo.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mr),lo.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Sr);var po=D.prototype;function go(e,t,n,r){var i=wn(),o=g().set(r,t);return i[n](o,e)}function fo(e,t,n){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return go(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=go(e,r,n,"month");return i}function mo(e,t,n,r){"boolean"===typeof e?(u(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,u(t)&&(n=t,t=void 0),t=t||"");var i,o=wn(),s=e?o._week.dow:0,a=[];if(null!=n)return go(t,(n+s)%7,r,"day");for(i=0;i<7;i++)a[i]=go(t,(i+s)%7,r,"day");return a}function vo(e,t){return fo(e,t,"months")}function wo(e,t){return fo(e,t,"monthsShort")}function bo(e,t,n){return mo(e,t,n,"weekdays")}function Co(e,t,n){return mo(e,t,n,"weekdaysShort")}function yo(e,t,n){return mo(e,t,n,"weekdaysMin")}po.calendar=O,po.longDateFormat=U,po.invalidDate=Y,po.ordinal=Q,po.preparse=ho,po.postformat=ho,po.relativeTime=Z,po.pastFuture=ee,po.set=I,po.eras=Mi,po.erasParse=Pi,po.erasConvertYear=Ii,po.erasAbbrRegex=Li,po.erasNameRegex=Ni,po.erasNarrowRegex=_i,po.months=lt,po.monthsShort=ct,po.monthsParse=dt,po.monthsRegex=mt,po.monthsShortRegex=ft,po.week=Rt,po.firstDayOfYear=kt,po.firstDayOfWeek=Tt,po.weekdays=Vt,po.weekdaysMin=Wt,po.weekdaysShort=Bt,po.weekdaysParse=jt,po.weekdaysRegex=Kt,po.weekdaysShortRegex=Yt,po.weekdaysMinRegex=qt,po.isPM=tn,po.meridiem=on,fn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===Ae(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=E("moment.lang is deprecated. Use moment.locale instead.",fn),r.langData=E("moment.langData is deprecated. Use moment.localeData instead.",wn);var So=Math.abs;function xo(){var e=this._data;return this._milliseconds=So(this._milliseconds),this._days=So(this._days),this._months=So(this._months),e.milliseconds=So(e.milliseconds),e.seconds=So(e.seconds),e.minutes=So(e.minutes),e.hours=So(e.hours),e.months=So(e.months),e.years=So(e.years),this}function Ro(e,t,n,r){var i=Mr(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Eo(e,t){return Ro(this,e,t,1)}function To(e,t){return Ro(this,e,t,-1)}function ko(e){return e<0?Math.floor(e):Math.ceil(e)}function Mo(){var e,t,n,r,i,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*ko(Io(a)+s),s=0,a=0),l.milliseconds=o%1e3,e=Ie(o/1e3),l.seconds=e%60,t=Ie(e/60),l.minutes=t%60,n=Ie(t/60),l.hours=n%24,s+=Ie(n/24),a+=i=Ie(Po(s)),s-=ko(Io(i)),r=Ie(a/12),a%=12,l.days=s,l.months=a,l.years=r,this}function Po(e){return 4800*e/146097}function Io(e){return 146097*e/4800}function Ao(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=ne(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+Po(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Io(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Do(e){return function(){return this.as(e)}}var Fo=Do("ms"),Oo=Do("s"),No=Do("m"),Lo=Do("h"),_o=Do("d"),Ho=Do("w"),Vo=Do("M"),Bo=Do("Q"),Wo=Do("y"),zo=Fo;function jo(){return Mr(this)}function Go(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function $o(e){return function(){return this.isValid()?this._data[e]:NaN}}var Uo=$o("milliseconds"),Ko=$o("seconds"),Yo=$o("minutes"),qo=$o("hours"),Xo=$o("days"),Qo=$o("months"),Jo=$o("years");function Zo(){return Ie(this.days()/7)}var es=Math.round,ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ns(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function rs(e,t,n,r){var i=Mr(e).abs(),o=es(i.as("s")),s=es(i.as("m")),a=es(i.as("h")),l=es(i.as("d")),c=es(i.as("M")),u=es(i.as("w")),d=es(i.as("y")),h=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(h=h||u<=1&&["w"]||u<n.w&&["ww",u]),(h=h||c<=1&&["M"]||c<n.M&&["MM",c]||d<=1&&["y"]||["yy",d])[2]=t,h[3]=+e>0,h[4]=r,ns.apply(null,h)}function is(e){return void 0===e?es:"function"===typeof e&&(es=e,!0)}function os(e,t){return void 0!==ts[e]&&(void 0===t?ts[e]:(ts[e]=t,"s"===e&&(ts.ss=t-1),!0))}function ss(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,o=ts;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(o=Object.assign({},ts,t),null!=t.s&&null==t.ss&&(o.ss=t.s-1)),r=rs(this,!i,o,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)}var as=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function cs(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,o,s,a,l=as(this._milliseconds)/1e3,c=as(this._days),u=as(this._months),d=this.asSeconds();return d?(e=Ie(l/60),t=Ie(e/60),l%=60,e%=60,n=Ie(u/12),u%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=d<0?"-":"",o=ls(this._months)!==ls(d)?"-":"",s=ls(this._days)!==ls(d)?"-":"",a=ls(this._milliseconds)!==ls(d)?"-":"",i+"P"+(n?o+n+"Y":"")+(u?o+u+"M":"")+(c?s+c+"D":"")+(t||e||l?"T":"")+(t?a+t+"H":"")+(e?a+e+"M":"")+(l?a+r+"S":"")):"P0D"}var us=sr.prototype;return us.isValid=ir,us.abs=xo,us.add=Eo,us.subtract=To,us.as=Ao,us.asMilliseconds=Fo,us.asSeconds=Oo,us.asMinutes=No,us.asHours=Lo,us.asDays=_o,us.asWeeks=Ho,us.asMonths=Vo,us.asQuarters=Bo,us.asYears=Wo,us.valueOf=zo,us._bubble=Mo,us.clone=jo,us.get=Go,us.milliseconds=Uo,us.seconds=Ko,us.minutes=Yo,us.hours=qo,us.days=Xo,us.weeks=Zo,us.months=Qo,us.years=Jo,us.humanize=ss,us.toISOString=cs,us.toString=cs,us.toJSON=cs,us.locale=si,us.localeData=li,us.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",cs),us.lang=ai,B("X",0,0,"unix"),B("x",0,0,"valueOf"),Te("x",be),Te("X",Se),Fe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e))}),Fe("x",function(e,t,n){n._d=new Date(Ae(e))}),r.version="2.30.1",i(qn),r.fn=lo,r.min=Zn,r.max=er,r.now=tr,r.utc=g,r.unix=co,r.months=vo,r.isDate=d,r.locale=fn,r.invalid=w,r.duration=Mr,r.isMoment=x,r.weekdays=bo,r.parseZone=uo,r.localeData=wn,r.isDuration=ar,r.monthsShort=wo,r.weekdaysMin=yo,r.defineLocale=mn,r.updateLocale=vn,r.locales=bn,r.weekdaysShort=Co,r.normalizeUnits=ne,r.relativeTimeRounding=is,r.relativeTimeThreshold=os,r.calendarFormat=Wr,r.prototype=lo,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()},6369:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6464:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},6672:(e,t,n)=>{"use strict";var r=n(5043);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},6715:(e,t,n)=>{"use strict";var r=n(4823),i=n(5214).f,o=n(9266),s=n(5551),a=n(3036),l=n(5555),c=n(6079);e.exports=function(e,t){var n,u,d,h,p,g=e.target,f=e.global,m=e.stat;if(n=f?r:m?r[g]||a(g,{}):r[g]&&r[g].prototype)for(u in t){if(h=t[u],d=e.dontCallGetSet?(p=i(n,u))&&p.value:n[u],!c(f?u:g+(m?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;l(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),s(n,u,h,e)}}},6774:(e,t,n)=>{"use strict";var r=n(1178),i=n(327);e.exports=function(e){return r(i(e))}},6821:(e,t,n)=>{"use strict";var r=n(4706);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},6842:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},6864:(e,t,n)=>{"use strict";var r=n(7707);e.exports=r({}.isPrototypeOf)},7004:(e,t,n)=>{"use strict";var r=n(8853),i=n(5043),o=n(7950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(s(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var k=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var M=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var P=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function D(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case m:return"Fragment";case w:return"Profiler";case v:return"StrictMode";case x:return"Suspense";case R:return"SuspenseList";case k:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case f:return"Portal";case y:return(e.displayName||"Context")+".Provider";case C:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:D(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return D(e(t))}catch(n){}}return null}var F=Array.isArray,O=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},_=[],H=-1;function V(e){return{current:e}}function B(e){0>H||(e.current=_[H],_[H]=null,H--)}function W(e,t){H++,_[H]=e.current,e.current=t}var z=V(null),j=V(null),G=V(null),$=V(null);function U(e,t){switch(W(G,t),W(j,e),W(z,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?id(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=od(t=id(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(z),W(z,e)}function K(){B(z),B(j),B(G)}function Y(e){null!==e.memoizedState&&W($,e);var t=z.current,n=od(t,e.type);t!==n&&(W(j,e),W(z,n))}function q(e){j.current===e&&(B(z),B(j)),$.current===e&&(B($),Yd._currentValue=L)}var X=Object.prototype.hasOwnProperty,Q=r.unstable_scheduleCallback,J=r.unstable_cancelCallback,Z=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,oe=r.unstable_NormalPriority,se=r.unstable_LowPriority,ae=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var pe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ge(e)/fe|0)|0},ge=Math.log,fe=Math.LN2;var me=256,ve=4194304;function we(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~o)?i=we(r):0!==(s&=a)?i=we(s):n||0!==(n=a&~e)&&(i=we(n)):0!==(a=r&~o)?i=we(a):0!==s?i=we(s):n||0!==(n=r&~e)&&(i=we(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function Ce(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function ye(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=me;return 0===(4194048&(me<<=1))&&(me=256),e}function xe(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function Re(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ee(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Te(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-pe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function ke(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-pe(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Me(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Pe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ie(){var e=N.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Ae=Math.random().toString(36).slice(2),De="__reactFiber$"+Ae,Fe="__reactProps$"+Ae,Oe="__reactContainer$"+Ae,Ne="__reactEvents$"+Ae,Le="__reactListeners$"+Ae,_e="__reactHandles$"+Ae,He="__reactResources$"+Ae,Ve="__reactMarker$"+Ae;function Be(e){delete e[De],delete e[Fe],delete e[Ne],delete e[Le],delete e[_e]}function We(e){var t=e[De];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Oe]||n[De]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=bd(e);null!==e;){if(n=e[De])return n;e=bd(e)}return t}n=(e=n).parentNode}return null}function ze(e){if(e=e[De]||e[Oe]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function je(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function Ge(e){var t=e[He];return t||(t=e[He]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function $e(e){e[Ve]=!0}var Ue=new Set,Ke={};function Ye(e,t){qe(e,t),qe(e+"Capture",t)}function qe(e,t){for(Ke[e]=t,e=0;e<t.length;e++)Ue.add(t[e])}var Xe,Qe,Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ze={},et={};function tt(e,t,n){if(i=t,X.call(et,i)||!X.call(Ze,i)&&(Je.test(i)?et[i]=!0:(Ze[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===Xe)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Xe=t&&t[1]||"",Qe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Xe+e+Qe}var ot=!1;function st(e,t){if(!e||ot)return"";ot=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){r=o}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var l=s.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{ot=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function at(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=at(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function pt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function ft(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function mt(e,t,n,r,i,o,s,a){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?wt(e,s,ct(t)):null!=n?wt(e,s,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function vt(e,t,n,r,i,o,s,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function wt(e,t,n){"number"===t&&pt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function bt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Ct(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function yt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(F(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var xt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Rt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||xt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Rt(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&Rt(e,o,t[o])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Mt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var It=null;function At(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Ft=null;function Ot(e){var t=ze(e);if(t&&(e=t.stateNode)){var n=e[Fe]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+ft(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Fe]||null;if(!i)throw Error(s(90));mt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":Ct(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&bt(e,!!n.multiple,t,!1)}}}var Nt=!1;function Lt(e,t,n){if(Nt)return e(t,n);Nt=!0;try{return e(t)}finally{if(Nt=!1,(null!==Dt||null!==Ft)&&(Wc(),Dt&&(t=Dt,e=Ft,Ft=Dt=null,Ot(t),e)))for(t=0;t<e.length;t++)Ot(e[t])}}function _t(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Fe]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ht=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Vt=!1;if(Ht)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(Fh){Vt=!1}var Wt=null,zt=null,jt=null;function Gt(){if(jt)return jt;var e,t,n=zt,r=n.length,i="value"in Wt?Wt.value:Wt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return jt=i.slice(e,1<t?1-t:void 0)}function $t(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ut(){return!0}function Kt(){return!1}function Yt(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Ut:Kt,this.isPropagationStopped=Kt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ut)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ut)},persist:function(){},isPersistent:Ut}),t}var qt,Xt,Qt,Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zt=Yt(Jt),en=h({},Jt,{view:0,detail:0}),tn=Yt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qt&&(Qt&&"mousemove"===e.type?(qt=e.screenX-Qt.screenX,Xt=e.screenY-Qt.screenY):Xt=qt=0,Qt=e),qt)},movementY:function(e){return"movementY"in e?e.movementY:Xt}}),rn=Yt(nn),on=Yt(h({},nn,{dataTransfer:0})),sn=Yt(h({},en,{relatedTarget:0})),an=Yt(h({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Yt(h({},Jt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Yt(h({},Jt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function gn(){return pn}var fn=Yt(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=$t(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gn,charCode:function(e){return"keypress"===e.type?$t(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?$t(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mn=Yt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Yt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gn})),wn=Yt(h({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0})),bn=Yt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Cn=Yt(h({},Jt,{newState:0,oldState:0})),yn=[9,13,27,32],Sn=Ht&&"CompositionEvent"in window,xn=null;Ht&&"documentMode"in document&&(xn=document.documentMode);var Rn=Ht&&"TextEvent"in window&&!xn,En=Ht&&(!Sn||xn&&8<xn&&11>=xn),Tn=String.fromCharCode(32),kn=!1;function Mn(e,t){switch(e){case"keyup":return-1!==yn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var In=!1;var An={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!An[e.type]:"textarea"===t}function Fn(e,t,n,r){Dt?Ft?Ft.push(r):Ft=[r]:Dt=r,0<(t=Gu(t,"onChange")).length&&(n=new Zt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var On=null,Nn=null;function Ln(e){Lu(e,0)}function _n(e){if(ht(je(e)))return e}function Hn(e,t){if("change"===e)return t}var Vn=!1;if(Ht){var Bn;if(Ht){var Wn="oninput"in document;if(!Wn){var zn=document.createElement("div");zn.setAttribute("oninput","return;"),Wn="function"===typeof zn.oninput}Bn=Wn}else Bn=!1;Vn=Bn&&(!document.documentMode||9<document.documentMode)}function jn(){On&&(On.detachEvent("onpropertychange",Gn),Nn=On=null)}function Gn(e){if("value"===e.propertyName&&_n(Nn)){var t=[];Fn(t,Nn,e,At(e)),Lt(Ln,t)}}function $n(e,t,n){"focusin"===e?(jn(),Nn=n,(On=t).attachEvent("onpropertychange",Gn)):"focusout"===e&&jn()}function Un(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return _n(Nn)}function Kn(e,t){if("click"===e)return _n(t)}function Yn(e,t){if("input"===e||"change"===e)return _n(t)}var qn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Xn(e,t){if(qn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!X.call(t,i)||!qn(e[i],t[i]))return!1}return!0}function Qn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jn(e,t){var n,r=Qn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qn(r)}}function Zn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Zn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=pt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=pt((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ht&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,or=null,sr=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;sr||null==rr||rr!==pt(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},or&&Xn(or,r)||(or=r,0<(r=Gu(ir,"onSelect")).length&&(t=new Zt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},dr={};function hr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return ur[e]=n[t];return e}Ht&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var pr=hr("animationend"),gr=hr("animationiteration"),fr=hr("animationstart"),mr=hr("transitionrun"),vr=hr("transitionstart"),wr=hr("transitioncancel"),br=hr("transitionend"),Cr=new Map,yr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){Cr.set(e,t),Ye(t,[e])}yr.push("scrollEnd");var xr=new WeakMap;function Rr(e,t){if("object"===typeof e&&null!==e){var n=xr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},xr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Er=[],Tr=0,kr=0;function Mr(){for(var e=Tr,t=kr=Tr=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var i=Er[t];Er[t++]=null;var o=Er[t];if(Er[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==o&&Dr(n,i,o)}}function Pr(e,t,n,r){Er[Tr++]=e,Er[Tr++]=t,Er[Tr++]=n,Er[Tr++]=r,kr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Ir(e,t,n,r){return Pr(e,t,n,r),Fr(e)}function Ar(e,t){return Pr(e,null,null,t),Fr(e)}function Dr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-pe(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function Fr(e){if(50<Dc)throw Dc=0,Fc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Or={};function Nr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lr(e,t,n,r){return new Nr(e,t,n,r)}function _r(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Hr(e,t){var n=e.alternate;return null===n?((n=Lr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Vr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,i,o){var a=0;if(r=e,"function"===typeof e)_r(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,z.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case k:return(e=Lr(31,n,t,i)).elementType=k,e.lanes=o,e;case m:return Wr(n.children,i,o,t);case v:a=8,i|=24;break;case w:return(e=Lr(12,n,t,2|i)).elementType=w,e.lanes=o,e;case x:return(e=Lr(13,n,t,i)).elementType=x,e.lanes=o,e;case R:return(e=Lr(19,n,t,i)).elementType=R,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case b:case y:a=10;break e;case C:a=9;break e;case S:a=11;break e;case E:a=14;break e;case T:a=16,r=null;break e}a=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Lr(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Wr(e,t,n,r){return(e=Lr(7,e,r,t)).lanes=n,e}function zr(e,t,n){return(e=Lr(6,e,null,t)).lanes=n,e}function jr(e,t,n){return(t=Lr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gr=[],$r=0,Ur=null,Kr=0,Yr=[],qr=0,Xr=null,Qr=1,Jr="";function Zr(e,t){Gr[$r++]=Kr,Gr[$r++]=Ur,Ur=e,Kr=t}function ei(e,t,n){Yr[qr++]=Qr,Yr[qr++]=Jr,Yr[qr++]=Xr,Xr=e;var r=Qr;e=Jr;var i=32-pe(r)-1;r&=~(1<<i),n+=1;var o=32-pe(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Qr=1<<32-pe(t)+i|n<<i|r,Jr=o+e}else Qr=1<<o|n<<i|r,Jr=e}function ti(e){null!==e.return&&(Zr(e,1),ei(e,1,0))}function ni(e){for(;e===Ur;)Ur=Gr[--$r],Gr[$r]=null,Kr=Gr[--$r],Gr[$r]=null;for(;e===Xr;)Xr=Yr[--qr],Yr[qr]=null,Jr=Yr[--qr],Yr[qr]=null,Qr=Yr[--qr],Yr[qr]=null}var ri=null,ii=null,oi=!1,si=null,ai=!1,li=Error(s(519));function ci(e){throw fi(Rr(Error(s(418,"")),e)),li}function ui(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[De]=e,t[Fe]=r,n){case"dialog":_u("cancel",t),_u("close",t);break;case"iframe":case"object":case"embed":_u("load",t);break;case"video":case"audio":for(n=0;n<Ou.length;n++)_u(Ou[n],t);break;case"source":_u("error",t);break;case"img":case"image":case"link":_u("error",t),_u("load",t);break;case"details":_u("toggle",t);break;case"input":_u("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":_u("invalid",t);break;case"textarea":_u("invalid",t),yt(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||Xu(t.textContent,n)?(null!=r.popover&&(_u("beforetoggle",t),_u("toggle",t)),null!=r.onScroll&&_u("scroll",t),null!=r.onScrollEnd&&_u("scrollend",t),null!=r.onClick&&(t.onclick=Qu),t=!0):t=!1,t||ci(e)}function di(e){for(ri=e.return;ri;)switch(ri.tag){case 5:case 13:return void(ai=!1);case 27:case 3:return void(ai=!0);default:ri=ri.return}}function hi(e){if(e!==ri)return!1;if(!oi)return di(e),oi=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||sd(e.type,e.memoizedProps)),t=!t),t&&ii&&ci(e),di(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ii=vd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ii=null}}else 27===n?(n=ii,pd(e.type)?(e=wd,wd=null,ii=e):ii=n):ii=ri?vd(e.stateNode.nextSibling):null;return!0}function pi(){ii=ri=null,oi=!1}function gi(){var e=si;return null!==e&&(null===bc?bc=e:bc.push.apply(bc,e),si=null),e}function fi(e){null===si?si=[e]:si.push(e)}var mi=V(null),vi=null,wi=null;function bi(e,t,n){W(mi,t._currentValue),t._currentValue=n}function Ci(e){e._currentValue=mi.current,B(mi)}function yi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var a=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),yi(o.return,n,e),r||(a=null);break e}o=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(o=a.alternate)&&(o.lanes|=n),yi(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function xi(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(s(387));if(null!==(a=a.memoizedProps)){var l=i.type;qn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===$.current){if(null===(a=i.alternate))throw Error(s(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Yd):e=[Yd])}i=i.return}null!==e&&Si(t,e,n,r),t.flags|=262144}function Ri(e){for(e=e.firstContext;null!==e;){if(!qn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ei(e){vi=e,wi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Ti(e){return Mi(vi,e)}function ki(e,t){return null===vi&&Ei(e),Mi(e,t)}function Mi(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===wi){if(null===e)throw Error(s(308));wi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else wi=wi.next=t;return n}var Pi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ii=r.unstable_scheduleCallback,Ai=r.unstable_NormalPriority,Di={$$typeof:y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fi(){return{controller:new Pi,data:new Map,refCount:0}}function Oi(e){e.refCount--,0===e.refCount&&Ii(Ai,function(){e.controller.abort()})}var Ni=null,Li=0,_i=0,Hi=null;function Vi(){if(0===--Li&&null!==Ni){null!==Hi&&(Hi.status="fulfilled");var e=Ni;Ni=null,_i=0,Hi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Bi=O.S;O.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Ni){var n=Ni=[];Li=0,_i=Pu(),Hi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Li++,t.then(Vi,Vi)}(0,t),null!==Bi&&Bi(e,t)};var Wi=V(null);function zi(){var e=Wi.current;return null!==e?e:rc.pooledCache}function ji(e,t){W(Wi,null===t?Wi.current:t.pool)}function Gi(){var e=zi();return null===e?null:{parent:Di._currentValue,pool:e}}var $i=Error(s(460)),Ui=Error(s(474)),Ki=Error(s(542)),Yi={then:function(){}};function qi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Xi(){}function Qi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Xi,Xi),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e;default:if("string"===typeof t.status)t.then(Xi,Xi);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e}throw Ji=t,$i}}var Ji=null;function Zi(){if(null===Ji)throw Error(s(459));var e=Ji;return Ji=null,e}function eo(e){if(e===$i||e===Ki)throw Error(s(483))}var to=!1;function no(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function io(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function oo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Fr(e),Dr(e,null,n),t}return Pr(e,r,t,n),Fr(e)}function so(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,ke(e,n)}}function ao(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var lo=!1;function co(){if(lo){if(null!==Hi)throw Hi}}function uo(e,t,n,r){lo=!1;var i=e.updateQueue;to=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var p=-536870913&a.lane,g=p!==a.lane;if(g?(oc&p)===p:(r&p)===p){0!==p&&p===_i&&(lo=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var f=e,m=a;p=t;var v=n;switch(m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(v,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(v,d,p):f)||void 0===p)break e;d=h({},d,p);break e;case 2:to=!0}}null!==(p=a.callback)&&(e.flags|=64,g&&(e.flags|=8192),null===(g=i.callbacks)?i.callbacks=[p]:g.push(p))}else g={lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=g,l=d):u=u.next=g,s|=p;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(g=a).next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===o&&(i.shared.lanes=0),pc|=s,e.lanes=s,e.memoizedState=d}}function ho(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function po(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ho(n[e],t)}var go=V(null),fo=V(0);function mo(e,t){W(fo,e=dc),W(go,t),dc=e|t.baseLanes}function vo(){W(fo,dc),W(go,go.current)}function wo(){dc=fo.current,B(go),B(fo)}var bo=0,Co=null,yo=null,So=null,xo=!1,Ro=!1,Eo=!1,To=0,ko=0,Mo=null,Po=0;function Io(){throw Error(s(321))}function Ao(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!qn(e[n],t[n]))return!1;return!0}function Do(e,t,n,r,i,o){return bo=o,Co=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?Us:Ks,Eo=!1,o=n(r,i),Eo=!1,Ro&&(o=Oo(t,n,r,i)),Fo(e),o}function Fo(e){O.H=$s;var t=null!==yo&&null!==yo.next;if(bo=0,So=yo=Co=null,xo=!1,ko=0,Mo=null,t)throw Error(s(300));null===e||ka||null!==(e=e.dependencies)&&Ri(e)&&(ka=!0)}function Oo(e,t,n,r){Co=e;var i=0;do{if(Ro&&(Mo=null),ko=0,Ro=!1,25<=i)throw Error(s(301));if(i+=1,So=yo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}O.H=Ys,o=t(n,r)}while(Ro);return o}function No(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?Wo(t):t,e=e.useState()[0],(null!==yo?yo.memoizedState:null)!==e&&(Co.flags|=1024),t}function Lo(){var e=0!==To;return To=0,e}function _o(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Ho(e){if(xo){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}xo=!1}bo=0,So=yo=Co=null,Ro=!1,ko=To=0,Mo=null}function Vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===So?Co.memoizedState=So=e:So=So.next=e,So}function Bo(){if(null===yo){var e=Co.alternate;e=null!==e?e.memoizedState:null}else e=yo.next;var t=null===So?Co.memoizedState:So.next;if(null!==t)So=t,yo=e;else{if(null===e){if(null===Co.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(yo=e).memoizedState,baseState:yo.baseState,baseQueue:yo.baseQueue,queue:yo.queue,next:null},null===So?Co.memoizedState=So=e:So=So.next=e}return So}function Wo(e){var t=ko;return ko+=1,null===Mo&&(Mo=[]),e=Qi(Mo,e,t),t=Co,null===(null===So?t.memoizedState:So.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?Us:Ks),e}function zo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return Wo(e);if(e.$$typeof===y)return Ti(e)}throw Error(s(438,String(e)))}function jo(e){var t=null,n=Co.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Co.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Co.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=M;return t.index++,n}function Go(e,t){return"function"===typeof t?t(e):t}function $o(e){return Uo(Bo(),yo,e)}function Uo(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=a=null,c=null,u=t=i.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(oc&h)===h:(bo&h)===h){var p=u.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===_i&&(d=!0);else{if((bo&p)===p){u=u.next,p===_i&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=o):c=c.next=h,Co.lanes|=p,pc|=p}h=u.action,Eo&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else p={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,a=o):c=c.next=p,Co.lanes|=h,pc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?a=o:c.next=l,!qn(o,e.memoizedState)&&(ka=!0,d&&null!==(n=Hi)))throw n;e.memoizedState=o,e.baseState=a,e.baseQueue=c,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Ko(e){var t=Bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);qn(o,t.memoizedState)||(ka=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Yo(e,t,n){var r=Co,i=Bo(),o=oi;if(o){if(void 0===n)throw Error(s(407));n=n()}else n=t();var a=!qn((yo||i).memoizedState,n);if(a&&(i.memoizedState=n,ka=!0),i=i.queue,vs(2048,8,Qo.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==So&&1&So.memoizedState.tag){if(r.flags|=2048,gs(9,{destroy:void 0,resource:void 0},Xo.bind(null,r,i,n,t),null),null===rc)throw Error(s(349));o||0!==(124&bo)||qo(r,t,n)}return n}function qo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Co.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Co.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Xo(e,t,n,r){t.value=n,t.getSnapshot=r,Jo(t)&&Zo(e)}function Qo(e,t,n){return n(function(){Jo(t)&&Zo(e)})}function Jo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!qn(e,n)}catch(r){return!0}}function Zo(e){var t=Ar(e,2);null!==t&&Lc(t,e,2)}function es(e){var t=Vo();if("function"===typeof e){var n=e;if(e=n(),Eo){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:e},t}function ts(e,t,n,r){return e.baseState=n,Uo(e,yo,"function"===typeof r?r:Go)}function ns(e,t,n,r,i){if(zs(e))throw Error(s(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==O.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,rs(t,o)):(o.next=n.next,t.pending=n.next=o)}}function rs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=O.T,s={};O.T=s;try{var a=n(i,r),l=O.S;null!==l&&l(s,a),is(e,t,a)}catch(c){ss(e,t,c)}finally{O.T=o}}else try{is(e,t,o=n(i,r))}catch(u){ss(e,t,u)}}function is(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){os(e,t,n)},function(n){return ss(e,t,n)}):os(e,t,n)}function os(e,t,n){t.status="fulfilled",t.value=n,as(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,rs(e,n)))}function ss(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,as(t),t=t.next}while(t!==r)}e.action=null}function as(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ls(e,t){return t}function cs(e,t){if(oi){var n=rc.formState;if(null!==n){e:{var r=Co;if(oi){if(ii){t:{for(var i=ii,o=ai;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=vd(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){ii=vd(i.nextSibling),r="F!"===i.data;break e}}ci(r)}r=!1}r&&(t=n[0])}}return(n=Vo()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:t},n.queue=r,n=Vs.bind(null,Co,r),r.dispatch=n,r=es(!1),o=Ws.bind(null,Co,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=Vo()).queue=i,n=ns.bind(null,Co,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function us(e){return ds(Bo(),yo,e)}function ds(e,t,n){if(t=Uo(e,t,ls)[0],e=$o(Go)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=Wo(t)}catch(s){if(s===$i)throw Ki;throw s}else r=t;var i=(t=Bo()).queue,o=i.dispatch;return n!==t.memoizedState&&(Co.flags|=2048,gs(9,{destroy:void 0,resource:void 0},hs.bind(null,i,n),null)),[r,o,e]}function hs(e,t){e.action=t}function ps(e){var t=Bo(),n=yo;if(null!==n)return ds(t,n,e);Bo(),t=t.memoizedState;var r=(n=Bo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function gs(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Co.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Co.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function fs(){return Bo().memoizedState}function ms(e,t,n,r){var i=Vo();r=void 0===r?null:r,Co.flags|=e,i.memoizedState=gs(1|t,{destroy:void 0,resource:void 0},n,r)}function vs(e,t,n,r){var i=Bo();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==yo&&null!==r&&Ao(r,yo.memoizedState.deps)?i.memoizedState=gs(t,o,n,r):(Co.flags|=e,i.memoizedState=gs(1|t,o,n,r))}function ws(e,t){ms(8390656,8,e,t)}function bs(e,t){vs(2048,8,e,t)}function Cs(e,t){return vs(4,2,e,t)}function ys(e,t){return vs(4,4,e,t)}function Ss(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function xs(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vs(4,4,Ss.bind(null,t,e),n)}function Rs(){}function Es(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Ao(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ts(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Ao(t,r[1]))return r[0];if(r=e(),Eo){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function ks(e,t,n){return void 0===n||0!==(1073741824&bo)?e.memoizedState=t:(e.memoizedState=n,e=Nc(),Co.lanes|=e,pc|=e,n)}function Ms(e,t,n,r){return qn(n,t)?n:null!==go.current?(e=ks(e,n,r),qn(e,t)||(ka=!0),e):0===(42&bo)?(ka=!0,e.memoizedState=n):(e=Nc(),Co.lanes|=e,pc|=e,t)}function Ps(e,t,n,r,i){var o=N.p;N.p=0!==o&&8>o?o:8;var s=O.T,a={};O.T=a,Ws(e,!1,t,n);try{var l=i(),c=O.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Bs(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Oc());else Bs(e,t,r,Oc())}catch(u){Bs(e,t,{then:function(){},status:"rejected",reason:u},Oc())}finally{N.p=o,O.T=s}}function Is(){}function As(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=Ds(e).queue;Ps(e,i,t,L,null===n?Is:function(){return Fs(e),n(r)})}function Ds(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:L},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Fs(e){Bs(e,Ds(e).next.queue,{},Oc())}function Os(){return Ti(Yd)}function Ns(){return Bo().memoizedState}function Ls(){return Bo().memoizedState}function _s(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Oc(),r=oo(t,e=io(n),n);return null!==r&&(Lc(r,t,n),so(r,t,n)),t={cache:Fi()},void(e.payload=t)}t=t.return}}function Hs(e,t,n){var r=Oc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},zs(e)?js(t,n):null!==(n=Ir(e,t,n,r))&&(Lc(n,e,r),Gs(n,t,r))}function Vs(e,t,n){Bs(e,t,n,Oc())}function Bs(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(zs(e))js(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,qn(a,s))return Pr(e,t,i,0),null===rc&&Mr(),!1}catch(l){}if(null!==(n=Ir(e,t,i,r)))return Lc(n,e,r),Gs(n,t,r),!0}return!1}function Ws(e,t,n,r){if(r={lane:2,revertLane:Pu(),action:r,hasEagerState:!1,eagerState:null,next:null},zs(e)){if(t)throw Error(s(479))}else null!==(t=Ir(e,n,r,2))&&Lc(t,e,2)}function zs(e){var t=e.alternate;return e===Co||null!==t&&t===Co}function js(e,t){Ro=xo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Gs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,ke(e,n)}}var $s={readContext:Ti,use:zo,useCallback:Io,useContext:Io,useEffect:Io,useImperativeHandle:Io,useLayoutEffect:Io,useInsertionEffect:Io,useMemo:Io,useReducer:Io,useRef:Io,useState:Io,useDebugValue:Io,useDeferredValue:Io,useTransition:Io,useSyncExternalStore:Io,useId:Io,useHostTransitionStatus:Io,useFormState:Io,useActionState:Io,useOptimistic:Io,useMemoCache:Io,useCacheRefresh:Io},Us={readContext:Ti,use:zo,useCallback:function(e,t){return Vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:ws,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ms(4194308,4,Ss.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ms(4194308,4,e,t)},useInsertionEffect:function(e,t){ms(4,2,e,t)},useMemo:function(e,t){var n=Vo();t=void 0===t?null:t;var r=e();if(Eo){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Vo();if(void 0!==n){var i=n(t);if(Eo){he(!0);try{n(t)}finally{he(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Hs.bind(null,Co,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Vo().memoizedState=e},useState:function(e){var t=(e=es(e)).queue,n=Vs.bind(null,Co,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Rs,useDeferredValue:function(e,t){return ks(Vo(),e,t)},useTransition:function(){var e=es(!1);return e=Ps.bind(null,Co,e.queue,!0,!1),Vo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Co,i=Vo();if(oi){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===rc)throw Error(s(349));0!==(124&oc)||qo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,ws(Qo.bind(null,r,o,e),[e]),r.flags|=2048,gs(9,{destroy:void 0,resource:void 0},Xo.bind(null,r,o,n,t),null),n},useId:function(){var e=Vo(),t=rc.identifierPrefix;if(oi){var n=Jr;t="\xab"+t+"R"+(n=(Qr&~(1<<32-pe(Qr)-1)).toString(32)+n),0<(n=To++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=Po++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Os,useFormState:cs,useActionState:cs,useOptimistic:function(e){var t=Vo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ws.bind(null,Co,!0,n),n.dispatch=t,[e,t]},useMemoCache:jo,useCacheRefresh:function(){return Vo().memoizedState=_s.bind(null,Co)}},Ks={readContext:Ti,use:zo,useCallback:Es,useContext:Ti,useEffect:bs,useImperativeHandle:xs,useInsertionEffect:Cs,useLayoutEffect:ys,useMemo:Ts,useReducer:$o,useRef:fs,useState:function(){return $o(Go)},useDebugValue:Rs,useDeferredValue:function(e,t){return Ms(Bo(),yo.memoizedState,e,t)},useTransition:function(){var e=$o(Go)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:Wo(e),t]},useSyncExternalStore:Yo,useId:Ns,useHostTransitionStatus:Os,useFormState:us,useActionState:us,useOptimistic:function(e,t){return ts(Bo(),0,e,t)},useMemoCache:jo,useCacheRefresh:Ls},Ys={readContext:Ti,use:zo,useCallback:Es,useContext:Ti,useEffect:bs,useImperativeHandle:xs,useInsertionEffect:Cs,useLayoutEffect:ys,useMemo:Ts,useReducer:Ko,useRef:fs,useState:function(){return Ko(Go)},useDebugValue:Rs,useDeferredValue:function(e,t){var n=Bo();return null===yo?ks(n,e,t):Ms(n,yo.memoizedState,e,t)},useTransition:function(){var e=Ko(Go)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:Wo(e),t]},useSyncExternalStore:Yo,useId:Ns,useHostTransitionStatus:Os,useFormState:ps,useActionState:ps,useOptimistic:function(e,t){var n=Bo();return null!==yo?ts(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:jo,useCacheRefresh:Ls},qs=null,Xs=0;function Qs(e){var t=Xs;return Xs+=1,null===qs&&(qs=[]),Qi(qs,e,t)}function Js(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Zs(e,t){if(t.$$typeof===p)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ea(e){return(0,e._init)(e._payload)}function ta(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Hr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=zr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===m?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===T&&ea(o)===t.type)?(Js(t=i(t,n.props),n),t.return=e,t):(Js(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Wr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=zr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case g:return Js(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case f:return(t=jr(t,e.mode,n)).return=e,t;case T:return h(e,t=(0,t._init)(t._payload),n)}if(F(t)||I(t))return(t=Wr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Qs(t),n);if(t.$$typeof===y)return h(e,ki(e,t),n);Zs(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case g:return n.key===i?c(e,t,n,r):null;case f:return n.key===i?u(e,t,n,r):null;case T:return p(e,t,n=(i=n._init)(n._payload),r)}if(F(n)||I(n))return null!==i?null:d(e,t,n,r,null);if("function"===typeof n.then)return p(e,t,Qs(n),r);if(n.$$typeof===y)return p(e,t,ki(e,n),r);Zs(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case g:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case f:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case T:return v(e,t,n,r=(0,r._init)(r._payload),i)}if(F(r)||I(r))return d(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return v(e,t,n,Qs(r),i);if(r.$$typeof===y)return v(e,t,n,ki(t,r),i);Zs(t,r)}return null}function w(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===m&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case g:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===m){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===T&&ea(b)===c.type){n(l,c.sibling),Js(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===m?((d=Wr(u.props.children,l.mode,d,u.key)).return=l,l=d):(Js(d=Br(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return a(l);case f:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=jr(u,l.mode,d)).return=l,l=d}return a(l);case T:return w(l,c,u=(b=u._init)(u._payload),d)}if(F(u))return function(i,s,a,l){for(var c=null,u=null,d=s,g=s=0,f=null;null!==d&&g<a.length;g++){d.index>g?(f=d,d=null):f=d.sibling;var m=p(i,d,a[g],l);if(null===m){null===d&&(d=f);break}e&&d&&null===m.alternate&&t(i,d),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m,d=f}if(g===a.length)return n(i,d),oi&&Zr(i,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(s=o(d,s,g),null===u?c=d:u.sibling=d,u=d);return oi&&Zr(i,g),c}for(d=r(d);g<a.length;g++)null!==(f=v(d,i,g,a[g],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?g:f.key),s=o(f,s,g),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach(function(e){return t(i,e)}),oi&&Zr(i,g),c}(l,c,u,d);if(I(u)){if("function"!==typeof(b=I(u)))throw Error(s(150));return function(i,a,l,c){if(null==l)throw Error(s(151));for(var u=null,d=null,g=a,f=a=0,m=null,w=l.next();null!==g&&!w.done;f++,w=l.next()){g.index>f?(m=g,g=null):m=g.sibling;var b=p(i,g,w.value,c);if(null===b){null===g&&(g=m);break}e&&g&&null===b.alternate&&t(i,g),a=o(b,a,f),null===d?u=b:d.sibling=b,d=b,g=m}if(w.done)return n(i,g),oi&&Zr(i,f),u;if(null===g){for(;!w.done;f++,w=l.next())null!==(w=h(i,w.value,c))&&(a=o(w,a,f),null===d?u=w:d.sibling=w,d=w);return oi&&Zr(i,f),u}for(g=r(g);!w.done;f++,w=l.next())null!==(w=v(g,i,f,w.value,c))&&(e&&null!==w.alternate&&g.delete(null===w.key?f:w.key),a=o(w,a,f),null===d?u=w:d.sibling=w,d=w);return e&&g.forEach(function(e){return t(i,e)}),oi&&Zr(i,f),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return w(l,c,Qs(u),d);if(u.$$typeof===y)return w(l,c,ki(l,u),d);Zs(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=zr(u,l.mode,d)).return=l,l=d),a(l)):n(l,c)}return function(e,t,n,r){try{Xs=0;var i=w(e,t,n,r);return qs=null,i}catch(s){if(s===$i||s===Ki)throw s;var o=Lr(29,s,null,e.mode);return o.lanes=r,o.return=e,o}}}var na=ta(!0),ra=ta(!1),ia=V(null),oa=null;function sa(e){var t=e.alternate;W(ua,1&ua.current),W(ia,e),null===oa&&(null===t||null!==go.current||null!==t.memoizedState)&&(oa=e)}function aa(e){if(22===e.tag){if(W(ua,ua.current),W(ia,e),null===oa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(oa=e)}}else la()}function la(){W(ua,ua.current),W(ia,ia.current)}function ca(e){B(ia),oa===e&&(oa=null),B(ua)}var ua=V(0);function da(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||md(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var pa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Oc(),i=io(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Lc(t,e,r),so(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Oc(),i=io(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Lc(t,e,r),so(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Oc(),r=io(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=oo(e,r,n))&&(Lc(t,e,n),so(t,e,n))}};function ga(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!Xn(n,r)||!Xn(i,o))}function fa(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&pa.enqueueReplaceState(t,t.state,null)}function ma(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=h({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var va="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function wa(e){va(e)}function ba(e){console.error(e)}function Ca(e){va(e)}function ya(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Sa(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function xa(e,t,n){return(n=io(n)).tag=3,n.payload={element:null},n.callback=function(){ya(e,t)},n}function Ra(e){return(e=io(e)).tag=3,e}function Ea(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Sa(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Sa(t,n,r),"function"!==typeof i&&(null===Rc?Rc=new Set([this]):Rc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ta=Error(s(461)),ka=!1;function Ma(e,t,n,r){t.child=null===e?ra(t,null,n,r):na(t,e.child,n,r)}function Pa(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Ei(t),r=Do(e,t,n,s,o,i),a=Lo(),null===e||ka?(oi&&a&&ti(t),t.flags|=1,Ma(e,t,r,i),t.child):(_o(e,t,i),qa(e,t,i))}function Ia(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||_r(o)||void 0!==o.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Aa(e,t,o,r,i))}if(o=e.child,!Xa(e,i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:Xn)(s,r)&&e.ref===t.ref)return qa(e,t,i)}return t.flags|=1,(e=Hr(o,r)).ref=t.ref,e.return=t,t.child=e}function Aa(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(Xn(o,r)&&e.ref===t.ref){if(ka=!1,t.pendingProps=r=o,!Xa(e,i))return t.lanes=e.lanes,qa(e,t,i);0!==(131072&e.flags)&&(ka=!0)}}return Na(e,t,n,r,i)}function Da(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,o=0;null!==i;)o=o|i.lanes|i.childLanes,i=i.sibling;t.childLanes=o&~r}else t.childLanes=0,t.child=null;return Fa(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Fa(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&ji(0,null!==o?o.cachePool:null),null!==o?mo(t,o):vo(),aa(t)}else null!==o?(ji(0,o.cachePool),mo(t,o),la(),t.memoizedState=null):(null!==e&&ji(0,null),vo(),la());return Ma(e,t,i,n),t.child}function Fa(e,t,n,r){var i=zi();return i=null===i?null:{parent:Di._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&ji(0,null),vo(),aa(t),null!==e&&xi(e,t,r,!0),null}function Oa(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Na(e,t,n,r,i){return Ei(t),n=Do(e,t,n,r,void 0,i),r=Lo(),null===e||ka?(oi&&r&&ti(t),t.flags|=1,Ma(e,t,n,i),t.child):(_o(e,t,i),qa(e,t,i))}function La(e,t,n,r,i,o){return Ei(t),t.updateQueue=null,n=Oo(t,r,n,i),Fo(e),r=Lo(),null===e||ka?(oi&&r&&ti(t),t.flags|=1,Ma(e,t,n,o),t.child):(_o(e,t,o),qa(e,t,o))}function _a(e,t,n,r,i){if(Ei(t),null===t.stateNode){var o=Or,s=n.contextType;"object"===typeof s&&null!==s&&(o=Ti(s)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=pa,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},no(t),s=n.contextType,o.context="object"===typeof s&&null!==s?Ti(s):Or,o.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ha(t,n,s,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(s=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&pa.enqueueReplaceState(o,o.state,null),uo(t,r,o,i),co(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var a=t.memoizedProps,l=ma(n,a);o.props=l;var c=o.context,u=n.contextType;s=Or,"object"===typeof u&&null!==u&&(s=Ti(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||c!==s)&&fa(t,o,r,s),to=!1;var h=t.memoizedState;o.state=h,uo(t,r,o,i),co(),c=t.memoizedState,a||h!==c||to?("function"===typeof d&&(ha(t,n,d,r),c=t.memoizedState),(l=to||ga(t,n,l,r,h,c,s))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=l):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ro(e,t),u=ma(n,s=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=n.contextType,l=Or,"object"===typeof c&&null!==c&&(l=Ti(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==l)&&fa(t,o,r,l),to=!1,h=t.memoizedState,o.state=h,uo(t,r,o,i),co();var p=t.memoizedState;s!==d||h!==p||to||null!==e&&null!==e.dependencies&&Ri(e.dependencies)?("function"===typeof a&&(ha(t,n,a,r),p=t.memoizedState),(u=to||ga(t,n,u,r,h,p,l)||null!==e&&null!==e.dependencies&&Ri(e.dependencies))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Oa(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=na(t,e.child,null,i),t.child=na(t,null,n,i)):Ma(e,t,n,i),t.memoizedState=o.state,e=t.child):e=qa(e,t,i),e}function Ha(e,t,n,r){return pi(),t.flags|=256,Ma(e,t,n,r),t.child}var Va={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ba(e){return{baseLanes:e,cachePool:Gi()}}function Wa(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=mc),e}function za(e,t,n){var r,i=t.pendingProps,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&ua.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(oi){if(o?sa(t):la(),oi){var l,c=ii;if(l=c){e:{for(l=c,c=ai;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==Xr?{id:Qr,overflow:Jr}:null,retryLane:536870912,hydrationErrors:null},(l=Lr(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ri=t,ii=null,l=!0):l=!1}l||ci(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return md(c)?t.lanes=32:t.lanes=536870912,null;ca(t)}return c=i.children,i=i.fallback,o?(la(),c=Ga({mode:"hidden",children:c},o=t.mode),i=Wr(i,o,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(o=t.child).memoizedState=Ba(n),o.childLanes=Wa(e,r,n),t.memoizedState=Va,i):(sa(t),ja(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(sa(t),t.flags&=-257,t=$a(e,t,n)):null!==t.memoizedState?(la(),t.child=e.child,t.flags|=128,t=null):(la(),o=i.fallback,c=t.mode,i=Ga({mode:"visible",children:i.children},c),(o=Wr(o,c,n,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,na(t,e.child,null,n),(i=t.child).memoizedState=Ba(n),i.childLanes=Wa(e,r,n),t.memoizedState=Va,t=o);else if(sa(t),md(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,fi({value:i,source:null,stack:null}),t=$a(e,t,n)}else if(ka||xi(e,t,n,!1),r=0!==(n&e.childLanes),ka||r){if(null!==(r=rc)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Me(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Ar(e,i),Lc(r,e,i),Ta;"$?"===c.data||Kc(),t=$a(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=vd(c.nextSibling),ri=t,oi=!0,si=null,ai=!1,null!==e&&(Yr[qr++]=Qr,Yr[qr++]=Jr,Yr[qr++]=Xr,Qr=e.id,Jr=e.overflow,Xr=t),(t=ja(t,i.children)).flags|=4096);return t}return o?(la(),o=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Hr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?o=Hr(u,o):(o=Wr(o,c,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,null===(c=e.child.memoizedState)?c=Ba(n):(null!==(l=c.cachePool)?(u=Di._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Gi(),c={baseLanes:c.baseLanes|n,cachePool:l}),o.memoizedState=c,o.childLanes=Wa(e,r,n),t.memoizedState=Va,i):(sa(t),e=(n=e.child).sibling,(n=Hr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function ja(e,t){return(t=Ga({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ga(e,t){return(e=Lr(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function $a(e,t,n){return na(t,e.child,null,n),(e=ja(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ua(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),yi(e.return,t,n)}function Ka(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ya(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ma(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ua(e,n,t);else if(19===e.tag)Ua(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(W(ua,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===da(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ka(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===da(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ka(t,!0,n,null,o);break;case"together":Ka(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),pc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(xi(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Hr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Hr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Xa(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ri(e))}function Qa(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)ka=!0;else{if(!Xa(e,n)&&0===(128&t.flags))return ka=!1,function(e,t,n){switch(t.tag){case 3:U(t,t.stateNode.containerInfo),bi(0,Di,e.memoizedState.cache),pi();break;case 27:case 5:Y(t);break;case 4:U(t,t.stateNode.containerInfo);break;case 10:bi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(sa(t),t.flags|=128,null):0!==(n&t.child.childLanes)?za(e,t,n):(sa(t),null!==(e=qa(e,t,n))?e.sibling:null);sa(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(xi(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Ya(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),W(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,Da(e,t,n);case 24:bi(0,Di,e.memoizedState.cache)}return qa(e,t,n)}(e,t,n);ka=0!==(131072&e.flags)}else ka=!1,oi&&0!==(1048576&t.flags)&&ei(t,Kr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===S){t.tag=11,t=Pa(null,t,r,e,n);break e}if(i===E){t.tag=14,t=Ia(null,t,r,e,n);break e}}throw t=D(r)||r,Error(s(306,t,""))}_r(r)?(e=ma(r,e),t.tag=1,t=_a(null,t,r,e,n)):(t.tag=0,t=Na(null,t,r,e,n))}return t;case 0:return Na(e,t,t.type,t.pendingProps,n);case 1:return _a(e,t,r=t.type,i=ma(r,t.pendingProps),n);case 3:e:{if(U(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,ro(e,t),uo(t,r,null,n);var a=t.memoizedState;if(r=a.cache,bi(0,Di,r),r!==o.cache&&Si(t,[Di],n,!0),co(),r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ha(e,t,r,n);break e}if(r!==i){fi(i=Rr(Error(s(424)),t)),t=Ha(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=vd(e.firstChild),ri=t,oi=!0,si=null,ai=!0,n=ra(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===i){t=qa(e,t,n);break e}Ma(e,t,r,n)}t=t.child}return t;case 26:return Oa(e,t),null===e?(n=Md(t.type,null,t.pendingProps,null))?t.memoizedState=n:oi||(n=t.type,e=t.pendingProps,(r=rd(G.current).createElement(n))[De]=t,r[Fe]=e,ed(r,n,e),$e(r),t.stateNode=r):t.memoizedState=Md(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Y(t),null===e&&oi&&(r=t.stateNode=Cd(t.type,t.pendingProps,G.current),ri=t,ai=!0,i=ii,pd(t.type)?(wd=i,ii=vd(r.firstChild)):ii=i),Ma(e,t,t.pendingProps.children,n),Oa(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&oi&&((i=r=ii)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ve])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=vd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,ai))?(t.stateNode=r,ri=t,ii=vd(r.firstChild),ai=!1,i=!0):i=!1),i||ci(t)),Y(t),i=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,r=o.children,sd(i,o)?r=null:null!==a&&sd(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=Do(e,t,No,null,null,n),Yd._currentValue=i),Oa(e,t),Ma(e,t,r,n),t.child;case 6:return null===e&&oi&&((e=n=ii)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(n,t.pendingProps,ai))?(t.stateNode=n,ri=t,ii=null,e=!0):e=!1),e||ci(t)),null;case 13:return za(e,t,n);case 4:return U(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=na(t,null,r,n):Ma(e,t,r,n),t.child;case 11:return Pa(e,t,t.type,t.pendingProps,n);case 7:return Ma(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ma(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,bi(0,t.type,r.value),Ma(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ei(t),r=r(i=Ti(i)),t.flags|=1,Ma(e,t,r,n),t.child;case 14:return Ia(e,t,t.type,t.pendingProps,n);case 15:return Aa(e,t,t.type,t.pendingProps,n);case 19:return Ya(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=Ga(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Hr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Da(e,t,n);case 24:return Ei(t),r=Ti(Di),null===e?(null===(i=zi())&&(i=rc,o=Fi(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},no(t),bi(0,Di,i)):(0!==(e.lanes&n)&&(ro(e,t),uo(t,null,null,n),co()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),bi(0,Di,r)):(r=o.cache,bi(0,Di,r),r!==i.cache&&Si(t,[Di],n,!0))),Ma(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Ja(e){e.flags|=4}function Za(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Wd(t)){if(null!==(t=ia.current)&&((4194048&oc)===oc?null!==oa:(62914560&oc)!==oc&&0===(536870912&oc)||t!==oa))throw Ji=Yi,Ui;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?xe():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ci(Di),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?Ja(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,gi())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Ja(t),null!==n?(nl(t),Za(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Ja(t),nl(t),Za(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Ja(t),nl(t),t.flags&=-16777217),null;case 27:q(t),n=G.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ja(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}e=z.current,hi(t)?ui(t):(e=Cd(i,r,n),t.stateNode=e,Ja(t))}return nl(t),null;case 5:if(q(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ja(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}if(e=z.current,hi(t))ui(t);else{switch(i=rd(G.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[De]=t,e[Fe]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(ed(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ja(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Ja(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=G.current,hi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ri))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[De]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||Xu(e.nodeValue,n)))||ci(t)}else(e=rd(e).createTextNode(r))[De]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[De]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),i=!1}else i=gi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ca(t),t):(ca(t),null)}if(ca(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var o=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return K(),null===e&&Bu(t.stateNode.containerInfo),nl(t),null;case 10:return Ci(t.type),nl(t),null;case 19:if(B(ua),null===(i=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)tl(i,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=da(e))){for(t.flags|=128,tl(i,!1),e=o.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Vr(n,e),n=n.sibling;return W(ua,1&ua.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=da(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!oi)return nl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=ua.current,W(ua,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return ca(t),wo(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Wi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ci(Di),nl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function il(e,t){switch(ni(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ci(Di),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return q(t),null;case 13:if(ca(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(ua),null;case 4:return K(),null;case 10:return Ci(t.type),null;case 22:case 23:return ca(t),wo(),null!==e&&B(Wi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ci(Di),null;default:return null}}function ol(e,t){switch(ni(t),t.tag){case 3:Ci(Di),K();break;case 26:case 27:case 5:q(t);break;case 4:K();break;case 13:ca(t);break;case 19:B(ua);break;case 10:Ci(t.type);break;case 22:case 23:ca(t),wo(),null!==e&&B(Wi);break;case 24:Ci(Di)}}function sl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(a){uu(t,t.return,a)}}function al(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(u){uu(i,l,u)}}}r=r.next}while(r!==o)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{po(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=ma(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){uu(e,t,i)}}function dl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){uu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){uu(e,t,o)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){uu(e,e.return,i)}}function pl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,a=null,l=null,c=null,u=null,d=null;for(g in n){var h=n[g];if(n.hasOwnProperty(g)&&null!=h)switch(g){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(g)||Ju(e,t,g,null,r,h)}}for(var p in r){var g=r[p];if(h=n[p],r.hasOwnProperty(p)&&(null!=g||null!=h))switch(p){case"type":o=g;break;case"name":i=g;break;case"checked":u=g;break;case"defaultChecked":d=g;break;case"value":a=g;break;case"defaultValue":l=g;break;case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(s(137,t));break;default:g!==h&&Ju(e,t,p,g,r,h)}}return void mt(e,a,l,c,u,d,o,i);case"select":for(o in g=a=l=p=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":g=c;default:r.hasOwnProperty(o)||Ju(e,t,o,null,r,c)}for(i in r)if(o=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":p=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==c&&Ju(e,t,i,o,r,c)}return t=l,n=a,r=g,void(null!=p?bt(e,!!n,p,!1):!!r!==!!n&&(null!=t?bt(e,!!n,t,!0):bt(e,!!n,n?[]:"",!1)));case"textarea":for(l in g=p=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Ju(e,t,l,null,r,i)}for(a in r)if(i=r[a],o=n[a],r.hasOwnProperty(a)&&(null!=i||null!=o))switch(a){case"value":p=i;break;case"defaultValue":g=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==o&&Ju(e,t,a,i,r,o)}return void Ct(e,p,g);case"option":for(var f in n)if(p=n[f],n.hasOwnProperty(f)&&null!=p&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else Ju(e,t,f,null,r,p);for(c in r)if(p=r[c],g=n[c],r.hasOwnProperty(c)&&p!==g&&(null!=p||null!=g))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else Ju(e,t,c,p,r,g);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)p=n[m],n.hasOwnProperty(m)&&null!=p&&!r.hasOwnProperty(m)&&Ju(e,t,m,null,r,p);for(u in r)if(p=r[u],g=n[u],r.hasOwnProperty(u)&&p!==g&&(null!=p||null!=g))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:Ju(e,t,u,p,r,g)}return;default:if(Tt(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!r.hasOwnProperty(v)&&Zu(e,t,v,void 0,r,p);for(d in r)p=r[d],g=n[d],!r.hasOwnProperty(d)||p===g||void 0===p&&void 0===g||Zu(e,t,d,p,r,g);return}}for(var w in n)p=n[w],n.hasOwnProperty(w)&&null!=p&&!r.hasOwnProperty(w)&&Ju(e,t,w,null,r,p);for(h in r)p=r[h],g=n[h],!r.hasOwnProperty(h)||p===g||null==p&&null==g||Ju(e,t,h,p,r,g)}(r,e.type,n,t),r[Fe]=t}catch(i){uu(e,e.return,i)}}function gl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&pd(e.type)||4===e.tag}function fl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&pd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ml(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qu));else if(4!==r&&(27===r&&pd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(ml(e,t,n),e=e.sibling;null!==e;)ml(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&pd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function wl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);ed(t,r,n),t[De]=e,t[Fe]=n}catch(o){uu(e,e.return,o)}}var bl=!1,Cl=!1,yl=!1,Sl="function"===typeof WeakSet?WeakSet:Set,xl=null;function Rl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:_l(e,n),4&r&&sl(5,n);break;case 1:if(_l(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){uu(n,n.return,s)}else{var i=ma(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){uu(n,n.return,a)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(_l(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{po(e,t)}catch(s){uu(n,n.return,s)}}break;case 27:null===t&&4&r&&wl(n);case 26:case 5:_l(e,n),null===t&&4&r&&hl(n),512&r&&ul(n,n.return);break;case 12:_l(e,n);break;case 13:_l(e,n),4&r&&Il(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=gu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||bl)){t=null!==t&&null!==t.memoizedState||Cl,i=bl;var o=Cl;bl=r,(Cl=t)&&!o?Vl(e,n,0!==(8772&n.subtreeFlags)):_l(e,n),bl=i,Cl=o}break;case 30:break;default:_l(e,n)}}function El(e){var t=e.alternate;null!==t&&(e.alternate=null,El(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Tl=null,kl=!1;function Ml(e,t,n){for(n=n.child;null!==n;)Pl(e,t,n),n=n.sibling}function Pl(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(o){}switch(n.tag){case 26:Cl||dl(n,t),Ml(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Cl||dl(n,t);var r=Tl,i=kl;pd(n.type)&&(Tl=n.stateNode,kl=!1),Ml(e,t,n),yd(n.stateNode),Tl=r,kl=i;break;case 5:Cl||dl(n,t);case 6:if(r=Tl,i=kl,Tl=null,Ml(e,t,n),kl=i,null!==(Tl=r))if(kl)try{(9===Tl.nodeType?Tl.body:"HTML"===Tl.nodeName?Tl.ownerDocument.body:Tl).removeChild(n.stateNode)}catch(s){uu(n,t,s)}else try{Tl.removeChild(n.stateNode)}catch(s){uu(n,t,s)}break;case 18:null!==Tl&&(kl?(gd(9===(e=Tl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),kh(e)):gd(Tl,n.stateNode));break;case 4:r=Tl,i=kl,Tl=n.stateNode.containerInfo,kl=!0,Ml(e,t,n),Tl=r,kl=i;break;case 0:case 11:case 14:case 15:Cl||al(2,n,t),Cl||al(4,n,t),Ml(e,t,n);break;case 1:Cl||(dl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),Ml(e,t,n);break;case 21:Ml(e,t,n);break;case 22:Cl=(r=Cl)||null!==n.memoizedState,Ml(e,t,n),Cl=r;break;default:Ml(e,t,n)}}function Il(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{kh(e)}catch(n){uu(t,t.return,n)}}function Al(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){var r=fu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function Dl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(pd(l.type)){Tl=l.stateNode,kl=!1;break e}break;case 5:Tl=l.stateNode,kl=!1;break e;case 3:case 4:Tl=l.stateNode.containerInfo,kl=!0;break e}l=l.return}if(null===Tl)throw Error(s(160));Pl(o,a,i),Tl=null,kl=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ol(t,e),t=t.sibling}var Fl=null;function Ol(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Dl(t,e),Nl(e),4&r&&(al(3,e,e.return),sl(3,e),al(5,e,e.return));break;case 1:Dl(t,e),Nl(e),512&r&&(Cl||null===n||dl(n,n.return)),64&r&&bl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Fl;if(Dl(t,e),Nl(e),512&r&&(Cl||null===n||dl(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Ve]||o[De]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),ed(o,r,n),o[De]=e,$e(o),r=o;break e;case"link":var a=Vd("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}ed(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(a=Vd("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}ed(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(s(468,r))}o[De]=e,$e(o),r=o}e.stateNode=r}else Bd(i,e.type,e.stateNode);else e.stateNode=Od(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?Bd(i,e.type,e.stateNode):Od(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&pl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Dl(t,e),Nl(e),512&r&&(Cl||null===n||dl(n,n.return)),null!==n&&4&r&&pl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Dl(t,e),Nl(e),512&r&&(Cl||null===n||dl(n,n.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(g){uu(e,e.return,g)}}4&r&&null!=e.stateNode&&pl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(yl=!0);break;case 6:if(Dl(t,e),Nl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(g){uu(e,e.return,g)}}break;case 3:if(Hd=null,i=Fl,Fl=Rd(t.containerInfo),Dl(t,e),Fl=i,Nl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{kh(t.containerInfo)}catch(g){uu(e,e.return,g)}yl&&(yl=!1,Ll(e));break;case 4:r=Fl,Fl=Rd(e.stateNode.containerInfo),Dl(t,e),Nl(e),Fl=r;break;case 12:default:Dl(t,e),Nl(e);break;case 13:Dl(t,e),Nl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(yc=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Al(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=bl,d=Cl;if(bl=u||i,Cl=d||c,Dl(t,e),Cl=d,bl=u,Nl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||bl||Cl||Hl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(g){uu(c,c.return,g)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(g){uu(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Al(e,n))));break;case 19:Dl(t,e),Nl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Al(e,r)));case 30:case 21:}}function Nl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(gl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;vl(e,fl(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(St(o,""),n.flags&=-33),vl(e,fl(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;ml(e,fl(e),a);break;default:throw Error(s(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ll(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ll(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function _l(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Rl(e,t.alternate,t),t=t.sibling}function Hl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:al(4,t,t.return),Hl(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Hl(t);break;case 27:yd(t.stateNode);case 26:case 5:dl(t,t.return),Hl(t);break;case 22:null===t.memoizedState&&Hl(t);break;default:Hl(t)}e=e.sibling}}function Vl(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:Vl(i,o,n),sl(4,o);break;case 1:if(Vl(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(i=(r=o).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)ho(l[i],a)}catch(c){uu(r,r.return,c)}}n&&64&s&&ll(o),ul(o,o.return);break;case 27:wl(o);case 26:case 5:Vl(i,o,n),n&&null===r&&4&s&&hl(o),ul(o,o.return);break;case 12:Vl(i,o,n);break;case 13:Vl(i,o,n),n&&4&s&&Il(i,o);break;case 22:null===o.memoizedState&&Vl(i,o,n),ul(o,o.return);break;case 30:break;default:Vl(i,o,n)}t=t.sibling}}function Bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Oi(n))}function Wl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e))}function zl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)jl(e,t,n,r),t=t.sibling}function jl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:zl(e,t,n,r),2048&i&&sl(9,t);break;case 1:case 13:default:zl(e,t,n,r);break;case 3:zl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Oi(e)));break;case 12:if(2048&i){zl(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;"function"===typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else zl(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?zl(e,t,n,r):$l(e,t):2&o._visibility?zl(e,t,n,r):(o._visibility|=2,Gl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Bl(s,t);break;case 24:zl(e,t,n,r),2048&i&&Wl(t.alternate,t)}}function Gl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,a=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Gl(o,s,a,l,i),sl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Gl(o,s,a,l,i):$l(o,s):(u._visibility|=2,Gl(o,s,a,l,i)),i&&2048&c&&Bl(s.alternate,s);break;case 24:Gl(o,s,a,l,i),i&&2048&c&&Wl(s.alternate,s);break;default:Gl(o,s,a,l,i)}t=t.sibling}}function $l(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:$l(n,r),2048&i&&Bl(r.alternate,r);break;case 24:$l(n,r),2048&i&&Wl(r.alternate,r);break;default:$l(n,r)}t=t.sibling}}var Ul=8192;function Kl(e){if(e.subtreeFlags&Ul)for(e=e.child;null!==e;)Yl(e),e=e.sibling}function Yl(e){switch(e.tag){case 26:Kl(e),e.flags&Ul&&null!==e.memoizedState&&function(e,t,n){if(null===zd)throw Error(s(475));var r=zd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=Pd(n.href),o=e.querySelector(Id(i));if(o)return null!==(e=o._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Gd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=o,void $e(o);o=e.ownerDocument||e,n=Ad(n),(i=Sd.get(i))&&Ld(n,i),$e(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),ed(o,"link",n),t.instance=o}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Gd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Fl,e.memoizedState,e.memoizedProps);break;case 5:default:Kl(e);break;case 3:case 4:var t=Fl;Fl=Rd(e.stateNode.containerInfo),Kl(e),Fl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Ul,Ul=16777216,Kl(e),Ul=t):Kl(e))}}function ql(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Xl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xl=r,Zl(r,e)}ql(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Ql(e),e=e.sibling}function Ql(e){switch(e.tag){case 0:case 11:case 15:Xl(e),2048&e.flags&&al(9,e,e.return);break;case 3:case 12:default:Xl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Jl(e)):Xl(e)}}function Jl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];xl=r,Zl(r,e)}ql(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:al(8,t,t.return),Jl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Jl(t));break;default:Jl(t)}e=e.sibling}}function Zl(e,t){for(;null!==xl;){var n=xl;switch(n.tag){case 0:case 11:case 15:al(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Oi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,xl=r;else e:for(n=e;null!==xl;){var i=(r=xl).sibling,o=r.return;if(El(r),r===n){xl=null;break e}if(null!==i){i.return=o,xl=i;break e}xl=o}}}var ec={getCacheForType:function(e){var t=Ti(Di),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ic=null,oc=0,sc=0,ac=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,pc=0,gc=0,fc=0,mc=0,vc=0,wc=null,bc=null,Cc=!1,yc=0,Sc=1/0,xc=null,Rc=null,Ec=0,Tc=null,kc=null,Mc=0,Pc=0,Ic=null,Ac=null,Dc=0,Fc=null;function Oc(){if(0!==(2&nc)&&0!==oc)return oc&-oc;if(null!==O.T){return 0!==_i?_i:Pu()}return Ie()}function Nc(){0===mc&&(mc=0===(536870912&oc)||oi?Se():536870912);var e=ia.current;return null!==e&&(e.flags|=32),mc}function Lc(e,t,n){(e!==rc||2!==sc&&9!==sc)&&null===e.cancelPendingCommit||(jc(e,0),Bc(e,oc,mc,!1)),Ee(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(gc|=n),4===hc&&Bc(e,oc,mc,!1)),Su(e))}function _c(e,t,n){if(0!==(6&nc))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||Ce(e,t),i=r?function(e,t){var n=nc;nc|=2;var r=$c(),i=Uc();rc!==e||oc!==t?(xc=null,Sc=te()+500,jc(e,t)):cc=Ce(e,t);e:for(;;)try{if(0!==sc&&null!==ic){t=ic;var o=ac;t:switch(sc){case 1:sc=0,ac=null,Zc(e,t,o,1);break;case 2:case 9:if(qi(o)){sc=0,ac=null,Jc(t);break}t=function(){2!==sc&&9!==sc||rc!==e||(sc=7),Su(e)},o.then(t,t);break e;case 3:sc=7;break e;case 4:sc=5;break e;case 7:qi(o)?(sc=0,ac=null,Jc(t)):(sc=0,ac=null,Zc(e,t,o,7));break;case 5:var a=null;switch(ic.tag){case 26:a=ic.memoizedState;case 5:case 27:var l=ic;if(!a||Wd(a)){sc=0,ac=null;var c=l.sibling;if(null!==c)ic=c;else{var u=l.return;null!==u?(ic=u,eu(u)):ic=null}break t}}sc=0,ac=null,Zc(e,t,o,5);break;case 6:sc=0,ac=null,Zc(e,t,o,6);break;case 8:zc(),hc=6;break e;default:throw Error(s(462))}}Xc();break}catch(d){Gc(e,d)}return wi=vi=null,O.H=r,O.A=i,nc=n,null!==ic?0:(rc=null,oc=0,Mr(),hc)}(e,t):Yc(e,t,!0),o=r;;){if(0===i){cc&&!r&&Bc(e,t,0,!1);break}if(n=e.current.alternate,!o||Vc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=wc;var c=l.current.memoizedState.isDehydrated;if(c&&(jc(l,a).flags|=256),2!==(a=Yc(l,a,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=o,gc|=o,i=4;break e}o=bc,bc=i,null!==o&&(null===bc?bc=o:bc.push.apply(bc,o))}i=a}if(o=!1,2!==i)continue}}if(1===i){jc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Bc(r,t,mc,!lc);break e;case 2:bc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=yc+300-te())){if(Bc(r,t,mc,!lc),0!==be(r,0,!0))break e;r.timeoutHandle=ld(Hc.bind(null,r,n,bc,xc,Cc,t,mc,gc,vc,lc,o,2,-0,0),i)}else Hc(r,n,bc,xc,Cc,t,mc,gc,vc,lc,o,0,-0,0)}break}i=Yc(e,t,!1),o=!1}Su(e)}function Hc(e,t,n,r,i,o,a,l,c,u,d,h,p,g){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(zd={stylesheets:null,count:0,unsuspend:jd},Yl(t),null!==(h=function(){if(null===zd)throw Error(s(475));var e=zd;return e.stylesheets&&0===e.count&&Ud(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Ud(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nu.bind(null,e,t,o,n,r,i,a,l,c,d,1,p,g)),void Bc(e,o,a,!u);nu(e,t,o,n,r,i,a,l,c)}function Vc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!qn(o(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,r){t&=~fc,t&=~gc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-pe(i),s=1<<o;r[o]=-1,i&=~s}0!==n&&Te(e,n,t)}function Wc(){return 0!==(6&nc)||(xu(0,!1),!1)}function zc(){if(null!==ic){if(0===sc)var e=ic.return;else wi=vi=null,Ho(e=ic),qs=null,Xs=0,e=ic;for(;null!==e;)ol(e.alternate,e),e=e.return;ic=null}}function jc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zc(),rc=e,ic=n=Hr(e.current,null),oc=t,sc=0,ac=null,lc=!1,cc=Ce(e,t),uc=!1,vc=mc=fc=gc=pc=hc=0,bc=wc=null,Cc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-pe(r),o=1<<i;t|=e[i],r&=~o}return dc=t,Mr(),n}function Gc(e,t){Co=null,O.H=$s,t===$i||t===Ki?(t=Zi(),sc=3):t===Ui?(t=Zi(),sc=4):sc=t===Ta?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ac=t,null===ic&&(hc=1,ya(e,Rr(t,e.current)))}function $c(){var e=O.H;return O.H=$s,null===e?$s:e}function Uc(){var e=O.A;return O.A=ec,e}function Kc(){hc=4,lc||(4194048&oc)!==oc&&null!==ia.current||(cc=!0),0===(134217727&pc)&&0===(134217727&gc)||null===rc||Bc(rc,oc,mc,!1)}function Yc(e,t,n){var r=nc;nc|=2;var i=$c(),o=Uc();rc===e&&oc===t||(xc=null,jc(e,t)),t=!1;var s=hc;e:for(;;)try{if(0!==sc&&null!==ic){var a=ic,l=ac;switch(sc){case 8:zc(),s=6;break e;case 3:case 2:case 9:case 6:null===ia.current&&(t=!0);var c=sc;if(sc=0,ac=null,Zc(e,a,l,c),n&&cc){s=0;break e}break;default:c=sc,sc=0,ac=null,Zc(e,a,l,c)}}qc(),s=hc;break}catch(u){Gc(e,u)}return t&&e.shellSuspendCounter++,wi=vi=null,nc=r,O.H=i,O.A=o,null===ic&&(rc=null,oc=0,Mr()),s}function qc(){for(;null!==ic;)Qc(ic)}function Xc(){for(;null!==ic&&!Z();)Qc(ic)}function Qc(e){var t=Qa(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Jc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=La(n,t,t.pendingProps,t.type,void 0,oc);break;case 11:t=La(n,t,t.pendingProps,t.type.render,t.ref,oc);break;case 5:Ho(t);default:ol(n,t),t=Qa(n,t=ic=Vr(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Zc(e,t,n,r){wi=vi=null,Ho(t),qs=null,Xs=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&xi(t,n,i,!0),null!==(n=ia.current)){switch(n.tag){case 13:return null===oa?Kc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),du(e,r,i)),!1;case 22:return n.flags|=65536,r===Yi?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),du(e,r,i)),!1}throw Error(s(435,n.tag))}return du(e,r,i),Kc(),!1}if(oi)return null!==(t=ia.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==li&&fi(Rr(e=Error(s(422),{cause:r}),n))):(r!==li&&fi(Rr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Rr(r,n),ao(e,i=xa(e.stateNode,r,i)),4!==hc&&(hc=2)),!1;var o=Error(s(520),{cause:r});if(o=Rr(o,n),null===wc?wc=[o]:wc.push(o),4!==hc&&(hc=2),null===t)return!0;r=Rr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,ao(n,e=xa(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===Rc||!Rc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ea(i=Ra(i),e,n,r),ao(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,oc))return hc=1,ya(e,Rr(n,e.current)),void(ic=null)}catch(o){if(null!==i)throw ic=i,o;return hc=1,ya(e,Rr(n,e.current)),void(ic=null)}32768&t.flags?(oi||1===r?e=!0:cc||0!==(536870912&oc)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ia.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,dc);if(null!==n)return void(ic=n);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var n=il(e.alternate,e);if(null!==n)return n.flags&=32767,void(ic=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=n}while(null!==e);hc=6,ic=null}function nu(e,t,n,r,i,o,a,l,c){e.cancelPendingCommit=null;do{au()}while(0!==Ec);if(0!==(6&nc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-pe(n),d=1<<u;a[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==r&&Te(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=kr,a,l,c),e===rc&&(ic=rc=null,oc=0),kc=t,Tc=e,Mc=n,Pc=o,Ic=i,Ac=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,Q(oe,function(){return lu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null,i=N.p,N.p=2,a=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(m){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var g;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(g=h.firstChild);)p=h,h=g;for(;;){if(h===e)break t;if(p===n&&++u===i&&(l=a),p===o&&++d===r&&(c=a),null!==(g=h.nextSibling))break;p=(h=p).parentNode}h=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,xl=t;null!==xl;)if(e=(t=xl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,xl=e;else for(;null!==xl;){switch(o=(t=xl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var f=ma(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(f,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))fd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":fd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,xl=e;break}xl=t.return}}(e,t)}finally{nc=a,N.p=i,O.T=r}}Ec=1,ru(),iu(),ou()}}function ru(){if(1===Ec){Ec=0;var e=Tc,t=kc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=O.T,O.T=null;var r=N.p;N.p=2;var i=nc;nc|=4;try{Ol(t,e);var o=nd,s=er(e.containerInfo),a=o.focusedElem,l=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&Zn(a.ownerDocument.documentElement,a)){if(null!==l&&tr(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var d=a.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),g=a.textContent.length,f=Math.min(l.start,g),m=void 0===l.end?f:Math.min(l.end,g);!p.extend&&f>m&&(s=m,m=f,f=s);var v=Jn(a,f),w=Jn(a,m);if(v&&w&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==w.node||p.focusOffset!==w.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),f>m?(p.addRange(b),p.extend(w.node,w.offset)):(b.setEnd(w.node,w.offset),p.addRange(b))}}}}for(d=[],p=a;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<d.length;a++){var C=d[a];C.element.scrollLeft=C.left,C.element.scrollTop=C.top}}nh=!!td,nd=td=null}finally{nc=i,N.p=r,O.T=n}}e.current=t,Ec=2}}function iu(){if(2===Ec){Ec=0;var e=Tc,t=kc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=O.T,O.T=null;var r=N.p;N.p=2;var i=nc;nc|=4;try{Rl(e,t.alternate,t)}finally{nc=i,N.p=r,O.T=n}}Ec=3}}function ou(){if(4===Ec||3===Ec){Ec=0,ee();var e=Tc,t=kc,n=Mc,r=Ac;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ec=5:(Ec=0,kc=Tc=null,su(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Rc=null),Pe(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=O.T,i=N.p,N.p=2,O.T=null;try{for(var o=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];o(a.value,{componentStack:a.stack})}}finally{O.T=t,N.p=i}}0!==(3&Mc)&&au(),Su(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===Fc?Dc++:(Dc=0,Fc=e):Dc=0,xu(0,!1)}}function su(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Oi(t)))}function au(e){return ru(),iu(),ou(),lu()}function lu(){if(5!==Ec)return!1;var e=Tc,t=Pc;Pc=0;var n=Pe(Mc),r=O.T,i=N.p;try{N.p=32>n?32:n,O.T=null,n=Ic,Ic=null;var o=Tc,a=Mc;if(Ec=0,kc=Tc=null,Mc=0,0!==(6&nc))throw Error(s(331));var l=nc;if(nc|=4,Ql(o.current),jl(o,o.current,a,n),nc=l,xu(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,o)}catch(c){}return!0}finally{N.p=i,O.T=r,su(e,t)}}function cu(e,t,n){t=Rr(n,t),null!==(e=oo(e,t=xa(e.stateNode,t,2),2))&&(Ee(e,2),Su(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Rc||!Rc.has(r))){e=Rr(n,e),null!==(r=oo(t,n=Ra(2),2))&&(Ea(n,r,t,e),Ee(r,2),Su(r));break}}t=t.return}}function du(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(uc=!0,i.add(n),e=hu.bind(null,e,t,n),t.then(e,e))}function hu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(oc&n)===n&&(4===hc||3===hc&&(62914560&oc)===oc&&300>te()-yc?0===(2&nc)&&jc(e,0):fc|=n,vc===oc&&(vc=0)),Su(e)}function pu(e,t){0===t&&(t=xe()),null!==(e=Ar(e,t))&&(Ee(e,t),Su(e))}function gu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),pu(e,n)}function fu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),pu(e,n)}var mu=null,vu=null,wu=!1,bu=!1,Cu=!1,yu=0;function Su(e){e!==vu&&null===e.next&&(null===vu?mu=vu=e:vu=vu.next=e),bu=!0,wu||(wu=!0,dd(function(){0!==(6&nc)?Q(re,Ru):Eu()}))}function xu(e,t){if(!Cu&&bu){Cu=!0;do{for(var n=!1,r=mu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-pe(42|e)+1)-1,o=201326741&(o&=i&~(s&~a))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Mu(r,o))}else o=oc,0===(3&(o=be(r,r===rc?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ce(r,o)||(n=!0,Mu(r,o));r=r.next}}while(n);Cu=!1}}function Ru(){Eu()}function Eu(){bu=wu=!1;var e=0;0!==yu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ad&&(ad=e,!0);return ad=null,!1}()&&(e=yu),yu=0);for(var t=te(),n=null,r=mu;null!==r;){var i=r.next,o=Tu(r,t);0===o?(r.next=null,null===n?mu=i:n.next=i,null===i&&(vu=n)):(n=r,(0!==e||0!==(3&o))&&(bu=!0)),r=i}xu(e,!1)}function Tu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-pe(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=ye(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}if(n=oc,n=be(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===sc||9===sc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&J(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ce(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&J(r),Pe(n)){case 2:case 8:n=ie;break;case 32:default:n=oe;break;case 268435456:n=ae}return r=ku.bind(null,e),n=Q(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&J(r),e.callbackPriority=2,e.callbackNode=null,2}function ku(e,t){if(0!==Ec&&5!==Ec)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(au()&&e.callbackNode!==n)return null;var r=oc;return 0===(r=be(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(_c(e,r,t),Tu(e,te()),null!=e.callbackNode&&e.callbackNode===n?ku.bind(null,e):null)}function Mu(e,t){if(au())return null;_c(e,t,!0)}function Pu(){return 0===yu&&(yu=Se()),yu}function Iu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Au(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Du=0;Du<yr.length;Du++){var Fu=yr[Du];Sr(Fu.toLowerCase(),"on"+(Fu[0].toUpperCase()+Fu.slice(1)))}Sr(pr,"onAnimationEnd"),Sr(gr,"onAnimationIteration"),Sr(fr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(mr,"onTransitionRun"),Sr(vr,"onTransitionStart"),Sr(wr,"onTransitionCancel"),Sr(br,"onTransitionEnd"),qe("onMouseEnter",["mouseout","mouseover"]),qe("onMouseLeave",["mouseout","mouseover"]),qe("onPointerEnter",["pointerout","pointerover"]),qe("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ou));function Lu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){va(u)}i.currentTarget=null,o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){va(u)}i.currentTarget=null,o=l}}}}function _u(e,t){var n=t[Ne];void 0===n&&(n=t[Ne]=new Set);var r=e+"__bubble";n.has(r)||(Wu(t,e,2,!1),n.add(r))}function Hu(e,t,n){var r=0;t&&(r|=4),Wu(n,e,r,t)}var Vu="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[Vu]){e[Vu]=!0,Ue.forEach(function(t){"selectionchange"!==t&&(Nu.has(t)||Hu(t,!1,e),Hu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vu]||(t[Vu]=!0,Hu("selectionchange",!1,t))}}function Wu(e,t,n,r){switch(ch(t)){case 2:var i=rh;break;case 8:i=ih;break;default:i=oh}n=i.bind(null,t,n,e),i=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function zu(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==a;){if(null===(s=We(a)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=o=s;continue e}a=a.parentNode}}r=r.return}Lt(function(){var r=o,i=At(n),s=[];e:{var a=Cr.get(e);if(void 0!==a){var c=Zt,u=e;switch(e){case"keypress":if(0===$t(n))break e;case"keydown":case"keyup":c=fn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=on;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case pr:case gr:case fr:c=an;break;case br:c=wn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=bn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=mn;break;case"toggle":case"beforetoggle":c=Cn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==a?a+"Capture":null:a;d=[];for(var g,f=r;null!==f;){var m=f;if(g=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===g||null===p||null!=(m=_t(f,p))&&d.push(ju(f,m,g)),h)break;f=f.return}0<d.length&&(a=new c(a,u,null,n,i),s.push({event:a,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===It||!(u=n.relatedTarget||n.fromElement)||!We(u)&&!u[Oe])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?We(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=rn,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=mn,m="onPointerLeave",p="onPointerEnter",f="pointer"),h=null==c?a:je(c),g=null==u?a:je(u),(a=new d(m,f+"leave",c,n,i)).target=h,a.relatedTarget=g,m=null,We(i)===r&&((d=new d(p,f+"enter",u,n,i)).target=g,d.relatedTarget=h,m=d),h=m,c&&u)e:{for(p=u,f=0,g=d=c;g;g=$u(g))f++;for(g=0,m=p;m;m=$u(m))g++;for(;0<f-g;)d=$u(d),f--;for(;0<g-f;)p=$u(p),g--;for(;f--;){if(d===p||null!==p&&d===p.alternate)break e;d=$u(d),p=$u(p)}d=null}else d=null;null!==c&&Uu(s,a,c,d,!1),null!==u&&null!==h&&Uu(s,h,u,d,!0)}if("select"===(c=(a=r?je(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var v=Hn;else if(Dn(a))if(Vn)v=Yn;else{v=Un;var w=$n}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Tt(r.elementType)&&(v=Hn):v=Kn;switch(v&&(v=v(e,r))?Fn(s,v,n,i):(w&&w(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&wt(a,"number",a.value)),w=r?je(r):window,e){case"focusin":(Dn(w)||"true"===w.contentEditable)&&(rr=w,ir=r,or=null);break;case"focusout":or=ir=rr=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,ar(s,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(s,n,i)}var b;if(Sn)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else In?Mn(e,n)&&(C="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(C="onCompositionStart");C&&(En&&"ko"!==n.locale&&(In||"onCompositionStart"!==C?"onCompositionEnd"===C&&In&&(b=Gt()):(zt="value"in(Wt=i)?Wt.value:Wt.textContent,In=!0)),0<(w=Gu(r,C)).length&&(C=new cn(C,e,null,n,i),s.push({event:C,listeners:w}),b?C.data=b:null!==(b=Pn(n))&&(C.data=b))),(b=Rn?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(kn=!0,Tn);case"textInput":return(e=t.data)===Tn&&kn?null:e;default:return null}}(e,n):function(e,t){if(In)return"compositionend"===e||!Sn&&Mn(e,t)?(e=Gt(),jt=zt=Wt=null,In=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return En&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(C=Gu(r,"onBeforeInput")).length&&(w=new cn("onBeforeInput","beforeinput",null,n,i),s.push({event:w,listeners:C}),w.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=Iu((i[Fe]||null).action),s=r.submitter;s&&null!==(t=(t=s[Fe]||null)?Iu(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var a=new Zt("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==yu){var e=s?Au(i,s):new FormData(i);As(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(a.preventDefault(),e=s?Au(i,s):new FormData(i),As(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(s,e,r,n,i)}Lu(s,t)})}function ju(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gu(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=_t(e,n))&&r.unshift(ju(e,i,o)),null!=(i=_t(e,t))&&r.push(ju(e,i,o))),3===e.tag)return r;e=e.return}return[]}function $u(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Uu(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=_t(n,o))&&s.unshift(ju(n,c,l)):i||null!=(c=_t(n,o))&&s.push(ju(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Ku=/\r\n?/g,Yu=/\u0000|\uFFFD/g;function qu(e){return("string"===typeof e?e:""+e).replace(Ku,"\n").replace(Yu,"")}function Xu(e,t){return t=qu(t),qu(e)===t}function Qu(){}function Ju(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&St(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Et(e,r,o);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&Ju(e,t,"name",i.name,i,null),Ju(e,t,"formEncType",i.formEncType,i,null),Ju(e,t,"formMethod",i.formMethod,i,null),Ju(e,t,"formTarget",i.formTarget,i,null)):(Ju(e,t,"encType",i.encType,i,null),Ju(e,t,"method",i.method,i,null),Ju(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Qu);break;case"onScroll":null!=r&&_u("scroll",e);break;case"onScrollEnd":null!=r&&_u("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":_u("beforetoggle",e),_u("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=kt.get(n)||n,r)}}function Zu(e,t,n,r,i,o){switch(n){case"style":Et(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?St(e,r):("number"===typeof r||"bigint"===typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&_u("scroll",e);break;case"onScrollEnd":null!=r&&_u("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Qu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ke.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[Fe]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_u("error",e),_u("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ju(e,t,r,a,n,null)}}return o&&Ju(e,t,"srcSet",n.srcSet,n,null),void(i&&Ju(e,t,"src",n.src,n,null));case"input":_u("invalid",e);var l=r=a=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":o=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Ju(e,t,i,d,n,null)}}return vt(e,r,l,c,u,a,o,!1),void dt(e);case"select":for(o in _u("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Ju(e,t,o,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?bt(e,!!i,t,!1):null!=n&&bt(e,!!i,n,!0));case"textarea":for(a in _u("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Ju(e,t,a,l,n,null)}return yt(e,i,o,r),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Ju(e,t,c,i,n,null);return;case"dialog":_u("beforetoggle",e),_u("toggle",e),_u("cancel",e),_u("close",e);break;case"iframe":case"object":_u("load",e);break;case"video":case"audio":for(i=0;i<Ou.length;i++)_u(Ou[i],e);break;case"image":_u("error",e),_u("load",e);break;case"details":_u("toggle",e);break;case"embed":case"source":case"link":_u("error",e),_u("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Ju(e,t,u,i,n,null)}return;default:if(Tt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&Zu(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Ju(e,t,l,i,n,null))}var td=null,nd=null;function rd(e){return 9===e.nodeType?e:e.ownerDocument}function id(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function od(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function sd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ad=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout(function(){throw e})}function pd(e){return"head"===e}function gd(e,t){var n=t,r=0,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&yd(s.documentElement),2&n&&yd(s.body),4&n)for(yd(n=s.head),s=n.firstChild;s;){var a=s.nextSibling,l=s.nodeName;s[Ve]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=a}}if(0===i)return e.removeChild(o),void kh(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=o}while(n);kh(t)}function fd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":fd(n),Be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function md(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var wd=null;function bd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Cd(e,t,n){switch(t=rd(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function yd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var Sd=new Map,xd=new Set;function Rd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Ed=N.d;N.d={f:function(){var e=Ed.f(),t=Wc();return e||t},r:function(e){var t=ze(e);null!==t&&5===t.tag&&"form"===t.type?Fs(t):Ed.r(e)},D:function(e){Ed.D(e),kd("dns-prefetch",e,null)},C:function(e,t){Ed.C(e,t),kd("preconnect",e,t)},L:function(e,t,n){Ed.L(e,t,n);var r=Td;if(r&&e&&t){var i='link[rel="preload"][as="'+ft(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+ft(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+ft(n.imageSizes)+'"]')):i+='[href="'+ft(e)+'"]';var o=i;switch(t){case"style":o=Pd(e);break;case"script":o=Dd(e)}Sd.has(o)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sd.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Id(o))||"script"===t&&r.querySelector(Fd(o))||(ed(t=r.createElement("link"),"link",e),$e(t),r.head.appendChild(t)))}},m:function(e,t){Ed.m(e,t);var n=Td;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+ft(r)+'"][href="'+ft(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Dd(e)}if(!Sd.has(o)&&(e=h({rel:"modulepreload",href:e},t),Sd.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Fd(o)))return}ed(r=n.createElement("link"),"link",e),$e(r),n.head.appendChild(r)}}},X:function(e,t){Ed.X(e,t);var n=Td;if(n&&e){var r=Ge(n).hoistableScripts,i=Dd(e),o=r.get(i);o||((o=n.querySelector(Fd(i)))||(e=h({src:e,async:!0},t),(t=Sd.get(i))&&_d(e,t),$e(o=n.createElement("script")),ed(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Ed.S(e,t,n);var r=Td;if(r&&e){var i=Ge(r).hoistableStyles,o=Pd(e);t=t||"default";var s=i.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Id(o)))a.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sd.get(o))&&Ld(e,n);var l=s=r.createElement("link");$e(l),ed(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){a.loading|=1}),l.addEventListener("error",function(){a.loading|=2}),a.loading|=4,Nd(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},i.set(o,s)}}},M:function(e,t){Ed.M(e,t);var n=Td;if(n&&e){var r=Ge(n).hoistableScripts,i=Dd(e),o=r.get(i);o||((o=n.querySelector(Fd(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Sd.get(i))&&_d(e,t),$e(o=n.createElement("script")),ed(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var Td="undefined"===typeof document?null:document;function kd(e,t,n){var r=Td;if(r&&"string"===typeof t&&t){var i=ft(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),xd.has(i)||(xd.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(ed(t=r.createElement("link"),"link",e),$e(t),r.head.appendChild(t)))}}function Md(e,t,n,r){var i,o,a,l,c=(c=G.current)?Rd(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Pd(n.href),(r=(n=Ge(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Pd(n.href);var u=Ge(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Id(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Sd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sd.set(e,n),u||(i=c,o=e,a=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),ed(o,"link",a),$e(o),i.head.appendChild(o))))),t&&null===r)throw Error(s(528,""));return d}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Dd(n),(r=(n=Ge(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Pd(e){return'href="'+ft(e)+'"'}function Id(e){return'link[rel="stylesheet"]['+e+"]"}function Ad(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Dd(e){return'[src="'+ft(e)+'"]'}function Fd(e){return"script[async]"+e}function Od(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+ft(n.href)+'"]');if(r)return t.instance=r,$e(r),r;var i=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return $e(r=(e.ownerDocument||e).createElement("style")),ed(r,"style",i),Nd(r,n.precedence,e),t.instance=r;case"stylesheet":i=Pd(n.href);var o=e.querySelector(Id(i));if(o)return t.state.loading|=4,t.instance=o,$e(o),o;r=Ad(n),(i=Sd.get(i))&&Ld(r,i),$e(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),ed(o,"link",r),t.state.loading|=4,Nd(o,n.precedence,e),t.instance=o;case"script":return o=Dd(n.src),(i=e.querySelector(Fd(o)))?(t.instance=i,$e(i),i):(r=n,(i=Sd.get(o))&&_d(r=h({},n),i),$e(i=(e=e.ownerDocument||e).createElement("script")),ed(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Nd(r,n.precedence,e));return t.instance}function Nd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Ld(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function _d(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Hd=null;function Vd(e,t,n){if(null===Hd){var r=new Map,i=Hd=new Map;i.set(n,r)}else(r=(i=Hd).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[Ve]||o[De]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function Bd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Wd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var zd=null;function jd(){}function Gd(){if(this.count--,0===this.count)if(this.stylesheets)Ud(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var $d=null;function Ud(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,$d=new Map,t.forEach(Kd,e),$d=null,Gd.call(e))}function Kd(e,t){if(!(4&t.state.loading)){var n=$d.get(e);if(n)var r=n.get(null);else{n=new Map,$d.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var s=i[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(o=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=Gd.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Yd={$$typeof:y,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function qd(e,t,n,r,i,o,s,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Re(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Re(0),this.hiddenUpdates=Re(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Xd(e,t,n,r,i,o,s,a,l,c,u,d){return e=new qd(e,t,n,s,a,l,c,d),t=1,!0===o&&(t|=24),o=Lr(3,null,null,t),e.current=o,o.stateNode=e,(t=Fi()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},no(o),e}function Qd(e){return e?e=Or:Or}function Jd(e,t,n,r,i,o){i=Qd(i),null===r.context?r.context=i:r.pendingContext=i,(r=io(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=oo(e,r,t))&&(Lc(n,0,t),so(n,e,t))}function Zd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Zd(e,t),(e=e.alternate)&&Zd(e,t)}function th(e){if(13===e.tag){var t=Ar(e,67108864);null!==t&&Lc(t,0,67108864),eh(e,67108864)}}var nh=!0;function rh(e,t,n,r){var i=O.T;O.T=null;var o=N.p;try{N.p=2,oh(e,t,n,r)}finally{N.p=o,O.T=i}}function ih(e,t,n,r){var i=O.T;O.T=null;var o=N.p;try{N.p=8,oh(e,t,n,r)}finally{N.p=o,O.T=i}}function oh(e,t,n,r){if(nh){var i=sh(r);if(null===i)zu(e,t,r,ah,n),wh(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return dh=bh(dh,e,t,n,r,i),!0;case"dragenter":return hh=bh(hh,e,t,n,r,i),!0;case"mouseover":return ph=bh(ph,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return gh.set(o,bh(gh.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,fh.set(o,bh(fh.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(wh(e,r),4&t&&-1<vh.indexOf(e)){for(;null!==i;){var o=ze(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=we(o.pendingLanes);if(0!==s){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-pe(s);a.entanglements[1]|=l,s&=~l}Su(o),0===(6&nc)&&(Sc=te()+500,xu(0,!1))}}break;case 13:null!==(a=Ar(o,2))&&Lc(a,0,2),Wc(),eh(o,2)}if(null===(o=sh(r))&&zu(e,t,r,ah,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else zu(e,t,r,null,n)}}function sh(e){return lh(e=At(e))}var ah=null;function lh(e){if(ah=null,null!==(e=We(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ah=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case oe:case se:return 32;case ae:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,ph=null,gh=new Map,fh=new Map,mh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wh(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":ph=null;break;case"pointerover":case"pointerout":gh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fh.delete(t.pointerId)}}function bh(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=ze(t))&&th(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ch(e){var t=We(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=N.p;try{return N.p=e,t()}finally{N.p=n}}(e.priority,function(){if(13===n.tag){var e=Oc();e=Me(e);var t=Ar(n,e);null!==t&&Lc(t,0,e),eh(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=sh(e.nativeEvent);if(null!==n)return null!==(t=ze(n))&&th(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);It=r,n.target.dispatchEvent(r),It=null,t.shift()}return!0}function Sh(e,t,n){yh(e)&&n.delete(t)}function xh(){uh=!1,null!==dh&&yh(dh)&&(dh=null),null!==hh&&yh(hh)&&(hh=null),null!==ph&&yh(ph)&&(ph=null),gh.forEach(Sh),fh.forEach(Sh)}function Rh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,xh)))}var Eh=null;function Th(e){Eh!==e&&(Eh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Eh===e&&(Eh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===lh(r||n))continue;break}var o=ze(n);null!==o&&(e.splice(t,3),t-=3,As(o,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function kh(e){function t(t){return Rh(t,e)}null!==dh&&Rh(dh,e),null!==hh&&Rh(hh,e),null!==ph&&Rh(ph,e),gh.forEach(t),fh.forEach(t);for(var n=0;n<mh.length;n++){var r=mh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<mh.length&&null===(n=mh[0]).blockedOn;)Ch(n),null===n.blockedOn&&mh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[Fe]||null;if("function"===typeof o)s||Th(n);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(i=o,s=o[Fe]||null)a=s.formAction;else if(null!==lh(i))continue}else a=s.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),Th(n)}}}function Mh(e){this._internalRoot=e}function Ph(e){this._internalRoot=e}Ph.prototype.render=Mh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Jd(t.current,Oc(),e,t,null,null)},Ph.prototype.unmount=Mh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Jd(e.current,2,null,e,null,null),Wc(),t[Oe]=null}},Ph.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var n=0;n<mh.length&&0!==t&&t<mh[n].priority;n++);mh.splice(n,0,e),0===n&&Ch(e)}};var Ih=i.version;if("19.1.0"!==Ih)throw Error(s(527,Ih,"19.1.0"));N.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return u(i),e;if(o===r)return u(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Ah={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Dh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dh.isDisabled&&Dh.supportsFiber)try{ue=Dh.inject(Ah),de=Dh}catch(Oh){}}t.createRoot=function(e,t){if(!a(e))throw Error(s(299));var n=!1,r="",i=wa,o=ba,l=Ca;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Xd(e,1,!1,null,0,n,r,i,o,l,0,null),e[Oe]=t.current,Bu(e),new Mh(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(s(299));var r=!1,i="",o=wa,l=ba,c=Ca,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=Xd(e,1,!0,t,0,r,i,o,l,c,0,u)).context=Qd(null),n=t.current,(i=io(r=Me(r=Oc()))).callback=null,oo(n,i,r),n=r,t.current.lanes=n,Ee(t,n),Su(t),e[Oe]=t.current,Bu(e),new Ph(t)},t.version="19.1.0"},7151:(e,t,n)=>{"use strict";var r=n(1239),i=n(3192);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},7192:(e,t,n)=>{"use strict";var r=n(4823),i=n(498),o=n(5687),s=function(e){return i.slice(0,e.length)===e};e.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},7251:(e,t,n)=>{"use strict";var r=n(4061),i=n(4291).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7592:e=>{"use strict";e.exports=!1},7707:(e,t,n)=>{"use strict";var r=n(5897),i=Function.prototype,o=i.call,s=r&&i.bind.bind(o,o);e.exports=r?s:function(e){return function(){return o.apply(e,arguments)}}},7899:(e,t,n)=>{"use strict";var r=n(7707),i=0,o=Math.random(),s=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(6672)},7970:(e,t,n)=>{"use strict";var r=n(3542),i=n(4706),o=n(6864),s=n(4111),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,a(e))}},8084:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},8097:(e,t,n)=>{"use strict";var r=n(5687),i=n(7707);e.exports=function(e){if("Function"===r(e))return i(e)}},8249:(e,t,n)=>{"use strict";var r=n(466),i=Math.min;e.exports=function(e){var t=r(e);return t>0?i(t,9007199254740991):0}},8853:(e,t,n)=>{"use strict";e.exports=n(5896)},8973:(e,t,n)=>{"use strict";var r=n(498);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},9055:(e,t,n)=>{"use strict";var r=n(8097),i=n(1239),o=n(5897),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},9140:(e,t,n)=>{"use strict";var r=n(4850),i=n(6821),o=n(7970),s=n(7151),a=n(2509),l=n(4352),c=TypeError,u=l("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,l=s(e,u);if(l){if(void 0===t&&(t="default"),n=r(l,e,t),!i(n)||o(n))return n;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},9266:(e,t,n)=>{"use strict";var r=n(9519),i=n(3572),o=n(6369);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9279:(e,t,n)=>{"use strict";var r=n(4823),i=n(4706),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},9286:(e,t,n)=>{"use strict";var r=n(6715),i=n(4823),o=n(9464).set,s=n(1709),a=i.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==a},{setImmediate:a})},9344:e=>{"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},9461:(e,t,n)=>{"use strict";e.exports=n(2330)},9464:(e,t,n)=>{"use strict";var r,i,o,s,a=n(4823),l=n(6464),c=n(9055),u=n(4706),d=n(6164),h=n(8084),p=n(904),g=n(1659),f=n(2760),m=n(155),v=n(8973),w=n(4234),b=a.setImmediate,C=a.clearImmediate,y=a.process,S=a.Dispatch,x=a.Function,R=a.MessageChannel,E=a.String,T=0,k={},M="onreadystatechange";h(function(){r=a.location});var P=function(e){if(d(k,e)){var t=k[e];delete k[e],t()}},I=function(e){return function(){P(e)}},A=function(e){P(e.data)},D=function(e){a.postMessage(E(e),r.protocol+"//"+r.host)};b&&C||(b=function(e){m(arguments.length,1);var t=u(e)?e:x(e),n=g(arguments,1);return k[++T]=function(){l(t,void 0,n)},i(T),T},C=function(e){delete k[e]},w?i=function(e){y.nextTick(I(e))}:S&&S.now?i=function(e){S.now(I(e))}:R&&!v?(s=(o=new R).port2,o.port1.onmessage=A,i=c(s.postMessage,s)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!h(D)?(i=D,a.addEventListener("message",A,!1)):i=M in f("script")?function(e){p.appendChild(f("script"))[M]=function(){p.removeChild(this),P(e)}}:function(e){setTimeout(I(e),0)}),e.exports={set:b,clear:C}},9519:(e,t,n)=>{"use strict";var r=n(8084);e.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},9704:(e,t,n)=>{"use strict";var r=n(9519),i=n(8084),o=n(2760);e.exports=!r&&!i(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var s={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(e=>s[e]=()=>r[e]);return s.default=()=>r,n.d(o,s),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".94ad20e2.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="spreadsheet-charts-demo:";n.l=(r,i,o,s)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=r),e[r]=[i];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/comanzanares/spreadsheet-charts-demo/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,o,s=r[0],a=r[1],l=r[2],c=0;if(s.some(t=>0!==e[t])){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkspreadsheet_charts_demo=self.webpackChunkspreadsheet_charts_demo||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{CHECKBOX_CHECKED:()=>gd,CHECKBOX_RENDERER_NAMESPACE:()=>pd,CHECKBOX_UNCHECKED:()=>fd,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>lu,CONTEXTMENU_ITEMS_ALIGNMENT:()=>hu,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>bu,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>gu,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>mu,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>pu,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>wu,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>fu,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>vu,CONTEXTMENU_ITEMS_BORDERS:()=>Cu,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>xu,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>Ru,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>Su,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>yu,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>Jc,CONTEXTMENU_ITEMS_COPY:()=>Zc,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>nu,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>tu,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>eu,CONTEXTMENU_ITEMS_CUT:()=>ru,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>cu,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>iu,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>Mu,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Iu,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>$c,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>Uc,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>su,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>ku,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>Tu,CONTEXTMENU_ITEMS_NO_ITEMS:()=>zc,CONTEXTMENU_ITEMS_READ_ONLY:()=>Qc,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>du,CONTEXTMENU_ITEMS_REDO:()=>Xc,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Eu,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>Yc,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>uu,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>Kc,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>jc,CONTEXTMENU_ITEMS_ROW_BELOW:()=>Gc,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>Pu,CONTEXTMENU_ITEMS_SHOW_ROW:()=>Au,CONTEXTMENU_ITEMS_UNDO:()=>qc,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>ou,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>au,CONTEXT_MENU_ITEMS_NAMESPACE:()=>Wc,FILTERS_BUTTONS_CANCEL:()=>cd,FILTERS_BUTTONS_CLEAR:()=>ad,FILTERS_BUTTONS_OK:()=>ld,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>ud,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>hd,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>dd,FILTERS_BUTTONS_SELECT_ALL:()=>sd,FILTERS_CONDITIONS_AFTER:()=>Xu,FILTERS_CONDITIONS_BEFORE:()=>Qu,FILTERS_CONDITIONS_BEGINS_WITH:()=>Vu,FILTERS_CONDITIONS_BETWEEN:()=>Yu,FILTERS_CONDITIONS_BY_VALUE:()=>ju,FILTERS_CONDITIONS_CONTAINS:()=>Wu,FILTERS_CONDITIONS_EMPTY:()=>Nu,FILTERS_CONDITIONS_ENDS_WITH:()=>Bu,FILTERS_CONDITIONS_EQUAL:()=>_u,FILTERS_CONDITIONS_GREATER_THAN:()=>Gu,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>$u,FILTERS_CONDITIONS_LESS_THAN:()=>Uu,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>Ku,FILTERS_CONDITIONS_NAMESPACE:()=>Fu,FILTERS_CONDITIONS_NONE:()=>Ou,FILTERS_CONDITIONS_NOT_BETWEEN:()=>qu,FILTERS_CONDITIONS_NOT_CONTAIN:()=>zu,FILTERS_CONDITIONS_NOT_EMPTY:()=>Lu,FILTERS_CONDITIONS_NOT_EQUAL:()=>Hu,FILTERS_CONDITIONS_TODAY:()=>Ju,FILTERS_CONDITIONS_TOMORROW:()=>Zu,FILTERS_CONDITIONS_YESTERDAY:()=>ed,FILTERS_DIVS_FILTER_BY_CONDITION:()=>td,FILTERS_DIVS_FILTER_BY_VALUE:()=>nd,FILTERS_LABELS_CONJUNCTION:()=>rd,FILTERS_LABELS_DISJUNCTION:()=>id,FILTERS_NAMESPACE:()=>Du,FILTERS_VALUES_BLANK_CELLS:()=>od});var t=n(5043),r=n.t(t,2),i=n(4391),o=n(7950);n(4647);const{entries:s,setPrototypeOf:a,isFrozen:l,getPrototypeOf:c,getOwnPropertyDescriptor:u}=Object;let{freeze:d,seal:h,create:p}=Object,{apply:g,construct:f}="undefined"!==typeof Reflect&&Reflect;d||(d=function(e){return e}),h||(h=function(e){return e}),g||(g=function(e,t,n){return e.apply(t,n)}),f||(f=function(e,t){return new e(...t)});const m=A(Array.prototype.forEach),v=A(Array.prototype.lastIndexOf),w=A(Array.prototype.pop),b=A(Array.prototype.push),C=A(Array.prototype.splice),y=A(String.prototype.toLowerCase),S=A(String.prototype.toString),x=A(String.prototype.match),R=A(String.prototype.replace),E=A(String.prototype.indexOf),T=A(String.prototype.trim),k=A(Object.prototype.hasOwnProperty),M=A(RegExp.prototype.test),P=(I=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return f(I,t)});var I;function A(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return g(e,t,r)}}function D(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;a&&a(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"===typeof i){const e=n(i);e!==i&&(l(t)||(t[r]=e),i=e)}e[i]=!0}return e}function F(e){for(let t=0;t<e.length;t++){k(e,t)||(e[t]=null)}return e}function O(e){const t=p(null);for(const[n,r]of s(e)){k(e,n)&&(Array.isArray(r)?t[n]=F(r):r&&"object"===typeof r&&r.constructor===Object?t[n]=O(r):t[n]=r)}return t}function N(e,t){for(;null!==e;){const n=u(e,t);if(n){if(n.get)return A(n.get);if("function"===typeof n.value)return A(n.value)}e=c(e)}return function(){return null}}const L=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),H=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),V=d(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),B=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),W=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),z=d(["#text"]),j=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),G=d(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),U=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),K=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Y=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=h(/<%[\w\W]*|[\w\W]*%>/gm),X=h(/\$\{[\w\W]*/gm),Q=h(/^data-[\-\w.\u00B7-\uFFFF]+$/),J=h(/^aria-[\-\w]+$/),Z=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=h(/^(?:\w+script|data):/i),te=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ne=h(/^html$/i),re=h(/^[a-z][.\w]*(-[.\w]+)+$/i);var ie=Object.freeze({__proto__:null,ARIA_ATTR:J,ATTR_WHITESPACE:te,CUSTOM_ELEMENT:re,DATA_ATTR:Q,DOCTYPE_NAME:ne,ERB_EXPR:q,IS_ALLOWED_URI:Z,IS_SCRIPT_OR_DATA:ee,MUSTACHE_EXPR:Y,TMPLIT_EXPR:X});const oe=1,se=3,ae=7,le=8,ce=9,ue=function(){return"undefined"===typeof window?null:window};var de=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue();const n=t=>e(t);if(n.version="3.2.6",n.removed=[],!t||!t.document||t.document.nodeType!==ce||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const i=r,o=i.currentScript,{DocumentFragment:a,HTMLTemplateElement:l,Node:c,Element:u,NodeFilter:h,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:f,DOMParser:I,trustedTypes:A}=t,F=u.prototype,$=N(F,"cloneNode"),Y=N(F,"remove"),q=N(F,"nextSibling"),X=N(F,"childNodes"),Q=N(F,"parentNode");if("function"===typeof l){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let J,ee="";const{implementation:te,createNodeIterator:re,createDocumentFragment:de,getElementsByTagName:he}=r,{importNode:pe}=i;let ge={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"===typeof s&&"function"===typeof Q&&te&&void 0!==te.createHTMLDocument;const{MUSTACHE_EXPR:fe,ERB_EXPR:me,TMPLIT_EXPR:ve,DATA_ATTR:we,ARIA_ATTR:be,IS_SCRIPT_OR_DATA:Ce,ATTR_WHITESPACE:ye,CUSTOM_ELEMENT:Se}=ie;let{IS_ALLOWED_URI:xe}=ie,Re=null;const Ee=D({},[...L,..._,...H,...B,...z]);let Te=null;const ke=D({},[...j,...G,...U,...K]);let Me=Object.seal(p(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Ie=null,Ae=!0,De=!0,Fe=!1,Oe=!0,Ne=!1,Le=!0,_e=!1,He=!1,Ve=!1,Be=!1,We=!1,ze=!1,je=!0,Ge=!1,$e=!0,Ue=!1,Ke={},Ye=null;const qe=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Xe=null;const Qe=D({},["audio","video","img","source","image","track"]);let Je=null;const Ze=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",tt="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml";let rt=nt,it=!1,ot=null;const st=D({},[et,tt,nt],S);let at=D({},["mi","mo","mn","ms","mtext"]),lt=D({},["annotation-xml"]);const ct=D({},["title","style","font","a","script"]);let ut=null;const dt=["application/xhtml+xml","text/html"];let ht=null,pt=null;const gt=r.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},mt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!pt||pt!==e){if(e&&"object"===typeof e||(e={}),e=O(e),ut=-1===dt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ht="application/xhtml+xml"===ut?S:y,Re=k(e,"ALLOWED_TAGS")?D({},e.ALLOWED_TAGS,ht):Ee,Te=k(e,"ALLOWED_ATTR")?D({},e.ALLOWED_ATTR,ht):ke,ot=k(e,"ALLOWED_NAMESPACES")?D({},e.ALLOWED_NAMESPACES,S):st,Je=k(e,"ADD_URI_SAFE_ATTR")?D(O(Ze),e.ADD_URI_SAFE_ATTR,ht):Ze,Xe=k(e,"ADD_DATA_URI_TAGS")?D(O(Qe),e.ADD_DATA_URI_TAGS,ht):Qe,Ye=k(e,"FORBID_CONTENTS")?D({},e.FORBID_CONTENTS,ht):qe,Pe=k(e,"FORBID_TAGS")?D({},e.FORBID_TAGS,ht):O({}),Ie=k(e,"FORBID_ATTR")?D({},e.FORBID_ATTR,ht):O({}),Ke=!!k(e,"USE_PROFILES")&&e.USE_PROFILES,Ae=!1!==e.ALLOW_ARIA_ATTR,De=!1!==e.ALLOW_DATA_ATTR,Fe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ne=e.SAFE_FOR_TEMPLATES||!1,Le=!1!==e.SAFE_FOR_XML,_e=e.WHOLE_DOCUMENT||!1,Be=e.RETURN_DOM||!1,We=e.RETURN_DOM_FRAGMENT||!1,ze=e.RETURN_TRUSTED_TYPE||!1,Ve=e.FORCE_BODY||!1,je=!1!==e.SANITIZE_DOM,Ge=e.SANITIZE_NAMED_PROPS||!1,$e=!1!==e.KEEP_CONTENT,Ue=e.IN_PLACE||!1,xe=e.ALLOWED_URI_REGEXP||Z,rt=e.NAMESPACE||nt,at=e.MATHML_TEXT_INTEGRATION_POINTS||at,lt=e.HTML_INTEGRATION_POINTS||lt,Me=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ft(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Me.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ft(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Me.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Me.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ne&&(De=!1),We&&(Be=!0),Ke&&(Re=D({},z),Te=[],!0===Ke.html&&(D(Re,L),D(Te,j)),!0===Ke.svg&&(D(Re,_),D(Te,G),D(Te,K)),!0===Ke.svgFilters&&(D(Re,H),D(Te,G),D(Te,K)),!0===Ke.mathMl&&(D(Re,B),D(Te,U),D(Te,K))),e.ADD_TAGS&&(Re===Ee&&(Re=O(Re)),D(Re,e.ADD_TAGS,ht)),e.ADD_ATTR&&(Te===ke&&(Te=O(Te)),D(Te,e.ADD_ATTR,ht)),e.ADD_URI_SAFE_ATTR&&D(Je,e.ADD_URI_SAFE_ATTR,ht),e.FORBID_CONTENTS&&(Ye===qe&&(Ye=O(Ye)),D(Ye,e.FORBID_CONTENTS,ht)),$e&&(Re["#text"]=!0),_e&&D(Re,["html","head","body"]),Re.table&&(D(Re,["tbody"]),delete Pe.tbody),e.TRUSTED_TYPES_POLICY){if("function"!==typeof e.TRUSTED_TYPES_POLICY.createHTML)throw P('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!==typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw P('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');J=e.TRUSTED_TYPES_POLICY,ee=J.createHTML("")}else void 0===J&&(J=function(e,t){if("object"!==typeof e||"function"!==typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(A,o)),null!==J&&"string"===typeof ee&&(ee=J.createHTML(""));d&&d(e),pt=e}},vt=D({},[..._,...H,...V]),wt=D({},[...B,...W]),bt=function(e){b(n.removed,{element:e});try{Q(e).removeChild(e)}catch(t){Y(e)}},Ct=function(e,t){try{b(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(r){b(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Be||We)try{bt(t)}catch(r){}else try{t.setAttribute(e,"")}catch(r){}},yt=function(e){let t=null,n=null;if(Ve)e="<remove></remove>"+e;else{const t=x(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===ut&&rt===nt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const i=J?J.createHTML(e):e;if(rt===nt)try{t=(new I).parseFromString(i,ut)}catch(s){}if(!t||!t.documentElement){t=te.createDocument(rt,"template",null);try{t.documentElement.innerHTML=it?ee:i}catch(s){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),rt===nt?he.call(t,_e?"html":"body")[0]:_e?t.documentElement:o},St=function(e){return re.call(e.ownerDocument||e,e,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},xt=function(e){return e instanceof f&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof g)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},Rt=function(e){return"function"===typeof c&&e instanceof c};function Et(e,t,r){m(e,e=>{e.call(n,t,r,pt)})}const Tt=function(e){let t=null;if(Et(ge.beforeSanitizeElements,e,null),xt(e))return bt(e),!0;const r=ht(e.nodeName);if(Et(ge.uponSanitizeElement,e,{tagName:r,allowedTags:Re}),Le&&e.hasChildNodes()&&!Rt(e.firstElementChild)&&M(/<[/\w!]/g,e.innerHTML)&&M(/<[/\w!]/g,e.textContent))return bt(e),!0;if(e.nodeType===ae)return bt(e),!0;if(Le&&e.nodeType===le&&M(/<[/\w]/g,e.data))return bt(e),!0;if(!Re[r]||Pe[r]){if(!Pe[r]&&Mt(r)){if(Me.tagNameCheck instanceof RegExp&&M(Me.tagNameCheck,r))return!1;if(Me.tagNameCheck instanceof Function&&Me.tagNameCheck(r))return!1}if($e&&!Ye[r]){const t=Q(e)||e.parentNode,n=X(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=$(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,q(e))}}}return bt(e),!0}return e instanceof u&&!function(e){let t=Q(e);t&&t.tagName||(t={namespaceURI:rt,tagName:"template"});const n=y(e.tagName),r=y(t.tagName);return!!ot[e.namespaceURI]&&(e.namespaceURI===tt?t.namespaceURI===nt?"svg"===n:t.namespaceURI===et?"svg"===n&&("annotation-xml"===r||at[r]):Boolean(vt[n]):e.namespaceURI===et?t.namespaceURI===nt?"math"===n:t.namespaceURI===tt?"math"===n&&lt[r]:Boolean(wt[n]):e.namespaceURI===nt?!(t.namespaceURI===tt&&!lt[r])&&!(t.namespaceURI===et&&!at[r])&&!wt[n]&&(ct[n]||!vt[n]):!("application/xhtml+xml"!==ut||!ot[e.namespaceURI]))}(e)?(bt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!M(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ne&&e.nodeType===se&&(t=e.textContent,m([fe,me,ve],e=>{t=R(t,e," ")}),e.textContent!==t&&(b(n.removed,{element:e.cloneNode()}),e.textContent=t)),Et(ge.afterSanitizeElements,e,null),!1):(bt(e),!0)},kt=function(e,t,n){if(je&&("id"===t||"name"===t)&&(n in r||n in gt))return!1;if(De&&!Ie[t]&&M(we,t));else if(Ae&&M(be,t));else if(!Te[t]||Ie[t]){if(!(Mt(e)&&(Me.tagNameCheck instanceof RegExp&&M(Me.tagNameCheck,e)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(e))&&(Me.attributeNameCheck instanceof RegExp&&M(Me.attributeNameCheck,t)||Me.attributeNameCheck instanceof Function&&Me.attributeNameCheck(t))||"is"===t&&Me.allowCustomizedBuiltInElements&&(Me.tagNameCheck instanceof RegExp&&M(Me.tagNameCheck,n)||Me.tagNameCheck instanceof Function&&Me.tagNameCheck(n))))return!1}else if(Je[t]);else if(M(xe,R(n,ye,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==E(n,"data:")||!Xe[e]){if(Fe&&!M(Ce,R(n,ye,"")));else if(n)return!1}else;return!0},Mt=function(e){return"annotation-xml"!==e&&x(e,Se)},Pt=function(e){Et(ge.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||xt(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te,forceKeepAttr:void 0};let i=t.length;for(;i--;){const s=t[i],{name:a,namespaceURI:l,value:c}=s,u=ht(a),d=c;let h="value"===a?d:T(d);if(r.attrName=u,r.attrValue=h,r.keepAttr=!0,r.forceKeepAttr=void 0,Et(ge.uponSanitizeAttribute,e,r),h=r.attrValue,!Ge||"id"!==u&&"name"!==u||(Ct(a,e),h="user-content-"+h),Le&&M(/((--!?|])>)|<\/(style|title)/i,h)){Ct(a,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){Ct(a,e);continue}if(!Oe&&M(/\/>/i,h)){Ct(a,e);continue}Ne&&m([fe,me,ve],e=>{h=R(h,e," ")});const p=ht(e.nodeName);if(kt(p,u,h)){if(J&&"object"===typeof A&&"function"===typeof A.getAttributeType)if(l);else switch(A.getAttributeType(p,u)){case"TrustedHTML":h=J.createHTML(h);break;case"TrustedScriptURL":h=J.createScriptURL(h)}if(h!==d)try{l?e.setAttributeNS(l,a,h):e.setAttribute(a,h),xt(e)?bt(e):w(n.removed)}catch(o){Ct(a,e)}}else Ct(a,e)}Et(ge.afterSanitizeAttributes,e,null)},It=function e(t){let n=null;const r=St(t);for(Et(ge.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Et(ge.uponSanitizeShadowNode,n,null),Tt(n),Pt(n),n.content instanceof a&&e(n.content);Et(ge.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,s=null,l=null;if(it=!e,it&&(e="\x3c!--\x3e"),"string"!==typeof e&&!Rt(e)){if("function"!==typeof e.toString)throw P("toString is not a function");if("string"!==typeof(e=e.toString()))throw P("dirty is not a string, aborting")}if(!n.isSupported)return e;if(He||mt(t),n.removed=[],"string"===typeof e&&(Ue=!1),Ue){if(e.nodeName){const t=ht(e.nodeName);if(!Re[t]||Pe[t])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)r=yt("\x3c!----\x3e"),o=r.ownerDocument.importNode(e,!0),o.nodeType===oe&&"BODY"===o.nodeName||"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!Be&&!Ne&&!_e&&-1===e.indexOf("<"))return J&&ze?J.createHTML(e):e;if(r=yt(e),!r)return Be?null:ze?ee:""}r&&Ve&&bt(r.firstChild);const u=St(Ue?e:r);for(;s=u.nextNode();)Tt(s),Pt(s),s.content instanceof a&&It(s.content);if(Ue)return e;if(Be){if(We)for(l=de.call(r.ownerDocument);r.firstChild;)l.appendChild(r.firstChild);else l=r;return(Te.shadowroot||Te.shadowrootmode)&&(l=pe.call(i,l,!0)),l}let d=_e?r.outerHTML:r.innerHTML;return _e&&Re["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&M(ne,r.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+d),Ne&&m([fe,me,ve],e=>{d=R(d,e," ")}),J&&ze?J.createHTML(d):d},n.setConfig=function(){mt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),He=!0},n.clearConfig=function(){pt=null,He=!1},n.isValidAttribute=function(e,t,n){pt||mt({});const r=ht(e),i=ht(t);return kt(r,i,n)},n.addHook=function(e,t){"function"===typeof t&&b(ge[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=v(ge[e],t);return-1===n?void 0:C(ge[e],n,1)[0]}return w(ge[e])},n.removeHooks=function(e){ge[e]=[]},n.removeAllHooks=function(){ge={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function he(e){return e[0].toUpperCase()+e.substr(1)}function pe(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function ge(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function fe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,(e,n)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n])}function me(e){return ve(`${e}`,{ALLOWED_TAGS:[]})}function ve(e,t){return de.sanitize(e,t)}const we=e=>["tabindex",e],be=()=>["role","gridcell"],Ce=()=>["role","rowheader"],ye=()=>["role","columnheader"],Se=()=>["role","row"],xe=()=>["scope","col"],Re=()=>["scope","row"],Ee=e=>["aria-label",e],Te=e=>["aria-haspopup",e],ke=e=>["aria-rowcount",e],Me=e=>["aria-colcount",e],Pe=e=>["aria-rowindex",e],Ie=e=>["aria-colindex",e],Ae=e=>["aria-expanded",e],De=e=>["aria-checked",e],Fe=e=>["aria-relevant",e],Oe=e=>["aria-posinset",e];function Ne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;for(;null!==i;){if(n===t){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Le(e,t){const n=e.closest(".handsontable");return!!n&&(n.parentNode===t||n===t)}function _e(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function He(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!==o&&void 0!==o&&o!==n;){const{nodeType:e,nodeName:n}=o;if(e===r&&(t.includes(n)||t.includes(o)))return o;const{host:s}=o;o=s&&e===i?s:o.parentNode}return null}function Ve(e,t,n){const r=[];let i=e;for(;i&&(i=He(i,t,n),i&&(!n||n.contains(i)));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const o=r.length;return o?r[o-1]:null}function Be(e,t){let n=e.parentNode,r=[];for("string"===typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function We(e,t,n){const r=n.parentElement.querySelector(`.ht_clone_${e}`);return r?r.contains(t):null}function ze(e){return e&&e.length?e.filter(e=>!!e):[]}function je(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...e.filter(e=>{const r=e instanceof RegExp;return r&&t&&n.push(e),!r})),t?{regexFree:r,regexes:n}:r}function Ge(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)}function $e(e,t){"string"===typeof t&&(t=t.split(" ")),(t=ze(t)).length>0&&e.classList.add(...t)}function Ue(e,t){"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:n,regexes:r}=je(t,!0);n=ze(n),n.length>0&&e.classList.remove(...n),r.forEach(t=>{e.classList.forEach(n=>{t.test(n)&&e.classList.remove(n)})})}function Ke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,n]]),t.forEach(t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)})}function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:n,regexes:r}=je(t,!0);n.forEach(t=>{""!==t&&e.removeAttribute(t)}),r.forEach(t=>{e.getAttributeNames().forEach(n=>{t.test(n)&&e.removeAttribute(n)})})}function qe(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)qe(t[e])}}function Xe(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const Qe=/(<(.*)>|&(.*);)/;function Je(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Qe.test(t)?e.innerHTML=n?ve(t):t:Ze(e,t)}function Ze(e,t){const n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(Xe(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function et(e){const t=e.ownerDocument.documentElement,n=e.ownerDocument.defaultView;let r=e;for(;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return et(r.host.impl);if(r.host)return et(r.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.getComputedStyle(r).display)return!1;r=r.parentNode}return!0}function tt(e){const t=e.ownerDocument,n=t.defaultView,r=t.documentElement;let i,o,s,a=e;for(i=a.offsetLeft,o=a.offsetTop,s=a;(a=a.offsetParent)&&a!==t.body&&"offsetLeft"in a;)i+=a.offsetLeft,o+=a.offsetTop,s=a;return s&&"fixed"===s.style.position&&(i+=n.pageXOffset||r.scrollLeft,o+=n.pageYOffset||r.scrollTop),{left:i,top:o}}function nt(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function rt(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function it(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?nt(t):e.scrollTop}function ot(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?rt(t):e.scrollLeft}function st(e){let t=e.ownerDocument,n=t?t.defaultView:void 0;t||(t=e.document?e.document:e,n=t.defaultView);const r=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:o}=i.style;if([e,t,o].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:o}=n.getComputedStyle(i)),r.includes(e)||r.includes(t)||r.includes(o))return i;if(i.clientHeight<=i.scrollHeight+1&&(r.includes(o)||r.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(t)||r.includes(e)))return i;i=i.parentNode}return n}function at(e){const t=e.ownerDocument,n=t.defaultView;let r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;const e=n.getComputedStyle(r),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(o)||t.includes(s))return r;r=r.parentNode}return n}function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===n)return"width"===t?`${n.innerWidth}px`:"height"===t?`${n.innerHeight}px`:void 0;const r=e.style[t];if(""!==r&&void 0!==r)return r;const i=n.getComputedStyle(e);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function ct(e){return e.offsetWidth}function ut(e){return e.offsetHeight}function dt(e){return e.clientHeight||e.innerHeight}function ht(e){return e.clientWidth||e.innerWidth}function pt(e){return e.selectionStart?e.selectionStart:0}function gt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function ft(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){const i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(t,n),i.style.display=o}}}let mt;function vt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===mt&&(mt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);const r=t.offsetWidth;n.style.overflow="scroll";let i=t.offsetWidth;return r===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-i}(e)),mt}function wt(e){return e instanceof Window?e.document.body.scrollHeight>e.innerHeight:e.offsetWidth!==e.clientWidth}function bt(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}function Ct(e,t,n){e.style.transform=`translate3d(${t},${n},0)`}function yt(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function St(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function xt(e){return St(e)&&!1===e.hasAttribute("data-hot-input")}function Rt(e){return!e.parentNode}function Et(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ke(e,"contenteditable",!0),n&&Ke(e,"aria-hidden","true"),t&&$e(e,"invisibleSelection"),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)}function Tt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),n.removeAllRanges(),t&&Ue(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function kt(e){var t;const n=null===e||void 0===e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(n&&null!==n&&e instanceof n)}var Mt=n(6178);function Pt(e,t){const n=t.length;let r=0;for(;r<n;)e.push(t[r]),r+=1}function It(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const n=e.length,r=e[0].length;for(let i=0;i<n;i++)for(let n=0;n<r;n++)t[n]||(t[n]=[]),t[n][i]=e[i][n];return t}function At(e,t,n,r){let i=-1,o=e,s=n;Array.isArray(e)||(o=Array.from(e));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function Dt(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];t(e,n,r)&&(s+=1,o[s]=e),n+=1}return o}function Ft(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length,o=[];let s=-1;for(;n<i;){const e=r[n];s+=1,o[s]=t(e,n,r),n+=1}return o}function Ot(e,t){let n=0,r=e;Array.isArray(e)||(r=Array.from(e));const i=r.length;for(;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function Nt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,...i]=[...t];let o=r;return Ot(i,e=>{o=o.filter(t=>!e.includes(t))}),o}function Lt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function _t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=At(e,(e,t,r)=>e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:""),"");return i.trim()}function Ht(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function Vt(e){return"undefined"!==typeof e}function Bt(e){return"undefined"===typeof e}function Wt(e){return null===e||""===e||Bt(e)}const zt="length",jt=e=>parseInt(e,16),Gt=e=>parseInt(e,10),$t=(e,t,n)=>e.substr(t,n),Ut=e=>e.codePointAt(0)-65,Kt=e=>`${e}`.replace(/\-/g,"");let Yt=!1;const qt={invalid:()=>_t`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return _t`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>_t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Xt={invalid:()=>_t`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:n}=e;return _t`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>_t`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Qt(e,t){const n=!Wt(e),r="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="15.3.0";let o,s="invalid",a="invalid";const l=function(e){let t=[][zt],n=t;if(e[zt]!==Ut("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Ut(i.shift());o;o=Ut(i.shift()||"A"))--o<""[zt]?n|=(Gt(`${Gt(jt(r)+(jt($t(e,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=$t(e,o,o?1===i[zt]?9:8:6);return n===t}(e=Kt(e||""));if(n||r||l)if(l){const t=Mt("29/04/2025","DD/MM/YYYY"),n=Math.floor(t.toDate().getTime()/864e5),r=jt($t(Kt(c=e),jt("12"),Ut("F")))/(jt($t(Kt(c),Ut("B"),~~![][zt]))||9);o=Mt(864e5*(r+1),"x").format("MMMM DD, YYYY"),n>r?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";var c;if("undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)&&(s="valid",a="valid"),!Yt&&"valid"!==s){qt[s]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===s?"info":"warn"](qt[s]({keyValidityDate:o,hotVersion:i})),Yt=!0}if("valid"!==a&&t.parentNode){if(Xt[a]({keyValidityDate:o,hotVersion:i})){const e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=Xt[a]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling)}}}function Jt(e){return"function"===typeof e}function Zt(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(()=>{t=e.apply(this,o)},n),t}}function en(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,n.concat(r))}}function tn(e,t,n,r,i,o,s,a){return Vt(a)?e.call(t,n,r,i,o,s,a):Vt(s)?e.call(t,n,r,i,o,s):Vt(o)?e.call(t,n,r,i,o):Vt(i)?e.call(t,n,r,i):Vt(r)?e.call(t,n,r):Vt(n)?e.call(t,n):e.call(t)}function nn(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},hn(e,(e,n)=>{"__children"!==n&&(e&&"object"===typeof e&&!Array.isArray(e)?t[n]=nn(e):Array.isArray(e)?e.length&&"object"===typeof e[0]&&!Array.isArray(e[0])?t[n]=[nn(e[0])]:t[n]=[]:t[n]=null)})),t}function rn(e,t,n){const r=Array.isArray(n);return hn(t,(t,i)=>{(!1===r||n.includes(i))&&(e[i]=t)}),e}function on(e,t){hn(t,(n,r)=>{t[r]&&"object"===typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),on(e[r],t[r])):e[r]=t[r]})}function sn(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}function an(e){const t={};return hn(e,(e,n)=>{t[n]=e}),t}function ln(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ot(n,t=>{e.MIXINS.push(t.MIXIN_NAME),hn(t,(t,n)=>{if(void 0!==e.prototype[n])throw new Error(`Mixin conflict. Property '${n}' already exist and cannot be overwritten.`);if("function"===typeof t)e.prototype[n]=t;else{const r=function(e,t){const n=`_${e}`;return function(){return void 0===this[n]&&(this[n]=(e=>{let t=e;return(Array.isArray(t)||un(t))&&(t=sn(t)),t})(t)),this[n]}},i=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:i(n),configurable:!0})}})}),e}function cn(e,t){return JSON.stringify(e)===JSON.stringify(t)}function un(e){return"[object Object]"===Object.prototype.toString.call(e)}function dn(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function hn(e,t){for(const n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function pn(e,t,n){if("string"!==typeof t)return;const r=t.split(".");let i=e;r.forEach((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==r.length-1?(mn(i,e)||(i[e]={}),i=i[e]):i[e]=n)})}function gn(e){if(!un(e))return 0;const t=function(e){let n=0;return un(e)?hn(e,(e,r)=>{"__children"!==r&&(n+=t(e))}):n+=1,n};return t(e)}function fn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const n=`_${t}`,r={_touched:!1,[n]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[n]},set(e){this._touched=!0,this[n]=e},enumerable:!0,configurable:!0}),r}function mn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function vn(e){return window.requestAnimationFrame(e)}function wn(e){window.cancelAnimationFrame(e)}function bn(){return"ontouchstart"in window}let Cn;const yn=e=>{const t={value:!1,test:(n,r)=>{t.value=e(n,r)}};return t},Sn={chrome:yn((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:yn(e=>/CriOS/.test(e)),edge:yn(e=>/Edge/.test(e)),edgeWebKit:yn(e=>/EdgiOS/.test(e)),firefox:yn(e=>/Firefox/.test(e)),firefoxWebKit:yn(e=>/FxiOS/.test(e)),mobile:yn(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:yn((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},xn={mac:yn(e=>/^Mac/.test(e)),win:yn(e=>/^Win/.test(e)),linux:yn(e=>/^Linux/.test(e)),ios:yn(e=>/iPhone|iPad|iPod/i.test(e))};function Rn(){return Sn.chrome.value}function En(){return Sn.firefox.value}function Tn(){return Sn.safari.value}function kn(){return Sn.mobile.value}function Mn(){return xn.ios.value}function Pn(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&xn.mac.value}function In(){return xn.win.value}function An(){return xn.mac.value}"undefined"!==typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hn(Sn,n=>{let{test:r}=n;r(e,t)})}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};hn(xn,t=>{let{test:n}=t;n(e)})}());const Dn={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:En()?182:174,AUDIO_MUTE:En()?181:173,AUDIO_UP:En()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Fn=[Dn.ALT,Dn.ARROW_DOWN,Dn.ARROW_LEFT,Dn.ARROW_RIGHT,Dn.ARROW_UP,Dn.AUDIO_DOWN,Dn.AUDIO_MUTE,Dn.AUDIO_UP,Dn.BACKSPACE,Dn.CAPS_LOCK,Dn.DELETE,Dn.END,Dn.ENTER,Dn.ESCAPE,Dn.F1,Dn.F2,Dn.F3,Dn.F4,Dn.F5,Dn.F6,Dn.F7,Dn.F8,Dn.F9,Dn.F10,Dn.F11,Dn.F12,Dn.F13,Dn.F14,Dn.F15,Dn.F16,Dn.F17,Dn.F18,Dn.F19,Dn.HOME,Dn.INSERT,Dn.MEDIA_NEXT,Dn.MEDIA_PLAY_PAUSE,Dn.MEDIA_PREV,Dn.MEDIA_STOP,Dn.NULL,Dn.NUM_LOCK,Dn.PAGE_DOWN,Dn.PAGE_UP,Dn.PAUSE,Dn.SCROLL_LOCK,Dn.SHIFT,Dn.TAB];function On(e){return Fn.includes(e)}function Nn(e,t){const n=t.split("|");let r=!1;return Ot(n,t=>{if(e===Dn[t])return r=!0,!1}),r}function Ln(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function _n(e){return!1===e.isImmediatePropagationEnabled}function Hn(e){return 2===e.button}function Vn(e){return 0===e.button}function Bn(){Vt(console)&&console.warn(...arguments)}function Wn(){Vt(console)&&console.error(...arguments)}const zn=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],jn=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Gn=new Map([[]]);function $n(e,t,n){Un(e,t),t.set(e,n)}function Un(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(e,t,n){return e.set(qn(e,t),n),n}function Yn(e,t){return e.get(qn(e,t))}function qn(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Xn=new WeakMap,Qn=new WeakMap,Jn=new WeakMap,Zn=new WeakSet;class er{constructor(){var e,t;Un(e=this,t=Zn),t.add(e),$n(this,Xn,new Map),$n(this,Qn,new Map),$n(this,Jn,new Set),zn.forEach(e=>qn(Zn,this,tr).call(this,e))}getHooks(e){var t;return null!==(t=Yn(Xn,this).get(e))&&void 0!==t?t:[]}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Yn(Xn,this).has(e)||(qn(Zn,this,tr).call(this,e),zn.push(e));const r=Yn(Xn,this).get(e);if(r.find(e=>e.callback===t))return;const i=Number.isInteger(n.orderIndex)?n.orderIndex:0,o=!!n.runOnce,s=!!n.initialHook;let a=!1;if(s){const e=r.find(e=>e.initialHook);e&&(e.callback=t,a=!0)}if(!a){r.push({callback:t,orderIndex:i,runOnce:o,initialHook:s,skip:!1});let n=Yn(Jn,this).has(e);n||0===i||(n=!0,Yn(Jn,this).add(e)),n&&r.length>1&&Yn(Xn,this).set(e,r.toSorted((e,t)=>e.orderIndex-t.orderIndex))}}has(e){return Yn(Xn,this).has(e)&&Yn(Xn,this).get(e).length>0}remove(e,t){if(!Yn(Xn,this).has(e))return!1;const n=Yn(Xn,this).get(e),r=n.find(e=>e.callback===t);if(r){let t=Yn(Qn,this).get(e);return r.skip=!0,t+=1,t>100&&(Yn(Xn,this).set(e,n.filter(e=>!e.skip)),t=0),Yn(Qn,this).set(e,t),!0}return!1}destroy(){Yn(Xn,this).clear(),Yn(Qn,this).clear(),Kn(Xn,this,null),Kn(Qn,this,null)}}function tr(e){Yn(Xn,this).set(e,[]),Yn(Qn,this).set(e,0)}function nr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const rr=_t`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ir{constructor(){nr(this,"globalBucket",new er)}static getSingleton(){return or}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new er),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Ot(t,t=>this.add(e,t,n)):(jn.has(e)&&Bn(fe(rr,{hookName:e,removedInVersion:jn.get(e)})),Gn.has(e)&&Bn(Gn.get(e)),this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!1})),this}once(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?Ot(t,t=>this.once(e,t,n)):this.getBucket(n).add(e,t,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?Ot(t,t=>this.addAsFixed(e,t,n)):this.getBucket(n).add(e,t,{initialHook:!0}),this}remove(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(n).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,n,r,i,o,s,a){{const l=this.getBucket().getHooks(t),c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=tn(l[u].callback,e,n,r,i,o,s,a);void 0!==c&&(n=c),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback),u+=1}}{const l=this.getBucket(e).getHooks(t),c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=tn(l[u].callback,e,n,r,i,o,s,a);void 0!==c&&(n=c),l[u]&&l[u].runOnce&&this.remove(t,l[u].callback,e),u+=1}}return n}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||zn.push(e)}deregister(e){this.isRegistered(e)&&zn.splice(zn.indexOf(e),1)}isDeprecated(e){return Gn.has(e)||jn.has(e)}isRegistered(e){return zn.indexOf(e)>=0}getRegistered(){return zn}}const or=new ir;const sr=new Map;function ar(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";sr.has(e)||sr.set(e,new Map);const t=sr.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const lr=new WeakMap,{register:cr,getItem:ur,hasItem:dr,getNames:hr,getValues:pr}=ar("editors");function gr(e){const t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},ir.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function fr(e,t){let n;if("function"===typeof e)lr.get(e)||vr(null,e),n=lr.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=ur(e)}if(!n)throw Error(`No editor registered under name "${e}"`);return n.getInstance(t)}function mr(e){if("function"===typeof e)return e;if(!dr(e))throw Error(`No registered editor found under "${e}" name`);return ur(e).getConstructor()}function vr(e,t){e&&"string"!==typeof e&&(e=(t=e).EDITOR_TYPE);const n=new gr(t);"string"===typeof e&&cr(e,n),lr.set(t,n)}function wr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let br=0;const Cr=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;wr(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){n.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),Ln(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:r,eventManager:this}),e.addEventListener(t,i,r),br+=1,()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;for(;o;)if(o-=1,r=this.context.eventListeners[o],r.event===t&&r.element===e){if(n&&n!==r.callback)continue;if(i&&r.eventManager!==this)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),br-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),br-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,r=e;n||(n=e.ownerDocument?e.ownerDocument:e,r=n.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}};function yr(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Sr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xr(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Rr=new WeakSet;class Er{constructor(e,t,n){yr(this,Rr),Sr(this,"hot",void 0),Sr(this,"tableMeta",void 0),Sr(this,"selection",void 0),Sr(this,"eventManager",void 0),Sr(this,"destroyed",!1),Sr(this,"activeEditor",void 0),Sr(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=n,this.eventManager=new Cr(e),this.hot.addHook("afterDocumentKeyDown",e=>xr(Rr,this,Tr).call(this,e)),this.hot.addHook("beforeCompositionStart",e=>xr(Rr,this,Tr).call(this,e)),this.hot.view._wt.update("onCellDblClick",(e,t,n)=>xr(Rr,this,kr).call(this,e,t,n))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,e=>{e&&this.prepareEditor()});const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:n,col:r}=t,i=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable())return void this.clearActiveEditor();const a=this.hot.getCell(n,r,!0);if(a){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(s),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=fr(e,this.hot),this.activeEditor.prepare(n,r,t,a,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const r=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,n);t instanceof MouseEvent&&"boolean"!==typeof i&&(i=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:n,col:r}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,s=i.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!t||s)}moveSelectionAfterEnter(e){const t={..."function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Tr(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||_n(e))return;const{keyCode:n}=e,r=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(On(n)||function(e){return[Dn.CONTROL,Dn.COMMAND_LEFT,Dn.COMMAND_RIGHT,Dn.COMMAND_FIREFOX].includes(e)}(n)||r||this.isEditorOpened()||this.openEditor("",e))}function kr(e,t){t.isCell()&&this.openEditor(null,e,!0)}const Mr=new WeakMap;Er.getInstance=function(e,t,n){let r=Mr.get(e);return r||(r=new Er(e,t,n),Mr.set(e,r)),r};const Pr=Er;function Ir(e,t,n){Ar(e,t),t.set(e,n)}function Ar(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dr(e,t){return e.get(Or(e,t))}function Fr(e,t,n){return e.set(Or(e,t),n),n}function Or(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Nr=Object.freeze({CELL:"cell",MIXED:"mixed"});var Lr=new WeakMap,_r=new WeakMap,Hr=new WeakMap,Vr=new WeakMap,Br=new WeakMap,Wr=new WeakSet;class zr{constructor(e){var t,n,r=this;Ar(t=this,n=Wr),n.add(t),Ir(this,Lr,void 0),Ir(this,_r,void 0),Ir(this,Hr,1),Ir(this,Vr,null),Ir(this,Br,new Map);const i=e.getSettings();Fr(Lr,this,e),Fr(_r,this,i.imeFastEdit?Nr.MIXED:Nr.CELL),Dr(Lr,this).addHook("afterUpdateSettings",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Or(Wr,r,Ur).call(r,...t)}),Dr(Lr,this).addHook("afterSelection",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Or(Wr,r,Gr).call(r,...t)}),Dr(Lr,this).addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Or(Wr,r,Gr).call(r,...t)}),Dr(Lr,this).addHook("afterSelectionEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Or(Wr,r,$r).call(r,...t)})}getFocusMode(){return Dr(_r,this)}setFocusMode(e){Object.values(Nr).includes(e)?Fr(_r,this,e):Bn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Dr(Hr,this)}setRefocusDelay(e){Fr(Hr,this,e)}setRefocusElementGetter(e){Fr(Vr,this,e)}getRefocusElement(){var e;return"function"===typeof Dr(Vr,this)?Dr(Vr,this).call(this):null===(e=Dr(Lr,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=e=>{var t,n;const r=null===(t=Dr(Lr,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r)return;let i=Dr(Lr,this).runHooks("modifyFocusedElement",r.row,r.col,e);kt(i)||(i=e),!i||null!==(n=Dr(Lr,this).getActiveEditor())&&void 0!==n&&n.isOpened()||i.focus({preventScroll:!0})};e?t(e):Or(Wr,this,jr).call(this,e=>t(e))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dr(Hr,this);var n,r;!Dr(Lr,this).getSettings().imeFastEdit||null!==(e=Dr(Lr,this).getActiveEditor())&&void 0!==e&&e.isOpened()||(null===(n=Dr(Lr,this).getActiveEditor())||void 0===n||null===(r=n.refreshValue)||void 0===r||r.call(n),Dr(Br,this).has(t)||Dr(Br,this).set(t,Zt(()=>{var e;Dr(Lr,this).isDestroyed||(null===(e=this.getRefocusElement())||void 0===e||e.select())},t)),Dr(Br,this).get(t)())}}function jr(e){var t;const n=null===(t=Dr(Lr,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!n||!Dr(Lr,this).selection.isCellVisible(n))return void e(null);const r=Dr(Lr,this).getCell(n.row,n.col,!0);null===r?Dr(Lr,this).addHookOnce("afterScroll",()=>{e(Dr(Lr,this).getCell(n.row,n.col,!0))}):e(r)}function Gr(){Or(Wr,this,jr).call(this,e=>{const{activeElement:t}=Dr(Lr,this).rootDocument;t&&xt(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function $r(){Or(Wr,this,jr).call(this,e=>{this.getFocusMode()===Nr.MIXED&&"TD"===(null===e||void 0===e?void 0:e.nodeName)&&this.refocusToEditorTextarea()})}function Ur(e){"boolean"===typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?Nr.MIXED:Nr.CELL)}const Kr={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Yr=new RegExp(Object.keys(Kr).map(e=>`(${e})`).join("|"),"gi");function qr(e){const t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=n?1:0,d=t?1:0;for(let h=0;h<o;h+=1){const r=t&&0===h,o=[];for(let t=0;t<s;t+=1){const s=!r&&n&&0===t;let a="";if(r)a=`<th>${e.getColHeader(t-u)}</th>`;else if(s)a=`<th>${e.getRowHeader(h-d)}</th>`;else{const n=i[h][t],{hidden:r,rowspan:o,colspan:s}=e.getCellMeta(h-d,t-u);if(!r){const e=[];if(o&&e.push(`rowspan="${o}"`),s&&e.push(`colspan="${s}"`),Wt(n))a=`<td ${e.join(" ")}></td>`;else{const t=n.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");a=`<td ${e.join(" ")}>${t}</td>`}}}o.push(a)}const a=["<tr>",...o,"</tr>"].join("");r?l.splice(1,0,a):c.splice(-1,0,a)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function Xr(e){const t=e.length,n=["<table>"];for(let r=0;r<t;r+=1){const i=e[r],o=i.length,s=[];0===r&&n.push("<tbody>");for(let e=0;e<o;e+=1){const t=i[e],n=Wt(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${n}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function Qr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const n=Array.from(new Set([".",...t])).map(e=>`\\${e}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===n&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function Jr(e){return Qr(e,[","])}function Zr(e,t,n){let r=-1;for("function"===typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function ei(e,t,n){let r=e+1;for("function"===typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}function ti(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function ni(e,t,n){return Math.min(e,t)===e?t:Math.max(e,n)===e?n:e}const ri="asc",ii=new Map([[ri,[-1,1]],["desc",[1,-1]]]),oi=e=>`The priority '${e}' is already declared in a map.`,si=e=>`The priority '${e}' is not a number.`;const ai=e=>`The id '${e}' is already declared in a map.`;function li(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function n(){return[...t]}function r(e){return t.has(e)}return e=Jt(e)?e:ai,{addItem:function(n,i){if(r(n))throw new Error(e(n));t.set(n,i)},clear:function(){t.clear()},getId:function(e){const[t]=n().find(t=>{let[n,r]=t;return e===r&&n})||[null];return t},getItem:function(e){return t.get(e)},getItems:n,hasItem:r,removeItem:function(e){return t.delete(e)}}}const ci=e=>`'${e}' value is already declared in a unique set.`;const ui=e=>`There is already registered "${e}" plugin.`,di=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Map;return e=Jt(e)?e:oi,t=Jt(t)?t:si,{addItem:function(r,i){if(!Qr(r))throw new Error(t(r));if(n.has(r))throw new Error(e(r));n.set(r,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ri;const[t,r]=ii.get(e)||ii.get(ri);return[...n].sort((e,n)=>e[0]<n[0]?t:r).map(e=>e[1])}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),hi=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Jt(e)?e:ci,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:ui}),pi=li({errorIdExists:ui});function gi(){return[...di.getItems(),...hi.getItems()]}function fi(e){const t=he(e);return pi.getItem(t)}function mi(e,t,n){[e,t,n]=function(e,t,n){"function"===typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),void 0===fi(e)&&function(e,t,n){const r=he(e);if(pi.hasItem(r))throw new Error(ui(r));void 0===n?hi.addItem(r):di.addItem(n,r);pi.addItem(r,t)}(e,t,n)}const{register:vi,getItem:wi,hasItem:bi,getNames:Ci,getValues:yi}=ar("renderers");function Si(e){if("function"===typeof e)return e;if(!bi(e))throw Error(`No registered renderer found under "${e}" name`);return wi(e)}function xi(e,t){"string"!==typeof e&&(e=(t=e).RENDERER_TYPE),vi(e,t)}const{register:Ri,getItem:Ei,hasItem:Ti,getNames:ki,getValues:Mi}=ar("validators");function Pi(e,t){"string"!==typeof e&&(e=(t=e).VALIDATOR_TYPE),Ri(e,t)}function Ii(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Ai(e,t){return e.get(Fi(e,t))}function Di(e,t,n){return e.set(Fi(e,t),n),n}function Fi(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Oi=new WeakMap,Ni=new WeakMap,Li=new WeakMap,_i=new WeakMap,Hi=new WeakMap,Vi=new WeakMap,Bi=new WeakMap,Wi=new WeakMap,zi=new WeakMap,ji=new WeakMap;const Gi=class{constructor(e,t,n,r,i,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Ii(this,Oi,void 0),Ii(this,Ni,void 0),Ii(this,Li,void 0),Ii(this,_i,void 0),Ii(this,Hi,void 0),Ii(this,Vi,void 0),Ii(this,Bi,void 0),Ii(this,Wi,void 0),Ii(this,zi,[null,null]),Ii(this,ji,[null,null]),Di(Oi,this,n),Di(Ni,this,t),Di(Li,this,i),Di(_i,this,o),Di(Hi,this,s),Di(Vi,this,r),Di(Bi,this,e),this.registerEvents()}registerEvents(){Ai(Vi,this).addEventListener(Ai(Li,this).holder,"contextmenu",e=>this.onContextMenu(e)),Ai(Vi,this).addEventListener(Ai(Li,this).TABLE,"mouseover",e=>this.onMouseOver(e)),Ai(Vi,this).addEventListener(Ai(Li,this).TABLE,"mouseout",e=>this.onMouseOut(e));const e=()=>{Ai(Vi,this).addEventListener(Ai(Li,this).holder,"touchstart",e=>this.onTouchStart(e)),Ai(Vi,this).addEventListener(Ai(Li,this).holder,"touchend",e=>this.onTouchEnd(e)),this.momentumScrolling||(this.momentumScrolling={}),Ai(Vi,this).addEventListener(Ai(Li,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ai(Oi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ai(Oi,this).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{Ai(Vi,this).addEventListener(Ai(Li,this).holder,"mouseup",e=>this.onMouseUp(e)),Ai(Vi,this).addEventListener(Ai(Li,this).holder,"mousedown",e=>this.onMouseDown(e))};kn()?e():(bn()&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(Ai(Wi,this)&&t){const[e,n]=[t.row,Ai(Wi,this).from.row],[r,i]=[t.col,Ai(Wi,this).from.col];return e===n&&r===i}return!1}parentCell(e){const t={},n=Ve(e,["TD","TH"],Ai(Li,this).TABLE);return n?(t.coords=Ai(Li,this).getCoords(n),t.TD=n):Ge(e,"wtBorder")&&Ge(e,"current")?(t.coords=Ai(_i,this).getFocusSelection().cellRange.highlight,t.TD=Ai(Li,this).getCell(t.coords)):Ge(e,"wtBorder")&&Ge(e,"area")&&Ai(_i,this).getAreaSelection().cellRange&&(t.coords=Ai(_i,this).getAreaSelection().cellRange.to,t.TD=Ai(Li,this).getCell(t.coords)),t}onMouseDown(e){const t=Ai(Ni,this).rootDocument.activeElement,n=en(Ne,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||n(0)===t||n(1)===t))return;const i=this.parentCell(r);Ge(r,"corner")?Ai(Oi,this).getSetting("onCellCornerMouseDown",e,r):i.TD&&Ai(Oi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(Ai(ji,this)[0]=i.TD,clearTimeout(Ai(zi,this)[0]),Ai(zi,this)[0]=setTimeout(()=>{Ai(ji,this)[0]=null},1e3))}onContextMenu(e){if(Ai(Oi,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!Ai(Oi,this).has("onCellMouseOver"))return;const t=Ai(Li,this).TABLE,n=Ve(e.target,["TD","TH"],t),r=Ai(Hi,this)||this;n&&n!==r.lastMouseOver&&Be(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,Ai(Li,this).getCoords(n),n))}onMouseOut(e){if(!Ai(Oi,this).has("onCellMouseOut"))return;const t=Ai(Li,this).TABLE,n=Ve(e.target,["TD","TH"],t),r=Ve(e.relatedTarget,["TD","TH"],t),i=Ai(Hi,this)||this;n&&n!==r&&Be(n,t)&&(this.callListener("onCellMouseOut",e,Ai(Li,this).getCoords(n),n),null===r&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&Ai(Oi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===Ai(ji,this)[0]&&t.TD===Ai(ji,this)[1]?(Ge(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),Ai(ji,this)[0]=null,Ai(ji,this)[1]=null):t.TD===Ai(ji,this)[0]&&(Ai(ji,this)[1]=t.TD,clearTimeout(Ai(zi,this)[1]),Ai(zi,this)[1]=setTimeout(()=>{Ai(ji,this)[1]=null},500)))}onTouchStart(e){Di(Wi,this,Ai(_i,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=Vt(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&Ai(Oi,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];Mn()&&(Sn.chromeWebKit.value||Sn.firefoxWebKit.value)&&this.selectedCellWasTouched(n)&&!t.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){const i=Ai(Oi,this).getSettingPure(e);i&&i(t,n,r,Ai(Bi,this).call(this))}destroy(){clearTimeout(Ai(zi,this)[0]),clearTimeout(Ai(zi,this)[1]),Ai(Vi,this).destroy()}};function $i(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ui=class{constructor(e,t,n){$i(this,"offset",void 0),$i(this,"total",void 0),$i(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function Ki(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Yi=class{constructor(e,t,n){Ki(this,"offset",void 0),Ki(this,"total",void 0),Ki(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function qi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Xi{constructor(){qi(this,"currentSize",0),qi(this,"nextSize",0),qi(this,"currentOffset",0),qi(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Qi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ji{constructor(){Qi(this,"size",new Xi),Qi(this,"workingSpace",0),Qi(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}function Zi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eo{constructor(e,t){Zi(this,"order",[]),this.order=[...Array(t).keys()].map(t=>e+t)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function to(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class no{constructor(e){to(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:t,nextSize:n}=e.getViewSize();let r=Math.max(n,t);if(0===r)return[];const{currentOffset:i,nextOffset:o}=e.getViewSize(),s=new eo(i,t),a=new eo(o,n),l=[];for(let c=0;c<r;c++){const t=s.get(c),i=a.get(c);if(-1===i)l.push(["remove",t]);else if(-1===t)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?l.push(["append",i]):l.push(["prepend",i]);else if(i>t)s.has(i)&&(s.remove(i),n<=s.length&&(r-=1)),l.push(["replace",i,t]);else if(i<t){const e=s.prepend(i);l.push(["insert_before",i,t,e])}else l.push(["none",i])}return l}}function ro(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class io{constructor(e,t){ro(this,"rootNode",void 0),ro(this,"nodesPool",void 0),ro(this,"sizeSet",new Ji),ro(this,"collectedNodes",[]),ro(this,"viewDiffer",new no(this.sizeSet)),ro(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:t}=this,[n,r,i,o]=e,s=this.nodesPool(r);switch(this.collectedNodes.push(s),n){case"prepend":t.insertBefore(s,t.firstChild);break;case"append":t.appendChild(s);break;case"insert_before":t.insertBefore(s,this.nodesPool(i)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(s,this.nodesPool(i));break;case"remove":t.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class oo extends io{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function so(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ao{constructor(e){so(this,"nodeType",void 0),so(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){const n="number"===typeof t?`${e}x${t}`:e.toString();if(this.pool.has(n))return this.pool.get(n);const r=this.rootDocument.createElement(this.nodeType);return this.pool.set(n,r),r}}function lo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class co{constructor(e,t){lo(this,"nodesPool",null),lo(this,"nodeType",void 0),lo(this,"rootNode",void 0),lo(this,"table",null),lo(this,"renderedNodes",0),this.nodesPool="string"===typeof e?new ao(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function uo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ho extends co{constructor(){super("TH"),uo(this,"orderViews",new WeakMap),uo(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new oo(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:r,cells:i}=this.table;for(let o=0;o<e;o++){const e=this.table.renderedRowToSource(o),s=r.getRenderedNode(o);this.sourceRowIndex=e;const a=this.obtainOrderView(s),l=i.obtainOrderView(s);a.appendView(l).setSize(n).setOffset(0).start();for(let r=n-1;r>=0;r--){a.render();const n=a.getCurrentNode();n.className="",n.removeAttribute("style"),Ye(n,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ke(n,[Ce(),Re(),Ie(r+1),we(-1)]),t[r](e,n,r)}a.end()}}}class po extends co{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,i=r+t;for(let t=0,s=e;t<s;t++){for(n=this.rootNode.childNodes[t],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Xe(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ke(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:n,rowHeadersCount:r}=this.table,i=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Ke(i,[Se(),Pe(t+1)]);for(let o=-1*r;o<n;o+=1){const n=this.table.renderedColumnToSource(o),s=i.childNodes[o+r];s.className="",s.removeAttribute("style"),Ye(s,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ke(s,[Ie(o+1+this.table.rowHeadersCount),we(-1),ye(),...o>=0?[xe()]:[Se()]]),e[t](n,s,t)}}}}let go=!1;class fo extends co{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!go&&e>1e3&&(go=!0,Bn(_t`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<t;r++){const e=this.table.renderedColumnToSource(r),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[r].style.width=`${t}px`}for(let r=0;r<e;r++){const e=this.table.renderedColumnToSource(r),n=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[r+t].style.width=`${n}px`}const n=this.rootNode.firstChild;n&&$e(n,"rowHeader")}}function mo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vo="ht__row_even",wo="ht__row_odd";let bo=!1;class Co extends co{constructor(e){super("TR",e),mo(this,"orderView",void 0),this.orderView=new io(e,e=>this.nodesPool.obtain(e))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!bo&&e>1e3&&(bo=!0,Bn(_t`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ke(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const e=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(r);var t,n;if(this.table.isAriaEnabled())Ke(e,[Se(),Pe(i+(null!==(t=null===(n=this.table.rowUtils)||void 0===n||null===(n=n.dataAccessObject)||void 0===n?void 0:n.columnHeaders.length)&&void 0!==t?t:0)+1)]);(i+1)%2===0?Ge(e,vo)||(Ue(e,wo),$e(e,vo)):Ge(e,wo)||(Ue(e,vo),$e(e,wo))}this.orderView.end()}}function yo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class So extends co{constructor(){super("TD"),yo(this,"orderViews",new WeakMap),yo(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new oo(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:r}=this.table;for(let s=0;s<e;s++){const e=this.table.renderedRowToSource(s),a=n.getRenderedNode(s);this.sourceRowIndex=e;const l=this.obtainOrderView(a),c=r.obtainOrderView(a);l.prependView(c).setSize(t).setOffset(0).start();for(let n=0;n<t;n++){l.render();const t=this.table.renderedColumnToSource(n),r=l.getCurrentNode();var i,o;if(Ge(r,"hide")||(r.className=""),r.removeAttribute("style"),r.removeAttribute("dir"),Ye(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,t,r),this.table.isAriaEnabled())Ke(r,[...r.hasAttribute("role")?[]:[be()],we(-1),Ie(t+(null!==(i=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function xo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ro{constructor(e){let{cellRenderer:t,stylesHandler:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};xo(this,"rootNode",void 0),xo(this,"rootDocument",void 0),xo(this,"rowHeaders",null),xo(this,"columnHeaders",null),xo(this,"colGroup",null),xo(this,"rows",null),xo(this,"cells",null),xo(this,"rowFilter",null),xo(this,"columnFilter",null),xo(this,"rowUtils",null),xo(this,"columnUtils",null),xo(this,"rowsToRender",0),xo(this,"columnsToRender",0),xo(this,"rowHeaderFunctions",[]),xo(this,"rowHeadersCount",0),xo(this,"columnHeaderFunctions",[]),xo(this,"columnHeadersCount",0),xo(this,"cellRenderer",void 0),xo(this,"activeOverlayName",void 0),xo(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const e=t.getRenderedNode(n),r=this.rowUtils;if(e.firstChild){const t=this.renderedRowToSource(n),i=r.getHeightByOverlayName(t,this.activeOverlayName),o=this.stylesHandler.areCellsBorderBox()?0:1;e.firstChild.style.height=i?i-o+"px":""}}}}class Eo{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:o,cellRenderer:s,stylesHandler:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new Ro(e,{cellRenderer:s,stylesHandler:a}),this.renderer.setRenderers({rowHeaders:new ho,columnHeaders:new po(t),colGroup:new fo(n),rows:new Co(r),cells:new So}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function To(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ko{constructor(e,t){To(this,"dataAccessObject",void 0),To(this,"wtSettings",void 0),To(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(t=e.getSetting("onModifyRowHeaderWidth",t),null!==t&&void 0!==t){const n=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let e=0;e<n;e++){let n=Array.isArray(t)?t[e]:t;n=null===n||void 0===n?r:n,this.headerWidths.set(e,n)}}}}function Mo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Po{constructor(e,t){Mo(this,"dataAccessObject",void 0),Mo(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}getHeightByOverlayName(e,t){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(n=void 0===n?r:Math.max(n,r)),n}}const Io="top",Ao="bottom",Do="inline_start",Fo="top_inline_start_corner",Oo="bottom_inline_start_corner",No=[Io,Ao,Do,Fo,Oo],Lo=new Map([[Io,`ht_clone_${Io}`],[Ao,`ht_clone_${Ao}`],[Do,`ht_clone_${Do} ht_clone_left`],[Fo,`ht_clone_${Fo} ht_clone_top_left_corner`],[Oo,`ht_clone_${Oo} ht_clone_bottom_left_corner`]]);function _o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ho=class{constructor(e,t,n,r,i){_o(this,"wtSettings",null),_o(this,"domBindings",void 0),_o(this,"TBODY",null),_o(this,"THEAD",null),_o(this,"COLGROUP",null),_o(this,"hasTableHeight",!0),_o(this,"hasTableWidth",!0),_o(this,"isTableVisible",!1),_o(this,"tableOffset",0),_o(this,"holderOffset",0),this.domBindings=n,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,qe(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new Po(this.dataAccessObject,this.wtSettings),this.columnUtils=new ko(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Eo({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ge(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ke(n,[["role","presentation"]]),n}createHider(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ge(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ke(n,[["role","presentation"]]),n}createHolder(e){const t=e.parentNode;let n;return t&&t.nodeType===Node.ELEMENT_NODE&&Ge(t,"wtHolder")||(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",Ke(n,[we(-1)]),t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ke(n.parentNode,[["role","presentation"]])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ke(n,[["role","presentation"]]),n}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:n,wtViewport:r}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),s=t.getSetting("rowHeaders"),a=s.length,l=t.getSetting("columnHeaders"),c=l.length;let u=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=tt(this.holder),u=r.createCalculators(u),a&&!t.getSetting("fixedColumnsStart"))){const e=n.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=tt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=Math.max(this.getFirstRenderedRow(),0),t=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new Yi(e,i,c),this.columnFilter=new Ui(t,o,a);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),u=!0!==e.skipRender}u&&(this.tableRenderer.setHeaderContentRenderers(s,l),(this.is(Ao)||this.is(Oo))&&this.tableRenderer.setHeaderContentRenderers(s,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ao))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Ao)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let i,o,s;const a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),o=this.getColumnHeader(t,n),o&&(s=dt(o),(!i&&r<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(a)?null!==a[n]&&void 0!==a[n]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(a[n]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a[n]||a))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let r=0,i=e.getSetting("columnHeaders").length;r<i;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=`${n[r]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(Ao))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let n=0;n<e;n++){const e=this.rowFilter.renderedToSource(n);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,n=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n,!this.isMaster,"render");if(r&&Array.isArray(r)&&([t,n]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,n=null;var r,i;e<0?(t=null===(r=this.rowFilter)||void 0===r?void 0:r.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY);return void 0!==t&&void 0!==n&&(!(n.childNodes.length<t+1)&&n.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.THEAD.childNodes[t];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(e=>{const r=e.childNodes[n];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const n=this.rowFilter.sourceToRendered(e),r=n<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):n,i=(n<0?this.THEAD:this.TBODY).childNodes[r];return null===i||void 0===i?void 0:i.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<n;r++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null===n||void 0===n?void 0:n.childNodes[r];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=He(t,["TD","TH"])),null===t)return null;const n=t.parentNode;if(!n)return null;const r=n.parentNode;let i=function(e){let t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}(n),o=t.cellIndex;if(We(Fo,t,this.wtRootElement)||We(Io,t,this.wtRootElement))"THEAD"===r.nodeName&&(i-=r.childNodes.length);else if(We(Oo,t,this.wtRootElement)||We(Ao,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i}else r===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter&&(i=this.rowFilter.renderedToSource(i));We(Fo,t,this.wtRootElement)||We(Do,t,this.wtRootElement)||We(Oo,t,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const s=this.wtSettings.getSetting("onModifyGetCoordsElement",i,o);return s&&Array.isArray(s)&&([i,o]=s),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),n=dt(this.TBODY)-1,r=this.wot.stylesHandler.areCellsBorderBox(),i=r?ut:dt,o=r?0:1,s=r?1:0;let a,l,c,u,d;if(t!==n||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;){e-=1,c=this.rowFilter.renderedToSource(e),a=this.getRowHeight(c),u=this.getTrForRow(c),d=u.querySelector("th");const t=0===c?s:0;l=d?i(d):i(u)-o,(!a&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<l-t||a<l)&&(r||(l+=1),this.dataAccessObject.wtViewport.oversizedRows[c]=l)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ct(this.TABLE)}getHeight(){return ut(this.TABLE)}getTotalWidth(){const e=ct(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=ut(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return et(this.TABLE)}_modifyRowHeaderWidth(e){let t=Jt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},Vo={getFirstRenderedRow(){return 0===this.getRenderedRowsCount()?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};dn(Vo,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const Bo=Vo,Wo={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};dn(Wo,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const zo=Wo;class jo extends Ho{constructor(e,t,n,r){super(e,t,n,r,Io)}}ln(jo,Bo),ln(jo,zo);const Go=jo;function $o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Uo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ko(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Yo=new WeakSet;function qo(e){const{wtSettings:t,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){let a=null;if(t.getSetting("rtlMode")){const e=r.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;a=Math.abs(e.right-t)}else{a=tt(r.wtRootElement).left}const l=Math.abs(ot(s,s));if(a>l){const t=ht(s);let r=i.getRowHeaderWidth();for(let i=1;i<=o;i++)if(r+=n.sumCellSizes(i-1,i),a+r-l>=t){e=i-2;break}}}return e}function Xo(e){const{topOverlay:t,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const s=tt(n.wtRootElement),a=it(o,o);if(s.top>a){const n=dt(o);let l=r.getColumnHeaderHeight();for(let r=1;r<=i;r++)if(l+=t.sumCellSizes(r-1,r),s.top+l-a>=n){e=r-2;break}}}return e}const Qo=class{constructor(e){$o(this,Yo),Uo(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,n){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,t),i=this.scrollViewportVertically(e.row,n);return r||i}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalColumns:r}=this.dataAccessObject;if(!n)return!1;const i=fn(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject,a="auto"===t;if(a&&e<o)return!1;const l=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let u=!1;return(a&&(e<l||e>c)||!a)&&(u=s.scrollTo(e,a?e>=this.getLastPartiallyVisibleColumn():"end"===t)),u}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const{drawn:n,totalRows:r}=this.dataAccessObject;if(!n)return!1;const i=fn(t);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,i),!Number.isInteger(e)||e<0||e>r)return!1;t=i.value;const{fixedRowsBottom:o,fixedRowsTop:s,topOverlay:a}=this.dataAccessObject,l="auto"===t;if(l&&(e<s||e>r-o-1))return!1;const c=this.getFirstVisibleRow(),u=this.getLastVisibleRow();let d=!1;return(l&&(e<c||e>u)||!l)&&(d=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return Ko(Yo,this,Xo).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return Ko(Yo,this,Xo).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return Ko(Yo,this,qo).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return Ko(Yo,this,qo).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function Jo(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Zo(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function es(e,t){return e.get(ns(e,t))}function ts(e,t,n){return e.set(ns(e,t),n),n}function ns(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var rs=new WeakMap;class is{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Zo(this,"row",null),Zo(this,"col",null),Jo(this,rs,!1),ts(rs,this,n),"undefined"!==typeof e&&"undefined"!==typeof t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:n,countRowHeaders:r,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-r)&&!(this.row>=t||this.col>=n))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return es(rs,this)}isSouthEastOf(e){return this.row>=e.row&&(es(rs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(es(rs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(es(rs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(es(rs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null===e||void 0===e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null===e||void 0===e?void 0:e.col)&&(this.col=e.col),e instanceof is&&ts(rs,this,e.isRtl()),this}clone(){return new is(this.row,this.col,es(rs,this))}toObject(){return{row:this.row,col:this.col}}}const os=is;function ss(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function as(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ls(e,t){return e.get(cs(e,t))}function cs(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var us=new WeakMap;class ds{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];as(this,"highlight",null),as(this,"from",null),as(this,"to",null),ss(this,us,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=n.clone(),function(e,t,n){e.set(cs(e,t),n)}(us,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<=t&&i.row>=t&&r.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),c=Math.max(r.row,s.row),u=Math.max(r.col,s.col),d=this._createCellCoords(a,l),h=this._createCellCoords(c,u);return this.from=d,this.to=h,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ls(us,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ls(us,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ls(us,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ls(us,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ls(us,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ls(us,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ls(us,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ls(us,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof os&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),c=[];return t===o&&c.push("top"),i===l&&c.push(ls(us,this)?"left":"right"),n===s&&c.push("bottom"),r===a&&c.push(ls(us,this)?"right":"left"),c}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(this._createCellCoords(r,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let r=e.row;r<=t.row;r++)for(let i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(this._createCellCoords(r,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let r=t.row;r<=n.row;r++)for(let i=t.col;i<=n.col;i++){if(!1===e(r,i))return}}clone(){return new ds(this.highlight,this.from,this.to,ls(us,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new os(e,t,ls(us,this))}}const hs=ds;function ps(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gs{get eventManager(){return new Cr(this)}constructor(e,t){ps(this,"wtTable",void 0),ps(this,"wtScroll",void 0),ps(this,"wtViewport",void 0),ps(this,"wtOverlays",void 0),ps(this,"selectionManager",void 0),ps(this,"wtEvent",void 0),ps(this,"guid",`wt_${pe()}`),ps(this,"drawInterrupted",!1),ps(this,"drawn",!1),ps(this,"activeOverlayName","master"),ps(this,"domBindings",void 0),ps(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Qo(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Ze(n,e[t])}])}}createCellCoords(e,t){return new os(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new hs(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,!this.wtTable.isVisible()||function(e){const t=e.ownerDocument.defaultView;let n=e;for(;n.parentNode;){if("0px"===n.style.height||"0"===n.style.height)return"hidden"===t.getComputedStyle(n).overflow;n=n.parentNode}return!1}(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n){return this.wtScroll.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function fs(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ms extends gs{constructor(e,t,n){super(e,t),fs(this,"cloneSource",void 0),fs(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.stylesHandler=n.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new Gi(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function vs(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ws{constructor(e,t,n,r,i){vs(this,"wtSettings",null),dn(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;const{TABLE:o,hider:s,spreader:a,holder:l,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=s,this.spreader=a,this.holder=l,this.wtRootElement=c,this.trimmingContainer=at(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=at(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=st(e.TABLE)}getRelativeCellPosition(e,t,n){if(!1===this.clone.wtTable.holder.contains(e))return void Bn(`The provided element is not a child of the ${this.type} overlay`);const r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let u=null;return u=r?this.getRelativeCellPositionWithinWindow(o,i,c,l):this.getRelativeCellPositionWithinHolder(o,s,i,c,l),u}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,s=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+vt())),o=e<=0?-1*e:0}else o=r.start;if(e){s=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else s=r.top;return{start:n.start+o,top:n.top+s}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition();let a=0,l=0;if(n||(a=o-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=s-i.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(-1===No.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=n.createElement("div"),o=n.createElement("table"),s=e.wtRootElement.parentNode;i.className=`${Lo.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Ke(i,[["role","presentation"]]),o.className=e.TABLE.className;e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),s.appendChild(i);const a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&this.type===Io||"vertical"===a&&this.type===Do?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=st(e.TABLE),new ms(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){const t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach(e=>{e.width="",e.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const bs=e=>{const t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=t.getCSSVariableValue("cell-autofill-size"),r=t.getCSSVariableValue("cell-autofill-border-width"),i=t.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:r,borderStyle:"solid",borderColor:i})};function Cs(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ys extends ws{constructor(e,t,n,r){super(e,t,Io,n,r),Cs(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Go(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),yt(e);else{const{wtTable:t}=this.wot,n=t.hider.getBoundingClientRect();i=Math.ceil(n.bottom)===e.offsetHeight,r=this.getOverlayOffset(),Ct(e,"0px",`${r}px`)}const o=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings,n=this.mainTableScrollableElement;let r=!1;if(n===t&&e!==t.scrollY){const n=t.scrollY;t.scrollTo(rt(t),e),r=n!==t.scrollY}else if(e!==n.scrollTop){const t=n.scrollTop;n.scrollTop=e,r=t!==n.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wot.stylesHandler.getDefaultRowHeight();let r=e,i=0;for(;r<t;){const e=this.wot.wtTable.getRowHeight(r);i+=void 0===e?n:e,r+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=vt(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=ut(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=bs(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:r}=this,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=r.getSetting("columnHeaders"),s=0===r.getSetting("fixedRowsTop")&&o.length>0&&!Ge(i.parentNode,"innerBorderTop")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=vt(this.domBindings.rootDocument)),t){const t=r.getSetting("fixedRowsBottom"),i=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),a+=1,a+=s}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);var c;return a+=l,(c=this.mainTableScrollableElement).scrollHeight-c.clientHeight===a-s&&s>0&&this.wot.wtOverlays.expandHiderVerticallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return it(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>e&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:n}=this,r=this.wot.wtTable.holder.parentNode,i=n.getSetting("totalColumns"),o="horizontal"===n.getSetting("preventOverflow");i?Ue(r,"emptyColumns"):$e(r,"emptyColumns");let s=!1;if(!t&&!o){const t=n.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,o=n.getSetting("columnHeaders");if((i||0===t)&&o.length>0){const t=Ge(r,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||0===n.getSetting("totalRows")?($e(r,"innerBorderTop"),s=!t):(Ue(r,"innerBorderTop"),s=t)}}return s}}const Ss={getFirstRenderedRow(){const e=this.getRenderedRowsCount();return 0===e?-1:this.wtSettings.getSetting("totalRows")-e},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return 0===this.getRenderedRowsCount()?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};dn(Ss,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const xs=Ss;class Rs extends Ho{constructor(e,t,n,r){super(e,t,n,r,Ao)}}ln(Rs,xs),ln(Rs,zo);const Es=Rs;function Ts(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ks extends ws{constructor(e,t,n,r){super(e,t,Ao,n,r),Ts(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Es(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom=`${n}px`);const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=vt(n)),r.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings,n=this.mainTableScrollableElement;let r=!1;if(n===t&&e!==t.scrollY){const e=t.scrollY;t.scrollTo(rt(t),top),r=e!==t.scrollY}else if(e!==n.scrollTop){const t=n.scrollTop;n.scrollTop=e,r=t!==n.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,stylesHandler:r}=this.wot,i=r.getDefaultRowHeight();let o=e,s=0;for(;o<t;){const e=n.getRowHeight(o);s+=void 0===e?i:e,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let r=t.getWorkspaceWidth();t.hasVerticalScroll()&&(r-=vt(n)),r=Math.min(r,e.wtRootElement.scrollWidth),i.width=`${r}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let s=ut(this.clone.wtTable.TABLE);e.hasDefinedSize()||(s=0),i.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&r.offsetHeight!==r.clientHeight&&(i=vt(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return it(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+e,0),n>t&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||0===t)&&r.length>0){const t=this.wot.wtTable.holder.parentNode,n=Ge(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?($e(t,"innerBorderBottom"),i=!n):(Ue(t,"innerBorderBottom"),i=n)}return i}}const Ms={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};dn(Ms,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const Ps=Ms,Is={getFirstRenderedColumn(){return 0===this.getRenderedColumnsCount()?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};dn(Is,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const As=Is;class Ds extends Ho{constructor(e,t,n,r){super(e,t,n,r,Do)}}ln(Ds,Ps),ln(Ds,As);const Fs=Ds;class Os extends ws{constructor(e,t,n,r){super(e,t,Do,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Fs(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),yt(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Ct(n,`${i}px`,"0px"));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===t&&e!==t.scrollX){const r=t.scrollX;t.scrollTo(e,nt(t)),n=r!==t.scrollX}else if(e!==r.scrollLeft){const t=r.scrollLeft;r.scrollLeft=e,n=t!==r.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===o){let r=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(r-=vt(n)),r=Math.min(r,e.wtRootElement.scrollHeight),i.height=`${r}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const s=ct(this.clone.wtTable.TABLE);i.width=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=bs(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:n}=this,r=n.getSetting("rowHeaders"),i=n.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0===i&&r.length>0&&!Ge(o.parentNode,"innerBorderInlineStart")?1:0;let a=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var c;return t&&o.offsetWidth!==o.clientWidth&&(l=vt(this.domBindings.rootDocument)),t?(a+=this.sumCellSizes(0,e+1),a-=this.wot.wtViewport.getViewportWidth(),a+=s):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),a+=l,(c=this.mainTableScrollableElement).scrollWidth-c.clientWidth===a-s&&s>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(s),this.setScrollPosition(a)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(ot(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);n>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,n=this.wot.wtTable.holder.parentNode,r=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),s="vertical"===t.getSetting("preventOverflow");o?Ue(n,"emptyRows"):$e(n,"emptyRows");let a=!1;if(!s)if(i&&!r.length)$e(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const t=Ge(n,"innerBorderInlineStart");e?($e(n,"innerBorderLeft innerBorderInlineStart"),a=!t):(Ue(n,"innerBorderLeft innerBorderInlineStart"),a=t)}return a}}class Ns extends Ho{constructor(e,t,n,r){super(e,t,n,r,Fo)}}ln(Ns,Bo),ln(Ns,As);const Ls=Ns;function _s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Hs extends ws{constructor(e,t,n,r,i,o){super(e,t,Fo,n,r),_s(this,"topOverlay",void 0),_s(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ls(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){Ct(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else yt(e);let t=ut(this.clone.wtTable.TABLE);const n=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class Vs extends Ho{constructor(e,t,n,r){super(e,t,n,r,Oo)}}ln(Vs,xs),ln(Vs,As);const Bs=Vs;class Ws extends ws{constructor(e,t,n,r,i,o){super(e,t,Oo,n,r),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Bs(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),n=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${n}px`}else yt(t),this.repositionOverlay();let n=ut(this.clone.wtTable.TABLE);const r=ct(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=vt(n)),r.style.bottom=`${i}px`}}function zs(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function js(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gs(e,t,n){return e.set(Us(e,t),n),n}function $s(e,t){return e.get(Us(e,t))}function Us(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ks=new WeakMap,Ys=new WeakMap,qs=new WeakMap,Xs=new WeakMap;const Qs=class{constructor(e,t,n,r,i,o){js(this,"wot",null),zs(this,Ks,[]),js(this,"topOverlay",null),js(this,"bottomOverlay",null),js(this,"inlineStartOverlay",null),js(this,"topInlineStartCornerOverlay",null),js(this,"bottomInlineStartCornerOverlay",null),js(this,"browserLineHeight",void 0),js(this,"wtSettings",null),zs(this,Ys,!1),zs(this,qs,0),zs(this,Xs,null),js(this,"resizeObserver",new ResizeObserver(e=>{vn(()=>{Array.isArray(e)&&e.length&&(Gs(qs,this,$s(qs,this)+1),100===$s(qs,this)&&(Bn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==$s(Xs,this)&&clearTimeout($s(Xs,this)),Gs(Xs,this,setTimeout(()=>{Gs(qs,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=o;const{rootDocument:s,rootWindow:a}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=vt(s);const l="hidden"===a.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?o.holder:st(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=a.scrollX,this.lastScrollY=a.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...$s(Ks,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),r=parseInt(n.lineHeight,10),i=1.2*parseInt(n.fontSize,10);this.browserLineHeight=r||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new ys(...e),this.bottomOverlay=new ks(...e),this.inlineStartOverlay=new Os(...e),this.topInlineStartCornerOverlay=new Hs(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Ws(...e,this.bottomOverlay,this.inlineStartOverlay),Gs(Ks,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Gs(Ys,this,$s(Ks,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),$s(Ks,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),$s(Ks,this).forEach(e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",e=>this.onKeyDown(e)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",e=>this.onTableScroll(e),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",e=>this.onTableScroll(e),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,s=this.wtSettings.getSetting("preventWheel"),a={passive:o};(s||i||!Rn())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",e=>this.onCloneWheel(e,s),a);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",e=>this.onCloneWheel(e,s),a)}),this.eventManager.addEventListener(t,"resize",()=>{vn(()=>{clearTimeout(l),this.wtSettings.getSetting("onWindowResize"),l=setTimeout(()=>{Gs(qs,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,s=i!==n&&o!==n&&!o.contains(i),a=r!==n&&o!==n&&!o.contains(r);if(this.keyPressed&&(s||a)||this.scrollableElement===n)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Nn(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=n,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=n;const t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=n)}this.verticalScrolling&&(t.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!$s(Ys,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Gs(Ys,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=st(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:n}=this.domBindings,r=this.scrollableElement===n,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),a=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,l=s+this.inlineStartOverlay.sumCellSizes(0,i),c=t.hider.style,u=(()=>!r&&this.scrollableElement.scrollTop>Math.max(0,a-t.holder.clientHeight))()?1:0,d=(()=>!r&&this.scrollableElement.scrollLeft>Math.max(0,l-t.holder.clientWidth))()?1:0;c.width=`${l+d}px`,c.height=`${a+u}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return Ot(t,t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;Ot([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],t=>{t&&(t.clone.wtTable.TABLE.className=e.className)})}};function Js(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zs{constructor(e){Js(this,"settings",{}),Js(this,"defaults",Object.freeze(this.getDefaults())),hn(this.defaults,(t,n)=>{if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===t)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const r=this.getSetting("data",e,t);Ze(n,void 0===r||null===r?"":r)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?hn(e,(e,t)=>{this.settings[t]=e}):this.settings[e]=t,this}getSetting(e,t,n,r,i){return"function"===typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class ea extends Ho{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){const e=at(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const n=e.parentElement,r=lt(e,"height",t),i=lt(e,"overflow",t),o=this.holder.style,{scrollWidth:s,scrollHeight:a}=e;let l=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const r=e.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",e.nextElementSibling?n.insertBefore(r,e.nextElementSibling):n.appendChild(r);const i=parseInt(t.getComputedStyle(r).height,10);n.removeChild(r),0===i&&(c=0)}c=Math.min(c,a),o.height="auto"===r?"auto":`${c}px`,l=Math.min(l,s),o.width=`${l}px`,o.overflow="",this.hasTableHeight="auto"===o.height||c>0,this.hasTableWidth=l>0}this.isTableVisible=et(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){const i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let t=-1*i;t<o;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[n]=!0}}}ln(ea,Ps),ln(ea,zo);const ta=ea;function na(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ra{constructor(){na(this,"count",0),na(this,"startRow",0),na(this,"endRow",0),na(this,"startPosition",0),na(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function ia(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class oa{constructor(){ia(this,"count",0),ia(this,"startRow",null),ia(this,"endRow",null),ia(this,"startPosition",null),ia(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i}=t;n<=r&&(this.startRow=e),n>=r&&n<=i&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(this.startRow-=1,e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<0||n>a.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function sa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class aa extends oa{constructor(){super(...arguments),sa(this,"rowStartOffset",0),sa(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalRows:r,startPositions:i}=e;if(null!==this.startRow&&"function"===typeof n){const e=this.startRow,t=this.endRow;n(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=i[this.startRow])&&void 0!==t?t:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function la(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ca{constructor(){la(this,"count",0),la(this,"startRow",null),la(this,"endRow",null),la(this,"startPosition",null),la(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:n,zeroBasedScrollOffset:r,innerViewportHeight:i,rowHeight:o}=t;n>=r&&n+o<=i&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:n,viewportHeight:r,horizontalScrollbarHeight:i,totalRows:o,needReverse:s,startPositions:a,rowHeight:l}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){const e=a[this.endRow]+l-a[this.startRow-1];if(e<=r-i&&(this.startRow-=1),e>=r-i)break}this.startPosition=null!==(t=a[this.startRow])&&void 0!==t?t:null;n+r-i<(null===this.startRow?0:e.getRowHeight(this.startRow))||n>a.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function ua(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class da{constructor(){ua(this,"count",0),ua(this,"startColumn",0),ua(this,"endColumn",0),ua(this,"startPosition",0),ua(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function ha(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pa{constructor(){ha(this,"count",0),ha(this,"startColumn",null),ha(this,"endColumn",null),ha(this,"startPosition",null),ha(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i}=t;n<=r&&(this.startColumn=e);n>=r&&n<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:c}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(this.startColumn-=1,e>r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;n+r-(o>0?r+1:r)<-1*i||n>l.at(-1)+c||-1*n-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ga(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fa extends pa{constructor(){super(...arguments),ga(this,"columnStartOffset",0),ga(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);const{overrideFn:n,totalColumns:r,startPositions:i}=e;if(null!==this.startColumn&&"function"===typeof n){const e=this.startColumn,t=this.endColumn;n(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=i[this.startColumn])&&void 0!==t?t:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ma(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class va{constructor(){ma(this,"count",0),ma(this,"startColumn",null),ma(this,"endColumn",null),ma(this,"startPosition",null),ma(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:n,zeroBasedScrollOffset:r,viewportWidth:i,columnWidth:o}=t;n>=r&&n+o<=r+(r>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:n,viewportWidth:r,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:s,needReverse:a,startPositions:l,columnWidth:c}=e;if(this.endColumn===s-1&&a)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(e<=r&&(this.startColumn-=1),e>=r)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const u=n+r-(o>0?r+1:r),d=null===this.startColumn?0:e.getColumnWidth(this.startColumn);u<-1*i||n>l.at(-1)||-1*n-r>-1*d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function wa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ba{constructor(e){wa(this,"calculationTypes",[]),wa(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[n,r]=t;this.calculationResults.set(n,r),r.initialize(e)})}_process(e,t){this.calculationTypes.forEach(n=>{let[,r]=n;return r.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,n]=t;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ca(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ya extends ba{constructor(e){let{calculationTypes:t,viewportHeight:n,scrollOffset:r,totalRows:i,defaultRowHeight:o,rowHeightFn:s,overrideFn:a,horizontalScrollbarHeight:l}=e;super(t),Ca(this,"viewportHeight",0),Ca(this,"scrollOffset",0),Ca(this,"zeroBasedScrollOffset",0),Ca(this,"totalRows",0),Ca(this,"rowHeightFn",null),Ca(this,"rowHeight",0),Ca(this,"overrideFn",null),Ca(this,"horizontalScrollbarHeight",0),Ca(this,"innerViewportHeight",0),Ca(this,"totalCalculatedHeight",0),Ca(this,"startPositions",[]),Ca(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=i,this.rowHeightFn=s,this.overrideFn=a,this.horizontalScrollbarHeight=null!==l&&void 0!==l?l:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}function Sa(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const xa=50;class Ra extends ba{constructor(e){let{calculationTypes:t,viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:o,overrideFn:s,inlineStartOffset:a}=e;super(t),Sa(this,"viewportWidth",0),Sa(this,"scrollOffset",0),Sa(this,"zeroBasedScrollOffset",0),Sa(this,"totalColumns",0),Sa(this,"columnWidthFn",null),Sa(this,"columnWidth",0),Sa(this,"overrideFn",null),Sa(this,"inlineStartOffset",0),Sa(this,"totalCalculatedWidth",0),Sa(this,"startPositions",[]),Sa(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=s,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?xa:t}}const Ea=class{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new ra:new aa],["fullyVisible",()=>new ca],["partiallyVisible",()=>new oa]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new da:new fa],["fullyVisible",()=>new va],["partiallyVisible",()=>new pa]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;if(t===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{n=ut(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:t}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(n===t){const t=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,t)>r&&(r=e.documentElement.clientWidth)}else r=n.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}const{holder:e,hider:t}=this.wtTable,n=e.clientHeight,r=t.offsetHeight;return n<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}const{holder:e,hider:t}=this.wtTable,n=e.clientWidth,r=t.offsetWidth;return n<r||r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getWorkspaceOffset(){return tt(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ut(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)e?(this.rowHeaderWidth+=ct(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r,i,o=this.getViewportHeight();this.rowHeaderWidth=NaN;let s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const a=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return a&&s>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s+=i,o-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(c-l,c),o-=i),r=n.holder.clientHeight===n.holder.offsetHeight?0:vt(this.domBindings.rootDocument),new ya({calculationTypes:e.map(e=>[e,this.rowsCalculatorTypes.get(e)()]),viewportHeight:o,scrollOffset:s,totalRows:t.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>n.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:r})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:n}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=e,r-=e}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=vt(this.domBindings.rootDocument)),new Ra({calculationTypes:e.map(e=>[e,this.columnsCalculatorTypes.get(e)()]),viewportWidth:r,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>n.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,n=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:r,endRow:i,rowStartOffset:o,rowEndOffset:s}=this.rowsRenderCalculator,a=this.wtSettings.getSetting("totalRows")-1,l=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:n}=e;if(null===t&&null===n){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:r,endColumn:i,columnStartOffset:o,columnEndOffset:s}=this.columnsRenderCalculator,a=this.wtSettings.getSetting("totalColumns")-1,l=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(l)&&l>0?(t=Math.max(0,t-Math.min(o,l)),n=Math.min(a,n+Math.min(s,l))):"auto"===l&&(t=Math.max(0,t-Math.ceil(o/2)),n=Math.min(a,n+Math.ceil(s/2))),!(t<r||t===r&&t>0)&&!(n>i||n===i&&n<a)}resetHasOversizedColumnHeadersMarked(){hn(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}};function Ta(e,t,n){ka(e,t),t.set(e,n)}function ka(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(e,t){return e.get(Ia(e,t))}function Pa(e,t,n){return e.set(Ia(e,t),n),n}function Ia(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Aa=new WeakMap,Da=new WeakMap,Fa=new WeakSet;class Oa{constructor(){var e,t;ka(e=this,t=Fa),t.add(e),Ta(this,Aa,void 0),Ta(this,Da,void 0)}setActiveOverlay(e){return Pa(Da,this,e),this}setActiveSelection(e){return Pa(Aa,this,e),this}scan(){const e=Ma(Aa,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"area"===e?this.scanCellsRange(e=>t.add(e)):"focus"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e)),this.scanCellsRange(e=>t.add(e))):"fill"===e?this.scanCellsRange(e=>t.add(e)):"header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"row"===e?(this.scanRowsInHeadersRange(e=>t.add(e)),this.scanRowsInCellsRange(e=>t.add(e))):"column"===e&&(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanColumnsInCellsRange(e=>t.add(e))),t}scanColumnsInHeadersRange(e){const[t,n,r,i]=Ma(Aa,this).getCorners(),{wtTable:o}=Ma(Da,this),s=o.getRenderedColumnsCount(),a=o.getColumnHeadersCount();let l=0;for(let c=-o.getRowHeadersCount();c<s;c++){const s=o.columnFilter.renderedToSource(c);if(!(s<n||s>i)){for(let c=-a;c<0;c++){if(c<t||c>r)continue;const u=c+a;let d=o.getColumnHeader(s,u);const h=Ma(Da,this).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:Ma(Aa,this).settings.selectionType,columnCursor:l,selectionWidth:i-n+1});null!==h&&(h!==s&&(d=o.getColumnHeader(h,u)),e(d))}l+=1}}}scanRowsInHeadersRange(e){const[t,n,r,i]=Ma(Aa,this).getCorners(),{wtTable:o}=Ma(Da,this),s=o.getRenderedRowsCount(),a=o.getRowHeadersCount();let l=0;for(let c=-o.getColumnHeadersCount();c<s;c++){const s=o.rowFilter.renderedToSource(c);if(!(s<t||s>r)){for(let c=-a;c<0;c++){if(c<n||c>i)continue;const u=c+a;let d=o.getRowHeader(s,u);const h=Ma(Da,this).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:Ma(Aa,this).settings.selectionType,rowCursor:l,selectionHeight:r-t+1});null!==h&&(h!==s&&(d=o.getRowHeader(h,u)),e(d))}l+=1}}}scanCellsRange(e){const{wtTable:t}=Ma(Da,this);Ia(Fa,this,Na).call(this,(n,r)=>{const i=t.getCell(Ma(Da,this).createCellCoords(n,r)),o=Ma(Da,this).getSetting("onAfterDrawSelection",n,r,Ma(Aa,this).settings.layerLevel);"string"===typeof o&&$e(i,o),e(i)})}scanRowsInCellsRange(e){const[t,,n]=Ma(Aa,this).getCorners(),{wtTable:r}=Ma(Da,this);Ia(Fa,this,La).call(this,(i,o)=>{if(i>=t&&i<=n){const t=r.getCell(Ma(Da,this).createCellCoords(i,o));e(t)}})}scanColumnsInCellsRange(e){const[,t,,n]=Ma(Aa,this).getCorners(),{wtTable:r}=Ma(Da,this);Ia(Fa,this,La).call(this,(i,o)=>{if(o>=t&&o<=n){const t=r.getCell(Ma(Da,this).createCellCoords(i,o));e(t)}})}}function Na(e){let[t,n,r,i]=Ma(Aa,this).getCorners();if(t<0&&r<0||n<0&&i<0)return;const{wtTable:o}=Ma(Da,this),s=t!==r||n!==i;if(n=Math.max(n,0),i=Math.max(i,0),t=Math.max(t,0),r=Math.max(r,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),i=Math.min(i,o.getLastRenderedColumn()),t=Math.max(t,o.getFirstRenderedRow()),r=Math.min(r,o.getLastRenderedRow()),i<n||r<t)return}else{if(!kt(o.getCell(Ma(Da,this).createCellCoords(t,n))))return}for(let a=t;a<=r;a+=1)for(let t=n;t<=i;t+=1)e(a,t)}function La(e){const{wtTable:t}=Ma(Da,this),n=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const n=t.rowFilter.renderedToSource(i);for(let i=0;i<r;i+=1)e(n,t.columnFilter.renderedToSource(i))}}const _a=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=bs(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ln(e);const n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",function e(o){var s;((s=o).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")})}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let s=0;s<5;s++){const i=n[s],o=t.createElement("div");o.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),r=o.style,r.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,r.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,r.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,this.main.appendChild(o)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),kn()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,stylesHandler:t}=this.wot,n=t.getCSSVariableValue("cell-mobile-handle-size"),r=t.getCSSVariableValue("cell-mobile-handle-border-radius"),i=t.getCSSVariableValue("cell-mobile-handle-background-color"),o=t.getCSSVariableValue("cell-mobile-handle-border-width"),s=t.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};hn({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},(e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e});hn(t.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${r}px`,background:`${i}`,border:`${o}px solid ${s}`},(e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,n,r,i,o){const s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:a,topHitArea:l,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),h=parseInt(a.width,10),p=parseInt(l.width,10),g=this.wot.wtTable.getWidth(),f=this.wot.wtTable.getHeight();a.top=`${parseInt(n-h-1,10)}px`,a[s]=`${parseInt(r-h-1,10)}px`,l.top=`${parseInt(n-p/4*3,10)}px`,l[s]=`${parseInt(r-p/4*3,10)}px`;const m=Math.min(parseInt(r+i,10),g-h-2*d),v=Math.min(parseInt(r+i-p/4,10),g-p-2*d);c[s]=`${m}px`,u[s]=`${v}px`;const w=Math.min(parseInt(n+o,10),f-h-2*d),b=Math.min(parseInt(n+o-p/4,10),f-p-2*d);c.top=`${w}px`,u.top=`${b}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",l.display="block",this.isPartRange(e,t)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(a.display="none",c.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",l.zIndex="9999"):(a.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;let[t,n,r,i]=e;if(t<0&&r<0||n<0&&i<0)return void this.disappear();const{wtTable:o,rootDocument:s,rootWindow:a}=this.wot,l=t!==r||n!==i,c=o.getFirstRenderedRow(),u=o.getLastRenderedRow(),d=o.getFirstRenderedColumn(),h=o.getLastRenderedColumn();if(d<0&&h<0||c<0&&u<0)return void this.disappear();let p;if(l){if(n=Math.max(n,d),i=Math.min(i,h),t=Math.max(t,c),r=Math.min(r,u),i<n||r<t)return void this.disappear();p=o.getCell(this.wot.createCellCoords(t,n))}else if(p=o.getCell(this.wot.createCellCoords(t,n)),!kt(p))return void this.disappear();const g=l?o.getCell(this.wot.createCellCoords(r,i)):p,f=tt(p),m=l?tt(g):f,v=tt(o.TABLE),w=f.top,b=f.left,C=this.wot.wtSettings.getSetting("rtlMode");let y=0,S=0;if(C){const e=ct(o.TABLE),t=ct(p),n=a.innerWidth-v.left-e;S=b+t-m.left,y=a.innerWidth-b-t-n-1}else S=m.left+ct(g)-b,y=b-v.left-1;if(this.isEntireColumnSelected(t,r)){const e=t,r=this.getDimensionsFromHeader("columns",n,i,e,v);let o=null;r&&([o,y,S]=r),o&&(p=o)}let x=w-v.top-1,R=m.top+ut(g)-w;if(this.isEntireRowSelected(n,i)){const e=n,i=this.getDimensionsFromHeader("rows",t,r,e,v);let o=null;i&&([o,x,R]=i),o&&(p=o)}const E=a.getComputedStyle(p);parseInt(E.borderTopWidth,10)>0&&(x+=1,R=R>0?R-1:0),parseInt(E[C?"borderRightWidth":"borderLeftWidth"],10)>0&&(y+=1,S=S>0?S-1:0);const T=C?"right":"left";this.topStyle.top=`${x}px`,this.topStyle[T]=`${y}px`,this.topStyle.width=`${S}px`,this.topStyle.display="block",this.startStyle.top=`${x}px`,this.startStyle[T]=`${y}px`,this.startStyle.height=`${R}px`,this.startStyle.display="block";const k=Math.floor(this.settings.border.width/2);this.bottomStyle.top=x+R-k+"px",this.bottomStyle[T]=`${y}px`,this.bottomStyle.width=`${S}px`,this.bottomStyle.display="block",this.endStyle.top=`${x}px`,this.endStyle[T]=y+S-k+"px",this.endStyle.height=`${R+1}px`,this.endStyle.display="block";let M=this.settings.border.cornerVisible;M="function"===typeof M?M(this.settings.layerLevel):M;const P=this.wot.getSetting("onModifyGetCellCoords",r,i,!1,"render");let[I,A]=[r,i];if(P&&Array.isArray(P)&&([,,I,A]=P),kn()||!M||this.isPartRange(I,A))this.cornerStyle.display="none";else{this.cornerStyle.top=x+R+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle[T]=y+S+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth+"px",this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=at(o.TABLE);const t=e===a;t&&(e=s.documentElement);const n=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,l=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),c=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(i===this.wot.getSetting("totalColumns")-1){const r=t?g.getBoundingClientRect().left:g.offsetLeft;let i=!1,o=0;C?(o=r-parseInt(this.cornerDefaultStyle.width,10)/2,i=o<0):(o=r+ct(g)+parseInt(this.cornerDefaultStyle.width,10)/2,i=o>=ht(e)),i&&(this.cornerStyle[T]=`${Math.floor(y+S+this.cornerCenterPointOffset-l-n)}px`,this.cornerStyle[C?"borderLeftWidth":"borderRightWidth"]=0)}if(r===this.wot.getSetting("totalRows")-1){const r=(t?g.getBoundingClientRect().top:g.offsetTop)+ut(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=dt(e),i=this.wot.stylesHandler.isClassicTheme();if(r){const e=Math.floor(x+R+this.cornerCenterPointOffset-c-n);i?(this.cornerStyle.top=`${e}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=e-1+"px"}}this.cornerStyle.display="block"}kn()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,i,x,y,S,R)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const{wtTable:o}=this.wot,s=o.wtRootElement.parentNode;let a=null,l=null,c=null,u=null,d=null,h=null,p=null,g=null;switch(e){case"rows":a=function(){return o.getRowHeader(...arguments)},l=function(){return ut(...arguments)},c="ht__selection--rows",h="top";break;case"columns":a=function(){return o.getColumnHeader(...arguments)},l=function(){return ct(...arguments)},c="ht__selection--columns",h="left"}if(s.classList.contains(c)){const e=this.wot.getSetting("columnHeaders").length;if(p=a(t,e-r),g=a(n,e-r),!p||!g)return!1;const o=tt(p),s=tt(g);return p&&g&&(u=o[h]-i[h]-1,d=s[h]+l(g)-o[h]),[p,u,d]}return!1}changeBorderStyle(e,t){const n=this[e].style,r=t[e];!r||r.hide?$e(this[e],"hidden"):(Ge(this[e],"hidden")&&Ue(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height=`${r.width}px`),"start"!==e&&"end"!==e||(n.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const t=1,n="#000",r=this[e].style;r.backgroundColor=n,r.width=`${t}px`,r.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?$e(this[e],"hidden"):Ue(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",kn()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function Ha(e,t,n){Va(e,t),t.set(e,n)}function Va(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(e,t){return e.get(za(e,t))}function Wa(e,t,n){return e.set(za(e,t),n),n}function za(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ja=new WeakMap,Ga=new WeakMap,$a=new WeakMap,Ua=new WeakMap,Ka=new WeakMap,Ya=new WeakMap,qa=new WeakSet;class Xa{constructor(e){var t,n;Va(t=this,n=qa),n.add(t),Ha(this,ja,void 0),Ha(this,Ga,void 0),Ha(this,$a,new Oa),Ha(this,Ua,new WeakMap),Ha(this,Ka,new WeakSet),Ha(this,Ya,new Map),Wa(Ga,this,e)}setActiveOverlay(e){return Wa(ja,this,e),Ba($a,this).setActiveOverlay(Ba(ja,this)),Ba(Ua,this).has(Ba(ja,this))||Ba(Ua,this).set(Ba(ja,this),new Set),this}getFocusSelection(){return null!==Ba(Ga,this)?Ba(Ga,this).getFocus():null}getAreaSelection(){return null!==Ba(Ga,this)?Ba(Ga,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ba(Ya,this).has(e)){const t=Ba(Ya,this).get(e);if(t.has(Ba(ja,this)))return t.get(Ba(ja,this));const n=new _a(Ba(ja,this),e.settings);return t.set(Ba(ja,this),n),n}const t=new _a(Ba(ja,this),e.settings);return Ba(Ya,this).set(e,new Map([[Ba(ja,this),t]])),t}getBorderInstances(e){var t,n;return Array.from(null!==(t=null===(n=Ba(Ya,this).get(e))||void 0===n?void 0:n.values())&&void 0!==t?t:[])}destroyBorders(e){Ba(Ya,this).get(e).forEach(e=>e.destroy()),Ba(Ya,this).delete(e)}render(e){if(null===Ba(Ga,this))return;e&&za(qa,this,Qa).call(this);const t=Array.from(Ba(Ga,this)),n=new Map,r=new Map;for(let i=0;i<t.length;i++){const e=t[i],{className:o,headerAttributes:s,createLayers:a,selectionType:l}=e.settings;Ba(Ka,this).has(e)||(Ba(Ka,this).add(e),e.addLocalHook("destroy",()=>this.destroyBorders(e)));const c=this.getBorderInstance(e);if(e.isEmpty()){null===c||void 0===c||c.disappear();continue}if(o){Ba($a,this).setActiveSelection(e).scan().forEach(e=>{if(n.has(e)){const t=n.get(e);t.has(o)&&!0===a?t.set(o,t.get(o)+1):t.set(o,1)}else n.set(e,new Map([[o,1]]));s&&(r.has(e)||r.set(e,[]),"TH"===e.nodeName&&r.get(e).push(...s))})}const u=e.getCorners();Ba(ja,this).getSetting("onBeforeDrawBorders",u,l),null===c||void 0===c||c.appear(u)}n.forEach((e,t)=>{var n;const r=Array.from(e).map(e=>{let[t,n]=e;return 1===n?t:[t,...Array.from({length:n-1},(e,n)=>`${t}-${n+1}`)]}).flat();r.forEach(e=>Ba(Ua,this).get(Ba(ja,this)).add(e)),$e(t,r),"TD"===t.nodeName&&Array.isArray(null===(n=Ba(Ga,this).options)||void 0===n?void 0:n.cellAttributes)&&Ke(t,Ba(Ga,this).options.cellAttributes)}),Array.from(r.keys()).forEach(e=>{Ke(e,[...r.get(e)])})}}function Qa(){const e=Ba(Ua,this).get(Ba(ja,this)),t=Ba(ja,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let n=0;n<t.length;n++)e.add(t[n]);e.forEach(e=>{var t,n;const r=Ba(ja,this).wtTable.TABLE.querySelectorAll(`.${e}`);let i=[];Array.isArray(null===(t=Ba(Ga,this).options)||void 0===t?void 0:t.cellAttributes)&&(i=Ba(Ga,this).options.cellAttributes.map(e=>e[0])),Array.isArray(null===(n=Ba(Ga,this).options)||void 0===n?void 0:n.headerAttributes)&&(i=[...i,...Ba(Ga,this).options.headerAttributes.map(e=>e[0])]);for(let o=0,s=r.length;o<s;o++)Ue(r[o],e),Ye(r[o],i)}),e.clear()}function Ja(e,t,n){Za(e,t),t.set(e,n)}function Za(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(e,t){return e.get(nl(e,t))}function tl(e,t,n){return e.set(nl(e,t),n),n}function nl(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var rl=new WeakMap,il=new WeakMap,ol=new WeakMap,sl=new WeakMap,al=new WeakMap,ll=new WeakMap,cl=new WeakMap,ul=new WeakSet;class dl{constructor(e){var t,n;Za(t=this,n=ul),n.add(t),Ja(this,rl,void 0),Ja(this,il,void 0),Ja(this,ol,void 0),Ja(this,sl,void 0),Ja(this,al,!0),Ja(this,ll,{}),Ja(this,cl,{}),tl(il,this,e.rootTable.parentElement.parentElement),tl(sl,this,e.rootDocument)}isClassicTheme(){return el(al,this)}getCSSVariableValue(e){var t;if(el(al,this))return null;if(el(ll,this)[`--ht-${e}`])return el(ll,this)[`--ht-${e}`];const n=null!==(t=nl(ul,this,ml).call(this,`--ht-${e}`))&&void 0!==t?t:nl(ul,this,vl).call(this,`--ht-${e}`);return null!==n?(el(ll,this)[`--ht-${e}`]=n,n):void 0}getStyleForTD(e){var t;return null===(t=el(cl,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(el(al,this))return 23;const e=nl(ul,this,hl).call(this);return!e&&Ge(el(il,this),"ht-wrapper")?(Bn(`The "${el(rl,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),tl(al,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e)return nl(ul,this,gl).call(this),tl(al,this,!0),void tl(rl,this,e||void 0);e&&e!==el(rl,this)&&(el(rl,this)&&nl(ul,this,wl).call(this),tl(rl,this,e),tl(al,this,!1),nl(ul,this,pl).call(this),nl(ul,this,gl).call(this))}getThemeName(){return el(rl,this)}removeClassNames(){Ge(el(il,this),el(rl,this))&&Ue(el(il,this),el(rl,this))}}function hl(){const e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(n)?null:e+2*t+n}function pl(){Ue(el(il,this),/ht-theme-.*/g),$e(el(il,this),el(rl,this))}function gl(){this.isClassicTheme()||tl(ol,this,getComputedStyle(el(il,this)));const e=nl(ul,this,fl).call(this,["box-sizing","border-bottom-width"]);el(cl,this).td={...el(cl,this).td,"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]}}function fl(e){const t=el(sl,this),n=el(il,this),r=t.createElement("table"),i=t.createElement("tbody"),o=t.createElement("tr"),s=t.createElement("tr"),a=t.createElement("td");s.appendChild(a),i.appendChild(o),i.appendChild(s),r.appendChild(i),n.appendChild(r);const l=getComputedStyle(a),c={};return e.forEach(e=>{c[e]=l.getPropertyValue(e)}),n.removeChild(r),c}function ml(e){const t=Math.ceil(parseFloat(nl(ul,this,vl).call(this,e)));return Number.isNaN(t)?null:t}function vl(e){const t=el(ol,this).getPropertyValue(e);return""===t?null:t}function wl(){tl(cl,this,{}),tl(ll,this,{}),tl(al,this,!0)}class bl extends gs{constructor(e,t){super(e,new Zs(t)),this.stylesHandler=new dl(this.domBindings);const n=this.wtSettings.getSetting("facade",this);this.wtTable=new ta(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Ea(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Xa(this.wtSettings.getSetting("selections")),this.wtEvent=new Gi(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Qs(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];hn({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(n,r)=>{this.wtSettings.getSetting(r).length&&t.push(n),e.push(n)}),Ue(this.wtTable.wtRootElement.parentNode,e),$e(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!No.includes(e))return null;const n=e.replace(/_([a-z])/g,e=>e[1].toUpperCase());return null!==(t=this.wtOverlays[`${n}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Cl{constructor(e){e instanceof gs?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new Cl(e);return()=>t},this._wot=new bl(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,n){return this._wot.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function yl(e){let{isShiftKey:t,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=e;const l=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const e=!o.inInSelection(i),t=n||r&&e;i.row<0&&i.col>=0&&!s.column?t&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?t&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?t&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}const Sl=new Map([["mousedown",yl],["mouseover",function(e){let{isLeftClick:t,coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;if(!t)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),c=r.tableProps.countRows();r.markSource("mouse"),a&&!i.column?r.setRangeEnd(o(c-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n),r.markEndSource()}],["touchstart",yl]]);function xl(e,t){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;Sl.get(e.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:Vn(e)||"touchstart"===e.type,isRightClick:Hn(e)})}const Rl=new WeakMap,El=Symbol("rootInstance");function Tl(e){return e===El}function kl(e){return Rl.has(e)}function Ml(e,t,n){Pl(e,t),t.set(e,n)}function Pl(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Il(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Al(e,t){return e.get(Fl(e,t))}function Dl(e,t,n){return e.set(Fl(e,t),n),n}function Fl(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ol=new WeakMap,Nl=new WeakMap,Ll=new WeakMap,_l=new WeakMap,Hl=new WeakMap,Vl=new WeakMap,Bl=new WeakMap,Wl=new WeakMap,zl=new WeakSet;function jl(){return parseInt(this.hot.rootElement.getAttribute(Me()[0]),10)}function Gl(e){const t=Fl(zl,this,jl).call(this)+e;Ke(this.hot.rootElement,...Me(t))}function $l(){const e=this.hot.rootElement;this.hasVerticalScroll()?$e(e,"htHasScrollY"):Ue(e,"htHasScrollY"),this.hasHorizontalScroll()?$e(e,"htHasScrollX"):Ue(e,"htHasScrollX")}const Ul=class{constructor(e){var t,n;Pl(t=this,n=zl),n.add(t),Il(this,"hot",void 0),Il(this,"eventManager",void 0),Il(this,"settings",void 0),Il(this,"THEAD",void 0),Il(this,"TBODY",void 0),Il(this,"_wt",void 0),Il(this,"activeWt",void 0),Ml(this,Ol,0),Ml(this,Nl,0),Il(this,"postponedAdjustElementsSize",!1),Ml(this,Ll,!1),Ml(this,_l,void 0),Ml(this,Hl,void 0),Ml(this,Vl,0),Ml(this,Bl,0),Ml(this,Wl,null),this.hot=e,this.eventManager=new Cr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),Fl(zl,this,$l).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n){return this._wt.scrollViewport(e,t,n)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),$e(e,"handsontable"),Dl(Hl,this,t.createElement("TABLE")),$e(Al(Hl,this),"htCore"),this.hot.getSettings().tableClassName&&$e(Al(Hl,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ke(Al(Hl,this),[["role","presentation"]]),Ke(e,[["role","treegrid"],ke(-1),Me(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),Al(Hl,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),Al(Hl,this).appendChild(this.TBODY),this.hot.table=Al(Hl,this),this.hot.container.insertBefore(Al(Hl,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n,rootWindow:r}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",e=>{Dl(Ll,this,!0),this.isTextSelectionAllowed(e.target)||(gt(r),e.preventDefault(),r.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Dl(Ll,this,!1)}),this.eventManager.addEventListener(e,"mousemove",e=>{Al(Ll,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&gt(r),e.preventDefault())}),this.eventManager.addEventListener(i,"keyup",e=>{n.isInProgress()&&!e.shiftKey&&n.finish()}),this.eventManager.addEventListener(i,"mouseup",r=>{n.isInProgress()&&Vn(r)&&n.finish(),Dl(_l,this,!1);const i=xt(t.activeElement);St(t.activeElement)&&!i||!i&&(n.isSelected()||n.isSelectedByAnyHeader()||e.contains(r.target)||Hn(r))||this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",e=>{n.isInProgress()&&Hn(e)&&(n.finish(),Dl(_l,this,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{n.isInProgress()&&n.finish(),Dl(_l,this,!1)}),this.eventManager.addEventListener(i,"mousedown",n=>{const r=n.target,o=n.x||n.clientX,s=n.y||n.clientY;let a=n.target;if(Al(_l,this)||!e||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(a===l){const e=vt(t);if(t.elementFromPoint(o+e,s)!==l||t.elementFromPoint(o,s+e)!==l)return}else for(;a!==i;){if(null===a){if(n.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}("function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(r):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=_e(r);for(;null!==o;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=_e(o);this.eventManager.addEventListener(Al(Hl,this),"selectstart",e=>{this.settings.fragmentSelection||St(e.target)||e.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let s=0;return t<0?s=o+1:t>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let r=e;r<=t;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(n+=1);return n}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&$e(n,e)}removeClassNameFromLicenseElement(e){var t;const n=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");n&&Ue(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Al(Hl,this),isDataViewInstance:()=>kl(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push((e,t)=>{const n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(n,t)}),this.hot.runHooks("afterGetRowHeaderRenderers",e),Dl(Nl,this,e.length),this.hot.getSettings().ariaTags&&Fl(zl,this,jl).call(this)===this.hot.countCols()&&Fl(zl,this,Gl).call(this,Al(Nl,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push((e,t)=>{const n=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(n,t)}),this.hot.runHooks("afterGetColumnHeaderRenderers",e),Dl(Ol,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const n=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),r=null===n?e:n;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,t)},cellRenderer:(e,t,n)=>{const[r,i]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",r,i,!1,"meta");let s=r,a=i;Array.isArray(o)&&([s,a]=o);const l=this.hot.getCellMeta(s,a),c=this.hot.colToProp(a);let u=this.hot.getDataAtRowProp(s,c);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,l)),this.hot.runHooks("beforeRenderer",n,r,i,c,u,l),this.hot.getCellRenderer(l)(this.hot,n,r,i,c,u,l),this.hot.runHooks("afterRenderer",n,r,i,c,u,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&et(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,Dl(_l,this,!0),Dl(Wl,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,i,n,o),_n(e)||(xl(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,i,n),this.activeWt=this._wt)},onCellContextMenu:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,Dl(_l,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,i,n),_n(e)||(this.hot.runHooks("afterOnCellContextMenu",e,i,n),this.activeWt=this._wt)},onCellMouseOut:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",e,i,n),_n(e)||(this.hot.runHooks("afterOnCellMouseOut",e,i,n),this.activeWt=this._wt)},onCellMouseOver:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",e,i,n,o),_n(e)||(!Al(_l,this)||Al(Wl,this)&&Al(Wl,this).x===e.clientX&&Al(Wl,this).y===e.clientY||xl(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,i,n),this.activeWt=this._wt,Dl(Wl,this,null))},onCellMouseUp:(e,t,n,r)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",e,i,n),_n(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,i,n),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{const n=this.hot.rowIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollVertically",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onBeforeViewportScrollHorizontally:(e,t)=>{const n=this.hot.columnIndexMapper,r=e<0;let i=e;return r||(i=n.getVisualFromRenderableIndex(e),null!==i)?(i=this.hot.runHooks("beforeViewportScrollHorizontally",i,t),this.hot.runHooks("beforeViewportScroll"),r?i:n.getRenderableFromVisualIndex(i)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,n)=>{const r=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingRowHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,n)=>{const r=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=r.getVisualFromRenderableIndex(e));const s=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,n);return i?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,n)=>{let r;const[i,o]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){const e=s.peekByIndex(null!==n&&void 0!==n?n:0);r=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",i,o,r,n)},onBeforeDrawBorders:(e,t)=>{const[n,r,i,o]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,n,r)=>{const i=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=t>=0?o.getVisualFromRenderableIndex(t):t,a=e>=0?i.getVisualFromRenderableIndex(e):e,l=this.hot.runHooks("modifyGetCellCoords",a,s,n,r);if(Array.isArray(l)){const[e,t,n,r]=l;return[e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,n>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)):n,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(e,t)=>{const n=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,i=t>=0?r.getVisualFromRenderableIndex(t):t,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",o,i);if(Array.isArray(s)){const[e,t]=s;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const n=this.countRenderableRows(),r=e.startRow,i=e.endRow;if("number"===typeof t)e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1);else if("auto"===t){const t=Math.max(1,Math.ceil(i/n*12));e.startRow=Math.max(r-t,0),e.endRow=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const n=this.countRenderableColumns(),r=e.startColumn,i=e.endColumn;if("number"===typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)),"auto"===t){const t=Math.max(1,Math.ceil(i/n*6));e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(i+t,n-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Cl(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(St(e))return!0;const t=Be(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Al(_l,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!Ge(n,"relative"))return Xe(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:r}=this.hot,i=n.createElement("div"),o=n.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const o=t.firstChild;Ge(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,r),o.className="",$e(o,["relative",...i()])):(Xe(t),this.appendColHeader(e,t,n,r))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span"),l=i();s.classList.add("relative",...l),a.className="colHeader",this.settings.ariaTags&&(Ke(s,"role","presentation"),Ke(a,"role","presentation")),this.updateCellHeader(a,e,n,r),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ge(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):Ge(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?Je(e,n(t,r)):(Ze(e,String.fromCharCode(160)),$e(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){Dl(Vl,this,e),Dl(Bl,this,t)}getLastSize(){return{width:Al(Vl,this),height:Al(Bl,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!==t&&void 0!==t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Al(Ol,this)}getRowHeadersCount(){return Al(Nl,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function Kl(e){let t,n=e+1,r="";for(;n>0;)t=(n-1)%26,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/26,10);return r}function Yl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;const r=[];return Array.isArray(e)&&Array.isArray(e[0])||(n=[e]),n.forEach((e,n)=>{Array.isArray(e)?e.forEach((e,i)=>{r.push([n+t,i,e])}):Object.keys(e).forEach(i=>{r.push([n+t,i,e[i]])})}),r}function ql(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&un(e[0])&&(t=gn(e[0]))),t}function Xl(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ql=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Xl(this,"hot",void 0),Xl(this,"data",void 0),Xl(this,"dataType","array"),Xl(this,"colToProp",()=>{}),Xl(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return Ot(this.data,(n,r)=>{const i=this.getAtCell(r,e);t.push(i)}),t}getAtRow(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===n,{dataDotNotation:o}=this.hot.getSettings();let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],i?s.forEach((t,n)=>{a[n]=this.getAtPhysicalCell(e,n,s)}):Zr(t,n,n=>{a[n-t]=this.getAtPhysicalCell(e,n,s)});else if(un(s)||Jt(s))if(a=r?[]:{},!i||r){const i=0,l=this.countFirstRowKeys()-1;Zr(i,l,c=>{const u=this.colToProp(c);if(c>=(t||i)&&c<=(n||l)&&!Number.isInteger(u)){const t=this.getAtPhysicalCell(e,u,s);r?a.push(t):o?pn(a,u,t):a[u]=t}})}else hn(s,(t,n)=>{const r=this.getAtPhysicalCell(e,n,s);o?pn(a,n,r):a[n]=r});return a}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=fn(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=n:pn(this.data[e],t,n))}}getAtPhysicalCell(e,t,n){let r=null;if(n)if("string"===typeof t){const{dataDotNotation:e}=this.hot.getSettings();r=e?function(e,t){const n=t.split(".");let r=e;return hn(n,e=>{if(r=r[e],void 0===r)return r=void 0,!1}),r}(n,t):n[t]}else r="function"===typeof t?t(n):n[t];if(this.hot.hasHook("modifySourceData")){const n=fn(r);this.hot.runHooks("modifySourceData",e,t,n,"get"),n.isTouched()&&(r=n.value)}return r}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,i=null,o=null,s=null,a=null;null===e||null===t?(r=!0,i=0,s=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col));const l=[];return Zr(i,s,e=>{l.push(r?this.getAtRow(e,void 0,void 0,n):this.getAtRow(e,o,a,n))}),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return ql(this.data)}destroy(){this.data=null,this.hot=null}},Jl={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,n,r,i,o,s){if(this._localHooks[e]){const a=this._localHooks[e].length;for(let l=0;l<a;l++)tn(this._localHooks[e][l],this,t,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};dn(Jl,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const Zl=Jl;function ec(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;ec(this,"indexedValues",[]),ec(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Jt(this.initValueOrFn)?Zr(e-1,e=>this.indexedValues.push(this.initValueOrFn(e))):Zr(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function nc(e,t,n){return[...e.slice(0,t),...n,...e.slice(t)]}function rc(e,t){return Dt(e,e=>!1===t.includes(e))}function ic(e,t){return Ft(e,e=>e-t.filter(t=>t<e).length)}function oc(e,t){const n=t[0],r=t.length;return Ft(e,e=>e>=n?e+r:e)}ln(tc,Zl);class sc extends tc{constructor(){super(e=>e)}insert(e,t){const n=oc(this.indexedValues,t);this.indexedValues=nc(n,e,t),super.insert(e,t)}remove(e){const t=rc(this.indexedValues,e);this.indexedValues=ic(t,e),super.remove(e)}}function ac(e,t,n,r){const i=n.length?n[0]:void 0;return[...e.slice(0,i),...n.map((e,t)=>Jt(r)?r(e,t):r),...void 0===i?[]:e.slice(i)]}function lc(e,t){return Dt(e,(e,n)=>!1===t.includes(n))}class cc extends tc{insert(e,t){this.indexedValues=ac(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=lc(this.indexedValues,e),super.remove(e)}}class uc extends cc{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return At(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function dc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hc extends tc{constructor(){super(...arguments),dc(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=rc(this.orderOfIndexes,[e]),Jt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=ac(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=oc(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=lc(this.indexedValues,e),this.orderOfIndexes=rc(this.orderOfIndexes,e),this.orderOfIndexes=ic(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class pc extends cc{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return At(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}const gc=new Map([["hiding",uc],["index",tc],["linkedPhysicalIndexToValue",hc],["physicalIndexToValue",cc],["trimming",pc]]);function fc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let mc=0;class vc{constructor(){fc(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),mc+=1)}unregister(e){const t=this.collection.get(e);Vt(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),mc-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Bt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}function wc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ln(vc,Zl);class bc extends vc{constructor(e,t){super(),wc(this,"mergedValuesCache",[]),wc(this,"aggregationFunction",void 0),wc(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=Ft(this.get(),e=>e.getValues()),t=[],n=Vt(e[0])&&e[0].length||0;for(let r=0;r<n;r+=1){const n=[];for(let t=0;t<this.getLength();t+=1)n.push(e[t][r]);t.push(n)}return Ft(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return Vt(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Cc(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function yc(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Sc=new WeakMap;class xc{constructor(){Cc(this,Sc,[])}subscribe(e){var t,n;return this.addLocalHook("change",e),this._write((n=this,(t=Sc).get(yc(t,n)))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){!function(e,t,n){e.set(yc(e,t),n)}(Sc,this,e)}}function Rc(e,t){const n=[];let r=0,i=0;for(;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function Ec(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function Tc(e,t){return e.get(Mc(e,t))}function kc(e,t,n){return e.set(Mc(e,t),n),n}function Mc(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ln(xc,Zl);var Pc=new WeakMap,Ic=new WeakMap,Ac=new WeakMap,Dc=new WeakMap,Fc=new WeakMap;class Oc{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ec(this,Pc,new Set),Ec(this,Ic,[]),Ec(this,Ac,[]),Ec(this,Dc,!1),Ec(this,Fc,!1),kc(Fc,this,null!==e&&void 0!==e&&e)}createObserver(){const e=new xc;return Tc(Pc,this).add(e),e.addLocalHook("unsubscribe",()=>{Tc(Pc,this).delete(e)}),e._writeInitialChanges(Rc(Tc(Ic,this),Tc(Ac,this))),e}emit(e){let t=Tc(Ac,this);Tc(Dc,this)&&Tc(Ic,this).length===e.length||(0===e.length?e=new Array(t.length).fill(Tc(Fc,this)):kc(Ic,this,new Array(e.length).fill(Tc(Fc,this))),Tc(Dc,this)||(kc(Dc,this,!0),t=Tc(Ic,this)));const n=Rc(t,e);Tc(Pc,this).forEach(e=>e._write(n)),kc(Ac,this,e)}}function Nc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new Set;class Lc{constructor(){Nc(this,"indexesSequence",new sc),Nc(this,"trimmingMapsCollection",new bc(e=>e.some(e=>!0===e),!1)),Nc(this,"hidingMapsCollection",new bc(e=>e.some(e=>!0===e),!1)),Nc(this,"variousMapsCollection",new vc),Nc(this,"hidingChangesObservable",new Oc({initialIndexValue:!1})),Nc(this,"notTrimmedIndexesCache",[]),Nc(this,"notHiddenIndexesCache",[]),Nc(this,"isBatched",!1),Nc(this,"indexesSequenceChanged",!1),Nc(this,"indexesChangeSource",void 0),Nc(this,"trimmedIndexesChanged",!1),Nc(this,"hiddenIndexesChanged",!1),Nc(this,"renderablePhysicalIndexesCache",[]),Nc(this,"fromPhysicalToVisualIndexesCache",new Map),Nc(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!gc.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(gc.get(e))(t)}(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof pc?this.trimmingMapsCollection.register(e,t):t instanceof uc?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Vt(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Vt(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Vt(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Vt(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const r=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?r.findIndex(t=>t>e):r.reverse().findIndex(t=>t<e),-1===i?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map(t=>t+e);this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter(e=>!1===this.isTrimmed(e))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter(e=>!1===this.isHidden(e))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter(e=>!1===this.isHidden(e))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"===typeof e&&(e=[e]);const n=Ft(e,e=>this.getPhysicalFromVisualIndex(e)),r=this.getNotTrimmedIndexesLength(),i=e.length,o=rc(this.getIndexesSequence(),n),s=o.filter(e=>!1===this.isTrimmed(e));let a=o.indexOf(s[s.length-1])+1;if(t+i<r){const e=s[t];a=o.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(nc(o,a,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],r=Vt(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=Ft(new Array(t).fill(r),(e,t)=>e+t);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),n=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(n,t)}}}function _c(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function Hc(e){Vt(e)&&Wn(_t`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}ln(Lc,Zl);const{register:Vc,getValues:Bc}=ar("phraseFormatters");Vc("pluralize",function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e});const Wc="ContextMenu:items",zc=`${Wc}.noItems`,jc=`${Wc}.insertRowAbove`,Gc=`${Wc}.insertRowBelow`,$c=`${Wc}.insertColumnOnTheLeft`,Uc=`${Wc}.insertColumnOnTheRight`,Kc=`${Wc}.removeRow`,Yc=`${Wc}.removeColumn`,qc=`${Wc}.undo`,Xc=`${Wc}.redo`,Qc=`${Wc}.readOnly`,Jc=`${Wc}.clearColumn`,Zc=`${Wc}.copy`,eu=`${Wc}.copyWithHeaders`,tu=`${Wc}.copyWithGroupHeaders`,nu=`${Wc}.copyHeadersOnly`,ru=`${Wc}.cut`,iu=`${Wc}.freezeColumn`,ou=`${Wc}.unfreezeColumn`,su=`${Wc}.mergeCells`,au=`${Wc}.unmergeCells`,lu=`${Wc}.addComment`,cu=`${Wc}.editComment`,uu=`${Wc}.removeComment`,du=`${Wc}.readOnlyComment`,hu=`${Wc}.align`,pu=`${Wc}.align.left`,gu=`${Wc}.align.center`,fu=`${Wc}.align.right`,mu=`${Wc}.align.justify`,vu=`${Wc}.align.top`,wu=`${Wc}.align.middle`,bu=`${Wc}.align.bottom`,Cu=`${Wc}.borders`,yu=`${Wc}.borders.top`,Su=`${Wc}.borders.right`,xu=`${Wc}.borders.bottom`,Ru=`${Wc}.borders.left`,Eu=`${Wc}.borders.remove`,Tu=`${Wc}.nestedHeaders.insertChildRow`,ku=`${Wc}.nestedHeaders.detachFromParent`,Mu=`${Wc}.hideColumn`,Pu=`${Wc}.showColumn`,Iu=`${Wc}.hideRow`,Au=`${Wc}.showRow`,Du="Filters:",Fu=`${Du}conditions`,Ou=`${Fu}.none`,Nu=`${Fu}.isEmpty`,Lu=`${Fu}.isNotEmpty`,_u=`${Fu}.isEqualTo`,Hu=`${Fu}.isNotEqualTo`,Vu=`${Fu}.beginsWith`,Bu=`${Fu}.endsWith`,Wu=`${Fu}.contains`,zu=`${Fu}.doesNotContain`,ju=`${Fu}.byValue`,Gu=`${Fu}.greaterThan`,$u=`${Fu}.greaterThanOrEqualTo`,Uu=`${Fu}.lessThan`,Ku=`${Fu}.lessThanOrEqualTo`,Yu=`${Fu}.isBetween`,qu=`${Fu}.isNotBetween`,Xu=`${Fu}.after`,Qu=`${Fu}.before`,Ju=`${Fu}.today`,Zu=`${Fu}.tomorrow`,ed=`${Fu}.yesterday`,td=`${Du}labels.filterByCondition`,nd=`${Du}labels.filterByValue`,rd=`${Du}labels.conjunction`,id=`${Du}labels.disjunction`,od=`${Du}values.blankCells`,sd=`${Du}buttons.selectAll`,ad=`${Du}buttons.clear`,ld=`${Du}buttons.ok`,cd=`${Du}buttons.cancel`,ud=`${Du}buttons.placeholder.search`,dd=`${Du}buttons.placeholder.value`,hd=`${Du}buttons.placeholder.secondValue`,pd="CheckboxRenderer:",gd=`${pd}checked`,fd=`${pd}unchecked`,md={languageCode:"en-US",[zc]:"No available options",[jc]:"Insert row above",[Gc]:"Insert row below",[$c]:"Insert column left",[Uc]:"Insert column right",[Kc]:["Remove row","Remove rows"],[Yc]:["Remove column","Remove columns"],[qc]:"Undo",[Xc]:"Redo",[Qc]:"Read only",[Jc]:"Clear column",[hu]:"Alignment",[pu]:"Left",[gu]:"Center",[fu]:"Right",[mu]:"Justify",[vu]:"Top",[wu]:"Middle",[bu]:"Bottom",[iu]:"Freeze column",[ou]:"Unfreeze column",[Cu]:"Borders",[yu]:"Top",[Su]:"Right",[xu]:"Bottom",[Ru]:"Left",[Eu]:"Remove border(s)",[lu]:"Add comment",[cu]:"Edit comment",[uu]:"Delete comment",[du]:"Read-only comment",[su]:"Merge cells",[au]:"Unmerge cells",[Zc]:"Copy",[eu]:["Copy with header","Copy with headers"],[tu]:["Copy with group header","Copy with group headers"],[nu]:["Copy header only","Copy headers only"],[ru]:"Cut",[Tu]:"Insert child row",[ku]:"Detach from parent",[Mu]:["Hide column","Hide columns"],[Pu]:["Show column","Show columns"],[Iu]:["Hide row","Hide rows"],[Au]:["Show row","Show rows"],[Ou]:"None",[Nu]:"Is empty",[Lu]:"Is not empty",[_u]:"Is equal to",[Hu]:"Is not equal to",[Vu]:"Begins with",[Bu]:"Ends with",[Wu]:"Contains",[zu]:"Does not contain",[Gu]:"Greater than",[$u]:"Greater than or equal to",[Uu]:"Less than",[Ku]:"Less than or equal to",[Yu]:"Is between",[qu]:"Is not between",[Xu]:"After",[Qu]:"Before",[Ju]:"Today",[Zu]:"Tomorrow",[ed]:"Yesterday",[od]:"Blank cells",[td]:"Filter by condition",[nd]:"Filter by value",[rd]:"And",[id]:"Or",[sd]:"Select all",[ad]:"Clear",[ld]:"OK",[cd]:"Cancel",[ud]:"Search",[dd]:"Value",[hd]:"Second value",[gd]:"Checked",[fd]:"Unchecked"},vd=e,wd=md.languageCode,{register:bd,getItem:Cd,hasItem:yd,getValues:Sd}=ar("languagesDictionaries");function xd(e,t){let n=e,r=t;return un(e)&&(r=e,n=r.languageCode),function(e,t){e!==wd&&(n=t,hn(Cd(wd),(e,t)=>{Bt(n[t])&&(n[t]=e)}));var n}(n,r),bd(n,sn(r)),sn(r)}function Rd(e){return Ed(e)?sn(Cd(e)):null}function Ed(e){return yd(e)}function Td(e,t,n){const r=Rd(e);if(null===r)return null;const i=r[t];if(Bt(i))return null;const o=function(e,t){let n=e;return Ot(function(){return Bc()}(),r=>{n=r(e,t)}),n}(i,n);return Array.isArray(o)?o[0]:o}xd(md);const kd="active-header",Md="header",Pd="area",Id="focus";class Ad{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}ln(Ad,Zl);const Dd=Ad;function Fd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Od=class extends Dd{constructor(e,t){super(e,null),Fd(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,r=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);return null===r||null===i?null:((r.row>i.row||r.col>i.col)&&(r=t,i=n),this.settings.createCellRange(r,r,i))}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===r)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return null===i?null:this.settings.createCellCoords(r,i)}getNearestNotHiddenIndex(e,t,n){return t<0?t:e.getNearestNotHiddenIndex(t,n)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),n="N-S"===e.getVerticalDirection()?1:-1,r="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if(null!==i&&null!==i.col&&null!==i.row||(o=this.getNearestNotHiddenCoords(t,n,r)),null!==o&&e.overlaps(o)){const t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return null===n.row||null===n.col||null===r.row||null===r.col?null:this.settings.createCellRange(n,n,r)}};function Nd(e){let{activeHeaderClassName:t,...n}=e;return new Od({className:t,...n,selectionType:kd})}function Ld(e){let{areaCornerVisible:t,...n}=e;return new Od({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...n,selectionType:Pd})}function _d(e){let{...t}=e;return new Od({className:"highlight",...t,selectionType:Pd})}function Hd(e){let{columnClassName:t,...n}=e;return new Od({className:t,...n,selectionType:"column"})}function Vd(e){let{headerClassName:t,...n}=e;return new Od({className:t,...n,selectionType:Md})}function Bd(e){let{rowClassName:t,...n}=e;return new Od({className:t,...n,selectionType:"row"})}function Wd(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jd(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Gd=new WeakSet;class $d{constructor(e){Wd(this,Gd),zd(this,"options",void 0),zd(this,"layerLevel",0),zd(this,"focus",void 0),zd(this,"fill",void 0),zd(this,"layeredAreas",new Map),zd(this,"areas",new Map),zd(this,"rowHeaders",new Map),zd(this,"columnHeaders",new Map),zd(this,"activeRowHeaders",new Map),zd(this,"activeColumnHeaders",new Map),zd(this,"activeCornerHeaders",new Map),zd(this,"rowHighlights",new Map),zd(this,"columnHighlights",new Map),zd(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...n}=e;return new Od({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t},...n,selectionType:Id})}(e),this.fill=function(e){let{...t}=e;return new Od({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:"fill"})}(e)}isEnabledFor(e,t){let n=e;e===Id&&(n="current");let r=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return jd(Gd,this,Ud).call(this,this.layeredAreas,Ld)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return jd(Gd,this,Ud).call(this,this.areas,_d)}getAreas(){return[...this.areas.values()]}createRowHeader(){return jd(Gd,this,Ud).call(this,this.rowHeaders,Vd)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return jd(Gd,this,Ud).call(this,this.columnHeaders,Vd)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return jd(Gd,this,Ud).call(this,this.activeRowHeaders,Nd)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return jd(Gd,this,Ud).call(this,this.activeColumnHeaders,Nd)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return jd(Gd,this,Ud).call(this,this.activeCornerHeaders,Nd)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return jd(Gd,this,Ud).call(this,this.rowHighlights,Bd)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return jd(Gd,this,Ud).call(this,this.columnHighlights,Hd)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:n,...r}=e;return new Od({...t,...r,selectionType:"custom-selection"},n)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Ot(this.areas.values(),e=>{e.clear()}),Ot(this.layeredAreas.values(),e=>{e.clear()}),Ot(this.rowHeaders.values(),e=>{e.clear()}),Ot(this.columnHeaders.values(),e=>{e.clear()}),Ot(this.activeRowHeaders.values(),e=>{e.clear()}),Ot(this.activeColumnHeaders.values(),e=>{e.clear()}),Ot(this.activeCornerHeaders.values(),e=>{e.clear()}),Ot(this.rowHighlights.values(),e=>{e.clear()}),Ot(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ud(e,t){const n=this.layerLevel;if(e.has(n))return e.get(n);const r=t({layerLevel:n,...this.options});return e.set(n,r),r}const Kd=$d;function Yd(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qd{constructor(e){Yd(this,"ranges",[]),Yd(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const Xd=qd;function Qd(e,t,n){Jd(e,t),t.set(e,n)}function Jd(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zd(e,t){return e.get(th(e,t))}function eh(e,t,n){return e.set(th(e,t),n),n}function th(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nh=new WeakMap,rh=new WeakMap,ih=new WeakMap,oh=new WeakSet;class sh{constructor(e,t){var n,r;Jd(n=this,r=oh),r.add(n),Qd(this,nh,void 0),Qd(this,rh,void 0),Qd(this,ih,{x:0,y:0}),eh(nh,this,e),eh(rh,this,t)}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Zd(rh,this).createCellCoords(e,t);let i=Zd(nh,this).current().highlight;const o=Zd(rh,this).visualToRenderableCoords(i);let s=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){const{width:e,height:t}=th(oh,this,lh).call(this),{row:o,col:l}=th(oh,this,dh).call(this,i),c=Zd(rh,this).fixedRowsBottom(),u=Zd(rh,this).minSpareRows(),d=Zd(rh,this).minSpareCols(),h=Zd(rh,this).autoWrapRow(),p=Zd(rh,this).autoWrapCol(),g=Zd(rh,this).createCellCoords(o+r.row,l+r.col);if(g.row>=t){const r=fn(n&&u>0&&0===c),i=g.col+1,o=Zd(rh,this).createCellCoords(g.row-t,i>=e?i-e:i);this.runLocalHooks("beforeColumnWrap",r,th(oh,this,hh).call(this,o),i>=e),r.value?this.runLocalHooks("insertRowRequire",Zd(rh,this).countRenderableRows()):p&&g.assign(o)}else if(g.row<0){const n=fn(p),r=g.col-1,i=Zd(rh,this).createCellCoords(t+g.row,r<0?e+r:r);this.runLocalHooks("beforeColumnWrap",n,th(oh,this,hh).call(this,i),r<0),p&&g.assign(i)}if(g.col>=e){const r=fn(n&&d>0),i=g.row+1,o=Zd(rh,this).createCellCoords(i>=t?i-t:i,g.col-e);this.runLocalHooks("beforeRowWrap",r,th(oh,this,hh).call(this,o),i>=t),r.value?this.runLocalHooks("insertColRequire",Zd(rh,this).countRenderableColumns()):h&&g.assign(o)}else if(g.col<0){const n=fn(h),r=g.row-1,i=Zd(rh,this).createCellCoords(r<0?t+r:r,e+g.col);this.runLocalHooks("beforeRowWrap",n,th(oh,this,hh).call(this,i),r<0),h&&g.assign(i)}const{rowDir:f,colDir:m}=th(oh,this,ah).call(this,g);s=f,a=m,i=th(oh,this,hh).call(this,g)}return this.runLocalHooks("afterTransformStart",i,s,a),i}transformEnd(e,t){const n=Zd(rh,this).createCellCoords(e,t),r=Zd(nh,this).current(),i=Zd(rh,this).visualToRenderableCoords(r.highlight),o=th(oh,this,ch).call(this,r.to.row,r.from.row),s=th(oh,this,uh).call(this,r.to.col,r.from.col),a=r.to.clone();let l=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),null!==i.row&&null!==i.col&&null!==o&&null!==s){const{row:e,col:t}=th(oh,this,dh).call(this,r.highlight),i=Zd(rh,this).createCellCoords(o+n.row,s+n.col),u=r.getTopStartCorner(),d=r.getTopEndCorner(),h=r.getBottomEndCorner();if(n.col<0&&s>=t&&i.col<t){const e=i.col-t;i.col=th(oh,this,uh).call(this,u.col,d.col)+e}else if(n.col>0&&s<=t&&i.col>t){const e=th(oh,this,uh).call(this,d.col,u.col),t=Math.max(i.col-e,1);i.col=e+t}if(n.row<0&&o>=e&&i.row<e){const t=i.row-e;i.row=th(oh,this,ch).call(this,u.row,h.row)+t}else if(n.row>0&&o<=e&&i.row>e){const e=th(oh,this,ch).call(this,h.row,u.row),t=Math.max(i.row-e,1);i.row=e+t}const{rowDir:p,colDir:g}=th(oh,this,ah).call(this,i);l=p,c=g;const f=th(oh,this,hh).call(this,i);0===n.row&&0!==n.col?a.col=f.col:0!==n.row&&0===n.col?a.row=f.row:(a.row=f.row,a.col=f.col)}return this.runLocalHooks("afterTransformEnd",a,l,c),a}setOffsetSize(e){let{x:t,y:n}=e;eh(ih,this,{x:t,y:n})}resetOffsetSize(){eh(ih,this,{x:0,y:0})}}function ah(e){const{width:t,height:n}=th(oh,this,lh).call(this);let r=0,i=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=n&&(r=1,e.row=n-1),e.col<0?(i=-1,e.col=0):e.col>0&&e.col>=t&&(i=1,e.col=t-1),{rowDir:r,colDir:i}}function lh(){return{width:Zd(ih,this).x+Zd(rh,this).countRenderableColumns(),height:Zd(ih,this).y+Zd(rh,this).countRenderableRows()}}function ch(e,t){const n=Zd(rh,this).findFirstNonHiddenRenderableRow(e,t);return null===n?null:Zd(ih,this).y+n}function uh(e,t){const n=Zd(rh,this).findFirstNonHiddenRenderableColumn(e,t);return null===n?null:Zd(ih,this).x+n}function dh(e){const{row:t,col:n}=Zd(rh,this).visualToRenderableCoords(e);if(null===t||null===n)throw new Error("Renderable coords are not visible.");return Zd(rh,this).createCellCoords(Zd(ih,this).y+t,Zd(ih,this).x+n)}function hh(e){const t=e.clone();return t.col=e.col-Zd(ih,this).x,t.row=e.row-Zd(ih,this).y,Zd(rh,this).renderableToVisualCoords(t)}ln(sh,Zl);const ph=sh,gh=[3,2],fh=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],mh=Symbol("root"),vh=Symbol("child");function wh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mh;if(t!==mh&&t!==vh)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(e),r=t===mh;let i=0;if(n){const t=e[0];if(0===e.length)i=1;else if(r&&t instanceof hs)i=3;else if(r&&Array.isArray(t))i=wh(t,vh);else if(e.length>=2&&e.length<=4){const t=!e.some((e,t)=>!fh[t].includes(typeof e));t&&(i=2)}}return i}function bh(e){let{createCellCoords:t,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!gh.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=3===e;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],c=s?o.to.row:o[2],u=s?o.to.col:o[3];if("function"===typeof i&&("string"===typeof l&&(l=i(l)),"string"===typeof u&&(u=i(u))),Bt(c)&&(c=a),Bt(u)&&(u=l),!r){const e=a,t=l,n=c,r=u;a=Math.min(e,n),l=Math.min(t,r),c=Math.max(e,n),u=Math.max(t,r)}const d=t(a,l),h=t(c,u);return n(d,d,h)}}function Ch(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function yh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sh(e,t){return e.get(Rh(e,t))}function xh(e,t,n){return e.set(Rh(e,t),n),n}function Rh(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Eh=new WeakMap,Th=new WeakMap,kh=new WeakMap,Mh=new WeakMap,Ph=new WeakMap,Ih=new WeakMap;class Ah{constructor(e,t){var n=this;yh(this,"settings",void 0),yh(this,"tableProps",void 0),yh(this,"inProgress",!1),yh(this,"selectedRange",new Xd((e,t,n)=>this.tableProps.createCellRange(e,t,n))),yh(this,"highlight",void 0),Ch(this,Eh,void 0),Ch(this,Th,void 0),yh(this,"selectedByRowHeader",new Set),yh(this,"selectedByColumnHeader",new Set),Ch(this,kh,!1),Ch(this,Mh,!1),Ch(this,Ph,"unknown"),Ch(this,Ih,-1),this.settings=e,this.tableProps=t,this.highlight=new Kd({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,n)=>this.tableProps.createCellRange(e,t,n)}),xh(Eh,this,new ph(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),xh(Th,this,new ph(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Sh(Eh,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...t)}),Sh(Eh,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...t)}),Sh(Eh,this).addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...t)}),Sh(Eh,this).addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...t)}),Sh(Eh,this).addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...t)}),Sh(Eh,this).addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("insertColRequire",...t)}),Sh(Eh,this).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeRowWrap",...t)}),Sh(Eh,this).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeColumnWrap",...t)}),Sh(Th,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformFocus",...t)}),Sh(Th,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("afterModifyTransformFocus",...t)})}getSelectedRange(){return this.selectedRange}markSource(e){xh(Ph,this,e)}markEndSource(){xh(Ph,this,"unknown")}getSelectionSource(){return Sh(Ph,this)}setExpectedLayers(e){xh(Ih,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,xh(Ih,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const i="multiple"===this.settings.selectionMode,o=Bt(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();xh(kh,this,!1),this.runLocalHooks("beforeSetRangeStart"+(n?"Only":""),s),(!i||i&&!o&&Bt(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),r=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||r>0)&&(0===n&&t.col<0&&!i||0===r&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{const e=o.getHorizontalDirection(),n=o.getVerticalDirection(),r=this.isMultiple();o.setTo(t),r&&(e!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),r&&(n!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const s=-1===Sh(Ih,this)||this.selectedRange.size()===Sh(Ih,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),r=this.tableProps.countCols();t<this.highlight.layerLevel&&(Ot(this.highlight.getAreas(),e=>{e.clear()}),Ot(this.highlight.getLayeredAreas(),e=>{e.clear()}),Ot(this.highlight.getRowHeaders(),e=>{e.clear()}),Ot(this.highlight.getColumnHeaders(),e=>{e.clear()}),Ot(this.highlight.getActiveRowHeaders(),e=>{e.clear()}),Ot(this.highlight.getActiveColumnHeaders(),e=>{e.clear()}),Ot(this.highlight.getActiveCornerHeaders(),e=>{e.clear()}),Ot(this.highlight.getRowHighlights(),e=>{e.clear()}),Ot(this.highlight.getColumnHighlights(),e=>{e.clear()})),this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),s=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),u=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),s.clear(),a.clear(),l.clear(),c.clear(),u.clear(),d.clear(),h.clear(),this.highlight.isEnabledFor(Pd,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(Md,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),n=this.tableProps.createCellCoords(e.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),i=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(s.add(t).commit(),a.add(r).commit(),d.add(t).commit(),h.add(r).commit()):(s.add(t).add(n).commit(),a.add(r).add(i).commit(),d.add(t).add(n).commit(),h.add(r).add(i).commit())}const t=!Sh(Mh,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||0===r&&this.isSelectedByRowHeader()),i=!Sh(Mh,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||0===n&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),i&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&i&&u.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Id,t.highlight)&&n.add(t.highlight).commit().syncWith(t),this.inProgress||(xh(kh,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?Sh(Eh,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Sh(Eh,this).resetOffsetSize(),this.setRangeStart(Sh(Eh,this).transformStart(e,t,n))}transformEnd(e,t){this.settings.navigableHeaders?Sh(Eh,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Sh(Eh,this).resetOffsetSize(),this.setRangeEnd(Sh(Eh,this).transformEnd(e,t))}transformFocus(e,t){const n=this.selectedRange.current(),{row:r,col:i}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),s=this.tableProps.countRenderableRowsInRange(0,r-1);n.highlight.isHeader()?Sh(Th,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:r<0?Math.abs(r):-s}):Sh(Th,this).setOffsetSize({x:i<0?0:-o,y:r<0?0:-s});const a=Sh(Th,this).transformStart(e,t);this.setRangeFocus(a.normalize())}shiftRows(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countRows(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=l?-1:0,u=l?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(ni(r.row+u,c,s-1),r.col),h=this.tableProps.createCellCoords(ni(i.row+t,c,s-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(ni(o.row+t,0,s-1),o.col)):this.setRangeStartOnly(d,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:r,to:i,highlight:o}=n,s=this.tableProps.countCols(),a=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=a?-1:0,u=a?0:t;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,ni(r.col+u,c,s-1)),h=this.tableProps.createCellCoords(i.row,ni(i.col+t,c,s-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,ni(o.col+t,0,s-1))):this.setRangeStartOnly(d,!0),a&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=fn(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Sh(kh,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),n=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(n>0&&t<0||0===n)&&e.getWidth()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),n=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(n>0&&t<0||0===n)&&e.getHeight()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));const n=this.selectedRange.peekByIndex(e);return!!n&&t(n)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countColHeaders(),l=n?-a:0,c=t?-s:0;if(0===l&&0===c&&(0===i||0===o))return;let u=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:h}=r;xh(Mh,this,h),d&&Number.isInteger(null===d||void 0===d?void 0:d.row)&&Number.isInteger(null===d||void 0===d?void 0:d.col)&&(u=this.tableProps.createCellCoords(ni(d.row,l,i-1),ni(d.col,c,o-1)));const p=this.tableProps.createCellCoords(l,c),g=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(p,void 0,u),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),xh(Mh,this,!1)}selectCells(e){var t=this;const n=wh(e);if(1===n)return!1;if(0===n)throw new Error(_t`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=bh(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},s=!e.some(e=>{const t=r(e),n=t.isValid(o);return!(n&&!t.containsHeaders()||n&&t.containsHeaders()&&t.isSingleHeader())});return s&&(this.clear(),this.setExpectedLayers(e.length),Ot(e,e=>{const{from:t,to:n}=r(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(n.clone())}),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r="string"===typeof e?this.tableProps.propToCol(e):e,i="string"===typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countColHeaders(),l=0===a?0:-a,c=this.tableProps.createCellCoords(l,r),u=this.tableProps.createCellCoords(o-1,i),d=this.tableProps.createCellRange(c,c,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:a});if(d){let e=0,t=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(e=ni(n.row,l,o-1),t=ni(n.col,Math.min(r,i),Math.max(r,i))):(e=ni(n,l,o-1),t=r);const s=this.tableProps.createCellCoords(e,t),c=0===a?0:ni(s.row,l,-1),u=o-1,d=this.tableProps.createCellCoords(c,r),h=this.tableProps.createCellCoords(u,i);this.runLocalHooks("beforeSelectColumns",d,h,s),d.row=c,h.row=u,this.setRangeStartOnly(d,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",d,h,s),this.finish()}return d}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,a=this.tableProps.createCellCoords(e,s),l=this.tableProps.createCellCoords(t,i-1),c=this.tableProps.createCellRange(a,a,l).isValid({countRows:r,countCols:i,countRowHeaders:o,countColHeaders:0});if(c){let r=0,a=0;Number.isInteger(null===n||void 0===n?void 0:n.row)&&Number.isInteger(null===n||void 0===n?void 0:n.col)?(r=ni(n.row,Math.min(e,t),Math.max(e,t)),a=ni(n.col,s,i-1)):(r=e,a=ni(n,s,i-1));const l=this.tableProps.createCellCoords(r,a),c=0===o?0:ni(l.col,s,-1),u=i-1,d=this.tableProps.createCellCoords(e,c),h=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",d,h,l),d.col=c,h.col=u,this.setRangeStartOnly(d,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",d,h,l),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:r,to:i,highlight:o}=n;this.clear(),o.assign({row:ni(o.row,-1/0,e-1),col:ni(o.col,-1/0,t-1)}),r.assign({row:ni(r.row,-1/0,e-1),col:ni(r.col,-1/0,t-1)}),i.assign({row:ni(i.row,0,e-1),col:ni(i.col,0,t-1)}),this.selectedRange.ranges.push(n),this.highlight.isEnabledFor(Id,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(e=>{e.commit()}),!this.isSelected())return;const e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(Id,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),a=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),c=this.highlight.createColumnHighlight();e.commit(),t.commit(),r.commit(),i.commit(),o.commit(),s.commit(),a.commit(),l.commit(),c.commit()}this.highlight.useLayerLevel(e)}}ln(Ah,Zl);const Dh=Ah,{register:Fh,getItem:Oh,hasItem:Nh,getNames:Lh,getValues:_h}=ar("cellTypes");function Hh(e,t){"string"!==typeof e&&(e=(t=e).CELL_TYPE);const{editor:n,renderer:r,validator:i}=t;n&&vr(e,n),r&&xi(e,r),i&&Pi(e,i),Fh(e,t)}function Vh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const r="string"===typeof t.type?function(e){if(!Nh(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return Oh(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&hn(t,(t,n)=>{e._automaticallyAssignedMetaProps.delete(n)}),!un(r))return;n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};hn(r,(t,r)=>{var o;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!mn(t,e))})(r,n)&&(i[r]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(r))}),rn(e,i)}function Bh(e){return Number.isInteger(e)&&e>=0}function Wh(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function zh(e){return null===e||void 0===e}const jh=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===Wt(r))return!1;return!0},isEmptyRow(e){let t,n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===Wt(r))return"object"===typeof r&&(i=this.getCellMeta(e,t),cn(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function Gh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $h{constructor(e){Gh(this,"metaCtor",class{}),Gh(this,"meta",void 0),this.meta=this.metaCtor.prototype,rn(this.meta,jh()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;rn(this.meta,e),Vh(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}function Uh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Kh{constructor(e){Uh(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){rn(this.meta,e),Vh(this.meta,e,e)}}function Yh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qh{constructor(e){Yh(this,"valueFactory",void 0),Yh(this,"data",[]),Yh(this,"index",[]),Yh(this,"holes",new Set),this.valueFactory=e}obtain(e){Wh(()=>Bh(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],void 0===n&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=n,this.index[e]=t}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Wh(()=>Bh(e)||zh(e),"Expecting an unsigned number or null/undefined argument.");const n=[],r=this.data.length;for(let o=0;o<t;o++)n.push(r+o),this.data.push(void 0);const i=zh(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Wh(()=>Bh(e)||zh(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(zh(e)?this.index.length-t:e,t);for(let r=0;r<n.length;r++){const e=n[r];"number"===typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,t)=>void 0!==e&&!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const t=this._getKeyByStorageIndex(n);-1!==t&&void 0!==this.data[n]&&e.push([t,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Xh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Qh=["data","width"];class Jh{constructor(e){Xh(this,"globalMeta",void 0),Xh(this,"metas",new qh(()=>this._createMeta())),this.globalMeta=e,this.metas=new qh(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);rn(n,t),Vh(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}var r,i;r=n,(i=e).prototype.constructor=i,r.prototype=new i,r.prototype.constructor=r;for(let o=0;o<t.length;o++)n.prototype[t[o]]=void 0;return n}(this.globalMeta.getMetaConstructor(),Qh).prototype}}function Zh(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ep{constructor(e){Zh(this,"columnMeta",void 0),Zh(this,"metas",new qh(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const r=this.getMeta(e,t);rn(r,n),Vh(r,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}setMeta(e,t,n,r){var i;const o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),o[n]=r}removeMeta(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)Vt(t[n])&&e.push(...t[n].values());return e}getMetasAtRow(e){Wh(()=>Bh(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new qh(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class tp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new $h(e),this.tableMeta=new Kh(this.globalMeta),this.columnMeta=new Jh(this.globalMeta),this.cellMeta=new ep(this.columnMeta),n.forEach(e=>new e(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){const r=this.cellMeta.getMeta(e,t);return r.visualRow=n.visualRow,r.visualCol=n.visualColumn,r.row=e,r.col=t,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function np(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ln(tp,Zl);class rp{constructor(e){var t=this;np(this,"metaManager",void 0),np(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return t.extendCellMeta(...arguments)}),ir.getSingleton().add("beforeRender",e=>{e&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:r}=e;if(null!==(t=this.metaSyncMemo.get(n))&&void 0!==t&&t.has(r))return;const{visualRow:i,visualCol:o}=e,s=this.metaManager.hot,a=s.colToProp(o);e.prop=a,s.runHooks("beforeGetCellMeta",i,o,e);const l=mn(e,"type")?e.type:null;let c=Jt(e.cells)?e.cells(n,r,a):null;var u;l&&(c?c.type=null!==(u=c.type)&&void 0!==u?u:l:c={type:l});c&&this.metaManager.updateCellMeta(n,r,c),s.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}function ip(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function op(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sp(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var ap=new WeakMap;class lp{constructor(e){op(this,"metaManager",void 0),op(this,"usageTracker",new Set),op(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),ip(this,ap,(e,t,n)=>{if(!n)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{initOnly:n,target:r,onChange:i}=e,o="string"===typeof r,s=o?r:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],i?(this.installPropWatcher(t,a,i),o&&this.installPropWatcher(r,a,i)):n&&(this.installPropWatcher(t,a,sp(ap,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))})}installPropWatcher(e,t,n){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const cp=/^(\r\n|\n\r|\r|\n)/,up=/^[^\t\r\n]+/,dp=/^\t/;function hp(e){let t,n,r,i,o,s="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)r>0&&(s+="\t"),o=e[t][r],"string"===typeof o?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:s+=null===o||void 0===o?"":o;t!==n-1&&(s+="\n")}return s}function pp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gp{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){pp(this,"hot",void 0),pp(this,"metaManager",void 0),pp(this,"tableMeta",void 0),pp(this,"dataSource",void 0),pp(this,"duckSchema",void 0),pp(this,"colToPropCache",void 0),pp(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let r=0,i=0,o=!1;if("function"===typeof t){const t=gn(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{const e=this.tableMeta.maxCols;r=Math.min(e,t.length)}for(n=0;n<r;n++){const e=o?t(n):t[n];if(un(e)){if("undefined"!==typeof e.data){const t=o?i:n;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return ql(this.dataSource)}recursiveDuckColumns(e,t,n){let r,i=t,o=n;return"undefined"===typeof i&&(i=0,o=""),"object"!==typeof e||Array.isArray(e)||hn(e,(e,t)=>{null===e?(r=o+t,this.colToPropCache.push(r),this.propToColCache.set(r,i),i+=1):i=this.recursiveDuckColumns(e,i,`${t}.`)}),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Vt(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Vt(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return null===n?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?nn(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,s=0,a=e;("number"!==typeof a||a>=i)&&(a=i),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a));if(!1===this.hot.runHooks("beforeCreateRow",a,t,n)||null===o)return{delta:0};const l=this.tableMeta.maxRows,c=this.getSchema().length,u=[];for(;s<t&&i+s<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=sn(this.getSchema()):(e=[],Zr(c-1,()=>e.push(null))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},on(e,this.getSchema())),u.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,i)),this.spliceData(o,0,u);const d=this.hot.toVisualRow(o);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(void 0===e||null===e?this.metaManager.createRow(null,s):"auto"!==n&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",d,s,n),{delta:s,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:n,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols();let a=e;("number"!==typeof a||a>=s)&&(a=s);if(!1===this.hot.runHooks("beforeCreateCol",a,t,n))return{delta:0};let l=s;a<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(a));const c=this.hot.countSourceRows();let u=this.hot.countCols(),d=0,h=l;"end"===r&&(h=Math.min(h+1,s));const p=h;for(;d<t&&u<o;){if("number"!==typeof a||a>=u)if(c>0)for(let e=0;e<c;e+=1)"undefined"===typeof i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<c;e++)i[e].splice(h,0,null);d+=1,h+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(a,d),d>0&&(void 0===e||null===e?this.metaManager.createColumn(null,d):"auto"!==n&&this.metaManager.createColumn(p,t));const g=this.hot.toVisualColumn(p);return this.hot.runHooks("afterCreateCol",g,d,n),this.refreshDuckSchema(),{delta:d,startPhysicalIndex:p}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(r,t),o=this.hot.countSourceRows();r=(o+r)%o;if(!1===this.hot.runHooks("beforeRemoveRow",r,i.length,i,n))return!1;const s=i.length;if(this.filterData(r,s,i),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const e=Vt(this.tableMeta.columns)||Vt(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((e,t)=>t-e).forEach(e=>{this.metaManager.removeRow(e,1)}),this.hot.runHooks("afterRemoveRow",r,s,i,n),!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r="number"!==typeof e?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();const i=this.visualColumnsToPhysical(r,t),o=i.slice(0).sort((e,t)=>t-e);if(!1===this.hot.runHooks("beforeRemoveCol",r,t,i,n))return!1;let s=!0;const a=o.length,l=this.dataSource;for(let c=0;c<a;c++)s&&i[0]!==i[c]-c&&(s=!1);if(s)for(let c=0,u=this.hot.countSourceRows();c<u;c++)l[c].splice(i[0],t),0===c&&this.metaManager.removeColumn(i[0],t);else for(let c=0,u=this.hot.countSourceRows();c<u;c++)for(let e=0;e<a;e++)l[c].splice(o[e],1),0===c&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,i,n),this.refreshDuckSchema(),!0}spliceCol(e,t,n){const r=this.hot.getDataAtCol(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Pt(a,o);let c=0;for(;c<n;)a.push(null),c+=1;return function(e){const t=e.length;let n=0;for(;n<t;)e[n]=[e[n]],n+=1}(a),this.hot.populateFromArray(t,e,a,null,null,"spliceCol"),i}spliceRow(e,t,n){const r=this.hot.getSourceDataAtRow(e),i=r.slice(t,t+n),o=r.slice(t+n);for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];Pt(a,o);let c=0;for(;c<n;)a.push(null),c+=1;return this.hot.populateFromArray(e,t,[a],null,null,"spliceRow"),i}spliceData(e,t,n){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,n)){const t=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach(e=>this.dataSource.push(e))}}filterData(e,t,n){let r=this.hot.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((e,t)=>-1===n.indexOf(t))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){const n=this.hot.toPhysicalRow(e);let r=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);r=isNaN(i)?i:r;const{dataDotNotation:o}=this.hot.getSettings();let s=null;if(r&&r.hasOwnProperty&&mn(r,t))s=r[t];else if(o&&"string"===typeof t&&t.indexOf(".")>-1){let e=r;if(!e)return null;const n=t.split(".");for(let t=0,r=n.length;t<r;t++)if(e=e[n[t]],"undefined"===typeof e)return null;s=e}else"function"===typeof t&&(s=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const e=fn(s);this.hot.runHooks("modifyData",n,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const r=this.hot.toPhysicalRow(e);let i=n,o=this.dataSource[r];const s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){const e=fn(i);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"set"),e.isTouched()&&(i=e.value)}const{dataDotNotation:a}=this.hot.getSettings();if(o&&o.hasOwnProperty&&mn(o,t))o[t]=i;else if(a&&"string"===typeof t&&t.indexOf(".")>-1){let e,n=o,r=0;const s=t.split(".");for(r=0,e=s.length-1;r<e;r++){if("__proto__"===s[r]||"constructor"===s[r]||"prototype"===s[r])return;"undefined"===typeof n[s[r]]&&(n[s[r]]={}),n=n[s[r]]}n[s[r]]=i}else if("function"===typeof t)t(this.dataSource.slice(r,r+1)[0],i);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;o[t]=i}}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),r=[];let i,o=(n+e)%n,s=t;for(;o<n&&s;)i=this.hot.toPhysicalRow(o),r.push(i),s-=1,o+=1;return r}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),r=[];let i=(n+e)%n,o=t;for(;i<n&&o;){const e=this.hot.toPhysicalColumn(i);r.push(e),o-=1,i+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!==0||this.hot.countSourceRows()?this.getRange(e,t,gp.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const r=[];let i,o,s;const a=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===a||0===l)return[];const c=n===gp.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(a-1,0),Math.max(e.row,t.row)),d=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){s=[];const n=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=d&&null!==n;o++)s.push(c.call(this,i,this.colToProp(o)));null!==n&&r.push(s)}return r}getText(e,t){return hp(this.getRange(e,t,gp.DESTINATION_RENDERER))}getCopyableText(e,t){return hp(this.getRange(e,t,gp.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const fp=gp;function mp(e,t,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:c,firstRun:u}=r,d=he(a),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":Jt(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks(`before${d}`,e,u,l);const p=new fp(i,e,c);if(t(p),"object"===typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${a} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=p.getSchema();let n;e=[];let r=0,o=0;for(r=0,o=h.startRows;r<o;r++)if("object"!==i.dataType&&"function"!==i.dataType||!h.dataSchema)if("array"===i.dataType)n=sn(t[0]),e.push(n);else{n=[];for(let e=0,t=h.startCols;e<t;e++)n.push(null);e.push(n)}else n=sn(t),e.push(n)}}Array.isArray(e[0])&&(i.dataType="array"),h.data=e,p.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${d}`,e,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ke(i.rootElement,[ke(-1),Me(i.countCols()+(i.view?i.countRowHeaders():0))])}function vp(e){kt(e)&&e.scrollIntoView({block:"nearest",inline:"nearest"})}function wp(e){const{selection:t,view:n}=e,r=e.getSelectedRangeLast(),i=t.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=r.getTopStartCorner().col,l=r.getBottomEndCorner().col,c=a<=o,u=l>=s,d=n.getFirstFullyVisibleRow(),h=n.getLastFullyVisibleRow(),p=r.getTopStartCorner().row,g=r.getBottomEndCorner().row,f=p<=d,m=g>=h;return{getComputedColumnTarget:e=>"mouse"===i||"keyboard"===i?e.col:c&&u?r.highlight.col:c?a:u?l:e.col,getComputedRowTarget:e=>"mouse"===i||"keyboard"===i?e.row:f&&m?r.highlight.row:f?p:m?g:e.row}}function bp(e){const{selection:t}=e;let n=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){n=!0},scrollTo(i){var o;if(n||r)return void(n=!1);let s;t.isFocusSelectionChanged()?s=function(e){return t=>{e.scrollViewportTo(t.toObject(),()=>{const{row:t,col:n}=e.getSelectedRangeLast().highlight;vp(e.getCell(t,n,!0))})}}(e):t.isSelectedByCorner()?s=()=>{}:t.isSelectedByRowHeader()?s=function(e){return t=>{const n=wp(e).getComputedRowTarget(t);e.scrollViewportTo({row:n},()=>{const t=!!e.getSettings().rowHeaders;vp(e.getCell(n,t?-1:0,!0))})}}(e):t.isSelectedByColumnHeader()?s=function(e){return t=>{const n=wp(e).getComputedColumnTarget(t);e.scrollViewportTo({col:n},()=>{const t=!!e.getSettings().colHeaders;vp(e.getCell(t?-1:0,n,!0))})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?s=function(e){return t=>{const n=wp(e),r={row:n.getComputedRowTarget(t),col:n.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{const{row:t,col:n}=r;vp(e.getCell(t,n,!0))})}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(s=function(e){return t=>{const n=wp(e),r={row:n.getComputedRowTarget(t),col:n.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{const{row:t,col:n}=r;vp(e.getCell(t,n,!0))})}}(e)):s=function(e){return t=>{const n=e.selection.getSelectionSource(),{row:r,col:i}=t,o=()=>{vp(e.getCell(r,i,!0))};if(r<0&&i>=0)e.scrollViewportTo({col:i},o);else if(i<0&&r>=0)e.scrollViewportTo({row:r},o);else{if("mouse"===n&&(i===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:i},o)}}}(e),null===(o=s)||void 0===o||o(i)}}}const Cp="gridDefault",yp="editorManager.handlingEditor";function Sp(e){const t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&Ke(t,[Ee("Focus catcher")]),t}function xp(e){const t=function(e){return t=>{if(!t)return null;const n=Rp(e),r=Ep(e);return t.col<n.col&&(t.col=n.col),t.col>r.col&&(t.col=r.col),t.row<n.row&&(t.row=n.row),t.row>r.row&&(t.row=r.row),t}}(e);let n;const{activate:r,deactivate:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.rootElement,r=Sp(e),i=Sp(e);return r.addEventListener("focus",()=>null===t||void 0===t?void 0:t.onFocusFromTop()),i.addEventListener("focus",()=>null===t||void 0===t?void 0:t.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){e._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){e._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}(e,{onFocusFromTop(){var r;const i=null!==(r=t(n))&&void 0!==r?r:Rp(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_above",i),e.selectCell(i.row,i.col)),e.listen()},onFocusFromBottom(){var r;const i=null!==(r=t(n))&&void 0!==r?r:Ep(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_below",i),e.selectCell(i.row,i.col)),e.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;e.addHook("afterListen",()=>i()),e.addHook("afterUnlisten",()=>r()),e.addHook("afterSelection",(t,r,i,c,u)=>{var d;(a&&(o.wrapped&&o.flipped||l)&&(l=!1,u.value=!0),s)&&(n=null===(d=e.getSelectedRangeLast())||void 0===d?void 0:d.highlight)}),e.addHook("beforeRowWrap",(e,t,n)=>{o.wrapped=!0,o.flipped=n});const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Cp,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:t}=e.getSettings();a=!0,e.getSelectedRangeLast()&&!t&&(s=!1),t||(l=!0)},position:"before"},{...c,callback:t=>{const{tabNavigation:r,autoWrapRow:i}=e.getSettings();if(a=!1,s=!0,!r||!e.selection.isSelected()||i&&o.wrapped&&o.flipped||!i&&o.wrapped)return i&&o.wrapped&&o.flipped&&(n=t.shiftKey?Rp(e):Ep(e)),o.wrapped=!1,o.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function Rp(e){const{rowIndexMapper:t,columnIndexMapper:n}=e,{navigableHeaders:r}=e.getSettings();let i=r&&e.countColHeaders()>0?-e.countColHeaders():0,o=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=n.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function Ep(e){var t,n;const{rowIndexMapper:r,columnIndexMapper:i}=e,{navigableHeaders:o}=e.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}if(a<0){if(!o||0===e.countColHeaders())return null;a=-1}return e._createCellCoords(null!==(t=r.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(n=i.getVisualFromRenderableIndex(a))&&void 0!==n?n:a)}const Tp=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),kp=e=>e.map(e=>{const t=e.toLowerCase();return Tp.has(t)?Tp.get(t):t}).sort().join("+"),Mp=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Pp=e=>{let{which:t,key:n}=e;if(Mp.has(t))return Mp.get(t);const r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:n.toLowerCase()},Ip=Symbol("shortcut-context");function Ap(e){return un(e)&&e.__kindOf===Ip}const Dp=["meta","alt","shift","control"],Fp=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),Op=[];let Np=0;const Lp=e=>{let{ownerWindow:t,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=e;const o=li({errorIdExists:e=>`The "${e}" context name is already registered.`});let s="grid";const a=()=>s,l=e=>o.getItem(e);let c=!1;const u=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a();const r=Ap(n)?n:l(n);let i=!1;if(!r.hasShortcut(t))return i;const o=r.getShortcuts(t);for(let s=0;s<o.length;s++){const{callback:n,runOnlyIf:r,preventDefault:a,stopPropagation:l,captureCtrl:d,forwardToContext:h}=o[s];if(!0===r(e)){if(c=d,i=!1===n(e,t),c=!1,a&&e.preventDefault(),l&&(Ln(e),e.stopPropagation()),i)break;h&&u(e,t,h)}}return i},d=function(e,t,n,r,i){const o=e=>Dp.includes(e),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},a=e=>{if(!1===t(e))return;if(!1===n(e)||229===e.keyCode||"string"!==typeof e.key||_n(e))return;const a=Pp(e);let l=[];o(a)||(l=s(e));const c=[a].concat(l);!i(e,c)&&(An()&&l.includes("meta")||!An()&&l.includes("control"))&&i(e,[a].concat(s(e,!0))),r(e)},l=e=>{if("string"===typeof e.key){const t=Pp(e);o(t)&&Fp.press(t)}},c=e=>{if("string"===typeof e.key){const t=Pp(e);o(t)&&Fp.release(t)}},u=()=>{Fp.releaseAll()};return{mount:()=>{let t=e;for(Np+=1;t;)1===Np&&(t.document.documentElement.addEventListener("keydown",l),Op.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",c),Op.push({event:"keyup",listener:c})),t.document.documentElement.addEventListener("keydown",a),t.document.documentElement.addEventListener("blur",u),t=_e(t)},unmount:()=>{let t=e;for(Np-=1;t;){if(0===Np){for(let e=0;e<Op.length;e++){const{event:n,listener:r}=Op[e];t.document.documentElement.removeEventListener(n,r)}Op.length=0}t.document.documentElement.removeEventListener("keydown",a),t.document.documentElement.removeEventListener("blur",u),t=_e(t)}},isPressed:e=>Fp.isPressed(e),releasePressedKeys:()=>Fp.releaseAll()}}(t,n,r,i,u);return d.mount(),{addContext:e=>{const t=(e=>{const t=li({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),n=function(){let{keys:e,callback:n,group:r,runOnlyIf:i=()=>!0,captureCtrl:o=!1,preventDefault:s=!0,stopPropagation:a=!1,relativeToGroup:l,position:c,forwardToContext:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Bt(r))throw new Error("You need to define the shortcut's group.");if(!1===Jt(n))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(_t`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const d={callback:n,group:r,runOnlyIf:i,captureCtrl:o,preventDefault:s,stopPropagation:a};Vt(l)&&(d.relativeToGroup=l,d.position=c),Ap(u)&&(d.forwardToContext=u),e.forEach(e=>{const n=kp(e);if(t.hasItem(n)){const e=t.getItem(n);let r=e.findIndex(e=>e.group===l);-1!==r?"before"===c?r-=1:r+=1:r=e.length,e.splice(r,0,d)}else t.addItem(n,[d])})},r=e=>{const n=kp(e);t.removeItem(n)};return{__kindOf:Ip,addShortcut:n,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach(e=>{hn(t,(n,r)=>{!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}),n(e)})},getShortcuts:e=>{const n=kp(e),r=t.getItem(n);return Vt(r)?r.slice():[]},hasShortcut:e=>{const n=kp(e);return t.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:e=>{t.getItems().forEach(t=>{let[n,i]=t;const o=i.filter(t=>t.group!==e);0===o.length?r((e=>e.split("+"))(n)):(i.length=0,i.push(...o))})}}})(e);return o.addItem(e,t),t},getActiveContextName:a,getContext:l,setActiveContextName:e=>{if(!o.hasItem(e))throw new Error(_t`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=e},isCtrlPressed:()=>!c&&(d.isPressed("control")||d.isPressed("meta")),releasePressedKeys:()=>d.releasePressedKeys(),destroy:()=>d.unmount()}},_p={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},Hp={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){Ot(this._hooksStorage[e]||[],t=>{this.hot.removeHook(e,t)})},clearHooks(){hn(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};dn(Hp,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const Vp=Hp;function Bp(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Wp=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class zp{static get EDITOR_TYPE(){return"base"}constructor(e){Bp(this,"hot",void 0),Bp(this,"state",Wp.VIRGIN),Bp(this,"_opened",!1),Bp(this,"_fullEditMode",!1),Bp(this,"_closeCallback",null),Bp(this,"TD",null),Bp(this,"row",null),Bp(this,"col",null),Bp(this,"prop",null),Bp(this,"originalValue",null),Bp(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:Wp.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,r,i,o;if(t){const e=this.hot.getSelectedLast();n=Math.max(Math.min(e[0],e[2]),0),r=Math.max(Math.min(e[1],e[3]),0),i=Math.max(e[0],e[2]),o=Math.max(e[1],e[3])}else[n,r,i,o]=[this.row,this.col,null,null];const s=this.hot.runHooks("modifyGetCellCoords",n,r,!1,"meta");Array.isArray(s)&&([n,r]=s),this.hot.populateFromArray(n,r,e,i,o,"edit")}beginEditing(e,t){if(this.state!==Wp.VIRGIN)return;const n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Wp.EDITING,this.isInFullEditMode()){const t="string"===typeof e?e:Ht(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o);n.view.scrollViewport(n._createCellCoords(r,i))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,t,n){let r;if(n){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),n(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==Wp.VIRGIN){if(this.state===Wp.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const n=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof n?String.prototype.trim.call(n||""):n]]:[[n]],this.state=Wp.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",e=>{this.state=Wp.FINISHED,this.discardEditor(e)}):(this.state=Wp.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout(()=>{this._fireCallbacks(!0)})}cancelChanges(){this.state=Wp.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===Wp.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Wp.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Wp.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Wp.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:r}=this.hot.view._wt,i=this.hot.rootWindow,o=tt(t),s=ct(t),a=tt(this.hot.rootElement),l=ct(this.hot.rootElement),c=n.topOverlay.holder,u=n.inlineStartOverlay.holder,d=c!==i?c.scrollTop:0,h=u!==i?u.scrollLeft:0,p=i.innerWidth-a.left-l,{wtTable:g}=null!==(e=n.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,f=g.name,m=["master","inline_start"].includes(f)?d:0,v=["master","top","bottom"].includes(f)?h:0,w=o.top===a.top?0:1;let b=o.top-a.top-w-m,C=0;C=this.hot.isRtl()?i.innerWidth-o.left-s-p-1+v:o.left-a.left-1-v,["top","top_inline_start_corner"].includes(f)&&(b+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(f)&&(C+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const y=this.hot.hasColHeaders(),S=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),x=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),R=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(y&&S<=0||S===R)&&(b+=1),x<=0&&(C+=1);const E=r.rowsRenderCalculator.startPosition,T=r.columnsRenderCalculator.startPosition,k=Math.abs(n.inlineStartOverlay.getScrollPosition()),M=n.topOverlay.getScrollPosition(),P=vt(this.hot.rootDocument);let I=t.offsetTop;if(["inline_start","master"].includes(f)&&(I+=E-M),["bottom","bottom_inline_start_corner"].includes(f)){const{wtViewport:e,wtTable:t}=n.bottomOverlay.clone;I+=e.getWorkspaceHeight()-t.getHeight()-P}let A=t.offsetLeft;this.hot.isRtl()?(A=A>=0?g.getWidth()-t.offsetLeft:Math.abs(A),A+=T-k-s):["top","master","bottom"].includes(f)&&(A+=T-k);const D=i.getComputedStyle(this.TD),F=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",O=parseInt(D[F],10)>0?0:1,N=parseInt(D.borderTopWidth,10)>0?0:1,L=ct(t)+O,_=ut(t)+N,H=wt(c)?P:0,V=bt(u)?P:0,B=this.hot.view.maximumVisibleElementWidth(A)-H+O;return{top:b,start:C,height:_,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(I)-V+N,this.hot.view.getDefaultRowHeight()),width:L,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}ln(zp,Vp);const jp={name:"editorCloseAndSaveByArrowKeys",callback(e,t,n){const r=e._getEditorManager(),i=r.getActiveEditor();i.isInFullEditMode()&&i.state===Wp.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(n.includes("arrowdown")?e.selection.transformStart(1,0):n.includes("arrowup")?e.selection.transformStart(-1,0):n.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):n.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},Gp={name:"editorCloseAndSaveByEnter",callback(e,t){const n=e._getEditorManager();n.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),n.moveSelectionAfterEnter(t)}},$p={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},Up={name:"editorFastOpen",callback(e,t){const{highlight:n}=e.getSelectedRangeLast();n.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},Kp={name:"editorOpen",callback(e,t,n){const r=e._getEditorManager(),i=e.getSelectedRangeLast(),{highlight:o}=i;if(e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const r=e.getSettings(),i="function"===typeof r.enterMoves?r.enterMoves(t):r.enterMoves;return void(n.includes("shift")?e.selection.transformFocus(-i.row,-i.col):e.selection.transformFocus(i.row,i.col))}o.isHeader()||(e.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(t):r.openEditor(null,t,!0):r.moveSelectionAfterEnter(t),Ln(t))}};const Yp={name:"extendCellsSelectionDown",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeLast();t.isSelectedByColumnHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByRowHeader())||(t.markSource("keyboard"),t.transformEnd(1,0),t.markEndSource())}},qp={name:"extendCellsSelectionDownByViewportHeight",callback(e){const{selection:t,rowIndexMapper:n}=e,{to:r}=e.getSelectedRangeLast(),i=Math.min(r.row+e.countVisibleRows(),e.countRows()-1),o=n.getNearestNotHiddenIndex(i,-1);if(null!==o){const n=e._createCellCoords(o,r.col),i=r.row-e.getFirstFullyVisibleRow(),s=Math.min(n.row-i,e.countRows()-1);t.markSource("keyboard"),t.setRangeEnd(n),t.markEndSource(),e.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Xp={name:"extendCellsSelectionLeft",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeLast();t.isSelectedByRowHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByColumnHeader())||(t.markSource("keyboard"),t.transformEnd(0,-1*e.getDirectionFactor()),t.markEndSource())}},Qp={name:"extendCellsSelectionRight",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeLast();t.isSelectedByRowHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByColumnHeader())||(t.markSource("keyboard"),t.transformEnd(0,e.getDirectionFactor()),t.markEndSource())}},Jp={name:"extendCellsSelectionToColumns",callback(e){const{selection:t}=e,{highlight:n,from:r,to:i}=e.getSelectedRangeLast();t.markSource("keyboard"),t.isSelectedByRowHeader()?t.selectAll(!0,!0):e.selectColumns(r.col,i.col,n),t.markEndSource()}},Zp={name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(e.countRows()-1,-1),l=i.clone();l.row=r.row,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col)),t.markEndSource()}}},eg={name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){const s=n.getNearestNotHiddenIndex(e.countCols()-1,-1),a=i.clone();a.col=r.col,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,s)),t.markEndSource()}}},tg={name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){const s=parseInt(e.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,a)),t.markEndSource()}}},ng={name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a)),t.markEndSource()}}},rg={name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=i.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,a)),t.markEndSource()}}},ig={name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:n}=e,{highlight:r,from:i,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=r.row,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(a,o.col)),t.markEndSource()}}},og={name:"extendCellsSelectionToRows",callback(e){const{selection:t}=e,{highlight:n,from:r,to:i}=e.getSelectedRangeLast();t.markSource("keyboard"),t.isSelectedByColumnHeader()?t.selectAll(!0,!0):e.selectRows(r.row,i.row,n),t.markEndSource()}},sg={name:"extendCellsSelectionUp",callback(e){const{selection:t}=e,{highlight:n}=e.getSelectedRangeLast();t.isSelectedByColumnHeader()||t.isSelectedByCorner()||!(n.isCell()||n.isHeader()&&t.isSelectedByRowHeader())||(t.markSource("keyboard"),t.transformEnd(-1,0),t.markEndSource())}},ag={name:"extendCellsSelectionUpByViewportHeight",callback(e){const{selection:t,rowIndexMapper:n}=e,{to:r}=e.getSelectedRangeLast(),i=Math.max(r.row-e.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(i,1);if(null!==o){const n=e._createCellCoords(o,r.col),i=r.row-e.getFirstFullyVisibleRow(),s=Math.max(n.row-i,0);t.markSource("keyboard"),t.setRangeEnd(n),t.markEndSource(),e.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};const lg={name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(1,0),t.markEndSource()}},cg={name:"moveCellSelectionDownByViewportHeight",callback(e){const{selection:t}=e,{navigableHeaders:n}=e.getSettings(),r=n?e.countColHeaders():0,{row:i}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+r;o=0===o?1:o,i===e.countRows()-1?o=1:i+o>e.countRows()&&(o=e.countRows()-i-1),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},ug={name:"moveCellSelectionInlineEnd",callback(e,t){const{selection:n}=e,r=e.getSettings(),i=e.getSelectedRangeLast(),o="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},dg={name:"moveCellSelectionInlineStart",callback(e,t){const{selection:n}=e,r=e.getSettings(),i=e.getSelectedRangeLast(),o="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;n.markSource("keyboard"),n.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},hg={name:"moveCellSelectionLeft",callback(e){const{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,-1*e.getDirectionFactor()),t.markEndSource()}},pg={name:"moveCellSelectionRight",callback(e){const{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,e.getDirectionFactor()),t.markEndSource()}},gg={name:"moveCellSelectionToMostBottom",callback(e){const{selection:t}=e,{col:n}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),t.setRangeStart(e._createCellCoords(r,n))}},fg={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(e.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(o,s)),t.markEndSource()}},mg={name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:n}=e;t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(e.countCols()-1,-1))),t.markEndSource()}},vg={name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:n}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(i,o)),t.markEndSource()}},wg={name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:n}=e,r=e.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,i)),t.markEndSource()}},bg={name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:n}=e,{row:r}=e.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,i)),t.markEndSource()}},Cg={name:"moveCellSelectionToMostTop",callback(e){const{selection:t}=e,{col:n}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,n)),t.markEndSource()}},yg={name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:n,columnIndexMapper:r}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(s,a)),t.markEndSource()}},Sg={name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(-1,0),t.markEndSource()}},xg={name:"moveCellSelectionUpByViewportHight",callback(e){const{selection:t}=e,{navigableHeaders:n}=e.getSettings(),r=n?e.countColHeaders():0,{row:i}=e.getSelectedRangeLast().highlight;let o=e.countVisibleRows()+r;o=0===o?-1:-o,i===-r?o=-1:i+o<r&&(o=-(i+r)),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}};const Rg={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},Eg={name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),n=e.getFirstFullyVisibleRow()-1,r=e.getFirstFullyVisibleColumn()-1,i=e.getLastFullyVisibleRow()+1,o=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(n,r),a=e._createCellCoords(i,o);if(!e._createCellRange(s,s,a).includes(t)&&(t.row>=0||t.col>=0)){const n={};if(t.col>=0){const r=Math.floor(e.countVisibleCols()/2);n.col=Math.max(t.col-r,0)}if(t.row>=0){const r=Math.floor(e.countVisibleRows()/2);n.row=Math.max(t.row-r,0)}e.scrollViewportTo({...n,verticalSnap:"top",horizontalSnap:"start"})}}},Tg={name:"selectAllCells",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!0}),t.markEndSource()}},kg={name:"selectAllCellsAndHeaders",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!1}),t.markEndSource()}},Mg={name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:n,col:r}=t[t.length-1].highlight.normalize(),i=e.getDataAtCell(n,r),o=new Map;for(let s=0;s<t.length;s++)t[s].forAll((t,s)=>{if(t>=0&&s>=0&&(t!==n||s!==r)){const{readOnly:n}=e.getCellMeta(t,s);n||o.set(`${t}x${s}`,[t,s,i])}});e.setDataAtCell(Array.from(o.values()))}},Pg=[_p,jp,Gp,$p,Up,Kp,Yp,qp,Xp,Qp,Jp,Zp,eg,tg,ng,rg,ig,og,sg,ag,lg,cg,ug,dg,hg,pg,gg,fg,mg,vg,wg,bg,Cg,yg,Sg,xg,Rg,Eg,Tg,kg,Mg];function Ig(e){const t={};return Pg.forEach(n=>{let{name:r,callback:i}=n;t[r]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i(e,...n)}}),t}function Ag(e){const t=e.getShortcutManager().addContext("editor"),n=Ig(e),r={group:yp};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>n.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>n.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>n.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function Dg(e){const t=e.getShortcutManager().addContext("grid"),n=Ig(e),r={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return Vt(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:Cp};t.addShortcuts([{keys:[["F2"]],callback:e=>n.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>n.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:yp,runOnlyIf:()=>Vt(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var t,n;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(n=e.getSelectedRangeLast())||void 0===n?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>n.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function Fg(e){const{classNames:t}=function(e,t){const n={element:void 0,classNames:[]};let r=e;for(;null!==r&&r!==e.ownerDocument.documentElement&&!n.element;){if("string"===typeof t&&r.classList.contains(t))n.element=r,n.classNames.push(t);else if(t instanceof RegExp){const e=Array.from(r.classList).filter(e=>t.test(e));e.length&&(n.element=r,n.classNames.push(...e))}r=r.parentElement}return n}(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}let Og=null;const Ng=new Map;new Set;function Lg(e,t){var n,r=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this;const s=new Cr(o);let a,l,c,u,d,h,p=!0;var g;Tl(i)&&(g=this,Rl.set(g,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=null!==(n=null===t||void 0===t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=function(e){let t=_c(e);return Ed(t)||(t=wd,Hc(e)),t}(t.language);const v=Object.fromEntries(Object.entries(t).filter(e=>{let[t]=e;return!(ir.getSingleton().isRegistered(t)||ir.getSingleton().isDeprecated(t))})),w=new tp(o,v,[rp,lp]),b=w.getTableMeta(),C=w.getGlobalMeta(),y=li();this.container=this.rootDocument.createElement("div"),e.insertBefore(this.container,e.firstChild),kl(this)&&(Qt(t.licenseKey,e),$e(e,"ht-wrapper")),this.guid=`ht_${pe()}`,Ng.set(this.guid,this),this.columnIndexMapper=new Lc,this.rowIndexMapper=new Lc,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{o.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{o.runHooks("afterRowSequenceChange",e)}),s.addEventListener(this.rootDocument.documentElement,"compositionstart",e=>{o.runHooks("beforeCompositionStart",e)}),l=new Ql(o),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new Dh(b,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:e=>a.propToCol(e),isEditorOpened:()=>!!o.getActiveEditor()&&o.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(e,t)=>o._createCellCoords(e,t),createCellRange:(e,t,n)=>o._createCellRange(e,t,n),visualToRenderableCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?o.columnIndexMapper.getRenderableFromVisualIndex(n):n)},renderableToVisualCoords:e=>{const{row:t,col:n}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?o.columnIndexMapper.getVisualFromRenderableIndex(n):n)},findFirstNonHiddenRenderableRow:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.rowIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.rowIndexMapper.getRenderableFromVisualIndex(s):s},findFirstNonHiddenRenderableColumn:(e,t)=>{const n=t>e?1:-1,r=Math.min(e,t),i=Math.max(e,t),s=o.columnIndexMapper.getNearestNotHiddenIndex(e,n);return null===s||1===n&&s>i||-1===n&&s<r?null:s>=0?o.columnIndexMapper.getRenderableFromVisualIndex(s):s},isDisabledCellSelection:(e,t)=>e<0||t<0?o.getSettings().disableVisualSelection:o.getCellMeta(e,t).disableVisualSelection});this.selection=S;const x=e=>{let{hiddenIndexesChanged:t}=e;this.forceFullRender=!0,t&&this.selection.commit()};function R(e,t){const n="className"===e?o.rootElement:o.table;if(p)$e(n,t);else{let r=[],i=[];C[e]&&(r=Array.isArray(C[e])?C[e]:Lt(C[e])),t&&(i=Array.isArray(t)?t:Lt(t));const o=Nt(r,i),s=Nt(i,r);o.length&&Ue(n,o),s.length&&$e(n,s)}C[e]=t}function E(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function T(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function k(e,t,n){if(!e.length)return void n();const r=o.getActiveEditor(),i=new E;let s=!0;i.onQueueEmpty=()=>{r&&s&&r.cancelChanges(),n()};for(let l=e.length-1;l>=0;l--){const[n,r]=e[l],c=a.propToCol(r);let u;u=Number.isInteger(c)?o.getCellMeta(n,c):{...Object.getPrototypeOf(b),...b},o.getCellValidator(u)&&(i.addValidatorToQueue(),o.validateCell(e[l][3],u,function(t,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");!1===r&&!1===n.allowInvalid&&(s=!1,e.splice(t,1),n.valid=!0),i.removeValidatorFormQueue()}}(l,u),t))}i.checkIfQueueIsEmpty()}function M(e,t){for(let n=e.length-1;n>=0;n--){let t=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(b.allowInsertRow)for(;e[n][0]>o.countRows()-1;){const{delta:e}=a.createRow(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}if("array"===o.dataType&&(!b.columns||0===b.columns.length)&&b.allowInsertColumn)for(;a.propToCol(e[n][1])>o.countCols()-1;){const{delta:e}=a.createCol(void 0,void 0,{source:"auto"});if(0===e){t=!0;break}}t||a.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}if(e.length>0){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",e,t),u.closeEditor(),o.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",e,t||"edit");const n=o.getActiveEditor();n&&Vt(n.refreshValue)&&n.refreshValue()}else o.render()}function P(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function I(e,t){const n=o.runHooks("beforeChange",e,t||"edit"),r=e.filter(e=>null!==e);var i;if(!1===n||0===r.length)return null===(i=o.getActiveEditor())||void 0===i||i.cancelChanges(),[];for(let s=r.length-1;s>=0;s--){const[e,t,,n]=r[s],i=a.propToCol(t);let l;l=Number.isInteger(i)?o.getCellMeta(e,i):{...Object.getPrototypeOf(b),...b};const{type:c,checkedTemplate:u,uncheckedTemplate:d}=l;if("numeric"===c&&"string"===typeof n&&Jr(n)&&(r[s][3]=T(n)),"checkbox"===c){const e=Ht(n),t=e===Ht(u),i=e===Ht(d);(t||i)&&(r[s][3]=t?u:d)}}return r}this.columnIndexMapper.addLocalHook("cacheUpdated",x),this.rowIndexMapper.addLocalHook("cacheUpdated",x),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{const n=fn(!1),r=this.selection.getSelectedRange(),{from:i,to:s}=r.current(),a=r.size()-1;this.runHooks("afterSelection",i.row,i.col,s.row,s.col,n,a),this.runHooks("afterSelectionByProp",i.row,o.colToProp(i.col),s.row,o.colToProp(s.col),n,a),t&&(!n.isTouched()||n.isTouched()&&!n.value)&&h.scrollTo(e);const l=S.isSelectedByRowHeader(),c=S.isSelectedByColumnHeader();l&&c?$e(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(Ue(this.rootElement,"ht__selection--columns"),$e(this.rootElement,"ht__selection--rows")):c?(Ue(this.rootElement,"ht__selection--rows"),$e(this.rootElement,"ht__selection--columns")):Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{const t=fn(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&h.scrollTo(e),u.closeEditor(),o.view.render(),u.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{const t=e.length-1,{from:n,to:r}=e[t];this.runHooks("afterSelectionEnd",n.row,n.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",n.row,o.colToProp(n.col),r.row,o.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{u.closeEditor(),o.view.render(),Ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),c={alter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const s=e=>{if(0===e.length)return[];const t=[...e];t.sort((e,t)=>{let[n]=e,[r]=t;return n===r?0:n>r?1:-1});const n=At(t,(e,t)=>{let[n,r]=t;const i=e[e.length-1],[o,s]=i,a=o+s;if(n<=a){const e=Math.max(r-(a-n),0);i[1]+=e}else e.push([n,r]);return e},[t[0]]);return n};switch(e){case"insert_row_below":case"insert_row_above":const i=o.countSourceRows();if(b.maxRows===i)return;const l="insert_row_below"===e?"below":"above";t=null!==t&&void 0!==t?t:"below"===l?i:0;const{delta:c,startPhysicalIndex:d}=a.createRow(t,n,{source:r,mode:l});S.shiftRows(o.toVisualRow(d),c);break;case"insert_col_start":case"insert_col_end":const h="insert_col_end"===e?"end":"start";t=null!==t&&void 0!==t?t:"end"===h?o.countSourceCols():0;const{delta:p,startPhysicalIndex:g}=a.createCol(t,n,{source:r,mode:h});if(p){if(Array.isArray(b.colHeaders)){const e=[o.toVisualColumn(g),0];e.length+=p,Array.prototype.splice.apply(b.colHeaders,e)}S.shiftColumns(o.toVisualColumn(g),p)}break;case"remove_row":const f=e=>{let t=0;Ot(e,e=>{let[n,i]=e;const s=Wt(n)?o.countRows()-1:Math.max(n-t,0);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeRow(n,i,r))return;if(S.isSelected()){const{row:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}const l=o.countRows(),c=b.fixedRowsTop;c>=s+1&&(b.fixedRowsTop-=Math.min(i,c-s));const d=b.fixedRowsBottom;d&&s>=l-d&&(b.fixedRowsBottom-=Math.min(i,d)),0===l?S.deselect():"ContextMenu.removeRow"===r?S.refresh():S.shiftRows(n,-i),t+=i})};Array.isArray(t)?f(s(t)):f([[t,n]]);break;case"remove_col":const m=e=>{let t=0;Ot(e,e=>{let[n,i]=e;const s=Wt(n)?o.countCols()-1:Math.max(n-t,0);let l=o.toPhysicalColumn(s);Number.isInteger(n)&&(n=Math.max(n-t,0));if(!a.removeCol(n,i,r))return;if(S.isSelected()){const{col:e}=o.getSelectedRangeLast().highlight;e>=n&&e<=n+i-1&&u.closeEditor(!0)}0===o.countCols()?S.deselect():"ContextMenu.removeColumn"===r?S.refresh():S.shiftColumns(n,-i);const c=b.fixedColumnsStart;c>=s+1&&(b.fixedColumnsStart-=Math.min(i,c-s)),Array.isArray(b.colHeaders)&&("undefined"===typeof l&&(l=-1),b.colHeaders.splice(l,i)),t+=i})};Array.isArray(t)?m(s(t)):m([[t,n]]);break;default:throw new Error(`There is no such action "${e}"`)}i||c.adjustRowsAndCols(),o.view.render(),o.view.adjustElementsSize()},adjustRowsAndCols(){const e=b.minRows,t=b.minSpareRows,n=b.minCols,r=b.minSpareCols;if(e){const t=o.countRows();t<e&&a.createRow(t,e-t,{source:"auto"})}if(t){const e=o.countEmptyRows(!0);if(e<t){const n=t-e,r=Math.min(n,b.maxRows-o.countSourceRows());a.createRow(o.countRows(),r,{source:"auto"})}}{let e;(n||r)&&(e=o.countEmptyCols(!0));let t=o.countCols();if(n&&!b.columns&&t<n){const r=n-t;e+=r,a.createCol(t,r,{source:"auto"})}if(r&&!b.columns&&"array"===o.dataType&&e<r){t=o.countCols();const n=r-e,i=Math.min(n,b.maxCols-t);a.createCol(t,i,{source:"auto"})}}},populateFromArray(e,t,n,r,i){let s,a,l,c;const u=[],d={},h=[],p=e.row,g=e.col;if(a=t.length,0===a)return!1;let f=0,m=0;switch(un(n)&&(f=n.col-g+1,m=n.row-p+1),i){case"shift_down":const i=It(t),v=i.length,w=Math.max(v,f),C=o.getData().slice(p),y=It(C).slice(g,g+w);for(l=0;l<w;l+=1)if(l<v){for(s=0,a=i[l].length;s<m-a;s+=1)i[l].push(i[l][s%a]);l<y.length?h.push(i[l].concat(y[l])):h.push(i[l].concat(new Array(C.length).fill(null)))}else h.push(i[l%v].concat(y[l]));o.populateFromArray(p,g,It(h));break;case"shift_right":const S=t.length,x=Math.max(S,m),R=o.getData().slice(p).map(e=>e.slice(g));for(s=0;s<x;s+=1)if(s<S){for(l=0,c=t[s].length;l<f-c;l+=1)t[s].push(t[s][l%c]);if(s<R.length)for(let e=0;e<R[s].length;e+=1)t[s].push(R[s][e]);else t[s].push(...new Array(R[0].length).fill(null))}else t.push(t[s%a].slice(0,x).concat(R[s]));o.populateFromArray(p,g,t);break;default:d.row=e.row,d.col=e.col;let E,T=0,k=0,M=!0;const P=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=t[e%t.length];return null!==n?r[n%r.length]:r},I=t.length,A=n?n.row-e.row+1:0;for(a=n?A:Math.max(I,A),s=0;s<a&&!(n&&d.row>n.row&&A>I||!b.allowInsertRow&&d.row>o.countRows()-1||d.row>=b.maxRows);s++){const t=s-T,i=P(t).length,h=n?n.col-e.col+1:0;if(c=n?h:Math.max(i,h),d.col=e.col,E=o.getCellMeta(d.row,d.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!E.skipRowOnPaste){for(k=0,l=0;l<c&&!(n&&d.col>n.col&&h>i||!b.allowInsertColumn&&d.col>o.countCols()-1||d.col>=b.maxCols);l++){if(E=o.getCellMeta(d.row,d.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&E.skipColumnOnPaste){k+=1,d.col+=1,c+=1;continue}if(E.readOnly&&"UndoRedo.undo"!==r){d.col+=1;continue}let e=P(t,l-k),n=o.getDataAtCell(d.row,d.col);if(null!==e&&"object"===typeof e)if(Array.isArray(e)&&null===n&&(n=[]),null===n||"object"!==typeof n)M=!1;else{const t=nn(Array.isArray(n)?n:n[0]||n),r=nn(Array.isArray(e)?e:e[0]||e);cn(t,r)||Array.isArray(t)&&Array.isArray(r)?e=sn(e):M=!1}else null!==n&&"object"===typeof n&&(M=!1);M&&u.push([d.row,d.col,e]),M=!0,d.col+=1}d.row+=1}else T+=1,d.row+=1,a+=1}o.setDataAtCell(u,null,null,r||"populateFromArray")}}},this.init=function(){l.setData(b.data),o.runHooks("beforeInit"),(kn()||Pn())&&$e(o.rootElement,"mobile"),this.updateSettings(t,!0),this.view=new Ul(this);const e=b.themeName||Fg(o.rootElement);o.useTheme(e),o.view.addClassNameToLicenseElement(o.getCurrentThemeName()),u=Pr.getInstance(o,b,S),h=bp(o),d=new zr(o),kl(this)&&xp(o),o.runHooks("init"),this.render(),p&&null===o.rootElement.offsetParent&&function(e,t){const n=new IntersectionObserver((n,r)=>{n.forEach(n=>{n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))})},{root:e.ownerDocument.body});n.observe(e)}(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()}),"object"===typeof p&&(o.runHooks("afterChange",p[0],p[1]),p=!1),o.runHooks("afterInit")},this._createCellCoords=function(e,t){return o.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return o.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){let i=o.getCellValidator(t);function s(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void n(e);const r=t.visualCol,i=t.visualRow,s=o.getCell(i,r,!0);if(s&&"TH"!==s.nodeName){const e=o.rowIndexMapper.getRenderableFromVisualIndex(i),t=o.columnIndexMapper.getRenderableFromVisualIndex(r);o.view._wt.getSetting("cellRenderer",e,t,s)}n(e)}var a,l;l=i,"[object RegExp]"===Object.prototype.toString.call(l)&&(a=i,i=function(e,t){t(a.test(e))}),Jt(i)?(e=o.runHooks("beforeValidate",e,t.visualRow,t.prop,r),o._registerImmediate(()=>{i.call(t,e,n=>{o&&(n=o.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,s(n),o.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))})})):o._registerImmediate(()=>{t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,n,r){const i=P(e,t,n),s=[];let c,u,d,h=r;for(c=0,u=i.length;c<u;c++){if("object"!==typeof i[c])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[c][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");d=i[c][1]>=this.countCols()?i[c][1]:a.colToProp(i[c][1]),s.push([i[c][0],d,l.getAtCell(this.toPhysicalRow(i[c][0]),i[c][1]),i[c][2]])}h||"object"!==typeof e||(h=t);const p=I(s,h);o.runHooks("afterSetDataAtCell",p,h),k(p,h,()=>{M(p,h)})},this.setDataAtRowProp=function(e,t,n,r){const i=P(e,t,n),s=[];let a,c,u=r;for(a=0,c=i.length;a<c;a++)s.push([i[a][0],i[a][1],l.getAtCell(this.toPhysicalRow(i[a][0]),i[a][1]),i[a][2]]);u||"object"!==typeof e||(u=t);const d=I(s,r);o.runHooks("afterSetDataAtRowProp",d,u),k(d,u,()=>{M(d,u)})},this.listen=function(){o&&!o.isListening()&&(Ng.forEach(e=>{o!==e&&e.unlisten()}),Og=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Og=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return Og===o.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(e),o.view.render(),t&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(e,t,n,r,i,s,a){if("object"!==typeof n||"object"!==typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"===typeof r?o._createCellCoords(r,i):null;return c.populateFromArray(o._createCellCoords(e,t),n,l,s,a)},this.spliceCol=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceCol(e,t,n,...i)},this.spliceRow=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return a.spliceRow(e,t,n,...i)},this.getSelected=function(){if(S.isSelected())return Ft(S.getSelectedRange(),e=>{let{from:t,to:n}=e;return[t.row,t.col,n.row,n.col]})},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];Ot(S.getSelectedRange(),e=>{if(e.isSingleHeader())return;const n=e.getTopStartCorner(),r=e.getBottomEndCorner();Zr(n.row,r.row,e=>{Zr(n.col,r.col,n=>{this.getCellMeta(e,n).readOnly||t.push([e,n,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!o.view)return;const e=o.view,{width:t,height:n}=e.getLastSize(),{width:r,height:i}=o.rootElement.getBoundingClientRect(),s=r!==t||i!==n;!1===o.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:r,height:i},s)||((s||e._wt.wtOverlays.scrollableElement===o.rootWindow)&&(e.setLastSize(r,i),o.render(),e.adjustElementsSize()),o.runHooks("afterRefreshDimensions",{width:t,height:n},{width:r,height:i},s))},this.updateData=function(e,t){mp(e,e=>{a=e},e=>{a=e,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),S.refresh()},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"updateData",source:t,metaManager:w,firstRun:p})},this.loadData=function(e,t){mp(e,e=>{a=e},()=>{w.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),S.refresh(),p&&(p=[null,"loadData"])},{hotInstance:o,dataMap:a,dataSource:l,internalSource:"loadData",source:t,metaManager:w,firstRun:p})},this.getInitialColumnCount=function(){const e=b.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Jt(e))if("array"===o.dataType){const n=this.countSourceCols();for(let r=0;r<n;r+=1)e(r)&&(t+=1)}else"object"!==o.dataType&&"function"!==o.dataType||(t=a.colToPropCache.length);else if(Vt(b.dataSchema)){const e=a.getSchema();t=Array.isArray(e)?e.length:gn(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,r){return Bt(e)?a.getAll():a.getRange(o._createCellCoords(e,t),o._createCellCoords(n,r),a.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return a.getCopyableText(o._createCellCoords(e,t),o._createCellCoords(n,r))},this.getCopyableData=function(e,t){return a.getCopyable(e,a.colToProp(t))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(p?o.loadData:o.updateData).bind(this);let r,i,s=!1;if(Vt(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Vt(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Vt(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(r in e.language&&function(e){const t=_c(e);Ed(t)?(o.runHooks("beforeLanguageChange",t),C.language=t,o.runHooks("afterLanguageChange",t)):Hc(e)}(e.language),e)if("data"===r||"language"===r);else if("className"===r)R("className",e.className);else if("tableClassName"===r&&o.table)R("tableClassName",e.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ir.getSingleton().isRegistered(r)||ir.getSingleton().isDeprecated(r)){const t=e[r];Jt(t)?(ir.getSingleton().addAsFixed(r,t,o),b[r]=t):Array.isArray(t)&&(ir.getSingleton().add(r,t,o),b[r]=t)}else!t&&mn(e,r)&&(C[r]=e[r]);void 0===e.data&&void 0===b.data?n(null,"updateSettings"):void 0!==e.data?n(e.data,"updateSettings"):void 0!==e.columns&&(a.createMap(),o.initIndexMappers());const l=o.countCols(),u=b.columns;if(u&&Jt(u)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||w.clearCache(),l>0)for(r=0,i=0;r<l;r++){if(u){const e=s?u(r):u[i];e&&w.updateColumnMeta(i,e)}i+=1}Vt(e.cell)&&hn(e.cell,e=>{o.setCellMetaObject(e.row,e.col,e)}),o.runHooks("afterCellMetaReset");let d=o.rootElement.style.height;""!==d&&(d=parseInt(o.rootElement.style.height,10));let h=e.height;if(Jt(h)&&(h=h()),t){o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(null===h){const e=o.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",e):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else void 0!==h&&(o.rootElement.style.height=isNaN(h)?`${h}`:`${h}px`,o.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){let t=e.width;Jt(t)&&(t=t()),o.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!t){if(o.view){o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames();const t=o.getCurrentThemeName(),n=mn(e,"themeName");t&&n&&t!==e.themeName&&(o.view.getStylesHandler().removeClassNames(),o.view.removeClassNameFromLicenseElement(t));const r=n&&e.themeName||Fg(o.rootElement);o.useTheme(r),o.view.addClassNameToLicenseElement(o.getCurrentThemeName())}o.runHooks("afterUpdateSettings",e)}c.adjustRowsAndCols(),o.view&&!p&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),t||!o.view||""!==d&&""!==h&&void 0!==h||d===h||o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=o.getSelectedLast();if(b.getValue){if(Jt(b.getValue))return b.getValue.call(o);if(e)return o.getData()[e[0][0]][b.getValue]}else if(e)return o.getDataAtCell(e[0],e[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){c.alter(e,t,n,r,i)},this.getCell=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r||void 0===i||void 0===r?null:o.view.getCellAtCoords(o._createCellCoords(i,r),n)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:n,col:r}=t;let i=n,s=r;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(s=this.columnIndexMapper.getVisualFromRenderableIndex(r)),o._createCellCoords(i,s)},this.colToProp=function(e){return a.colToProp(e)},this.propToCol=function(e){return a.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))},this.getDataAtRowProp=function(e,t){return a.get(e,t)},this.getDataAtCol=function(e){const t=[],n=a.getRange(o._createCellCoords(0,e),o._createCellCoords(b.data.length-1,e),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getDataAtProp=function(e){const t=[],n=a.getRange(o._createCellCoords(0,a.propToCol(e)),o._createCellCoords(b.data.length-1,a.propToCol(e)),a.DESTINATION_RENDERER);for(let r=0;r<n.length;r+=1)for(let e=0;e<n[r].length;e+=1)t.push(n[r][e]);return t},this.getSourceData=function(e,t,n,r){let i;return i=void 0===e?l.getData():l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r)),i},this.getSourceDataArray=function(e,t,n,r){let i;return i=void 0===e?l.getData(!0):l.getByRange(o._createCellCoords(e,t),o._createCellCoords(n,r),!0),i},this.getSourceDataAtCol=function(e){return l.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){const i=P(e,t,n),s=this.hasHook("afterSetSourceDataAtCell"),a=[];s&&Ot(i,e=>{let[t,n,r]=e;a.push([t,n,l.getAtCell(t,n),r])}),Ot(i,e=>{let[t,n,r]=e;l.setAtCell(t,n,r)}),s&&this.runHooks("afterSetSourceDataAtCell",a,r),this.render();const c=o.getActiveEditor();c&&Vt(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return l.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return l.getAtCell(e,t)},this.getDataAtRow=function(e){return a.getRange(o._createCellCoords(e,0),o._createCellCoords(e,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],[o,s]=i;let[,,a,l]=i,c=null,u=null;void 0===a&&(a=o),void 0===l&&(l=s);let d="mixed";return Zr(Math.max(Math.min(o,a),0),Math.max(o,a),e=>{let t=!0;return Zr(Math.max(Math.min(s,l),0),Math.max(s,l),n=>{const r=this.getCellMeta(e,n);return u=r.type,c?t=c===u:c=u,t}),d=t?u:"mixed",t}),d},this.removeCellMeta=function(e,t,n){const[r,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let s=w.getCellMetaKeyValue(r,i,n);!1!==o.runHooks("beforeRemoveCellMeta",e,t,n,s)&&(w.removeCellMeta(r,i,n),o.runHooks("afterRemoveCellMeta",e,t,n,s)),s=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(r.length>0&&!Array.isArray(r[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&w.removeRow(this.toPhysicalRow(e),t),r.length>0&&Ot(r.reverse(),t=>{w.createRow(this.toPhysicalRow(e)),Ot(t,(t,n)=>this.setCellMetaObject(e,n,t))}),o.render()},this.setCellMetaObject=function(e,t,n){"object"===typeof n&&hn(n,(n,r)=>{this.setCellMeta(e,t,r,n)})},this.setCellMeta=function(e,t,n,r){if(!1===o.runHooks("beforeSetCellMeta",e,t,n,r))return;let i=e,s=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(s=this.toPhysicalColumn(t)),w.setCellMeta(i,s,n,r),o.runHooks("afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipMetaExtension:!1},r=this.toPhysicalRow(e),i=this.toPhysicalColumn(t);return null===r&&(r=e),null===i&&(i=t),w.getCellMeta(r,i,{visualRow:e,visualColumn:t,...n})},this.getColumnMeta=function(e){return w.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return w.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===o.dataType||b.columns)},this.getCellRenderer=function(e,t){const n="number"===typeof e?o.getCellMeta(e,t).renderer:e.renderer;return"string"===typeof n?Si(n):Bt(n)?Si("text"):n},this.getCellEditor=function(e,t){const n="number"===typeof e?o.getCellMeta(e,t).editor:e.editor;return"string"===typeof n?mr(n):Bt(n)?mr("text"):n},this.getCellValidator=function(e,t){const n="number"===typeof e?o.getCellMeta(e,t).validator:e.validator;return"string"===typeof n?function(e){if("function"===typeof e)return e;if(!Ti(e))throw Error(`No registered validator found under "${e}" name`);return Ei(e)}(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){const r=new E;e&&(r.onQueueEmpty=e);let i=o.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=o.countCols()-1;for(;e>=0;)void 0===n||-1!==n.indexOf(e)?(r.addValidatorToQueue(),o.validateCell(o.getDataAtCell(i,e),o.getCellMeta(i,e),e=>{if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1):e-=1;i-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=b.rowHeaders,n=e;return void 0!==n&&(n=o.runHooks("modifyRowHeader",n)),void 0===n?(t=[],Zr(o.countRows()-1,e=>{t.push(o.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[n]?t=t[n]:Jt(t)?t=t(n):t&&"string"!==typeof t&&"number"!==typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(void 0!==b.colHeaders&&null!==b.colHeaders)return!!b.colHeaders;for(let e=0,t=o.countCols();e<t;e++)if(o.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=o.runHooks("modifyColHeader",e);if(void 0===n){const e=[],t=o.countCols();for(let n=0;n<t;n++)e.push(o.getColHeader(n));return e}let r=b.colHeaders;const i=o.toPhysicalColumn(n),s=function(e){const t=[],n=o.countCols();let r=0;for(;r<n;r++)Jt(b.columns)&&b.columns(r)&&t.push(r);return t[e]}(i);return!1===b.colHeaders?r=null:b.columns&&Jt(b.columns)&&b.columns(s)&&b.columns(s).title?r=b.columns(s).title:b.columns&&b.columns[i]&&b.columns[i].title?r=b.columns[i].title:Array.isArray(b.colHeaders)&&void 0!==b.colHeaders[i]?r=b.colHeaders[i]:Jt(b.colHeaders)?r=b.colHeaders(i):b.colHeaders&&"string"!==typeof b.colHeaders&&"number"!==typeof b.colHeaders&&(r=Kl(n)),r=o.runHooks("modifyColumnHeaderValue",r,e,t),r},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=o.getCellMeta(0,e).width}if(void 0!==t&&t!==b.width||(t=b.colWidths),void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let n=o._getColWidthFromSettings(e);return n=o.runHooks("modifyColWidth",n,e,t),void 0===n&&(n=xa),n},this._getRowHeightFromSettings=function(e){const t=this.view.getDefaultRowHeight();let n=b.rowHeights;if(void 0!==n&&null!==n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"===typeof n&&(n=parseInt(n,10))}return void 0!==n&&null!==n&&n<t?t:n},this.getRowHeight=function(e,t){let n=o._getRowHeightFromSettings(e);return n=o.runHooks("modifyRowHeight",n,e,t),n},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const e=b.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return ei(o.countRows()-1,n=>{if(o.isEmptyRow(n))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return ei(o.countCols()-1,n=>{if(o.isEmptyCol(n))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return b.isEmptyRow.call(o,e)},this.isEmptyCol=function(e){return b.isEmptyCol.call(o,e)},this.selectCell=function(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Bt(e)&&!Bt(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&h.suspend();const n=S.selectCells(e);return n&&t&&o.listen(),h.resume(),n},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectColumns(e,t,n)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;return S.selectRows(e,t,n)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2?arguments[2]:void 0;h.skipNextScrollCycle(),S.selectAll(e,t,n)};const A=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e,t){var n;"number"===typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(n=arguments[4])||void 0===n||n});const{row:r,col:i,considerHiddenIndexes:s}=null!==e&&void 0!==e?e:{};let a=r,l=i;if(Jt(t)&&this.addHookOnce("afterScroll",t),void 0===s||s){const e=Number.isInteger(r)&&r>=0,t=Number.isInteger(i)&&i>=0,n=e?A(this.rowIndexMapper,r):void 0,s=t?A(this.columnIndexMapper,i):void 0;if(null===n||null===s)return!1;a=e?o.rowIndexMapper.getRenderableFromVisualIndex(n):r,l=t?o.columnIndexMapper.getRenderableFromVisualIndex(s):i}const c=Number.isInteger(a),u=Number.isInteger(l);let d=!1;return c&&a>=0&&u&&l>=0?d=o.view.scrollViewport(o._createCellCoords(a,l),e.horizontalSnap,e.verticalSnap):c&&a>=0&&(u&&l<0||!u)?d=o.view.scrollViewportVertically(a,e.verticalSnap):u&&l>=0&&(c&&a<0||!c)&&(d=o.view.scrollViewportHorizontally(l,e.horizontalSnap)),Jt(t)&&(d?this.view.render():(this.removeHook("afterScroll",t),this._registerMicrotask(()=>t()))),d},this.scrollToFocusedCell=function(e){if(!this.selection.isSelected())return!1;Jt(e)&&this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast(),n=this.scrollViewportTo(t.toObject());return n?this.view.render():Jt(e)&&(this.removeHook("afterScroll",e),this._registerMicrotask(()=>e())),n},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),Ng.delete(this.guid),kl(o)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Xe(o.rootElement),s.destroy(),u&&u.destroy(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),y.getItems().forEach(e=>{let[,t]=e;t.destroy()}),y.clear(),o.runHooks("afterDestroy")},!0),ir.getSingleton().destroy(o),hn(o,(e,t,n)=>{var r;Jt(e)?n[t]=(r=t,()=>{throw new Error(`The "${r}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(n[t]=null)}),o.isDestroyed=!0,a&&a.destroy(),a=null,c=null,S=null,u=null,o=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return y.getItem(he(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:y.getId(e)},this.getInstance=function(){return o},this.addHook=function(e,t,n){ir.getSingleton().add(e,t,o,n)},this.hasHook=function(e){return ir.getSingleton().has(e,o)||ir.getSingleton().has(e)},this.addHookOnce=function(e,t,n){ir.getSingleton().once(e,t,o,n)},this.removeHook=function(e,t){ir.getSingleton().remove(e,t,o)},this.runHooks=function(e,t,n,r,i,s,a){return ir.getSingleton().run(o,e,t,n,r,i,s,a)},this.getTranslatedPhrase=function(e,t){return Td(b.language,e,t)},this.toHTML=()=>qr(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",qr(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!p)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=e;"function"===typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){Ot(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Ot(this.immediates,e=>{clearImmediate(e)})},this._registerMicrotask=function(e){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||e()})},this._getEditorManager=function(){return u};const D=Lp({handleEvent:()=>o.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var F;this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&D.releasePressedKeys()}),this.getShortcutManager=function(){return D},this.getFocusManager=function(){return d},gi().forEach(e=>{const t=fi(e);y.addItem(e,new t(this))}),F=o,[Dg,Ag].forEach(e=>e(F)),D.setActiveContextName("grid"),ir.getSingleton().run(o,"construct")}function _g(e,t,n){e.addEventListener(t,n,!1)}function Hg(e,t,n){e.removeEventListener(t,n,!1)}function Vg(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function Bg(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value,...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},n=e.body,r=e.createTextNode(""),i=e.createElement("span");let o;function s(){var e,s;r.textContent=t.textContent(o),i.style.position="absolute",i.style.fontSize=Vg(o).fontSize,i.style.fontFamily=Vg(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const a=parseInt((null===(e=Vg(o))||void 0===e?void 0:e.paddingInlineStart)||0,10),l=parseInt((null===(s=Vg(o))||void 0===s?void 0:s.paddingInlineEnd)||0,10),c=i.clientWidth+a+l+1;n.removeChild(i);const u=o.style;u.height=`${t.minHeight}px`,t.minWidth>c?u.width=`${t.minWidth}px`:c>t.maxWidth?u.width=`${t.maxWidth}px`:u.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>d?u.height=`${t.minHeight}px`:t.maxHeight<d?(u.height=`${t.maxHeight}px`,u.overflowY="visible"):u.height=`${d}px`}function a(){e.defaultView.setTimeout(s,0)}return{init:function(e,n){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=o.clientHeight;else{const n=parseInt(e.minHeight,10);isNaN(n)||(t.minHeight=n)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=o.clientHeight;else{const n=parseInt(e.maxHeight,10);isNaN(n)||(t.maxHeight=n)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=o.clientWidth;else{const n=parseInt(e.minWidth,10);isNaN(n)||(t.minWidth=n)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=o.clientWidth;else{const n=parseInt(e.maxWidth,10);isNaN(n)||(t.maxWidth=n)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}(n),"TEXTAREA"===o.nodeName&&(o.style.resize="none",o.style.height=`${t.minHeight}px`,o.style.minWidth=`${t.minWidth}px`,o.style.maxWidth=`${t.maxWidth}px`,o.style.overflowY="hidden"),l&&(_g(o,"input",s),_g(o,"keydown",a)),s()},resize:s,unObserve(){Hg(o,"input",s),Hg(o,"keydown",a)}}}function Wg(e,t){const n=pt(t),r=t.value.split("\n");let i=n,o=0;for(let s=0;s<r.length;s++){const t=r[s];0!==s&&(o+=r[s-1].length+1);const a=o+t.length;if("home"===e?i=o:"end"===e&&(i=a),n<=a)break}ft(t,i)}function zg(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const jg="ht_editor_hidden",Gg="textEditor";class $g extends zp{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),zg(this,"eventManager",new Cr(this)),zg(this,"autoResize",Bg(this.hot.rootDocument)),zg(this,"TEXTAREA",void 0),zg(this,"textareaStyle",void 0),zg(this,"TEXTAREA_PARENT",void 0),zg(this,"textareaParentStyle",void 0),zg(this,"layerClass",void 0),this.eventManager=new Cr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Le(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,n,r,i,o){const s=this.state;if(super.prepare(e,t,n,r,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===Wp.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===Wp.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),ft(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ke(this.TEXTAREA,[["data-hot-input",""],we(-1)]),$e(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),$e(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ge(this.TEXTAREA_PARENT,this.layerClass)&&Ue(this.TEXTAREA_PARENT,this.layerClass),$e(this.TEXTAREA_PARENT,jg),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Sn.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ue(this.TEXTAREA_PARENT,this.layerClass),$e(this.TEXTAREA_PARENT,jg)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;Zr(e.length-1,n=>{if(Ge(e[n],"handsontableEditor"))return t=!0,!1}),Ge(this.TEXTAREA_PARENT,jg)&&Ue(this.TEXTAREA_PARENT,jg),t?(this.layerClass="ht_editor_visible",$e(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),$e(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==Wp.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:n,width:r,maxWidth:i,height:o,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const a=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=a.fontSize,this.TEXTAREA.style.fontFamily=a.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,i),minHeight:Math.min(o,s),maxWidth:i,maxHeight:s},!0)}bindEvents(){Mn()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Wp.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Wp.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>Vt(this.hot.getSelected()),group:Gg},n=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(n(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(n(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(n(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[n]=t;Wg(n,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[n]=t;Wg(n,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Gg)}}function Ug(e,t,n,r,i,o,s){const a=s.ariaTags,l=[],c=[],u=[],d=[];s.className&&$e(t,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(["aria-readonly","true"])):a&&u.push("aria-readonly"),!1===s.valid&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(["aria-invalid","true"])):(c.push(s.invalidCellClassName),a&&u.push("aria-invalid")),!1===s.wordWrap&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Ue(t,c),$e(t,l),Ye(t,u),Ke(t,d)}Ug.RENDERER_TYPE="base";function Kg(e,t,n,r,i,o,s){Ug.apply(this,[e,t,n,r,i,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Ht(a),s.trimWhitespace&&(a=a.trim()),Ze(t,a)}Kg.RENDERER_TYPE="text";const Yg={CELL_TYPE:"text",editor:$g,renderer:Kg};function qg(e,t){const n=new Lg(e,t||{},El);return n.init(),n}Hh(Yg),qg.editors={BaseEditor:zp},qg.Core=function(e){return new Lg(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},El)},qg.DefaultSettings=jh(),qg.hooks=ir.getSingleton(),qg.CellCoords=os,qg.CellRange=hs,qg.packageName="handsontable",qg.buildDate="24/04/2025 10:59:00",qg.version="15.3.0",qg.languages={dictionaryKeys:vd,getLanguageDictionary:Rd,getLanguagesDictionaries:function(){return Sd()},registerLanguageDictionary:xd,getTranslatedPhrase:Td};const Xg=qg;function Qg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Jg(e,t,n){return t=rf(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,sf()?Reflect.construct(t,n||[],rf(e).constructor):t.apply(e,n))}function Zg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ef(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uf(r.key),r)}}function tf(e,t,n){return t&&ef(e.prototype,t),n&&ef(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function nf(e,t,n){return(t=uf(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rf(e){return rf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rf(e)}function of(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lf(e,t)}function sf(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(sf=function(){return!!e})()}function af(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lf(e,t){return lf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},lf(e,t)}function cf(e){return function(e){if(Array.isArray(e))return Qg(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Qg(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qg(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uf(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var df=null,hf="global";function pf(e,n){var r=t.Children.toArray(e),i=t.Children.count(e),o=null;return 0!==i&&(o=1===i&&r[0].props[n]?r[0]:r.find(function(e){return void 0!==e.props[n]})),o||null}function gf(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function ff(e,n){if("undefined"===typeof e||null===n)return null;var r=wf(n.props,!1);return r.className="".concat("hot-wrapper-editor-container"," ").concat(r.className),o.createPortal(t.createElement("div",Object.assign({},r),n),e.body)}function mf(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hf,i=pf(e,"hot-editor"),o=gf(i);return i?t.cloneElement(i,{emitEditorInstance:function(e,t){n.get(o)||n.set(o,new Map),n.get(o).set(null!==t&&void 0!==t?t:hf,e)},editorColumnScope:r,isEditor:!0}):null}function vf(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;r||(r=document),df||(df=r.createDocumentFragment());var a=null!==s&&void 0!==s?s:r.createElement("DIV");df.appendChild(a);var l=t.cloneElement(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?af(Object(n),!0).forEach(function(t){nf(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):af(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({key:"".concat(n.row,"-").concat(n.col)},n));return{portal:o.createPortal(l,a,i),portalContainer:a}}function wf(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var bf=function(){return tf(function e(){Zg(this,e)},null,[{key:"getSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.prevProps,r=void 0===n?{}:n,i=t.isInit,o=void 0!==i&&i,s=t.initOnlySettingKeys,a=void 0===s?[]:s,l=function(t){return!(o||!a.includes(t))&&r[t]===e[t]},c={};if(e.settings){var u=e.settings;for(var d in u)u.hasOwnProperty(d)&&!l(d)&&(c[d]=u[d])}for(var h in e)"settings"!==h&&"children"!==h&&!l(h)&&e.hasOwnProperty(h)&&(c[h]=e[h]);return c}}])}(),Cf=function(e){function n(){return Zg(this,n),Jg(this,n,arguments)}return of(n,e),tf(n,[{key:"getSettingsProps",value:function(){var e=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(t){return!e.internalProps.includes(t)}).reduce(function(t,n){return t[n]=e.props[n],t},{})}},{key:"getLocalEditorElement",value:function(){return mf(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var e=this.props._getChildElementByType(this.props.children,"hot-renderer"),t=this.getLocalEditorElement();this.columnSettings=bf.getSettings(this.getSettingsProps()),null!==e&&(this.columnSettings.renderer=this.props._getRendererWrapper(e),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==t&&(this.columnSettings.editor=this.props._getEditorClass(t,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var e=ff(this.props._getOwnerDocument(),this.getLocalEditorElement());return t.createElement(t.Fragment,null,e)}}])}(t.Component),yf=function(e){function n(){var e;return Zg(this,n),(e=Jg(this,n,arguments)).state={portals:[]},e}return of(n,e),tf(n,[{key:"render",value:function(){return t.createElement(t.Fragment,null,this.state.portals)}}])}(t.Component);function Sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xf={exports:{}};var Rf,Ef,Tf,kf;function Mf(){if(Ef)return Rf;Ef=1;return Rf="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}xf.exports=function(){if(kf)return Tf;kf=1;var e=Mf();function t(){}function n(){}return n.resetWarningCache=t,Tf=function(){function r(t,n,r,i,o,s){if(s!==e){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function i(){return r}r.isRequired=r;var o={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:t};return o.PropTypes=o,o},Tf}()();var Pf=Sf(xf.exports),If=function(e){function n(){var e;return Zg(this,n),(e=Jg(this,n,arguments)).id=null,e.__hotInstance=null,e.hotElementRef=null,e.columnSettings=[],e.renderersPortalManager=null,e.portalCache=new Map,e.portalContainerCache=new Map,e.renderedCellCache=new Map,e.editorCache=new Map,e.componentRendererColumns=new Map,e}return of(n,e),tf(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(e){this.__hotInstance=e}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!==typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(e){this.hotElementRef=e}},{key:"getRendererWrapper",value:function(e){var t=this;return function(n,r,i,o,s,a,l){var c=t.getRenderedCellCache(),u=t.getPortalContainerCache(),d="".concat(i,"-").concat(o),h=n.guid,p="".concat(h,"-").concat(d),g="".concat(d,"-").concat(h);if(c.has(d)&&(r.innerHTML=c.get(d).innerHTML),r&&!r.getAttribute("ghost-table")){for(var f=t.portalCache.get(g),m=u.get(p);r.firstChild;)r.removeChild(r.firstChild);if(f&&m)r.appendChild(m);else{var v=vf(e,{TD:r,row:i,col:o,prop:s,value:a,cellProperties:l,isRenderer:!0},r.ownerDocument,g,m),w=v.portal,b=v.portalContainer;u.set(p,b),r.appendChild(b),t.portalCache.set(g,w)}}return c.set(d,r),r}}},{key:"getEditorClass",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hf,r=gf(e),i=null===(t=this.getEditorCache().get(r))||void 0===t?void 0:t.get(n);return this.makeEditorClass(i)}},{key:"makeEditorClass",value:function(e){var t=function(t){function n(t){var r;return Zg(this,n),r=Jg(this,n,[t]),e.hotCustomEditorInstance=r,r.editorComponent=e,r}return of(n,t),tf(n,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Xg.editors.BaseEditor);return Object.getOwnPropertyNames(Xg.editors.BaseEditor.prototype).forEach(function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e[n]).call.apply(t,[e].concat(i))})}),t}},{key:"getGlobalRendererElement",value:function(){return pf(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return mf(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:(null===(e=this.hotInstance)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e._initOnlySettings)||[],s=bf.getSettings(this.props,{prevProps:i,isInit:r,initOnlySettingKeys:o}),a=this.getGlobalRendererElement(),l=this.getGlobalEditorElement();(s.columns=this.columnSettings.length?this.columnSettings:s.columns,l)?s.editor=this.getEditorClass(l,hf):this.props.editor||null!==(t=this.props.settings)&&void 0!==t&&t.editor?s.editor=this.props.editor||this.props.settings.editor:s.editor=mr("text");a?(s.renderer=this.getRendererWrapper(a),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(n=this.props.settings)&&void 0!==n&&n.renderer?s.renderer=this.props.renderer||this.props.settings.renderer:s.renderer=Si("text");return s}},{key:"displayAutoSizeWarning",value:function(e){var t,n;this.hotInstance&&(null!==(t=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||null!==(n=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==n&&n.enabled)&&this.componentRendererColumns.size>0&&function(){var e;"undefined"!==typeof console&&(e=console).warn.apply(e,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(e,t){this.columnSettings[t]=e}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:cf(this.portalCache.values())})}},{key:"updateHot",value:function(e){this.hotInstance&&this.hotInstance.updateSettings(e,!1)}},{key:"setRenderersPortalManagerRef",value:function(e){this.renderersPortalManager=e}},{key:"componentDidMount",value:function(){var e=this,t=this.createNewGlobalSettings(!0);this.hotInstance=new Xg.Core(this.hotElementRef,t),this.hotInstance.addHook("beforeViewRender",function(){return e.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return e.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(t)}},{key:"componentDidUpdate",value:function(e){this.clearCache();var t=this.createNewGlobalSettings(!1,e);this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var e=this,n=t.Children.toArray(this.props.children).filter(function(e){return function(e){return e.type===Cf}(e)}).map(function(n,r){return t.cloneElement(n,{_componentRendererColumns:e.componentRendererColumns,_emitColumnSettings:e.setHotColumnSettings.bind(e),_columnIndex:r,_getChildElementByType:pf.bind(e),_getRendererWrapper:e.getRendererWrapper.bind(e),_getEditorClass:e.getEditorClass.bind(e),_getOwnerDocument:e.getOwnerDocument.bind(e),_getEditorCache:e.getEditorCache.bind(e),children:n.props.children})}),r=wf(this.props),i=ff(this.getOwnerDocument(),this.getGlobalEditorElement());return t.createElement(t.Fragment,null,t.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},r),n),t.createElement(yf,{ref:this.setRenderersPortalManagerRef.bind(this)}),i)}}],[{key:"version",get:function(){return"15.3.0"}}])}(t.Component);If.propTypes={style:Pf.object,id:Pf.string,className:Pf.string};var Af=["children"],Df=t.forwardRef(function(e,n){var r,i=e.children,o=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,Af),s="function"===typeof t.useId?t.useId():void 0,a=null!==(r=o.id)&&void 0!==r?r:s;return t.createElement(If,Object.assign({id:a},o,{ref:n}),i)});Df.version=If.version;t.Component;const Ff="handsontableEditor";class Of extends $g{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),"none"===e.display&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ft(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(e,t){const n=this.getSourceData(t.row,t.col);void 0!==n&&s.setValue(n),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&rn(a,o.handsontable),this.htOptions=a}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&!1===n()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,n)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;null===(e=this.htEditor)||void 0===e||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{var n;t||(null===(n=this.htEditor)||void 0===n||n.useTheme(e))})}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:Ff,relativeToGroup:yp,position:"before"},n=(e,t)=>{const n=this.htEditor;if(void 0!==e&&(e<0||n.flipped&&e>n.countRows()-1?n.deselectCell():n.selectCell(e,0),n.getData().length))return t.preventDefault(),Ln(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor;let r,i;return!t.getSelectedLast()&&t.flipped?r=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(i=t.getSelectedLast()[0],r=Math.max(0,i-1)):(i=t.getSelectedLast()[0],r=i-1)),n(r,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor;let r,i;if(t.getSelectedLast()||t.flipped){if(t.getSelectedLast())if(t.flipped)r=t.getSelectedLast()[0]+1;else if(!t.flipped){const e=t.countRows()-1;i=t.getSelectedLast()[0],r=Math.min(e,i+1)}}else r=0;return n(r,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Ff)}}function Nf(e,t,n){Lf(e,t),t.set(e,n)}function Lf(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hf(e,t){return e.get(Vf(e,t))}function Vf(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Bf=new WeakMap,Wf=new WeakMap,zf=new WeakSet;class jf extends Of{constructor(){var e,t;super(...arguments),Lf(e=this,t=zf),t.add(e),_f(this,"query",null),_f(this,"strippedChoices",[]),_f(this,"rawChoices",[]),Nf(this,Bf,this.hot.guid.slice(0,9)),Nf(this,Wf,Zt(()=>{this.focus()},100)),_f(this,"sortByRelevance",function(e,t,n){const r=[],i=[],o=e.length;let s,a,l,c,u=t.length;if(0===o){for(l=0;l<u;l++)i.push(l);return i}for(l=0;l<u;l++){if(a=me(Ht(t[l])),n)c=a.indexOf(e);else{const t=this.cellProperties.locale;c=a.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==c&&(s=a.length-c-o,r.push({baseIndex:l,index:c,charsLeft:s,value:a}))}for(r.sort((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0}),l=0,u=r.length;l<u;l++)i.push(r[l].baseIndex);return i})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find(e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value);return Vt(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),$e(this.htContainer,"autocompleteEditor"),$e(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ke(this.TEXTAREA,[["type","text"],["role","combobox"],Te("listbox"),["aria-autocomplete","list"]])}prepare(e,t,n,r,i,o){var s;super.prepare(e,t,n,r,i,o),this.hot.getSettings().ariaTags&&Ke(this.TEXTAREA,[Ae("false"),(s=`${Hf(Bf,this)}-listbox-${e}-${t}`,["aria-controls",s])])}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null===n||void 0===n?void 0:n.length,{row:i,col:o}=this;var s;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",e=>this.onBeforeKeyDown(e)),this.htEditor.addHook("afterScroll",Hf(Wf,this)),this.htEditor.updateSettings({colWidths:e?[ct(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(e,i,o,s,a,l,c)=>{Kg(e,i,o,s,a,l,c);const{filteringCaseSensitive:u,allowHtml:d,locale:h}=this.cellProperties,p=this.query;let g,f,m=Ht(l);var v;m&&!d&&(g=!0===u?m.indexOf(p):m.toLocaleLowerCase(h).indexOf(p.toLocaleLowerCase(h)),-1!==g&&(f=m.substr(g,p.length),m=m.replace(f,`<strong>${f}</strong>`))),t&&Ke(i,[["role","option"],...n?[(v=r,["aria-setsize",v])]:[],...n?[Oe(n.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${s}`]]),i.innerHTML=m},afterSelectionEnd:(e,n)=>{if(t){const t=e=>{var t;Ke(e,[["aria-selected","true"]]),Ke(this.TEXTAREA,...(t=e.id,["aria-activedescendant",t]))},r=this.htEditor.getCell(e,n,!0);null!==r?t(r):this.htEditor.addHookOnce("afterScrollVertically",()=>{const r=this.htEditor.getCell(e,n,!0);t(r)})}}}),t&&(Ke(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,"role","presentation"),Ke(this.htEditor.rootElement,[["role","listbox"],(s="polite",["aria-live",s]),Fe("text"),["id",`${Hf(Bf,this)}-listbox-${i}-${o}`]]),Ke(this.TEXTAREA,...Ae("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ke(this.TEXTAREA,[Ae("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"===typeof t?t.call(this.cellProperties,e,e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=pt(this.TEXTAREA),n=(r=this.TEXTAREA).selectionEnd?r.selectionEnd:0;var r;const i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(s)?s.length:0;if(!1===o)c&&(a=s[0]);else{const e=[];for(let t=0,n=l.length;t<n&&!(i&&c<=t);t++)c?e.push(l[s[t]]):e.push(l[t]);a=0,l=e}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(It([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ft(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=this.getEditedCellRect(),t=e.height;let n=e.top;if(this.hot.view.isVerticallyScrollableByWindow()){const e=this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+e,0)}const r=this.getHeight(),i=this.hot.view.getWorkspaceHeight()-n-t,o=r>i&&n>i+t;return o?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(o?n:i,r),o}limitDropdownIfNeeded(e,t){if(t>e){let n=0,r=0,i=0,o=null;do{i=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),n+=i,r+=1}while(n<e);o=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-o+"px"),this.setDropdownHeight(n-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),Vf(zf,this,Gf).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Vf(zf,this,Gf).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length),r=Array.from({length:n},(e,t)=>t).reduce((e,t)=>e+(this.htEditor.getRowHeight(t)||this.htEditor.view.getDefaultRowHeight()),0);return r+t+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=Ft(e,e=>Ht(e));return Ft(n,e=>t?e:me(e))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1;let r=!1;return e===Dn.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===Dn.ARROW_UP&&n>-1&&(r=!0),r}onBeforeKeyDown(e){if(32===(t=e.keyCode)||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90||e.keyCode===Dn.BACKSPACE||e.keyCode===Dn.DELETE||e.keyCode===Dn.INSERT){let t=10;if(e.keyCode===Dn.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t)}var t}}function Gf(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+vt(this.hot.rootDocument)})}class $f extends zp{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){const e=this.TD.querySelector('input[type="checkbox"]');Ge(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const Uf=()=>window,Kf=()=>window.document,Yf=(e,t)=>window.setTimeout(e,t),qf=function(e,t,n,r){e.addEventListener(t,n,!!r)},Xf=function(e,t,n,r){e.removeEventListener(t,n,!!r)},Qf=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},Jf=function(e,t){Qf(e,t)||(e.className=""===e.className?t:e.className+" "+t)},Zf=function(e,t){var n;e.className=(n=(" "+e.className+" ").replace(" "+t+" "," ")).trim?n.trim():n.replace(/^\s+|\s+$/g,"")},em=function(e){return/Array/.test(Object.prototype.toString.call(e))},tm=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},nm=function(e){let t=e.getDay();return 0===t||6===t},rm=function(e){return e%4===0&&e%100!==0||e%400===0},im=function(e,t){return[31,rm(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},om=function(e){tm(e)&&e.setHours(0,0,0,0)},sm=function(e,t){return e.getTime()===t.getTime()},am=function(e,t,n){let r,i;for(r in t)i=void 0!==e[r],i&&"object"===typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?tm(t[r])?n&&(e[r]=new Date(t[r].getTime())):em(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=am({},t[r],n):!n&&i||(e[r]=t[r]);return e},lm=function(e,t,n){let r=Kf().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=am(r,n),e.dispatchEvent(r)},cm=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},um={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},dm=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},hm=function(e){let t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},pm=function(e,t,n,r,i){let o=new Date(r,n,t),s=e.hasMoment?e.moment(o).isoWeek():function(e,t){e.setHours(0,0,0,0);let n=e.getDate(),r=e.getDay(),i=t,o=i-1,s=function(e){return(e+7-1)%7};e.setDate(n+o-s(r));let a=new Date(e.getFullYear(),0,i),l=(e.getTime()-a.getTime())/864e5;return 1+Math.round((l-o+s(a.getDay()))/7)}(o,i);return'<td class="pika-week">'+s+"</td>"},gm=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},fm=function(e,t,n,r,i,o){let s,a,l,c,u,d=e._o,h=n===d.minYear,p=n===d.maxYear,g='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f=!0,m=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(h&&s<d.minMonth||p&&s>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[s]+"</option>");for(c='<div class="pika-label">'+d.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",em(d.yearRange)?(s=d.yearRange[0],a=d.yearRange[1]+1):(s=n-d.yearRange,a=1+n+d.yearRange),l=[];s<a&&s<=d.maxYear;s++)s>=d.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return u='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",d.showMonthAfterYear?g+=u+c:g+=c+u,h&&(0===r||d.minMonth>=r)&&(f=!1),p&&(11===r||d.maxMonth<=r)&&(m=!1),0===t&&(g+='<button class="pika-prev'+(f?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),g+"</div>"},mm=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+function(e){let t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+dm(e,t)+'">'+dm(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")};function vm(e){let t=this,n=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let r=(e=e||Uf().event).target||e.srcElement;if(r)if(Qf(r,"is-disabled")||(!Qf(r,"pika-button")||Qf(r,"is-empty")||Qf(r.parentNode,"is-disabled")?Qf(r,"pika-prev")?t.prevMonth():Qf(r,"pika-next")&&t.nextMonth():(t.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),n.bound&&Yf(function(){t.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100))),Qf(r,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let n=(e=e||Uf().event).target||e.srcElement;n&&(Qf(n,"pika-select-month")?t.gotoMonth(n.value):Qf(n,"pika-select-year")&&t.gotoYear(n.value))},t._onKeyChange=function(e){if(e=e||Uf().event,t.isVisible())switch(e.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let e=this.moment(n.field.value,n.format,n.formatStrict);return e&&e.isValid()?e.toDate():null}return new Date(Date.parse(n.field.value))},t._onInputChange=function(e){let n;e.firedBy!==t&&(n=t._parseFieldValue(),tm(n)&&t.setDate(n),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=Kf().activeElement;do{if(Qf(e,"pika-single"))return}while(e=e.parentNode);t._c||(t._b=Yf(function(){t.hide()},50)),t._c=!1},t._onClick=function(e){let r=(e=e||Uf().event).target||e.srcElement,i=r;if(r){!hasEventListeners&&Qf(r,"pika-select")&&(r.onchange||(r.setAttribute("onchange","return;"),qf(r,"change",t._onChange)));do{if(Qf(i,"pika-single")||i===n.trigger)return}while(i=i.parentNode);t._v&&r!==n.trigger&&i!==n.trigger&&t.hide()}},t.el=Kf().createElement("div"),t.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),qf(t.el,"mousedown",t._onMouseDown,!0),qf(t.el,"touchend",t._onMouseDown,!0),qf(t.el,"change",t._onChange),n.keyboardInput&&qf(Kf(),"keydown",t._onKeyChange),n.field&&(n.container?n.container.appendChild(t.el):n.bound?Kf().body.appendChild(t.el):n.field.parentNode.insertBefore(t.el,n.field.nextSibling),qf(n.field,"change",t._onInputChange),n.defaultDate||(n.defaultDate=t._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;tm(r)?n.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),n.bound?(this.hide(),t.el.className+=" is-bound",qf(n.trigger,"click",t._onInputClick),qf(n.trigger,"focus",t._onInputFocus),qf(n.trigger,"blur",t._onInputBlur)):this.show()}function wm(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function bm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cm(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}vm.prototype={config:function(e){this._o||(this._o=am({},um,!0));let t=am(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"===typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"===typeof t.disableDayFn?t.disableDayFn:null;let n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,tm(t.minDate)||(t.minDate=!1),tm(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),em(t.yearRange)){let e=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||um.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,tm(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return tm(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",lm(this._o.field,"change",{firedBy:this})),this.draw();if("string"===typeof e&&(e=new Date(Date.parse(e))),!tm(e))return;let n=this._o.minDate,r=this._o.maxDate;tm(n)&&e<n?e=n:tm(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),om(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),lm(this._o.field,"change",{firedBy:this})),t||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(tm(e)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=i<n.getTime()||r.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let n,r=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+i):"subtract"===e&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=cm(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=cm({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(om(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=um.minDate,this._o.minYear=um.minYear,this._o.minMonth=um.minMonth,this._o.startRange=um.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(om(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=um.maxDate,this._o.maxYear=um.maxYear,this._o.maxMonth=um.maxMonth,this._o.endRange=um.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t,n=this._o,r=n.minYear,i=n.maxYear,o=n.minMonth,s=n.maxMonth,a="";this._y<=r&&(this._y=r,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<n.numberOfMonths;l++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+fm(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=a,n.bound&&"hidden"!==n.field.type&&Yf(function(){n.trigger.focus()},1),"function"===typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)},adjustPosition:function(){let e,t,n,r,i,o,s,a,l,c,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,n=this.el.offsetHeight,r=Uf().innerWidth||Kf().documentElement.clientWidth,i=Uf().innerHeight||Kf().documentElement.clientHeight,o=Kf().body.scrollTop||Kf().documentElement.scrollTop,c=!0,u=!0,l=e.getBoundingClientRect(),s=l.left+Uf().pageXOffset,a=l.bottom+Uf().pageYOffset,(this._o.reposition&&s+t>r||this._o.position.indexOf("right")>-1&&s-t+e.offsetWidth>0)&&(s=s-t+e.offsetWidth,c=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-e.offsetHeight>0)&&(a=a-n-e.offsetHeight,u=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Jf(this.el,c?"left-aligned":"right-aligned"),Jf(this.el,u?"bottom-aligned":"top-aligned"),Zf(this.el,c?"right-aligned":"left-aligned"),Zf(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,n){let r=this._o,i=new Date,o=im(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];om(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let c=0===t?11:t-1,u=11===t?0:t+1,d=0===t?e-1:e,h=11===t?e+1:e,p=im(d,c),g=o+s,f=g;for(;f>7;)f-=7;g+=7-f;let m=!1;for(let v=0,w=0;v<g;v++){let n=new Date(e,t,v-s+1),g=!!tm(this._d)&&sm(n,this._d),f=sm(n,i),b=-1!==r.events.indexOf(n.toDateString()),C=v<s||v>=o+s,y=v-s+1,S=t,x=e,R=r.startRange&&sm(r.startRange,n),E=r.endRange&&sm(r.endRange,n),T=r.startRange&&r.endRange&&r.startRange<n&&n<r.endRange;C&&(v<s?(y=p+y,S=c,x=d):(y-=o,S=u,x=h));let k={day:y,month:S,year:x,hasEvent:b,isSelected:g,isToday:f,isDisabled:r.minDate&&n<r.minDate||r.maxDate&&n>r.maxDate||r.disableWeekends&&nm(n)||r.disableDayFn&&r.disableDayFn(n),isEmpty:C,isStartRange:R,isEndRange:E,isInRange:T,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&g&&(m=!0),l.push(hm(k)),7===++w&&(r.showWeekNumber&&l.unshift(pm(this,v-s,t,e,r.firstWeekOfYearMinDays)),a.push(gm(l,r.isRTL,r.pickWholeWeek,m)),l=[],w=0,m=!1)}return mm(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Zf(this.el,"is-hidden"),this._o.bound&&(qf(Kf(),"click",this._onClick),this.adjustPosition()),"function"===typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&Xf(Kf(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Jf(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"===typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),Xf(this.el,"mousedown",this._onMouseDown,!0),Xf(this.el,"touchend",this._onMouseDown,!0),Xf(this.el,"change",this._onChange),e.keyboardInput&&Xf(Kf(),"keydown",this._onKeyChange),e.field&&(Xf(e.field,"change",this._onInputChange),e.bound&&(Xf(e.trigger,"click",this._onInputClick),Xf(e.trigger,"focus",this._onInputFocus),Xf(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const ym="date",Sm="dateEditor";var xm=new WeakSet;class Rm extends $g{constructor(){super(...arguments),wm(this,xm),bm(this,"parentDestroyed",!1),bm(this,"$datePicker",null)}static get EDITOR_TYPE(){return ym}init(){if("function"!==typeof Mt)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||(Ue(this.datePicker,/ht-theme-.*/g),$e(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),$e(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Ue(this.datePicker,/ht-theme-.*/g),$e(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ge(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:Sm})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()});this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Sm),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){const t=Cm(xm,this,Em).call(this),n=this.hot.view.isMouseDown(),r=!!e&&On(e.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new vm(this.getDatePickerConfig()),"function"===typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(Mt),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,Mt(i,t,!0).isValid()&&this.$datePicker.setMoment(Mt(i,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),r||n||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,Mt(i,t,!0).isValid()&&this.$datePicker.setMoment(Mt(i,t),!0),r||n||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&on(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=null!==(e=n.format)&&void 0!==e?e:Cm(xm,this,Em).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=Mt(t).format(Cm(xm,this,Em).call(this))),this.setValue(t),r&&r(),kn()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==Wp.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:n,columnIndexMapper:r}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:o}=null!==(t=i.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,s=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),a=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),l=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=a&&this.col>=l&&this.col<=c){const e=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+ut(this.TD)}px`;let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-ct(this.datePicker):t+=e.left,this.datePickerStyle.left=`${t}px`}else this.hideDatepicker()}}function Em(){var e;return null!==(e=this.cellProperties.dateFormat)&&void 0!==e?e:"DD/MM/YYYY"}class Tm extends jf{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,n,r,i,o){o.filter=!1,o.strict=!0,super.prepare(e,t,n,r,i,o)}}class km extends $g{static get EDITOR_TYPE(){return"numeric"}}function Mm(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Pm extends $g{constructor(){super(...arguments),Mm(this,"autoResize",Bg(this.hot.rootDocument,{textContent:e=>"\u2022".repeat(e.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Xe(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Im="ht_editor_visible",Am="selectEditor";class Dm extends zp{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute("aria-hidden","true"),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),$e(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ge(this.selectWrapper,Im)&&Ue(this.selectWrapper,Im),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o);const s=this.cellProperties.selectOptions;let a;a="function"===typeof s?this.prepareOptions(s(this.row,this.col,this.prop)):this.prepareOptions(s),Xe(this.select),hn(a,(e,t)=>{const n=this.hot.rootDocument.createElement("OPTION");n.value=t,Je(n,e),this.select.appendChild(n)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"===typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Wp.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:n,height:r}=this.getEditedCellRect(),i=this.selectWrapper.style;i.height=`${r}px`,i.width=`${n}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",$e(this.selectWrapper,Im)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:Am};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Am)}}class Fm extends $g{static get EDITOR_TYPE(){return"time"}prepare(e,t,n,r,i,o){super.prepare(e,t,n,r,i,o),this.TEXTAREA.dir="ltr"}}function Om(e,t,n,r,i,o,s){Ug.apply(this,[e,t,n,r,i,o,s]),Je(t,null===o||void 0===o?"":o,!1)}Om.RENDERER_TYPE="html";function Nm(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=s.allowHtml?Om:Kg,c=a.createElement("DIV"),u=e.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute("aria-hidden","true"),c.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,n,r,i,o,s]),t.firstChild||t.appendChild(a.createTextNode(String.fromCharCode(160))),t.insertBefore(c,t.firstChild),$e(t,"htAutocomplete"),!e.acArrowListener){const i=new Cr(e);e.acArrowListener=function(i){Ge(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",()=>{i.destroy()})}}Nm.RENDERER_TYPE="autocomplete";function Lm(e,t,n,r,i,o,s){Nm.apply(this,[e,t,n,r,i,o,s])}Lm.RENDERER_TYPE="dropdown";const _m=new WeakMap,Hm=new WeakMap,Vm="data-row",Bm="data-col",Wm="checkboxRenderer",zm="checkbox";function jm(e,t,n,r,i,o,s){const{rootDocument:a}=e,l=e.getSettings().ariaTags;Ug.apply(this,[e,t,n,r,i,o,s]),function(e){let t=Hm.get(e);if(!t){const{rootElement:n}=e;t=new Cr(e),t.addEventListener(n,"click",t=>function(e,t){const{target:n}=e;if(!Gm(n))return;if(!n.hasAttribute(Vm)||!n.hasAttribute(Bm))return;const r=parseInt(n.getAttribute(Vm),10),i=parseInt(n.getAttribute(Bm),10),o=t.getCellMeta(r,i);o.readOnly&&e.preventDefault()}(t,e)),t.addEventListener(n,"mouseup",t=>function(e,t){const{target:n}=e;if(!Gm(n))return;if(!n.hasAttribute(Vm)||!n.hasAttribute(Bm))return;setTimeout(t.listen,10)}(t,e)),t.addEventListener(n,"change",t=>function(e,t){const{target:n}=e;if(!Gm(n))return;if(!n.hasAttribute(Vm)||!n.hasAttribute(Bm))return;const r=parseInt(n.getAttribute(Vm),10),i=parseInt(n.getAttribute(Bm),10),o=t.getCellMeta(r,i);if(!o.readOnly){let n=null;n=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,i,n)}}(t,e)),Hm.set(e,t)}}(e);let c=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(a);const u=s.label;let d=!1;if("undefined"===typeof s.checkedTemplate&&(s.checkedTemplate=!0),"undefined"===typeof s.uncheckedTemplate&&(s.uncheckedTemplate=!1),Xe(t),o===s.checkedTemplate||Ht(o).toLocaleLowerCase(s.locale)===Ht(s.checkedTemplate).toLocaleLowerCase(s.locale)?c.checked=!0:o===s.uncheckedTemplate||Ht(o).toLocaleLowerCase(s.locale)===Ht(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?c.checked=!1:Wt(o)?$e(c,"noValue"):(c.style.display="none",$e(c,"htBadValue"),d=!0),Ke(c,[[Vm,n],[Bm,r]]),l&&Ke(c,[Ee(c.checked?e.getTranslatedPhrase(gd):e.getTranslatedPhrase(fd)),De(c.checked),["role","checkbox"]]),!d&&u){let s="";if(u.value)s="function"===typeof u.value?u.value.call(this,n,r,i,o):u.value;else if(u.property){const t=e.getDataAtRowProp(n,u.property);s=null!==t?t:""}const l=function(e,t,n){const r=e.createElement("label");r.className="htCheckboxRendererLabel "+(n?"fullWidth":"");const i=e.createTextNode(t);if(n){const t=e.createElement("span");t.appendChild(i),r.appendChild(t)}else r.appendChild(i);return r.cloneNode(!0)}(a,s,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(l),t.appendChild(c)):(l.appendChild(c),c=l):u.position&&"after"!==u.position||(u.separated?(t.appendChild(c),t.appendChild(l)):(l.insertBefore(c,l.firstChild),c=l))}function h(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=e.getSelectedRange(),r=[],i=new Map;let o=[],s=0;if(n){for(let a=0;a<n.length;a++){const{row:l,col:c}=n[a].getTopStartCorner(),{row:u,col:d}=n[a].getBottomEndCorner();for(let n=l;n<=u;n+=1)for(let a=c;a<=d;a+=1){const l=e.getCellMeta(n,a);if(l.hidden)continue;const c={checkedTemplate:l.checkedTemplate,uncheckedTemplate:l.uncheckedTemplate};if("checkbox"!==l.type){!0!==t||l.readOnly||(i.has(r.length)?i.set(r.length,[...i.get(r.length),[n,a,null]]):i.set(r.length,[[n,a,null]]));continue}if(!0===l.readOnly)continue;"undefined"===typeof l.checkedTemplate&&(l.checkedTemplate=!0),"undefined"===typeof l.uncheckedTemplate&&(l.uncheckedTemplate=!1);const u=e.getDataAtCell(n,a);!1===t?[l.checkedTemplate,l.checkedTemplate.toString()].includes(u)?o.push([n,a,l.uncheckedTemplate,c]):[l.uncheckedTemplate,l.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([n,a,l.checkedTemplate,c]):o.push([n,a,l.uncheckedTemplate,c]),s+=1}r.push(s),s=0}o=o.every(e=>{let[,,t]=e;return t===o[0][2]})?o.map(e=>{let[t,n,r]=e;return[t,n,r]}):o.map(e=>{let[t,n,,r]=e;return[t,n,r.checkedTemplate]}),o.length>0&&r.forEach((t,n)=>{let r=o.splice(0,t);i.size&&i.has(n)&&(r=[...r,...i.get(n)]),e.setDataAtCell(r)})}}function p(){const t=e.getSelectedRange();if(t){for(let n=0;n<t.length;n++){const r=t[n].getTopStartCorner(),i=t[n].getBottomEndCorner();for(let t=r.row;t<=i.row;t++)for(let n=r.col;n<=i.col;n++){if(e.getCellMeta(t,n).readOnly)continue;const r=e.getCell(t,n);if(kt(r)){if(r.querySelectorAll("input[type=checkbox]").length>0)return!0}}}return!1}}(!u||u&&!u.separated)&&t.appendChild(c),d&&t.appendChild(a.createTextNode("#bad-value#")),_m.has(e)||(_m.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),n={group:Wm,relativeToGroup:yp,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(h(),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(h(),!p()),runOnlyIf:()=>{const t=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&(null===t||void 0===t?void 0:t.highlight.isCell())&&!e.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(h(!0),!p()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}}],n)}())}function Gm(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}ir.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,n){const{label:r,type:i,row:o,column:s,prop:a}=t;if(i===zm){if(r){const{value:t,property:i}=r;let l=n;if(t)l="function"===typeof t?t(o,s,a,n):t;else if(i){const e=this.getDataAtRowProp(o,i);l=null!==e?e:n}e=l}return e}}),jm.RENDERER_TYPE=zm;function $m(e,t,n,r,i,o,s){Nm.apply(this,[e,t,n,r,i,o,s])}$m.RENDERER_TYPE="handsontable";var Um,Km,Ym,qm,Xm,Qm,Jm="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};function Zm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ev(){return Km?Um:(Km=1,Um={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){let t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}})}function tv(){if(qm)return Ym;qm=1;const e=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function t(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(r,i,o,s,a,l,c){if(!isNaN(+r))return+r;let u="",d=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(d!==r)return-1*n(d,i,o,s,a,l);for(let t=0;t<e.length;t++){let c=e[t];if(u=r.replace(RegExp(`([0-9 ])(${c.key})$`),"$1"),u!==r)return n(u,i,o,s,a,l)*c.factor}if(u=r.replace("%",""),u!==r)return n(u,i,o,s,a,l)/100;let h=parseFloat(r);if(isNaN(h))return;let p=s(h);if(p&&"."!==p&&(u=r.replace(new RegExp(`${t(p)}$`),""),u!==r))return n(u,i,o,s,a,l);let g={};Object.keys(l).forEach(e=>{g[l[e]]=e});let f=Object.keys(g).sort().reverse(),m=f.length;for(let e=0;e<m;e++){let t=f[e],c=g[t];if(u=r.replace(t,""),u!==r){let e;switch(c){case"thousand":e=Math.pow(10,3);break;case"million":e=Math.pow(10,6);break;case"billion":e=Math.pow(10,9);break;case"trillion":e=Math.pow(10,12)}return n(u,i,o,s,a,l)*e}}}function r(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(""===e)return;if(e===s)return 0;let l=function(e,n,r){let i=e.replace(r,"");return i=i.replace(new RegExp(`([0-9])${t(n.thousands)}([0-9])`,"g"),"$1$2"),i=i.replace(n.decimal,"."),i}(e,r,i);return n(l,r,i,o,s,a)}return Ym={unformat:function(e,t){const n=sv();let i,o=n.currentDelimiters(),s=n.currentCurrency().symbol,a=n.currentOrdinal(),l=n.getZeroFormat(),c=n.currentAbbreviations();if("string"===typeof e)i=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;let n=e.split(":");if(3!==n.length)return!1;let r=+n[0],i=+n[1],o=+n[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(o)}(e,o)?function(e){let t=e.split(":"),n=+t[0],r=+t[1];return+t[2]+60*r+3600*n}(e):r(e,o,s,a,l,c);else{if("number"!==typeof e)return;i=e}if(void 0!==i)return i}},Ym}function nv(){if(Qm)return Xm;Qm=1;let e=tv();const t=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(e,t)=>"byte"===t.output,message:"`base` must be provided only when the output is `byte`",mandatory:e=>"byte"===e.output},characteristic:{type:"number",restriction:e=>e>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(e,t)=>!0===t.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:e=>e>=0,message:"value must be positive"},{restriction:(e,t)=>!t.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:e=>e>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(e,t)=>"percent"===t.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},r={languageTag:{type:"string",mandatory:!0,restriction:e=>e.match(t),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function i(t){return void 0!==e.unformat(t)}function o(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object.keys(e).map(i=>{if(!t[i])return console.error(`${r} Invalid key: ${i}`),!1;let s=e[i],a=t[i];if("string"===typeof a&&(a={type:a}),"format"===a.type){if(!o(s,n,`[Validate ${i}]`,!0))return!1}else if(typeof s!==a.type)return console.error(`${r} ${i} type mismatched: "${a.type}" expected, "${typeof s}" provided`),!1;if(a.restrictions&&a.restrictions.length){let t=a.restrictions.length;for(let n=0;n<t;n++){let{restriction:t,message:o}=a.restrictions[n];if(!t(s,e))return console.error(`${r} ${i} invalid value: ${o}`),!1}}if(a.restriction&&!a.restriction(s,e))return console.error(`${r} ${i} invalid value: ${a.message}`),!1;if(a.validValues&&-1===a.validValues.indexOf(s))return console.error(`${r} ${i} invalid value: must be among ${JSON.stringify(a.validValues)}, "${s}" provided`),!1;if(a.children){if(!o(s,a.children,`[Validate ${i}]`))return!1}return!0});return i||s.push(...Object.keys(t).map(n=>{let i=t[n];if("string"===typeof i&&(i={type:i}),i.mandatory){let t=i.mandatory;if("function"===typeof t&&(t=t(e)),t&&void 0===e[n])return console.error(`${r} Missing mandatory key "${n}"`),!1}return!0})),s.reduce((e,t)=>e&&t,!0)}function s(e){return o(e,n,"[Validate format]")}return Xm={validate:function(e,t){let n=i(e),r=s(t);return n&&r},validateFormat:s,validateInput:i,validateLanguage:function(e){return o(e,r,"[Validate language]")}},Xm}var rv,iv,ov={parseFormat:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!==typeof e?e:(function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}(e=function(e,t){let n=e.match(/{([^}]*)}$/);return n?(t.postfix=n[1],e.slice(0,-n[0].length)):e}(e=function(e,t){let n=e.match(/^{([^}]*)}/);return n?(t.prefix=n[1],e.slice(n[0].length)):e}(e,t),t),t),function(e,t){let n=e.match(/[1-9]+[0-9]*/);n&&(t.totalLength=+n[0])}(e,t),function(e,t){let n=e.split(".")[0].match(/0+/);n&&(t.characteristic=n[0].length)}(e,t),function(e,t){if(-1!==e.indexOf(".")){let n=e.split(".")[0];t.optionalCharacteristic=-1===n.indexOf("0")}}(e,t),function(e,t){-1!==e.indexOf("a")&&(t.average=!0)}(e,t),function(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}(e,t),function(e,t){let n=e.split(".")[1];if(n){let e=n.match(/0+/);e&&(t.mantissa=e[0].length)}}(e,t),function(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}(e,t),function(e,t){const n=e.split(".")[1];n&&(t.trimMantissa=-1!==n.indexOf("["))}(e,t),function(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}(e,t),function(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0,t.spaceSeparatedCurrency=!0,(t.average||t.forceAverage)&&(t.spaceSeparatedAbbreviation=!0))}(e,t),function(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}(e,t),function(e,t){e.match(/^\+/)&&(t.forceSign=!0)}(e,t),t)}};function sv(){if(iv)return rv;iv=1;const e=ev(),t=nv(),n=ov;let r,i={},o={},s=null,a={};function l(e){r=e}function c(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>c().bytes||{},i.currentCurrency=()=>c().currency,i.currentAbbreviations=()=>c().abbreviations,i.currentDelimiters=()=>c().delimiters,i.currentOrdinal=()=>c().ordinal,i.currentDefaults=()=>Object.assign({},c().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().timeFormat),i.setDefaults=e=>{e=n.parseFormat(e),t.validateFormat(e)&&(a=e)},i.getZeroFormat=()=>s,i.setZeroFormat=e=>s="string"===typeof e?e:null,i.hasZeroFormat=()=>null!==s,i.languageData=e=>{if(e){if(o[e])return o[e];throw new Error(`Unknown tag "${e}"`)}return c()},i.registerLanguage=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.validateLanguage(e))throw new Error("Invalid language data");o[e.languageTag]=e,n&&l(e.languageTag)},i.setLanguage=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.languageTag;if(!o[t]){let e=t.split("-")[0],r=Object.keys(o).find(t=>t.split("-")[0]===e);return o[r]?void l(r):void l(n)}l(t)},i.registerLanguage(e),r=e.languageTag,rv=i}function av(e,t){e.forEach(e=>{let n;try{n=function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${e}`)}catch(r){console.error(`Unable to load "${e}". No matching language file found.`)}n&&t.registerLanguage(n)})}var lv,cv={exports:{}};lv=cv,function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,l=14,c=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=l-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function f(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,l=e.e,c=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=l==c,!i||!o)return r?0:!i^n?1:-1;if(!r)return l>c^n?1:-1;for(a=(l=i.length)<(c=o.length)?l:c,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return l==c?0:l>c^n?1:-1}function m(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function v(e){var t=e.c.length-1;return p(e.e/l)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function b(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}t=function e(t){var C,y,S,x=_.prototype={constructor:_,toString:null,valueOf:null},R=new _(1),E=20,T=4,k=-7,M=21,P=-1e7,I=1e7,A=!1,D=1,F=0,O={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},N="0123456789abcdefghijklmnopqrstuvwxyz",L=!0;function _(e,t){var r,o,a,u,d,h,p,g,f=this;if(!(f instanceof _))return new _(e,t);if(null==t){if(e&&!0===e._isBigNumber)return f.s=e.s,void(!e.c||e.e>I?f.c=f.e=null:e.e<P?f.c=[f.e=0]:(f.e=e.e,f.c=e.c.slice()));if((h="number"==typeof e)&&0*e==0){if(f.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,d=e;d>=10;d/=10,u++);return void(u>I?f.c=f.e=null:(f.e=u,f.c=[e]))}g=String(e)}else{if(!n.test(g=String(e)))return S(f,g,h);f.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(u=g.indexOf("."))>-1&&(g=g.replace(".","")),(d=g.search(/e/i))>0?(u<0&&(u=d),u+=+g.slice(d+1),g=g.substring(0,d)):u<0&&(u=g.length)}else{if(m(t,2,N.length,"Base"),10==t&&L)return W(f=new _(e),E+f.e+1,T);if(g=String(e),h="number"==typeof e){if(0*e!=0)return S(f,g,h,t);if(f.s=1/e<0?(g=g.slice(1),-1):1,_.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(s+e)}else f.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(r=N.slice(0,t),u=d=0,p=g.length;d<p;d++)if(r.indexOf(o=g.charAt(d))<0){if("."==o){if(d>u){u=p;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,d=-1,u=0;continue}return S(f,String(e),h,t)}h=!1,(u=(g=y(g,t,10,f.s)).indexOf("."))>-1?g=g.replace(".",""):u=g.length}for(d=0;48===g.charCodeAt(d);d++);for(p=g.length;48===g.charCodeAt(--p););if(g=g.slice(d,++p)){if(p-=d,h&&_.DEBUG&&p>15&&(e>c||e!==i(e)))throw Error(s+f.s*e);if((u=u-d-1)>I)f.c=f.e=null;else if(u<P)f.c=[f.e=0];else{if(f.e=u,f.c=[],d=(u+1)%l,u<0&&(d+=l),d<p){for(d&&f.c.push(+g.slice(0,d)),p-=l;d<p;)f.c.push(+g.slice(d,d+=l));d=l-(g=g.slice(d)).length}else d-=p;for(;d--;g+="0");f.c.push(+g)}}else f.c=[f.e=0]}function H(e,t,n,r){var i,o,s,a,l;if(null==n?n=T:m(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)l=g(e.c),l=1==r||2==r&&(s<=k||s>=M)?w(l,s):b(l,s,"0");else if(o=(e=W(new _(e),t,n)).e,a=(l=g(e.c)).length,1==r||2==r&&(t<=o||o<=k)){for(;a<t;l+="0",a++);l=w(l,o)}else if(t-=s,l=b(l,o,"0"),o+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=o-a)>0)for(o+1==a&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function V(e,t){for(var n,r,i=1,o=new _(e[0]);i<e.length;i++)(!(r=new _(e[i])).s||(n=f(o,r))===t||0===n&&o.s===t)&&(o=r);return o}function B(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*l-1)>I?e.c=e.e=null:n<P?e.c=[e.e=0]:(e.e=n,e.c=t),e}function W(e,t,n,o){var s,c,d,h,p,g,f,m=e.c,v=u;if(m){e:{for(s=1,h=m[0];h>=10;h/=10,s++);if((c=t-s)<0)c+=l,d=t,p=m[g=0],f=i(p/v[s-d-1]%10);else if((g=r((c+1)/l))>=m.length){if(!o)break e;for(;m.length<=g;m.push(0));p=f=0,s=1,d=(c%=l)-l+1}else{for(p=h=m[g],s=1;h>=10;h/=10,s++);f=(d=(c%=l)-l+s)<0?0:i(p/v[s-d-1]%10)}if(o=o||t<0||null!=m[g+1]||(d<0?p:p%v[s-d-1]),o=n<4?(f||o)&&(0==n||n==(e.s<0?3:2)):f>5||5==f&&(4==n||o||6==n&&(c>0?d>0?p/v[s-d]:0:m[g-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,o?(t-=e.e+1,m[0]=v[(l-t%l)%l],e.e=-t||0):m[0]=e.e=0,e;if(0==c?(m.length=g,h=1,g--):(m.length=g+1,h=v[l-c],m[g]=d>0?i(p/v[s-d]%v[d])*h:0),o)for(;;){if(0==g){for(c=1,d=m[0];d>=10;d/=10,c++);for(d=m[0]+=h,h=1;d>=10;d/=10,h++);c!=h&&(e.e++,m[0]==a&&(m[0]=1));break}if(m[g]+=h,m[g]!=a)break;m[g--]=0,h=1}for(c=m.length;0===m[--c];m.pop());}e.e>I?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function z(e){var t,n=e.e;return null===n?e.toString():(t=g(e.c),t=n<=k||n>=M?w(t,n):b(t,n,"0"),e.s<0?"-"+t:t)}return _.clone=e,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(n=e[t],0,h,t),E=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(n=e[t],0,8,t),T=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(m(n[0],-h,0,t),m(n[1],0,h,t),k=n[0],M=n[1]):(m(n,-h,h,t),k=-(M=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)m(n[0],-h,-1,t),m(n[1],1,h,t),P=n[0],I=n[1];else{if(m(n,-h,h,t),!n)throw Error(o+t+" cannot be zero: "+n);P=-(I=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw A=!n,Error(o+"crypto unavailable");A=n}else A=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(n=e[t],0,9,t),D=n),e.hasOwnProperty(t="POW_PRECISION")&&(m(n=e[t],0,h,t),F=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);O=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);L="0123456789"==n.slice(0,10),N=n}}return{DECIMAL_PLACES:E,ROUNDING_MODE:T,EXPONENTIAL_AT:[k,M],RANGE:[P,I],CRYPTO:A,MODULO_MODE:D,POW_PRECISION:F,FORMAT:O,ALPHABET:N}},_.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!_.DEBUG)return!0;var t,n,r=e.c,s=e.e,c=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===c||-1===c)&&s>=-h&&s<=h&&s===i(s)){if(0===r[0]){if(0===s&&1===r.length)return!0;break e}if((t=(s+1)%l)<1&&(t+=l),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=a||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===s&&(null===c||1===c||-1===c))return!0;throw Error(o+"Invalid BigNumber: "+e)},_.maximum=_.max=function(){return V(arguments,-1)},_.minimum=_.min=function(){return V(arguments,1)},_.random=function(){var e=9007199254740992,t=Math.random()*e&2097151?function(){return i(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var n,s,a,c,d,p=0,g=[],f=new _(R);if(null==e?e=E:m(e,0,h),c=r(e/l),A)if(crypto.getRandomValues){for(n=crypto.getRandomValues(new Uint32Array(c*=2));p<c;)(d=131072*n[p]+(n[p+1]>>>11))>=9e15?(s=crypto.getRandomValues(new Uint32Array(2)),n[p]=s[0],n[p+1]=s[1]):(g.push(d%1e14),p+=2);p=c/2}else{if(!crypto.randomBytes)throw A=!1,Error(o+"crypto unavailable");for(n=crypto.randomBytes(c*=7);p<c;)(d=281474976710656*(31&n[p])+1099511627776*n[p+1]+4294967296*n[p+2]+16777216*n[p+3]+(n[p+4]<<16)+(n[p+5]<<8)+n[p+6])>=9e15?crypto.randomBytes(7).copy(n,p):(g.push(d%1e14),p+=7);p=c/7}if(!A)for(;p<c;)(d=t())<9e15&&(g[p++]=d%1e14);for(c=g[--p],e%=l,c&&e&&(d=u[l-e],g[p]=i(c/d)*d);0===g[p];g.pop(),p--);if(p<0)g=[a=0];else{for(a=-1;0===g[0];g.splice(0,1),a-=l);for(p=1,d=g[0];d>=10;d/=10,p++);p<l&&(a-=l-p)}return f.e=a,f.c=g,f}}(),_.sum=function(){for(var e=1,t=arguments,n=new _(t[0]);e<t.length;)n=n.plus(t[e++]);return n},y=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,l=e.length;a<l;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(n,r,i,o,s){var a,l,c,u,d,h,p,f,m=n.indexOf("."),v=E,w=T;for(m>=0&&(u=F,F=0,n=n.replace(".",""),h=(f=new _(r)).pow(n.length-m),F=u,f.c=t(b(g(h.c),h.e,"0"),10,i,e),f.e=f.c.length),c=u=(p=t(n,r,i,s?(a=N,e):(a=e,N))).length;0==p[--u];p.pop());if(!p[0])return a.charAt(0);if(m<0?--c:(h.c=p,h.e=c,h.s=o,p=(h=C(h,f,v,w,i)).c,d=h.r,c=h.e),m=p[l=c+v+1],u=i/2,d=d||l<0||null!=p[l+1],d=w<4?(null!=m||d)&&(0==w||w==(h.s<0?3:2)):m>u||m==u&&(4==w||d||6==w&&1&p[l-1]||w==(h.s<0?8:7)),l<1||!p[0])n=d?b(a.charAt(1),-v,a.charAt(0)):a.charAt(0);else{if(p.length=l,d)for(--i;++p[--l]>i;)p[l]=0,l||(++c,p=[1].concat(p));for(u=p.length;!p[--u];);for(m=0,n="";m<=u;n+=a.charAt(p[m++]));n=b(n,c,a.charAt(0))}return n}}(),C=function(){function e(e,t,n){var r,i,o,s,a=0,l=e.length,c=t%d,u=t/d|0;for(e=e.slice();l--;)a=((i=c*(o=e[l]%d)+(r=u*o+(s=e[l]/d|0)*c)%d*d+a)/n|0)+(r/d|0)+u*s,e[l]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,o,s,c,u){var d,h,g,f,m,v,w,b,C,y,S,x,R,E,T,k,M,P=r.s==o.s?1:-1,I=r.c,A=o.c;if(!I||!I[0]||!A||!A[0])return new _(r.s&&o.s&&(I?!A||I[0]!=A[0]:A)?I&&0==I[0]||!A?0*P:P/0:NaN);for(C=(b=new _(P)).c=[],P=s+(h=r.e-o.e)+1,u||(u=a,h=p(r.e/l)-p(o.e/l),P=P/l|0),g=0;A[g]==(I[g]||0);g++);if(A[g]>(I[g]||0)&&h--,P<0)C.push(1),f=!0;else{for(E=I.length,k=A.length,g=0,P+=2,(m=i(u/(A[0]+1)))>1&&(A=e(A,m,u),I=e(I,m,u),k=A.length,E=I.length),R=k,S=(y=I.slice(0,k)).length;S<k;y[S++]=0);M=A.slice(),M=[0].concat(M),T=A[0],A[1]>=u/2&&T++;do{if(m=0,(d=t(A,y,k,S))<0){if(x=y[0],k!=S&&(x=x*u+(y[1]||0)),(m=i(x/T))>1)for(m>=u&&(m=u-1),w=(v=e(A,m,u)).length,S=y.length;1==t(v,y,w,S);)m--,n(v,k<w?M:A,w,u),w=v.length,d=1;else 0==m&&(d=m=1),w=(v=A.slice()).length;if(w<S&&(v=[0].concat(v)),n(y,v,S,u),S=y.length,-1==d)for(;t(A,y,k,S)<1;)m++,n(y,k<S?M:A,S,u),S=y.length}else 0===d&&(m++,y=[0]);C[g++]=m,y[0]?y[S++]=I[R]||0:(y=[I[R]],S=1)}while((R++<E||null!=y[0])&&P--);f=null!=y[0],C[0]||C.splice(0,1)}if(u==a){for(g=1,P=C[0];P>=10;P/=10,g++);W(b,s+(b.e=g+h*l-1)+1,c,f)}else b.e=h,b.r=+f;return b}}(),S=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,n=/^\.([^.]+)$/,r=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(s,a,l,c){var u,d=l?a:a.replace(i,"");if(r.test(d))s.s=isNaN(d)?null:d<0?-1:1;else{if(!l&&(d=d.replace(e,function(e,t,n){return u="x"==(n=n.toLowerCase())?16:"b"==n?2:8,c&&c!=u?e:t}),c&&(u=c,d=d.replace(t,"$1").replace(n,"0.$1")),a!=d))return new _(d,u);if(_.DEBUG)throw Error(o+"Not a"+(c?" base "+c:"")+" number: "+a);s.s=null}s.c=s.e=null}}(),x.absoluteValue=x.abs=function(){var e=new _(this);return e.s<0&&(e.s=1),e},x.comparedTo=function(e,t){return f(this,new _(e,t))},x.decimalPlaces=x.dp=function(e,t){var n,r,i,o=this;if(null!=e)return m(e,0,h),null==t?t=T:m(t,0,8),W(new _(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-p(this.e/l))*l,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},x.dividedBy=x.div=function(e,t){return C(this,new _(e,t),E,T)},x.dividedToIntegerBy=x.idiv=function(e,t){return C(this,new _(e,t),0,1)},x.exponentiatedBy=x.pow=function(e,t){var n,s,a,c,u,d,h,p,g=this;if((e=new _(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+z(e));if(null!=t&&(t=new _(t)),u=e.e>14,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return p=new _(Math.pow(+z(g),u?e.s*(2-v(e)):+z(e))),t?p.mod(t):p;if(d=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new _(NaN);(s=!d&&g.isInteger()&&t.isInteger())&&(g=g.mod(t))}else{if(e.e>9&&(g.e>0||g.e<-1||(0==g.e?g.c[0]>1||u&&g.c[1]>=24e7:g.c[0]<8e13||u&&g.c[0]<=9999975e7)))return c=g.s<0&&v(e)?-0:0,g.e>-1&&(c=1/c),new _(d?1/c:c);F&&(c=r(F/l+2))}for(u?(n=new _(.5),d&&(e.s=1),h=v(e)):h=(a=Math.abs(+z(e)))%2,p=new _(R);;){if(h){if(!(p=p.times(g)).c)break;c?p.c.length>c&&(p.c.length=c):s&&(p=p.mod(t))}if(a){if(0===(a=i(a/2)))break;h=a%2}else if(W(e=e.times(n),e.e+1,1),e.e>14)h=v(e);else{if(0===(a=+z(e)))break;h=a%2}g=g.times(g),c?g.c&&g.c.length>c&&(g.c.length=c):s&&(g=g.mod(t))}return s?p:(d&&(p=R.div(p)),t?p.mod(t):c?W(p,F,T,void 0):p)},x.integerValue=function(e){var t=new _(this);return null==e?e=T:m(e,0,8),W(t,t.e+1,e)},x.isEqualTo=x.eq=function(e,t){return 0===f(this,new _(e,t))},x.isFinite=function(){return!!this.c},x.isGreaterThan=x.gt=function(e,t){return f(this,new _(e,t))>0},x.isGreaterThanOrEqualTo=x.gte=function(e,t){return 1===(t=f(this,new _(e,t)))||0===t},x.isInteger=function(){return!!this.c&&p(this.e/l)>this.c.length-2},x.isLessThan=x.lt=function(e,t){return f(this,new _(e,t))<0},x.isLessThanOrEqualTo=x.lte=function(e,t){return-1===(t=f(this,new _(e,t)))||0===t},x.isNaN=function(){return!this.s},x.isNegative=function(){return this.s<0},x.isPositive=function(){return this.s>0},x.isZero=function(){return!!this.c&&0==this.c[0]},x.minus=function(e,t){var n,r,i,o,s=this,c=s.s;if(t=(e=new _(e,t)).s,!c||!t)return new _(NaN);if(c!=t)return e.s=-t,s.plus(e);var u=s.e/l,d=e.e/l,h=s.c,g=e.c;if(!u||!d){if(!h||!g)return h?(e.s=-t,e):new _(g?s:NaN);if(!h[0]||!g[0])return g[0]?(e.s=-t,e):new _(h[0]?s:3==T?-0:0)}if(u=p(u),d=p(d),h=h.slice(),c=u-d){for((o=c<0)?(c=-c,i=h):(d=u,i=g),i.reverse(),t=c;t--;i.push(0));i.reverse()}else for(r=(o=(c=h.length)<(t=g.length))?c:t,c=t=0;t<r;t++)if(h[t]!=g[t]){o=h[t]<g[t];break}if(o&&(i=h,h=g,g=i,e.s=-e.s),(t=(r=g.length)-(n=h.length))>0)for(;t--;h[n++]=0);for(t=a-1;r>c;){if(h[--r]<g[r]){for(n=r;n&&!h[--n];h[n]=t);--h[n],h[r]+=a}h[r]-=g[r]}for(;0==h[0];h.splice(0,1),--d);return h[0]?B(e,h,d):(e.s=3==T?-1:1,e.c=[e.e=0],e)},x.modulo=x.mod=function(e,t){var n,r,i=this;return e=new _(e,t),!i.c||!e.s||e.c&&!e.c[0]?new _(NaN):!e.c||i.c&&!i.c[0]?new _(i):(9==D?(r=e.s,e.s=1,n=C(i,e,0,3),e.s=r,n.s*=r):n=C(i,e,0,D),(e=i.minus(n.times(e))).c[0]||1!=D||(e.s=i.s),e)},x.multipliedBy=x.times=function(e,t){var n,r,i,o,s,c,u,h,g,f,m,v,w,b,C,y=this,S=y.c,x=(e=new _(e,t)).c;if(!S||!x||!S[0]||!x[0])return!y.s||!e.s||S&&!S[0]&&!x||x&&!x[0]&&!S?e.c=e.e=e.s=null:(e.s*=y.s,S&&x?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=p(y.e/l)+p(e.e/l),e.s*=y.s,(u=S.length)<(f=x.length)&&(w=S,S=x,x=w,i=u,u=f,f=i),i=u+f,w=[];i--;w.push(0));for(b=a,C=d,i=f;--i>=0;){for(n=0,m=x[i]%C,v=x[i]/C|0,o=i+(s=u);o>i;)n=((h=m*(h=S[--s]%C)+(c=v*h+(g=S[s]/C|0)*m)%C*C+w[o]+n)/b|0)+(c/C|0)+v*g,w[o--]=h%b;w[o]=n}return n?++r:w.splice(0,1),B(e,w,r)},x.negated=function(){var e=new _(this);return e.s=-e.s||null,e},x.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new _(e,t)).s,!i||!t)return new _(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/l,s=e.e/l,c=r.c,u=e.c;if(!o||!s){if(!c||!u)return new _(i/0);if(!c[0]||!u[0])return u[0]?e:new _(c[0]?r:0*i)}if(o=p(o),s=p(s),c=c.slice(),i=o-s){for(i>0?(s=o,n=u):(i=-i,n=c),n.reverse();i--;n.push(0));n.reverse()}for((i=c.length)-(t=u.length)<0&&(n=u,u=c,c=n,t=i),i=0;t;)i=(c[--t]=c[t]+u[t]+i)/a|0,c[t]=a===c[t]?0:c[t]%a;return i&&(c=[i].concat(c),++s),B(e,c,s)},x.precision=x.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return m(e,1,h),null==t?t=T:m(t,0,8),W(new _(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*l+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},x.shiftedBy=function(e){return m(e,-9007199254740991,c),this.times("1e"+e)},x.squareRoot=x.sqrt=function(){var e,t,n,r,i,o=this,s=o.c,a=o.s,l=o.e,c=E+4,u=new _("0.5");if(1!==a||!s||!s[0])return new _(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+z(o)))||a==1/0?(((t=g(s)).length+l)%2==0&&(t+="0"),a=Math.sqrt(+t),l=p((l+1)/2)-(l<0||l%2),n=new _(t=a==1/0?"5e"+l:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new _(a+""),n.c[0])for((a=(l=n.e)+c)<3&&(a=0);;)if(i=n,n=u.times(i.plus(C(o,i,c,1))),g(i.c).slice(0,a)===(t=g(n.c)).slice(0,a)){if(n.e<l&&--a,"9999"!=(t=t.slice(a-3,a+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(W(n,n.e+E+2,1),e=!n.times(n).eq(o));break}if(!r&&(W(i,i.e+E+2,0),i.times(i).eq(o))){n=i;break}c+=4,a+=4,r=1}return W(n,n.e+E+1,T,e)},x.toExponential=function(e,t){return null!=e&&(m(e,0,h),e++),H(this,e,t,1)},x.toFixed=function(e,t){return null!=e&&(m(e,0,h),e=e+this.e+1),H(this,e,t)},x.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=O;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),l=+n.groupSize,c=+n.secondaryGroupSize,u=n.groupSeparator||"",d=a[0],h=a[1],p=i.s<0,g=p?d.slice(1):d,f=g.length;if(c&&(s=l,l=c,c=s,f-=s),l>0&&f>0){for(s=f%l||l,d=g.substr(0,s);s<f;s+=l)d+=u+g.substr(s,l);c>0&&(d+=u+g.slice(s)),p&&(d="-"+d)}r=h?d+(n.decimalSeparator||"")+((c=+n.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):h):d}return(n.prefix||"")+r+(n.suffix||"")},x.toFraction=function(e){var t,n,r,i,s,a,c,d,h,p,f,m,v=this,w=v.c;if(null!=e&&(!(c=new _(e)).isInteger()&&(c.c||1!==c.s)||c.lt(R)))throw Error(o+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+z(c));if(!w)return new _(v);for(t=new _(R),h=n=new _(R),r=d=new _(R),m=g(w),s=t.e=m.length-v.e-1,t.c[0]=u[(a=s%l)<0?l+a:a],e=!e||c.comparedTo(t)>0?s>0?t:h:c,a=I,I=1/0,c=new _(m),d.c[0]=0;p=C(c,t,0,1),1!=(i=n.plus(p.times(r))).comparedTo(e);)n=r,r=i,h=d.plus(p.times(i=h)),d=i,t=c.minus(p.times(i=t)),c=i;return i=C(e.minus(n),r,0,1),d=d.plus(i.times(h)),n=n.plus(i.times(r)),d.s=h.s=v.s,f=C(h,r,s*=2,T).minus(v).abs().comparedTo(C(d,n,s,T).minus(v).abs())<1?[h,r]:[d,n],I=a,f},x.toNumber=function(){return+z(this)},x.toPrecision=function(e,t){return null!=e&&m(e,1,h),H(this,e,t,2)},x.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=k||i>=M?w(g(n.c),i):b(g(n.c),i,"0"):10===e&&L?t=b(g((n=W(new _(n),E+i+1,T)).c),n.e,"0"):(m(e,2,N.length,"Base"),t=y(b(g(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},x.valueOf=x.toJSON=function(){return z(this)},x._isBigNumber=!0,null!=t&&_.set(t),_}(),t.default=t.BigNumber=t,lv.exports?lv.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(Jm);var uv=cv.exports;const dv=sv(),hv=nv(),pv=ov,gv=uv,fv={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},mv={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:vv,decimalSuffixes:wv}=dv.currentBytes(),bv={general:{scale:1024,suffixes:wv,marker:"bd"},binary:{scale:1024,suffixes:vv,marker:"b"},decimal:{scale:1e3,suffixes:wv,marker:"d"}};function Cv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if("string"===typeof t&&(t=pv.parseFormat(t)),!hv.validateFormat(t))return"ERROR: invalid format";let r=t.prefix||"",i=t.postfix||"",o=function(e,t,n){switch(t.output){case"currency":return function(e,t,n){const r=n.currentCurrency();let i,o=Object.assign({},t),s=Object.assign({},mv,o),a="",l=!!s.totalLength||!!s.forceAverage||s.average,c=o.currencyPosition||r.position,u=o.currencySymbol||r.symbol;const d=void 0!==s.spaceSeparatedCurrency?s.spaceSeparatedCurrency:s.spaceSeparated;void 0===o.lowPrecision&&(o.lowPrecision=!1);d&&(a=" ");"infix"===c&&(i=a+u+a);let h=Rv({instance:e,providedFormat:o,state:n,decimalSeparator:i});"prefix"===c&&(h=e._value<0&&"sign"===s.negative?`-${a}${u}${h.slice(1)}`:e._value>0&&s.forceSign?`+${a}${u}${h.slice(1)}`:u+a+h);c&&"postfix"!==c||(a=!s.spaceSeparatedAbbreviation&&l?"":a,h=h+a+u);return h}(e,t=Ev(t,dv.currentCurrencyDefaultFormat()),dv);case"percent":return function(e,t,n,r){let i=t.prefixSymbol,o=Rv({instance:r(100*e._value),providedFormat:t,state:n}),s=Object.assign({},mv,t);if(i)return`%${s.spaceSeparated?" ":""}${o}`;return`${o}${s.spaceSeparated?" ":""}%`}(e,t=Ev(t,dv.currentPercentageDefaultFormat()),dv,n);case"byte":return function(e,t,n,r){let i=t.base||"binary",o=Object.assign({},mv,t);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let l={general:{scale:1024,suffixes:a||wv,marker:"bd"},binary:{scale:1024,suffixes:s||vv,marker:"b"},decimal:{scale:1e3,suffixes:a||wv,marker:"d"}}[i],{value:c,suffix:u}=yv(e._value,l.suffixes,l.scale),d=Rv({instance:r(c),providedFormat:t,state:n,defaults:n.currentByteDefaultFormat()});return`${d}${o.spaceSeparated?" ":""}${u}`}(e,t=Ev(t,dv.currentByteDefaultFormat()),dv,n);case"time":return t=Ev(t,dv.currentTimeDefaultFormat()),function(e){let t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return`${t}:${n<10?"0":""}${n}:${r<10?"0":""}${r}`}(e);case"ordinal":return function(e,t,n){let r=n.currentOrdinal(),i=Object.assign({},mv,t),o=Rv({instance:e,providedFormat:t,state:n}),s=r(e._value);return`${o}${i.spaceSeparated?" ":""}${s}`}(e,t=Ev(t,dv.currentOrdinalDefaultFormat()),dv);default:return Rv({instance:e,providedFormat:t,numbro:n})}}(e,t,n);return o=function(e,t){return t+e}(o,r),o=function(e,t){return e+t}(o,i),o}function yv(e,t,n){let r=t[0],i=Math.abs(e);if(i>=n){for(let o=1;o<t.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(i>=s&&i<a){r=t[o],e/=s;break}}r===t[0]&&(e/=Math.pow(n,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function Sv(e){let t="";for(let n=0;n<e;n++)t+="0";return t}function xv(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.round;if(-1!==e.toString().indexOf("e"))return function(e,t){let n=e.toString(),[r,i]=n.split("e"),[o,s=""]=r.split(".");if(+i>0)n=o+s+Sv(i-s.length);else{let e=".";e=+o<0?`-0${e}`:`0${e}`;let r=(Sv(-i-1)+Math.abs(o)+s).substr(0,t);r.length<t&&(r+=Sv(t-r.length)),n=e+r}return+i>0&&t>0&&(n+=`.${Sv(t)}`),n}(e,t);return new gv(n(+`${e}e+${t}`)/Math.pow(10,t)).toFixed(t)}function Rv(e){let{instance:t,providedFormat:n,state:r=dv,decimalSeparator:i,defaults:o=r.currentDefaults()}=e,s=t._value;if(0===s&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let a=Object.assign({},mv,o,n),l=a.totalLength,c=l?0:a.characteristic,u=a.optionalCharacteristic,d=a.forceAverage,h=a.lowPrecision,p=!!l||!!d||a.average,g=l?-1:p&&void 0===n.mantissa?0:a.mantissa,f=!l&&(void 0===n.optionalMantissa?-1===g:a.optionalMantissa),m=a.trimMantissa,v=a.thousandSeparated,w=a.spaceSeparated,b=a.negative,C=a.forceSign,y=a.exponential,S=a.roundingFunction,x="";if(p){let e=function(e){let{value:t,forceAverage:n,lowPrecision:r=!0,abbreviations:i,spaceSeparated:o=!1,totalLength:s=0,roundingFunction:a=Math.round}=e,l="",c=Math.abs(t),u=-1;if(n&&i[n]&&fv[n]?(l=i[n],t/=fv[n]):c>=fv.trillion||r&&1===a(c/fv.trillion)?(l=i.trillion,t/=fv.trillion):c<fv.trillion&&c>=fv.billion||r&&1===a(c/fv.billion)?(l=i.billion,t/=fv.billion):c<fv.billion&&c>=fv.million||r&&1===a(c/fv.million)?(l=i.million,t/=fv.million):(c<fv.million&&c>=fv.thousand||r&&1===a(c/fv.thousand))&&(l=i.thousand,t/=fv.thousand),l&&(l=(o?" ":"")+l),s){let e=t<0,n=t.toString().split(".")[0],r=e?n.length-1:n.length;u=Math.max(s-r,0)}return{value:t,abbreviation:l,mantissaPrecision:u}}({value:s,forceAverage:d,lowPrecision:h,abbreviations:r.currentAbbreviations(),spaceSeparated:w,roundingFunction:S,totalLength:l});s=e.value,x+=e.abbreviation,l&&(g=e.mantissaPrecision)}if(y){let e=function(e){let{value:t,characteristicPrecision:n}=e,[r,i]=t.toExponential().split("e"),o=+r;return n?(1<n&&(o*=Math.pow(10,n-1),i=+i-(n-1),i=i>=0?`+${i}`:i),{value:o,abbreviation:`e${i}`}):{value:o,abbreviation:`e${i}`}}({value:s,characteristicPrecision:c});s=e.value,x=e.abbreviation+x}let R=function(e,t,n,r,i,o){if(-1===r)return e;let s=xv(t,r,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||i))return a;let c=l.match(/0+$/);return i&&c?`${a}.${l.toString().slice(0,c.index)}`:s.toString()}(s.toString(),s,f,g,m,S);return R=function(e,t,n,r){let i=e,[o,s]=i.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=t<0&&0===o.indexOf("-");if(a&&(o=o.slice(1),i=i.slice(1)),o.length<r){let e=r-o.length;for(let t=0;t<e;t++)i=`0${i}`}return a&&(i=`-${i}`),i.toString()}(R,s,u,c),R=function(e,t,n,r,i){let o=r.currentDelimiters(),s=o.thousands;i=i||o.decimal;let a=o.thousandsSize||3,l=e.toString(),c=l.split(".")[0],u=l.split(".")[1];const d=t<0&&0===c.indexOf("-");if(n){d&&(c=c.slice(1));let e=function(e,t){let n=[],r=0;for(let i=e;i>0;i--)r===t&&(n.unshift(i),r=0),r++;return n}(c.length,a);e.forEach((e,t)=>{c=c.slice(0,e+t)+s+c.slice(e+t)}),d&&(c=`-${c}`)}return l=u?c+i+u:c,l}(R,s,v,r,i),(p||y)&&(R=function(e,t){return e+t}(R,x)),(C||s<0)&&(R=function(e,t,n){return 0===t?e:0===+e?e.replace("-",""):t>0?`+${e}`:"sign"===n?e:`(${e.replace("-","")})`}(R,s,b)),R}function Ev(e,t){if(!e)return t;let n=Object.keys(e);return 1===n.length&&"output"===n[0]?t:e}const Tv=uv;function kv(e,t,n){let r=new Tv(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new Tv(i),e._value=r.minus(i).toNumber(),e}const Mv=sv(),Pv=nv(),Iv=(e=>({loadLanguagesInNode:t=>av(t,e)}))(_v),Av=tv();let Dv=(e=>({format:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Cv(...n,e)},getByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=bv.general;return yv(e._value,t.suffixes,t.scale).suffix}(...n,e)},getBinaryByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=bv.binary;return yv(e._value,t.suffixes,t.scale).suffix}(...n,e)},getDecimalByteUnit:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return function(e){let t=bv.decimal;return yv(e._value,t.suffixes,t.scale).suffix}(...n,e)},formatOrDefault:Ev}))(_v),Fv=(e=>({add:(t,n)=>function(e,t,n){let r=new Tv(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new Tv(i),e._value=r.plus(i).toNumber(),e}(t,n,e),subtract:(t,n)=>kv(t,n,e),multiply:(t,n)=>function(e,t,n){let r=new Tv(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new Tv(i),e._value=r.times(i).toNumber(),e}(t,n,e),divide:(t,n)=>function(e,t,n){let r=new Tv(e._value),i=t;return n.isNumbro(t)&&(i=t._value),i=new Tv(i),e._value=r.dividedBy(i).toNumber(),e}(t,n,e),set:(t,n)=>function(e,t,n){let r=t;return n.isNumbro(t)&&(r=t._value),e._value=r,e}(t,n,e),difference:(t,n)=>function(e,t,n){let r=n(e._value);return kv(r,t,n),Math.abs(r._value)}(t,n,e),BigNumber:Tv}))(_v);const Ov=ov;class Nv{constructor(e){this._value=e}clone(){return _v(this._value)}format(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Dv.format(this,e)}formatCurrency(e){return"string"===typeof e&&(e=Ov.parseFormat(e)),(e=Dv.formatOrDefault(e,Mv.currentCurrencyDefaultFormat())).output="currency",Dv.format(this,e)}formatTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",Dv.format(this,e)}binaryByteUnits(){return Dv.getBinaryByteUnit(this)}decimalByteUnits(){return Dv.getDecimalByteUnit(this)}byteUnits(){return Dv.getByteUnit(this)}difference(e){return Fv.difference(this,e)}add(e){return Fv.add(this,e)}subtract(e){return Fv.subtract(this,e)}multiply(e){return Fv.multiply(this,e)}divide(e){return Fv.divide(this,e)}set(e){return Fv.set(this,Lv(e))}value(){return this._value}valueOf(){return this._value}}function Lv(e){let t=e;return _v.isNumbro(e)?t=e._value:"string"===typeof e?t=_v.unformat(e):isNaN(e)&&(t=NaN),t}function _v(e){return new Nv(Lv(e))}_v.version="2.5.0",_v.isNumbro=function(e){return e instanceof Nv},_v.language=Mv.currentLanguage,_v.registerLanguage=Mv.registerLanguage,_v.setLanguage=Mv.setLanguage,_v.languages=Mv.languages,_v.languageData=Mv.languageData,_v.zeroFormat=Mv.setZeroFormat,_v.defaultFormat=Mv.currentDefaults,_v.setDefaults=Mv.setDefaults,_v.defaultCurrencyFormat=Mv.currentCurrencyDefaultFormat,_v.validate=Pv.validate,_v.loadLanguagesInNode=Iv.loadLanguagesInNode,_v.unformat=Av.unformat,_v.BigNumber=Fv.BigNumber;var Hv=Zm(_v);function Vv(e,t){if(Qr(e)){const n=t.numericFormat,r=n&&n.culture||"-",i=n&&n.pattern;if("undefined"!==typeof r&&!Hv.languages()[r]){const e=r.replace("-",""),t=Hv.allLanguages?Hv.allLanguages[r]:Hv[e];t&&Hv.registerLanguage(t)}Hv.setLanguage(r),e=Hv(e).format(i||"0")}return e}function Bv(e,t,n,r,i,o,s){let a=o;if(Qr(a)){let e=[];if(Array.isArray(s.className))e=s.className;else{var l;const t=null!==(l=s.className)&&void 0!==l?l:"";t.length&&(e=t.split(" "))}a=Vv(a,s),e.indexOf("htLeft")<0&&e.indexOf("htCenter")<0&&e.indexOf("htRight")<0&&e.indexOf("htJustify")<0&&e.push("htRight"),e.indexOf("htNumeric")<0&&e.push("htNumeric"),s.className=e.join(" "),t.dir="ltr"}Kg(e,t,n,r,i,a,s)}Bv.RENDERER_TYPE="numeric";function Wv(e,t,n,r,i,o,s){Kg.apply(this,[e,t,n,r,i,o,s]);const a=s.hashLength||t.innerHTML.length,l=s.hashSymbol||"*";let c="";Zr(a-1,()=>{c+=l}),Je(t,c)}Wv.RENDERER_TYPE="password";function zv(e,t,n,r,i,o,s){Kg.apply(this,[e,t,n,r,i,o,s])}zv.RENDERER_TYPE="select";function jv(e,t,n,r,i,o,s){Kg.apply(this,[e,t,n,r,i,o,s]),t.dir="ltr"}jv.RENDERER_TYPE="time";function Gv(e,t){let n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,$v(n,t)):$v(n,t)(this.source):t(!0)}function $v(e,t){const n=e;return function(e){let r=!1;for(let t=0,i=e.length;t<i;t++)if(n===e[t]){r=!0;break}t(r)}}Gv.VALIDATOR_TYPE="autocomplete";function Uv(e,t){const n=fr(ym,this.instance);let r=e,i=!0;null!==r&&void 0!==r||(r="");let o=Mt(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Mt(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(!0===this.correctFormat){const e=function(e,t){const n=Mt(function(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}(e)),r=Mt(e,t),i=e.search(/[A-Za-z]/g)>-1;let o;o=n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?n:r;return o.format(t)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),i=!0}else i=!1;t(i)}Uv.VALIDATOR_TYPE="date";function Kv(e,t){Gv.apply(this,[e,t])}Kv.VALIDATOR_TYPE="dropdown";function Yv(e,t){let n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):t(""!==n&&Qr(e))}Yv.VALIDATOR_TYPE="numeric";const qv=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function Xv(e,t){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Mt(i,qv,!0).isValid()?Mt(i):Mt(i,n);let a=s.isValid(),l=Mt(i,n,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(!0===this.correctFormat){const e=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),r=!0}else r=!1;t(r)}Xv.VALIDATOR_TYPE="time";const Qv={CELL_TYPE:"autocomplete",editor:jf,renderer:Nm,validator:Gv},Jv={CELL_TYPE:"checkbox",editor:$f,renderer:jm};function Zv(e,t,n,r,i,o,s){Nm.apply(this,[e,t,n,r,i,o,s])}Zv.RENDERER_TYPE="date";const ew={CELL_TYPE:"date",editor:Rm,renderer:Zv,validator:Uv},tw={CELL_TYPE:"dropdown",editor:Tm,renderer:Lm,validator:Kv,filter:!1,strict:!0},nw={CELL_TYPE:"handsontable",editor:Of,renderer:$m},rw={CELL_TYPE:"numeric",editor:km,renderer:Bv,validator:Yv,dataType:"number"},iw={CELL_TYPE:"password",editor:Pm,renderer:Wv,copyable:!1},ow={CELL_TYPE:"select",editor:Dm,renderer:zv},sw={CELL_TYPE:"time",editor:Fm,renderer:jv,validator:Xv};function aw(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cw(e,t){return e.get(uw(e,t))}function uw(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const dw=new Map([["plugin",function(e){return!!fi(e)}],["cell-type",Nh],["editor",dr],["renderer",bi],["validator",Ti]]),hw=Symbol("mainSetting"),pw=[];let gw=null;var fw=new WeakMap,mw=new WeakSet;class vw{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){var t,n;aw(t=this,n=mw),n.add(t),lw(this,"eventManager",new Cr(this)),lw(this,"pluginName",null),lw(this,"pluginsInitializedCallbacks",[]),lw(this,"isPluginsReady",!1),lw(this,"enabled",!1),lw(this,"initialized",!1),function(e,t,n){aw(e,t),t.set(e,n)}(this,fw,{}),dn(this,"hot",e,{writable:!1}),gw=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",e=>this.onUpdateSettings(e)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach(t=>{const[n,r]=t.split(":");if(!dw.has(n))throw new Error(`Unknown plugin dependency type "${n}" was found.`);dw.get(n)(r)||e.push(` - ${r} (${n})`)}),e.length>0){const t=[`The ${this.pluginName} plugin requires the following modules:\n`,`${e.join("\n")}\n`].join("");pw.push(t)}}gw||(gw=gi()),gw.indexOf(this.pluginName)>=0&&gw.splice(gw.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});if(0===gw.length){if(pw.length>0){const e=[`${pw.join("\n")}\n`,"You have to import and register them manually."].join("");throw pw.length=0,new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const t=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===e)return t;const n=this.constructor.DEFAULT_SETTINGS;var r,i;return(Array.isArray(t)||un(t))&&n[hw]===e?Array.isArray(t)?t:null!==(r=t[e])&&void 0!==r?r:n[e]:un(t)&&null!==(i=t[e])&&void 0!==i?i:n[e]}addHook(e,t,n){cw(fw,this)[e]=cw(fw,this)[e]||[];const r=cw(fw,this)[e];this.hot.addHook(e,t,n),r.push(t),cw(fw,this)[e]=r}removeHooks(e){Ot(cw(fw,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=cw(fw,this);hn(e,(e,t)=>this.removeHooks(t)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Ot(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=uw(mw,this,ww).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),hn(this,(e,t)=>{"hot"!==t&&(this[t]=null)}),delete this.t,delete this.hot}}function ww(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(let n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}function bw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Cw=class{constructor(e){bw(this,"hot",null),bw(this,"container",null),bw(this,"injected",!1),bw(this,"rows",[]),bw(this,"columns",[]),bw(this,"samples",null),bw(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),0===e&&$e(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!==t&&void 0!==t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Ot(this.rows,t=>{const{height:n}=t.table.getBoundingClientRect();e(t.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),Ot(this.columns,t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{Ot(n.strings,n=>{t.appendChild(this.createColElement(n.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),n.appendChild(r)),this.samples.forEach(r=>{Ot(r.strings,r=>{const i=r.col,o=this.hot.getCellMeta(e,i),s=this.hot.getCellRenderer(o),a=t.createElement("td");a.setAttribute("ghost-table",1),s(this.hot,a,e,i,this.hot.colToProp(i),r.value,o),n.appendChild(a)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");n.push([-1,r]),t.appendChild(r)}this.samples.forEach(r=>{Ot(r.strings,r=>{const i=r.col,o=e.createElement("th");n.push([i,o]),t.appendChild(o)})}),this.table.tHead.appendChild(t),Ot(n,e=>{const[t,n]=e;this.hot.view.appendColHeader(t,n)})}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach(r=>{Ot(r.strings,r=>{const i=r.row,o=this.hot.getCellMeta(i,e),s=this.hot.getCellRenderer(o),a=t.createElement("td"),l=t.createElement("tr");a.setAttribute("ghost-table",1),s(this.hot,a,i,e,this.hot.colToProp(e),r.value,o),l.appendChild(a),n.appendChild(l)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const n=this.hot.rootDocument.createElement("col");let r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let i=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)i+=this.hot.getColWidth(o);return n.style.width=`${i}px`,n}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(a.appendChild(l),i.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(i),this.isVertical()&&o.appendChild(a),r.appendChild(o),$e(r,e),n.appendChild(r),{fragment:n,table:r,tHead:i,tBody:o,colGroup:s,tr:a,th:l}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),r=t.createElement("div");return $e(r,`htGhostTable htAutoSize ${e.trim()}`),n.appendChild(r),{fragment:n,container:r}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function yw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Sw{static get SAMPLE_COUNT(){return 3}constructor(e){yw(this,"samples",null),yw(this,"dataFactory",null),yw(this,"customSampleCount",null),yw(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Sw.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const r=new Map,{from:i,to:o}="number"===typeof n?{from:n,to:n}:n;return Zr(i,o,n=>{const i=this.generateSample(e,t,n);r.set(n,i)}),r}generateSample(e,t,n){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const r=new Map,i="row"===e?"col":"row",o=[];return Zr(t.from,t.to,t=>{const s="row"===e?this.dataFactory(n,t):this.dataFactory(t,n);if(!1===s)return;const{value:a,bundleSeed:l}=s,c="string"===typeof l&&l.length>0;let u;u=c?l:un(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${Ht(a).length}`,r.has(u)||r.set(u,{needed:this.getSampleCount(),strings:[]});const d=r.get(u);if(d.needed){(!(o.indexOf(a)>-1)||this.allowDuplicates||c)&&(d.strings.push({value:a,[i]:t}),o.push(a),d.needed-=1)}}),r}}const xw=Sw;function Rw(e,t,n){Ew(e,t),t.set(e,n)}function Ew(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kw(e,t){return e.get(Pw(e,t))}function Mw(e,t,n){return e.set(Pw(e,t),n),n}function Pw(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("modifyAutoColumnSizeSeed");const Iw="autoColumnSize";var Aw=new WeakMap,Dw=new WeakMap,Fw=new WeakMap,Ow=new WeakSet;class Nw extends vw{static get PLUGIN_KEY(){return Iw}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){var t,n;super(e),Ew(t=this,n=Ow),n.add(t),Tw(this,"ghostTable",new Cw(this.hot)),Tw(this,"samplesGenerator",new xw((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;const i=this.hot.getCellMeta(e,t);let o="";i.spanned||(o=this.hot.getDataAtCell(e,t));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),Tw(this,"inProgress",!1),Tw(this,"measuredColumns",0),Tw(this,"columnWidthsMap",new cc),Rw(this,Aw,!1),Rw(this,Dw,[]),Rw(this,Fw,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(e,t,n)=>Pw(Ow,this,zw).call(this,e,t,n))}isEnabled(){return!1!==this.hot.getSettings()[Iw]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pw(Ow,e,Bw).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pw(Ow,e,Ww).call(e,...n)}),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Pw(Ow,e,Gw).call(e,...n)}),this.addHook("beforeRender",()=>Pw(Ow,this,Vw).call(this)),this.addHook("modifyColWidth",(e,t)=>this.getColumnWidth(t,e)),this.addHook("init",()=>Pw(Ow,this,jw).call(this)),super.enablePlugin()}updatePlugin(){Mw(Fw,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>Pw(Ow,this,zw).call(this,e,t,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:t},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;Zr(r.from,r.to,e=>{let t=this.hot.toPhysicalColumn(e);null===t&&(t=e),(n||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t))&&Pw(Ow,this,_w).call(this,e,i)}),this.ghostTable.columns.length&&(Pw(Ow,this,Hw).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return wn(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:n,to:Math.min(n+Nw.CALCULATION_STEP,r)},e,t),n=n+Nw.CALCULATION_STEP+1,n<r?i=vn(o):(wn(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},e,t),n=s+1),n<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Iw];let t=Nw.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return un(e)&&(t=e.syncLimit,ge(t)?t=ti(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&"number"===typeof r&&(r=Math.max(r,xa))),r}getFirstVisibleColumn(){var e;return null!==(e=this.hot.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((e,t,n)=>{const r=kw(Dw,this).length;return(r-1<n||kw(Dw,this)[n]!==t)&&e.push(this.hot.toVisualColumn(n)),r-1<n?kw(Dw,this).push(t):kw(Dw,this)[n]=t,e},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.columnWidthsMap.setValueAtIndex(e,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Lw(e){const t={from:0,to:this.hot.countRows()-1};e.forEach(e=>{const n=this.hot.toPhysicalColumn(e);null!==n&&(this.hot._getColWidthFromSettings(n)||Pw(Ow,this,_w).call(this,e,t))}),this.ghostTable.columns.length&&(Pw(Ow,this,Hw).call(this),this.ghostTable.clean())}function _w(e,t){this.samplesGenerator.generateColumnSamples(e,t).forEach((e,t)=>this.ghostTable.addColumn(t,e))}function Hw(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,t)})},!0)}function Vw(){this.calculateVisibleColumnsWidth(),this.inProgress||(Pw(Ow,this,Lw).call(this,kw(Fw,this)),Mw(Fw,this,[]))}function Bw(e,t){t||this.recalculateAllColumnsWidth()}function Ww(e){const t=e.reduce((e,t)=>{let[,n]=t;const r=this.hot.propToCol(n);return Number.isInteger(r)&&-1===e.indexOf(r)&&e.push(r),e},[]);kw(Fw,this).push(...t)}function zw(e,t,n){let r=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function jw(){Mw(Dw,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Mw(Aw,this,!0)}function Gw(e){if(!kw(Aw,this))return;const t=e.reduce((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.col;if(Number.isInteger(r)){const t=this.hot.toVisualColumn(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);kw(Fw,this).push(...t)}const $w={horizontal:"horizontal",vertical:"vertical"};function Uw(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Kw(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yw(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("modifyAutofillRange"),ir.getSingleton().register("beforeAutofill"),ir.getSingleton().register("afterAutofill");const qw="autofill",Xw=["fillHandle"];var Qw=new WeakSet;class Jw extends vw{constructor(){super(...arguments),Uw(this,Qw),Kw(this,"addingStarted",!1),Kw(this,"mouseDownOnCellCorner",!1),Kw(this,"mouseDragOutside",!1),Kw(this,"handleDraggedCells",0),Kw(this,"directions",[]),Kw(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return qw}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[qw,...Xw]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Yw(Qw,this,eb).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Yw(Qw,this,Zw).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>Yw(Qw,this,tb).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:r,endCol:i}]),s=[],a=[],l=[];return Ot(o,e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===s.indexOf(t)&&s.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===a.indexOf(t)&&a.push(t)}),Ot(s,e=>{const t=[];Ot(a,n=>{t.push(this.hot.getCopyableData(e,n))}),l.push(t)}),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,r]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),o=i.getTopStartCorner(),s=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const a=[o.row,o.col,s.row,s.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(s.row,n),Math.max(s.col,r)],a),{directionOfDrag:c,startOfDragCoords:u,endOfDragCoords:d}=function(e,t,n){let r,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",r=n(t[0],t[1]),i=n(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",r=n(t[0],e[3]+1),i=n(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",r=n(t[0],t[1]),i=n(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",r=n(e[2]+1,t[1]),i=n(t[2],t[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}(a,l,(e,t)=>this.hot._createCellCoords(e,t));if(u&&u.row>-1&&u.col>-1){const e=this.getSelectionData(),t=i.clone(),n=this.hot._createCellRange(u,u,d),r=this.hot.runHooks("beforeAutofill",e,t,n,c);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let o=r;const s=r;if(["up","left"].indexOf(c)>-1&&(1!==s.length||0!==s[0].length))if(o=[],"up"===c){const e=d.row-u.row+1,t=e%s.length;for(let n=0;n<e;n++)o.push(s[(n+(s.length-t))%s.length])}else{const e=d.col-u.col+1,t=e%s[0].length;for(let n=0;n<s.length;n++){o.push([]);for(let r=0;r<e;r++)o[n].push(s[n][(r+(s[n].length-t))%s[n].length])}}this.hot.populateFromArray(u.row,u.col,o,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(l),this.hot.runHooks("afterAutofill",o,t,n,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let r=e;if(this.directions.includes($w.vertical)&&this.directions.includes($w.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(r=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(r=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes($w.vertical))r=this.hot._createCellCoords(e.row,n.col);else{if(!this.directions.includes($w.horizontal))return;r=this.hot._createCellCoords(n.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let r;for(let i=e[2]+1;i<n;i++){for(let r=e[1];r<=e[3];r++){if(!Wt(t[i][r]))return-1}const n=t[i][e[1]-1],o=t[i][e[3]+1];Wt(n)&&Wt(o)||(r=i)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ft(e,e=>Math.max(e,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=tt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+ut(this.hot.table),r=tt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+ct(this.hot.table);return e.clientY>n&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Yw(Qw,this,nb).call(this)),this.eventManager.addEventListener(e,"mousemove",e=>Yw(Qw,this,rb).call(this,e))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys($w),t.autoInsertRow=!0):un(e)?(Vt(e.autoInsertRow)?e.direction===$w.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Vt(e.direction)?t.directions=[e.direction]:t.directions=Object.keys($w)):"string"===typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function Zw(){this.selectAdjacent()&&this.fillIn()}function eb(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function tb(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function nb(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function rb(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ib(e,t,n){ob(e,t),t.set(e,n)}function ob(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ab(e,t,n){return e.set(cb(e,t),n),n}function lb(e,t){return e.get(cb(e,t))}function cb(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ub="autoRowSize";var db=new WeakMap,hb=new WeakMap,pb=new WeakSet;class gb extends vw{static get PLUGIN_KEY(){return ub}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){var t,n;super(e),ob(t=this,n=pb),n.add(t),sb(this,"headerHeight",null),sb(this,"ghostTable",new Cw(this.hot)),sb(this,"samplesGenerator",new xw((e,t)=>{const n=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(n)||this.hot.columnIndexMapper.isHidden(r))return!1;if(e>=0&&t>=0){if(this.hot.getCellMeta(e,t).hidden)return!1}let i;return e>=0?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i}})),sb(this,"inProgress",!1),sb(this,"measuredRows",0),sb(this,"rowHeightsMap",new cc),ib(this,db,[]),ib(this,hb,!1),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(e,t,n)=>cb(pb,this,vb).call(this,e,t,n))}isEnabled(){const e=this.hot.getSettings()[ub];return!0===e||un(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cb(pb,e,wb).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cb(pb,e,bb).call(e,...n)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cb(pb,e,yb).call(e,...n)}),this.addHook("beforeRender",()=>cb(pb,this,mb).call(this)),this.addHook("modifyRowHeight",(e,t)=>this.getRowHeight(t,e)),this.addHook("init",()=>cb(pb,this,Cb).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,n)=>cb(pb,this,vb).call(this,e,t,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:t},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}Zr(r.from,r.to,e=>{let t=this.hot.toPhysicalRow(e);if(null===t&&(t=e),n||null===this.rowHeightsMap.getValueAtIndex(t)){this.samplesGenerator.generateRowSamples(e,i).forEach((e,t)=>this.ghostTable.addRow(t,e))}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return wn(i),void(this.inProgress=!1);this.calculateRowsHeight({from:n,to:Math.min(n+gb.CALCULATION_STEP,r)},e,t),n=n+gb.CALCULATION_STEP+1,n<r?i=vn(o):(wn(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},e,t),n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[ub];let t=gb.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return un(e)&&(t=e.syncLimit,ge(t)?t=ti(n,t):t>>=0),Math.min(t,n)}getRowHeight(e,t){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let r=t;return null!==n&&n>(t||0)&&(r=n),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:n}="number"===typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{Zr(Math.min(t,n),Math.max(t,n),e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function fb(e){const t={from:0,to:this.hot.countCols()-1};e.forEach(e=>{this.samplesGenerator.generateRowSamples(e,t).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{const n=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(n,t)})},!0),this.ghostTable.clean())}function mb(){this.calculateVisibleRowsHeight(),this.inProgress||(cb(pb,this,fb).call(this,lb(db,this)),ab(db,this,[]))}function vb(e,t,n){let r=e;return n&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function wb(e,t){t||this.recalculateAllRowsHeight()}function bb(e){const t=e.reduce((e,t)=>{let[n]=t;return-1===e.indexOf(n)&&e.push(n),e},[]);lb(db,this).push(...t)}function Cb(){this.recalculateAllRowsHeight(),ab(hb,this,!0)}function yb(e){if(!lb(hb,this))return;const t=e.reduce((e,t)=>{var n;const r=null===(n=t.address)||void 0===n?void 0:n.row;if(Number.isInteger(r)){const t=this.hot.toVisualRow(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);lb(db,this).push(...t)}const Sb=new Map([["indexesSequence",{getListWithInsertedItems:nc,getListWithRemovedItems:rc}],["physicallyIndexed",{getListWithInsertedItems:ac,getListWithRemovedItems:lc}]]),xb=e=>{if(!1===Sb.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return Sb.get(e)},{getListWithInsertedItems:Rb,getListWithRemovedItems:Eb}=xb("physicallyIndexed");const Tb=class extends tc{constructor(){super(e=>e)}insert(e,t){const n=oc(this.indexedValues,t);this.indexedValues=Rb(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=Eb(this.indexedValues,e);this.indexedValues=ic(t,e),super.remove(e)}},{getListWithInsertedItems:kb,getListWithRemovedItems:Mb}=xb("physicallyIndexed");const Pb=class extends tc{constructor(){super(e=>e)}insert(e,t){this.indexedValues=kb(this.indexedValues,e,t,(e,t)=>this.getNextValue(t)),super.insert(e,t)}remove(e){this.indexedValues=Mb(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};function Ib(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Ab(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Db="bindRowsWithHeaders",Fb=new Map([["loose",Tb],["strict",Pb]]);var Ob=new WeakSet;class Nb extends vw{constructor(){super(...arguments),Ib(this,Ob),Ab(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Db}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[Db]}enablePlugin(){var e;if(this.enabled)return;const t=null!==(e=Fb.get(this.getSetting()))&&void 0!==e?e:Fb.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(Ob,this,Lb).call(this,e)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Lb(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}function _b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hb(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vb(e,t){return e.get(Wb(e,t))}function Bb(e,t,n){return e.set(Wb(e,t),n),n}function Wb(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const zb="collapsibleColumns",jb=["nestedHeaders"],Gb="collapsibleIndicator",$b=zb,Ub=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Kb=new WeakMap,Yb=new WeakSet;class qb extends vw{constructor(){var e,t;super(...arguments),_b(e=this,t=Yb),t.add(e),Hb(this,"nestedHeadersPlugin",null),Hb(this,"headerStateManager",null),function(e,t,n){_b(e,t),t.set(e,n)}(this,Kb,null)}static get PLUGIN_KEY(){return zb}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[zb,...jb]}isEnabled(){return!!this.hot.getSettings()[zb]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Bn("You need to configure the Nested Headers plugin in order to use collapsible headers."),Bb(Kb,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Wb(Yb,this,Jb).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Wb(Yb,e,Zb).call(e,...n)}),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Wb(Yb,e,Xb).call(e,...n)}),this.addHook("beforeOnCellMouseDown",(e,t,n)=>Wb(Yb,this,Qb).call(this,e,t,n)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"===typeof e?this.headerStateManager.mapState(e=>({collapsible:e.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Bb(Kb,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:i,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,n))&&void 0!==e?e:{};if(r)return i?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())},group:$b,relativeToGroup:yp,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup($b)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};Zr(0,e-1,e=>{const o=t.childNodes[e],s=n.childNodes[e],a=r?r.childNodes[e]:null;Zr(0,o.childNodes.length-1,e=>{let t=o.childNodes[e].querySelector(`.${Gb}`);i(t),s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(`.${Gb}`),i(t)),r&&a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(`.${Gb}`),i(t))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(t=>{const{collapsible:n,origColspan:r,headerLevel:i,columnIndex:o,isCollapsed:s}=t;if(!0===n&&r>1&&(s&&"expand"===e||!s&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:o}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!Ub.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=Dt(e,e=>{let{row:t}=e;return t<0});let r=n.length>0;Ot(n,e=>{var n;let{row:i,col:o}=e;const{collapsible:s,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(i,o))&&void 0!==n?n:{};if(!s||a&&"collapse"===t||!a&&"expand"===t)return r=!1,!1});const i=[],o=[];r&&Ot(n,e=>{let{row:n,col:r}=e;const{colspanCompensation:s,affectedColumns:a,rollbackModification:l}=this.headerStateManager.triggerNodeModification(t,n,r);s>0&&(o.push(...a),i.push(l))});const s=this.getCollapsedColumns();let a=[];"collapse"===t?a=function(e){const t=[];return Ot(e,e=>{-1===t.indexOf(e)&&t.push(e)}),t}([...s,...o]):"expand"===t&&(a=Dt(s,e=>!o.includes(e)));const l=Ub.get(t);if(!1===this.hot.runHooks(l.beforeHook,s,a,r))return void Ot(i,e=>{e()});this.hot.batchExecution(()=>{Ot(o,e=>{Vb(Kb,this).setValueAtIndex(this.hot.toPhysicalColumn(e),l.hideColumn)})},!0);const c=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===t&&c&&u){const{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){const n=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,r=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==n&&null!==r&&this.hot.selectCell(n,r)}}this.hot.runHooks(l.afterHook,s,a,r,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Vb(Kb,this).getHiddenIndexes()}destroy(){Bb(Kb,this,null),super.destroy()}}function Xb(e,t,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=null!==(r=this.headerStateManager.getHeaderSettings(n,e))&&void 0!==r?r:{},a=i&&o>1&&e>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=t.querySelector(`.${Gb}`);var u;(Ye(t,[Ae("")[0]]),a)?(c||(c=this.hot.rootDocument.createElement("div"),$e(c,Gb),t.querySelector("div:first-child").appendChild(c)),Ue(c,["collapsed","expanded"]),s?($e(c,"collapsed"),Ze(c,"+"),l&&Ke(t,...Ae(!1))):($e(c,"expanded"),Ze(c,"-"),l&&Ke(t,...Ae(!0))),l&&Ke(c,"aria-hidden","true")):null===(u=c)||void 0===u||u.remove()}function Qb(e,t){Ge(e.target,Gb)&&(Ge(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Ge(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Ln(e))}function Jb(){this.updatePlugin()}function Zb(e,t){t||this.updatePlugin()}function eC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tC=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class nC{constructor(e,t){eC(this,"hot",void 0),eC(this,"sortingStates",new hc),eC(this,"sortEmptyCells",false),eC(this,"indicator",true),eC(this,"headerAction",true),eC(this,"compareFunctionFactory",void 0),eC(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){un(e)&&hn(e,(e,t)=>{tC.includes(t)&&(this[t]=e)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[n]=t;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return un(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map(e=>{let[t,n]=e;return{column:this.hot.toVisualColumn(t),...n}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Vt(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function rC(e,t,n){const r=t.locale;return function(t,i){const{sortEmptyCells:o}=n;return"string"===typeof t&&(t=t.toLocaleLowerCase(r)),"string"===typeof i&&(i=i.toLocaleLowerCase(r)),t===i?dC:Wt(t)?Wt(i)?dC:o&&"asc"===e?hC:pC:Wt(i)?o&&"asc"===e?pC:hC:isNaN(t)&&!isNaN(i)?"asc"===e?pC:hC:!isNaN(t)&&isNaN(i)?"asc"===e?hC:pC:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?hC:pC:t>i?"asc"===e?pC:hC:dC)}}const iC="default";const{register:oC,getItem:sC,hasItem:aC}=ar("sorting.compareFunctionFactory"),{register:lC,getItem:cC}=ar("sorting.mainSortComparator");function uC(e){return aC(e)?sC(e):sC(iC)}oC("checkbox",function(e,t,n){const r=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Wt(s),c=Wt(a),u=l?i:s,d=c?i:a,h=u===i||u===r,p=d===i||d===r;if(!1===o){if(l&&!1===c)return pC;if(!1===l&&c)return hC}return!1===h&&p?"asc"===e?hC:pC:h&&!1===p?"asc"===e?pC:hC:!1===h&&!1===p?rC(e,t,n)(s,a):u===i&&d===r?"asc"===e?hC:pC:u===r&&d===i?"asc"===e?pC:hC:dC}}),oC("date",function(e,t,n){return SC(e,t.dateFormat,n)}),oC(iC,rC),oC("numeric",function(e,t,n){return function(t,r){const i=parseFloat(t),o=parseFloat(r),{sortEmptyCells:s}=n;if(i===o||isNaN(i)&&isNaN(o))return dC;if(s){if(Wt(t))return"asc"===e?hC:pC;if(Wt(r))return"asc"===e?pC:hC}return isNaN(i)?pC:isNaN(o)?hC:i<o?"asc"===e?hC:pC:i>o?"asc"===e?pC:hC:dC}}),oC("time",function(e,t,n){return SC(e,t.timeFormat,n)});const dC=0,hC=-1,pC=1;const gC="asc",fC="desc",mC="colHeader";function vC(e){if(e.some(e=>!1===function(e){if(!1===un(e))return!1;const{column:t,sortOrder:n}=e;return Number.isInteger(t)&&[gC,fC].includes(n)}(e)))return!1;const t=e.map(e=>{let{column:t}=e;return t});return new Set(t).size===t.length}function wC(e){if(e!==fC)return e===gC?fC:gC}function bC(e){return e.querySelector(`.${mC}`)}function CC(e,t){if(e<0||!t.parentNode)return!1;const n=t.parentNode.parentNode.childNodes;return-1===Array.from(n).indexOf(t.parentNode)-n.length}function yC(e,t,n){return-1===e&&t>=0&&!1===Hn(n)}function SC(e,t,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return dC;if(Wt(r))return Wt(i)?dC:o&&"asc"===e?hC:pC;if(Wt(i))return o&&"asc"===e?pC:hC;const s=Mt(r,t),a=Mt(i,t);return s.isValid()?a.isValid()?a.isAfter(s)?"asc"===e?hC:pC:a.isBefore(s)?"asc"===e?pC:hC:dC:hC:pC}}const xC="indicatorDisabled",RC="columnSorting",EC="sortAction",TC=new Map([[gC,"ascending"],[fC,"descending"]]);function kC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function MC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PC(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const IC="columnSorting",AC="append",DC=IC;lC(IC,function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function(n){const r=e[n],s=t[n],a=i[n],l=o[n],c=s.columnSorting;return(c.compareFunctionFactory?c.compareFunctionFactory:uC(s.type))(r,s,c)(a,l)}(0)}}),ir.getSingleton().register("beforeColumnSort"),ir.getSingleton().register("afterColumnSort");const FC=new WeakMap;var OC=new WeakSet;class NC extends vw{constructor(){super(...arguments),kC(this,OC),MC(this,"columnStatesManager",null),MC(this,"columnMetaCache",null),MC(this,"pluginKey",IC),MC(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return IC}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e,t,n=this;if(FC.has(this.hot)&&FC.get(this.hot)!==this.pluginKey)return this.hot.updateSettings({[this.pluginKey]:!1}),e=FC.get(this.hot),t=this.pluginKey,void Bn(_t`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${e}\` will work. The \`${t}\` plugin will remain disabled.`);this.enabled||(FC.set(this.hot,this.pluginKey),this.columnStatesManager=new nC(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new cc(e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(e,t)=>PC(OC,this,_C).call(this,e,t)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return PC(OC,n,VC).call(n,...t)}),this.addHook("afterOnCellMouseDown",(e,t)=>this.onAfterOnCellMouseDown(e,t)),this.addHook("afterInit",()=>PC(OC,this,LC).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return PC(OC,n,HC).call(n,...t)}),this.hot.view&&PC(OC,this,LC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const n=bC(t);!1!==CC(e,t)&&null!==n&&this.updateHeaderClasses(n)};FC.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.row&&n.col>=0},relativeToGroup:yp,position:"before",group:DC})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(DC)}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(n);!1!==this.hot.runHooks("beforeColumnSort",t,n,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new sc),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,r?n:t,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Vt(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return vC(e)&&e.every(e=>{let{column:n}=e;return n<=t&&n>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=Ft(e,e=>{let{column:t,...n}=e;return{column:this.hot.toPhysicalColumn(t),...n}}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=e=>{let{column:t,...n}=e;return{column:this.hot.toVisualColumn(t),...n}};return Vt(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Ft(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Vt(t)){const n=wC(t);return Vt(n)?{column:e,sortOrder:n}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:wC()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AC;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==n,i=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(Bt(o))return[...i.slice(0,n),...i.slice(n+1)];if(t===AC)return[...i.slice(0,n),...i.slice(n+1),o];if("replace"===t)return[...i.slice(0,n),o,...i.slice(n+1)]}return Vt(o)?i.concat(o):i}getPluginColumnConfig(e){if(un(e)){const t=e[this.pluginKey];if(un(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(r);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):Jt(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;const t=[],n=this.hot.countRows(),r=t=>Ft(e,e=>this.hot.getDataAtCell(t,e.column));for(let l=0;l<this.getNumberOfRowsToSort(n);l+=1)t.push([this.hot.toPhysicalRow(l)].concat(r(l)));const i=Ft(t,e=>e[0]);!function(e,t){const n=cC(t);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];e.sort(n(...i))}(t,this.pluginKey,Ft(e,e=>e.sortOrder),Ft(e,e=>this.getFirstCellSettings(e.column)));for(let l=t.length;l<n;l+=1)t.push([l].concat(r(l)));const o=Ft(t,e=>e[0]),s=new Map(Ft(i,(e,t)=>[e,o[t]])),a=Ft(this.hot.rowIndexMapper.getIndexesSequence(),e=>s.has(e)?s.get(e):e);this.hot.rowIndexMapper.setIndexesSequence(a)}sortBySettings(e){if(un(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||un(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Ue(e,Array.from(TC.values()).concat(EC,xC,RC)),!1!==this.enabled){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];$e(e,function(e,t,n,r){const i=[RC];if(r&&i.push(EC),!1===n)return i.push(xC),i;const o=e.getSortOrderOfColumn(t);return Vt(o)&&i.push(TC.get(o)),i}(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Vt(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Ge(e.target,mC)}onAfterOnCellMouseDown(e,t){if(!1!==yC(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));const e=this.hot.getActiveEditor(),n=this.getColumnNextConfig(t.col);null!==e&&void 0!==e&&e.isOpened()&&this.hot.getCellValidator(e.row,e.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(n)}):this.sort(n)}}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function LC(){const e=this.getAllSavedSortSettings();if(un(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function _C(e,t){const n=bC(t);if(!1===CC(e,t)||null===n)return;const r=this.getFirstCellSettings(e)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,e,i,o),this.hot.getSettings().ariaTags){const n=this.columnStatesManager.getSortOrderOfColumn(e);Ke(t,...(s=n?`${n}ending`:"none",["aria-sort",s]))}var s}function HC(e){!0===e&&this.hot.view&&PC(OC,this,LC).call(this)}function VC(e,t,n,r){!1!==yC(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function BC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WC=class{constructor(e,t){BC(this,"plugin",void 0),BC(this,"hot",void 0),BC(this,"endpoints",[]),BC(this,"settings",void 0),BC(this,"settingsType","array"),BC(this,"currentEndpoint",null),BC(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(n||"function"!==typeof this.settings)return n||(n=this.settings),Ot(n,e=>{const n={};this.assignSetting(e,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,n,"reversedRowCoords",!1),this.assignSetting(e,n,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,n,"sourceColumn",e.destinationColumn),this.assignSetting(e,n,"type","sum"),this.assignSetting(e,n,"forceNumeric",!1),this.assignSetting(e,n,"suppressDataTypeErrors",!0),this.assignSetting(e,n,"customFunction",null),this.assignSetting(e,n,"readOnly",!0),this.assignSetting(e,n,"roundFloat",!1),t.push(n)}),t;this.settingsType="function"}assignSetting(e,t,n,r){if("ranges"!==n||void 0!==e[n]){if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}else t[n]=r}resetSetupBeforeStructureAlteration(e,t,n){if("function"!==this.settingsType)return;const r=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Ot(i,i=>{"row"===r&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=n:"remove_row"===e&&(i.alterRowOffset=-1*n)),"col"===r&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=n:"remove_col"===e&&(i.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,r,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const s=e.indexOf("row")>-1?"row":"col",a=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),c=0===e.indexOf("move_row"),u=t;Ot(l,e=>{"row"===s&&e.destinationRow>=u&&(e.alterRowOffset=a*n),"col"===s&&e.destinationColumn>=u&&(e.alterColumnOffset=a*n)}),this.resetAllEndpoints(l,!c),Ot(l,c?e=>{this.extendEndpointRanges(e,u,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,r){Ot(e.ranges,e=>{e[1]&&(t>=e[0]&&t<=e[1]?n>e[1]?e[1]+=r:n<e[0]&&(e[0]-=r):n>=e[0]&&n<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,n=[],r=[];Ot(t,e=>{const t=[];if(e[1])for(let n=e[0];n<=e[1];n++)t.push(this.hot.toPhysicalRow(n));else t.push(this.hot.toPhysicalRow(e[0]));r.push(t)}),Ot(r,e=>{let t=[];Ot(e,(r,i)=>{0===i?t.push(r):e[i]!==e[i-1]+1&&(t.push(e[i-1]),n.push(t),t=[],t.push(r)),i===e.length-1&&(t.push(r),n.push(t))})}),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Ot(e.ranges,n=>{Ot(n,(r,i)=>{r>=t&&(n[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some(e=>{const t=e.alterRowOffset||0,n=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+n>=this.hot.countCols()})||(this.cellsToSetCache=[],Ot(e,e=>{this.resetEndpointValue(e,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Ot(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],Ot(e,(e,n,r)=>{`${e[2]||""}`!==`${e[3]}`&&Ot(this.getAllEndpoints(),(e,i)=>{this.hot.propToCol(r[n][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)})}),Ot(t,e=>{this.refreshEndpoint(this.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const t=this.hot.toVisualRow(e.destinationRow);if(null!==t){const n=this.hot.getCellMeta(t,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const n=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&n.readOnly===e.readOnly||(n.readOnly=e.readOnly,n.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const t=e.roundFloat;let n=0;Number.isInteger(t)&&(n=Math.min(Math.max(0,t),100)),e.result=e.result.toFixed(n)}n?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Bn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function zC(e){return null===e||void 0===e||isNaN(e)}function jC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function GC(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $C(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const UC="columnSummary";var KC=new WeakSet;class YC extends vw{constructor(){super(...arguments),jC(this,KC),GC(this,"endpoints",null)}static get PLUGIN_KEY(){return UC}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[UC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[UC],this.endpoints=new WC(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $C(KC,e,qC).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $C(KC,e,QC).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $C(KC,e,XC).call(e,...n)}),this.addHook("beforeCreateRow",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,n)),this.addHook("beforeCreateCol",(e,t,n)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,n)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,n)),this.addHook("afterCreateCol",(e,t,n)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,n)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $C(KC,e,JC).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return hn(e.ranges,n=>{t+=this.getPartialSum(n,e.sourceColumn)}),t}getPartialSum(e,t){let n=0,r=e[1]||e[0],i=null,o=0;do{if(i=this.getCellValue(r,t),i=zC(i)?null:i,null!==i){const e=(`${i}`.split(".")[1]||[]).length||1;e>o&&(o=e)}n+=i||0,r-=1}while(r>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,t){let n=null;return hn(e.ranges,r=>{const i=this.getPartialMinMax(r,e.sourceColumn,t);if(null===n&&null!==i&&(n=i),null!==i)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i)}}),null===n?"Not enough data":n}getPartialMinMax(e,t,n){let r,i=null,o=e[1]||e[0];do{if(r=this.getCellValue(o,t),r=zC(r)?null:r,null===i)i=r;else if(null!==r)switch(n){case"min":i=Math.min(i,r);break;case"max":i=Math.max(i,r)}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let n,r=0,i=e[1]||e[0];do{n=this.getCellValue(i,t),n=zC(n)?null:n,null===n&&(r+=1),i-=1}while(i>=e[0]);return r}countEntries(e){let t=0;return hn(e.ranges,n=>{const r=void 0===n[1]?1:n[1]-n[0]+1,i=this.countEmpty(n,e.sourceColumn);t+=r,t-=i}),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const n=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(null!==n&&null!==r&&(o=this.hot.getCellMeta(n,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(_t`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function qC(){this.endpoints.initEndpoints()}function XC(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function QC(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function JC(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}function ZC(e,t,n){ey(e,t),t.set(e,n)}function ey(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ty(e,t){return e.get(ry(e,t))}function ny(e,t,n){return e.set(ry(e,t),n),n}function ry(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var iy=new WeakMap,oy=new WeakMap,sy=new WeakMap,ay=new WeakSet;class ly{constructor(){var e,t;ey(e=this,t=ay),t.add(e),ZC(this,iy,!0),ZC(this,oy,null),ZC(this,sy,new ResizeObserver(e=>ry(ay,this,cy).call(this,e)))}setObservedElement(e){ny(oy,this,e)}unobserve(){ty(sy,this).unobserve(ty(oy,this))}observe(){ny(iy,this,!0),ty(sy,this).observe(ty(oy,this))}destroy(){ty(sy,this).disconnect()}}function cy(e){!ty(iy,this)&&Array.isArray(e)&&e.length?e.forEach(e=>{let{borderBoxSize:t}=e;const{inlineSize:n,blockSize:r}=t[0];this.runLocalHooks("resize",n,r)}):ny(iy,this,!1)}function uy(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function dy(e,t){return e.get(py(e,t))}function hy(e,t,n){return e.set(py(e,t),n),n}function py(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ln(ly,Zl);var gy=new WeakMap,fy=new WeakMap,my=new WeakMap,vy=new WeakMap,wy=new WeakMap,by=new WeakMap,Cy=new WeakMap;class yy{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var n=this;uy(this,gy,void 0),uy(this,fy,!1),uy(this,my,null),uy(this,vy,void 0),uy(this,wy,void 0),uy(this,by,!0),uy(this,Cy,new ly),hy(gy,this,e),hy(fy,this,t),hy(vy,this,this.createEditor()),hy(wy,this,dy(vy,this).style),dy(Cy,this).setObservedElement(this.getInputElement()),dy(Cy,this).addLocalHook("resize",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runLocalHooks("resize",...t)}),this.hide()}setPosition(e,t){dy(wy,this).left=`${e}px`,dy(wy,this).top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:ct(this.getInputElement()),height:ut(this.getInputElement())}}observeSize(){dy(Cy,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){dy(wy,this).display="block",hy(by,this,!1)}hide(){dy(Cy,this).unobserve(),dy(by,this)||(dy(wy,this).display="none"),hy(by,this,!0)}isVisible(){return"block"===dy(wy,this).display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return dy(gy,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=dy(gy,this).createElement("div"),t=dy(gy,this).createElement("textarea");return e.style.display="none",hy(my,this,dy(gy,this).createElement("div")),dy(my,this).setAttribute("dir",dy(fy,this)?"rtl":"ltr"),$e(dy(my,this),yy.CLASS_EDITOR_CONTAINER),dy(gy,this).body.appendChild(dy(my,this)),$e(e,yy.CLASS_EDITOR),$e(t,yy.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),dy(my,this).appendChild(e),e}getInputElement(){return dy(vy,this).querySelector(`.${yy.CLASS_INPUT}`)}getEditorElement(){return dy(vy,this)}destroy(){const e=dy(my,this)?dy(my,this).parentNode:null;dy(vy,this).parentNode.removeChild(dy(vy,this)),hy(vy,this,null),hy(wy,this,null),dy(Cy,this).destroy(),e&&e.removeChild(dy(my,this))}}ln(yy,Zl);const Sy=yy;function xy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ry{constructor(e){xy(this,"wasLastActionShow",!0),xy(this,"showDebounced",null),xy(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Zt(e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)},e)}destroy(){this.clearLocalHooks()}}ln(Ry,Zl);const Ey=Ry,Ty="---------";function ky(e,t){const n={};return Ot(e,e=>{e.forAll((e,r)=>{e>=0&&r>=0&&(n[e]||(n[e]=[]),n[e][r]=t(e,r))})}),n}function My(e,t,n,r,i){Ot(e,e=>{e.forAll((e,o)=>{e>=0&&o>=0&&function(e,t,n,r,i,o){const s=i(e,t);let a=r;s.className&&(a="vertical"===n?function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}(s.className,r):function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}(s.className,r));o(e,t,"className",a)}(e,o,t,n,r,i)})})}function Py(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function Iy(e,t){let n=!1;return Array.isArray(e)&&Ot(e,e=>(e.forAll((e,r)=>{if(e>=0&&r>=0&&t(e,r))return n=!0,!1}),n)),n}function Ay(e,t){const n={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:e}=t.defaultView,{top:r,left:i}=e.getBoundingClientRect();n.top=r,n.left=i}return n}function Dy(e,t,n){Fy(e,t),t.set(e,n)}function Fy(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oy(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ny(e,t,n){return e.set(_y(e,t),n),n}function Ly(e,t){return e.get(_y(e,t))}function _y(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const Hy="comments",Vy="comment",By="value",Wy="style",zy="readOnly",jy=Hy,Gy=`plugin:${Hy}`;var $y=new WeakMap,Uy=new WeakMap,Ky=new WeakMap,Yy=new WeakMap,qy=new WeakMap,Xy=new WeakMap,Qy=new WeakSet;class Jy extends vw{constructor(){var e,t;super(...arguments),Fy(e=this,t=Qy),t.add(e),Oy(this,"range",{}),Dy(this,$y,null),Dy(this,Uy,null),Dy(this,Ky,!1),Dy(this,Yy,!1),Dy(this,qy,null),Dy(this,Xy,"")}static get PLUGIN_KEY(){return Hy}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[Hy]}enablePlugin(){var e=this;this.enabled||(Ly($y,this)||(Ny($y,this,new Sy(this.hot.rootDocument,this.hot.isRtl())),Ly($y,this).addLocalHook("resize",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _y(Qy,e,sS).call(e,...n)})),Ly(Uy,this)||Ny(Uy,this,new Ey(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,n,r,i,o)=>_y(Qy,this,rS).call(this,e,o)),this.addHook("afterScroll",()=>_y(Qy,this,lS).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>_y(Qy,this,aS).call(this,e)),this.addHook("beforeCompositionStart",e=>_y(Qy,this,aS).call(this,e)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return _y(Qy,e,cS).call(e,...n)}),Ly(Uy,this).addLocalHook("hide",()=>this.hide()),Ly(Uy,this).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ly(Uy,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),n=e.addContext(Gy);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const t=this.hot.getSelectedRangeLast();Ny(Yy,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(Gy),this.hot._registerTimeout(()=>{Ny(Yy,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()},group:jy}),n.addShortcut({keys:[["Escape"]],callback:()=>{Ly($y,this).setValue(Ly(Xy,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ly($y,this).isVisible()&&Ly($y,this).isFocused(),group:jy}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ly($y,this).isVisible()&&Ly($y,this).isFocused(),group:jy}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Ly($y,this).setValue(Ly($y,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:jy})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jy)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",e=>_y(Qy,this,tS).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>_y(Qy,this,Zy).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>_y(Qy,this,nS).call(this)),this.eventManager.addEventListener(t,"focus",()=>_y(Qy,this,oS).call(this)),this.eventManager.addEventListener(t,"blur",()=>_y(Qy,this,iS).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",e=>_y(Qy,this,eS).call(this,e))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=He(e.target,"TD","TBODY");return!!(t&&Ge(t,"htCommentCell")&&He(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=Ly($y,this).getValue();let n="";null!==e&&void 0!==e?n=e:null!==t&&void 0!==t&&(n=t);const r=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(r,i,{[By]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Vy),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,By)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,By)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:n}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ly(Uy,this).cancelHiding(),Ly($y,this).setValue(null!==(e=r[Vy]?r[Vy][By]:null)&&void 0!==e?e:""),Ly($y,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){Ly($y,this).hide()}refreshEditor(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&(!this.range.from||!Ly($y,this).isVisible()))return;const{rowIndexMapper:e,columnIndexMapper:t}=this.hot,{row:n,col:r}=this.range.from;let i=e.getRenderableFromVisualIndex(n),o=t.getRenderableFromVisualIndex(r);const s=null===i;Ly($y,this).setPosition(0,0),null===i&&(i=e.getRenderableFromVisualIndex(e.getNearestNotHiddenIndex(n,-1))),null===o&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(r,-1)));const a=null===i,l=null===o;i=null!==i&&void 0!==i?i:0,o=null!==o&&void 0!==o?o:0;const{rootWindow:c,view:{_wt:u}}=this.hot,{wtTable:d}=u,h=u.getCell({row:i,col:o},!0),p=this.getCommentMeta(n,r,Wy);p?Ly($y,this).setSize(p.width,p.height):Ly($y,this).resetSize();const g=l?0:d.getColumnWidth(o),f=s&&!a?ut(h):0,{left:m,top:v,width:w,height:b}=h.getBoundingClientRect(),{width:C,height:y}=Ly($y,this).getSize(),{innerWidth:S,innerHeight:x}=this.hot.rootWindow,R=this.hot.rootDocument.documentElement,E=vt(this.hot.rootDocument),T=wt(this.hot.rootWindow)?E:0,k=bt(this.hot.rootWindow)?E:0;let M=m+c.scrollX+g,P=v+c.scrollY+f;this.hot.isRtl()&&(M-=C+g),this.hot.isLtr()&&m+w+C>S-T?M=m+c.scrollX-C-1:this.hot.isRtl()&&M<-(R.scrollWidth-R.clientWidth)&&(M=m+c.scrollX+g+1),v+y>x-k&&(P-=y-b+1),Ly($y,this).setPosition(M,P),Ly($y,this).setReadOnlyState(this.getCommentMeta(n,r,zy)),Ly($y,this).observeSize()}focusEditor(){Ly($y,this).focus()}updateCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t)[Vy];let i;r?(i=sn(r),on(i,n)):i=n,this.hot.setCellMeta(e,t,Vy,i)}getCommentMeta(e,t,n){const r=this.hot.getCellMeta(e,t);if(r[Vy])return r[Vy][n]}addToContextMenu(e){var t;e.items.push({name:Ty},(t=this,{key:"commentsAddEdit",name(){var e;const n=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==n&&void 0!==n&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(cu):this.getTranslatedPhrase(lu)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(uu)},callback(){this.getSelectedRangeLast().forAll((t,n)=>{t>=0&&n>=0&&e.removeCommentAtCell(t,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(du),n=Iy(this.getSelectedRange(),(t,n)=>e.getCommentMeta(t,n,zy));return n?Py(t):t},callback(){this.getSelectedRangeLast().forAll((t,n)=>{if(t>=0&&n>=0){const r=!!e.getCommentMeta(t,n,zy);e.updateCommentMeta(t,n,{[zy]:!r})}})},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getEditorInputElement(){return Ly($y,this).getInputElement()}destroy(){var e,t;null===(e=Ly($y,this))||void 0===e||e.destroy(),null===(t=Ly(Uy,this))||void 0===t||t.destroy(),super.destroy()}}function Zy(e){if(this.hot.view&&this.hot.view._wt&&!Ly(Ky,this)&&!this.targetIsCommentTextArea(e)){const t=He(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function eS(e){e.stopPropagation()}function tS(e){const{rootDocument:t}=this.hot;if(!(Ly(Ky,this)||Ly($y,this).isFocused()||Ge(e.target,"wtBorder")||Ly(qy,this)===e.target)&&Ly($y,this))if(Ny(qy,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));Ly(Uy,this).show(t)}else Be(e.target,t)&&!this.targetIsCommentTextArea(e)&&Ly(Uy,this).hide()}function nS(){Ny(Ky,this,!1)}function rS(e,t){t[Vy]&&t[Vy][By]&&$e(e,t.commentedCellClassName)}function iS(){Ny(Xy,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function oS(){Ny(Xy,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Gy)}function sS(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Wy]:{width:e,height:t}})}function aS(e){Ly($y,this).isFocused()&&Ln(e)}function lS(){Ly(Yy,this)||this.hide()}function cS(){const e=Ly($y,this).getEditorElement();Ue(e,/ht-theme-.*/g),$e(e,this.hot.getCurrentThemeName())}function uS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dS{constructor(e){uS(this,"hot",void 0),uS(this,"commands",{}),uS(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=e.split(":"),o=i[0],s=2===i.length?i[1]:null;let a=this.commands[o];if(!a)throw new Error(`Menu command '${o}' not exists.`);if(s&&a.submenu&&(a=function(e,t){let n;return Ot(t,t=>{const r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1}),n}(s,a.submenu.items)),!0===a.disabled)return;if("function"===typeof a.disabled&&!0===a.disabled.call(this.hot))return;if(mn(a,"submenu"))return;const l=[];"function"===typeof a.callback&&l.push(a.callback),"function"===typeof this.commonCallback&&l.push(this.commonCallback),n.unshift(i.join(":")),Ot(l,e=>e.apply(this.hot,n))}}const hS="alignment";const pS="clear_column";const gS="col_left";const fS="col_right";const mS="make_read_only";const vS="redo";const wS="remove_col";const bS="remove_row";const CS="row_above";const yS="row_below";const SS="no_items";const xS="undo";const RS=[CS,yS,gS,fS,pS,bS,wS,xS,vS,mS,hS,Ty,SS],ES={[Ty]:function(){return{name:Ty}},[SS]:function(){return{key:SS,name(){return this.getTranslatedPhrase(zc)},disabled:!0,isCommand:!1}},[CS]:function(){return{key:CS,name(){return this.getTranslatedPhrase(jc)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[yS]:function(){return{key:yS,name(){return this.getTranslatedPhrase(Gc)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[gS]:function(){return{key:gS,name(){return this.getTranslatedPhrase($c)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[fS]:function(){return{key:fS,name(){return this.getTranslatedPhrase(Uc)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[pS]:function(){return{key:pS,name(){return this.getTranslatedPhrase(Jc)},callback(e,t){const n=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let t=!1;return e.forAll((e,n)=>{if(e<0||n<0)return!0;const{readOnly:r}=this.getCellMeta(e,n);return!!r||(t=!0,!1)}),!t}}},[bS]:function(){return{key:bS,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[n,,r]=e[0];n-r!==0&&(t=1)}return this.getTranslatedPhrase(Kc,t)},callback(){this.alter("remove_row",function(e){const t=wh(e.getSelected());if(0===t||1===t)return[];const n=bh(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Ot(e.getSelected(),e=>{const{from:t,to:i}=n(e),o=Math.max(t.row,0),s=i.row-o+1;Ot(Array.from(new Array(s),(e,t)=>o+t),e=>{r.has(e)||r.add(e)})});const i=At(Array.from(r).sort((e,t)=>e-t),(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return i}(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[wS]:function(){return{key:wS,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,n,,r]=e[0];n-r!==0&&(t=1)}return this.getTranslatedPhrase(Yc,t)},callback(){this.alter("remove_col",function(e){const t=wh(e.getSelected());if(0===t||1===t)return[];const n=bh(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;Ot(e.getSelected(),e=>{const{from:t,to:i}=n(e),o=Math.max(t.col,0),s=i.col-o+1;Ot(Array.from(new Array(s),(e,t)=>o+t),e=>{r.has(e)||r.add(e)})});const i=At(Array.from(r).sort((e,t)=>e-t),(e,t,n,r)=>(0!==n&&t===r[n-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[]);return i}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[xS]:function(){return{key:xS,name(){return this.getTranslatedPhrase(qc)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[vS]:function(){return{key:vS,name(){return this.getTranslatedPhrase(Xc)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[mS]:function(){return{key:mS,checkable:!0,ariaChecked(){const e=Iy(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return e},ariaLabel(){return this.getTranslatedPhrase(Qc)},name(){let e=this.getTranslatedPhrase(Qc);const t=Iy(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly);return t&&(e=Py(e)),e},callback(){const e=this.getSelectedRange(),t=Iy(e,(e,t)=>this.getCellMeta(e,t).readOnly);Ot(e,e=>{e.forAll((e,n)=>{e>=0&&n>=0&&this.setCellMeta(e,n,"readOnly",!t)})}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[hS]:function(){return{key:hS,name(){return this.getTranslatedPhrase(hu)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${hS}:left`,name(){return this.getTranslatedPhrase(pu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:`${hS}:center`,name(){return this.getTranslatedPhrase(gu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:`${hS}:right`,name(){return this.getTranslatedPhrase(fu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:`${hS}:justify`,name(){return this.getTranslatedPhrase(mu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{name:Ty},{key:`${hS}:top`,name(){return this.getTranslatedPhrase(vu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:`${hS}:middle`,name(){return this.getTranslatedPhrase(wu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1},{key:`${hS}:bottom`,name(){return this.getTranslatedPhrase(bu)},callback(){const e=this.getSelectedRange(),t=ky(e,(e,t)=>this.getCellMeta(e,t).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,n,r),My(e,n,r,(e,t)=>this.getCellMeta(e,t),(e,t,n,r)=>this.setCellMeta(e,t,n,r)),this.render()},disabled:!1}]}}}};function TS(){const e={};return hn(ES,(t,n)=>{e[n]=t()}),e}function kS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class MS{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;kS(this,"hot",void 0),kS(this,"predefinedItems",TS()),kS(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,hn(e,(e,n)=>{let r="";e.name===Ty?(t[Ty]=e,r=Ty):isNaN(parseInt(n,10))?(e.key=void 0===e.key?n:e.key,t[n]=e,r=e.key):(t[e.key]=e,r=e.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);un(i)?hn(i,(e,t)=>{let i=n["string"===typeof e?e:t];i||(i=e),un(e)?rn(i,e):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),r.push(i)}):Ot(i,(e,t)=>{let i=n[e];!i&&RS.indexOf(e)>=0||(i||(i={name:e,key:`${t}`}),un(e)&&rn(i,e),void 0===i.key&&(i.key=t),r.push(i))});return r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function PS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class IS{constructor(e,t){PS(this,"top",void 0),PS(this,"topRelative",void 0),PS(this,"left",void 0),PS(this,"leftRelative",void 0),PS(this,"scrollTop",void 0),PS(this,"scrollLeft",void 0),PS(this,"cellHeight",void 0),PS(this,"cellWidth",void 0);const n=t.scrollY,r=t.scrollX;let i,o,s,a,l,c;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),s=parseInt(e.left,10),l=e.height||0,c=e.width||0,o=i,a=s,i+=n,s+=r):"event"===this.type&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),l=e.target.clientHeight,c=e.target.clientWidth,o=i-n,a=s-r),this.top=i,this.topRelative=o,this.left=s,this.leftRelative=a,this.scrollTop=n,this.scrollLeft=r,this.cellHeight=l,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function AS(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function DS(e,t){return e.get(OS(e,t))}function FS(e,t,n){return e.set(OS(e,t),n),n}function OS(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var NS=new WeakMap,LS=new WeakMap,_S=new WeakMap,HS=new WeakMap,VS=new WeakMap;class BS{constructor(e){AS(this,NS,void 0),AS(this,LS,void 0),AS(this,_S,void 0),AS(this,HS,!1),AS(this,VS,{above:0,below:0,left:0,right:0}),FS(HS,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return DS(VS,this)[e]=t,this}setElement(e){return FS(NS,this,e),this}setParentElement(e){return FS(LS,this,e),this}updatePosition(e){FS(_S,this,new IS(e,DS(NS,this).ownerDocument.defaultView)),DS(HS,this)?(DS(_S,this).fitsBelow(DS(NS,this))?this.setPositionBelowCursor():DS(_S,this).fitsAbove(DS(NS,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===DS(NS,this).dir?DS(_S,this).fitsOnLeft(DS(NS,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():DS(_S,this).fitsOnRight(DS(NS,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=DS(VS,this).above+DS(_S,this).top-DS(NS,this).offsetHeight;if(DS(LS,this)){const t=DS(LS,this).ownerDocument.defaultView.getComputedStyle(DS(LS,this).querySelector(".ht_master")),n=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=DS(_S,this).top+DS(_S,this).cellHeight-DS(NS,this).scrollHeight+n+r}DS(NS,this).style.top=`${e}px`}setPositionBelowCursor(){let e=DS(VS,this).below+DS(_S,this).top+1;if(DS(LS,this)){const t=DS(LS,this).ownerDocument.defaultView.getComputedStyle(DS(LS,this).querySelector(".ht_master")),n=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=DS(_S,this).top-n-r-1}DS(NS,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=DS(_S,this).left;if(DS(LS,this)){const t=DS(LS,this).ownerDocument.defaultView,n=Number.parseInt(t.getComputedStyle(DS(LS,this).querySelector(".htCore")).borderRightWidth,10);e+=DS(_S,this).cellWidth+n}else e+=DS(VS,this).right;DS(NS,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=DS(VS,this).left+DS(_S,this).left-DS(NS,this).offsetWidth;if(DS(LS,this)){const t=DS(LS,this).ownerDocument.defaultView;e-=Number.parseInt(t.getComputedStyle(DS(LS,this).querySelector(".htCore")).borderLeftWidth,10)}DS(NS,this).style.left=`${e}px`}}function WS(e){let{initialPage:t=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=e;const o=new Set;let s=ni(t,-1,l()-1);function a(e,t){const n=l()-1;if(e<0&&(e=n),e>n&&(e=0),o.has(e))return-1;o.add(e);return!1===r(e,!1)&&(e=a(1===t?++e:--e,t)),e}function l(){return Math.max(n(),0)}return{setCurrentPage:function(e){e>-1&&e<l()&&!1!==r(e,!0)&&(s=e)},getCurrentPage:function(){return s},toFirstItem:function(){l()>0&&(o.clear(),s=a(0,1))},toLastItem:function(){l()>0&&(o.clear(),s=a(l()-1,-1))},toNextItem:function(){l()>0&&(o.clear(),s=a(++s,1))},toPreviousItem:function(){l()>0&&(o.clear(),s=a(--s,-1))},getSize:l,clear:function(){o.clear(),s=t,i()}}}function zS(e){return mn(e,"submenu")}function jS(e){return new RegExp(Ty,"i").test(e.name)}function GS(e,t){return!0===e.disabled||"function"===typeof e.disabled&&!0===e.disabled.call(t)}function $S(e){return mn(e,"disableSelection")}function US(e,t){const n=e.slice(0);for(let r=0;r<n.length&&n[r].name===t;)n.shift();return n}function KS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ty,n=e.slice(0);return n=US(n,t),n=function(e,t){let n=e.slice(0);return n.reverse(),n=US(n,t),n.reverse(),n}(n,t),n=function(e){const t=[];return Ot(e,(e,n)=>{n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)}),t}(n),n}function YS(e){return WS({size:()=>e.countRows(),onItemSelect(t,n){const r=e.getCell(t,0);if(!r||function(e){return Ge(e,"htSeparator")}(r)||function(e){return Ge(e,"htDisabled")}(r)||function(e){return Ge(e,"htSelectionDisabled")}(r))return!1;e.selectCell(t,0,...n?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}const qS="menu",XS=qS;function QS(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function JS(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZS(e,t,n){return e.set(tx(e,t),n),n}function ex(e,t){return e.get(tx(e,t))}function tx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nx=new WeakMap,rx=new WeakMap,ix=new WeakMap;class ox{get tableBorderWidth(){return void 0===ex(ix,this)&&this.hotMenu&&ZS(ix,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),ex(ix,this)}constructor(e,t){var n=this;JS(this,"hot",void 0),JS(this,"options",void 0),JS(this,"eventManager",new Cr(this)),JS(this,"container",void 0),JS(this,"positioner",void 0),JS(this,"hotMenu",null),JS(this,"hotSubMenus",{}),JS(this,"parentMenu",void 0),JS(this,"menuItems",null),JS(this,"origOutsideClickDeselects",null),QS(this,nx,void 0),QS(this,rx,void 0),QS(this,ix,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new BS(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.parentMenu.runLocalHooks("afterSelectionChange",...t)}),this.hot.addHook("afterSetTheme",(e,t)=>{var n;t||(null===(n=this.hotMenu)||void 0===n||n.useTheme(e))})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"touchstart",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"contextmenu",e=>this.onDocumentContextMenu(e)),e=_e(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ex(nx,this)}getKeyboardShortcutsCtrl(){return ex(rx,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Zt(e=>this.openSubMenu(e),300),t=this.options.minWidth||215;let n=!1,r=Dt(this.menuItems,e=>(e.key===SS&&(n=!0),function(e,t){return!e.hidden||!("function"===typeof e.hidden&&e.hidden.call(t))}(e,this.hot)));if(r.length<1&&!n)r.push(TS()[SS]);else if(0===r.length)return;r=KS(r,Ty);let i=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>Vt(e)&&e<t?t:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(s=this.hot,(e,t,n,r,i,o)=>{const a=e.getSourceDataAtRow(n),l=s.rootDocument.createElement("div"),c="function"===typeof o?o.call(s):o,u="function"===typeof a.ariaLabel?a.ariaLabel.call(s):a.ariaLabel,d="function"===typeof a.ariaChecked?a.ariaChecked.call(s):a.ariaChecked;if(Xe(t),$e(l,"htItemWrapper"),s.getSettings().ariaTags){const e=!GS(a,s)&&!$S(a)&&!jS(a);Ke(t,[...(h=a,!0===h.checkable?[["role","menuitemcheckbox"],Ee(u),De(d)]:[["role","menuitem"],Ee(c)]),...e?[we(-1)]:[],...GS(a,s)?[["aria-disabled","true"]]:[],...zS(a)?[Ae(!1)]:[]])}var h;t.className="",t.appendChild(l),jS(a)?$e(t,"htSeparator"):"function"===typeof a.renderer?($e(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,n,r,i,c))):Je(l,c),GS(a,s)?$e(t,"htDisabled"):$S(a)?$e(t,"htSelectionDisabled"):zS(a)&&$e(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(e,t)=>{ex(nx,this).setCurrentPage(t.row)},afterOnCellMouseOver:(t,n)=>{this.isAllSubMenusClosed()?e(n.row):this.openSubMenu(n.row)},afterOnCellContextMenu:e=>{e.preventDefault(),In()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,n,r,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{In()&&Hn(e)||!i||!this.hasSelectedItem()||(kn()||Pn()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var s;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),ZS(nx,this,YS(this.hotMenu)),ZS(rx,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=[];function r(e,t){s(t).addShortcuts(e,{group:qS})}function i(e,t){const i=s(t);e.forEach(e=>{let{keys:t}=e;t.forEach(e=>i.removeShortcutsByKeys(e))}),n.push({shortcuts:e,contextName:t}),r(e,t)}function o(e){return e?`${XS}:${e}`:XS}function s(t){var n;const r=e.hotMenu.getShortcutManager(),i=o(t);return null!==(n=r.getContext(i))&&void 0!==n?n:r.addContext(i)}return r(function(e){const{hot:t,hotMenu:n}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,r)=>{const i=t.getSettings(),o="function"===typeof i.tabMoves?i.tabMoves(n):i.tabMoves;r.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[[t.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const t=n.getSelectedLast();if(t){const n=e.openSubMenu(t[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[[t.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{const r=n.getSelectedLast();r&&(n.getSourceDataAtRow(r[0]).submenu?e.openSubMenu(r[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(-n.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedLast()?n.selection.transformStart(n.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach(e=>{let{shortcuts:t,contextName:n}=e;i(t,n)}),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...n]},getContext:s,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),ex(rx,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(ex(nx,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const e=this.parentMenu.hotMenu.getSelectedLast();if(e){Ke(this.parentMenu.hotMenu.getCell(e[0],0),[Ae(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return Ge(e,"htSubmenu")}(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),r=new ox(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=r,this.hot.getSettings().ariaTags&&Ke(t,[Ae(!0)]),r}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];if(n){n.destroy(),delete this.hotSubMenus[t.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ke(r,[Ae(!1)])}}closeAllSubMenus(){Ot(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),r=n?function(e){return Ft(e,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}(n):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}isCommandPassive(e){return!1===e.isCommand||jS(e)||GS(e,this.hot)||zS(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=t.hider.style,i=t.holder.style,o=parseInt(r.width,10),s=At(n,(e,t,n)=>{const r=this.hotMenu.getCell(n,0)?ut(this.hotMenu.getCell(n,0)):0;return e+(t.name===Ty?1:r)},0);e.isClassicTheme()?(i.width=`${o+3}px`,i.height=`${s+3}px`):(i.width=`${o}px`,i.height=`${s}px`),r.height=i.height}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let n,r=e;return r&&(Jt(r)&&(r=r.call(this.hot),r=null===r||Bt(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,n=t.querySelector(`.${this.options.className}.${r}`)),n||(n=t.createElement("div"),$e(n,`htMenu handsontable ${this.options.className}`),r&&$e(n,r),this.options.container.appendChild(n)),n}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Ke(this.hotMenu.rootElement,[["role","menu"],we(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Be(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Be(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ge(e.target,"htCore")&&Be(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function sx(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ax(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ln(ox,Zl);const cx="contextMenu",ux=cx;ir.getSingleton().register("afterContextMenuDefaultOptions"),ir.getSingleton().register("beforeContextMenuShow"),ir.getSingleton().register("afterContextMenuShow"),ir.getSingleton().register("afterContextMenuHide"),ir.getSingleton().register("afterContextMenuExecute");var dx=new WeakSet;class hx extends vw{constructor(){super(...arguments),sx(this,dx),ax(this,"commandExecutor",new dS(this.hot)),ax(this,"itemsFactory",null),ax(this,"menu",null)}static get PLUGIN_KEY(){return cx}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[CS,yS,Ty,gS,fS,Ty,bS,wS,Ty,xS,vS,Ty,mS,Ty,hS]}isEnabled(){return!!this.hot.getSettings()[cx]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[cx];"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new ox(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>lx(dx,this,gx).call(this)),this.menu.addLocalHook("afterOpen",()=>lx(dx,this,fx).call(this)),this.menu.addLocalHook("afterClose",()=>lx(dx,this,mx).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)}),this.addHook("afterOnCellContextMenu",e=>lx(dx,this,px).call(this,e)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=Ay(this.menu.container,this.hot.rootDocument);this.open({left:t.left+n.left,top:t.top+n.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:ux})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ux)}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(t=this.menu)&&void 0!==t&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();const r=this.menu.tableBorderWidth>0;hn(n,(e,t)=>{const n=["below","right"].includes(t)?e+1:e-1;this.menu.setOffset(t,r?e:n)}),this.menu.setPosition(e)}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new MS(this.hot,hx.DEFAULT_ITEMS);const e=this.hot.getSettings()[cx],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),Ot(n,e=>this.commandExecutor.registerCommand(e.key,e))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function px(e){const t=this.hot.getSettings(),n=t.rowHeaders,r=t.colHeaders;const i=e.target;if(this.close(),Ge(i,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!n&&!r&&!function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)&&(!Ge(i,"current")||!Ge(i,"wtBorder")))return;const o=Ay(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function gx(){this.hot.runHooks("beforeContextMenuShow",this)}function fx(){this.hot.runHooks("afterContextMenuShow",this)}function mx(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}hx.SEPARATOR={name:Ty};class vx{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class wx{constructor(){this.clipboardData=new vx}preventDefault(){}composedPath(){return[]}}function bx(e,t,n){Cx(e,t),t.set(e,n)}function Cx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yx(e,t){return e.get(xx(e,t))}function Sx(e,t,n){return e.set(xx(e,t),n),n}function xx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Rx=new WeakMap,Ex=new WeakMap,Tx=new WeakMap,kx=new WeakMap,Mx=new WeakMap,Px=new WeakMap,Ix=new WeakSet;class Ax{constructor(e){let{countRows:t,countColumns:n,rowsLimit:r,columnsLimit:i,countColumnHeaders:o}=e;var s,a;Cx(s=this,a=Ix),a.add(s),bx(this,Rx,void 0),bx(this,Ex,void 0),bx(this,Tx,void 0),bx(this,kx,void 0),bx(this,Mx,void 0),bx(this,Px,void 0),Sx(Ex,this,t),Sx(Tx,this,n),Sx(kx,this,r),Sx(Mx,this,i),Sx(Px,this,o)}setSelectedRange(e){Sx(Rx,this,e)}getCellsRange(){if(0===yx(Ex,this).call(this)||0===yx(Tx,this).call(this))return null;const{row:e,col:t}=yx(Rx,this).getTopStartCorner(),{row:n,col:r}=yx(Rx,this).getBottomEndCorner(),i=xx(Ix,this,Fx).call(this,e,n),o=xx(Ix,this,Dx).call(this,t,r);return{isRangeTrimmed:n!==i||r!==o,startRow:e,startCol:t,endRow:i,endCol:o}}getMostBottomColumnHeadersRange(){if(0===yx(Tx,this).call(this)||0===yx(Px,this).call(this))return null;const{col:e}=yx(Rx,this).getTopStartCorner(),{col:t}=yx(Rx,this).getBottomEndCorner(),n=xx(Ix,this,Dx).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(0===yx(Tx,this).call(this)||0===yx(Px,this).call(this))return null;const{col:e}=yx(Rx,this).getTopStartCorner(),{col:t}=yx(Rx,this).getBottomEndCorner(),n=xx(Ix,this,Dx).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-yx(Px,this).call(this),startCol:e,endRow:-1,endCol:n}}}function Dx(e,t){return Math.min(t,Math.max(e+yx(Mx,this).call(this)-1,e))}function Fx(e,t){return Math.min(t,Math.max(e+yx(kx,this).call(this)-1,e))}function Ox(e){const t=[],n=[];return Ot(e,e=>{Zr(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),e=>{-1===t.indexOf(e)&&t.push(e)});Zr(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),e=>{-1===n.indexOf(e)&&n.push(e)})}),{rows:t,columns:n}}function Nx(e,t,n){Lx(e,t),t.set(e,n)}function Lx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hx(e,t){return e.get(Bx(e,t))}function Vx(e,t,n){return e.set(Bx(e,t),n),n}function Bx(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("afterCopyLimit"),ir.getSingleton().register("modifyCopyableRange"),ir.getSingleton().register("beforeCut"),ir.getSingleton().register("afterCut"),ir.getSingleton().register("beforePaste"),ir.getSingleton().register("afterPaste"),ir.getSingleton().register("beforeCopy"),ir.getSingleton().register("afterCopy");const Wx="copyPaste",zx=["fragmentSelection"],jx=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Gx=new WeakMap,$x=new WeakMap,Ux=new WeakMap,Kx=new WeakMap,Yx=new WeakMap,qx=new WeakMap,Xx=new WeakMap,Qx=new WeakMap,Jx=new WeakSet;class Zx extends vw{constructor(){var e,t;super(...arguments),Lx(e=this,t=Jx),t.add(e),_x(this,"columnsLimit",1/0),_x(this,"rowsLimit",1/0),_x(this,"pasteMode","overwrite"),_x(this,"uiContainer",this.hot.rootDocument.body),Nx(this,Gx,!1),Nx(this,$x,!1),Nx(this,Ux,!1),Nx(this,Kx,"cells-only"),Nx(this,Yx,!1),Nx(this,qx,!1),Nx(this,Xx,new Ax({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Nx(this,Qx,!1),_x(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Wx}static get SETTING_KEYS(){return[Wx,...zx]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Wx]}enablePlugin(){var e,t,n=this;this.enabled||(this.pasteMode=null!==(e=this.getSetting("pasteMode"))&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Vx(Gx,this,this.getSetting("copyColumnHeaders")),Vx($x,this,this.getSetting("copyColumnGroupHeaders")),Vx(Ux,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(t=this.getSetting("uiContainer"))&&void 0!==t?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",e=>Bx(Jx,this,iR).call(this,e)),this.addHook("afterSelection",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Bx(Jx,n,oR).call(n,...t)}),this.addHook("afterSelectionEnd",()=>Bx(Jx,this,sR).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Tn()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Bx(Jx,n,aR).call(n,...t)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Bx(Jx,n,lR).call(n,...t)}),this.addHook("afterSelection",()=>Bx(Jx,this,cR).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){Vx(Kx,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),Vx(Yx,this,!0),Bx(Jx,this,eR).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Vx(qx,this,!0),Bx(Jx,this,eR).call(this,"cut")}getRangedCopyableData(e){return hp(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:r}=Ox(e);return Ot(n,e=>{const n=[];Ot(r,t=>{e<0?n.push(this.hot.getColHeader(t,e)):n.push(this.hot.getCopyableData(e,t))}),t.push(n)}),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const n=new wx;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);Hx(Xx,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===Hx(Kx,this)?t.set("headers",Hx(Xx,this).getMostBottomColumnHeadersRange()):("with-column-headers"===Hx(Kx,this)?t.set("headers",Hx(Xx,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===Hx(Kx,this)&&t.set("headers",Hx(Xx,this).getAllColumnHeadersRange()),t.set("cells",Hx(Xx,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(e=>null!==e).map(e=>{let{startRow:t,startCol:n,endRow:r,endCol:i}=e;return{startRow:t,startCol:n,endRow:r,endCol:i}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(null!==n&&n.isRangeTrimmed){const{startRow:e,startCol:t,endRow:r,endCol:i}=n;this.hot.runHooks("afterCopyLimit",r-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,r=e[0].length,i=[],{row:o,col:s}=t.getTopStartCorner(),{row:a,col:l}=t.getBottomEndCorner();let c=o,u=s,d=o,h=s;for(;i.length<n||c<=a;){const{skipRowOnPaste:t,visualRow:a}=this.hot.getCellMeta(c,s);if(c=a+1,!0===t)continue;d=a,u=s;const p=[],g=i.length%n;for(;p.length<r||u<=l;){const{skipColumnOnPaste:t,visualCol:n}=this.hot.getCellMeta(o,u);if(u=n+1,!0===t)continue;h=n;const i=p.length%r;p.push(e[g][i])}i.push(p)}return Vx(Qx,this,!0),this.hot.populateFromArray(o,s,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,d,h]}onCopy(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Hx(Yx,this)||this.isEditorOpened()||kt(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!Le(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vx(Yx,this,!1);const i=this.getRangedData(this.copyableRanges),o=Bx(Jx,this,tR).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",i,this.copyableRanges,o)){const t=hp(i);if(e&&e.clipboardData){const n=Xr(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[jx,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.runHooks("afterCopy",i,this.copyableRanges,o)}Vx(Kx,this,"cells-only")}onCut(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Hx(qx,this)||this.isEditorOpened()||kt(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!Le(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Vx(qx,this,!1);const i=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",i,this.copyableRanges)){const t=hp(i);if(e&&e.clipboardData){const n=Xr(i,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[jx,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",i,this.copyableRanges)}}onPaste(e){const t=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),r=null===t||void 0===t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||kt(t)&&(r&&t!==n||!r&&t!==this.hot.rootDocument.body&&!Le(t,this.hot.rootElement)))return;let i;if(e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){const t=ve(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(t&&/(<table)|(<TABLE)/g.test(t)){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const n={},r=t.createDocumentFragment(),i=t.createElement("div");r.appendChild(i);let o=e;if("string"===typeof o){const e=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,e=>{const t=e.match(/<td\b[^>]*?>/g)[0];return`${t}${e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`});i.insertAdjacentHTML("afterbegin",`${e}`),o=i.querySelector("table")}if(!o||!function(e){return"TABLE"===(e&&e.nodeName||"")}(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=null!==o.querySelector("tbody th"),l=o.querySelector("tr"),c=l?Array.from(l.cells).reduce((e,t)=>e+t.colSpan,0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let h=!1,p=0,g=0;if(o.tHead){const e=Array.from(o.tHead.rows).filter(e=>{const t=null!==e.querySelector("td");return t&&d.push(e),!t});p=e.length,h=p>0,p>1?n.nestedHeaders=Array.from(e).reduce((e,t)=>{const n=Array.from(t.cells).reduce((e,t,n)=>{if(a&&0===n)return e;const{colSpan:r,innerHTML:i}=t,o=r>1?{label:i,colspan:r}:i;return e.push(o),e},[]);return e.push(n),e},[]):h&&(n.colHeaders=Array.from(e[0].children).reduce((e,t,n)=>(a&&0===n||e.push(t.innerHTML),e),[]))}d.length&&(n.fixedRowsTop=d.length),u.length&&(n.fixedRowsBottom=u.length);const f=[...d,...Array.from(o.tBodies).reduce((e,t)=>(e.push(...Array.from(t.rows)),e),[]),...u];g=f.length;const m=new Array(g);for(let b=0;b<g;b++)m[b]=new Array(c);const v=[],w=[];for(let b=0;b<g;b++){const e=f[b],t=Array.from(e.cells),n=t.length;for(let r=0;r<n;r++){const e=t[r],{nodeName:n,innerHTML:i,rowSpan:o,colSpan:a}=e,l=m[b].findIndex(e=>void 0===e);if("TD"===n){if(o>1||a>1){for(let e=b;e<b+o;e++)if(e<g)for(let t=l;t<l+a;t++)m[e][t]=null;const t=e.getAttribute("style");t&&t.includes("mso-ignore:colspan")||v.push({col:l,row:b,rowspan:o,colspan:a})}let t="";t=s&&/excel/gi.test(s.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),m[b][l]=t.replace(Yr,e=>Kr[e])}else w.push(i)}}return v.length&&(n.mergeCells=v),w.length&&(n.rowHeaders=w),m.length&&(n.data=m),n}(t,this.hot.rootDocument);i=e.data}else i=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(i=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof i&&(i=function(e){const t=[[""]];if(0===e.length)return t;let n,r=0,i=0;for(;e.length>0&&n!==e.length;)if(n=e.length,e.match(dp))e=e.replace(dp,""),r+=1,t[i][r]="";else if(e.match(cp))e=e.replace(cp,""),r=0,i+=1,t[i]=[""];else{let n="";if(e.startsWith('"')){let t=0,r=!0;for(;r;){const i=e.slice(0,1);'"'===i&&(t+=1),n+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2===0)&&(r=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,e=>new Array(Math.floor(e.length/2)).fill('"').join(""))}else{const t=e.match(up);n=t?t[0]:"",e=e.slice(n.length)}t[i][r]=n}return t}(i)),void 0===i||i&&0===i.length)return;if(!1===this.hot.runHooks("beforePaste",i,this.copyableRanges))return;const[o,s,a,l]=this.populateValues(i);this.hot.selectCell(o,s,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",i,this.copyableRanges)}destroy(){super.destroy()}}function eR(e){if(Tn()){const t=this.hot.getSelectedRangeLast();if(t){const{row:n,col:r}=t.highlight,i=this.hot.getCell(n,r,!0);i&&function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Et(e,n),t(),Tt(e,n)}(i,()=>{this.hot.rootDocument.execCommand(e)})}}else this.hot.rootDocument.execCommand(e)}function tR(e){const{rows:t}=Ox(e);let n=0;for(let r=0;r<t.length&&!(t[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function nR(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);r&&Et(r)}}}function rR(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:n}=e.highlight,r=this.hot.getCell(t,n,!0);null!==r&&void 0!==r&&r.hasAttribute("contenteditable")&&Tt(r)}}}function iR(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(Zc)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1})),Hx(Gx,this)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?ni(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eu,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Hx($x,this)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?ni(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tu,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),Hx(Ux,this)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?ni(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(nu,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(ru)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function oR(e,t,n,r,i){Hx(Qx,this)&&(i.value=!0),Vx(Qx,this,!1)}function sR(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function aR(){Bx(Jx,this,rR).call(this)}function lR(){Bx(Jx,this,nR).call(this)}function cR(){Bx(Jx,this,rR).call(this)}function uR(e,t){return`border_row${e}col${t}`}function dR(e){var t,n;(Vt(e.start)||Vt(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Vt(e.end)||Vt(e.right))&&(e.end=null!==(n=e.end)&&void 0!==n?n:e.right);return delete e.left,delete e.right,e}function hR(e){return Vt(e.start)&&(e.left=e.start),Vt(e.end)&&(e.right=e.end),e}function pR(e,t){return{id:uR(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function gR(e,t){let n=!1;return Ot(e.getSelectedRange(),r=>{r.forAll((r,i)=>{if(r<0||i<0)return;const o=e.getCellMeta(r,i).borders;if(o){if(!t)return n=!0,!1;if(!mn(o[t],"hide")||!1===o[t].hide)return n=!0,!1}})}),n}function fR(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}const mR=new Map([["left","start"],["right","end"]]);function vR(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(Su);return gR(this,t)&&(e=fR(e)),e},callback(n,r){const i=gR(this,t);e.prepareBorder(r,t,i)}}}function wR(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(xu);return gR(this,"bottom")&&(e=fR(e)),e},callback(t,n){const r=gR(this,"bottom");e.prepareBorder(n,"bottom",r)}}}function bR(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(Ru);return gR(this,t)&&(e=fR(e)),e},callback(n,r){const i=gR(this,t);e.prepareBorder(r,t,i)}}}function CR(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Eu)},callback(t,n){e.prepareBorder(n,"noBorders")},disabled(){return!gR(this)}}}function yR(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function SR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const RR="customBorders";var ER=new WeakSet;class TR extends vw{constructor(){super(...arguments),yR(this,ER),SR(this,"savedBorders",[])}static get PLUGIN_KEY(){return RR}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[RR]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>xR(ER,this,kR).call(this,e)),this.addHook("init",()=>xR(ER,this,MR).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),r=dR(t));const i=bh(wh(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Ot(e,e=>{i(e).forAll((e,t)=>{Ot(n,n=>{this.prepareBorderFromCustomAdded(e,t,r,function(e){var t;return null!==(t=mR.get(e))&&void 0!==t?t:e}(n))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=bh(wh(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),n=[];return Ot(e,e=>{t(e).forAll((e,t)=>{Ot(this.savedBorders,r=>{r.row===e&&r.col===t&&n.push(hR(r))})})}),n}clearBorders(e){e?this.setBorders(e):(Ot(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const n=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,n,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:n})}prepareBorderFromCustomAdded(e,t,n,r){const i=this.hot.countRows(),o=this.hot.countCols();if(e>=i||t>=o)return;let s=pR(e,t);var a,l;n&&(a=s,mn(l=n,"border")&&l.border&&(a.border=l.border),mn(l,"top")&&Vt(l.top)&&(l.top?(un(l.top)||(l.top={width:1,color:"#000"}),a.top=l.top):(l.top={hide:!0},a.top=l.top)),mn(l,"bottom")&&Vt(l.bottom)&&(l.bottom?(un(l.bottom)||(l.bottom={width:1,color:"#000"}),a.bottom=l.bottom):(l.bottom={hide:!0},a.bottom=l.bottom)),mn(l,"start")&&Vt(l.start)&&(l.start?(un(l.start)||(l.start={width:1,color:"#000"}),a.start=l.start):(l.start={hide:!0},a.start=l.start)),mn(l,"end")&&Vt(l.end)&&(l.end?(un(l.end)||(l.end={width:1,color:"#000"}),a.end=l.end):(l.end={hide:!0},a.end=l.end)),s=a,Ot(this.hot.selection.highlight.customSelections,e=>{if(s.id===e.settings.id)return Object.assign(e.settings,n),s.id=e.settings.id,s.top=e.settings.top,s.bottom=e.settings.bottom,s.start=e.settings.start,s.end=e.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",hR(s)),this.insertBorderIntoSettings(s,r)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);Zr(e.from.row,n,n=>{Zr(e.from.col,r,r=>{const i=pR(n,r);let o=0;n===e.from.row&&mn(t,"top")&&(o+=1,i.top=t.top),n===e.to.row&&mn(t,"bottom")&&(o+=1,i.bottom=t.bottom),r===e.from.col&&mn(t,"start")&&(o+=1,i.start=t.start),r===e.to.col&&mn(t,"end")&&(o+=1,i.end=t.end),o>0&&(this.hot.setCellMeta(n,r,"borders",hR(i)),this.insertBorderIntoSettings(i))})})}removeAllBorders(e,t){const n=uR(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,r){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?dR(i):pR(e,t),r){i[n]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",hR(i))}}else{i[n]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,n,r)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",hR(i))}}prepareBorder(e,t,n){Ot(e,e=>{let{start:r,end:i}=e;if(r.row===i.row&&r.col===i.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,n);else switch(t){case"noBorders":Zr(r.col,i.col,e=>{Zr(r.row,i.row,t=>{this.removeAllBorders(t,e)})});break;case"top":Zr(r.col,i.col,e=>{this.setBorder(r.row,e,t,n)});break;case"bottom":Zr(r.col,i.col,e=>{this.setBorder(i.row,e,t,n)});break;case"start":Zr(r.row,i.row,e=>{this.setBorder(e,r.col,t,n)});break;case"end":Zr(r.row,i.row,e=>{this.setBorder(e,i.col,t,n)})}})}createCustomBorders(e){Ot(e,e=>{const t=dR(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)})}countHide(e){const{top:t,bottom:n,start:r,end:i}=e;return At([t,n,r,i],(e,t)=>{let n=e;return t&&t.hide&&(n+=1),n},0)}clearBordersFromSelectionSettings(e){const t=Ft(this.hot.selection.highlight.customSelections,e=>e.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){Ot(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){Ot(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=Ft(this.savedBorders,e=>e.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):Ot(this.savedBorders,(n,r)=>{if(e.id===n.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,n){let r=!1;return Ot(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id){return Ot(this.hot.view._wt.selectionManager.getBorderInstances(i),e=>{e.toggleHiddenClass(t,n)}),r=!0,!1}}),r}checkCustomSelections(e,t,n){const r=this.countHide(e);let i=!1;return 4===r?(this.removeAllBorders(e.row,e.col),i=!0):Ot(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),n){Ot(this.hot.view._wt.selectionManager.getBorderInstances(r),t=>{t.changeBorderStyle(n,e)})}return i=!0,!1}}),i}changeBorderSettings(){const e=this.hot.getSettings()[RR];if(Array.isArray(e)){const t=sn(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=function(e){return e.some(e=>Vt(e.left)||Vt(e.right))}(e),n=function(e){return e.some(e=>Vt(e.start)||Vt(e.end))}(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function kR(e){var t;this.hot.getSettings()[RR]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Cu)},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(yu);return gR(this,"top")&&(e=fR(e)),e},callback(e,n){const r=gR(this,"top");t.prepareBorder(n,"top",r)}}),vR(this),wR(this),bR(this),CR(this)]}})}function MR(){this.changeBorderSettings()}function PR(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function IR(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function AR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const DR="dragToScroll";var FR=new WeakSet;class OR extends vw{constructor(){super(...arguments),PR(this,FR),IR(this,"boundaries",null),IR(this,"callback",null),IR(this,"listening",!1)}static get PLUGIN_KEY(){return DR}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[DR]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>AR(FR,this,NR).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>AR(FR,this,NR).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",e=>this.onMouseMove(e)),t=_e(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function NR(e){if(Hn(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback((e,n)=>{var r,i;const o=null!==(r=t.scrollLeft)&&void 0!==r?r:t.scrollX,s=null!==(i=t.scrollTop)&&void 0!==i?i:t.scrollY;t.scroll(o+50*Math.sign(e),s+20*Math.sign(n))}),this.listen()}function LR(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _R(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HR(e,t,n){return e.set(VR(e,t),n),n}function VR(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("afterDropdownMenuDefaultOptions"),ir.getSingleton().register("beforeDropdownMenuShow"),ir.getSingleton().register("afterDropdownMenuShow"),ir.getSingleton().register("afterDropdownMenuHide"),ir.getSingleton().register("afterDropdownMenuExecute");const BR="dropdownMenu",WR="changeType",zR=BR;var jR=new WeakMap,GR=new WeakSet;class $R extends vw{static get PLUGIN_KEY(){return BR}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[gS,fS,Ty,wS,Ty,pS,Ty,mS,Ty,hS]}constructor(e){var t,n;super(e),LR(t=this,n=GR),n.add(t),_R(this,"commandExecutor",new dS(this.hot)),_R(this,"itemsFactory",null),_R(this,"menu",null),function(e,t,n){LR(e,t),t.set(e,n)}(this,jR,!1),this.hot.addHook("afterGetColHeader",(e,t)=>VR(GR,this,YR).call(this,e,t))}isEnabled(){return this.hot.getSettings()[BR]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new MS(this.hot,$R.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VR(GR,e,eE).call(e,...n)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VR(GR,e,ZR).call(e,...n)});const t=this.hot.getSettings()[BR],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new ox(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>VR(GR,this,qR).call(this)),this.menu.addLocalHook("afterOpen",()=>VR(GR,this,XR).call(this)),this.menu.addLocalHook("afterSubmenuOpen",e=>VR(GR,this,QR).call(this,e)),this.menu.addLocalHook("afterClose",()=>VR(GR,this,JR).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.executeCommand.call(e,...n)}),Ot(r,e=>this.commandExecutor.registerCommand(e.key,e))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);const{from:t}=this.hot.getSelectedRangeLast(),n=Ay(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,t.col,!0).querySelector(`.${WR}`),i=r.getBoundingClientRect();this.open({left:i.left+n.left,top:i.top+r.offsetHeight+n.top},{left:i.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:zR},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:zR}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zR)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>VR(GR,this,KR).call(this,e))}open(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),hn(n,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.commandExecutor.execute(e,...n)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function UR(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function KR(e){if(Ge(e.target,WR)){const t=Ay(this.menu.container,this.hot.rootDocument),n=e.target.getBoundingClientRect();e.stopPropagation(),HR(jR,this,!1),this.open({left:n.left+t.left,top:n.top+e.target.offsetHeight+t.top},{left:n.width,right:0,above:0,below:3})}}function YR(e,t){const n=t.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(e<0||i!==r.length-1)return;const o=t.querySelector(`.${WR}`);if(this.enabled&&o)return;if(!this.enabled)return void(o&&o.parentNode.removeChild(o));const s=this.hot.rootDocument.createElement("button");s.className=WR,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ke(s,[["aria-hidden","true"],Ee(" ")]),Ke(t,[Te("menu")])),s.onclick=function(){return!1},t.firstChild.insertBefore(s,t.firstChild.firstChild)}function qR(){this.hot.runHooks("beforeDropdownMenuShow",this)}function XR(){this.hot.runHooks("afterDropdownMenuShow",this),VR(GR,this,UR).call(this,this.menu)}function QR(e){VR(GR,this,UR).call(this,e)}function JR(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function ZR(e){return n=this,(t=jR).get(VR(t,n))?null:e;var t,n}function eE(e){Ge(e.target,WR)&&HR(jR,this,!0)}function tE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}$R.SEPARATOR={name:Ty};const nE=class{constructor(e){tE(this,"hot",void 0),tE(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:r}=this._getDataRange(),i=this.options,o=[];return Zr(e,n,e=>{const n=[];!i.exportHiddenRows&&this._isHiddenRow(e)||(Zr(t,r,t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||n.push(this.hot.getDataAtCell(e,t))}),o.push(n))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),r=this.hot.getRowHeader();Zr(t,n,t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(r[t])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),r=this.hot.getColHeader();Zr(t,n,t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(r[t])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,r=0,i=t,o=e]=this.options.range;return n=Math.max(n,0),r=Math.max(r,0),i=Math.min(i,t),o=Math.min(o,e),{startRow:n,startCol:r,endRow:i,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};function rE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iE{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){rE(this,"dataProvider",void 0),rE(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=an(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=rn(an(iE.DEFAULT_OPTIONS),t),t=rn(t,e),t.filename=fe(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const oE=iE;function sE(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function aE(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const lE=String.fromCharCode(13),cE=String.fromCharCode(34),uE=String.fromCharCode(10),dE=String.fromCharCode(61),hE=String.fromCharCode(43),pE=String.fromCharCode(45),gE=String.fromCharCode(64),fE=String.fromCharCode(9);var mE=new WeakSet;function vE(e){return e.startsWith(dE)||e.startsWith(hE)||e.startsWith(pE)||e.startsWith(gE)||e.startsWith(fE)||e.startsWith(lE)?`'${e}`:e}function wE(e,t){return t.test(e)?`'${e}`:e}const bE=class extends oE{constructor(){super(...arguments),sE(this,mE)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n",sanitizeValues:!1}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const r=n.length>0,i=this.dataProvider.getRowHeaders(),o=i.length>0;let s=e.bom?String.fromCharCode(65279):"";return r&&(n=Ft(n,t=>this._escapeCell(t,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(s+=e.columnDelimiter),s+=n.join(e.columnDelimiter),s+=e.rowDelimiter),Ot(t,(t,n)=>{n>0&&(s+=e.rowDelimiter),o&&(s+=this._escapeCell(i[n],{sanitizeValue:e.sanitizeValues}),s+=e.columnDelimiter);const r=t.map(t=>this._escapeCell(t,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);s+=r}),s}_escapeCell(e){let{force:t=!1,sanitizeValue:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Ht(e);return""===r||(n&&(t=!0),n instanceof RegExp?r=aE(mE,this,wE).call(this,r,n):"function"===typeof n?r=n(r):n&&(r=aE(mE,this,vE).call(this,r)),(t||r.indexOf(lE)>=0||r.indexOf(cE)>=0||r.indexOf(uE)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}},CE="csv",yE={[CE]:bE};class SE extends vw{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:n,rootWindow:r}=this.hot,i=this._createTypeFormatter(e,t),o=this._createBlob(i),s=r.URL||r.webkitURL,a=n.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==a.download){const e=s.createObjectURL(o);a.style.display="none",a.setAttribute("href",e),a.setAttribute("download",l),n.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),n.body.removeChild(a),setTimeout(()=>{s.revokeObjectURL(e)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,l)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!yE[e])throw new Error(`Export format type "${e}" is not supported.`);return function(e,t,n){return"function"===typeof yE[e]?new yE[e](t,n):null}(e,new nE(this.hot),t)}_createBlob(e){let t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function xE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RE{constructor(e,t){let{id:n,stateless:r=!0}=t;xE(this,"hot",void 0),xE(this,"id",void 0),xE(this,"elements",[]),xE(this,"hidden",!1),xE(this,"stateId",""),xE(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new hc)}getElements(){return this.elements}reset(){Ot(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Ot(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ln(RE,Zl);const EE={};function TE(e,t){if(!EE[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:n,descriptor:r}=EE[e];let i=t;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(e){return n.apply(e.meta.instance,[].concat([e],[i]))}}function kE(e){if(!EE[e])throw Error(`Filter condition "${e}" does not exist.`);return EE[e].descriptor}function ME(e,t,n){n.key=e,EE[e]={condition:t,descriptor:n}}const PE="none";ME(PE,function(){return!0},{name:Ou,inputsCount:0,showOperators:!1});const IE="empty";ME(IE,function(e){return Wt(e.value)},{name:Nu,inputsCount:0,showOperators:!0});const AE="not_empty";ME(AE,function(e,t){return!TE(IE,t)(e)},{name:Lu,inputsCount:0,showOperators:!0});const DE="eq";ME(DE,function(e,t){let[n]=t;return Ht(e.value).toLocaleLowerCase(e.meta.locale)===Ht(n)},{name:_u,inputsCount:1,showOperators:!0});const FE="neq";ME(FE,function(e,t){return!TE(DE,t)(e)},{name:Hu,inputsCount:1,showOperators:!0});ME("gt",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r},{name:Gu,inputsCount:1,showOperators:!0});ME("gte",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r},{name:$u,inputsCount:1,showOperators:!0});ME("lt",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r},{name:Uu,inputsCount:1,showOperators:!0});ME("lte",function(e,t){let[n]=t,r=n;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r},{name:Ku,inputsCount:1,showOperators:!0});const OE="date_after";ME(OE,function(e,t){let[n]=t;const r=Mt(e.value,e.meta.dateFormat),i=Mt(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)>=0},{name:Xu,inputsCount:1,showOperators:!0});const NE="date_before";ME(NE,function(e,t){let[n]=t;const r=Mt(e.value,e.meta.dateFormat),i=Mt(n,e.meta.dateFormat);return!(!r.isValid()||!i.isValid())&&r.diff(i)<=0},{name:Qu,inputsCount:1,showOperators:!0});const LE="between";ME(LE,function(e,t){let[n,r]=t,i=n,o=r;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(o,10);i=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){const t=TE(NE,[o]),n=TE(OE,[i]);return t(e)&&n(e)}return e.value>=i&&e.value<=o},{name:Yu,inputsCount:2,showOperators:!0});const _E="not_between";ME(_E,function(e,t){return!TE(LE,t)(e)},{name:qu,inputsCount:2,showOperators:!0});const HE="begins_with";ME(HE,function(e,t){let[n]=t;return Ht(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Ht(n))},{name:Vu,inputsCount:1,showOperators:!0});const VE="ends_with";ME(VE,function(e,t){let[n]=t;return Ht(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Ht(n))},{name:Bu,inputsCount:1,showOperators:!0});const BE="contains";ME(BE,function(e,t){let[n]=t;return Ht(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Ht(n))>=0},{name:Wu,inputsCount:1,showOperators:!0});const WE="not_contains";ME(WE,function(e,t){return!TE(BE,t)(e)},{name:zu,inputsCount:1,showOperators:!0});const zE="date_tomorrow";ME(zE,function(e){const t=Mt(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Mt().subtract(-1,"days").startOf("day"),"d")},{name:Zu,inputsCount:0});const jE="date_today";ME(jE,function(e){const t=Mt(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Mt().startOf("day"),"d")},{name:Ju,inputsCount:0});const GE="date_yesterday";ME(GE,function(e){const t=Mt(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Mt().subtract(1,"days").startOf("day"),"d")},{name:ed,inputsCount:0});const $E="numeric",UE="text",KE="date",YE={[$E]:[PE,Ty,IE,AE,Ty,DE,FE,Ty,"gt","gte","lt","lte",LE,_E],[UE]:[PE,Ty,IE,AE,Ty,DE,FE,Ty,HE,VE,Ty,BE,WE],[KE]:[PE,Ty,IE,AE,Ty,DE,FE,Ty,NE,OE,LE,Ty,zE,jE,GE]};function qE(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const XE="built",QE="building",JE=["click","input","keydown","keypress","keyup","focus","blur","change"];class ZE{static get DEFAULTS(){return an({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){qE(this,"hot",void 0),qE(this,"eventManager",new Cr(this)),qE(this,"options",void 0),qE(this,"_element",void 0),qE(this,"buildState",void 0),this.hot=e,this.options=rn(ZE.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===QE?this._element:this.buildState===XE?(this.update(),this._element):(this.buildState=QE,this.build(),this.buildState=XE,this._element)}isBuilt(){return this.buildState===XE}translateIfPossible(e){return"string"===typeof e&&e.startsWith(Du)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,e=>this.runLocalHooks(t,e,this))};if(this.buildState||(this.buildState=QE),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&$e(this._element,this.options.className),this.options.children.length)Ot(this.options.children,e=>this._element.appendChild(e.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),hn(this.options,(e,n)=>{void 0!==t[n]&&"className"!==n&&"tagName"!==n&&"children"!==n&&(t[n]=this.translateIfPossible(e))}),this._element.appendChild(t),Ot(JE,n=>e(t,n))}else Ot(JE,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function eT(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tT(e,t){return e.get(nT(e,t))}function nT(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ln(ZE,Zl);var rT=new WeakMap,iT=new WeakSet;class oT extends ZE{static get DEFAULTS(){return an({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){var n,r;super(e,rn(oT.DEFAULTS,t)),eT(n=this,r=iT),r.add(n),function(e,t,n){eT(e,t),t.set(e,n)}(this,rT,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>nT(iT,this,sT).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");!function(e,t,n){e.set(nT(e,t),n)}(rT,this,this._element.firstChild),$e(this._element,"htUIInput"),$e(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(tT(rT,this).type=this.options.type,tT(rT,this).placeholder=this.translateIfPossible(this.options.placeholder),tT(rT,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&tT(rT,this).focus()}}function sT(e){this.options.value=e.target.value}function aT(e,t,n){lT(e,t),t.set(e,n)}function lT(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cT(e,t,n){return e.set(dT(e,t),n),n}function uT(e,t){return e.get(dT(e,t))}function dT(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var hT=new WeakMap,pT=new WeakMap,gT=new WeakMap,fT=new WeakMap,mT=new WeakMap,vT=new WeakSet;class wT extends ZE{static get DEFAULTS(){return an({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){var n,r;super(e,rn(wT.DEFAULTS,t)),lT(n=this,r=vT),r.add(n),aT(this,hT,null),aT(this,pT,[]),aT(this,gT,void 0),aT(this,fT,void 0),aT(this,mT,void 0),this.registerHooks()}getMenu(){return uT(hT,this)}registerHooks(){this.addLocalHook("click",()=>dT(vT,this,yT).call(this))}setItems(e){cT(pT,this,this.translateNames(e)),uT(hT,this)&&uT(hT,this).setMenuItems(uT(pT,this))}translateNames(e){return Ot(e,e=>{e.name=this.translateIfPossible(e.name)}),e}build(){super.build(),cT(hT,this,new ox(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),uT(hT,this).setMenuItems(uT(pT,this));const e=new ZE(this.hot,{className:"htUISelectCaption"}),t=new ZE(this.hot,{className:"htUISelectDropdown"});cT(gT,this,e),cT(fT,this,e.element),cT(mT,this,t),this.hot.getSettings().ariaTags&&(Ke(t.element,[["aria-hidden","true"]]),Ke(this._element,[["role","listbox"]])),Ot([e,t],e=>this._element.appendChild(e.element)),uT(hT,this).addLocalHook("select",e=>dT(vT,this,bT).call(this,e)),uT(hT,this).addLocalHook("afterClose",()=>dT(vT,this,CT).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:uT(hT,this).hot.getTranslatedPhrase(Ou),uT(fT,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();uT(hT,this)&&(uT(hT,this).open(),uT(hT,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),uT(hT,this).getNavigator().toFirstItem(),uT(hT,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){uT(hT,this)&&uT(hT,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){uT(hT,this)&&(uT(hT,this).destroy(),cT(hT,this,null)),uT(gT,this)&&uT(gT,this).destroy(),uT(mT,this)&&uT(mT,this).destroy(),super.destroy()}}function bT(e){e.name!==Ty&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function CT(){this.runLocalHooks("afterClose")}function yT(){this.openOptions()}function ST(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function xT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function RT(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ET=new WeakSet;class TT extends RE{constructor(e,t){super(e,{id:t.id,stateless:!1}),ST(this,ET),xT(this,"name",""),xT(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new wT(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new oT(this.hot,{placeholder:dd})),this.elements.push(new oT(this.hot,{placeholder:hd})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>RT(ET,this,kT).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Ot(this.getInputElements(),e=>{e.addLocalHook("keydown",e=>RT(ET,this,MT).call(this,e))})}setState(e){if(this.reset(),!e)return;const t=an(e.command);t.name.startsWith(Fu)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),Ot(e.args,(e,n)=>{if(n>t.inputsCount-1)return!1;const r=this.getInputElement(n);r.setValue(e),r[t.inputsCount>n?"show":"hide"](),n||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||kE(PE),t=[];return Ot(this.getInputElements(),(n,r)=>{e.inputsCount>r&&t.push(n.getValue())}),{command:e,args:t}}updateState(e,t){const n=kE(e?e.name:PE);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||Ot(this.getInputElements(),e=>e.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof wT)[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof oT)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{$e(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&$e(t.parentNode,"border");const s=this.hot.rootDocument.createElement("div");return $e(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Ot(this.elements,e=>t.appendChild(e.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[kE(PE)];if(null!==e){const{visualIndex:n}=e;t=function(e){const t=[];let n=e;return YE[n]||(n=UE),Ot(YE[n],e=>{let n;n=e===Ty?{name:Ty}:an(kE(e)),t.push(n)}),t}(this.hot.getDataType(0,n,this.hot.countRows(),n))}Ot(this.getInputElements(),e=>e.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function kT(e){Ot(this.getInputElements(),(t,n)=>{t[e.inputsCount>n?"show":"hide"](),0===n&&this.hot._registerTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}function MT(e){Nn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ln(e))}const PT={};function IT(e,t,n){PT[e]={name:t,func:n}}const AT="conjunction";IT(AT,rd,function(e,t){return e.every(e=>e.func(t))});const DT="disjunction";IT(DT,id,function(e,t){return e.some(e=>e.func(t))});const FT="disjunctionWithExtraCondition";function OT(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function NT(e,t){return e.get(_T(e,t))}function LT(e,t,n){return e.set(_T(e,t),n),n}function _T(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}IT(FT,id,function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(e=>e.func(t))&&e[e.length-1].func(t)});var HT=new WeakMap,VT=new WeakMap;class BT extends ZE{static get DEFAULTS(){return an({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,rn(BT.DEFAULTS,t)),OT(this,HT,void 0),OT(this,VT,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),LT(VT,this,e),LT(HT,this,this._element.firstChild),NT(HT,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(NT(VT,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&NT(HT,this).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(NT(HT,this).checked=e)}focus(){this.isBuilt()&&NT(HT,this).focus()}}function WT(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zT(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jT=new WeakSet;class GT extends RE{constructor(e,t){super(e,{id:t.id,stateless:!1}),WT(this,jT),zT(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>($e(t.parentNode,"htFiltersMenuOperators"),Ot(this.elements,e=>t.appendChild(e.element)),t)}}buildOperatorsElement(){const e=[AT,DT];Ot(e,t=>{const n=new BT(this.hot,{name:"operator",label:{htmlFor:t,textContent:(r=t,PT[r].name)},value:t,checked:t===e[0],id:t});var r;n.addLocalHook("change",e=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(jT,this,$T).call(this,e)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(_t`Radio button with index ${e} doesn't exist.`);Ot(this.elements,(t,n)=>{t.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(e=>e instanceof BT&&e.isChecked());return e?e.getValue():AT}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Ot(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:AT;t===FT&&(t=DT),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}}function $T(e){this.setState(e.target.value)}!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Cn||(Cn="object"===typeof Intl?new Intl.Collator(e,t).compare:"function"===typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1)}();function UT(e,t){let n=e;return""===n&&(n=`(${t})`),n}function KT(e){const t=new Set(e);return function(e){return t.has(e)}}function YT(e){return null===e||void 0===e?"":e}function qT(e){return Array.from(new Set(e)).map(e=>YT(e)).sort((e,t)=>"number"===typeof e&&"number"===typeof t?e-t:e===t?0:e>t?1:-1)}function XT(e,t,n,r){const i=[],o=e===t;let s;return o||(s=KT(t)),e.forEach(e=>{let t=!1;(o||s(e))&&(t=!0);const a={checked:t,value:e,visualValue:UT(e,n)};r&&r(a),i.push(a)}),i}function QT(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function JT(e,t){return e.get(ZT(e,t))}function ZT(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ek=new WeakMap;class tk extends ZE{static get DEFAULTS(){return an({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,rn(tk.DEFAULTS,t)),QT(this,ek,void 0)}build(){super.build(),function(e,t,n){e.set(ZT(e,t),n)}(ek,this,this._element.firstChild)}update(){this.isBuilt()&&(JT(ek,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&JT(ek,this).focus()}activate(){JT(ek,this).click()}}function nk(e,t,n){rk(e,t),t.set(e,n)}function rk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ik(e,t){return e.get(sk(e,t))}function ok(e,t,n){return e.set(sk(e,t),n),n}function sk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const ak="multipleSelect.itemBox";var lk=new WeakMap,ck=new WeakMap,uk=new WeakMap,dk=new WeakMap,hk=new WeakMap,pk=new WeakMap,gk=new WeakSet;class fk extends ZE{static get DEFAULTS(){return an({className:"htUIMultipleSelect",value:[]})}constructor(e,t){var n,r;super(e,rn(fk.DEFAULTS,t)),rk(n=this,r=gk),r.add(n),nk(this,lk,[]),nk(this,ck,void 0),nk(this,uk,void 0),nk(this,dk,void 0),nk(this,hk,void 0),nk(this,pk,void 0),ok(dk,this,new oT(this.hot,{placeholder:ud,className:"htUIMultipleSelectSearch"})),ok(hk,this,new tk(this.hot,{textContent:sd,className:"htUISelectAll"})),ok(pk,this,new tk(this.hot,{textContent:ad,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ik(ck,this)}registerHooks(){ik(dk,this).addLocalHook("keydown",e=>sk(gk,this,vk).call(this,e)),ik(dk,this).addLocalHook("input",e=>sk(gk,this,mk).call(this,e)),ik(hk,this).addLocalHook("click",e=>sk(gk,this,wk).call(this,e)),ik(pk,this).addLocalHook("click",e=>sk(gk,this,bk).call(this,e))}setItems(e){var t;ok(lk,this,e),null===(t=ik(ck,this))||void 0===t||t.loadData(ik(lk,this))}setLocale(e){ok(uk,this,e)}getLocale(){return ik(uk,this)}getItems(){return[...ik(lk,this)]}getValue(){return function(e){const t=[];return e.forEach(e=>{e.checked&&t.push(e.value)}),t}(ik(lk,this))}getSearchInputElement(){return ik(dk,this)}getSelectAllElement(){return ik(hk,this)}getClearAllElement(){return ik(pk,this)}isSelectedAllValues(){return ik(lk,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new ZE(this.hot,{className:"htUISelectionControls",children:[ik(hk,this),ik(pk,this)]});this._element.appendChild(ik(dk,this).element),this._element.appendChild(n.element),this._element.appendChild(t);const r=t=>{var n;if(!this._element)return;null===(n=ik(ck,this))||void 0===n||n.destroy(),$e(t,"htUIMultipleSelectHot"),ok(ck,this,new this.hot.constructor(t,{data:ik(lk,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,n,r,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ik(ck,this).listen()},modifyColWidth:t=>{const n=ik(ck,this).container.scrollWidth-vt(e);return void 0!==t&&t<n?n:t},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ik(ck,this).init(),this.hot.addHook("afterSetTheme",(e,t)=>{t||ik(ck,this).useTheme(e)});const r=ik(ck,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:ak}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{ik(ck,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:ak})};r(t),this.hot._registerTimeout(()=>r(t),100)}focus(){this.isBuilt()&&ik(ck,this).listen()}reset(){ik(dk,this).reset(),ik(hk,this).reset(),ik(pk,this).reset()}update(){this.isBuilt()&&(ik(ck,this).loadData(function(e,t){const n=KT(t);return e.map(e=>(e.checked=n(e.value),e))}(ik(lk,this),this.options.value)),super.update())}destroy(){var e;null===(e=ik(ck,this))||void 0===e||e.destroy(),ik(dk,this).destroy(),ik(pk,this).destroy(),ik(hk,this).destroy(),ok(dk,this,null),ok(pk,this,null),ok(hk,this,null),ok(ck,this,null),ok(lk,this,null),super.destroy()}}function mk(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;n=""===t?[...ik(lk,this)]:ik(lk,this).filter(e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),ik(ck,this).loadData(n)}function vk(e){this.runLocalHooks("keydown",e,this);en(Nn,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),Ln(e),ik(ck,this).listen(),ik(ck,this).selectCell(0,0))}function wk(e){const t=[];e.preventDefault(),ik(ck,this).getSourceData().forEach((e,n)=>{e.checked=!0,t.push(Yl(e,n)[0])}),ik(ck,this).setSourceDataAtCell(t)}function bk(e){const t=[];e.preventDefault(),ik(ck,this).getSourceData().forEach((e,n)=>{e.checked=!1,t.push(Yl(e,n)[0])}),ik(ck,this).setSourceDataAtCell(t)}const Ck="by_value";function yk(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Sk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ME(Ck,function(e,t){let[n]=t;return n(e.value)},{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[KT(t)]},showOperators:!1});var Rk,Ek=new WeakSet;class Tk extends RE{constructor(e,t){super(e,{id:t.id,stateless:!1}),yk(this,Ek),Sk(this,"name",""),this.name=t.name,this.elements.push(new fk(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>xk(Ek,this,kk).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>xk(Ek,this,Pk).call(this,e,t))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ck){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?PE:Ck},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,n,r,i,o)=>{const[s]=Dt(n,e=>e.name===Ck),a={},l=this.hot.getTranslatedPhrase(od);if(s){const n=i(t,o),c=Ft(n,e=>e.value),u=new Map(n.map(e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)])),d=qT(c);r&&(s.args[0]=r);const h=[],p=XT(d,s.args[0],l,e=>{e.checked&&h.push(e.value),xk(Ek,this,Mk).call(this,e,u)}),g=e.editedConditionStack.column;a.locale=this.hot.getCellMeta(0,g).locale,a.args=[h],a.command=kE(Ck),a.itemsSnapshot=p}else a.args=[],a.command=kE(PE);this.state.setValueAtIndex(t,a)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof fk)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,r,i,o)=>{$e(t.parentNode,"htFiltersMenuValue");const s=this.hot.rootDocument.createElement("div");return $e(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||Ot(this.elements,e=>t.appendChild(e.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(od),t=this._getColumnVisibleValues(),n=t.map(e=>e.value),r=new Map(t.map(e=>[e.value,e.meta])),i=qT(n),o=XT(i,i,e,e=>{xk(Ek,this,Mk).call(this,e,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(i);const s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:Ft(this.hot.getDataAtCol(e.visualIndex),(t,n)=>({value:YT(t),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function kk(e){Nn(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ln(e))}function Mk(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function Pk(e,t){return"numeric"===t.type?Vv(e,t):e}function Ik(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Ak(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dk=new WeakSet;class Fk extends RE{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),Ik(this,Dk),Ak(this,"name",""),this.name=t.name,this.elements.push(new oT(this.hot,{type:"button",value:ld,className:"htUIButton htUIButtonOK",identifier:Fk.BUTTON_OK})),this.elements.push(new oT(this.hot,{type:"button",value:cd,className:"htUIButton htUIButtonCancel",identifier:Fk.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Ot(this.elements,e=>{e.addLocalHook("click",(e,t)=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(Dk,this,Ok).call(this,e,t))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>($e(t.parentNode,"htFiltersMenuActionBar"),Ot(this.elements,e=>t.appendChild(e.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function Ok(e,t){t.options.identifier===Rk.BUTTON_OK?this.accept():this.cancel()}function Nk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Rk=Fk;const Lk="ConditionCollection.filteringStates";class _k{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Nk(this,"hot",void 0),Nk(this,"isMapRegistrable",void 0),Nk(this,"filteringStates",new hc),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(Lk,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var n;const r=this.filteringStates.getValueAtIndex(t),i=null!==(n=null===r||void 0===r?void 0:r.conditions)&&void 0!==n?n:[],o=null===r||void 0===r?void 0:r.operation;return this.isMatchInConditions(i,e,o)}isMatchInConditions(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:AT;return!e.length||function(e){if(!PT[e])throw Error(`Operation with id "${e}" does not exist.`);const t=PT[e].func;return function(e,n){return t(e,n)}}(n)(e,t)}addCondition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:AT,r=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,o=t.args.map(e=>"string"===typeof e?e.toLocaleLowerCase(i):e),s=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const a=this.getOperation(e);if(a){if(a!==n)throw Error(_t`The column of index ${e} has been already applied with a \`${a}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Bt(PT[n]))throw new Error(_t`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(e);0===l.length?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:s,args:o,func:TE(s,o)}]},r):l.push({name:s,args:o,func:TE(s,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return null!==(t=null===(n=this.filteringStates.getValueAtIndex(e))||void 0===n?void 0:n.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[n,{operation:r,conditions:i}]=t;return e.push({column:n,operation:r,conditions:i.map(e=>{let{name:t,args:n}=e;return{name:t,args:[...n]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(e=>{e.conditions.forEach(t=>this.addCondition(e.column,t))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some(e=>e.name===t):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Lk),this.filteringStates=null,this.clearLocalHooks()}}ln(_k,Zl);const Hk=_k;function Vk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Bk=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];Vk(this,"conditionCollection",void 0),Vk(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return Ot(this.conditionCollection.getFilteredColumns(),(t,n)=>{let r=this.columnDataFactory(t);n&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)}),e}filterByColumn(e){const t=[];return Ot(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=>{void 0!==n&&this.conditionCollection.isMatch(n,e)&&t.push(n)}),t}_getIntersectData(e,t){const n=[];return Ot(t,t=>{const r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])}),n}};function Wk(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zk(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jk(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Gk=new WeakSet;class $k{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];Wk(this,Gk),zk(this,"hot",void 0),zk(this,"conditionCollection",void 0),zk(this,"columnDataFactory",void 0),zk(this,"changes",[]),zk(this,"grouping",!1),zk(this,"latestEditedColumnPosition",-1),zk(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",e=>jk(Gk,this,Uk).call(this,e)),this.conditionCollection.addLocalHook("afterRemove",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("afterAdd",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("beforeClean",()=>jk(Gk,this,Kk).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>jk(Gk,this,Yk).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Ot(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var n=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const r=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const o=r.slice(0,i),s=r.slice(i);s.length&&s[0].column===e&&s.shift();const a=function(e){const t=e.length;return function n(r){return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];const a=r.concat(o);let l;return l=a.length>=t?e.apply(this,a):n(a),l}}([])}(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new Hk(n.hot,!1),o=[].concat(e,r);i.importAllConditions(o);const s=n.columnDataFactory(t);let a;a=i.isEmpty()?s:new Bk(i,e=>n.columnDataFactory(e)).filter(),a=Ft(a,e=>e.meta.visualRow);const l=KT(a);return i.destroy(),Dt(s,e=>l(e.meta.visualRow))})(o),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:s,filteredRowsFactory:a,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),hn(this,(e,t)=>{this[t]=null})}}function Uk(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function Kk(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Yk(){Ot(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}ln($k,Zl);const qk=$k;const Xk="filters";function Qk(e,t){let n,r=-1;const i=(o=t,WS({initialPage:0,size:()=>o.length,onItemSelect:(e,t)=>{const n=o[e];return n instanceof fk?t:!(n.element&&!et(n.element))&&void n.focus()}}));var o;const s=e=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(Xk),i.setCurrentPage(t.indexOf(e))};function a(e){const o=n.getKeyboardShortcutsCtrl(),s=e.getKeyboardShortcutsCtrl();i.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(Xk),callback:()=>{e.isSubMenu()&&e.close(),o.listen(Xk)}}]),e.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{const t=n.getNavigator();t.getCurrentPage()>-1&&(r=t.getCurrentPage()),t.clear(),e.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{const n=t[i.getCurrentPage()];n instanceof wT&&(n.openOptions(),e.preventDefault()),n instanceof tk&&(n.activate(),e.preventDefault()),n instanceof ZE||e.preventDefault()}}],Xk)}function l(e){e.addLocalHook("afterSelectionChange",e=>{e.key.startsWith("filter_")||i.clear()}),e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a),n=e}return t.forEach(e=>{e instanceof ZE&&(e.addLocalHook("click",s(e)),e.addLocalHook("focus",s(e)),e.addLocalHook("afterClose",s(e)))}),l(e),{...i,listen:function(){n.focus(),n.getKeyboardShortcutsCtrl().listen(Xk)},setMenu:l,getMenu:function(){return n},getLastMenuPage:function(){return r}}}function Jk(e,t,n){Zk(e,t),t.set(e,n)}function Zk(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eM(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tM(e,t,n){return e.set(rM(e,t),n),n}function nM(e,t){return e.get(rM(e,t))}function rM(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const iM="filters",oM=iM;var sM=new WeakMap,aM=new WeakMap,lM=new WeakMap,cM=new WeakSet;class uM extends vw{static get PLUGIN_KEY(){return iM}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t,n,r;super(e),t=this,Zk(n=this,r=cM),r.add(n),eM(this,"dropdownMenuPlugin",null),eM(this,"conditionCollection",null),eM(this,"conditionUpdateObserver",null),eM(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),eM(this,"filtersRowsMap",null),Jk(this,sM,void 0),Jk(this,aM,new WeakSet),Jk(this,lM,[]),this.hot.addHook("afterGetColHeader",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return rM(cM,t,bM).call(t,...n)})}isEnabled(){return!!this.hot.getSettings()[iM]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new pc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const t=this.hot.getSettings().dropdownMenu,n=t&&t.uiContainer||this.hot.rootDocument.body,r=e=>(e.addLocalHook("accept",()=>rM(cM,this,mM).call(this,"accept")),e.addLocalHook("cancel",()=>rM(cM,this,mM).call(this,"cancel")),e.addLocalHook("change",t=>rM(cM,this,vM).call(this,e,t)),e),i=()=>`${this.hot.getTranslatedPhrase(td)}:`,o=()=>`${this.hot.getTranslatedPhrase(nd)}:`;if(!this.components.get("filter_by_condition")){const e=new TT(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});e.addLocalHook("afterClose",()=>rM(cM,this,wM).call(this)),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new GT(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new TT(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});e.addLocalHook("afterClose",()=>rM(cM,this,wM).call(this)),this.components.set("filter_by_condition2",r(e))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Tk(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Fk(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new Hk(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new qk(this.hot,this.conditionCollection,e=>this.getDataMapAtColumn(e)),this.conditionUpdateObserver.addLocalHook("update",e=>rM(cM,this,CM).call(this,e))),this.components.forEach(e=>e.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rM(cM,e,fM).call(e,...n)}),this.addHook("beforeDropdownMenuShow",()=>rM(cM,this,gM).call(this)),this.addHook("afterDropdownMenuShow",()=>rM(cM,this,hM).call(this)),this.addHook("afterDropdownMenuHide",()=>rM(cM,this,pM).call(this)),this.addHook("afterChange",e=>rM(cM,this,dM).call(this,e)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!nM(sM,this)&&this.dropdownMenuPlugin.enabled){const e=[{focus:()=>{const e=nM(sM,this).getMenu(),t=e.getNavigator(),n=nM(sM,this).getLastMenuPage();e.focus(),n>0?t.setCurrentPage(n):t.toFirstItem()}},...Array.from(this.components).map(e=>{let[,t]=e;return t.getElements()}).flat()];tM(sM,this,Qk(this.dropdownMenuPlugin.menu,e));const t=e=>{nM(sM,this).listen(),e.preventDefault(),Nn(e.keyCode,"TAB")&&(e.shiftKey?nM(sM,this).toPreviousItem():nM(sM,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",t),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",t)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((e,t)=>{e.destroy(),this.components.set(t,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:oM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oM)}addCondition(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:AT;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},r)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let r=[];const i=this.exportConditions(),o=this.hot.runHooks("beforeFilter",i,nM(lM,this));if(!1!==o&&n){const n=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Ft(t.filter(),e=>e.meta.visualRow);const e=KT(r);Zr(this.hot.countSourceRows()-1,t=>{e(t)||n.push(t)}),Ot(n,e=>{this.filtersRowsMap.setValueAtIndex(e,!0)})},!0),e||r.length||this.hot.deselectCell(),tM(lM,this,this.exportConditions())}else!1===o||n?this.importConditions(nM(lM,this)):(tM(lM,this,this.exportConditions()),this.filtersRowsMap.clear());this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),!1!==o&&(this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return Ot(this.hot.getSourceDataAtCol(t),(e,r)=>{var i;const{row:o,col:s,visualCol:a,visualRow:l,type:c,instance:u,dateFormat:d,locale:h}=this.hot.getCellMeta(r,t),p=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==i?i:e;n.push({meta:{row:o,col:s,visualCol:a,visualRow:l,type:c,instance:u,dateFormat:d,locale:h},value:YT(p)})}),n}updateValueComponentCondition(e){const t=qT(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const n=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach(e=>{e.isHidden()||e.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,n,r){let i=e;return i===DT&&t.command.key!==PE&&n.command.key!==PE&&r.command.key!==PE?i=FT:r.command.key!==PE&&(t.command.key!==PE&&n.command.key!==PE||(i=AT)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new Bk(e,e=>this.getDataMapAtColumn(e))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ot(r,n=>{Ot(t.menuItems,(t,r)=>{t.key===n.getMenuItemDescriptor().key&&e.push(r)})}),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,n=t.getPlugin("hiddenRows");for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];const s=this.getIndexesOfComponents(...i);e?n.showRows(s):n.hideRows(s),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function dM(e){e&&Ot(e,e=>{const[,t]=e,n=this.hot.propToCol(t);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function hM(){const e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function pM(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function gM(){const e=this.dropdownMenuPlugin.menu;nM(aM,this).has(e)||nM(sM,this).setMenu(e),nM(aM,this).add(e)}function fM(e){e.items.push({name:Ty}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}function mM(e){var t;if("accept"===e){const e=this.getSelectedColumn();var n;if(null===e)return void(null===(n=this.dropdownMenuPlugin)||void 0===n||n.close());const{physicalIndex:t}=e,r=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,i,o);this.conditionUpdateObserver.groupChanges();let a=this.conditionCollection.getColumnStackPosition(t);-1===a&&(a=void 0),this.conditionCollection.removeConditions(t),r.command.key!==PE&&(this.conditionCollection.addCondition(t,r,s,a),i.command.key!==PE&&this.conditionCollection.addCondition(t,i,s,a)),o.command.key!==PE&&this.conditionCollection.addCondition(t,o,s,a),this.conditionUpdateObserver.flush(),this.components.forEach(e=>e.saveState(t)),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function vM(e,t){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),e.constructor!==TT||t.inputsCount||this.setListeningDropdownMenu(),n.updateMenuDimensions()}function wM(){this.setListeningDropdownMenu()}function bM(e,t,n){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)&&n===this.hot.view.getColumnHeadersCount()-1?$e(t,"htFiltersActive"):Ue(t,"htFiltersActive")}function CM(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:n,column:r},conditionArgsChange:i}=e;Array.isArray(i)&&tM(lM,this,nM(lM,this).map(e=>(e.column===r&&n.length>0&&e.conditions.forEach(e=>{"by_value"===e.name&&(e.args=[[...i]])}),e)));const o=n.filter(e=>e.name===Ck),s=n.filter(e=>e.name!==Ck);if(o.length>=2||s.length>=3)Bn(_t`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const t=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(t,r),this.components.get("filter_by_value").updateState(e)}}const yM="internal-use-in-handsontable",SM={licenseKey:yM,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function xM(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[pP])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function RM(e){return Object.keys(e).reduce((t,n)=>("hyperformula"!==n&&(t[n]=e[n]),t),{})}function EM(){const e="engine_relationship",t=ar(pP);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function TM(){const e="shared_engine_usage",t=ar(pP);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function kM(e){const t=e.getSettings(),n=t[pP],r=null===n||void 0===n?void 0:n.engine;if(!0===n)return null;if(Bt(r))return null;var i;if("function"===typeof r.hyperformula||"function"===typeof r)return function(e,t,n){const r=t[pP],i=function(e){var t;const n=e[pP],r=RM(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),i=xM(e);return{...SM,...r,...i}}(t),o=EM(),s=TM();(function(e,t){t&&t.forEach(t=>{const{name:n,plugin:r,translations:i}=t;try{e.registerFunction(n,r,i)}catch(o){Bn(o.message)}})})(e,r.functions),function(e,t){if(t){const{langCode:r}=t;try{e.registerLanguage(r,t)}catch(n){Bn(n.message)}}}(e,r.language);const a=e.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach(t=>{const{name:n,expression:r,scope:i,options:o}=t;try{e.addNamedExpression(n,r,i,o)}catch(s){Bn(s.message)}}),e.resumeEvaluation())}(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}(null!==(i=r.hyperformula)&&void 0!==i?i:r,t,e);if("object"===typeof r&&Bt(r.hyperformula)){const t=EM(),n=TM().get(r);return t.has(r)||t.set(r,[]),t.get(r).push(e),n&&n.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:yM}),r.getConfig().leapYear1900===SM.leapYear1900&&!1!==cn(r.getConfig().nullDate,SM.nullDate)||Bn(_t`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function MM(e){var t;const n=EM(),r=0===n.size?[]:Array.from(null!==(t=n.get(e))&&void 0!==t?t:[]);return new Map(r.map(e=>[e.getPlugin("formulas").sheetId,e]))}function PM(e,t){if(e){const n=EM(),r=n.get(e),i=TM(),o=i.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&n.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(i.delete(e),e.destroy()))}}const IM="DD/MM/YYYY";function AM(e,t){return"string"===typeof e&&"date"===t}function DM(e,t){return Mt(e,t,!0).isValid()}function FM(e,t){return Mt(e,t,!0).format(IM)}function OM(e,t){return Mt(e,IM,!0).format(t)}function NM(e,t){const n=new Date(Date.UTC(0,0,e+-1));return Mt(n).format(t)}function LM(e,t,n){const r=function(e,t){const n=[];return e.forEach(e=>{const r={from:e,to:t};n.forEach(e=>{const t=e.from>e.to,n=e.to<=r.from;e.from>r.from&&n&&t&&(r.from+=1)}),r.from>=t&&(t+=1),n.push(r)}),n}(e,function(e,t,n){const r=Array.from(Array(n).keys()).filter(t=>!1===e.includes(t));var i;return 0===t?null!==(i=r[t])&&void 0!==i?i:0:r[t-1]+1}(e,t,n));return function(e){return e.forEach((t,n)=>{e.slice(n+1).forEach(e=>{const n=e.from<e.to;e.from>t.from&&n&&(e.from-=1)})}),e}(r)}function _M(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function HM(e,t){return e.get(BM(e,t))}function VM(e,t,n){return e.set(BM(e,t),n),n}function BM(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var WM=new WeakMap,zM=new WeakMap,jM=new WeakMap,GM=new WeakMap,$M=new WeakMap,UM=new WeakMap,KM=new WeakMap;const YM=class{constructor(e,t,n){_M(this,WM,void 0),_M(this,zM,void 0),_M(this,jM,void 0),_M(this,GM,[]),_M(this,$M,[]),_M(this,UM,void 0),_M(this,KM,[]),VM(WM,this,e),VM(zM,this,t),VM(jM,this,n)}setRemovedHfIndexes(e){return VM(KM,this,e.map(e=>{const t=HM(zM,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)})),HM(KM,this)}getRemovedHfIndexes(){return HM(KM,this)}getHfIndexFromVisualIndex(e){const t=HM(zM,this).getIndexesSequence(),n=HM(zM,this).getNotTrimmedIndexes();return t.indexOf(n[e],e)}syncMoves(e){const t=`move${he(HM(WM,this))}s`;HM(jM,this).getEngine().batch(()=>{e.forEach(e=>{const n=e.from!==e.to,r=e.from+1!==e.to;n&&r&&HM(jM,this).getEngine()[t](HM(jM,this).getSheetId(),e.from,1,e.to)})})}storeMovesInformation(e,t,n){!1!==n&&(VM($M,this,e.map(e=>this.getHfIndexFromVisualIndex(e))),VM(UM,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(HM(jM,this).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const n=LM(HM($M,this),HM(UM,this),HM(zM,this).getNumberOfIndexes());null===HM(jM,this).getSheetId()?HM(jM,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${he(HM(WM,this))}Order`;return t=>{if(HM(jM,this).isPerformingUndoRedo())return;const n=HM(zM,this).getIndexesSequence();if("update"===t&&n.length>0){const t=HM(GM,this).map(e=>n.indexOf(e)),r=HM(jM,this).getEngine().getSheetDimensions(HM(jM,this).getSheetId());let i;i="row"===HM(WM,this)?r.height:r.width;for(let e=t.length;e<i;e+=1)t.push(e);HM(jM,this).getEngine()[e](HM(jM,this).getSheetId(),t)}VM(GM,this,n)}}init(){VM(GM,this,HM(zM,this).getIndexesSequence())}};function qM(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function XM(e,t){return e.get(JM(e,t))}function QM(e,t,n){return e.set(JM(e,t),n),n}function JM(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var ZM=new WeakMap,eP=new WeakMap,tP=new WeakMap,nP=new WeakMap,rP=new WeakMap,iP=new WeakMap,oP=new WeakMap;const sP=class{constructor(e,t,n){qM(this,ZM,void 0),qM(this,eP,void 0),qM(this,tP,void 0),qM(this,nP,!1),qM(this,rP,!1),qM(this,iP,null),qM(this,oP,null),QM(ZM,this,new YM("row",e,this)),QM(eP,this,new YM("column",t,this)),QM(tP,this,n)}getForAxis(e){return XM("row"===e?ZM:eP,this)}setPerformUndo(e){QM(nP,this,e)}setPerformRedo(e){QM(rP,this,e)}isPerformingUndoRedo(){return XM(nP,this)||XM(rP,this)}getSheetId(){return XM(oP,this)}getEngine(){return XM(iP,this)}getPostponeAction(){return XM(tP,this)}setupSyncEndpoint(e,t){QM(iP,this,e),QM(oP,this,t),XM(ZM,this).init(),XM(eP,this).init()}};function aP(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lP(e,t,n){cP(e,t),t.set(e,n)}function cP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uP(e,t,n){return e.set(hP(e,t),n),n}function dP(e,t){return e.get(hP(e,t))}function hP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const pP="formulas",gP=["maxRows","maxColumns","language"];ir.getSingleton().register("afterNamedExpressionAdded"),ir.getSingleton().register("afterNamedExpressionRemoved"),ir.getSingleton().register("afterSheetAdded"),ir.getSingleton().register("afterSheetRemoved"),ir.getSingleton().register("afterSheetRenamed"),ir.getSingleton().register("afterFormulasValuesUpdate");const fP=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var mP=new WeakMap,vP=new WeakMap,wP=new WeakMap,bP=new WeakSet;class CP extends vw{constructor(){var e,t,n;super(...arguments),e=this,cP(t=this,n=bP),n.add(t),lP(this,mP,!1),lP(this,vP,!1),lP(this,wP,[["valuesUpdated",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,BP).call(e,...n)}],["namedExpressionAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,WP).call(e,...n)}],["namedExpressionRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,zP).call(e,...n)}],["sheetAdded",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,jP).call(e,...n)}],["sheetRenamed",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,GP).call(e,...n)}],["sheetRemoved",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hP(bP,e,$P).call(e,...n)}]]),aP(this,"staticRegister",ar("formulas")),aP(this,"engine",null),aP(this,"sheetId",null),aP(this,"sheetName",null),aP(this,"indexSyncer",null),aP(this,"rowAxisSyncer",null),aP(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return pP}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[pP,...gP]}isEnabled(){return!!this.hot.getSettings()[pP]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=kM(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&hP(bP,this,yP).call(this,e)}this.addHook("beforeLoadData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,RP).call(t,...n)}),this.addHook("afterLoadData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,TP).call(t,...n)}),this.addHook("beforeUpdateData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,RP).call(t,...n)}),this.addHook("afterUpdateData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,TP).call(t,...n)}),this.addHook("modifyData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,kP).call(t,...n)}),this.addHook("modifySourceData",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,MP).call(t,...n)}),this.addHook("beforeValidate",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,SP).call(t,...n)}),this.addHook("afterSetSourceDataAtCell",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,IP).call(t,...n)}),this.addHook("afterSetDataAtCell",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,PP).call(t,...n)}),this.addHook("afterSetDataAtRowProp",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,PP).call(t,...n)}),this.addHook("beforeCreateRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,AP).call(t,...n)}),this.addHook("beforeCreateCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,DP).call(t,...n)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,NP).call(t,...n)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,LP).call(t,...n)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,FP).call(t,...n)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,OP).call(t,...n)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,_P).call(t,...n)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,HP).call(t,...n)}),this.indexSyncer=new sP(this.hot.rowIndexMapper,this.hot.columnIndexMapper,e=>{this.hot.addHookOnce("init",()=>{e()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(e,t,n,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("beforeColumnMove",(e,t,n,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("afterRowMove",(e,t,n,r,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("afterColumnMove",(e,t,n,r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,i)}),this.hot.addHook("beforeColumnFreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)}),this.hot.addHook("afterColumnFreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.hot.addHook("beforeColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)}),this.hot.addHook("afterColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.addHook("afterCellMetaReset",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,EP).call(t,...n)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,VP).call(t,...n)}),this.addHook("beforeAutofill",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return hP(bP,t,xP).call(t,...n)}),dP(wP,this).forEach(e=>{let[t,n]=e;return this.engine.on(t,n)}),super.enablePlugin()}else Bn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){dP(wP,this).forEach(e=>{let[t,n]=e;return this.engine.off(t,n)}),PM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const n=e[pP];return{...RM(null!==n&&void 0!==n&&null!==(t=n.engine)&&void 0!==t&&t.hyperformula?n.engine:{}),...xM(e)}}(this.hot.getSettings());(function(e,t){return Object.keys(t).some(n=>void 0!==t[n]&&t[n]!==e[n])})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[pP];if(Vt(n)&&Vt(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[pP].sheetName;if(e&&this.engine.doesSheetExist(e))this.switchSheet(this.sheetName);else{const t=this.addSheet(null!==e&&void 0!==e?e:void 0,this.hot.getSourceDataArray());hP(bP,this,yP).call(this,t)}}super.updatePlugin(e)}destroy(){dP(wP,this).forEach(e=>{var t;let[n,r]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(n,r)}),uP(wP,this,null),PM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Vt(t)&&(n=t,!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))))return Bn("The provided data should be an array of arrays."),!1;var n;if(void 0!==e&&null!==e&&this.engine.doesSheetExist(e))return Bn("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(null!==e&&void 0!==e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(r){return Bn(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void Wn(`The sheet named \`${e}\` does not exist, switch aborted.`);hP(bP,this,yP).call(this,e);const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${he(pP)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==r&&null!==i?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new Set;e.forEach(e=>{var t;const r=null===e||void 0===e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==r&&(n.has(r)||n.add(r))}),MM(this.engine).forEach((e,r)=>{var i;(t||r!==this.sheetId)&&n.has(r)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())})}validateDependentCells(e){const t=e=>{var t;const{row:n,col:r,sheet:i}=null!==(t=null===e||void 0===e?void 0:e.address)&&void 0!==t?t:{};return Vt(i)?`${i}:${n}x${r}`:""},n=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map(e=>t(e)));e.forEach(e=>{var r,i;const{row:o,col:s}=null!==(r=e.address)&&void 0!==r?r:{};if(!1===Vt(o)||!1===Vt(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;const a=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.sheet,l=t(e);if(void 0!==a&&!n.has(l)){const e=MM(this.engine).get(a);if(!e)return;e.validateCell(e.getDataAtCell(o,s),e.getCellMeta(o,s),()=>{})}})}syncChangeWithEngine(e,t,n){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r))return void Bn(`Not possible to set cell data at ${JSON.stringify(r)}`);const i=this.hot.getCellMeta(e,t);var o;return AM(n,i.type)&&(DM(n,i.dateFormat)?n=FM(n,i.dateFormat):!1===("string"===typeof(o=n)&&o.startsWith("="))&&(n=`'${n}`)),this.engine.setCellContents(r,n)}}function yP(e){this.sheetName=e,this.sheetId=this.engine.getSheetId(this.sheetName)}function SP(e,t,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(t,r)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},n=this.hot.getCellMeta(t,r);let i=this.engine.getCellValue(e);return"date"===n.type&&Qr(i)&&(i=NM(i,n.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return e}function xP(e,t,n){const{row:r,col:i}=t.getTopStartCorner(),{row:o,col:s}=t.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:c,col:u}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(h))return!1;const p=this.engine.getFillRangeData(d,h),{row:g,col:f}=d.start,{row:m,col:v}=d.end,w=m-g+1,b=v-f+1;for(let C=0;C<p.length;C+=1)for(let e=0;e<p[C].length;e+=1){const t=p[C][e],n=g+C%w,r=f+e%b,i=this.hot.getCellMeta(n,r);AM(t,i.type)&&(t.startsWith("'")?p[C][e]=t.slice(1):!1===this.isFormulaCellType(n,r,this.sheetId)&&(p[C][e]=OM(t,i.dateFormat)))}return p}function RP(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(he(pP))||uP(vP,this,Bt(this.hot.getSettings().data))}function EP(){if(dP(vP,this))return void this.switchSheet(this.sheetName);const e=this.hot.getSourceDataArray();e.forEach((t,n)=>{t.forEach((t,r)=>{const i=this.hot.getCellMeta(n,r,{skipMetaExtension:!0}),o=i.dateFormat;AM(t,i.type)&&(DM(t,o)?e[n][r]=FM(t,o):t.startsWith("=")||(e[n][r]=`'${t}`))})}),uP(mP,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),uP(mP,this,!1)}function TP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.includes(he(pP)))return;const r=function(e,t){return!Bt(t)&&e.doesSheetExist(t)||(t=e.addSheet(t)),t}(this.engine,this.hot.getSettings()[pP].sheetName);if(hP(bP,this,yP).call(this,r),"updateSettings"!==n)if(dP(vP,this))this.switchSheet(this.sheetName);else{const e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){uP(mP,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),uP(mP,this,!1)}}}function kP(e,t,n,r){if("get"!==r||dP(mP,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(null===i||null===t)return;const o=this.getCellType(i,t);if("VALUE"===o||"EMPTY"===o)return void(n.value=(s=n.value,function(e){return"string"===typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}(s)?s.substr(1):s));var s;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let l=this.engine.getCellValue(a);const c=this.hot.getCellMeta(i,t,{skipMetaExtension:!0});"date"===c.type&&Qr(l)&&(l=NM(l,c.dateFormat)),n.value="object"===typeof l&&null!==l?l.value:l}function MP(e,t,n,r){if("get"!==r||dP(mP,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===i||null===o)return;const s=this.getCellType(i,o);if("VALUE"===s||"EMPTY"===s)return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===a.width&&0===a.height)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function PP(e,t){if(fP(t))return;const n=[],r=[],i=this.engine.batch(()=>{e.forEach(e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i),a=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(s),c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==a&&null!==l?this.syncChangeWithEngine(t,s,o):n.push([t,s,o]),r.push({address:c})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const e=this.engine.batch(()=>{n.forEach(e=>{let[t,n,r]=e;this.syncChangeWithEngine(t,n,r)})});this.renderDependentSheets(e,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function IP(e,t){if(fP(t))return;const n=[],r=[];e.forEach(e=>{let[t,i,,o]=e;const s=this.hot.propToCol(i);if(!Qr(s))return;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(a)?(r.push({address:a}),n.push(...this.engine.setCellContents(a,o))):Bn(`Not possible to set source cell data at ${JSON.stringify(a)}`)}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function AP(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}function DP(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}function FP(e,t,n){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1]))&&void 0}function OP(e,t,n){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(n).every(e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1]))&&void 0}function NP(e,t,n){if(fP(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function LP(e,t,n){if(fP(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function _P(e,t,n,r){if(fP(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeRows(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function HP(e,t,n,r){if(fP(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{i.forEach(e=>{this.engine.removeColumns(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function VP(e,t,n){var r;uP(mP,this,!0);const i=this.hot.getSourceDataArray(n,0,n+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());uP(mP,this,!1),i.forEach((e,t)=>{e.forEach((e,r)=>{this.engine.setCellContents({col:r,row:n+t,sheet:this.sheetId},[[e]])})})}function BP(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function WP(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function zP(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function jP(e){this.hot.runHooks("afterSheetAdded",e)}function GP(e,t){hP(bP,this,yP).call(this,t),this.hot.runHooks("afterSheetRenamed",e,t)}function $P(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}function UP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KP(e,t){return e.get(qP(e,t))}function YP(e,t,n){return e.set(qP(e,t),n),n}function qP(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeHideColumns"),ir.getSingleton().register("afterHideColumns"),ir.getSingleton().register("beforeUnhideColumns"),ir.getSingleton().register("afterUnhideColumns");const XP="hiddenColumns";var QP=new WeakMap,JP=new WeakSet;class ZP extends vw{constructor(){var e,t;super(...arguments),UP(e=this,t=JP),t.add(e),function(e,t,n){UP(e,t),t.set(e,n)}(this,QP,null)}static get PLUGIN_KEY(){return XP}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[XP]}enablePlugin(){var e=this;this.enabled||(YP(QP,this,new uc),KP(QP,this).addLocalHook("init",()=>qP(JP,this,oI).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,KP(QP,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qP(JP,e,iI).call(e,...n)}),this.addHook("afterGetCellMeta",(e,t,n)=>qP(JP,this,tI).call(this,e,t,n)),this.addHook("modifyColWidth",(e,t)=>qP(JP,this,eI).call(this,e,t),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return qP(JP,e,rI).call(e,...n)}),this.addHook("modifyCopyableRange",e=>qP(JP,this,nI).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;const i=KP(QP,this).getValues().slice(),o=e.length>0;if(n&&o){Ot(e.map(e=>this.hot.toPhysicalColumn(e)),e=>{i[e]=!1}),r=At(i,(e,t,n)=>(t&&e.push(this.hot.toVisualColumn(n)),e),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,r,n&&o)&&(n&&o&&KP(QP,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,n&&o,n&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,r,n)&&(n&&this.hot.batchExecution(()=>{Ot(e,e=>{KP(QP,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)})},!0),this.hot.runHooks("afterHideColumns",t,r,n,n&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return Ft(KP(QP,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return KP(QP,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){Ot(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){YP(QP,this,null),super.destroy()}}function eI(e,t){return this.isHidden(t)?0:this.getSetting("indicators")&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"===typeof e&&this.hot.hasColHeaders()?e+15:void 0}function tI(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenColumn")&&(n.className+=" afterHiddenColumn");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function nI(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Ot(e,e=>{let t=!0,r=0;Zr(e.startCol,e.endCol,i=>{this.isHidden(i)?(t||n(e.startRow,e.endRow,r,i-1),t=!0):(t&&(r=i),i===e.endCol&&n(e.startRow,e.endRow,r,i),t=!1)})}),t}function rI(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),$e(t,n)}function iI(e){var t;e.items.push({name:Ty},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,r]=e;n-r!==0&&(t=1)}return this.getTranslatedPhrase(Mu,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Pu,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ft(e.getHiddenColumns(),e=>this.toPhysicalColumn(e));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),c=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=c.slice(i,o+1);u.push(...e.filter(e=>n.includes(e)))}}else if(0===a&&a<i)u.push(...c.slice(0,i));else if(null===a)u.push(...c.slice(0,this.countCols()));else{const e=this.countCols()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return Ot(u,e=>{t.push(this.toVisualColumn(e))}),0===t.length}}}(this))}function oI(){const e=this.getSetting("columns");Array.isArray(e)&&this.hideColumns(e)}function sI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aI(e,t){return e.get(cI(e,t))}function lI(e,t,n){return e.set(cI(e,t),n),n}function cI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeHideRows"),ir.getSingleton().register("afterHideRows"),ir.getSingleton().register("beforeUnhideRows"),ir.getSingleton().register("afterUnhideRows");const uI="hiddenRows";var dI=new WeakMap,hI=new WeakSet;class pI extends vw{constructor(){var e,t;super(...arguments),sI(e=this,t=hI),t.add(e),function(e,t,n){sI(e,t),t.set(e,n)}(this,dI,null)}static get PLUGIN_KEY(){return uI}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[uI]}enablePlugin(){var e=this;this.enabled||(lI(dI,this,new uc),aI(dI,this).addLocalHook("init",()=>cI(hI,this,bI).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,aI(dI,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cI(hI,e,wI).call(e,...n)}),this.addHook("afterGetCellMeta",(e,t,n)=>cI(hI,this,fI).call(this,e,t,n)),this.addHook("modifyRowHeight",(e,t)=>cI(hI,this,gI).call(this,e,t)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cI(hI,e,vI).call(e,...n)}),this.addHook("modifyCopyableRange",e=>cI(hI,this,mI).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;const i=aI(dI,this).getValues().slice(),o=e.length>0;if(n&&o){Ot(e.map(e=>this.hot.toPhysicalRow(e)),e=>{i[e]=!1}),r=At(i,(e,t,n)=>(t&&e.push(this.hot.toVisualRow(n)),e),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,r,n&&o)&&(n&&o&&aI(dI,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,r,n&&o,n&&r.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,r,n)&&(n&&this.hot.batchExecution(()=>{Ot(e,e=>{aI(dI,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)})},!0),this.hot.runHooks("afterHideRows",t,r,n,n&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return Ft(aI(dI,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return aI(dI,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){Ot(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){lI(dI,this,null),super.destroy()}}function gI(e,t){return this.isHidden(t)?0:e}function fI(e,t,n){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",-1===n.className.indexOf("afterHiddenRow")&&(n.className+=" afterHiddenRow");else if(n.className){const e=n.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),n.className=e.join(" ")}}}function mI(e){if(this.getSetting("copyPasteEnabled"))return e;const t=[],n=(e,n,r,i)=>{t.push({startRow:e,endRow:n,startCol:r,endCol:i})};return Ot(e,e=>{let t=!0,r=0;Zr(e.startRow,e.endRow,i=>{this.isHidden(i)?(t||n(r,i-1,e.startCol,e.endCol),t=!0):(t&&(r=i),i===e.endRow&&n(r,i,e.startCol,e.endCol),t=!1)})}),t}function vI(e,t){if(!this.getSetting("indicators")||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),$e(t,n)}function wI(e){var t;e.items.push({name:Ty},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,r]=e;n-r!==0&&(t=1)}return this.getTranslatedPhrase(Iu,t)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let t=r;t<=i;t+=1)o.push(t);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Au,e)},callback(){var n,r;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==n?n:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ft(e.getHiddenRows(),e=>this.toPhysicalRow(e));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||n.length<1)return!0;t.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),c=s.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-a+1){const e=c.slice(i,o+1);u.push(...e.filter(e=>n.includes(e)))}}else if(0===a&&a<i)u.push(...c.slice(0,i));else if(null===a)u.push(...c.slice(0,this.countRows()));else{const e=this.countRows()-1;l===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return Ot(u,e=>{t.push(this.toVisualRow(e))}),0===t.length}}}(this))}function bI(){const e=this.getSetting("rows");Array.isArray(e)&&this.hideRows(e)}function CI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yI(e,t){return e.get(xI(e,t))}function SI(e,t,n){return e.set(xI(e,t),n),n}function xI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeColumnFreeze"),ir.getSingleton().register("afterColumnFreeze"),ir.getSingleton().register("beforeColumnUnfreeze"),ir.getSingleton().register("afterColumnUnfreeze");const RI="manualColumnFreeze";var EI=new WeakMap,TI=new WeakSet;class kI extends vw{constructor(){var e,t;super(...arguments),CI(e=this,t=TI),t.add(e),function(e,t,n){CI(e,t),t.set(e,n)}(this,EI,!1)}static get PLUGIN_KEY(){return RI}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[RI]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>xI(TI,this,MI).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>xI(TI,this,PI).call(this,e,t)),super.enablePlugin())}disablePlugin(){SI(EI,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;yI(EI,this)||SI(EI,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,n)&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const t=this.hot.getSettings(),n=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;yI(EI,this)||SI(EI,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,n)&&(n&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function MI(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(iu)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ou)},callback(t,n){const[{start:{col:r}}]=n;e.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function PI(e,t){if(yI(EI,this)){const n=this.hot.getSettings().fixedColumnsStart;if(t<n)return!1;if(e.some(e=>e<n))return!1}}function II(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const AI="px";const DI=class{constructor(e){II(this,"hot",void 0),II(this,"_element",null),II(this,"state",0),II(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){Qr(e)&&(this._element.style.top=e+AI),Qr(t)&&(this._element.style[this.inlineProperty]=t+AI)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Qr(e)&&(this._element.style.width=e+AI),Qr(t)&&(this._element.style.height=t+AI)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Qr(e)&&(this._element.style.marginTop=e+AI),Qr(t)&&(this._element.style[`margin${he(this.inlineProperty)}`]=t+AI)}getOffset(){const e=this._element.style,t=`margin${he(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const FI=class extends DI{build(){super.build(),$e(this._element,"ht__manualColumnMove--backlight")}};const OI=class extends DI{build(){super.build(),$e(this._element,"ht__manualColumnMove--guideline")}};function NI(e,t,n){LI(e,t),t.set(e,n)}function LI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _I(e,t,n){return e.set(VI(e,t),n),n}function HI(e,t){return e.get(VI(e,t))}function VI(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeColumnMove"),ir.getSingleton().register("afterColumnMove");const BI="manualColumnMove",WI="ht__manualColumnMove",zI="show-ui",jI="on-moving--columns",GI="after-selection--columns";var $I=new WeakMap,UI=new WeakMap,KI=new WeakMap,YI=new WeakMap,qI=new WeakMap,XI=new WeakMap,QI=new WeakMap,JI=new WeakMap,ZI=new WeakMap,eA=new WeakMap,tA=new WeakMap,nA=new WeakSet;class rA extends vw{constructor(){var e,t;super(...arguments),LI(e=this,t=nA),t.add(e),NI(this,$I,new FI(this.hot)),NI(this,UI,new OI(this.hot)),NI(this,KI,[]),NI(this,YI,0),NI(this,qI,!1),NI(this,XI,{}),NI(this,QI,void 0),NI(this,JI,void 0),NI(this,ZI,void 0),NI(this,eA,void 0),NI(this,tA,void 0)}static get PLUGIN_KEY(){return BI}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[BI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VI(nA,e,iA).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VI(nA,e,sA).call(e,...n)}),this.addHook("afterScrollVertically",()=>VI(nA,this,lA).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return VI(nA,e,cA).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),$e(this.hot.rootElement,WI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,WI),this.unregisterEvents(),HI($I,this).destroy(),HI(UI,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=HI(QI,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,n,r);if(_I(QI,this,void 0),!1===i)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,n,r,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t);return _I(QI,this,t),this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some(e=>e<0),s=e.some(e=>e>=n);return!(r||i||o||s)}isColumnOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}countFinalIndex(e,t){const n=At(e,(e,n)=>(n<t&&(e+=1),e),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let r=0;for(let i=e;i<=t;i+=1){const e=n.getRenderableFromVisualIndex(i);i<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(r+=this.hot.view._wt.wtTable.getColumnWidth(e)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[BI];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return Zr(e,t,e=>{n.push(e)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(HI(JI,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,r="number"===typeof n.scrollX?n.scrollX:n.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,HI(JI,this)-1);const o=t.hider.offsetWidth,s=t.TBODY.offsetLeft,a=HI($I,this).getOffset().start,l=HI($I,this).getSize().width;let c=0,u=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,t=ct(this.hot.rootElement),i=e.innerWidth-HI(ZI,this)-t;u=e.innerWidth-HI(XI,this).eventPageX-i-(void 0===n.scrollX?r:0)}else u=HI(XI,this).eventPageX-(HI(ZI,this)-(void 0===n.scrollX?r:0));if(HI(eA,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(HI(JI,this))&&(i+=r),i+=c,HI(JI,this)<0)HI(tA,this)>0?HI(XI,this).col=0:HI(XI,this).col=e>0?e-1:e;else if(HI(XI,this).TD.offsetWidth/2+i<=u){const e=HI(JI,this)>=HI(YI,this)?HI(YI,this)-1:HI(JI,this);HI(XI,this).col=e+1,i+=HI(XI,this).TD.offsetWidth}else HI(XI,this).col=HI(JI,this);let d=u,h=i;u+l+a>=o?d=o-l-a:u+a<s+c&&(d=s+c+Math.abs(a)),i>=o-1?h=o-1:0===h?h=1:void 0!==n.scrollX&&HI(JI,this)<HI(tA,this)&&(h-=HI(ZI,this)<=n.scrollX?HI(ZI,this):0),HI($I,this).setPosition(null,d),HI(UI,this).setPosition(null,h)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>VI(nA,this,oA).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>VI(nA,this,aA).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){HI($I,this).build(),HI(UI,this).build()}destroy(){HI($I,this).destroy(),HI(UI,this).destroy(),super.destroy()}}function iA(e,t,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ge(e.target,"sortAction");if(!s||!o||HI(qI,this)||0!==e.button||a)return _I(qI,this,!1),HI(KI,this).length=0,void Ue(this.hot.rootElement,[jI,zI]);const l=HI(UI,this).isBuilt()&&!HI(UI,this).isAppended(),c=HI($I,this).isBuilt()&&!HI($I,this).isAppended();l&&c&&(HI(UI,this).appendTo(i.hider),HI($I,this).appendTo(i.hider));const{from:u,to:d}=s,h=Math.min(u.col,d.col),p=Math.max(u.col,d.col);if(t.row<0&&t.col>=h&&t.col<=p){r.column=!0,_I(qI,this,!0);const o=n.firstChild?function(e,t){const n={x:e.offsetX,y:e.offsetY};let r=e.target;if(!kt(t)||r!==t&&r.contains(t))return n;for(;r!==t;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}(e,n.firstChild).x:e.offsetX;HI(XI,this).eventPageX=e.pageX,_I(JI,this,t.col),HI(XI,this).TD=n,HI(XI,this).col=t.col,_I(KI,this,this.prepareColumnsToMoving(h,p)),_I(eA,this,!!this.hot.getSettings().rowHeaders),_I(YI,this,this.hot.countCols()),_I(tA,this,this.hot.getSettings().fixedColumnsStart),_I(ZI,this,tt(this.hot.rootElement).left);const s=HI(eA,this)?-1:0,a=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=t.col<HI(tA,this),c=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?n.offsetWidth:0)),d=this.getColumnsWidth(h,t.col-1)+u,g=this.getColumnsWidth(s,h-1)+(l?c:0)+d;HI($I,this).setPosition(a,g),HI($I,this).setSize(this.getColumnsWidth(h,p),i.hider.offsetHeight-a),HI($I,this).setOffset(null,-d),$e(this.hot.rootElement,jI)}else Ue(this.hot.rootElement,GI),_I(qI,this,!1),HI(KI,this).length=0}function oA(e){HI(qI,this)&&(HI(XI,this).eventPageX=e.pageX,this.refreshPositions())}function sA(e,t,n,r){this.hot.getSelectedRangeLast()&&HI(qI,this)&&(HI(KI,this).indexOf(t.col)>-1?Ue(this.hot.rootElement,zI):$e(this.hot.rootElement,zI),r.row=!0,r.column=!0,r.cell=!0,_I(JI,this,t.col),HI(XI,this).TD=n)}function aA(){const e=HI(XI,this).col,t=HI(KI,this).length;if(_I(JI,this,void 0),_I(qI,this,!1),Ue(this.hot.rootElement,[jI,zI,GI]),this.hot.selection.isSelectedByColumnHeader()&&$e(this.hot.rootElement,GI),t<1||void 0===e)return;const n=HI(KI,this)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(HI(KI,this),e);if(HI(KI,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualColumn(r),n=e+t-1;this.hot.selectColumns(e,n)}}function lA(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;HI($I,this).setPosition(t),HI($I,this).setSize(null,e.hider.offsetHeight-t)}function cA(){this.moveBySettingsOrLoad()}function uA(e,t,n){dA(e,t),t.set(e,n)}function dA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hA(e,t,n){return e.set(gA(e,t),n),n}function pA(e,t){return e.get(gA(e,t))}function gA(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const fA="manualColumnResize",mA="manualColumnWidths";var vA=new WeakMap,wA=new WeakMap,bA=new WeakMap,CA=new WeakMap,yA=new WeakMap,SA=new WeakMap,xA=new WeakMap,RA=new WeakMap,EA=new WeakMap,TA=new WeakMap,kA=new WeakMap,MA=new WeakMap,PA=new WeakMap,IA=new WeakMap,AA=new WeakMap,DA=new WeakMap,FA=new WeakSet;class OA extends vw{static get PLUGIN_KEY(){return fA}static get PLUGIN_PRIORITY(){return 130}constructor(e){var t,n;super(e),dA(t=this,n=FA),n.add(t),uA(this,vA,null),uA(this,wA,null),uA(this,bA,[]),uA(this,CA,null),uA(this,yA,null),uA(this,SA,null),uA(this,xA,null),uA(this,RA,null),uA(this,EA,this.hot.rootDocument.createElement("DIV")),uA(this,TA,this.hot.rootDocument.createElement("DIV")),uA(this,kA,null),uA(this,MA,!1),uA(this,PA,0),uA(this,IA,null),uA(this,AA,void 0),uA(this,DA,void 0),$e(pA(EA,this),"manualColumnResizer"),$e(pA(TA,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[fA]}enablePlugin(){var e=this;this.enabled||(hA(AA,this,new cc),pA(AA,this).addLocalHook("init",()=>gA(FA,this,NA).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,pA(AA,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gA(FA,e,WA).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gA(FA,e,zA).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return gA(FA,e,jA).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){hA(DA,this,pA(AA,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",mA,pA(AA,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",mA,e),e.value}setManualSize(e,t){const n=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return pA(AA,this).setValueAtIndex(r,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);pA(AA,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;hA(vA,this,e);const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(pA(vA,this)),r=n.col;if(r<0)return;const i=ut(pA(vA,this)),o=pA(vA,this).getBoundingClientRect();let s;r<t.getSetting("fixedColumnsStart")&&(s=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(pA(vA,this),n.row,n.col)),s||(s=t.wtOverlays.topOverlay.getRelativeCellPosition(pA(vA,this),n.row,n.col)),hA(wA,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),hA(bA,this,[]);const a=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&a){Ot(this.hot.getSelectedRange(),e=>{Zr(e.getTopStartCorner().col,e.getBottomEndCorner().col,e=>{pA(bA,this).includes(e)||pA(bA,this).push(e)})})}pA(bA,this).includes(pA(wA,this))||hA(bA,this,[pA(wA,this)]),hA(RA,this,s.start-6),hA(xA,this,parseInt(o.width,10)),pA(EA,this).style.top=`${s.top}px`,pA(EA,this).style[this.inlineDir]=`${pA(RA,this)+pA(xA,this)}px`,pA(EA,this).style.height=`${i}px`,this.hot.rootElement.appendChild(pA(EA,this))}refreshHandlePosition(){pA(EA,this).style[this.inlineDir]=`${pA(RA,this)+pA(CA,this)}px`}setupGuidePosition(){const e=parseInt(ut(pA(EA,this)),10),t=parseInt(pA(EA,this).style.top,10)+e,n=this.hot.view.getTableHeight();$e(pA(EA,this),"active"),$e(pA(TA,this),"active"),pA(TA,this).style.top=`${t}px`,this.refreshGuidePosition(),pA(TA,this).style.height=n-e+"px",this.hot.rootElement.appendChild(pA(TA,this))}refreshGuidePosition(){pA(TA,this).style[this.inlineDir]=pA(EA,this).style[this.inlineDir]}hideHandleAndGuide(){Ue(pA(EA,this),"active"),Ue(pA(TA,this),"active")}checkIfColumnHeader(e){const t=He(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeColumnResize",pA(yA,this),t,!0);void 0!==r&&hA(yA,this,r),this.setManualSize(t,pA(yA,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pA(yA,this),t,!0),n&&e()};if(pA(PA,this)>=2){pA(bA,this).length>1?(Ot(pA(bA,this),e=>{t(e)}),e()):Ot(pA(bA,this),e=>{t(e,!0)})}hA(PA,this,0),hA(IA,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",e=>gA(FA,this,LA).call(this,e)),this.eventManager.addEventListener(t,"mousedown",e=>gA(FA,this,_A).call(this,e)),this.eventManager.addEventListener(e,"mousemove",e=>gA(FA,this,HA).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>gA(FA,this,VA).call(this)),this.eventManager.addEventListener(pA(EA,this),"contextmenu",()=>gA(FA,this,BA).call(this))}destroy(){super.destroy()}}function NA(){const e=this.hot.getSettings()[fA],t=this.loadManualColumnWidths();"undefined"!==typeof t?this.hot.batchExecution(()=>{t.forEach((e,t)=>{pA(AA,this).setValueAtIndex(t,e)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((e,t)=>{pA(AA,this).setValueAtIndex(t,e)})},!0),hA(DA,this,e)):!0===e&&Array.isArray(pA(DA,this))&&this.hot.batchExecution(()=>{pA(DA,this).forEach((e,t)=>{pA(AA,this).setValueAtIndex(t,e)})},!0)}function LA(e){if(!Rt(e.target)&&!0!==pA(MA,this)&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");!t||null!==n&&"1"!==n||pA(kA,this)||this.setupHandlePosition(t)}}function _A(e){e.target.parentNode===this.hot.rootElement&&Ge(e.target,"manualColumnResizer")&&(this.setupHandlePosition(pA(vA,this)),this.setupGuidePosition(),hA(kA,this,!0),null===pA(IA,this)&&(hA(IA,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(pA(IA,this))),hA(PA,this,pA(PA,this)+1),this.startX=e.pageX,hA(yA,this,pA(xA,this)))}function HA(e){if(pA(kA,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();hA(CA,this,pA(xA,this)+t),Ot(pA(bA,this),e=>{hA(yA,this,this.setManualSize(e,pA(CA,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function VA(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeColumnResize",pA(yA,this),t,!1),n&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",pA(yA,this),t,!1)};if(pA(kA,this)){if(this.hideHandleAndGuide(),hA(kA,this,!1),pA(yA,this)!==pA(xA,this)){pA(bA,this).length>1?(Ot(pA(bA,this),e=>{t(e)}),e()):Ot(pA(bA,this),e=>{t(e,!0)})}this.setupHandlePosition(pA(vA,this))}}function BA(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(pA(EA,this)),this.hot.rootElement.removeChild(pA(TA,this)),hA(kA,this,!1),hA(MA,this,!0),this.hot._registerImmediate(()=>{hA(MA,this,!1)})}function WA(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),r=pA(AA,this).getValueAtIndex(e);this.hot.getSettings()[fA]&&r&&(n=r)}return n}function zA(e,t){const n=pA(AA,this).getValueAtIndex(this.hot.toPhysicalColumn(t));return"number"===typeof n?n:e}function jA(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function GA(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const $A="px";const UA=class{constructor(e){GA(this,"hot",void 0),GA(this,"_element",null),GA(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+$A),void 0!==t&&(this._element.style.left=t+$A)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+$A),t&&(this._element.style.height=t+$A)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+$A),t&&(this._element.style.marginLeft=t+$A)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const KA=class extends UA{build(){super.build(),$e(this._element,"ht__manualRowMove--backlight")}};const YA=class extends UA{build(){super.build(),$e(this._element,"ht__manualRowMove--guideline")}};function qA(e,t,n){XA(e,t),t.set(e,n)}function XA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QA(e,t,n){return e.set(ZA(e,t),n),n}function JA(e,t){return e.get(ZA(e,t))}function ZA(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeRowMove"),ir.getSingleton().register("afterRowMove");const eD="manualRowMove",tD="ht__manualRowMove",nD="show-ui",rD="on-moving--rows",iD="after-selection--rows";var oD=new WeakMap,sD=new WeakMap,aD=new WeakMap,lD=new WeakMap,cD=new WeakMap,uD=new WeakMap,dD=new WeakSet;class hD extends vw{constructor(){var e,t;super(...arguments),XA(e=this,t=dD),t.add(e),qA(this,oD,new KA(this.hot)),qA(this,sD,new YA(this.hot)),qA(this,aD,[]),qA(this,lD,void 0),qA(this,cD,{}),qA(this,uD,void 0)}static get PLUGIN_KEY(){return eD}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[eD]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ZA(dD,e,pD).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ZA(dD,e,fD).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>ZA(dD,this,vD).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ZA(dD,e,wD).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),$e(this.hot.rootElement,tD),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ue(this.hot.rootElement,tD),this.unregisterEvents(),JA(oD,this).destroy(),JA(sD,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=JA(uD,this),r=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,n,r);if(QA(uD,this,void 0),!1===i)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,n,r,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t);return QA(uD,this,t),this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>n,i=t<0,o=e.some(e=>e<0),s=e.some(e=>e>=n);return!(r||i||o||s)}isRowOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}countFinalIndex(e,t){const n=At(e,(e,n)=>(n<t&&(e+=1),e),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let r=0;for(let i=e;i<=t;i++){const e=n.getRenderableFromVisualIndex(i);null!==e&&(r+=this.hot.view._wt.wtTable.getRowHeight(e)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[eD];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:r}=e;return Zr(Math.min(n.row,r.row),Math.max(n.row,r.row),e=>{t.push(e)}),t}refreshPositions(){const e=JA(cD,this).coords,t=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&n<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,o=JA(cD,this).TD,s=this.hot.rootElement,a=tt(s),l=at(s),c=i.holder.scrollTop,u=this.hot.rootWindow!==l?l.scrollTop:0,d=a.top-u,h=JA(cD,this).eventPageY-d+c,p=i.hider.offsetHeight,g=i.TBODY.offsetTop,f=JA(oD,this).getOffset().top,m=JA(oD,this).getSize().height,v=o.offsetHeight/2,w=o.offsetHeight;let b=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const C=h>=b+v;this.isFixedRowTop(e.row)&&(b+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?JA(cD,this).row=t>0?t-1:t:C?(JA(cD,this).row=e.row+1,b+=0===e.row?w-1:w):JA(cD,this).row=e.row;let y=h,S=b;h+m+f>=p?y=p-m-f:h+f<g&&(y=g+Math.abs(f)),b>=p-1&&(S=p-1),JA(oD,this).setPosition(y),JA(sD,this).setPosition(S)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>ZA(dD,this,gD).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>ZA(dD,this,mD).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){JA(oD,this).build(),JA(sD,this).build()}destroy(){JA(oD,this).destroy(),JA(sD,this).destroy(),super.destroy()}}function pD(e,t,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||JA(lD,this)||0!==e.button)return QA(lD,this,!1),JA(aD,this).length=0,void Ue(this.hot.rootElement,[rD,nD]);const l=JA(sD,this).isBuilt()&&!JA(sD,this).isAppended(),c=JA(oD,this).isBuilt()&&!JA(oD,this).isAppended();l&&c&&(JA(sD,this).appendTo(i.hider),JA(oD,this).appendTo(i.hider));const{from:u,to:d}=a,h=Math.min(u.row,d.row),p=Math.max(u.row,d.row);if(t.col<0&&t.row>=h&&t.row<=p){r.row=!0,QA(lD,this,!0),JA(cD,this).eventPageY=e.pageY,JA(cD,this).coords=t,JA(cD,this).TD=n,QA(aD,this,this.prepareRowsToMoving());const s=i.holder.scrollLeft+o.getRowHeaderWidth(),a=this.getRowsHeight(h,t.row-1)+(e.clientY-n.getBoundingClientRect().top);JA(oD,this).setPosition(null,s),JA(oD,this).setSize(i.hider.offsetWidth-s,this.getRowsHeight(h,p)),JA(oD,this).setOffset(-a,null),$e(this.hot.rootElement,rD),this.refreshPositions()}else Ue(this.hot.rootElement,iD),QA(lD,this,!1),JA(aD,this).length=0}function gD(e){JA(lD,this)&&(JA(cD,this).eventPageY=e.pageY,this.refreshPositions())}function fD(e,t,n,r){this.hot.getSelectedRangeLast()&&JA(lD,this)&&(JA(aD,this).indexOf(t.row)>-1?Ue(this.hot.rootElement,nD):$e(this.hot.rootElement,nD),r.row=!0,r.column=!0,r.cell=!0,JA(cD,this).coords=t,JA(cD,this).TD=n)}function mD(){const e=JA(cD,this).row,t=JA(aD,this).length;if(QA(lD,this,!1),Ue(this.hot.rootElement,[rD,nD,iD]),this.hot.selection.isSelectedByRowHeader()&&$e(this.hot.rootElement,iD),t<1||void 0===e)return;const n=JA(aD,this)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(JA(aD,this),e);if(JA(aD,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualRow(r),n=e+t-1;this.hot.selectRows(e,n)}}function vD(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;JA(oD,this).setPosition(null,t),JA(oD,this).setSize(e.hider.offsetWidth-t)}function wD(){this.moveBySettingsOrLoad()}function bD(e,t,n){CD(e,t),t.set(e,n)}function CD(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yD(e,t,n){return e.set(xD(e,t),n),n}function SD(e,t){return e.get(xD(e,t))}function xD(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const RD="manualRowResize",ED="manualRowHeights";var TD=new WeakMap,kD=new WeakMap,MD=new WeakMap,PD=new WeakMap,ID=new WeakMap,AD=new WeakMap,DD=new WeakMap,FD=new WeakMap,OD=new WeakMap,ND=new WeakMap,LD=new WeakMap,_D=new WeakMap,HD=new WeakMap,VD=new WeakMap,BD=new WeakMap,WD=new WeakMap,zD=new WeakSet;class jD extends vw{static get PLUGIN_KEY(){return RD}static get PLUGIN_PRIORITY(){return 30}constructor(e){var t,n;super(e),CD(t=this,n=zD),n.add(t),bD(this,TD,null),bD(this,kD,null),bD(this,MD,[]),bD(this,PD,null),bD(this,ID,null),bD(this,AD,null),bD(this,DD,null),bD(this,FD,null),bD(this,OD,this.hot.rootDocument.createElement("DIV")),bD(this,ND,this.hot.rootDocument.createElement("DIV")),bD(this,LD,!1),bD(this,_D,!1),bD(this,HD,0),bD(this,VD,null),bD(this,BD,void 0),bD(this,WD,void 0),$e(SD(OD,this),"manualRowResizer"),$e(SD(ND,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[RD]}enablePlugin(){this.enabled||(yD(BD,this,new cc),SD(BD,this).addLocalHook("init",()=>xD(zD,this,XD).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,SD(BD,this)),this.addHook("modifyRowHeight",(e,t)=>xD(zD,this,qD).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){yD(WD,this,SD(BD,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",ED,SD(BD,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",ED,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),r=Math.max(t,this.hot.view.getDefaultRowHeight());return SD(BD,this).setValueAtIndex(n,r),r}getLastDesiredRowHeight(){return SD(PD,this)}setupHandlePosition(e){yD(TD,this,e);const{view:t}=this.hot,{_wt:n}=t,r=n.wtTable.getCoords(SD(TD,this)),i=r.row;if(i<0)return;const o=ct(SD(TD,this)),s=SD(TD,this).getBoundingClientRect(),a=i<n.getSetting("fixedRowsTop"),l=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let c;a?c=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(SD(TD,this),r.row,r.col):l&&(c=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(SD(TD,this),r.row,r.col)),c||(c=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(SD(TD,this),r.row,r.col)),yD(kD,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),yD(MD,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){Ot(this.hot.getSelectedRange(),e=>{Zr(e.getTopStartCorner().row,e.getBottomStartCorner().row,e=>{SD(MD,this).includes(e)||SD(MD,this).push(e)})})}SD(MD,this).includes(SD(kD,this))||yD(MD,this,[SD(kD,this)]),yD(FD,this,c.top-6),yD(DD,this,parseInt(s.height,10)),SD(OD,this).style.top=`${SD(FD,this)+SD(DD,this)}px`,SD(OD,this).style[this.inlineDir]=`${c.start}px`,SD(OD,this).style.width=`${o}px`,this.hot.rootElement.appendChild(SD(OD,this))}refreshHandlePosition(){SD(OD,this).style.top=`${SD(FD,this)+SD(PD,this)}px`}setupGuidePosition(){const e=parseInt(ct(SD(OD,this)),10),t=parseInt(SD(OD,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();$e(SD(OD,this),"active"),$e(SD(ND,this),"active"),SD(ND,this).style.top=SD(OD,this).style.top,SD(ND,this).style[this.inlineDir]=`${t}px`,SD(ND,this).style.width=n-e+"px",this.hot.rootElement.appendChild(SD(ND,this))}refreshGuidePosition(){SD(ND,this).style.top=SD(OD,this).style.top}hideHandleAndGuide(){Ue(SD(OD,this),"active"),Ue(SD(ND,this),"active")}checkIfRowHeader(e){const t=He(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,r.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&SD(ID,this)<t?t:SD(ID,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{const r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==r&&yD(ID,this,r),this.setManualSize(t,SD(ID,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),n&&e()};if(SD(HD,this)>=2){SD(MD,this).length>1?(Ot(SD(MD,this),e=>{t(e)}),e()):Ot(SD(MD,this),e=>{t(e,!0)})}yD(HD,this,0),yD(VD,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",e=>xD(zD,this,GD).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>xD(zD,this,$D).call(this,e)),this.eventManager.addEventListener(t,"mousemove",e=>xD(zD,this,UD).call(this,e)),this.eventManager.addEventListener(t,"mouseup",()=>xD(zD,this,KD).call(this)),this.eventManager.addEventListener(SD(OD,this),"contextmenu",()=>xD(zD,this,YD).call(this))}destroy(){super.destroy()}}function GD(e){if(!Rt(e.target)&&!0!==SD(_D,this)&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(SD(LD,this)||this.setupHandlePosition(t))}}function $D(e){Ge(e.target,"manualRowResizer")&&(this.setupHandlePosition(SD(TD,this)),this.setupGuidePosition(),yD(LD,this,!0),null===SD(VD,this)&&(yD(VD,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(SD(VD,this))),yD(HD,this,SD(HD,this)+1),yD(AD,this,e.pageY),yD(ID,this,SD(DD,this)))}function UD(e){SD(LD,this)&&(yD(PD,this,SD(DD,this)+(e.pageY-SD(AD,this))),Ot(SD(MD,this),e=>{yD(ID,this,this.setManualSize(e,SD(PD,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function KD(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),n&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(SD(LD,this)){if(this.hideHandleAndGuide(),yD(LD,this,!1),SD(ID,this)!==SD(DD,this)){SD(MD,this).length>1?(Ot(SD(MD,this),e=>{t(e)}),e()):Ot(SD(MD,this),e=>{t(e,!0)})}this.setupHandlePosition(SD(TD,this))}}function YD(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(SD(OD,this)),this.hot.rootElement.removeChild(SD(ND,this)),yD(LD,this,!1),yD(_D,this,!0),this.hot._registerImmediate(()=>{yD(_D,this,!1)})}function qD(e,t){let n=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),r=SD(BD,this).getValueAtIndex(e);this.hot.getSettings()[RD]&&r&&(n=r)}return n}function XD(){const e=this.hot.getSettings()[RD],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{"undefined"!==typeof t?t.forEach((e,t)=>{SD(BD,this).setValueAtIndex(t,e)}):Array.isArray(e)?(e.forEach((e,t)=>{SD(BD,this).setValueAtIndex(t,e)}),yD(WD,this,e)):!0===e&&Array.isArray(SD(WD,this))&&SD(WD,this).forEach((e,t)=>{SD(BD,this).setValueAtIndex(t,e)})},!0)}function QD(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function JD(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ZD(e,t){return e.get(tF(e,t))}function eF(e,t,n){return e.set(tF(e,t),n),n}function tF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var nF=new WeakMap;const rF=class{constructor(e,t,n,r,i,o){JD(this,"row",void 0),JD(this,"col",void 0),JD(this,"rowspan",void 0),JD(this,"colspan",void 0),JD(this,"removed",!1),JD(this,"cellCoordsFactory",void 0),JD(this,"cellRangeFactory",void 0),QD(this,nF,null),this.row=e,this.col=t,this.rowspan=n,this.colspan=r,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return _t`The merged cell declared with {row: ${t}, col: ${n},\x20
      rowspan: ${r}, colspan: ${i}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:n}=e;return _t`The merged cell declared at [${t}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:n}=e;return _t`The merged cell declared at [${t}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:n}=e;return _t`The merged cell declared at [${t}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:n,rowspan:r,colspan:i}=e;return t<0||n<0||r<0||i<0}static isSingleCell(e){let{rowspan:t,colspan:n}=e;return 1===n&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:n}=e;return 0===n||0===t}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),eF(nF,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",s=Math.min(t,r),a=Math.max(t,r),l=this[o],c=this[o]+this[i]-1;if(l>=t&&(this[o]+=n),n>0)t<=c&&t>l&&(this[i]+=n);else if(n<0){if(s<=l&&a>=c)return this.removed=!0,eF(nF,this,null),!1;if(l>=s&&l<=a){const e=a-l+1,t=Math.abs(n)-e;this[o]-=t+n,this[i]-=e}else if(l<=s&&c>=a)this[i]+=n;else if(l<=s&&c>=s&&c<a){const e=c-s+1;this[i]-=e}}return eF(nF,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return ZD(nF,this)||eF(nF,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),ZD(nF,this)}};function iF(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function oF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var aF=new WeakSet;class lF{constructor(e){iF(this,aF),oF(this,"plugin",void 0),oF(this,"mergedCells",[]),oF(this,"mergedCellsMatrix",new Map),oF(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:n}=e;return _t`The merged cell declared at [${t}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var n;return!!this.mergedCellsMatrix.has(e)&&(null!==(n=this.mergedCellsMatrix.get(e).get(t))&&void 0!==n&&n)}getByRange(e){const{row:t,col:n}=e.getTopStartCorner(),{row:r,col:i}=e.getBottomEndCorner(),o=this.mergedCells.length;let s=!1;for(let a=0;a<o;a++){const e=this.mergedCells[a],{row:o,col:l,rowspan:c,colspan:u}=e;if(o>=t&&o+c-1<=r&&l>=n&&l+u-1<=i){s=e;break}}return s}filterOverlappingMergeCells(e){const t=new Set;this.mergedCells.forEach(e=>{const{row:n,col:r,colspan:i,rowspan:o}=e;for(let s=n;s<n+o;s++)for(let e=r;e<r+i;e++)t.add(`r${s},c${e}`)});const n=e.filter(e=>{const{row:n,col:r,colspan:i,rowspan:o}=e,s=new Set;let a=!1;for(let l=n;l<n+o;l++){for(let n=r;n<r+i;n++){const r=`r${l},c${n}`;if(t.has(r)){Bn(lF.IS_OVERLAPPING_WARNING(e)),a=!0;break}s.add(r)}if(a)break}return a||t.add(...s),!a});return n}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=[];for(let a=n;a<=i;a++)for(let e=r;e<=o;e++){const n=this.get(a,e);n&&(t||!t&&n.row===a&&n.col===e)&&s.push(n)}return s}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.row,r=e.col,i=e.rowspan,o=e.colspan,s=new rF(n,r,i,o,this.hot._createCellCoords,this.hot._createCellRange),a=this.get(n,r),l=!t&&this.isOverlapping(s);return a||l?(l&&Bn(lF.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),this.mergedCells.push(s),sF(aF,this,uF).call(this,s),s)}remove(e,t){const n=this.get(e,t),r=n?this.mergedCells.indexOf(n):-1;return!(!n||-1===r)&&(this.mergedCells.splice(r,1),sF(aF,this,dF).call(this,n),n)}clear(){Ot(this.mergedCells,e=>{let{row:t,col:n,rowspan:r,colspan:i}=e;Zr(t,t+r,e=>{Zr(n,n+i,t=>{const n=this.hot.getCell(e,t);n&&(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let n=0;n<this.mergedCells.length;n++){if(this.mergedCells[n].getRange().overlaps(t))return!0}return!1}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);if(!n)return!1;const{row:r,col:i,rowspan:o,colspan:s}=n,a=this.hot.view.getActiveOverlayName(),l=["top","top_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(a)?0:this.hot.getFirstRenderedVisibleColumn(),u=ni(l,r,r+o-1),d=ni(c,i,i+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(r,i)}getStartMostColumnIndex(e,t){const n=sF(aF,this,cF).call(this,e,"col",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getEndMostColumnIndex(e,t){const n=sF(aF,this,cF).call(this,e,"col",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}getTopMostRowIndex(e,t){const n=sF(aF,this,cF).call(this,e,"row",-1);let r=t;for(let i=0;i<n.length;i++)if(n[i]<=t){r=n[i];break}return r}getBottomMostRowIndex(e,t){const n=sF(aF,this,cF).call(this,e,"row",1);let r=t;for(let i=0;i<n.length;i++)if(n[i]>=t){r=n[i];break}return r}shiftCollections(e,t,n){const r=[0,0];switch(e){case"right":r[0]+=n;break;case"left":r[0]-=n;break;case"down":r[1]+=n;break;case"up":r[1]-=n}const i=[];this.mergedCells.forEach(e=>{e.shift(r,t),e.removed&&i.push(e)}),i.forEach(e=>{this.mergedCells.splice(this.mergedCells.indexOf(e),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(e=>{sF(aF,this,uF).call(this,e)})}}function cF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=new Map,i=1===n?e.getTopStartCorner():e.getBottomEndCorner(),o=1===n?e.getBottomEndCorner():e.getTopStartCorner();for(let s=i.row;1===n?s<=o.row:s>=o.row;s+=n)for(let e=i.col;1===n?e<=o.col:e>=o.col;e+=n){const i="row"===t?s:e,o=this.get(s,e);let a=i;o&&(a=1===n?o[t]+o[`${t}span`]-1:o[t]),r.has(i)||r.set(i,new Set),r.get(i).add(a)}return Array.from(new Set(Array.from(r.entries()).filter(e=>{let[,t]=e;return 1===t.size}).flatMap(e=>{let[,t]=e;return Array.from(t)})))}function uF(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(n,e)}function dF(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let n=e.col;n<e.col+e.colspan;n++)this.mergedCellsMatrix.get(t).delete(n)}const hF=lF;function pF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const gF=class{constructor(e){pF(this,"plugin",void 0),pF(this,"mergedCellsCollection",void 0),pF(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let n=null;return n=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",n}snapDragArea(e,t,n,r){const i=t.slice(0),o=this.getAutofillSize(e,t,n),[s,a,l,c]=e,u=["up","down"].indexOf(n)>-1?l-s+1:c-a+1,d=o-Math.floor(o/u)*u,h=this.getFarthestCollection(e,t,n,r);if(h)if("down"===n){const e=h.row+h.rowspan-s-d;i[2]+e>=this.plugin.hot.countRows()?i[2]-=d:i[2]+=d?e:0}else if("right"===n){const e=h.col+h.colspan-a-d;i[3]+e>=this.plugin.hot.countCols()?i[3]-=d:i[3]+=d?e:0}else if("up"===n){const e=l-d-h.row+1;i[0]+e<0?i[0]+=d:i[0]-=d?e:0}else if("left"===n){const e=c-d-h.col+1;i[1]+e<0?i[1]+=d:i[1]-=d?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:r,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),rn(this.currentFillData,e)}getAutofillSize(e,t,n){const[r,i,o,s]=e,[a,l,c,u]=t;switch(n){case"up":return r-a;case"down":return c-o;case"left":return i-l;case"right":return u-s;default:return null}}getDragArea(e,t,n){const[r,i,o,s]=e,[a,l,c,u]=t;switch(n){case"up":return[a,l,r-1,s];case"down":{const e=this.mergedCellsCollection.get(c,s);return[o+1,i,c+(e?e.rowspan-1:0),s]}case"left":return[a,l,o,i-1];case"right":{const e=this.mergedCellsCollection.get(c,s);return[r,s+(e?e.colspan-1:0),c,u]}default:return null}}getFarthestCollection(e,t,n,r){const[i,o,s,a]=e,l=["up","down"].indexOf(n)>-1,c=l?s:a,u=l?i:o,d=this.getAutofillSize(e,t,n),h=l?s-i+1:a-o+1,p=d-Math.floor(d/h)*h;let g=null,f=null,m=null;switch(n){case"up":g="includesVertically",m=c-p+1;break;case"left":g="includesHorizontally",m=c-p+1;break;case"down":g="includesVertically",m=u+p-1;break;case"right":g="includesHorizontally",m=u+p-1}return Ot(r,e=>{e[g](m)&&e.isFarther(f,n)&&(f=e)}),f}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,i=(e,n)=>{switch(r){case"up":return e.row-n>=t.from.row;case"down":return e.row+e.rowspan-1+n<=t.to.row;case"left":return e.col-n>=t.from.column;case"right":return e.col+e.colspan-1+n<=t.to.column;default:return null}};let o=0,s=null,a=1;do{for(let e=0;e<n.length;e+=1){if(s=n[e],o=a*this.currentFillData.cycleLength,i(s,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan},!0)}e===n.length-1&&(a+=1)}}while(i(s,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return Ot(e,e=>{const r=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===n.min||i<n.min)&&(n.min=i),(null===n.max||i>n.max)&&(n.max=i)}),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const r=this.getDragArea(e,t,n),[i,o,s,a]=r,l=this.plugin.hot._createCellCoords(i,o),c=this.plugin.hot._createCellCoords(s,a),u=this.plugin.hot._createCellRange(l,l,c);if(0===this.mergedCellsCollection.getWithinRange(u,!0).length)return!1;const d=this.mergedCellsCollection.getWithinRange(u,!1);return 0===d.length||("up"===n||"down"===n?!d.every(e=>{let{colspan:t}=e;return t===u.getWidth()}):!d.every(e=>{let{rowspan:t}=e;return t===u.getHeight()}))}};function fF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mF=class{constructor(e){fF(this,"plugin",void 0),fF(this,"hot",void 0),fF(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,n,r){const i=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),a=Math.max(n[1],n[3]);if(void 0===r)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const l=this.plugin.mergedCellsCollection.get(e,t);if(!l)return;const c=l.getLastRow(),u=l.getLastColumn();return i<=l.row&&o<=l.col&&s>=c&&a>=u?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let t=0;t<e.colspan;t+=1)n.push(this.hot._createCellCoords(e.row+r,e.col+t));for(let r=0;r<n.length;r+=1){const e=[];for(let i=0;i<t.length;i+=1)e[i]=t[i].includes(n[r]);if(!e.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}};function vF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wF{constructor(e){vF(this,"data",void 0),vF(this,"next",null),vF(this,"prev",null),this.data=e}}const bF=class{constructor(){vF(this,"first",null),vF(this,"last",null)}push(e){const t=new wF(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){const t=new wF(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){const n=e(t);if(t===this.last||!0===n)break;t=t.next}}remove(e){if(null===this.first)return!1;let t,n,r=this.first;for(;r;){if(r.data===e)return t=r.next,n=r.prev,t&&(t.prev=n),n&&(n.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=n),!0;r=r.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(null===this.last)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,n){n&&(e(n,n.next),n.next=t)}(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let e,t=this.first.next,n=this.first;for(;t;)e=t.next,t.next=n,n.prev=t,n=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=n,this.last=e}};function CF(e,t,n){yF(e,t),t.set(e,n)}function yF(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SF(e,t){return e.get(RF(e,t))}function xF(e,t,n){return e.set(RF(e,t),n),n}function RF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var EF=new WeakMap,TF=new WeakMap,kF=new WeakMap,MF=new WeakMap,PF=new WeakMap,IF=new WeakMap,AF=new WeakMap,DF=new WeakSet;class FF{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:n,columnIndexMapper:r}=e;var i,o;yF(i=this,o=DF),o.add(i),CF(this,EF,new bF),CF(this,TF,new bF),CF(this,kF,null),CF(this,MF,null),CF(this,PF,null),CF(this,IF,null),CF(this,AF,null),xF(PF,this,t),xF(IF,this,n),xF(AF,this,r)}getCurrentVerticalNode(){return SF(MF,this).data}getFirstVerticalNode(){return SF(TF,this).first.data}getNextVerticalNode(){return SF(MF,this).next.data}getPrevVerticalNode(){return SF(MF,this).prev.data}getCurrentHorizontalNode(){return SF(kF,this).data}getFirstHorizontalNode(){return SF(EF,this).first.data}getNextHorizontalNode(){return SF(kF,this).next.data}getPrevHorizontalNode(){return SF(kF,this).prev.data}setPrevNodeAsActive(){xF(MF,this,SF(MF,this).prev),xF(kF,this,SF(kF,this).prev)}setNextNodeAsActive(){xF(MF,this,SF(MF,this).next),xF(kF,this,SF(kF,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),n=e.getBottomEndCorner(),r=new WeakSet;xF(EF,this,new bF);for(let o=t.row;o<=n.row;o++)if(!SF(IF,this).isHidden(o))for(let i=t.col;i<=n.col;i++){if(SF(AF,this).isHidden(i))continue;const t=RF(DF,this,OF).call(this,e,SF(EF,this),r,o,i);t&&xF(kF,this,t)}SF(EF,this).first&&(SF(EF,this).first.prev=SF(EF,this).last,SF(EF,this).last.next=SF(EF,this).first);const i=new WeakSet;xF(TF,this,new bF);for(let o=t.col;o<=n.col;o++)if(!SF(AF,this).isHidden(o))for(let r=t.row;r<=n.row;r++){if(SF(IF,this).isHidden(r))continue;const t=RF(DF,this,OF).call(this,e,SF(TF,this),i,r,o);t&&xF(MF,this,t)}SF(TF,this).first&&(SF(TF,this).first.prev=SF(TF,this).last,SF(TF,this).last.next=SF(TF,this).first)}setActiveNode(e,t){return SF(EF,this).inorder(n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return xF(kF,this,n),!1}),SF(TF,this).inorder(n=>{const{rowStart:r,rowEnd:i,colStart:o,colEnd:s}=n.data;if(e>=r&&e<=i&&t>=o&&t<=s)return xF(MF,this,n),!1}),this}}function OF(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.highlight.clone().normalize(),l=SF(PF,this).call(this,r,i);if(l&&n.has(l))return null;const c={colStart:i,colEnd:i,rowStart:r,rowEnd:r};if(l){if(n.add(l),l.row<o.row||l.row+l.rowspan-1>s.row||l.col<o.col||l.col+l.colspan-1>s.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const u=t.push(c);return r===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?u:null}function NF(e,t,n){const{view:r,rowIndexMapper:i}=e,o=r.getStylesHandler(),s=r.getDefaultRowHeight();let a=0;for(let c=t;c<t+n;c++){var l;if(!i.isHidden(c))a+=null!==(l=e.getRowHeight(c))&&void 0!==l?l:s,0!==c||o.isClassicTheme()||(a+=1)}return a}function LF(e,t,n){_F(e,t),t.set(e,n)}function _F(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HF(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VF(e,t,n){return e.set(WF(e,t),n),n}function BF(e,t){return e.get(WF(e,t))}function WF(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}ir.getSingleton().register("beforeMergeCells"),ir.getSingleton().register("afterMergeCells"),ir.getSingleton().register("beforeUnmergeCells"),ir.getSingleton().register("afterUnmergeCells");const zF="mergeCells",jF=zF;var GF=new WeakMap,$F=new WeakMap,UF=new WeakMap,KF=new WeakMap,YF=new WeakSet;class qF extends vw{constructor(){var e,t;super(...arguments),_F(e=this,t=YF),t.add(e),HF(this,"mergedCellsCollection",null),HF(this,"autofillCalculations",null),HF(this,"selectionCalculations",null),LF(this,GF,null),LF(this,$F,{row:0,col:0}),LF(this,UF,new FF({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),LF(this,KF,function(e){const{hot:t}=e,{rowIndexMapper:n,columnIndexMapper:r}=t,i=new Map;return{before:function(){},after:function(o,s,a){const l=e.mergedCellsCollection.get(s,a);if(!un(l))return o.removeAttribute("rowspan"),o.removeAttribute("colspan"),Tn()&&i.has(s)&&!t.getSettings().rowHeaders&&(o.style.height=`${i.get(s)}px`,i.delete(s)),void(o.style.display="");const{row:c,col:u,colspan:d,rowspan:h}=l,[p,g]=e.translateMergedCellToRenderable(c,h,u,d),f=e.getSetting("virtualized");if(Tn()&&0===u&&!t.getSettings().rowHeaders){const e=NF(t,c,h);i.set(s,e/h)}const m=p-n.getRenderableFromVisualIndex(s)+1,v=g-r.getRenderableFromVisualIndex(a)+1;let w=n.getNearestNotHiddenIndex(c,1),b=r.getNearestNotHiddenIndex(u,1);if(f){const e=t.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(e)||(w=Math.max(w,t.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)||(b=Math.max(b,t.getFirstRenderedVisibleColumn()))}const C=Math.min(h,m),y=Math.min(d,v);w===s&&b===a?(o.setAttribute("rowspan",C),o.setAttribute("colspan",y)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}}}(this))}static get PLUGIN_KEY(){return zF}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[hw]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[zF]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new hF(this),this.autofillCalculations=new gF(this),this.selectionCalculations=new mF(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,XF).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,JF).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,ZF).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,eO).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,tO).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,iO).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,iO).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,oO).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,sO).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,aO).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,nO).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,nO).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,QF).call(e,...n)}),this.addHook("afterRenderer",function(){return BF(KF,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,rO).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,lO).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,cO).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,uO).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,dO).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,hO).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,pO).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,gO).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,fO).call(e,...n)}),this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,mO).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,vO).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,wO).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,bO).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,CO).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return WF(YF,e,yO).call(e,...n)}),this.addHook("beforeUndoStackChange",(e,t)=>{if("MergeCells"===t)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!Rn())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(e=>{const{row:n,rowspan:r}=e;for(let i=n+1;i<n+r;i++)t.push(i)}),t=[...new Set(t)],t.forEach(t=>{const n=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map(e=>"master"===(null===e||void 0===e?void 0:e.name)?e:e.clone.wtTable).forEach(t=>{const r=t.getRow(n);r&&(r.style.background=lt(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(e=>{var t;e.style.background=null===(t=lt(e,"backgroundColor"))||void 0===t?void 0:t.replace(", 0.99)",")")})},1)}validateSetting(e){return!!e&&(rF.containsNegativeValues(e)?(Bn(rF.NEGATIVE_VALUES_WARNING(e)),!1):rF.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Bn(rF.IS_OUT_OF_BOUNDS_WARNING(e)),!1):rF.isSingleCell(e)?(Bn(rF.IS_SINGLE_CELL(e)),!1):!rF.containsZeroSpan(e)||(Bn(rF.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(){const e=this.getSetting("cells").filter(e=>this.validateSetting(e)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];t.forEach(e=>{const{row:t,col:r,rowspan:i,colspan:o}=e,s=this.hot._createCellCoords(t,r),a=this.hot._createCellCoords(t+i-1,r+o-1),l=this.hot._createCellRange(s,s,a);this.mergeRange(l,!0,!0);for(let c=t;c<t+i;c++)for(let e=r;e<r+o;e++)c===t&&e===r||n.push([c,e,null])}),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:i.row-r.row+1,colspan:i.col-r.col+1},s=[];let a=null;if(!this.canMergeRange(o,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),Zr(0,o.rowspan-1,e=>{Zr(0,o.colspan-1,t=>{let n=null;s[e]||(s[e]=[]),0===e&&0===t?n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),s[e][t]=n})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0);return!this.mergedCellsCollection.add(o,t)||(n?a=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),a)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.mergedCellsCollection.getWithinRange(e);0!==n.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),Ot(n,e=>{this.mergedCellsCollection.remove(e.row,e.col),Zr(0,e.rowspan-1,t=>{Zr(0,e.colspan-1,n=>{this.hot.removeCellMeta(e.row+t,e.col+n,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+n,"copyable")})}),this.hot.removeCellMeta(e.row,e.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const{from:t,to:n}=e.clone().normalize(),r=this.mergedCellsCollection.get(t.row,t.col);r.row===t.row&&r.col===t.col&&r.row+r.rowspan-1===n.row&&r.col+r.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.mergeRange(this.hot._createCellRange(i,i,o))}unmerge(e,t,n,r){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(n,r);this.unmergeRange(this.hot._createCellRange(i,i,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:jF})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jF)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(un(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(r<e.startRow)return e.startRow=r,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,r=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(r,i);if(un(o)){const r=o.row+o.rowspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(un(o)){const r=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(r<e.startColumn)return e.startColumn=r,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,r=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,r);if(un(o)){const r=o.col+o.colspan-1,i=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,n,r){const{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let s,a;s=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),a=0===r?o.getNearestNotHiddenIndex(n,1):o.getNearestNotHiddenIndex(n+r-1,-1);return[e>=0?i.getRenderableFromVisualIndex(s):e,n>=0?o.getRenderableFromVisualIndex(a):n]}}function XF(){this.generateFromSettings(),this.hot.render()}function QF(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner(),r=t.getBottomEndCorner();for(let i=0;i<e.length;i+=1)if(n.row===e[i].row&&n.col===e[i].col&&r.row===e[i].row+e[i].rowspan-1&&r.col===e[i].col+e[i].colspan-1)return!1}return e}function JF(e){BF($F,this).row=e.row,BF($F,this).col=e.col}function ZF(e){const t=this.hot.getSelectedRangeLast(),{highlight:n}=t,{columnIndexMapper:r,rowIndexMapper:i}=this.hot;BF(GF,this)&&(null!==i.getRenderableFromVisualIndex(BF(GF,this).row)&&(n.row=BF(GF,this).row),null!==r.getRenderableFromVisualIndex(BF(GF,this).col)&&(n.col=BF(GF,this).col),VF(GF,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(e.col<0){const t=n.col>=s&&n.col<=a?s-1:a,i=r.getNearestNotHiddenIndex(t,-1);e.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,n.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,n.col)-1,1)}else if(e.col>0){const t=n.col>=s&&n.col<=a?a+1:s,i=r.getNearestNotHiddenIndex(t,1);e.col=null===i?this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(n.col,i)-1,1)}const l=o.row,c=o.row+o.rowspan-1;if(e.row<0){const t=n.row>=l&&n.row<=c?l-1:c,r=i.getNearestNotHiddenIndex(t,-1);e.row=null===r?-this.hot.view.countRenderableRowsInRange(0,n.row):-Math.max(this.hot.view.countRenderableRowsInRange(r,n.row)-1,1)}else if(e.row>0){const t=n.row>=l&&n.row<=c?c+1:l,r=i.getNearestNotHiddenIndex(t,1);e.row=null===r?this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(n.row,r)-1,1)}}function eO(e){const t=this.hot.getSelectedRangeLast(),n=t.clone(),{to:r}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,s=(e,t)=>{n.expand(this.hot._createCellCoords(e,t));for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;s(r.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===n.getHorizontalDirection()&&(o=n.getTopStartCorner().col);const a=i.getNearestNotHiddenIndex(o,1);null!==a&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,r.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;s(r.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===n.getHorizontalDirection()&&(o=n.getBottomEndCorner().col);const a=i.getNearestNotHiddenIndex(o,-1);null!==a&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,a)-1,1))}if(e.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;s(i,r.col),"S-N"===t.getVerticalDirection()&&"S-N"===n.getVerticalDirection()&&(i=n.getTopStartCorner().row);const a=o.getNearestNotHiddenIndex(i,1);null!==a&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(a,r.row)-1,1))}else if(e.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;s(i,r.col),"N-S"===t.getVerticalDirection()&&"N-S"===n.getVerticalDirection()&&(i=n.getBottomStartCorner().row);const a=o.getNearestNotHiddenIndex(i,-1);null!==a&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,a)-1,1))}}function tO(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void VF(GF,this,t.clone());for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[r].getRange(),!1);const n=this.mergedCellsCollection.get(t.row,t.col);VF(GF,this,t.clone()),n&&t.assign(n)}function nO(e,t,n,r){if(e<0||t<0)return;const i=this.mergedCellsCollection.get(e,t);if(!i)return;const{row:o,col:s,colspan:a,rowspan:l}=i,c=o,u=s,d=o+l-1,h=s+a-1;if("render"===r&&this.getSetting("virtualized")){const e=this.hot.view.getActiveOverlayName(),t=["top","top_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleRow(),n=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleColumn();return[ni(t,c,d),ni(n,u,h),ni(this.hot.getLastRenderedVisibleRow(),c,d),ni(this.hot.getLastRenderedVisibleColumn(),u,h)]}return[c,u,d,h]}function rO(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(au)}return this.getTranslatedPhrase(su)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,r.row,r.col,!1)},disabled(){const e=this.getSelectedLast();return!e||rF.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function iO(){VF(GF,this,null)}function oO(){if(BF(GF,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),n=e.getHorizontalDirection(),r=BF(GF,this).clone().normalize();BF(UF,this).setActiveNode(r.row,r.col),BF($F,this).row>0||BF($F,this).col>0?BF(UF,this).setPrevNodeAsActive():("E-W"===n&&BF($F,this).col<0||"S-N"===t&&BF($F,this).row<0)&&BF(UF,this).setNextNodeAsActive()}function sO(e,t){const n=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:i}=this.hot;let o=null,s=null;if(BF($F,this).col<0){const{rowEnd:e,colEnd:t}=BF(UF,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(BF($F,this).col>0){const{rowStart:e,colStart:t}=BF(UF,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}else if(BF($F,this).row<0){const{rowEnd:e,colEnd:t}=BF(UF,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(BF($F,this).row>0){const{rowStart:e,colStart:t}=BF(UF,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}if(null!==o||null!==s){const r=this.hot._createCellCoords(o,s),i=this.mergedCellsCollection.get(r.row,r.col),a=this.hot.selection.highlight.getFocus();e=r.row,t=r.col,i?n.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):n.highlight.assign(r),a.clear(),a.add(r).commit()}BF(UF,this).setActiveNode(e,t),VF($F,this,{row:0,col:0})}function aO(){this.hot.getSelectedRangeLast().isHeader()||BF(UF,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function lO(e,t,n){const r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function cO(e){if(this.getSetting("virtualized"))return;const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function uO(e){if(this.getSetting("virtualized"))return;const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function dO(e,t){const n=this.autofillCalculations.getDirection(t,e);if(this.autofillCalculations.dragAreaOverlapsCollections(t,e,n))return t;const r=this.hot._createCellCoords(t[0],t[1]),i=this.hot._createCellCoords(t[2],t[3]),o=this.hot._createCellRange(r,r,i),s=this.mergedCellsCollection.getWithinRange(o);return 0===s.length?e:this.autofillCalculations.snapDragArea(t,e,n,s)}function hO(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function pO(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function gO(e,t,n){"auto"!==n&&this.mergedCellsCollection.shiftCollections("down",e,t)}function fO(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function mO(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function vO(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeLast();Ot(this.mergedCellsCollection.getWithinRange(t),n=>{t.getBottomEndCorner().row===n.getLastRow()&&t.getBottomEndCorner().col===n.getLastColumn()&&(e[2]=n.row,e[3]=n.col)})}}function wO(e,t,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,r)}function bO(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function CO(e,t,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(s,s,a))}function yO(e,t,n){if(this.hot.getSettings().rowHeaders||"bottom"===n||"bottom_inline_start_corner"===n)return e;let r,i;if("master"===n)r=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const e=this.hot.view.getOverlayByName(n);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;const o=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t,i),a=this.hot._createCellRange(o,o,s),l=this.mergedCellsCollection.getWithinRange(a,!0),c=l.reduce((e,t)=>{let{rowspan:n}=t;return Math.max(e,n)},1);let u=0;return l.length>1&&l[0].rowspan<c&&(u=c-l[0].rowspan),l.forEach(r=>{let{rowspan:i}=r,o=0;o="top"===n||"top_inline_start_corner"===n?Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-t):i-u,e=Math.max(null!==e&&void 0!==e?e:0,NF(this.hot,t,o))}),e}const SO="sort";function xO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const RO="multiColumnSorting",EO=RO;lC(RO,function(e,t){return function(n,r){const[,...i]=n,[,...o]=r;return function n(r){const s=e[r],a=t[r],l=i[r],c=o[r],u=a.multiColumnSorting,d=(u.compareFunctionFactory?u.compareFunctionFactory:uC(a.type))(s,a,u)(l,c);if(d===dC){const e=r+1;if("undefined"!==typeof t[e])return n(e)}return d}(0)}});class TO extends NC{constructor(){super(...arguments),xO(this,"pluginKey",RO)}static get PLUGIN_KEY(){return RO}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,AC)),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:yp,position:"before",group:EO})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(EO)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super.updateHeaderClasses(e,...n),Ue(e,function(e){const t=e.className.split(" "),n=new RegExp(`^${SO}-[0-9]{1,2}$`);return t.filter(e=>n.test(e))}(e)),!1!==this.enabled&&$e(e,function(e,t,n){const r=[];return!1===n||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push(`${SO}-${e.getIndexOfColumnInSortQueue(t)+1}`),r}(...n))}onAfterOnCellMouseDown(e,t){!1!==yC(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,AC))):this.sort(this.getColumnNextConfig(t.col)))}}function kO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class MO extends vw{constructor(){super(...arguments),kO(this,"dragged",[]),kO(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return kn()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(t);if(-1===n)return!1;0===n?e.dragged=e.dragged.slice(0,1):1===n&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",t=>{let n;return Ge(t.target,"topSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):Ge(t.target,"bottomSelectionHandle-HitArea")?(n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(t,"touchend",t=>Ge(t.target,"topSelectionHandle-HitArea")?(n.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):Ge(t.target,"bottomSelectionHandle-HitArea")?(n.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0),this.eventManager.addEventListener(t,"touchmove",t=>{const{rootDocument:n}=this.hot;let r,i,o,s,a,l;if(0===e.dragged.length)return;const c=n.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);c&&c!==e.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(r=e.hot.getCoords(c),-1===r.col&&(r.col=0),i=e.hot.getSelectedRangeLast(),o=i.getWidth(),s=i.getHeight(),a=i.getDirection(),1===o&&1===s&&e.hot.selection.setRangeEnd(r),l=e.getCurrentRangeCoords(i,r,e.touchStartRange.direction,a,e.dragged[0]),null!==l.start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=c),t.preventDefault())})}getCurrentRangeCoords(e,t,n,r,i){const o=e.getTopStartCorner(),s=e.getBottomEndCorner(),a=e.getBottomStartCorner(),l=e.getTopEndCorner();let c={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":c="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(c={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===i?c={start:t,end:a}:c.end=t;break;case"NW-SE":"top"===i?c={start:t,end:s}:c.end=t;break;case"SE-NW":"top"===i?c={start:t,end:o}:c.end=t;break;case"SW-NE":"top"===i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(r){case"NW-SE":c="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(a.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":c="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?c={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(c={start:a,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(c.end=t);break;case"SE-NW":"top"===i?c.end=t:c={start:t,end:o}}}return c}isDragged(){return this.dragged.length>0}}function PO(){let{label:e="",colspan:t=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:c}}function IO(){return{label:"",isPlaceholder:!0}}function AO(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function DO(e,t){return e.get(OO(e,t))}function FO(e,t,n){return e.set(OO(e,t),n),n}function OO(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const NO=["label","collapsible"];var LO=new WeakMap,_O=new WeakMap,HO=new WeakMap;class VO{constructor(){AO(this,LO,[]),AO(this,_O,0),AO(this,HO,1/0)}setColumnsLimit(e){FO(HO,this,e)}setData(){FO(LO,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const n=[];if(0===t)return n;Ot(e,e=>{const r=[];let i=0;n.push(r),Ot(e,e=>{const n=PO();if(un(e)){const{label:t,colspan:r,headerClassName:i}=e;n.label=Ht(t),"number"===typeof r&&r>1&&(n.colspan=r,n.origColspan=r),"string"===typeof i&&(n.headerClassNames=[...i.split(" ")])}else n.label=Ht(e);i+=n.origColspan;let o=!1;if(i>=t&&(n.colspan=n.origColspan-(i-t),n.origColspan=n.colspan,o=!0),r.push(n),n.colspan>1)for(let t=0;t<n.colspan-1;t++)r.push(IO());return!o})});const r=Math.max(...Ft(n,e=>e.length));return Ot(n,e=>{if(e.length<r){const t=Ft(new Array(r-e.length),()=>PO());e.splice(e.length,0,...t)}}),n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],DO(HO,this))),FO(_O,this,DO(LO,this).length)}getData(){return DO(LO,this)}mergeWith(e){Ot(e,e=>{let{row:t,col:n,...r}=e;const i=this.getHeaderSettings(t,n);null!==i&&rn(i,r,NO)})}map(e){Ot(DO(LO,this),t=>{Ot(t,t=>{const n=e({...t});un(n)&&rn(t,n,NO)})})}getHeaderSettings(e,t){var n;if(e>=DO(_O,this)||e<0)return null;const r=DO(LO,this)[e];return!1===Array.isArray(r)||t>=r.length?null:null!==(n=r[t])&&void 0!==n?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=[];if(e>=DO(_O,this)||e<0)return r;const i=DO(LO,this)[e];let o=0;for(let s=t;s<i.length;s++){const e=i[s];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(s+=e.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return DO(_O,this)}getColumnsCount(){return DO(_O,this)>0?DO(LO,this)[0].length:0}clear(){FO(LO,this,[]),FO(_O,this,0)}}function BO(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WO="DF-pre-order";const zO=new Map([[WO,function e(t,n){let r=t.call(n,this);for(let i=0;i<this.childs.length;i++){if(!1===r)return!1;r=e.call(this.childs[i],t,n)}return r}],["DF-post-order",function e(t,n){for(let r=0;r<this.childs.length;r++){if(!1===e.call(this.childs[r],t,n))return!1}return t.call(n,this)}],["BF",function(e,t){const n=[this];!function r(){if(0===n.length)return;const i=n.shift();n.push(...i.childs),!1!==e.call(t,i)&&r()}()}]]);class jO{constructor(e){BO(this,"data",{}),BO(this,"parent",null),BO(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new jO({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!zO.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);zO.get(t).call(this,e,this)}walkUp(e){const t=this,n=r=>{!1!==e.call(t,r)&&null!==r.parent&&n(r.parent)};n(this)}}function GO(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function $O(e,t){return e.get(UO(e,t))}function UO(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var KO=new WeakMap,YO=new WeakMap,qO=new WeakMap;class XO{constructor(e){GO(this,KO,new Map),GO(this,YO,new Map),GO(this,qO,null),function(e,t,n){e.set(UO(e,t),n)}(qO,this,e)}getRoots(){return Array.from($O(KO,this).values())}getRootByColumn(e){let t;return $O(YO,this).has(e)&&(t=$O(KO,this).get($O(YO,this).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const r=t-$O(YO,this).get(t);let i,o=0;return n.walkDown(n=>{const{data:{origColspan:s,headerLevel:a}}=n;if(e===a){if(r>=o&&r<=o+s-1)return i=n,i.data.isRoot=t===i.data.columnIndex,!1;o+=s}}),i}rebuildTreeIndex(){let e=0;$O(YO,this).clear(),Ot($O(KO,this),t=>{let[,{data:{colspan:n}}]=t;for(let r=e;r<e+n;r++)$O(YO,this).set(r,e);e+=n})}buildTree(){this.clear();const e=$O(qO,this).getColumnsCount();let t=0;for(;t<e;){const e=$O(qO,this).getHeaderSettings(0,t),n=new jO;$O(KO,this).set(t,n),this.buildLeaves(n,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=$O(qO,this).getHeadersSettings(n,t,r);n+=1,Ot(i,r=>{const i={...r,headerLevel:n-1,columnIndex:t};let o;1===n?(e.data=i,o=e):(o=new jO(i),e.addChild(o)),n<$O(qO,this).getLayersCount()&&this.buildLeaves(o,t,n,r.origColspan),t+=r.origColspan})}clear(){$O(KO,this).clear(),$O(YO,this).clear()}}function QO(e,t){e.walkDown(e=>{let{data:n,childs:r}=e;if(!n.isHidden&&(t(n.columnIndex),0===r.length))for(let i=1;i<n.colspan;i++)t(n.columnIndex+i)})}function JO(e,t){let{childs:n}=e;if(0!==n.length)return n[0].data[t]}function ZO(e){return JO(e,"origColspan")===e.data.origColspan}function eN(e){const{data:t,childs:n}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ZO(e))return eN(n[0]);t.isCollapsed=!1;const r=n.slice(1),i=new Set;let o=0;if(r.length>0)Ot(r,e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;o+=t.colspan,QO(e,e=>{i.add(e)})});else{const{colspan:e,origColspan:n,columnIndex:r}=t;o=n-e;for(let t=1;t<n;t++)i.add(r+t)}return e.walkUp(e=>{const{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):ZO(e)&&(t.isCollapsed=JO(e,"isCollapsed"))}),{rollbackModification:()=>tN(e),affectedColumns:Array.from(i),colspanCompensation:o}}function tN(e){var t;const{data:n,childs:r}=e;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(ZO(e))return tN(r[0]);n.isCollapsed=!0;const i=r.slice(1),o=new Set;if(i.length>0)Ot(i,e=>{QO(e,e=>{o.add(e)}),e.data.clonedTree=e.cloneTree(),e.walkDown(e=>{let{data:t}=e;t.isHidden=!0})});else{const{origColspan:e,columnIndex:t}=n;for(let n=1;n<e;n++){const e=t+n;o.add(e)}}const s=n.colspan-(null!==(t=JO(e,"colspan"))&&void 0!==t?t:1);return e.walkUp(e=>{const{data:t}=e;t.colspan-=s,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):ZO(e)&&(t.isCollapsed=JO(e,"isCollapsed"))}),{rollbackModification:()=>eN(e),affectedColumns:Array.from(o),colspanCompensation:s}}const nN=new Map([["collapse",tN],["expand",eN],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(_t`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(n.includes(t))return;let r=!1;e.walkUp(e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{const{data:n}=e;n.crossHiddenColumns.push(t),n.colspan>1?n.colspan-=1:n.isHidden=!0})}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(_t`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=e.data;if(!n.includes(t))return;let r=!1;e.walkUp(e=>{const{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{const{data:n}=e;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(t),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1})}]]);function rN(e){const t=[];return Ot(e,e=>{e.walkDown(e=>{const n=e.data,{origColspan:r,columnIndex:i,headerLevel:o,crossHiddenColumns:s}=n,a=function(e,t){let n;Array.isArray(e[t])?n=e[t]:(n=[],e[t]=n);return n}(t,o);let l=!1;for(let t=i;t<i+r;t++){if(s.includes(t)||l)a.push(IO());else{const e=iN(n);e.isRoot=!0,a.push(e),l=!0}}})}),t}function iN(e){const{crossHiddenColumns:t,...n}=PO(e);return n}function oN(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function sN(e,t,n){return e.set(lN(e,t),n),n}function aN(e,t){return e.get(lN(e,t))}function lN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var cN=new WeakMap,uN=new WeakMap,dN=new WeakMap;class hN{constructor(){oN(this,cN,new VO),oN(this,uN,new XO(aN(cN,this))),oN(this,dN,[[]])}setState(e){aN(cN,this).setData(e);let t=!1;try{aN(uN,this).buildTree()}catch(n){aN(uN,this).clear(),aN(cN,this).clear(),t=!0}return sN(dN,this,rN(aN(uN,this).getRoots())),t}setColumnsLimit(e){aN(cN,this).setColumnsLimit(e)}mergeStateWith(e){const t=Ft(e,e=>{let{row:t,...n}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...n}});aN(cN,this).mergeWith(t),aN(uN,this).buildTree(),sN(dN,this,rN(aN(uN,this).getRoots()))}mapState(e){aN(cN,this).map(e),aN(uN,this).buildTree(),sN(dN,this,rN(aN(uN,this).getRoots()))}mapNodes(e){return At(aN(uN,this).getRoots(),(t,n)=>(n.walkDown(n=>{const r=e(n.data);void 0!==r&&t.push(r)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const r=aN(uN,this).getNode(t,n);let i;return r&&(i=function(e,t,n){if(!nN.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return nN.get(e)(t,n)}(e,r,n),sN(dN,this,rN(aN(uN,this).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,r;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(n=null===(r=aN(dN,this)[e])||void 0===r?void 0:r[t])&&void 0!==n?n:null}getHeaderTreeNodeData(e,t){const n=this.getHeaderTreeNode(e,t);return n?{...n.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const n=aN(uN,this).getNode(e,t);return n||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=t-e+1;let r=!1,i=null;for(let o=e;o<=t;o++){const s=aN(uN,this).getRootByColumn(o);if(!s)break;r=!0,s.walkDown(r=>{const{columnIndex:o,headerLevel:s,origColspan:a,isHidden:l}=r.data;l||a<=n&&o>=e&&o+a-1<=t&&(null===i||s<i)&&(i=s)},WO)}return r&&null===i?-1:this.levelToRowCoords(null!==i&&void 0!==i?i:0)}findLeftMostColumnIndex(e,t){var n;const{isRoot:r}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0};if(r)return t;let i=t-1;for(;i>=0;){var o;const{isRoot:t}=null!==(o=this.getHeaderSettings(e,i))&&void 0!==o?o:{isRoot:!0};if(t)break;i-=1}return i}findRightMostColumnIndex(e,t){var n;const{isRoot:r,origColspan:i}=null!==(n=this.getHeaderSettings(e,t))&&void 0!==n?n:{isRoot:!0,origColspan:1};if(r)return t+i-1;let o=t+1;for(;o<this.getColumnsCount();){var s;const{isRoot:t}=null!==(s=this.getHeaderSettings(e,o))&&void 0!==s?s:{isRoot:!0};if(t)break;o+=1}return o-1}getLayersCount(){return aN(cN,this).getLayersCount()}getColumnsCount(){return aN(cN,this).getColumnsCount()}clear(){sN(dN,this,[]),aN(cN,this).clear(),aN(uN,this).clear()}}function pN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const gN=class{constructor(e,t){pN(this,"hot",void 0),pN(this,"nestedHeaderSettingsGetter",void 0),pN(this,"layersCount",0),pN(this,"container",void 0),pN(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const t=this.container.querySelectorAll("tr:last-of-type th"),n=t.length;this.widthsMap.clear();for(let r=0;r<n;r++){const e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),n=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(n,t[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,r=t.createDocumentFragment(),i=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,s=n.getRenderableIndexesLength();for(let a=0;a<this.layersCount;a++){const e=t.createElement("tr");for(let r=0;r<s;r++){let i=n.getVisualFromRenderableIndex(r);null===i&&(i=r);const s=t.createElement("th"),l=this.nestedHeaderSettingsGetter(a,i);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;o&&(t+='<button class="changeType"></button>'),Je(s,t),s.colSpan=l.colspan,e.appendChild(s)}}i.appendChild(e)}r.appendChild(i),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};function fN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mN(e,t,n){vN(e,t),t.set(e,n)}function vN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wN(e,t,n){return e.set(CN(e,t),n),n}function bN(e,t){return e.get(CN(e,t))}function CN(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const yN="nestedHeaders";var SN=new WeakMap,xN=new WeakMap,RN=new WeakMap,EN=new WeakMap,TN=new WeakMap,kN=new WeakSet;class MN extends vw{constructor(){var e,t;super(...arguments),vN(e=this,t=kN),t.add(e),mN(this,SN,new hN),mN(this,xN,null),mN(this,RN,null),mN(this,EN,!1),mN(this,TN,null),fN(this,"ghostTable",new gN(this.hot,(e,t)=>this.getHeaderSettings(e,t))),fN(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return yN}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[yN]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||Bn(_t`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>CN(kN,this,$N).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,UN).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,FN).call(e,...n)}),this.addHook("afterOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,ON).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,NN).call(e,...n)}),this.addHook("beforeOnCellMouseUp",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,LN).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,_N).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,HN).call(e,...n)}),this.addHook("afterSelection",()=>CN(kN,this,PN).call(this)),this.addHook("afterSelectionFocusSet",()=>CN(kN,this,PN).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,IN).call(e,...n)}),this.addHook("afterGetColumnHeaderRenderers",e=>CN(kN,this,BN).call(this,e)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,zN).call(e,...n)}),this.addHook("modifyColumnHeaderValue",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,jN).call(e,...n)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,AN).call(e,...n)}),this.addHook("beforeCopy",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,DN).call(e,...n)}),this.addHook("beforeSelectColumns",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,VN).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,WN).call(e,...n)}),this.addHook("modifyFocusedElement",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CN(kN,e,GN).call(e,...n)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>CN(kN,this,PN).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>CN(kN,this,PN).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();bN(SN,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=bN(SN,this).setState(e)),this.detectedOverlappedHeaders&&Bn(_t`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((e,t)=>{const n=!0===e?"hide-column":"show-column";bN(SN,this).triggerColumnModification(n,t)}),!bN(xN,this)&&this.enabled&&wN(xN,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(e=>{e.forEach(e=>{let{op:t,index:n,newValue:r}=e;if("replace"===t){const e=!0===r?"hide-column":"show-column";bN(SN,this).triggerColumnModification(e,n)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),bN(SN,this).clear(),bN(xN,this).unsubscribe(),wN(xN,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return bN(SN,this)}getLayersCount(){return bN(SN,this).getLayersCount()}getHeaderSettings(e,t){return bN(SN,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const e=n.childNodes[o];if(!e)break;const t=r.childNodes[o],s=i?i.childNodes[o]:null;for(let n=0,r=e.childNodes.length;n<r;n++)e.childNodes[n].removeAttribute("colspan"),Ue(e.childNodes[n],"hiddenHeader"),t&&t.childNodes[n]&&(t.childNodes[n].removeAttribute("colspan"),Ue(t.childNodes[n],"hiddenHeader")),i&&s&&s.childNodes[n]&&(s.childNodes[n].removeAttribute("colspan"),Ue(s.childNodes[n],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,i)=>{var o;const{columnIndexMapper:s,view:a}=this.hot;let l=s.getVisualFromRenderableIndex(r);null===l&&(l=r),i.removeAttribute("colspan"),Ue(i,"hiddenHeader"),Ue(i,"hiddenHeaderText");const{colspan:c,isHidden:u,isPlaceholder:d,headerClassNames:h}=null!==(o=bN(SN,this).getHeaderSettings(e,l))&&void 0!==o?o:{label:""};if(d||u)$e(i,"hiddenHeader");else if(c>1){var p,g,f;const{wtOverlays:e}=a._wt,t=null===(p=e.topInlineStartCornerOverlay)||void 0===p?void 0:p.clone.wtTable.THEAD.contains(i),o=null===(g=e.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i);(null===(f=e.topOverlay)||void 0===f?void 0:f.clone.wtTable.THEAD.contains(i))&&l<n&&$e(i,"hiddenHeaderText");const s=t||o?Math.min(c,n-r):c;s>1&&i.setAttribute("colspan",s)}if(this.hot.view.appendColHeader(l,i,function(){return t.getColumnHeaderValue(...arguments)},e),!d&&!u){const e=i.querySelector("div.relative");e&&h&&h.length>0&&(Ue(e,this.hot.getColumnMeta(l).headerClassName),$e(e,h))}}}getColumnHeaderValue(e,t){var n;const{isHidden:r,isPlaceholder:i}=null!==(n=bN(SN,this).getHeaderSettings(t,e))&&void 0!==n?n:{};return i||r?"":this.hot.getColHeader(e,t)}destroy(){wN(SN,this,null),null!==bN(xN,this)&&(bN(xN,this).unsubscribe(),wN(xN,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return bN(SN,this).getHeaderTreeNodeData(e.row,e.col)}}function PN(){var e;const t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:n}=t;if(n.isHeader()&&n.col>=0){const e=bN(SN,this).findLeftMostColumnIndex(n.row,n.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}}function IN(e,t){var n;const r=this.hot.getSelectedRangeLast();if(!r)return e;const{highlight:i}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?i.row:null===(n=bN(TN,this))||void 0===n?void 0:n.row,l=s?e:i.col,c=a<0&&l>=0;if(wN(TN,this,null),!c)return e;const u=this.hot.getFirstFullyVisibleColumn(),d=this.hot.getLastFullyVisibleColumn(),h=d-u+1,p=bN(SN,this).findLeftMostColumnIndex(a,l),g=bN(SN,this).findRightMostColumnIndex(a,l),f=g-p+1;if(p<u&&g>d)return p;if(s){let e=null;return p>=u&&g>d?f>h?(t.value="start",e=p):(t.value="end",e=g):p<u&&g<=d&&(f>h?(t.value="end",e=g):(t.value="start",e=p)),e}return p<=u?p:g}function AN(e,t,n){const r=bN(SN,this).getHeaderTreeNodeData(t,e);if(!r)return e;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=bN(SN,this).getHeaderSettings(t,e);if(o===Md){if(!a)return r.columnIndex}else if(o===kd&&(l>s-i||!a))return null;return e}function DN(e,t,n){let{columnHeadersCount:r}=n;if(0!==r)for(let o=0;o<t.length;o++){const{startRow:n,startCol:r,endRow:s,endCol:a}=t[o],l=s-n+1;if(n>=0||1===r-a+1)break;for(let t=r;t<=a;t++)for(let o=n;o<=s;o++){var i;const n=l+o,s=t-r;if(0===s)continue;!1===(null===(i=bN(SN,this).getHeaderTreeNodeData(o,t))||void 0===i?void 0:i.isRoot)&&(e[n][s]="")}}}function FN(e,t,n,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function ON(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;wN(RN,this,t.clone()),wN(EN,this,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?o.push(i.getTopEndCorner().col,s,t.row):t.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,t.row):o.push(s,s+a-1,t.row):(Vn(e)||Hn(e)&&l||function(e){return e instanceof TouchEvent}(e))&&o.push(s,s+a-1,t.row),r.selectColumns(...o)}function NN(e,t,n,r){if(!this.hot.view.isMouseDown()||r.column)return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;r.column=!0,r.cell=!0;const d=[],h=ni(t.row,-1/0,-1);t.col<u.col?d.push(c.col,o,h):t.col>u.col?d.push(l.col,o+s-1,h):d.push(o,o+s-1,h),this.hot.selection.selectColumns(...d)}function LN(){wN(EN,this,!1)}function _N(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!bN(EN,this)||!e)return;const t=this.hot.getSelectedRangeLast(),n=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=bN(SN,this).getHeaderTreeNodeData(bN(RN,this).row,bN(RN,this).col);if(t.setHighlight(bN(RN,this)),o>t.getWidth()||i<n||i+o-1>r){const e=bN(SN,this).findTopMostEntireHeaderLevel(ni(n,i,i+o-1),ni(r,i,i+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function HN(e){const{highlight:t}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(n.isHeader()&&n.col>=0))return;const r=bN(SN,this).findLeftMostColumnIndex(n.row,n.col),i=bN(SN,this).findRightMostColumnIndex(n.row,n.col);if(e.col<0){const n=t.col>=r&&t.col<=i?r-1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,-1);e.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,t.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){const n=t.col>=r&&t.col<=i?i+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n,1);e.col=null===o?this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function VN(e,t,n){const r=e.row,i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});wN(TN,this,n.clone()),t.col<e.col?(i&&(e.col=i.columnIndex+i.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(i&&(e.col=i.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function BN(e){if(bN(SN,this).getLayersCount()>0){e.length=0;for(let t=0;t<bN(SN,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}function WN(e){const t=bN(SN,this).getLayersCount();let n=e.startColumn,r=!!t;for(let i=0;i<t;i++){const t=bN(SN,this).findLeftMostColumnIndex(i,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(r=!1),Qr(o)&&o<e.startColumn){n=o;break}}e.startColumn=r?bN(SN,this).getHeaderTreeNodeData(0,n).columnIndex:n}function zN(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}function jN(e,t,n){var r;const{label:i}=null!==(r=bN(SN,this).getHeaderTreeNodeData(n,t))&&void 0!==r?r:{label:""};return i}function GN(e,t){if(e<0)return this.hot.getCell(e,bN(SN,this).findLeftMostColumnIndex(e,t),!0)}function $N(){this.updatePlugin()}function UN(e,t){t||this.updatePlugin()}function KN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const YN=class{constructor(e,t){KN(this,"hot",void 0),KN(this,"data",null),KN(this,"plugin",void 0),KN(this,"parentReference",new WeakMap),KN(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Zr(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Ot(e.__children,n=>{this.cacheNode(n,t+1,e)})}getDataObject(e){return null===e||void 0===e?null:this.cache.rows[e]}readTreeNodes(e,t,n,r){let i=!1,o=t;if(isNaN(o)&&o.end)return o;let s=e;return s||(s={__children:this.data},i=!0,o-=1),null!==n&&void 0!==n&&o===n?{result:s,end:!0}:null!==r&&void 0!==r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&Ot(s.__children,e=>{if(this.parentReference.set(e,i?null:s),o=this.readTreeNodes(e,o,n,r),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return hn(this.data[0],(t,n)=>{e[n]=null}),e}getRowIndex(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const n=this.getRowParent(e);return null===n||void 0===n?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&n.__children?(Ot(n.__children,e=>{t+=1,e.__children&&(t+=this.countChildren(e))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"===typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var n;return(null===(n=e.__children)||void 0===n?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&0!==(null===(t=n.__children)||void 0===t?void 0:t.length)}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let r,i=n;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const n=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",n,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(n,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",n,1),r=n}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);i=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const n=this.translateTrimmedRow(e),r=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,i+1,null);break;case"above":this.addChildAtIndex(r,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null;const r=[];Array.isArray(e)?(Zr(e[0],e[2],e=>{const t=this.translateTrimmedRow(e);r.push(this.getDataObject(t))}),Zr(0,r.length-2,e=>{this.detachFromParent(r[e],!1)}),n=r[r.length-1]):n=e;const i=this.getRowIndex(n),o=this.countChildren(n),s=this.getRowIndexWithinParent(n),a=this.getRowParent(n),l=this.getRowParent(a),c=this.getRowIndex(l);let u=null;if(this.hot.runHooks("beforeDetachChild",a,n),null!==s&&void 0!==s){const e=Array.from(new Array(i+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",i,o+1,e,this.plugin.pluginName),a.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,o+1,e,this.plugin.pluginName),l){u=c+this.countChildren(l);const e=this.getChild(l,this.countChildren(l)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),l.__children.push(n)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",a,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const r=[];Ot(n,e=>{r.push(this.getDataObject(e))}),Ot(r,e=>{const t=this.getRowIndexWithinParent(e),n=this.getRowParent(e);null===n?this.data.splice(t,1):n.__children.splice(t,1)}),this.rewriteCache()}spliceData(e,t,n){const r=this.getDataObject(e-1);let i=null,o=e;r&&r.__children&&0===r.__children.length?(i=r,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(o,t,...n):i.__children.splice(o,t):n?this.data.splice(o,t,...n):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=t;do{n=this.getRowParent(n),null!==n&&(t=n)}while(null!==n);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,r){const i=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),a=o.__children.slice(s,s+1),l=e>t;let c=i?this.getRowParent(t-1):this.getRowParent(t);null!==c&&void 0!==c||(c=this.getRowParent(t-1)),null!==c&&void 0!==c||(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const u=i||n||r?c.__children.length:this.getRowIndexWithinParent(t),d=o===c;c.__children.splice(u,0,a[0]),o.__children.splice(s+(l&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};function qN(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const XN=class{constructor(e,t){qN(this,"hot",void 0),qN(this,"plugin",void 0),this.hot=t,this.plugin=e}};class QN extends XN{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),o=t.getElementsByTagName("DIV")[0],s=o.querySelector("span.rowHeader"),a=o.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(Ot(a,e=>{e&&o.removeChild(e)}),$e(t,QN.CSS_CLASSES.indicatorContainer),r){const{rootDocument:e}=this.hot,t=s.cloneNode(!0);o.innerHTML="",Zr(0,r-1,()=>{const t=e.createElement("SPAN");$e(t,QN.CSS_CLASSES.emptyIndicator),o.appendChild(t)}),o.appendChild(t)}if(this.dataManager.hasChildren(i)){const e=this.hot.rootDocument.createElement("DIV");l&&Ke(e,[["aria-hidden","true"]]),$e(t,QN.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?($e(e,`${QN.CSS_CLASSES.button} ${QN.CSS_CLASSES.expandButton}`),l&&Ke(t,[Ae(!1)])):($e(e,`${QN.CSS_CLASSES.button} ${QN.CSS_CLASSES.collapseButton}`),l&&Ke(t,[Ae(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);const n=this.hot.view.getStylesHandler();let r=11;if(!n.isClassicTheme()){r=2*n.getCSSVariableValue("cell-horizontal-padding")}this.rowHeaderWidthCache=Math.max(50,r+10*t+25),this.hot.render()}}const JN=QN;const ZN=class extends XN{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,e)},shiftStash:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t&&void 0!==t||(t=1/0),Ot(n.lastCollapsedRows,(i,o)=>{i>=e&&i<t&&(n.lastCollapsedRows[o]=i+r)})},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.collapseMultipleChildren(n.lastCollapsedRows,e),n.lastCollapsedRows=void 0},trimStash:(e,t)=>{Zr(e,e+t-1,e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)})}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(i)&&Ot(i.__children,e=>{r.push(this.dataManager.getRowIndex(e))}),s=this.collapseRows(r,!0,!1),n&&this.trimRows(s),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Ot(e,e=>{r.push(...this.collapseChildren(e,!1,!1))}),n&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Ot(e,e=>{r.push(e),t&&this.collapseChildRows(e,r)}),n&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Ot(this.dataManager.getDataObject(e).__children,e=>{const n=this.dataManager.getRowIndex(e);t.push(n),this.collapseChildRows(n,t)})}n&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=[];return Ot(e,e=>{r.push(e),t&&this.expandChildRows(e,r)}),n&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Ot(this.dataManager.getDataObject(e).__children,e=>{if(!this.isAnyParentCollapsed(e)){const n=this.dataManager.getRowIndex(e);t.push(n),this.expandChildRows(n,t)}})}n&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];let i=null,o=null,s=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&Ot(i.__children,e=>{const t=this.dataManager.getRowIndex(e);r.push(t)}),s=this.expandRows(r,!0,!1),n&&this.untrimRows(s),t&&this.renderAndAdjust(),s}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=[];Ot(e,e=>{r.push(...this.expandChildren(e,!1,!1))}),n&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];Ot(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];Ot(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Ot(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Ot(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&Ot(t.__children,e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return n=!1,!1}),n}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);Ge(e.target,JN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Ln(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function eL(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function tL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nL(e,t){return e.get(function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(e,t))}var rL=new WeakMap;const iL=class extends XN{constructor(){super(...arguments),tL(this,"dataManager",this.plugin.dataManager),eL(this,rL,{row_above:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,t)=>{const n=t[t.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Tu)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(ku)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Zr(0,e.items.length-1,n=>{if(0===n)return Ot(t,(t,r)=>{e.items.splice(n+r,0,t)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Zr(0,e.items.length-1,t=>{const n=nL(rL,this)[e.items[t].key];null!==n&&void 0!==n&&(e.items[t].callback=n)}),e}};function oL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class sL{constructor(e){oL(this,"plugin",void 0),oL(this,"hot",void 0),oL(this,"dataManager",void 0),oL(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:r}))return!1;this.movedToCollapsed=!1;const i=n===this.hot.countRows(),o=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let s=!0;const a=e.map(e=>{if(!s)return!1;const t=this.dataManager.translateTrimmedRow(e);return s=this.shouldAllowMoving(t,o),t}),l=-1===a.indexOf(o);if(!s||!l)return!1;const c=this.getBaseParent(a),u=this.getTargetParent(i,o),d=c===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,o,d),this.moveRows(a,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(a,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:r,movePossible:i}=e;let o=!1;return Bt(r)&&(Bn(_t`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,r,i,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return null!==n&&void 0!==n||(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const r=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)})})}moveCellsMeta(e,t){const n=[],r=Math.max(...e)<t;e.forEach(e=>{n.push(this.hot.getCellMetaAtRow(e))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let r=0,i=0;if(this.movedToCollapsed){let o=null;o=e[n-1]<t?this.dataManager.translateTrimmedRow(t-n):this.dataManager.translateTrimmedRow(t);const s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),a=this.dataManager.getRowIndex(s);r=this.dataManager.untranslateTrimmedRow(a),i=r}else e[n-1]<t?(i=t-1,r=i-n+1):(r=t,i=r+n-1);this.hot.selectCells([[r,0,i,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((e,n)=>e-n!==t)}}function aL(e,t,n){lL(e,t),t.set(e,n)}function lL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uL(e,t){return e.get(hL(e,t))}function dL(e,t,n){return e.set(hL(e,t),n),n}function hL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const pL="nestedRows",gL=pL;var fL=new WeakMap,mL=new WeakMap,vL=new WeakSet;class wL extends vw{constructor(){var e,t;super(...arguments),lL(e=this,t=vL),t.add(e),cL(this,"dataManager",null),cL(this,"headersUI",null),cL(this,"collapsedRowsMap",null),aL(this,fL,!1),aL(this,mL,!1)}static get PLUGIN_KEY(){return pL}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[pL]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new pc),this.dataManager=new YN(this,this.hot),this.collapsingUI=new ZN(this,this.hot),this.headersUI=new JN(this,this.hot),this.contextMenuUI=new iL(this,this.hot),this.rowMoveController=new sL(this),this.addHook("afterInit",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,DL).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,FL).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,yL).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,SL).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,xL).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,CL).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,TL).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,EL).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,kL).call(e,...n)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,ML).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,PL).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,IL).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,RL).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,AL).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hL(vL,e,bL).call(e,...n)}),this.addHook("beforeLoadData",e=>hL(vL,this,OL).call(this,e)),this.addHook("beforeUpdateData",e=>hL(vL,this,OL).call(this,e)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const n=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return n&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(n)&&-1===n.col&&n.row>=0},group:gL,relativeToGroup:yp,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gL)}disableCoreAPIModifiers(){dL(mL,this,!0)}enableCoreAPIModifiers(){dL(mL,this,!1)}onModifyRowData(e){if(!uL(mL,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!uL(mL,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return!(!uL(mL,this)&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,n),!1)}destroy(){super.destroy()}}function bL(e,t,n,r){return this.rowMoveController.onBeforeRowMove(e,t,n,r)}function CL(e,t,n){this.collapsingUI.toggleState(e,t,n)}function yL(e,t,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),dL(fL,this,!0),this.dataManager.getData().slice()}function SL(e){return this.contextMenuUI.appendOptions(e)}function xL(e,t){this.headersUI.appendLevelIndicators(e,t)}function RL(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function EL(e,t,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{dL(fL,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function TL(e,t,n){const r=Array.from(n.reduce((e,t)=>{if(this.dataManager.isParent(t)){const n=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(n)&&n.forEach(t=>e.add(this.dataManager.getRowIndex(t))),e}return e.add(t)},new Set));n.length=0,n.push(...r)}function kL(){this.collapsingUI.collapsedRowsStash.stash()}function ML(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function PL(){this.collapsingUI.collapsedRowsStash.stash()}function IL(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function AL(){this.dataManager.rewriteCache()}function DL(){this.headersUI.updateRowHeaderWidth()}function FL(e,t){uL(fL,this)&&(t.skipRender=!0)}function OL(e){if(!function(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>"object"===typeof e&&!Array.isArray(e)&&null!==e))}(e))return Wn("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[pL]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}function NL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const LL=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;NL(this,"rootWindow",void 0),NL(this,"prefix",void 0),NL(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n="undefined"===typeof e?t:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return null===r?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Ot(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"===typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function _L(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}ir.getSingleton().register("persistentStateSave"),ir.getSingleton().register("persistentStateLoad"),ir.getSingleton().register("persistentStateReset");const HL="persistentState";class VL extends vw{constructor(){super(...arguments),_L(this,"storage",void 0)}static get PLUGIN_KEY(){return HL}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[HL]}enablePlugin(){this.enabled||(this.storage||(this.storage=new LL(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function BL(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function WL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zL(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const jL="search",GL=function(e,t,n,r,i){e.getCellMeta(t,n).isSearchResult=i},$L=function(e,t,n){return!(Bt(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!Bt(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(n.locale).indexOf(e.toLocaleLowerCase(n.locale)))};var UL=new WeakSet;class KL extends vw{constructor(){super(...arguments),BL(this,UL),WL(this,"callback",GL),WL(this,"queryMethod",$L),WL(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return jL}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[jL]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[jL];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zL(UL,e,YL).call(e,...n)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zL(UL,e,YL).call(e,...n)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),i=this.hot.countCols(),o=[],s=this.hot;return Zr(0,r-1,r=>{Zr(0,i-1,i=>{const a=this.hot.getDataAtCell(r,i),l=this.hot.getCellMeta(r,i),c=l.search.callback||t,u=(l.search.queryMethod||n)(e,a,l);if(u){const e={row:r,col:i,data:a};o.push(e)}c&&c(s,r,i,a,u)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){un(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function YL(e,t,n,r,i,o){const s=o.className||[];let a=[];"string"===typeof s?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function qL(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class XL{constructor(e){qL(this,"viewportWidth",void 0),qL(this,"overwriteColumnWidthFn",void 0),qL(this,"baseWidths",new Map),qL(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class QL extends XL{calculate(){const e=Array.from(this.baseWidths).reduce((e,t)=>{let[,n]=t;return e+n},0);if(this.viewportWidth-e<0)return void this.stretchedWidths.clear();const t=this.viewportWidth/e,n=[],r=[];let i=this.viewportWidth,o=0;if(this.baseWidths.forEach((e,s)=>{const a=Math.round(e*t),l=this.overwriteColumnWidthFn(a,s);a===l&&a>=xa?(n.push([s,l]),o+=l):a!==l&&(n.push([s,l]),r.push(s),i-=l)}),i<=xa)return void this.stretchedWidths.clear();const s=i/o;let a=-1,l=0;n.forEach((e,t)=>{let[i,o]=e,c=o;r.includes(i)||(c=Math.round(o*s)),this.stretchedWidths.set(i,c),a=i,t<n.length-1&&(l+=c)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(a,Math.round(this.viewportWidth-l))}}function JL(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function ZL(e,t){return e.get(t_(e,t))}function e_(e,t,n){return e.set(t_(e,t),n),n}function t_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var n_=new WeakMap,r_=new WeakMap;class i_ extends XL{constructor(){super(...arguments),JL(this,n_,0),JL(this,r_,-1)}prepare(e){super.prepare(e),e_(n_,this,0),e_(r_,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),e_(r_,this,e),e_(n_,this,t)}calculate(){if(-1===ZL(r_,this))return;const e=Array.from(this.baseWidths).reduce((e,t)=>{let[,n]=t;return e+n},0),t=Math.max(this.viewportWidth-e+ZL(n_,this),0);this.stretchedWidths.set(ZL(r_,this),t)}}function o_(e,t,n){s_(e,t),t.set(e,n)}function s_(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a_(e,t){return e.get(c_(e,t))}function l_(e,t,n){return e.set(c_(e,t),n),n}function c_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var u_=new WeakMap,d_=new WeakMap,h_=new WeakMap,p_=new WeakMap,g_=new WeakSet;class f_{constructor(e){var t,n;s_(t=this,n=g_),n.add(t),o_(this,u_,void 0),o_(this,d_,void 0),o_(this,h_,new Map([["all",new QL(c_(g_,this,w_).bind(this))],["last",new i_(c_(g_,this,w_).bind(this))]])),o_(this,p_,"none"),l_(u_,this,e),l_(d_,this,a_(u_,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(e){l_(p_,this,a_(h_,this).has(e)?e:"none")}refreshStretching(){"none"!==a_(p_,this)?a_(u_,this).batchExecution(()=>{a_(d_,this).clear();const e=a_(h_,this).get(a_(p_,this));let t=a_(u_,this).view.getViewportWidth();c_(g_,this,m_).call(this)&&(t-=vt(a_(u_,this).rootDocument)),e.prepare({viewportWidth:t});for(let n=0;n<a_(u_,this).countCols();n++)a_(u_,this).columnIndexMapper.isHidden(a_(u_,this).toPhysicalColumn(n))||e.setColumnBaseWidth(n,c_(g_,this,v_).call(this,n));e.calculate(),e.getWidths().forEach(e=>{let[t,n]=e;a_(d_,this).setValueAtIndex(a_(u_,this).toPhysicalColumn(t),n)})},!0):a_(d_,this).clear()}getStretchedWidth(e){return a_(d_,this).getValueAtIndex(a_(u_,this).toPhysicalColumn(e))}}function m_(){const{view:e}=a_(u_,this);if(e.isVerticallyScrollableByWindow())return!1;const t=e.getViewportHeight(),n=a_(u_,this).countRows(),r=e.getStylesHandler().getDefaultRowHeight();let i=0,o=!1;for(let a=0;a<n;a++){var s;if(i+=(null!==(s=a_(u_,this).getRowHeight(a))&&void 0!==s?s:r)+(0===a?1:0),i>t){o=!0;break}}return o}function v_(e){var t;return null!==(t=a_(u_,this).getColWidth(e,"StretchColumns"))&&void 0!==t?t:xa}function w_(e,t){return a_(u_,this).runHooks("beforeStretchingColumnWidth",e,t)}function b_(e,t,n){C_(e,t),t.set(e,n)}function C_(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y_(e,t,n){return e.set(x_(e,t),n),n}function S_(e,t){return e.get(x_(e,t))}function x_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var R_=new WeakMap,E_=new WeakMap,T_=new WeakMap,k_=new WeakSet;class M_ extends vw{constructor(){var e,t;super(...arguments),C_(e=this,t=k_),t.add(e),b_(this,R_,new f_(this.hot)),b_(this,E_,null),b_(this,T_,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;null!==(t=this.hot)&&void 0!==t&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(e=>{let{contentRect:t}=e;null!==S_(E_,this)&&S_(E_,this)!==t.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),y_(E_,this,t.width)})})}))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(S_(R_,this).useStrategy(this.hot.getSettings().stretchH),S_(T_,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x_(k_,e,I_).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return x_(k_,e,P_).call(e,...n)},10),super.enablePlugin())}updatePlugin(){S_(R_,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),S_(T_,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return S_(R_,this).getStretchedWidth(e)}destroy(){S_(T_,this).disconnect(),y_(T_,this,null),y_(R_,this,null),super.destroy()}}function P_(e,t,n){if(n===this.pluginName)return;const r=this.getColumnWidth(t);return"number"===typeof r?r:e}function I_(e){e&&S_(R_,this).refreshStretching()}function A_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function D_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F_(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var O_=new WeakSet;class N_ extends vw{constructor(){super(...arguments),A_(this,O_),D_(this,"scrollbars",[]),D_(this,"clones",[]),D_(this,"lockedCollection",!1),D_(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return bn()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>F_(O_,this,L_).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>F_(O_,this,__).call(this)),this.addHook("afterMomentumScroll",()=>F_(O_,this,H_).call(this))}}function L_(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function __(){this.freezeOverlays=!0,Ot(this.clones,e=>{$e(e,"hide-tween")})}function H_(){this.freezeOverlays=!1,Ot(this.clones,e=>{Ue(e,"hide-tween"),$e(e,"show-tween")}),this.hot._registerTimeout(()=>{Ot(this.clones,e=>{Ue(e,"show-tween")})},400),Ot(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function V_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function B_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const W_="trimRows";var z_=new WeakSet;class j_ extends vw{constructor(){super(...arguments),V_(this,z_),B_(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return W_}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[W_]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new pc),this.trimmedRowsMap.addLocalHook("init",()=>function(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}(z_,this,G_).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[W_];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Ot(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;n&&(r=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,r,n)&&(n&&this.hot.batchExecution(()=>{Ot(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),this.hot.runHooks("afterTrimRow",t,r,n,n&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let r=t;const i=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(Ot(e,e=>{i[e]=!1}),r=At(i,(e,t,n)=>(t&&e.push(n),e),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,r,n&&o)&&(n&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,r,n&&o,n&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}destroy(){super.destroy()}}function G_(){const e=this.hot.getSettings()[W_];Array.isArray(e)&&this.hot.batchExecution(()=>{Ot(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function $_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class U_{constructor(e){$_(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function K_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Y_ extends U_{constructor(e){let{stateBefore:t,range:n,type:r,alignment:i}=e;super("cell_alignment"),K_(this,"stateBefore",void 0),K_(this,"range",void 0),K_(this,"type",void 0),K_(this,"alignment",void 0),this.stateBefore=t,this.range=n,this.type=r,this.alignment=i}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(e,n,r,i)=>{t.done(()=>new Y_({stateBefore:e,range:n,type:r,alignment:i}))})}undo(e,t){Ot(this.range,t=>{t.forAll((t,n)=>{t>=0&&n>=0&&e.setCellMeta(t,n,"className",this.stateBefore[t][n]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){My(this.range,this.type,this.alignment,(t,n)=>e.getCellMeta(t,n),(t,n,r,i)=>e.setCellMeta(t,n,r,i)),e.addHookOnce("afterViewRender",t),e.render()}}function q_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X_ extends U_{constructor(e){let{columns:t,finalIndex:n}=e;super("col_move"),q_(this,"columns",void 0),q_(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(e,n)=>{!1!==e&&t.done(()=>new X_({columns:e,finalIndex:n}))})}undo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t);LM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveColumn(r,t)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function Q_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J_ extends U_{constructor(e){let{currentSortState:t,newSortState:n}=e;super("col_sort"),Q_(this,"previousSortState",void 0),Q_(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=n}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(e,n,r)=>{r&&t.done(()=>new J_({currentSortState:e,newSortState:n}))})}undo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),i=r.isEnabled()?r:n;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),t()}redo(e,t){const n=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:n).sort(this.nextSortState),t()}}function Z_(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class eH extends U_{constructor(e){let{index:t,amount:n}=e;super("insert_col"),Z_(this,"index",void 0),Z_(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(e,n,r)=>{t.done(()=>new eH({index:e,amount:n}),r)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function tH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nH extends U_{constructor(e){let{index:t,amount:n}=e;super("insert_row"),tH(this,"index",void 0),tH(this,"amount",void 0),this.index=t,this.amount=n}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(e,n,r)=>{t.done(()=>new nH({index:e,amount:n}),r)})}undo(e,t){const n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function rH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class iH extends U_{constructor(e){let{changes:t,selected:n,countCols:r,countRows:i}=e;super("change"),rH(this,"changes",void 0),rH(this,"selected",void 0),rH(this,"countCols",void 0),rH(this,"countRows",void 0),this.changes=t,this.selected=n,this.countCols=r,this.countRows=i}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(n,r){const i=n&&n.length;if(!i)return;if(!n.find(e=>{const[,,t,n]=e;return t!==n}))return;t.done(()=>{const t=n.reduce((e,t)=>(e.push([...t]),e),[]);t.forEach(t=>{t[1]=e.propToCol(t[1])});const r=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new iH({changes:t,selected:r,countCols:e.countCols(),countRows:e.countRows()})},r)})}undo(e,t){const n=sn(this.changes);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.undo");const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const i=e.countCols()-this.countCols;i>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,i,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){const n=sn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function oH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class sH extends U_{constructor(e){let{conditionsStack:t,previousConditionsStack:n}=e;super("filter"),oH(this,"conditionsStack",void 0),oH(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=n}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(e,n)=>{t.done(()=>new sH({conditionsStack:e,previousConditionsStack:n}))})}undo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,t){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),n.importConditions(this.conditionsStack),n.filter()}}function aH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class lH extends U_{constructor(e){let{data:t,cellRange:n}=e;super("merge_cells"),aH(this,"cellRange",void 0),this.cellRange=n,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(n,r)=>{if(r)return;const i=n.getTopStartCorner(),o=n.getBottomEndCorner(),s=e.getData(i.row,i.col,o.row,o.col);t.done(()=>new lH({data:s,cellRange:n}))})}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}function cH(e,t,n,r,i){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return Zr(r,i,r=>{Zr(t,n,t=>{const n=e.getCellMeta(t,r);if(Object.keys(n).length!==s){const e=Object.fromEntries(Object.entries(n).filter(e=>{let[t]=e;return!1===o.includes(t)}));a.push([n.visualRow,n.visualCol,e])}})}),a}function uH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class dH extends U_{constructor(e){let{index:t,indexes:n,data:r,amount:i,headers:o,columnPositions:s,rowPositions:a,fixedColumnsStart:l,removedCellMetas:c}=e;super("remove_col"),uH(this,"index",void 0),uH(this,"indexes",void 0),uH(this,"data",void 0),uH(this,"amount",void 0),uH(this,"headers",void 0),uH(this,"columnPositions",void 0),uH(this,"rowPositions",void 0),uH(this,"fixedColumnsStart",void 0),uH(this,"removedCellMetas",void 0),this.index=t,this.indexes=n,this.data=r,this.amount=i,this.headers=o,this.columnPositions=s.slice(0),this.rowPositions=a.slice(0),this.fixedColumnsStart=l,this.removedCellMetas=c}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(n,r,i,o)=>{t.done(()=>{const t=e.getSourceDataArray(),i=(e.countCols()+n)%e.countCols(),o=i+r-1,s=[],a=[],l=[];return Zr(t.length-1,n=>{const r=[],a=t[n];Zr(i,o,t=>{r.push(a[e.toPhysicalColumn(t)])}),s.push(r)}),Zr(r-1,t=>{l.push(e.toPhysicalColumn(i+t))}),Array.isArray(e.getSettings().colHeaders)&&Zr(r-1,t=>{a.push(e.getSettings().colHeaders[e.toPhysicalColumn(i+t)]||null)}),new dH({index:i,indexes:l,data:s,amount:r,headers:a,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:cH(e,0,e.countRows(),i,o)})},o)})}undo(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),r=(e,t,r)=>r[this.indexes.indexOf(n[t])],i=this.data.length,o=[];for(let l=0;l<i;l++)o.push(Ft(this.data[l],r));const s=Ft(this.headers,r),a=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),Ot(e.getSourceDataArray(),(e,t)=>{Ot(n,(n,r)=>{e[n]=o[t][r],a.push([t,n,e[n]])})}),"undefined"!==typeof this.headers&&Ot(s,(t,r)=>{e.getSettings().colHeaders[n[r]]=t}),this.removedCellMetas.forEach(t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(a,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function hH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pH extends U_{constructor(e){let{index:t,data:n,fixedRowsBottom:r,fixedRowsTop:i,rowIndexesSequence:o,removedCellMetas:s}=e;super("remove_row"),hH(this,"index",void 0),hH(this,"data",void 0),hH(this,"fixedRowsBottom",void 0),hH(this,"fixedRowsTop",void 0),hH(this,"rowIndexesSequence",void 0),hH(this,"removedCellMetas",void 0),this.index=t,this.data=n,this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=o,this.removedCellMetas=s}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(n,r,i,o)=>{t.done(()=>{const t=e.toPhysicalRow(n),i=t+r-1,o=sn(e.getSourceData(t,0,t+r-1,e.countSourceCols()-1));return new pH({index:t,data:o,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:cH(e,t,i,0,e.countCols()-1)})},o)})}undo(e,t){const n=e.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((e,t)=>{Object.keys(e).forEach(n=>{const i=parseInt(n,10);r.push([this.index+t,isNaN(i)?n:i,e[n]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(t=>{let[n,r,i]=t;e.setCellMetaObject(n,r,i)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function gH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fH extends U_{constructor(e){let{rows:t,finalIndex:n}=e;super("row_move"),gH(this,"rows",void 0),gH(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(e,n)=>{!1!==e&&t.done(()=>new fH({rows:e,finalIndex:n}))})}undo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t);LM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),n.moveRow(r,t)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function mH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vH extends U_{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),mH(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(e,n)=>{n||t.done(()=>new vH({cellRange:e}))})}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}function wH(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function bH(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CH(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}const yH="undoRedo";ir.getSingleton().register("beforeUndo"),ir.getSingleton().register("afterUndo"),ir.getSingleton().register("beforeRedo"),ir.getSingleton().register("afterRedo");const SH=new Set;var xH=new WeakSet;class RH extends vw{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(e){var t,n;super(e),wH(this,xH),bH(this,"doneActions",[]),bH(this,"undoneActions",[]),bH(this,"ignoreNewActions",!1),t=e,n=this,[Y_,X_,J_,eH,nH,iH,sH,lH,dH,pH,fH,vH].forEach(e=>e.startRegisteringEvents(t,n))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return CH(xH,e,EH).call(e,...n)}),this.registerShortcuts(),CH(xH,this,TH).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),CH(xH,this,kH).call(this)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:yH};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yH)}done(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const n=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",n,t))return;const r=e(),i=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",i,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=sn(t);if(!1===this.hot.runHooks("beforeUndo",n))return;this.ignoreNewActions=!0;const r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=sn(t);if(!1===this.hot.runHooks("beforeRedo",n))return;this.ignoreNewActions=!0;const r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function EH(e,t){"loadData"===t&&this.clear()}function TH(){const e=e=>{SH.has(e)||(Bn(_t`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),SH.add(e))};this.hot.undo=()=>{e("undo"),this.undo()},this.hot.redo=()=>{e("redo"),this.redo()},this.hot.isUndoAvailable=()=>(e("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(e("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{e("clear"),this.clear()},this.hot.undoRedo=this}function kH(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}var MH=n(579);vr(zp),vr(jf),vr($f),vr(Rm),vr(Tm),vr(Of),vr(km),vr(Pm),vr(Dm),vr($g),vr(Fm),xi(Nm),xi(Ug),xi(jm),xi(Lm),xi($m),xi(Om),xi(Bv),xi(Wv),xi(zv),xi(Kg),xi(jv),Pi(Gv),Pi(Kv),Pi(Uv),Pi(Yv),Pi(Xv),Hh(Qv),Hh(Jv),Hh(ew),Hh(tw),Hh(nw),Hh(rw),Hh(iw),Hh(ow),Hh(Yg),Hh(sw),mi(Nw),mi(Jw),mi(gb),mi(Nb),mi(qb),mi(NC),mi(YC),mi(Jy),mi(hx),mi(Zx),mi(TR),mi(OR),mi($R),mi(SE),mi(uM),mi(CP),mi(ZP),mi(pI),mi(kI),mi(rA),mi(OA),mi(hD),mi(jD),mi(qF),mi(TO),mi(MO),mi(MN),mi(wL),mi(VL),mi(KL),mi(M_),mi(N_),mi(j_),mi(RH);const PH=e=>{let{data:n,onDataChange:r}=e;const i=(0,t.useMemo)(()=>{if(!n||0===n.length){const e=5,t=5,n=[];for(let r=0;r<e;r++){const e=new Array(t).fill("");n.push(e)}return n}return n.map(e=>{const t=[];return Object.keys(e).forEach(n=>{const r=parseInt(n);t[r]=e[n]}),t})},[n]),o=(0,t.useCallback)(()=>{const e={};n.length>0?Object.keys(n[0]).forEach(t=>{e[t]=""}):e[0]="",r([...n,e])},[n,r]),s=(0,t.useCallback)(()=>{const e=Math.max(...n.flatMap(e=>Object.keys(e).map(e=>parseInt(e))),-1)+1,t=n.map(t=>({...t,[e]:""}));r(t)},[n,r]),a=(0,t.useMemo)(()=>(0,MH.jsx)(Df,{data:i,colHeaders:!0,rowHeaders:!0,height:"auto",width:"100%",licenseKey:"non-commercial-and-evaluation",stretchH:"all",autoWrapRow:!0,autoWrapCol:!0,minSpareRows:5,minSpareCols:2,contextMenu:!0,filters:!0,dropdownMenu:!0,columnSorting:!0,afterChange:(e,t)=>{if(e&&"loadData"!==t){const t=[...i];e.forEach(e=>{let[n,r,i,o]=e;t[n]&&"number"===typeof r&&(t[n][r]=o)});const n=t.map(e=>{const t={};return e.forEach((e,n)=>{t[n]=e}),t});r(n)}},settings:{licenseKey:"non-commercial-and-evaluation"}}),[i,r]);return(0,MH.jsxs)("div",{className:"spreadsheet-container",children:[(0,MH.jsxs)("div",{className:"spreadsheet-header",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcca Data Spreadsheet"}),(0,MH.jsxs)("div",{className:"spreadsheet-controls",children:[(0,MH.jsx)("button",{className:"control-btn add-row-btn",onClick:o,children:"\u2795 Add Row"}),(0,MH.jsx)("button",{className:"control-btn add-column-btn",onClick:s,children:"\u2795 Add Column"})]})]}),(0,MH.jsx)("div",{className:"spreadsheet-wrapper",children:a})]})};var IH=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,n){const r=t?this.allAsyncListeners:this.allSyncListeners;let i=r.get(e);return!i&&n&&(i=new Set,r.set(e,i)),i}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.getListeners(e,n,!0).add(t)}removeEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.getListeners(e,n,!1);if(r&&(r.delete(t),0===r.size)){(n?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const n=e.type;if(t&&"event"in e){const t=e.event;t instanceof Event&&(e.eventPath=t.composedPath())}const r=(n,r)=>n.forEach(n=>{if(!r.has(n))return;const i=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>n(e)):()=>n(e);t?this.dispatchAsync(i):i()}),i=this.getListeners(n,t,!1)??new Set,o=new Set(i);o.size>0&&r(o,i);new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(r=>{const i=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>r(n,e)):()=>r(n,e);t?this.dispatchAsync(i):i()})}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const e=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(e):e(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(e=>e())}},AH=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(AH||{}),DH={};function FH(e,t){DH[t]||(e(),DH[t]=!0)}function OH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];console.log("AG Grid: "+e,...n)}function NH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];FH(()=>console.warn("AG Grid: "+e,...n),e+n?.join(""))}function LH(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];FH(()=>console.error("AG Grid: "+e,...n),e+n?.join(""))}function _H(e){return!!(e&&e.constructor&&e.call&&e.apply)}function HH(e){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length>0&&window.setTimeout(()=>e.forEach(e=>e()),t)}(e,400)}var VH=[],BH=!1;function WH(e){VH.push(e),BH||(BH=!0,window.setTimeout(()=>{const e=VH.slice();VH.length=0,BH=!1,e.forEach(e=>e())},0))}function zH(e,t){let n;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];const s=this;window.clearTimeout(n),n=window.setTimeout(function(){e.apply(s,i)},t)}}function jH(e,t){let n=0;return function(){const r=(new Date).getTime();if(!(r-n<t)){n=r;for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];e.apply(this,o)}}}function GH(e){return null==e||""===e?null:e}function $H(e){return null!=e&&(""!==e||arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function UH(e){return!$H(e)}function KH(e){return null==e||0===e.length}function YH(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function qH(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"===typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function XH(e){if(void 0!==e)return null!==e&&""!==e&&QH(e)}function QH(e){return"boolean"===typeof e?e:"string"===typeof e&&("TRUE"===e.toUpperCase()||""==e)}function JH(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function ZH(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=null==e,i=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),r&&i)return 0;if(r)return-1;if(i)return 1;function o(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return o(e,t);if(!n)return o(e,t);try{return e.localeCompare(t)}catch(s){return o(e,t)}}function eV(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach(e=>t.push(e)),t}return Object.values(e)}function tV(e,t){return e.get("rowModelType")===t}function nV(e){return tV(e,"clientSide")}function rV(e){return tV(e,"serverSide")}function iV(e,t){return e.get("domLayout")===t}function oV(e){return void 0!==OV(e)}function sV(e){return!e.get("suppressAsyncEvents")}function aV(e){return"function"===typeof e.get("getRowHeight")}function lV(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;if(null==r&&(r=e.environment.getDefaultRowHeight()),aV(e)){if(n)return{height:r,estimated:!0};const i={node:t,data:t.data},o=e.getCallback("getRowHeight")(i);if(uV(o))return 0===o&&NH("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,o),estimated:!1}}if(t.detail&&e.get("masterDetail"))return function(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");if(uV(t))return{height:t,estimated:!1};return{height:300,estimated:!1}}(e);const i=e.get("rowHeight");return{height:i&&uV(i)?i:r,estimated:!1}}function cV(e){const{environment:t}=e,n=e.get("rowHeight");if(!n||UH(n))return t.getDefaultRowHeight();const r=t.refreshRowHeightVariable();return-1!==r?r:(NH("row height must be a number if not using standard row model"),t.getDefaultRowHeight())}function uV(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)}function dV(e,t,n){const r=t[e.getDomDataKey()];return r?r[n]:void 0}function hV(e,t,n,r){const i=e.getDomDataKey();let o=t[i];UH(o)&&(o={},t[i]=o),o[n]=r}function pV(e){let t=null;const n=e.get("getDocument");return n&&$H(n)?t=n():e.eGridDiv&&(t=e.eGridDiv.ownerDocument),t&&$H(t)?t:document}function gV(e){return pV(e).defaultView||window}function fV(e){return e.eGridDiv.getRootNode()}function mV(e){return fV(e).activeElement}function vV(e){const t=pV(e),n=mV(e);return null===n||n===t.body}function wV(e){return!e.get("ensureDomOrder")&&e.get("animateRows")}function bV(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||iV(e,"print"))}function CV(e){const t=e.get("autoGroupColumnDef");return!t?.comparator&&!e.get("treeData")}function yV(e){const t=e.get("groupAggFiltering");return"function"===typeof t?e.getCallback("groupAggFiltering"):!0===t?()=>!0:void 0}function SV(e){const t=e.get("grandTotalRow");if(t)return t;return e.get("groupIncludeTotalFooter")?"bottom":void 0}function xV(e){const t=e.get("groupTotalRow");if("function"===typeof t)return e.getCallback("groupTotalRow");if(t)return()=>t;const n=e.get("groupIncludeFooter");if("function"===typeof n){const t=e.getCallback("groupIncludeFooter");return e=>t(e)?"bottom":void 0}return()=>n?"bottom":void 0}function RV(e){return e.exists("groupDisplayType")?"multipleColumns"===e.get("groupDisplayType"):e.get("groupHideOpenParents")}function EV(e,t){return!t&&"groupRows"===e.get("groupDisplayType")}function TV(e){const t=e.getCallback("getRowId");return void 0===t?t:e=>{let n=t(e);return"string"!==typeof n&&(NH("The getRowId callback must return a string. The ID ",n," is being cast to a string."),n=String(n)),n}}function kV(e){return e?.checkboxes??!0}function MV(e){return"multiRow"===e?.mode&&(e.headerCheckbox??!0)}function PV(e){const t=e.get("cellSelection");return void 0!==t?!!t:e.get("enableRangeSelection")}function IV(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&"fill"===t.handle?.mode:e.get("enableFillHandle")}function AV(e){const t=e.get("rowSelection")??"single";if("string"===typeof t){const t=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return(!t||!n)&&(t?"enableDeselection":!n||"enableSelection")}return("singleRow"===t.mode||"multiRow"===t.mode)&&(t.enableClickSelection??!1)}function DV(e){const t=AV(e);return!0===t||"enableDeselection"===t}function FV(e){const t=e.get("rowSelection");return"string"===typeof t?e.get("isRowSelectable"):t?.isRowSelectable}function OV(e){const t=e.get("rowSelection");if("string"===typeof t)switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}return t?.mode}function NV(e){return"multiRow"===OV(e)}function LV(e){const t=e.get("rowSelection");if("string"===typeof t){const t=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return t&&n?"filteredDescendants":t?"descendants":"self"}return"multiRow"===t?.mode?t.groupSelects:void 0}function _V(e){const t=LV(e);return"descendants"===t||"filteredDescendants"===t}function HV(e){return e.isModuleRegistered("@ag-grid-enterprise/set-filter")&&!e.get("suppressSetFilterByDefault")}function VV(e){if(e&&e.length)return e[e.length-1]}function BV(e,t,n){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every((e,r)=>n?n(e,t[r]):t[r]===e)}function WV(e,t){const n=e.indexOf(t);n>=0&&(e[n]=e[e.length-1],e.pop())}function zV(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}function jV(e,t,n){e.splice(n,0,t)}function GV(e,t,n){!function(e,t){for(let n=0;n<t.length;n++)zV(e,t[n])}(e,t),t.slice().reverse().forEach(t=>jV(e,t,n))}function $V(e,t){return e.indexOf(t)>-1}function UV(e){return e?.flatMap(e=>e)??[]}function KV(e,t){null!=t&&null!=e&&t.forEach(t=>e.push(t))}var YV="__ag_Grid_Stop_Propagation",qV=["touchstart","touchend","touchmove","touchcancel","scroll"],XV={};function QV(e){e[YV]=!0}function JV(e){return!0===e[YV]}var ZV=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t=>{if("boolean"===typeof XV[t])return XV[t];const n=document.createElement(e[t]||"div");return XV[t="on"+t]=t in n}})();function eB(e,t,n){let r=t;for(;r;){const t=dV(e,r,n);if(t)return t;r=r.parentElement}return null}function tB(e,t){return!(!t||!e)&&function(e){const t=e;if(t.path)return t.path;if(t.composedPath)return t.composedPath();return function(e){const t=[];let n=e.target;for(;n;)t.push(n),n=n.parentElement;return t}(t)}(t).indexOf(e)>=0}var nB=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.frameworkOverrides=e.frameworkOverrides,this.stubContext=e.context,this.eventService=e.eventService,this.gos=e.gos,this.localeService=e.localeService}getFrameworkOverrides(){return this.frameworkOverrides}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,n){this.localEventService||(this.localEventService=new IH),this.localEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.localEventService&&this.localEventService.removeEventListener(e,t,n)}dispatchLocalEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventService,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const n=[];for(const r in t){const i=t[r];i&&n.push(this._setupListener(e,r,i))}return n}_setupListener(e,t,n){if(this.destroyed)return()=>null;e instanceof HTMLElement?function(e,t,n,r){const i=$V(qV,n)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,n,r,i)}(this.getFrameworkOverrides(),e,t,n):e.addEventListener(t,n);const r=()=>(e.removeEventListener(t,n),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==r),null)}setupGridOptionListener(e,t){this.gos.addPropertyEventListener(e,t);const n=()=>(this.gos.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(e=>e!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const n=e.join("-")+this.propertyListenerId++,r=e=>{if(e.changeSet){if(e.changeSet&&e.changeSet.id===this.lastChangeSetIdLookup[n])return;this.lastChangeSetIdLookup[n]=e.changeSet.id}const r={type:"gridPropertyChanged",changeSet:e.changeSet,source:e.source};t(r)};e.forEach(e=>this.setupGridOptionListener(e,r))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const n=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),n}createBean(e,t,n){return(t||this.stubContext).createBean(e,n)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function rB(e){return e instanceof iB}var iB=class extends nB{constructor(e,t,n,r){super(),this.isColumn=!1,this.expandable=!1,this.instanceId=EB(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=n,this.level=r}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some(e=>e.isVisible())}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach(t=>{TB(t)?e.push(t):rB(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,n=!1;const r=this.findChildrenRemovingPadding();for(let o=0,s=r.length;o<s;o++){const i=r[o];if(!i.isVisible())continue;const s=i.getColumnGroupShow();"open"===s?(e=!0,n=!0):"closed"===s?(t=!0,n=!0):(e=!0,t=!0)}const i=e&&t&&n;this.expandable!==i&&(this.expandable=i,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=n=>{n.forEach(n=>{rB(n)&&n.isPadding()?t(n.children):e.push(n)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},oB="ag-Grid-ControlsColumn",sB=class extends nB{constructor(){super(...arguments),this.beanName="controlsColService"}createControlsCols(){const{gos:e}=this,t=e.get("rowSelection");if(!t||"object"!==typeof t)return[];const n=kV(t),r=MV(t);if(n||r){const t=e.get("selectionColumnDef"),n={maxWidth:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:e.get("enableRtl")?"right":"left",comparator(e,t,n,r){const i=n.isSelected(),o=r.isSelected();return i&&o?0:i?1:-1},editable:!1,suppressFillHandle:!0,...t,colId:`${oB}`},r=new kB(n,null,n.colId,!1);return this.createBean(r),[r]}return[]}},aB="ag-Grid-AutoColumn";function lB(e){const t=[],n=e=>{for(let r=0;r<e.length;r++){const i=e[r];TB(i)?t.push(i):rB(i)&&n(i.getChildren())}};return n(e),t}function cB(e){return e.reduce((e,t)=>e+t.getActualWidth(),0)}function uB(e,t,n){const r={};if(!t)return;AB(null,t,e=>{r[e.getInstanceId()]=e}),n&&AB(null,n,e=>{r[e.getInstanceId()]=null});const i=Object.values(r).filter(e=>null!=e);e.destroyBeans(i)}function dB(e){return e.getId().startsWith(aB)}function hB(e){return e.getColId().startsWith(oB)}function pB(e){let t=[];if(e instanceof Array){e.some(e=>"string"!==typeof e)?NH("if colDef.type is supplied an array it should be of type 'string[]'"):t=e}else"string"===typeof e?t=e.split(","):NH("colDef.type should be of type 'string' | 'string[]'");return t}var gB=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e,t){const{frameworkOverrides:n,wrappedListeners:r}=this;let i=t;if(n.shouldWrapOutgoing){i=e=>{n.wrapOutgoing(()=>t(e))};let o=r.get(e);o||(o=new Map,r.set(e,o)),o.set(t,i)}return i}wrapGlobal(e){const{frameworkOverrides:t,wrappedGlobalListeners:n}=this;let r=e;return t.shouldWrapOutgoing&&(r=(n,r)=>{t.wrapOutgoing(()=>e(n,r))},n.set(e,r)),r}unwrap(e,t){const{wrappedListeners:n}=this,r=n.get(e);if(r){const i=r.get(t);if(i)return r.delete(t),0===r.size&&n.delete(e),i}return t}unwrapGlobal(e){const{wrappedGlobalListeners:t}=this,n=t.get(e);return n?(t.delete(e),n):e}},fB=new Set(["__proto__","constructor","prototype"]);function mB(e,t){if(null!=e)if(Array.isArray(e))for(let n=0;n<e.length;n++)t(n.toString(),e[n]);else for(const[n,r]of Object.entries(e))t(n,r)}function vB(e){const t={},n=Object.keys(e);for(let r=0;r<n.length;r++){if(fB.has(n[r]))continue;const i=n[r],o=e[i];t[i]=o}return t}function wB(e,t){if(!e)return;const n=e,r={};return Object.keys(n).forEach(e=>{if(t&&t.indexOf(e)>=0||fB.has(e))return;const i=n[e],o=SB(i)&&i.constructor===Object;r[e]=o?wB(i):i}),r}function bB(e){if(!e)return[];const t=Object;if("function"===typeof t.values)return t.values(e);const n=[];for(const r in e)e.hasOwnProperty(r)&&e.propertyIsEnumerable(r)&&n.push(e[r]);return n}function CB(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];$H(t)&&mB(t,(t,i)=>{if(fB.has(t))return;let o=e[t];if(o!==i){if(r){if(null==o&&null!=i){"object"===typeof i&&i.constructor===Object&&(o={},e[t]=o)}}SB(i)&&SB(o)&&!Array.isArray(o)?CB(o,i,n,r):(n||void 0!==i)&&(e[t]=i)}})}function yB(e,t,n){if(!t||!e)return;if(!n)return e[t];const r=t.split(".");let i=e;for(let o=0;o<r.length;o++){if(null==i)return;i=i[r[o]]}return i}function SB(e){return"object"===typeof e&&null!==e}var xB={resizable:!0,sortable:!0},RB=0;function EB(){return RB++}function TB(e){return e instanceof kB}var kB=class extends nB{constructor(e,t,n,r){super(),this.isColumn=!0,this.instanceId=EB(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.columnEventService=new IH,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=n,this.primary=r,this.setState(e)}wireBeans(e){this.columnHoverService=e.columnHoverService}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);const t=e.sortIndex,n=e.initialSortIndex;void 0!==t?null!==t&&(this.sortIndex=t):null!==n&&(this.sortIndex=n);const r=e.hide,i=e.initialHide;this.visible=void 0!==r?!r:!i,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const o=e.flex,s=e.initialFlex;void 0!==o?this.flex=o:void 0!==s&&(this.flex=s)}setColDef(e,t,n){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.columnEventService.dispatchEvent(this.createColumnEvent("colDefChanged",n))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}postConstruct(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=$H(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=$H(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.gos.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=$H(this.colDef.tooltipField)||$H(this.colDef.tooltipValueGetter)||$H(this.colDef.tooltipComponent)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const n=qH(e.width),r=qH(e.initialWidth);return t=null!=n?n:null!=r?r:200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(UH(this.colDef)||UH(this.colDef.showRowGroup))return!1;const t=!0===this.colDef.showRowGroup,n=this.colDef.showRowGroup===e;return t||n}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}addEventListener(e,t){this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.columnEventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new gB(this.frameworkOverrides));const n=this.frameworkEventListenerService?.wrap(e,t)??t;this.columnEventService.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(e,t)??t;this.columnEventService.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){const t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1}isCellEditable(e){if(e.group)if(this.gos.get("treeData")){if(!e.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1;return this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){const t=this.gos.get("rowSelection");if(t&&"string"!==typeof t){const n=hB(this)&&kV(t);return this.isColumnFunc(e,n)}return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??xB[e]}isColumnFunc(e,t){if("boolean"===typeof t)return t;if("function"===typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.columnEventService.dispatchEvent(this.createColumnEvent("headerHighlightChanged","uiColumnMoved")))}setMoving(e,t){this.moving=e,this.columnEventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t){this.sort!==e&&(this.sort=e,this.columnEventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return UH(this.sort)}isSorting(){return $H(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setMenuVisible(e,t){this.menuVisible!==e&&(this.menuVisible=e,this.columnEventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.columnEventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t,n){this.filterActive!==e&&(this.filterActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const r=this.createColumnEvent("filterChanged",t);n&&CB(r,n),this.columnEventService.dispatchEvent(r)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t){const n=!0===e;this.visible!==n&&(this.visible=n,this.columnEventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let n=!0;for(;e;){if(!e.isPadding()){n=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:n}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(UH(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.colSpan(t);return Math.max(n,1)}getRowSpan(e){if(UH(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.rowSpan(t);return Math.max(n,1)}setActualWidth(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.columnEventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t){this.pivotActive!==e&&(this.pivotActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t){this.aggregationActive!==e&&(this.aggregationActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}dispatchStateUpdatedEvent(e){this.columnEventService.dispatchEvent({type:"columnStateUpdated",key:e})}},MB={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},PB=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=YH(e);let n=0;for(;;){let r;if(e?(r=e,0!==n&&(r+="_"+n)):t?(r=t,0!==n&&(r+="_"+n)):r=n,!this.existingKeys[r])return this.existingKeys[r]=!0,String(r);n++}}},IB=class extends nB{constructor(){super(...arguments),this.beanName="columnFactory"}wireBeans(e){this.dataTypeService=e.dataTypeService}createColumnTree(e,t,n,r){const i=new PB,{existingCols:o,existingGroups:s,existingColKeys:a}=this.extractExistingTreeData(n);i.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,o,i,s,r),c=this.findMaxDept(l,0),u=this.balanceColumnTree(l,0,c,i);return AB(null,u,(e,t)=>{rB(e)&&e.setupExpandable(),e.setOriginalParent(t)}),{columnTree:u,treeDept:c}}extractExistingTreeData(e){const t=[],n=[],r=[];return e&&AB(null,e,e=>{if(rB(e)){const t=e;n.push(t)}else{const n=e;r.push(n.getId()),t.push(n)}}),{existingCols:t,existingGroups:n,existingColKeys:r}}balanceTreeForAutoCols(e,t){const n=[],r=this.findDepth(t);return e.forEach(e=>{let t=e;for(let n=r-1;n>=0;n--){const r=new iB(null,`FAKE_PATH_${e.getId()}}_${n}`,!0,n);this.createBean(r),r.setChildren([t]),t.setOriginalParent(r),t=r}0===r&&e.setOriginalParent(null),n.push(t)}),[n,r]}findDepth(e){let t=0,n=e;for(;n&&n[0]&&rB(n[0]);)t++,n=n[0].getChildren();return t}balanceColumnTree(e,t,n,r){const i=[];for(let o=0;o<e.length;o++){const s=e[o];if(rB(s)){const e=s,o=this.balanceColumnTree(e.getChildren(),t+1,n,r);e.setChildren(o),i.push(e)}else{let o,a;for(let e=n-1;e>=t;e--){const e=r.getUniqueKey(null,null),n=this.createMergedColGroupDef(null),i=new iB(n,e,!0,t);this.createBean(i),a&&a.setChildren([i]),a=i,o||(o=a)}if(o&&a){i.push(o);if(e.some(e=>rB(e))){a.setChildren([s]);continue}a.setChildren(e);break}i.push(s)}}return i}findMaxDept(e,t){let n=t;for(let r=0;r<e.length;r++){const i=e[r];if(rB(i)){const e=i,r=this.findMaxDept(e.getChildren(),t+1);n<r&&(n=r)}}return n}recursivelyCreateColumns(e,t,n,r,i,o,s){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const c=e[l];this.isColumnGroup(c)?a[l]=this.createColumnGroup(n,c,t,r,i,o,s):a[l]=this.createColumn(n,c,r,i,s)}return a}createColumnGroup(e,t,n,r,i,o,s){const a=this.createMergedColGroupDef(t),l=i.getUniqueKey(a.groupId||null,null),c=new iB(a,l,!1,n);this.createBean(c);const u=this.findExistingGroup(t,o);u&&o.splice(u.idx,1);const d=u?.group;d&&c.setExpanded(d.isExpanded());const h=this.recursivelyCreateColumns(a.children,n+1,e,r,i,o,s);return c.setChildren(h),c}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,n,r,i){const o=this.findExistingColumn(t,n);o&&n?.splice(o.idx,1);let s=o?.column;if(s){const e=this.addColumnDefaultAndTypes(t,s.getColId());s.setColDef(e,t,i),this.applyColumnState(s,e,i)}else{const n=r.getUniqueKey(t.colId,t.field),i=this.addColumnDefaultAndTypes(t,n);s=new kB(i,t,n,e),this.createBean(s)}return this.dataTypeService?.addColumnListeners(s),s}applyColumnState(e,t,n){const r=qH(t.flex);void 0!==r&&e.setFlex(r);if(e.getFlex()<=0){const r=qH(t.width);if(null!=r)e.setActualWidth(r,n);else{const t=e.getActualWidth();e.setActualWidth(t,n)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort,n):e.setSort(void 0,n));const i=qH(t.sortIndex);void 0!==i&&e.setSortIndex(i);const o=XH(t.hide);void 0!==o&&e.setVisible(!o,n),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let n=0;n<t.length;n++){const r=t[n].getUserProvidedColDef();if(!r)continue;if(null!=e.colId){if(t[n].getId()===e.colId)return{idx:n,column:t[n]};continue}if(null!=e.field){if(r.field===e.field)return{idx:n,column:t[n]}}else if(r===e)return{idx:n,column:t[n]}}}findExistingGroup(e,t){if(null!=e.groupId)for(let n=0;n<t.length;n++){const r=t[n];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:n,group:r}}}addColumnDefaultAndTypes(e,t){const n={};CB(n,this.gos.get("defaultColDef"),!1,!0);const r=this.updateColDefAndGetColumnType(n,e,t);r&&this.assignColumnTypes(r,n),CB(n,e,!1,!0);const i=this.gos.get("autoGroupColumnDef"),o=CV(this.gos);return e.rowGroup&&i&&o&&CB(n,{sort:i.sort,initialSort:i.initialSort},!1,!0),this.dataTypeService?.validateColDef(n),n}updateColDefAndGetColumnType(e,t,n){const r=this.dataTypeService?.updateColDefAndGetColumnType(e,t,n),i=t.type??r??e.type;return e.type=i,i?pB(i):void 0}assignColumnTypes(e,t){if(!e.length)return;const n=Object.assign({},MB);mB(this.gos.get("columnTypes")||{},(e,t)=>{if(e in n)NH(`the column type '${e}' is a default column type and cannot be overridden.`);else{t.type&&NH("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),n[e]=t}}),e.forEach(e=>{const r=n[e.trim()];r?CB(t,r,!1,!0):NH("colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(e){return void 0!==e.children}};function AB(e,t,n){if(t)for(let r=0;r<t.length;r++){const i=t[r];rB(i)&&AB(i,i.getChildren(),n),n(i,e)}}var DB=class extends nB{constructor(){super(...arguments),this.beanName="columnModel",this.pivotMode=!1,this.autoHeightActiveAtLeastOnce=!1,this.ready=!1,this.changeEventsDispatching=!1,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}wireBeans(e){this.context=e.context,this.ctrlsService=e.ctrlsService,this.columnFactory=e.columnFactory,this.columnSizeService=e.columnSizeService,this.visibleColsService=e.visibleColsService,this.columnViewportService=e.columnViewportService,this.pivotResultColsService=e.pivotResultColsService,this.columnAnimationService=e.columnAnimationService,this.autoColService=e.autoColService,this.controlsColService=e.controlsColService,this.valueCache=e.valueCache,this.columnDefFactory=e.columnDefFactory,this.columnApplyStateService=e.columnApplyStateService,this.columnGroupStateService=e.columnGroupStateService,this.eventDispatcher=e.columnEventDispatcher,this.columnMoveService=e.columnMoveService,this.columnAutosizeService=e.columnAutosizeService,this.funcColsService=e.funcColsService,this.quickFilterService=e.quickFilterService,this.showRowGroupColsService=e.showRowGroupColsService,this.environment=e.environment}postConstruct(){const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],e=>this.refreshAll(FB(e.source))),this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,FB(e.source))}),this.addManagedPropertyListener("autoGroupColumnDef",e=>this.onAutoGroupColumnDefChanged(FB(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],e=>this.recreateColumnDefs(FB(e.source))),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),FB(e.source))),this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}createColsFromColDefs(e){const t=this.colDefs?this.columnApplyStateService.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire();const n=this.colDefCols?.list,r=this.colDefCols?.tree,i=this.columnFactory.createColumnTree(this.colDefs,!0,r,e);uB(this.context,this.colDefCols?.tree,i.columnTree);const o=i.columnTree,s=i.treeDept,a=lB(o),l={};a.forEach(e=>l[e.getId()]=e),this.colDefCols={tree:o,treeDepth:s,list:a,map:l},this.funcColsService.extractCols(e,n),this.ready=!0,this.refreshCols(!0),this.visibleColsService.refresh(e),this.columnViewportService.checkViewportColumns(),this.eventDispatcher.everythingChanged(e),t&&(this.changeEventsDispatching=!0,t(),this.changeEventsDispatching=!1),this.eventDispatcher.newColumnsLoaded(e),"gridInitializing"===e&&this.columnSizeService.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder(),this.selectCols(),this.createAutoCols(),this.addAutoCols(),this.createControlsCols(),this.addControlsCols();const n=(r=this.gos,this.showingPivotResult?!r.get("enableStrictPivotColumnOrder"):r.get("maintainColumnOrder"));var r;e&&!n||this.restoreColOrder(),this.positionLockedCols(),this.showRowGroupColsService?.refresh(),this.quickFilterService?.refreshQuickFilterCols(),this.setColSpanActive(),this.setAutoHeightActive(),this.visibleColsService.clear(),this.columnViewportService.clear();!BV(t,this.cols.tree)&&this.eventDispatcher.gridColumns()}selectCols(){const e=this.pivotResultColsService.getPivotResultCols();if(this.showingPivotResult=null!=e,e){const{map:t,list:n,tree:r,treeDepth:i}=e;this.cols={list:n.slice(),map:{...t},tree:r.slice(),treeDepth:i};e.list.some(e=>void 0!==this.cols?.map[e.getColId()])||(this.lastPivotOrder=null)}else{const{map:e,list:t,tree:n,treeDepth:r}=this.colDefCols;this.cols={list:t.slice(),map:{...e},tree:n.slice(),treeDepth:r}}}getColsToShow(){const e=this.isPivotMode()&&!this.isShowingPivotResult(),t=this.funcColsService.getValueColumns();return this.cols.list.filter(n=>{const r=dB(n);if(e){const e=t&&$V(t,n);return r||e}return r||n.isVisible()})}addAutoCols(){null!=this.autoCols&&(this.cols.list=this.autoCols.list.concat(this.cols.list),this.cols.tree=this.autoCols.tree.concat(this.cols.tree),OB(this.cols))}createAutoCols(){const e=EV(this.gos,this.pivotMode),t=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),n=this.funcColsService.getRowGroupColumns(),r=()=>{this.autoCols&&(uB(this.context,this.autoCols.tree),this.autoCols=null)};if(!(n.length>0||this.gos.get("treeData"))||t||e||!this.autoColService)return void r();const i=this.autoColService.createAutoCols(n)??[],o=LB(i,this.autoCols?.list||null),s=this.cols.treeDepth,a=this.autoCols?this.autoCols.treeDepth:-1;if(o&&a==s)return;r();const[l,c]=this.columnFactory.balanceTreeForAutoCols(i,this.cols.tree);this.autoCols={list:i,tree:l,treeDepth:c,map:{}};const u=e=>{if(!e)return null;const t=e.filter(e=>!dB(e));return[...i,...t]};this.lastOrder=u(this.lastOrder),this.lastPivotOrder=u(this.lastPivotOrder)}createControlsCols(){const e=()=>{uB(this.context,this.controlsCols?.tree),this.controlsCols=null};this.controlsColService||e();const t=this.cols.treeDepth,n=(this.controlsCols?.treeDepth??-1)==t,r=this.controlsColService?.createControlsCols()??[];if(LB(r,this.controlsCols?.list??[])&&n)return;e();const[i,o]=this.columnFactory.balanceTreeForAutoCols(r,this.cols.tree);this.controlsCols={list:r,tree:i,treeDepth:o,map:{}};const s=e=>{if(!e)return null;const t=e.filter(e=>!hB(e));return[...r,...t]};this.lastOrder=s(this.lastOrder),this.lastPivotOrder=s(this.lastPivotOrder)}addControlsCols(){null!=this.controlsCols&&(this.cols.list=this.controlsCols.list.concat(this.cols.list),this.cols.tree=this.controlsCols.tree.concat(this.cols.tree),OB(this.cols))}refreshAll(e){this.isReady()&&(this.refreshCols(!1),this.visibleColsService.refresh(e))}setColsVisible(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.columnApplyStateService.applyColumnState({state:e.map(e=>({colId:"string"===typeof e?e:e.getColId(),hide:!t}))},n)}setColsPinned(e,t,n){if(!this.cols)return;if(KH(e))return;if(iV(this.gos,"print"))return void NH("Changing the column pinning status is not allowed with domLayout='print'");let r;this.columnAnimationService.start(),r=!0===t||"left"===t?"left":"right"===t?"right":null;const i=[];e.forEach(e=>{if(!e)return;const t=this.getCol(e);t&&t.getPinned()!==r&&(t.setPinned(r),i.push(t))}),i.length&&(this.visibleColsService.refresh(n),this.eventDispatcher.columnPinned(i,n)),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,n){let r;r=rB(e)?e.getId():e||"",this.columnGroupStateService.setColumnGroupState([{groupId:r,open:t}],n)}getProvidedColGroup(e){let t=null;return AB(null,this.cols?.tree,n=>{rB(n)&&n.getId()===e&&(t=n)}),t}isColGroupLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||0===t)return!1;if(-1===t)return!0;return t>this.funcColsService.getRowGroupColumns().findIndex(t=>t.getColId()===e.getColId())}isSuppressAutoCol(){if("custom"===this.gos.get("groupDisplayType"))return!0;return"custom"===this.gos.get("treeDataDisplayType")}setAutoHeightActive(){if(this.autoHeightActive=this.cols.list.some(e=>e.isVisible()&&e.isAutoHeight()),this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;nV(this.gos)||rV(this.gos)||NH("autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}}restoreColOrder(){const e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;const t=new Map(e.map((e,t)=>[e,t]));if(!this.cols.list.some(e=>t.has(e)))return;const n=new Map(this.cols.list.map(e=>[e,!0])),r=e.filter(e=>n.has(e)),i=new Map(r.map(e=>[e,!0])),o=this.cols.list.filter(e=>!i.has(e)),s=r.slice();o.forEach(e=>{let t=e.getOriginalParent();if(!t)return void s.push(e);const n=[];for(;!n.length&&t;){t.getLeafColumns().forEach(e=>{const t=s.indexOf(e)>=0,r=n.indexOf(e)<0;t&&r&&n.push(e)}),t=t.getOriginalParent()}if(!n.length)return void s.push(e);const r=n.map(e=>s.indexOf(e)),i=Math.max(...r);jV(s,e,i+1)}),this.cols.list=s}sortColsLikeKeys(e){if(null==this.cols)return;let t=[];const n={};e.forEach(e=>{if(n[e])return;const r=this.cols.map[e];r&&(t.push(r),n[e]=!0)});let r=0;this.cols.list.forEach(e=>{const i=e.getColId();if(null!=n[i])return;i.startsWith(aB)?jV(t,e,r++):t.push(e)}),t=this.columnMoveService.placeLockedColumns(t),this.columnMoveService.doesMovePassMarryChildren(t)?this.cols.list=t:NH("Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}sortColsLikeCols(e){if(!e||e.length<=1)return;e.filter(e=>this.cols.list.indexOf(e)<0).length>0||e.sort((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t))}resetColDefIntoCol(e,t){const n=e.getUserProvidedColDef();if(!n)return!1;const r=this.columnFactory.addColumnDefaultAndTypes(n,e.getColId());return e.setColDef(r,n,t),!0}queueResizeOperations(){this.shouldQueueResizeOperations=!0}isShouldQueueResizeOperations(){return this.shouldQueueResizeOperations}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}moveInCols(e,t,n){GV(this.cols?.list,e,t),this.visibleColsService.refresh(n)}positionLockedCols(){this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list:this.lastOrder=this.cols?.list}getColumnDefs(){if(!this.colDefCols)return;const e=this.colDefCols.list.slice();this.showingPivotResult?e.sort((e,t)=>this.lastOrder.indexOf(e)-this.lastOrder.indexOf(t)):this.lastOrder&&e.sort((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t));const t=this.funcColsService.getRowGroupColumns(),n=this.funcColsService.getPivotColumns();return this.columnDefFactory.buildColumnDefs(e,t,n)}isShowingPivotResult(){return this.showingPivotResult}isChangeEventsDispatching(){return this.changeEventsDispatching}isColSpanActive(){return this.colSpanActive}isProvidedColGroupsPresent(){return this.colDefCols?.treeDepth>0}setColSpanActive(){this.colSpanActive=this.cols.list.some(e=>null!=e.getColDef().colSpan)}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}getHeaderRowCount(){return this.cols?this.cols.treeDepth+1:-1}isReady(){return this.ready}isPivotMode(){return this.pivotMode}setPivotMode(e,t){e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)&&(this.pivotMode=e,this.ready&&(this.refreshCols(!1),this.visibleColsService.refresh(t),this.eventDispatcher.pivotModeChanged()))}isPivotSettingAllowed(e){return!e||!this.gos.get("treeData")||(NH("Pivot mode not available with treeData."),!1)}isPivotActive(){const e=this.funcColsService.getPivotColumns();return this.pivotMode&&!KH(e)}recreateColumnDefs(e){this.cols&&(this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e),this.createColsFromColDefs(e))}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){uB(this.context,this.colDefCols?.tree),uB(this.context,this.autoCols?.tree),uB(this.context,this.controlsCols?.tree),super.destroy()}getColTree(){return this.cols.tree}getColDefColTree(){return this.colDefCols.tree}getColDefCols(){return this.colDefCols?.list?this.colDefCols.list:null}getCols(){return this.cols?.list??[]}getAllCols(){const e=this.pivotResultColsService.getPivotResultCols(),t=e?.list;return[this.colDefCols?.list??[],this.autoCols?.list??[],this.controlsCols?.list??[],t??[]].flat()}getColsForKeys(e){return e?e.map(e=>this.getCol(e)).filter(e=>null!=e):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return null==e?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(null==t)return null;const{map:n,list:r}=t;if("string"==typeof e&&n[e])return n[e];for(let i=0;i<r.length;i++)if(NB(r[i],e))return r[i];return this.getAutoCol(e)}getAutoCol(e){return this.autoCols?.list.find(t=>NB(t,e))??null}getAutoCols(){return this.autoCols?.list??null}setColHeaderHeight(e,t){e.setAutoHeaderHeight(t)&&(e.isColumn?this.eventDispatcher.headerHeight(e):this.eventDispatcher.groupHeaderHeight(e))}getGroupRowsHeight(){const e=[],t=this.ctrlsService.getHeaderRowContainerCtrls();for(const n of t){if(!n)continue;const t=n.getGroupRowCount()||0;for(let r=0;r<t;r++){const t=n.getGroupRowCtrlAtIndex(r),i=e[r];if(t){const n=this.getColumnGroupHeaderRowHeight(t);(null==i||n>i)&&(e[r]=n)}}}return e}getColumnGroupHeaderRowHeight(e){const t=this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight();let n=0;const r=e.getHeaderCtrls();for(const i of r){const e=i.getColumn();if(e.isAutoHeaderHeight()){const t=e.getAutoHeaderHeight();null!=t&&t>n&&(n=t)}}return Math.max(t,n)}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.visibleColsService.getAllCols().filter(e=>e.isAutoHeaderHeight()).map(e=>e.getAutoHeaderHeight()||0);return Math.max(e,...t)}getHeaderHeight(){return this.gos.get("headerHeight")??this.environment.getDefaultHeaderHeight()}getFloatingFiltersHeight(){return this.gos.get("floatingFiltersHeight")??this.getHeaderHeight()}getGroupHeaderHeight(){return this.gos.get("groupHeaderHeight")??this.getHeaderHeight()}getPivotHeaderHeight(){return this.gos.get("pivotHeaderHeight")??this.getHeaderHeight()}getPivotGroupHeaderHeight(){return this.gos.get("pivotGroupHeaderHeight")??this.getGroupHeaderHeight()}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if("fitCellContents"!==e?.type)return;const{colIds:t,skipHeader:n}=e;setTimeout(()=>{t?this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:n,source:"autosizeColumns"}):this.columnAutosizeService.autoSizeAllColumns("autosizeColumns",n)})}onAutoGroupColumnDefChanged(e){this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e)}onSelectionOptionsChanged(e,t,n){const r=(t&&"string"!==typeof t?kV(t):void 0)!==(e&&"string"!==typeof e?kV(e):void 0),i=t&&"string"!==typeof t?MV(t):void 0,o=e&&"string"!==typeof e?MV(e):void 0;(r||i!==o)&&this.refreshAll(n)}};function FB(e){return"gridOptionsUpdated"===e?"gridOptionsChanged":e}function OB(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function NB(e,t){const n=e===t,r=e.getColDef()===t,i=e.getColId()==t;return n||r||i}function LB(e,t){return BV(e,t,(e,t)=>e.getColId()===t.getColId())}var _B=class extends nB{constructor(){super(...arguments),this.beanName="columnAutosizeService",this.timesDelayed=0}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.animationFrameService=e.animationFrameService,this.autoWidthCalculator=e.autoWidthCalculator,this.eventDispatcher=e.columnEventDispatcher,this.ctrlsService=e.ctrlsService,this.renderStatusService=e.renderStatusService}autoSizeCols(e){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.autoSizeCols(e));const{colKeys:t,skipHeader:n,skipHeaderGroups:r,stopAtGroup:i,source:o="api"}=e;if(this.animationFrameService.flushAllFrames(),this.timesDelayed<5&&this.renderStatusService&&!this.renderStatusService.areHeaderCellsRendered())return this.timesDelayed++,void setTimeout(()=>this.autoSizeCols(e));this.timesDelayed=0;const s=[];let a=-1;const l=null!=n?n:this.gos.get("skipHeaderOnAutoSize"),c=null!=r?r:l;for(;0!==a;){a=0;const e=[];t.forEach(t=>{if(!t)return;const n=this.columnModel.getCol(t);if(!n)return;if(s.indexOf(n)>=0)return;const r=this.autoWidthCalculator.getPreferredWidthForColumn(n,l);if(r>0){const e=this.normaliseColumnWidth(n,r);n.setActualWidth(e,o),s.push(n),a++}e.push(n)}),e.length&&this.visibleColsService.refresh(o)}c||this.autoSizeColumnGroupsByColumns(t,o,i),this.eventDispatcher.columnResized(s,!0,"autosizeColumns")}autoSizeColumn(e,t,n){e&&this.autoSizeCols({colKeys:[e],skipHeader:n,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,n){const r=new Set;let i;this.columnModel.getColsForKeys(e).forEach(e=>{let t=e.getParent();for(;t&&t!=n;)t.isPadding()||r.add(t),t=t.getParent()});for(const o of r){for(const e of this.ctrlsService.getHeaderRowContainerCtrls())if(i=e.getHeaderCtrlForColumn(o),i)break;i&&i.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.autoSizeAllColumns(e,t));const n=this.visibleColsService.getAllCols();this.autoSizeCols({colKeys:n,skipHeader:t,source:e})}normaliseColumnWidth(e,t){const n=e.getMinWidth();t<n&&(t=n);const r=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=r),t}},HB=class extends nB{constructor(){super(...arguments),this.beanName="funcColsService",this.rowGroupCols=[],this.valueCols=[],this.pivotCols=[]}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.aggFuncService=e.aggFuncService,this.visibleColsService=e.visibleColsService}getModifyColumnsNoEventsCallbacks(){return{addGroupCol:e=>this.rowGroupCols.push(e),removeGroupCol:e=>zV(this.rowGroupCols,e),addPivotCol:e=>this.pivotCols.push(e),removePivotCol:e=>zV(this.pivotCols,e),addValueCol:e=>this.valueCols.push(e),removeValueCol:e=>zV(this.valueCols,e)}}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupCols.slice(0);const n=this.columnModel.getColDefCol(t);return n?[n]:null}sortRowGroupColumns(e){this.rowGroupCols.sort(e)}sortPivotColumns(e){this.pivotCols.sort(e)}getValueColumns(){return this.valueCols?this.valueCols:[]}getPivotColumns(){return this.pivotCols?this.pivotCols:[]}getRowGroupColumns(){return this.rowGroupCols?this.rowGroupCols:[]}isRowGroupEmpty(){return KH(this.rowGroupCols)}setColumnAggFunc(e,t,n){if(!e)return;const r=this.columnModel.getColDefCol(e);r&&(r.setAggFunc(t),this.eventDispatcher.columnChanged("columnValueChanged",[r],n))}setRowGroupColumns(e,t){this.setColList(e,this.rowGroupCols,"columnRowGroupChanged",!0,!0,(e,n)=>this.setRowGroupActive(e,n,t),t)}setRowGroupActive(e,t,n){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,n),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.columnModel.setColsVisible([t],!1,n),e||this.gos.get("suppressMakeColumnVisibleAfterUnGroup")||this.columnModel.setColsVisible([t],!0,n))}addRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!0,!0,e=>this.setRowGroupActive(!0,e,t),"columnRowGroupChanged",t)}removeRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!1,!0,e=>this.setRowGroupActive(!1,e,t),"columnRowGroupChanged",t)}addPivotColumns(e,t){this.updateColList(e,this.pivotCols,!0,!1,e=>e.setPivotActive(!0,t),"columnPivotChanged",t)}setPivotColumns(e,t){this.setColList(e,this.pivotCols,"columnPivotChanged",!0,!1,(e,n)=>{n.setPivotActive(e,t)},t)}removePivotColumns(e,t){this.updateColList(e,this.pivotCols,!1,!1,e=>e.setPivotActive(!1,t),"columnPivotChanged",t)}setValueColumns(e,t){this.setColList(e,this.valueCols,"columnValueChanged",!1,!1,(e,n)=>this.setValueActive(e,n,t),t)}setValueActive(e,t,n){if(e!==t.isValueActive()&&(t.setValueActive(e,n),e&&!t.getAggFunc()&&this.aggFuncService)){const e=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(e)}}addValueColumns(e,t){this.updateColList(e,this.valueCols,!0,!1,e=>this.setValueActive(!0,e,t),"columnValueChanged",t)}removeValueColumns(e,t){this.updateColList(e,this.valueCols,!1,!1,e=>this.setValueActive(!1,e,t),"columnValueChanged",t)}moveRowGroupColumn(e,t,n){if(this.isRowGroupEmpty())return;const r=this.rowGroupCols[e],i=this.rowGroupCols.slice(e,t);this.rowGroupCols.splice(e,1),this.rowGroupCols.splice(t,0,r),this.eventDispatcher.rowGroupChanged(i,n)}setColList(e,t,n,r,i,o,s){if(!this.columnModel.getCols())return;const a=new Map;t.forEach((e,t)=>a.set(e,t)),t.length=0,$H(e)&&e.forEach(e=>{const n=this.columnModel.getColDefCol(e);n&&t.push(n)}),t.forEach((e,t)=>{const n=a.get(e);void 0!==n?r&&n!==t||a.delete(e):a.set(e,0)});(this.columnModel.getColDefCols()||[]).forEach(e=>{const n=t.indexOf(e)>=0;o(n,e)}),i&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(s),this.eventDispatcher.columnChanged(n,[...a.keys()],s)}updateColList(e,t,n,r,i,o,s){if(!e||KH(e))return;let a=!1;const l=new Set;e.forEach(e=>{if(!e)return;const r=this.columnModel.getColDefCol(e);if(r){if(l.add(r),n){if(t.indexOf(r)>=0)return;t.push(r)}else{const e=t.indexOf(r);if(e<0)return;for(let n=e+1;n<t.length;n++)l.add(t[n]);zV(t,r)}i(r),a=!0}}),a&&(r&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(s),this.eventDispatcher.genericColumnEvent(o,Array.from(l),s))}extractCols(e,t){this.extractRowGroupCols(e,t),this.extractPivotCols(e,t),this.extractValueCols(e,t)}extractValueCols(e,t){this.valueCols=this.extractColsCommon(t,this.valueCols,(t,n)=>t.setValueActive(n,e),()=>{},()=>{},e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0},e=>null!=e.initialAggFunc&&""!=e.initialAggFunc),this.valueCols.forEach(e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)})}extractRowGroupCols(e,t){this.rowGroupCols=this.extractColsCommon(t,this.rowGroupCols,(t,n)=>t.setRowGroupActive(n,e),e=>e.rowGroupIndex,e=>e.initialRowGroupIndex,e=>e.rowGroup,e=>e.initialRowGroup)}extractPivotCols(e,t){this.pivotCols=this.extractColsCommon(t,this.pivotCols,(t,n)=>t.setPivotActive(n,e),e=>e.pivotIndex,e=>e.initialPivotIndex,e=>e.pivot,e=>e.initialPivot)}extractColsCommon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;const a=[],l=[];(this.columnModel.getColDefCols()||[]).forEach(n=>{const c=e.indexOf(n)<0,u=n.getColDef(),d=XH(o(u)),h=XH(s(u)),p=qH(r(u)),g=qH(i(u));let f;if(f=void 0!==d?d:void 0!==p?null!==p&&p>=0:c?void 0!==h?h:!!(void 0!==g)&&(null!=g&&g>=0):t.indexOf(n)>=0,f){(c?null!=p||null!=g:null!=p)?a.push(n):l.push(n)}});const c=e=>{const t=r(e.getColDef()),n=i(e.getColDef());return null!=t?t:n};a.sort((e,t)=>{const n=c(e),r=c(t);return n===r?0:n<r?-1:1});const u=[].concat(a);return t.forEach(e=>{l.indexOf(e)>=0&&u.push(e)}),l.forEach(e=>{u.indexOf(e)<0&&u.push(e)}),t.forEach(e=>{u.indexOf(e)<0&&n(e,!1)}),u.forEach(e=>{t.indexOf(e)<0&&n(e,!0)}),u}generateColumnStateForRowGroupAndPivotIndexes(e,t){const n={},r=(e,t,r,i,o,s)=>{const a=this.columnModel.getColDefCols();if(!t.length||!a)return[];const l=Object.keys(e),c=new Set(l),u=new Set(l),d=new Set(t.map(e=>{const t=e.getColId();return u.delete(t),t}).concat(l)),h=[],p={};let g=0;for(let n=0;n<a.length;n++){const e=a[n].getColId();d.has(e)&&(h.push(e),p[e]=g++)}let f=1e3,m=!1,v=0;const w=t=>{const n=p[t];for(let r=v;r<n;r++){const t=h[r];u.has(t)&&(e[t][o]=f++,u.delete(t))}v=n};t.forEach(t=>{const a=t.getColId();if(c.has(a))w(a),e[a][o]=f++;else{const l=t.getColDef();if(null===l[o]||void 0===l[o]&&null==l[s]){if(!m){l[r]||void 0===l[r]&&l[i]?w(a):(u.forEach(t=>{e[t][o]=f+p[t]}),f+=h.length,m=!0)}n[a]||(n[a]={colId:a}),n[a][o]=f++}}})};return r(e,this.rowGroupCols,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),r(t,this.pivotCols,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(n)}},VB=class extends nB{constructor(){super(...arguments),this.beanName="columnApplyStateService"}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.sortController=e.sortController,this.columnGetStateService=e.columnGetStateService,this.funcColsService=e.funcColsService,this.visibleColsService=e.visibleColsService,this.columnAnimationService=e.columnAnimationService,this.pivotResultColsService=e.pivotResultColsService}applyColumnState(e,t){const n=this.columnModel.getColDefCols()||[];if(KH(n))return!1;if(e&&e.state&&!e.state.forEach)return NH("applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const r=this.funcColsService.getModifyColumnsNoEventsCallbacks(),i=(n,i,o)=>{const s=this.compareColumnStatesAndDispatchEvents(t),a=i.slice(),l={},c={},u=[],d=[];let h=0;const p=this.funcColsService.getRowGroupColumns().slice(),g=this.funcColsService.getPivotColumns().slice();n.forEach(n=>{const i=n.colId||"";if(i.startsWith(aB))return u.push(n),void d.push(n);const s=o(i);s?(this.syncColumnWithStateItem(s,n,e.defaultState,l,c,!1,t,r),zV(a,s)):(d.push(n),h+=1)});const f=n=>this.syncColumnWithStateItem(n,null,e.defaultState,l,c,!1,t,r);a.forEach(f),this.funcColsService.sortRowGroupColumns(BB.bind(this,l,p)),this.funcColsService.sortPivotColumns(BB.bind(this,c,g)),this.columnModel.refreshCols(!1);const m=(this.columnModel.getAutoCols()||[]).slice();return u.forEach(n=>{const i=this.columnModel.getAutoCol(n.colId);zV(m,i),this.syncColumnWithStateItem(i,n,e.defaultState,null,null,!0,t,r)}),m.forEach(f),this.orderLiveColsLikeState(e),this.visibleColsService.refresh(t),this.eventDispatcher.everythingChanged(t),s(),{unmatchedAndAutoStates:d,unmatchedCount:h}};this.columnAnimationService.start();let{unmatchedAndAutoStates:o,unmatchedCount:s}=i(e.state||[],n,e=>this.columnModel.getColDefCol(e));if(o.length>0||$H(e.defaultState)){const e=this.pivotResultColsService.getPivotResultCols(),t=e?.list;s=i(o,t||[],e=>this.pivotResultColsService.getPivotResultCol(e)).unmatchedCount}return this.columnAnimationService.finish(),0===s}resetColumnState(e){if(KH(this.columnModel.getColDefCols()))return;const t=lB(this.columnModel.getColDefColTree()),n=[];let r=1e3,i=1e3,o=[];const s=this.columnModel.getAutoCols();s&&(o=o.concat(s)),t&&(o=o.concat(t)),o.forEach(e=>{const t=this.getColumnStateFromColDef(e);UH(t.rowGroupIndex)&&t.rowGroup&&(t.rowGroupIndex=r++),UH(t.pivotIndex)&&t.pivot&&(t.pivotIndex=i++),n.push(t)}),this.applyColumnState({state:n,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(e,t)=>null!=e?e:null!=t?t:null,n=e.getColDef(),r=t(n.sort,n.initialSort),i=t(n.sortIndex,n.initialSortIndex),o=t(n.hide,n.initialHide),s=t(n.pinned,n.initialPinned),a=t(n.width,n.initialWidth),l=t(n.flex,n.initialFlex);let c=t(n.rowGroupIndex,n.initialRowGroupIndex),u=t(n.rowGroup,n.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let d=t(n.pivotIndex,n.initialPivotIndex),h=t(n.pivot,n.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);const p=t(n.aggFunc,n.initialAggFunc);return{colId:e.getColId(),sort:r,sortIndex:i,hide:o,pinned:s,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:p}}syncColumnWithStateItem(e,t,n,r,i,o,s,a){if(!e)return;const l=(e,r)=>{const i={value1:void 0,value2:void 0};let o=!1;return t&&(void 0!==t[e]&&(i.value1=t[e],o=!0),$H(r)&&void 0!==t[r]&&(i.value2=t[r],o=!0)),!o&&n&&(void 0!==n[e]&&(i.value1=n[e]),$H(r)&&void 0!==n[r]&&(i.value2=n[r])),i},c=l("hide").value1;void 0!==c&&e.setVisible(!c,s);const u=l("pinned").value1;void 0!==u&&e.setPinned(u);const d=e.getColDef().minWidth??this.gos.environment.getDefaultColumnMinWidth(),h=l("flex").value1;if(void 0!==h&&e.setFlex(h),null==h){const t=l("width").value1;null!=t&&null!=d&&t>=d&&e.setActualWidth(t,s)}const p=l("sort").value1;void 0!==p&&("desc"===p||"asc"===p?e.setSort(p,s):e.setSort(void 0,s));const g=l("sortIndex").value1;if(void 0!==g&&e.setSortIndex(g),o||!e.isPrimary())return;const f=l("aggFunc").value1;void 0!==f&&("string"===typeof f?(e.setAggFunc(f),e.isValueActive()||(e.setValueActive(!0,s),a.addValueCol(e))):($H(f)&&NH("stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,s),a.removeValueCol(e))));const{value1:m,value2:v}=l("rowGroup","rowGroupIndex");void 0===m&&void 0===v||("number"===typeof v||m?(e.isRowGroupActive()||(e.setRowGroupActive(!0,s),a.addGroupCol(e)),r&&"number"===typeof v&&(r[e.getId()]=v)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,s),a.removeGroupCol(e)));const{value1:w,value2:b}=l("pivot","pivotIndex");void 0===w&&void 0===b||("number"===typeof b||w?(e.isPivotActive()||(e.setPivotActive(!0,s),a.addPivotCol(e)),i&&"number"===typeof b&&(i[e.getId()]=b)):e.isPivotActive()&&(e.setPivotActive(!1,s),a.removePivotCol(e)))}orderLiveColsLikeState(e){if(!e.applyOrder||!e.state)return;const t=[];e.state.forEach(e=>{null!=e.colId&&t.push(e.colId)}),this.columnModel.sortColsLikeKeys(t)}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.funcColsService.getRowGroupColumns().slice(),pivotColumns:this.funcColsService.getPivotColumns().slice(),valueColumns:this.funcColsService.getValueColumns().slice()},n=this.columnGetStateService.getColumnState(),r={};return n.forEach(e=>{r[e.colId]=e}),()=>{const i=this.columnModel.getAllCols(),o=(t,n,r,i)=>{if(BV(n.map(i),r.map(i)))return;const o=new Set(n);r.forEach(e=>{o.delete(e)||o.add(e)});const s=[...o];this.eventService.dispatchEvent({type:t,columns:s,column:1===s.length?s[0]:null,source:e})},s=e=>{const t=[];return i.forEach(n=>{const i=r[n.getColId()];i&&e(i,n)&&t.push(n)}),t},a=e=>e.getColId();o("columnRowGroupChanged",t.rowGroupColumns,this.funcColsService.getRowGroupColumns(),a),o("columnPivotChanged",t.pivotColumns,this.funcColsService.getPivotColumns(),a);const l=s((e,t)=>{const n=null!=e.aggFunc,r=n!=t.isValueActive(),i=n&&e.aggFunc!=t.getAggFunc();return r||i});l.length>0&&this.eventDispatcher.columnChanged("columnValueChanged",l,e);this.eventDispatcher.columnResized(s((e,t)=>e.width!=t.getActualWidth()),!0,e);this.eventDispatcher.columnPinned(s((e,t)=>e.pinned!=t.getPinned()),e);this.eventDispatcher.columnVisible(s((e,t)=>e.hide==t.isVisible()),e);const c=s((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex());c.length>0&&this.sortController.dispatchSortChangedEvents(e,c),this.normaliseColumnMovedEventForColumnState(n,e)}}normaliseColumnMovedEventForColumnState(e,t){const n=this.columnGetStateService.getColumnState(),r={};n.forEach(e=>r[e.colId]=e);const i={};e.forEach(e=>{r[e.colId]&&(i[e.colId]=!0)});const o=e.filter(e=>i[e.colId]),s=n.filter(e=>i[e.colId]),a=[];s.forEach((e,t)=>{const n=o&&o[t];if(n&&n.colId!==e.colId){const e=this.columnModel.getCol(n.colId);e&&a.push(e)}}),a.length&&this.eventDispatcher.columnMoved({movedColumns:a,source:t,finished:!0})}},BB=(e,t,n,r)=>{const i=e[n.getId()],o=e[r.getId()],s=null!=i,a=null!=o;if(s&&a)return i-o;if(s)return-1;if(a)return 1;const l=t.indexOf(n),c=t.indexOf(r),u=l>=0;return u&&c>=0?l-c:u?-1:1},WB=class extends nB{constructor(){super(...arguments),this.beanName="columnMoveService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher}moveColumnByIndex(e,t,n){const r=this.columnModel.getCols();if(!r)return;const i=r[e];this.moveColumns([i],t,n)}moveColumns(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=this.columnModel.getCols();if(!i)return;if(t>i.length-e.length)return NH("tried to insert columns in invalid location, toIndex = ",t),void NH("remember that you should not count the moving columns when calculating the new index");this.columnAnimationService.start();const o=this.columnModel.getColsForKeys(e);this.doesMovePassRules(o,t)&&(this.columnModel.moveInCols(o,t,n),this.eventDispatcher.columnMoved({movedColumns:o,source:n,toIndex:t,finished:r})),this.columnAnimationService.finish()}doesMovePassRules(e,t){const n=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(n)}doesOrderPassRules(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}getProposedColumnOrder(e,t){const n=this.columnModel.getCols().slice();return GV(n,e,t),n}doesMovePassLockedPositions(e){const t=this.gos.get("enableRtl");let n=t?1:-1,r=!0;return e.forEach(e=>{const i=(e=>e?"left"===e||!0===e?-1:1:0)(e.getColDef().lockPosition);t?i>n&&(r=!1):i<n&&(r=!1),n=i}),r}doesMovePassMarryChildren(e){let t=!0;return AB(null,this.columnModel.getColTree(),n=>{if(!rB(n))return;const r=n,i=r.getColGroupDef();if(!(i&&i.marryChildren))return;const o=[];r.getLeafColumns().forEach(t=>{const n=e.indexOf(t);o.push(n)});Math.max.apply(Math,o)-Math.min.apply(Math,o)>r.getLeafColumns().length-1&&(t=!1)}),t}placeLockedColumns(e){const t=[],n=[],r=[];e.forEach(e=>{const i=e.getColDef().lockPosition;"right"===i?r.push(e):"left"===i||!0===i?t.push(e):n.push(e)});return this.gos.get("enableRtl")?[...r,...n,...t]:[...t,...n,...r]}},zB=/[&<>"']/g,jB={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function GB(e){const t=String.fromCharCode;function n(e,n){return t(e>>n&63|128)}function r(e){if(0==(4294967168&e))return t(e);let r="";return 0==(4294965248&e)?r=t(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),r=t(e>>12&15|224),r+=n(e,6)):0==(4292870144&e)&&(r=t(e>>18&7|240),r+=n(e,12),r+=n(e,6)),r+=t(63&e|128),r}const i=function(e){const t=[];if(!e)return[];const n=e.length;let r,i,o=0;for(;o<n;)r=e.charCodeAt(o++),r>=55296&&r<=56319&&o<n?(i=e.charCodeAt(o++),56320==(64512&i)?t.push(((1023&r)<<10)+(1023&i)+65536):(t.push(r),o--)):t.push(r);return t}(e),o=i.length;let s,a=-1,l="";for(;++a<o;)s=i[a],l+=r(s);return l}function $B(e,t){if(null==e)return null;const n=e.toString().toString();return t?n:n.replace(zB,e=>jB[e])}var UB=class extends nB{constructor(){super(...arguments),this.beanName="columnNameService"}wireBeans(e){this.expressionService=e.expressionService,this.funcColsService=e.funcColsService,this.columnModel=e.columnModel}getDisplayNameForColumn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;const r=this.getHeaderName(e.getColDef(),e,null,null,t);return n?this.wrapHeaderNameWithAggFunc(e,r):r}getDisplayNameForProvidedColumnGroup(e,t,n){const r=t?t.getColGroupDef():null;return r?this.getHeaderName(r,null,e,t,n):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,n,r,i){const o=e.headerValueGetter;if(o){const s=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:n,providedColumnGroup:r,location:i});return"function"===typeof o?o(s):"string"===typeof o?this.expressionService.evaluate(o,s):(NH("headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?(s=e.field)&&null!=s?s.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):"")).join(" "):null:"";var s}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const n=e.getColDef().pivotValueColumn;let r,i=null;if($H(n)){const o=this.funcColsService.getValueColumns(),s=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===o.length,a=void 0!==e.getColDef().pivotTotalColumnIds;if(s&&!a)return t;i=n?n.getAggFunc():null,r=!0}else{const t=e.isValueActive(),n=this.columnModel.isPivotMode()||!this.funcColsService.isRowGroupEmpty();t&&n?(i=e.getAggFunc(),r=!0):r=!1}if(r){const e="string"===typeof i?i:"func";return`${this.localeService.getLocaleTextFunc()(e,e)}(${t})`}return t}},KB=class extends nB{constructor(){super(...arguments),this.beanName="pivotResultColsService"}wireBeans(e){this.context=e.context,this.columnModel=e.columnModel,this.columnFactory=e.columnFactory,this.visibleColsService=e.visibleColsService}destroy(){uB(this.context,this.pivotResultCols?.tree),super.destroy()}isPivotResultColsPresent(){return null!=this.pivotResultCols}lookupPivotResultCol(e,t){if(null==this.pivotResultCols)return null;const n=this.columnModel.getColDefCol(t);let r=null;return this.pivotResultCols.list.forEach(t=>{const i=t.getColDef().pivotKeys,o=t.getColDef().pivotValueColumn;BV(i,e)&&o===n&&(r=t)}),r}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.columnModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){if(this.columnModel.isReady()&&(null!=e||null!=this.pivotResultCols)){if(e){this.processPivotResultColDef(e);const n=this.columnFactory.createColumnTree(e,!1,this.pivotResultCols?.tree||this.previousPivotResultCols||void 0,t);uB(this.context,this.pivotResultCols?.tree,n.columnTree);const r=n.columnTree,i=n.treeDept,o=lB(r),s={};this.pivotResultCols={tree:r,treeDepth:i,list:o,map:s},this.pivotResultCols.list.forEach(e=>this.pivotResultCols.map[e.getId()]=e);const a=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.columnModel.refreshCols(!a)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.columnModel.refreshCols(!1);this.visibleColsService.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),n=this.gos.get("processPivotResultColGroupDef");if(!t&&!n)return;const r=e=>{e.forEach(e=>{if($H(e.children)){const t=e;n&&n(t),r(t.children)}else{t&&t(e)}})};e&&r(e)}},YB=class extends nB{constructor(){super(...arguments),this.beanName="columnSizeService"}wireBeans(e){this.columnModel=e.columnModel,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}setColumnWidths(e,t,n,r){const i=[];e.forEach(e=>{const n=this.columnModel.getColDefCol(e.key)||this.columnModel.getCol(e.key);if(!n)return;i.push({width:e.newWidth,ratios:[1],columns:[n]});if("shift"===this.gos.get("colResizeDefault")&&(t=!t),t){const t=this.visibleColsService.getColAfter(n);if(!t)return;const r=n.getActualWidth()-e.newWidth,o=t.getActualWidth()+r;i.push({width:o,ratios:[1],columns:[t]})}}),0!==i.length&&this.resizeColumnSets({resizeSets:i,finished:n,source:r})}resizeColumnSets(e){const{resizeSets:t,finished:n,source:r}=e;if(!(!t||t.every(e=>this.checkMinAndMaxWidthsForSet(e)))){if(n){const e=t&&t.length>0?t[0].columns:null;this.eventDispatcher.columnResized(e,n,r)}return}const i=[],o=[];t.forEach(e=>{const{width:t,columns:n,ratios:s}=e,a={},l={};n.forEach(e=>o.push(e));let c=!0,u=0;for(;c;){if(u++,u>1e3){LH("infinite loop in resizeColumnSets");break}c=!1;const e=[];let r=0,i=t;n.forEach((t,n)=>{if(l[t.getId()])i-=a[t.getId()];else{e.push(t);const i=s[n];r+=i}});const o=1/r;e.forEach((n,r)=>{let u;r===e.length-1?u=i:(u=Math.round(s[r]*t*o),i-=u);const d=n.getMinWidth(),h=n.getMaxWidth();u<d?(u=d,l[n.getId()]=!0,c=!0):h>0&&u>h&&(u=h,l[n.getId()]=!0,c=!0),a[n.getId()]=u})}n.forEach(e=>{const t=a[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,r),i.push(e))})});const s=i.length>0;let a=[];s&&(a=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.visibleColsService.setLeftValues(r),this.visibleColsService.updateBodyWidths(),this.columnViewportService.checkViewportColumns());const l=o.concat(a);(s||n)&&this.eventDispatcher.columnResized(l,n,r,a)}checkMinAndMaxWidthsForSet(e){const{columns:t,width:n}=e;let r=0,i=0,o=!0;t.forEach(e=>{const t=e.getMinWidth();r+=t||0;const n=e.getMaxWidth();n>0?i+=n:o=!1});return n>=r&&(!o||n<=i)}refreshFlexedColumns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];const n=this.visibleColsService.getCenterCols();let r=-1;if(e.resizingCols){const t=new Set(e.resizingCols);for(let e=n.length-1;e>=0;e--)if(t.has(n[e])){r=e;break}}let i=0,o=[],s=0,a=0;for(let h=0;h<n.length;h++){n[h].getFlex()&&h>r?(o.push(n[h]),a+=n[h].getFlex(),s+=n[h].getMinWidth()):i+=n[h].getActualWidth()}if(!o.length)return[];let l=[];i+s>this.flexViewportWidth&&(o.forEach(e=>e.setActualWidth(e.getMinWidth(),t)),l=o,o=[]);const c=[];let u;e:for(;;){u=this.flexViewportWidth-i;const e=u/a;for(let n=0;n<o.length;n++){const r=o[n],s=e*r.getFlex();let u=0;const d=r.getMinWidth(),h=r.getMaxWidth();if(s<d?u=d:s>h&&(u=h),u){r.setActualWidth(u,t),WV(o,r),a-=r.getFlex(),l.push(r),i+=r.getActualWidth();continue e}c[n]=Math.floor(s)}break}let d=u;return o.forEach((e,n)=>{const r=n<o.length-1?Math.min(c[n],d):Math.max(c[n],d);e.setActualWidth(r,t),l.push(e),d-=c[n]}),e.skipSetLeft||this.visibleColsService.setLeftValues(t),e.updateBodyWidths&&this.visibleColsService.updateBodyWidths(),e.fireResizedEvent&&this.eventDispatcher.columnResized(l,!0,t,o),o}sizeColumnsToFit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sizeColumnsToFit",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,n,r));const i={};r&&r?.columnLimits?.forEach(e=>{let{key:t,...n}=e;i["string"===typeof t?t:t.getColId()]=n});const o=this.visibleColsService.getAllCols(),s=e===cB(o);if(e<=0||!o.length||s)return;const a=[],l=[];o.forEach(e=>{!0===e.getColDef().suppressSizeToFit?l.push(e):a.push(e)});const c=a.slice(0);let u=!1;const d=e=>{zV(a,e),l.push(e)};for(a.forEach(e=>{e.resetActualWidth(t);const n=i?.[e.getId()],o=n?.minWidth??r?.defaultMinWidth,s=n?.maxWidth??r?.defaultMaxWidth,a=e.getActualWidth();"number"===typeof o&&a<o?e.setActualWidth(o,t,!0):"number"===typeof s&&a>s&&e.setActualWidth(s,t,!0)});!u;){u=!0;const n=e-cB(l);if(n<=0)a.forEach(e=>{const n=i?.[e.getId()]?.minWidth??r?.defaultMinWidth;"number"!==typeof n?e.setMinimum(t):e.setActualWidth(n,t,!0)});else{const e=n/cB(a);let o=n;for(let n=a.length-1;n>=0;n--){const s=a[n],l=i?.[s.getId()],c=l?.minWidth??r?.defaultMinWidth,h=l?.maxWidth??r?.defaultMaxWidth,p=s.getMinWidth(),g=s.getMaxWidth(),f="number"===typeof c&&c>p?c:p,m="number"===typeof h&&h<g?h:g;let v=Math.round(s.getActualWidth()*e);v<f?(v=f,d(s),u=!1):v>m?(v=m,d(s),u=!1):0===n&&(v=o),s.setActualWidth(v,t,!0),o-=v}}}c.forEach(e=>{e.fireColumnWidthChangedEvent(t)}),this.visibleColsService.setLeftValues(t),this.visibleColsService.updateBodyWidths(),n||this.eventDispatcher.columnResized(c,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout(()=>{if("fitGridWidth"===t){const{columnLimits:t,defaultMinWidth:n,defaultMaxWidth:r}=e,i=t?.map(e=>{let{colId:t,minWidth:n,maxWidth:r}=e;return{key:t,minWidth:n,maxWidth:r}});this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:n,defaultMaxWidth:r,columnLimits:i})}else"fitProvidedWidth"===t&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")})}};function qB(e,t){return e+"_"+t}function XB(e){return e instanceof QB}var QB=class extends nB{constructor(e,t,n,r){super(),this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.groupId=t,this.partId=n,this.providedColumnGroup=e,this.pinned=r}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return qB(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every(e=>e.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{XB(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const e=VV(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{TB(t)?e.push(t):XB(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{TB(t)?e.push(t):XB(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;null!=e&&e.isPadding();)e=e.getParent();if(!(!!e&&e.getProvidedColumnGroup().isExpandable()))return this.displayedChildren=this.children,void this.dispatchLocalEvent({type:"displayedChildrenChanged"});this.children.forEach(t=>{if(XB(t)&&(!t.displayedChildren||!t.displayedChildren.length))return;switch(t.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(t);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(t);break;default:this.displayedChildren.push(t)}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},JB=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let n;return n="number"!==typeof t?0:t+1,this.existingIds[e]=n,n}},ZB=class extends nB{constructor(){super(...arguments),this.beanName="visibleColsService",this.colsAndGroupsMap={},this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher}refresh(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.buildTrees(),this.updateOpenClosedVisibilityInColumnGroups(),this.columnsLeft=tW(this.treeLeft),this.columnsCenter=tW(this.treeCenter),this.columnsRight=tW(this.treeRight),this.joinColsAriaOrder(),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.columns.filter(e=>e.isAutoHeight()),this.columnSizeService.refreshFlexedColumns(),this.updateBodyWidths(),this.columnViewportService.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(e),this.eventDispatcher.visibleCols(e)}updateBodyWidths(){const e=cB(this.columnsCenter),t=cB(this.columnsLeft),n=cB(this.columnsRight);this.bodyWidthDirty=this.bodyWidth!==e;(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==n)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=n,this.eventService.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventService.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e){let t,n;this.gos.get("enableRtl")?(t=this.columnsLeft?this.columnsLeft[0]:null,n=this.columnsRight?VV(this.columnsRight):null):(t=this.columnsLeft?VV(this.columnsLeft):null,n=this.columnsRight?this.columnsRight[0]:null),this.columnModel.getCols().forEach(r=>{r.setLastLeftPinned(r===t,e),r.setFirstRightPinned(r===n,e)})}buildTrees(){const e=this.columnModel.getColsToShow(),t=e.filter(e=>"left"==e.getPinned()),n=e.filter(e=>"right"==e.getPinned()),r=e.filter(e=>"left"!=e.getPinned()&&"right"!=e.getPinned()),i=new JB;this.treeLeft=this.createGroups({columns:t,idCreator:i,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=this.createGroups({columns:n,idCreator:i,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=this.createGroups({columns:r,idCreator:i,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.ariaOrderColumns=[]}joinColsAriaOrder(){const e=this.columnModel.getCols(),t=[],n=[],r=[];for(const i of e){const e=i.getPinned();e?!0===e||"left"===e?t.push(i):r.push(i):n.push(i)}this.ariaOrderColumns=t.concat(n).concat(r)}getAriaColIndex(e){let t;return t=XB(e)?e.getLeafColumns()[0]:e,this.ariaOrderColumns.indexOf(t)+1}getAllAutoHeightCols(){return this.autoHeightCols}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(e=>{if(XB(e)){e.checkLeft()}})})}setLeftValuesOfCols(e){if(!this.columnModel.getColDefCols())return;const t=this.columnModel.getCols().slice(0),n=this.gos.get("enableRtl");[this.columnsLeft,this.columnsRight,this.columnsCenter].forEach(r=>{if(n){let t=cB(r);r.forEach(n=>{t-=n.getActualWidth(),n.setLeft(t,e)})}else{let t=0;r.forEach(n=>{n.setLeft(t,e),t+=n.getActualWidth()})}!function(e,t){for(let n=0;n<t.length;n++)WV(e,t[n])}(t,r)}),t.forEach(t=>{t.setLeft(null,e)})}joinCols(){this.gos.get("enableRtl")?this.columns=this.columnsRight.concat(this.columnsCenter).concat(this.columnsLeft):this.columns=this.columnsLeft.concat(this.columnsCenter).concat(this.columnsRight)}getColsCenter(){return this.columnsCenter}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}getTreeLeft(){return this.treeLeft}getTreeRight(){return this.treeRight}getTreeCenter(){return this.treeCenter}getAllCols(){return this.columns}isColDisplayed(e){return this.getAllCols().indexOf(e)>=0}getLeftColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsLeft):this.columnsLeft}getRightColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsRight):this.columnsRight}getColsForRow(e,t,n,r){const i=[];let o=null;for(let s=0;s<t.length;s++){const a=t[s],l=t.length-s,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const e=c-1;for(let n=1;n<=e;n++)u.push(t[s+n]);s+=e}let d;if(n?(d=!1,u.forEach(e=>{n(e)&&(d=!0)})):d=!0,d){if(0===i.length&&o){!!r&&r(a)&&i.push(o)}i.push(a)}o=a}return i}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getCenterCols(){return this.columnsCenter}getLeftCols(){return this.columnsLeft}getRightCols(){return this.columnsRight}getColBefore(e){const t=this.getAllCols(),n=t.indexOf(e);return n>0?t[n-1]:null}getGroupAtDirection(e,t){const n=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),r=e.getDisplayedLeafColumns(),i="After"===t?VV(r):r[0],o=`getCol${t}`;for(;;){const t=this[o](i);if(!t)return null;const r=this.getColGroupAtLevel(t,n);if(r!==e)return r}}getColGroupAtLevel(e,t){let n,r,i=e.getParent();for(;;){if(n=i.getProvidedColumnGroup().getLevel(),r=i.getPaddingLevel(),n+r<=t)break;i=i.getParent()}return i}isPinningLeft(){return this.columnsLeft.length>0}isPinningRight(){return this.columnsRight.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=e=>{this.colsAndGroupsMap[e.getUniqueId()]=e};eW(this.treeCenter,!1,e),eW(this.treeLeft,!1,e),eW(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){eW(this.getAllTrees(),!1,e=>{XB(e)&&e.calculateDisplayedColumns()})}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["getLeftCols","getCenterCols","getRightCols"];e&&t.reverse();for(let n=0;n<t.length;n++){const r=this[t[n]]();if(r.length)return e?VV(r):r[0]}return null}getColumnGroup(e,t){if(!e)return null;if(XB(e))return e;const n=this.getAllTrees(),r="number"===typeof t;let i=null;return eW(n,!1,n=>{if(XB(n)){const o=n;let s;s=r?e===o.getGroupId()&&t===o.getPartId():e===o.getGroupId(),s&&(i=o)}}),i}getColAfter(e){const t=this.getAllCols(),n=t.indexOf(e);return n<t.length-1?t[n+1]:null}isBodyWidthDirty(){return this.bodyWidthDirty}setBodyWidthDirty(){this.bodyWidthDirty=!0}getColsLeftWidth(){return cB(this.columnsLeft)}getDisplayedColumnsRightWidth(){return cB(this.columnsRight)}isColAtEdge(e,t){const n=this.getAllCols();if(!n.length)return!1;const r="first"===t;let i;if(XB(e)){const t=e.getDisplayedLeafColumns();if(!t.length)return!1;i=r?t[0]:VV(t)}else i=e;return(r?n[0]:VV(n))===i}createGroups(e){const{columns:t,idCreator:n,pinned:r,oldDisplayedGroups:i,isStandaloneStructure:o}=e,s=this.mapOldGroupsById(i),a=[];let l=t;for(;l.length;){const e=l;l=[];let t=0;const i=i=>{const c=t;t=i;const u=e[c],d=(XB(u)?u.getProvidedColumnGroup():u).getOriginalParent();if(null==d){for(let t=c;t<i;t++)a.push(e[t]);return}const h=this.createColGroup(d,n,s,r,o);for(let t=c;t<i;t++)h.addChild(e[t]);l.push(h)};for(let n=1;n<e.length;n++){const r=e[n],o=(XB(r)?r.getProvidedColumnGroup():r).getOriginalParent(),s=e[t];o!==(XB(s)?s.getProvidedColumnGroup():s).getOriginalParent()&&i(n)}t<e.length&&i(e.length)}return o||this.setupParentsIntoCols(a,null),a}createColGroup(e,t,n,r,i){const o=e.getGroupId(),s=t.getInstanceIdForKey(o);let a=n[qB(o,s)];return a&&a.getProvidedColumnGroup()!==e&&(a=null),$H(a)?a.reset():(a=new QB(e,o,s,r),i||this.createBean(a)),a}mapOldGroupsById(e){const t={},n=e=>{e.forEach(e=>{if(XB(e)){const r=e;t[e.getUniqueId()]=r,n(r.getChildren())}})};return e&&n(e),t}setupParentsIntoCols(e,t){e.forEach(e=>{if(e.setParent(t),XB(e)){const t=e;this.setupParentsIntoCols(t.getChildren(),t)}})}};function eW(e,t,n){if(e)for(let r=0;r<e.length;r++){const i=e[r];if(XB(i)){eW(t?i.getDisplayedChildren():i.getChildren(),t,n)}n(i)}}function tW(e){const t=[];return eW(e,!0,e=>{TB(e)&&t.push(e)}),t}var nW=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel"],rW=[...nW,"scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged"],iW={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0},oW=class{};oW.STRING_PROPERTIES=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"],oW.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","theme","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","cellSelection","selectionColumnDef"],oW.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],oW.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],oW.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],oW.OTHER_PROPERTIES=["suppressStickyTotalRow","loadThemeGoogleFonts","rowSelection"],oW.FUNCTION_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"],oW.ALL_PROPERTIES=[...oW.ARRAY_PROPERTIES,...oW.OBJECT_PROPERTIES,...oW.STRING_PROPERTIES,...oW.NUMBER_PROPERTIES,...oW.FUNCTION_PROPERTIES,...oW.BOOLEAN_PROPERTIES,...oW.OTHER_PROPERTIES];var sW=oW,aW=class{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}};aW.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY",aW.PUBLIC_EVENTS=nW,aW.EVENT_CALLBACKS=rW.map(e=>aW.getCallbackForEvent(e)),aW.BOOLEAN_PROPERTIES=sW.BOOLEAN_PROPERTIES,aW.ALL_PROPERTIES=sW.ALL_PROPERTIES,aW.ALL_PROPERTIES_AND_CALLBACKS=[...aW.ALL_PROPERTIES,...aW.EVENT_CALLBACKS],aW.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(aW.ALL_PROPERTIES_AND_CALLBACKS);var lW=aW;var cW=class extends nB{};function uW(e,t,n){return n&&e.addDestroyFunc(()=>t.destroyBean(n)),n??e}var dW=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.addCssClass(e));if(!0!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach(e=>this.removeCssClass(e));if(!1!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const n=(e||"").split(" ");if(n.length>1)return void n.forEach(e=>this.addOrRemoveCssClass(e,t))}if(this.cssClassStates[e]!==t&&e.length){const n=this.getGui();n&&n.classList.toggle(e,t),this.cssClassStates[e]=t}}};function hW(e,t,n){null==n||"string"===typeof n&&""==n?gW(e,t):pW(e,t,n)}function pW(e,t,n){e.setAttribute(fW(t),n.toString())}function gW(e,t){e.removeAttribute(fW(t))}function fW(e){return`aria-${e}`}function mW(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function vW(e,t){hW(e,"label",t)}function wW(e,t){hW(e,"labelledby",t)}function bW(e,t){hW(e,"live",t)}function CW(e,t){hW(e,"hidden",t)}function yW(e,t){pW(e,"expanded",t)}function SW(e,t){pW(e,"rowcount",t)}function xW(e,t){pW(e,"rowindex",t)}function RW(e,t){pW(e,"colcount",t)}function EW(e,t){pW(e,"colindex",t)}function TW(e,t){pW(e,"sort",t)}function kW(e){gW(e,"sort")}function MW(e,t){hW(e,"selected",t)}function PW(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var IW="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function AW(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,n=t.call(e,"input, select, button, textarea"),r=t.call(e,IW),i=UW(e);return n&&!r&&i}function DW(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:r}=n;e.classList.toggle("ag-hidden",!t),r||CW(e,!t)}function FW(e,t){const n="disabled",r=t?e=>e.setAttribute(n,""):e=>e.removeAttribute(n);r(e),ez(e.querySelectorAll("input"),e=>r(e))}function OW(e,t,n){let r=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof n){if(++r>n)break}else if(e===n)break}return!1}function NW(e){const{height:t,width:n,borderTopWidth:r,borderRightWidth:i,borderBottomWidth:o,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(n||"0"),borderTopWidth:parseFloat(r||"0"),borderRightWidth:parseFloat(i||"0"),borderBottomWidth:parseFloat(o||"0"),borderLeftWidth:parseFloat(s||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(u||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:f}}function LW(e){const t=NW(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function _W(e){const t=NW(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function HW(e){const{height:t,marginBottom:n,marginTop:r}=NW(e);return Math.floor(t+n+r)}function VW(e){const{width:t,marginLeft:n,marginRight:r}=NW(e);return Math.floor(t+n+r)}function BW(e){const t=e.getBoundingClientRect(),{borderTopWidth:n,borderLeftWidth:r,borderRightWidth:i,borderBottomWidth:o}=NW(e);return{top:t.top+(n||0),left:t.left+(r||0),right:t.right+(i||0),bottom:t.bottom+(o||0)}}function WW(e,t){let n=e.scrollLeft;return t&&(n=Math.abs(n)),n}function zW(e,t,n){n&&(t*=-1),e.scrollLeft=t}function jW(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function GW(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function $W(e){return!!e.offsetParent}function UW(e){const t=e;if(t.checkVisibility)return t.checkVisibility({checkVisibilityCSS:!0});return!(!$W(e)||"visible"!==window.getComputedStyle(e).visibility)}function KW(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function YW(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):qW(e,t)}function qW(e,t){t=QW(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function XW(e,t){t=QW(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function QW(e){return"number"===typeof e?`${e}px`:e}function JW(e){return e instanceof Node||e instanceof HTMLElement}function ZW(e,t,n){null==n||""===n?e.removeAttribute(t):e.setAttribute(t,n.toString())}function ez(e,t){if(null!=e)for(let n=0;n<e.length;n++)t(e[n])}var tz,nz,rz,iz,oz,sz,az,lz,cz,uz=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}};function dz(){return void 0===tz&&(tz=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),tz}function hz(){if(void 0===nz)if(dz()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(nz=null!=e[1]?parseFloat(e[1]):0)}else nz=0;return nz}function pz(){return void 0===iz&&(iz=/(firefox)/i.test(navigator.userAgent)),iz}function gz(){return void 0===oz&&(oz=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),oz}function fz(){return void 0===sz&&(sz=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),sz}function mz(){return!dz()||hz()>=15}function vz(e){if(!e)return null;const t=e.tabIndex,n=e.getAttribute("tabIndex");return-1!==t||null!==n&&(""!==n||pz())?t.toString():null}function wz(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let n=t.offsetWidth-t.clientWidth;0===n&&0===t.clientWidth&&(n=null),t.parentNode&&t.parentNode.removeChild(t),null!=n&&(lz=n,az=0===n)}function bz(){return null==az&&wz(),az}var Cz=class e extends nB{constructor(e,t,n,r){super(),this.parentComp=e,this.tooltipShowDelayOverride=t,this.tooltipHideDelayOverride=n,this.shouldDisplayTooltip=r,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupService=e.popupService,this.userComponentFactory=e.userComponentFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.parentComp.getGui();0===this.tooltipTrigger&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),1===this.tooltipTrigger&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return t<0&&NH(`${e} should not be lower than 0`),Math.max(200,t)}getTooltipDelay(e){return"show"===e?this.tooltipShowDelayOverride??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipHideDelayOverride??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return e&&"hover"!==e?1:0}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),fz()||(e.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(t)},100):this.prepareToShowTooltip(t))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&2===this.state&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,n=this.parentComp.getGui(),r=this.tooltipComp?.getGui();this.isInteractingWithTooltip||n.contains(t)||this.interactionEnabled&&r?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(t){if(0!=this.state||e.isLocked)return;let n=0;t&&(n=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),n),this.state=1}isLastTooltipHiddenRecently(){return(new Date).getTime()-e.lastTooltipHideTime<1e3}setToDoNothing(e){e||2!==this.state||this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e={...this.parentComp.getTooltipParams()};if(!$H(e.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip())return void this.setToDoNothing();this.state=2,this.tooltipInstanceCount++;const t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}hideTooltip(t){!t&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),e.lastTooltipHideTime=(new Date).getTime()),this.eventService.dispatchEvent({type:"tooltipHide",parentGui:this.parentComp.getGui()}),t&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(2!==this.state||this.tooltipInstanceCount!==e)return void this.destroyBean(t);const n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),0===this.tooltipTrigger&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");const r=this.localeService.getLocaleTextFunc(),i=this.popupService.addPopup({eChild:n,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(i&&(this.tooltipPopupDestroyFunc=i.hideFunc),this.positionTooltip(),1===this.tooltipTrigger){const e=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:e,columnMoved:e})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(pV(this.gos),{keydown:e=>{n.contains(e?.target)||this.onKeyDown()}}),1===this.tooltipTrigger&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventService.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.parentComp.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=mV(this.gos);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.parentComp.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupService.positionPopupByComponent({...e,eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,n=0===this.tooltipTrigger?1e3:0;window.setTimeout(()=>{e(),this.destroyBean(t)},n),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(e=>{e&&e()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){e.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},100)}unlockService(){e.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};Cz.isLocked=!1;var yz=Cz,Sz=class extends nB{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}wireBeans(e){this.beans=e}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",n=this.ctrl.getGui();n&&(null!=e&&""!=e?n.setAttribute(t,e):n.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){if(null!=this.tooltipManager)return;const e={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new yz(e,this.ctrl.getTooltipShowDelayOverride?.(),this.ctrl.getTooltipHideDelayOverride?.(),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?.(),n=e.getColDef?.(),r=e.getRowNode?.();return{location:e.getLocation(),colDef:n,column:t,rowIndex:e.getRowIndex?.(),node:r,data:r?.data,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?.(),hideTooltipCallback:()=>this.tooltipManager?.hideTooltip(!0)}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},xz=new uz,Rz=null,Ez=class e extends nB{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=xz.next(),this.cssClassManager=new dW(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(e=>[e.selector,e])),e&&this.setTemplate(e)}preWireBeans(e){super.preWireBeans(e)}preConstruct(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips"),this.wireTemplate(this.getGui())}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const{newTooltipText:t,showDelayOverride:n,hideDelayOverride:r,location:i,shouldDisplayTooltip:o}=e||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==t&&(this.tooltipText=t);const s=()=>this.tooltipText;null!=t&&(this.tooltipFeature=this.createBean(new Sz({getTooltipValue:s,getGui:()=>this.getGui(),getLocation:()=>i??"UNKNOWN",getColDef:e?.getColDef,getColumn:e?.getColumn,getTooltipShowDelayOverride:null!=n?()=>n:void 0,getTooltipHideDelayOverride:null!=r?()=>r:void 0,shouldDisplayTooltip:o})))}getDataRefAttribute(e){return e.getAttribute?e.getAttribute("data-ref"):null}applyElementsToComponent(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===t&&(t=this.getDataRefAttribute(e)),t){const i=this[t];if(i===Rz)this[t]=r??e;else{const e=n&&n[t];this.suppressDataRefValidation||e||NH(`Issue with data-ref: ${t} on ${this.constructor.name} with ${i}`)}}}createChildComponentsFromTags(e,t){const n=function(e){if(null==e)return[];const t=[];return ez(e,e=>t.push(e)),t}(e.childNodes);n.forEach(n=>{if(!(n instanceof HTMLElement))return;const r=this.createComponentFromElement(n,e=>{e.getGui()&&this.copyAttributesFromNode(n,e.getGui())},t);if(r){if(r.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);const e=Array.prototype.slice.call(n.children);r.addItems(e)}this.swapComponentForNode(r,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)})}createComponentFromElement(t,n,r){const i=t.nodeName,o=this.getDataRefAttribute(t),s=0===i.indexOf("AG-"),a=s?this.componentSelectors.get(i):null;let l=null;if(a){e.elementGettingCreated=t;const i=r&&o?r[o]:void 0;l=new a.component(i),l.setParentComponent(this),this.createBean(l,null,n)}else s&&NH(`Missing selector: ${i}`);return this.applyElementsToComponent(t,o,r,l),l}copyAttributesFromNode(e,t){!function(e,t){if(e)for(let n=0;n<e.length;n++){const r=e[n];t(r.name,r.value)}}(e.attributes,(e,n)=>t.setAttribute(e,n))}swapComponentForNode(e,t,n){const r=e.getGui();t.replaceChild(r,n),t.insertBefore(document.createComment(n.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach(e=>e.setAttribute("tabindex",t.toString()))}setTemplate(e,t,n){const r=KW(e);this.setTemplateFromElement(r,t,n)}setTemplateFromElement(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.eGui=e,this.suppressDataRefValidation=r,t)for(let i=0;i<t.length;i++){const e=t[i];this.componentSelectors.set(e.selector,e)}this.wireTemplate(e,n)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let n=t;return null==e?null:(n||(n=this.eGui),JW(e)?{element:e,parent:n}:{element:e.getGui(),parent:n})}prependChild(e,t){const{element:n,parent:r}=this.getContainerAndElement(e,t)||{};n&&r&&r.insertAdjacentElement("afterbegin",n)}appendChild(e,t){const{element:n,parent:r}=this.getContainerAndElement(e,t)||{};n&&r&&r.appendChild(n)}isDisplayed(){return this.displayed}setVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.visible){this.visible=e;const{skipAriaHidden:n}=t;!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:r}=n;e.classList.toggle("ag-invisible",!t),r||CW(e,!t)}(this.eGui,e,{skipAriaHidden:n})}}setDisplayed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:n}=t;DW(this.eGui,e,{skipAriaHidden:n});const r={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(r)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}addGuiEventListener(e,t,n){this.eGui.addEventListener(e,t,n),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}},Tz={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",checkboxChecked:"checkbox-checked",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off"},kz=(()=>{const e=new Set(Object.values(Tz));return e.add("eye"),e})();function Mz(e,t,n,r){let i=null;const o=n&&n.getColDef().icons;if(o&&(i=o[e]),t&&!i){const n=t.get("icons");n&&(i=n[e])}if(!i){const t=document.createElement("span");let n=Tz[e]??(kz.has(e)?e:void 0);return n||(r?n=e:(NH(`Did not find icon ${e}`),n="")),t.setAttribute("class",`ag-icon ag-icon-${n}`),t.setAttribute("unselectable","on"),mW(t,"presentation"),t}{let e;if("function"===typeof i)e=i();else{if("string"!==typeof i)throw new Error("icon from grid options needs to be a string or a function");e=i}if("string"===typeof e)return KW(e);if(JW(e))return e;NH("iconRenderer should return back a string or a dom object")}}var Pz=class extends Ez{constructor(){super(...arguments),this.dragSource=null,this.eIcon=Rz,this.eLabel=Rz}postConstruct(){const e=e=>function(e,t,n){const r=Mz(e,t,n);if(r){const{className:e}=r;if("string"===typeof e&&e.indexOf("ag-icon")>-1||"object"===typeof e&&e["ag-icon"])return r}const i=document.createElement("span");return i.appendChild(r),i}(e,this.gos,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate('<div class="ag-dnd-ghost ag-unselectable">\n                <span data-ref="eIcon" class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n                <div data-ref="eLabel" class="ag-dnd-ghost-label"></div>\n            </div>')}destroy(){this.dragSource=null,super.destroy()}setIcon(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];jW(this.eIcon);let n=null;e||(e=this.dragSource?.getDefaultIconName?this.dragSource?.getDefaultIconName():"notAllowed"),n=this.dropIconMap[e],this.eIcon.classList.toggle("ag-shake-left-to-right",t),n===this.dropIconMap.hide&&this.gos.get("suppressDragLeaveHidesColumns")||n&&this.eIcon.appendChild(n)}setLabel(e){this.eLabel.textContent=$B(e)}};function Iz(e,t,n){if(0===n)return!1;const r=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(r,i)<=n}var Az=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new IH,this.eElement=e,this.preventMouseClick=t;const n=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),i=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",n,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",i,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",n,{passive:!0}),this.eElement.removeEventListener("touchmove",r,{passive:!0}),this.eElement.removeEventListener("touchend",i,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout(()=>{const n=this.touchStart===t;if(this.touching&&n&&!this.moved){this.moved=!0;const t={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(t)}},500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!Iz(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const e={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}};function Dz(e,t){return`<span data-ref="eSort${e}" class="ag-sort-indicator-icon ag-sort-${t} ag-hidden" aria-hidden="true"></span>`}var Fz=`<span class="ag-sort-indicator-container">\n        ${Dz("Order","order")}\n        ${Dz("Asc","ascending-icon")}\n        ${Dz("Desc","descending-icon")}\n        ${Dz("Mixed","mixed-icon")}\n        ${Dz("None","none-icon")}\n    </span>`,Oz=class extends Ez{constructor(e){super(),this.eSortOrder=Rz,this.eSortAsc=Rz,this.eSortDesc=Rz,this.eSortMixed=Rz,this.eSortNone=Rz,e||this.setTemplate(Fz)}wireBeans(e){this.sortController=e.sortController}attachCustomElements(e,t,n,r,i){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=n,this.eSortMixed=r,this.eSortNone=i}setupSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!this.column.isSortable()&&!this.column.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const n=this.updateIcons.bind(this),r=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",n),this.addManagedEventListeners({newColumnsLoaded:n,sortChanged:r,columnRowGroupChanged:r}),this.onSortChanged()}addInIcon(e,t,n){if(null==t)return;const r=Mz(e,this.gos,n);r&&t.appendChild(r)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const t="asc"===e;DW(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){const t="desc"===e;DW(this.eSortDesc,t,{skipAriaHidden:!0})}if(this.eSortNone){const t=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),n=null===e||void 0===e;DW(this.eSortNone,!t&&n,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;CV(this.gos)&&e&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);DW(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){if(!this.eSortOrder)return;const e=this.sortController.getColumnsWithSortingOrdered(),t=this.sortController.getDisplaySortIndexForColumn(this.column)??-1,n=e.some(e=>this.sortController.getDisplaySortIndexForColumn(e)??!1),r=t>=0&&n;DW(this.eSortOrder,r,{skipAriaHidden:!0}),t>=0?this.eSortOrder.textContent=(t+1).toString():jW(this.eSortOrder)}},Nz={selector:"AG-SORT-INDICATOR",component:Oz},Lz=class extends Ez{constructor(){super(...arguments),this.eFilter=Rz,this.eFilterButton=Rz,this.eSortIndicator=Rz,this.eMenu=Rz,this.eLabel=Rz,this.eText=Rz,this.eSortOrder=Rz,this.eSortAsc=Rz,this.eSortDesc=Rz,this.eSortMixed=Rz,this.eSortNone=Rz,this.lastMovingChanged=0}wireBeans(e){this.sortController=e.sortController,this.menuService=e.menuService,this.funcColsService=e.funcColsService}destroy(){super.destroy()}refresh(e){const t=this.params;return this.params=e,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&this.shouldSuppressMenuHide()==this.currentSuppressMenuHide&&t.enableFilterButton==e.enableFilterButton&&t.enableFilterIcon==e.enableFilterIcon&&(this.setDisplayName(e),!0)}workOutTemplate(){let e=this.params.template??'<div class="ag-cell-label-container" role="presentation">\n        <span data-ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n        <span data-ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>\n        <div data-ref="eLabel" class="ag-header-cell-label" role="presentation">\n            <span data-ref="eText" class="ag-header-cell-text"></span>\n            <span data-ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n            <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>\n        </div>\n    </div>';return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate,[Nz]),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const t=$B(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=t)}}addInIcon(e,t,n){if(null==t)return;const r=Mz(e,this.gos,n);r&&t.appendChild(r)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const t=new Az(this.getGui(),!0),n=this.shouldSuppressMenuHide(),r=n&&$H(this.eMenu),i=r?new Az(this.eMenu,!0):t;if(this.params.enableMenu){const e=r?"tap":"longTap",t=e=>this.params.showColumnMenuAfterMouseClick(e.touchStart);this.addManagedListeners(i,{[e]:t})}if(this.params.enableSorting){const e=e=>{const t=e.touchStart.target;n&&(this.eMenu?.contains(t)||this.eFilterButton?.contains(t))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListeners(t,{tap:e})}if(this.params.enableFilterButton){const e=new Az(this.eFilterButton,!0);this.addManagedListeners(e,{tap:()=>this.params.showFilter(this.eFilterButton)}),this.addDestroyFunc(()=>e.destroy())}this.addDestroyFunc(()=>t.destroy()),r&&this.addDestroyFunc(()=>i.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return GW(this.eMenu),void(this.eMenu=void 0);const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedElementListeners(this.eMenu,{click:()=>this.params.showColumnMenu(this.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){const t=this.params.column,n=this.menuService.isLegacyMenuEnabled();if(e&&!n){if(this.menuService.isFilterMenuInHeaderEnabled(t))return this.params.showFilter(this.eFilterButton??this.eMenu??this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu(this.eMenu??this.eFilterButton??this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.createBean(new Oz(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListeners(this.params.column,{movingChanged:()=>{this.lastMovingChanged=(new Date).getTime()}}),this.eLabel&&this.addManagedElementListeners(this.eLabel,{click:e=>{const t=this.params.column.isMoving(),n=(new Date).getTime()-this.lastMovingChanged<50;if(!(t||n)){const t="ctrl"===this.gos.get("multiSortKey")?e.ctrlKey||e.metaKey:e.shiftKey;this.params.progressSort(t)}}});const e=()=>{const e=this.params.column.getSort();if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc","asc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-desc","desc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-none",!e),this.params.column.getColDef().showRowGroup){const e=this.funcColsService.getSourceColumnsForGroupColumn(this.params.column),t=e?.every(e=>this.params.column.getSort()==e.getSort()),n=!t;this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",n)}};this.addManagedEventListeners({sortChanged:e,columnRowGroupChanged:e})}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedElementListeners(this.eFilterButton,{click:()=>this.params.showFilter(this.eFilterButton)}):this.eFilterButton=void 0}configureFilter(e,t,n){if(!e)return GW(t),!1;const r=this.params.column;return this.addInIcon("filter",t,r),this.addManagedListeners(r,{filterChanged:n}),n(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();DW(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){return e?this.eFilterButton??this.eMenu??this.getGui():this.eMenu??this.eFilterButton??this.getGui()}},_z=class extends Ez{constructor(){super('<div class="ag-header-group-cell-label" role="presentation">\n            <span data-ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span data-ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span data-ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>'),this.agOpened=Rz,this.agClosed=Rz,this.agLabel=Rz}wireBeans(e){this.columnModel=e.columnModel}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&NH("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened",this.agOpened),this.addInIcon("columnGroupClosed",this.agClosed);const e=e=>{if(JV(e))return;const t=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(this.agClosed,e),this.addTouchAndClickListeners(this.agOpened,e);const t=e=>{QV(e)};this.addManagedElementListeners(this.agClosed,{dblclick:t}),this.addManagedElementListeners(this.agOpened,{dblclick:t}),this.addManagedElementListeners(this.getGui(),{dblclick:e}),this.updateIconVisibility();const n=this.params.columnGroup.getProvidedColumnGroup(),r=this.updateIconVisibility.bind(this);this.addManagedListeners(n,{expandedChanged:r,expandableChanged:r})}addTouchAndClickListeners(e,t){const n=new Az(e,!0);this.addManagedListeners(n,{tap:t}),this.addDestroyFunc(()=>n.destroy()),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const e=this.params.columnGroup.isExpanded();DW(this.agOpened,e),DW(this.agClosed,!e)}else DW(this.agOpened,!1),DW(this.agClosed,!1)}addInIcon(e,t){const n=Mz(e,this.gos,null);n&&t.appendChild(n)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return DW(this.agOpened,!1),void DW(this.agClosed,!1)}setupLabel(){const{displayName:e,columnGroup:t}=this.params;if($H(e)){const t=$B(e,!0);this.agLabel.textContent=t}this.addOrRemoveCssClass("ag-sticky-label",!t.getColGroupDef()?.suppressStickyLabel)}},Hz=class extends Ez{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const n=document.createElement("span");n.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(n),this.setTemplateFromElement(e)}wireBeans(e){this.filterManager=e.filterManager}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const n=Math.abs(t),r=e.formatValue(n),i=$H(r)?r:n,o=t>=0;this.eDelta.textContent=o?"\u2191"+i:"\u2193"+i,this.eDelta.classList.toggle("ag-value-change-delta-up",o),this.eDelta.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),jW(this.eDelta)}refresh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.value;if(n===this.lastValue)return!1;if($H(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:$H(e.value)?this.eValue.textContent=n:jW(this.eValue),this.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof n&&"number"===typeof this.lastValue){const t=n-this.lastValue;this.showDelta(e,t)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=n,!0}},Vz=class extends Ez{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}wireBeans(e){this.filterManager=e.filterManager}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.value;return UH(n)&&(n=""),n!==this.lastValue&&(!this.filterManager?.isSuppressFlashingCellsBecauseFiltering()&&(t||this.addSlideAnimation(),this.lastValue=n,$H(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:$H(e.value)?this.eCurrent.textContent=n:jW(this.eCurrent),!0))}},Bz=class{};Bz.BACKSPACE="Backspace",Bz.TAB="Tab",Bz.ENTER="Enter",Bz.ESCAPE="Escape",Bz.SPACE=" ",Bz.LEFT="ArrowLeft",Bz.UP="ArrowUp",Bz.RIGHT="ArrowRight",Bz.DOWN="ArrowDown",Bz.DELETE="Delete",Bz.F2="F2",Bz.PAGE_UP="PageUp",Bz.PAGE_DOWN="PageDown",Bz.PAGE_HOME="Home",Bz.PAGE_END="End",Bz.A="KeyA",Bz.C="KeyC",Bz.D="KeyD",Bz.V="KeyV",Bz.X="KeyX",Bz.Y="KeyY",Bz.Z="KeyZ";var Wz=class extends Ez{constructor(e,t,n){super(t,n),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:n,labelAlignment:r,disabled:i}=this.config;null!=i&&this.setDisabled(i),null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=n&&this.setLabelWidth(n),this.setLabelAlignment(r||this.labelAlignment),this.refreshLabel()}refreshLabel(){jW(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(DW(this.eLabel,!1),mW(this.eLabel,"presentation")):(DW(this.eLabel,!0),mW(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||YW(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return FW(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},zz=class extends Wz{constructor(e,t,n,r){super(e,t,n),this.className=r}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:n}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),null!=n&&this.onValueChange(n),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),n=this.getLabel();null==n||""==n||null!==e.getAttribute("aria-label")?wW(e,""):wW(e,t??"")}setAriaLabel(e){return vW(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return qW(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}},jz=class extends zz{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";super(e,e?.template??`\n            <div role="presentation">\n                <div data-ref="eLabel" class="ag-input-field-label"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${r} data-ref="eInput" class="ag-input-field-input"></${r}>\n                </div>\n            </div>`,[],t),this.inputType=n,this.displayFieldTag=r,this.eLabel=Rz,this.eWrapper=Rz,this.eInput=Rz}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;null!=e&&this.setInputName(e),null!=t&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return YW(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return ZW(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return vW(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return FW(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(!0===e)ZW(this.eInput,"autocomplete",null);else{const t="string"===typeof e?e:"off";ZW(this.eInput,"autocomplete",t)}return this}},Gz=class extends jz{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-checkbox",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox"),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;"boolean"===typeof e&&this.setReadOnly(e),"boolean"===typeof t&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,n){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:n});const r=this.getInputElement();this.eventService.dispatchEvent({type:"checkboxChanged",id:r.id,name:r.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),n=this.selected=e.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}},$z={selector:"AG-CHECKBOX",component:Gz},Uz=class extends Ez{constructor(){super('\n            <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[$z]),this.eCheckbox=Rz}init(e){this.refresh(e);const t=this.eCheckbox.getInputElement();t.setAttribute("tabindex","-1"),bW(t,"polite"),this.addManagedListeners(t,{click:e=>{if(QV(e),this.eCheckbox.isDisabled())return;const t=this.eCheckbox.getValue();this.onCheckboxChanged(t)},dblclick:e=>{QV(e)}}),this.addManagedElementListeners(this.params.eGridCell,{keydown:e=>{if(e.key===Bz.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===mV(this.gos)&&this.eCheckbox.toggle();const t=this.eCheckbox.getValue();this.onCheckboxChanged(t),e.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,n=!0;if(e.node.group&&e.column)if("boolean"===typeof e.value)t=e.value;else{const r=e.column.getColId();r.startsWith(aB)?t=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[r]?t=e.value??void 0:n=!1}else t=e.value??void 0;if(!n)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(t);const r=null!=e.disabled?e.disabled:!e.column?.isCellEditable(e.node);this.eCheckbox.setDisabled(r);const i=this.localeService.getLocaleTextFunc(),o=PW(i,t),s=r?o:`${i("ariaToggleCellValue","Press SPACE to toggle cell value")} (${o})`;this.eCheckbox.setInputAriaLabel(s)}onCheckboxChanged(e){const{column:t,node:n,value:r}=this.params;this.eventService.dispatchEvent({type:"cellEditingStarted",column:t,colDef:t?.getColDef(),data:n.data,node:n,rowIndex:n.rowIndex,rowPinned:n.rowPinned,value:r});const i=this.params.node.setDataValue(this.params.column,e,"edit");this.eventService.dispatchEvent({type:"cellEditingStopped",column:t,colDef:t?.getColDef(),data:n.data,node:n,rowIndex:n.rowIndex,rowPinned:n.rowPinned,value:r,oldValue:r,newValue:e,valueChanged:i}),i||this.updateCheckbox(this.params)}},Kz=class extends Ez{constructor(){super('<div class="ag-loading">\n            <span class="ag-loading-icon" data-ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" data-ref="eLoadingText"></span>\n        </div>'),this.eLoadingIcon=Rz,this.eLoadingText=Rz}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=Mz("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}},Yz=class extends Ez{constructor(){super('<div class="ag-skeleton-container"></div>')}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>wW(e.eParentOfValue)),wW(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");vW(this.getGui(),t)}setupLoading(e){const t=pV(this.gos).createElement("div");t.classList.add("ag-skeleton-effect");const n=e.node.rowIndex;if(null!=n){const e=75+25*(n%2===0?Math.sin(n):Math.cos(n));t.style.width=`${e}%`}this.getGui().appendChild(t);const r=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");vW(this.getGui(),r)}refresh(e){return!1}destroy(){super.destroy()}},qz=class extends Ez{constructor(){super()}destroy(){super.destroy()}},Xz=class extends qz{init(){const e=GH(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??'<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>'),!e){const e=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=e("loadingOoo","Loading...")})}}},Qz=class extends qz{init(){const e=GH(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??'<span class="ag-overlay-no-rows-center"></span>'),!e){const e=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=e("noRowsToShow","No Rows To Show")})}}},Jz=class extends Ez{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Zz=class extends Jz{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=$B(t,!0)}};function ej(e){const{inputValue:t,allSuggestions:n,hideIrrelevant:r,filterByPercentageOfBestMatch:i,addSequentialWeight:o}=e;let s=n.map((e,n)=>({value:e,relevance:tj(t.toLowerCase(),e.toLocaleLowerCase(),o),idx:n}));if(s.sort((e,t)=>t.relevance-e.relevance),r&&(s=s.filter(e=>0!==e.relevance)),s.length>0&&i&&i>0){const e=s[0].relevance*i;s=s.filter(t=>e-t.relevance<0)}const a=[],l=[];for(const c of s)a.push(c.value),l.push(c.idx);return{values:a,indices:l}}function tj(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.replace(/\s/g,""),i=t.replace(/\s/g,""),o=r.length,s=i.length,a=new Array(o+1).fill(null).map(()=>new Array(s+1).fill(0));for(let u=0;u<=o;u+=1)a[u][0]=u;for(let u=0;u<=s;u+=1)a[0][u]=u;for(let u=1;u<=o;u++)for(let e=1;e<=s;e++)r[u-1]===i[e-1]?a[u][e]=a[u-1][e-1]:a[u][e]=1+Math.min(a[u][e-1],Math.min(a[u-1][e],a[u-1][e-1]));const l=a[o][s];let c=Math.max(o,s)-l;if(n){const e=function(e){const t=[],n=e.length;for(let r=1;r<=n;r++)for(let i=0;i<=n-r;i++){const n=i+r-1;t.push(e.slice(i,n+1))}return t}(r);for(let t=0;t<e.length;t++){const n=e[t];-1!==i.indexOf(n)&&(c+=1,c*=n.length)}}return c}var nj=class extends nB{constructor(){super(...arguments),this.beanName="userComponentRegistry",this.agGridDefaults={agDragAndDropImage:Pz,agColumnHeader:Lz,agColumnGroupHeader:_z,agSortIndicator:Oz,agAnimateShowChangeCellRenderer:Hz,agAnimateSlideCellRenderer:Vz,agLoadingCellRenderer:Kz,agSkeletonCellRenderer:Yz,agCheckboxCellRenderer:Uz,agLoadingOverlay:Xz,agNoRowsOverlay:Qz,agTooltipComponent:Zz},this.agGridDefaultParams={},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agGroupCellRenderer:"@ag-grid-enterprise/row-grouping",agGroupRowRenderer:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}postConstruct(){const e=this.gos.get("components");null!=e&&mB(e,(e,t)=>this.registerJsComponent(e,t))}registerDefaultComponent(e,t,n){this.agGridDefaults[e]=t,n&&(this.agGridDefaultParams[e]=n)}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const n=(e,t,n)=>({componentFromFramework:t,component:e,params:n}),r=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(null!=r)return n(r,!0);const i=this.jsComps[t];if(i){return n(i,this.getFrameworkOverrides().isFrameworkComponent(i))}const o=this.agGridDefaults[t];if(o)return n(o,!1,this.agGridDefaultParams[t]);const s=this.enterpriseAgDefaultCompsModule[t];return s?this.gos.assertModuleRegistered(s,`AG Grid '${e}' component: ${t}`):FH(()=>{this.warnAboutMissingComponent(e,t)},"MissingComp"+t),null}warnAboutMissingComponent(e,t){const n=ej({inputValue:t,allSuggestions:[...Object.keys(this.agGridDefaults).filter(e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e)),...Object.keys(this.jsComps)],hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;NH(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),n.length>0&&NH(`         Did you mean: [${n.slice(0,3)}]?`),NH(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}},rj=class e{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e(e=>this.onDone(e),e=>this.onReject(e))}static all(t){return t.length?new e(e=>{let n=t.length;const r=new Array(n);t.forEach((t,i)=>{t.then(t=>{r[i]=t,n--,0===n&&e(r)})})}):e.resolve()}static resolve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e(e=>e(t))}then(t){return new e(e=>{1===this.status?e(t(this.resolution)):this.waiters.push(n=>e(t(n)))})}onDone(e){this.status=1,this.resolution=e,this.waiters.forEach(t=>t(e))}onReject(e){}},ij={propertyName:"dateComponent",cellRenderer:!1},oj={propertyName:"dragAndDropImageComponent",cellRenderer:!1},sj={propertyName:"headerComponent",cellRenderer:!1},aj={propertyName:"headerGroupComponent",cellRenderer:!1},lj={propertyName:"cellRenderer",cellRenderer:!0},cj={propertyName:"cellRenderer",cellRenderer:!1},uj={propertyName:"loadingCellRenderer",cellRenderer:!0},dj={propertyName:"cellEditor",cellRenderer:!1},hj={propertyName:"innerRenderer",cellRenderer:!0},pj={propertyName:"loadingOverlayComponent",cellRenderer:!1},gj={propertyName:"noRowsOverlayComponent",cellRenderer:!1},fj={propertyName:"tooltipComponent",cellRenderer:!1},mj={propertyName:"filter",cellRenderer:!1},vj={propertyName:"floatingFilterComponent",cellRenderer:!1},wj={propertyName:"toolPanel",cellRenderer:!1},bj={propertyName:"statusPanel",cellRenderer:!1},Cj={propertyName:"fullWidthCellRenderer",cellRenderer:!0},yj={propertyName:"loadingCellRenderer",cellRenderer:!0},Sj={propertyName:"groupRowRenderer",cellRenderer:!0},xj={propertyName:"detailCellRenderer",cellRenderer:!0},Rj={propertyName:"menuItem",cellRenderer:!1},Ej=class e extends nB{constructor(){super(...arguments),this.beanName="userComponentFactory"}wireBeans(e){this.agComponentUtils=e.agComponentUtils,this.componentMetadataProvider=e.componentMetadataProvider,this.userComponentRegistry=e.userComponentRegistry,this.frameworkComponentWrapper=e.frameworkComponentWrapper,this.gridOptions=e.gridOptions}getDragAndDropImageCompDetails(e){return this.getCompDetails(this.gridOptions,oj,"agDragAndDropImage",e,!0)}getHeaderCompDetails(e,t){return this.getCompDetails(e,sj,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,aj,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Cj,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,yj,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,Sj,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,xj,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,hj,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,hj,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,lj,null,t)}getEditorRendererDetails(e,t){return this.getCompDetails(e,cj,null,t)}getLoadingCellRendererDetails(e,t){return this.getCompDetails(e,uj,"agSkeletonCellRenderer",t,!0)}getCellEditorDetails(e,t){return this.getCompDetails(e,dj,"agCellEditor",t,!0)}getFilterDetails(e,t,n){return this.getCompDetails(e,mj,n,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,ij,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,pj,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,gj,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,fj,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,lj,null,t)}getFloatingFilterCompDetails(e,t,n){return this.getCompDetails(e,vj,n,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,wj,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,bj,null,t,!0)}getMenuItemCompDetails(e,t){return this.getCompDetails(e,Rj,"agMenuItem",t,!0)}getCompDetails(t,n,r,i){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{propertyName:s,cellRenderer:a}=n;let l,{compName:c,jsComp:u,fwComp:d,paramsFromSelector:h,popupFromSelector:p,popupPositionFromSelector:g}=e.getCompKeys(this.frameworkOverrides,t,n,i);const f=e=>{const t=this.userComponentRegistry.retrieve(s,e);t&&(u=t.componentFromFramework?void 0:t.component,d=t.componentFromFramework?t.component:void 0,l=t.params)};if(null!=c&&f(c),null==u&&null==d&&null!=r&&f(r),u&&a&&!this.agComponentUtils.doesImplementIComponent(u)&&(u=this.agComponentUtils.adaptFunction(s,u)),!u&&!d)return void(o&&LH(`Could not find component ${c}, did you forget to configure this component?`));const m=this.mergeParamsWithApplicationProvidedParams(t,n,i,h,l),v=null==u,w=u||d;return{componentFromFramework:v,componentClass:w,params:m,type:n,popupFromSelector:p,popupPositionFromSelector:g,newAgStackInstance:()=>this.newAgStackInstance(w,v,m,n)}}static getCompKeys(e,t,n,r){const{propertyName:i}=n;let o,s,a,l,c,u;if(t){const n=t,d=n[i+"Selector"],h=d?d(r):null,p=t=>{if("string"===typeof t)o=t;else if(null!=t&&!0!==t){e.isFrameworkComponent(t)?a=t:s=t}};h?(p(h.component),l=h.params,c=h.popup,u=h.popupPosition):p(n[i])}return{compName:o,jsComp:s,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}newAgStackInstance(e,t,n,r){const i=r.propertyName;let o;if(!t)o=new e;else{const t=this.componentMetadataProvider.retrieve(i);o=this.frameworkComponentWrapper.wrap(e,t.mandatoryMethodList,t.optionalMethodList,r)}const s=this.initComponent(o,n);return null==s?rj.resolve(o):s.then(()=>o)}mergeParamsWithApplicationProvidedParams(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4?arguments[4]:void 0;const o=this.gos.getGridCommonParams();CB(o,n),i&&CB(o,i);const s=e&&e[t.propertyName+"Params"];if("function"===typeof s){CB(o,s(n))}else"object"===typeof s&&CB(o,s);return CB(o,r),o}initComponent(e,t){if(this.createBean(e),null!=e.init)return e.init(t)}};function Tj(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var kj=class e{static register(t){e.__register(t,!0,void 0)}static registerModules(t){e.__registerModules(t,!0,void 0)}static __register(t,n,r){e.runVersionChecks(t),void 0!==r?(e.areGridScopedModules=!0,void 0===e.gridModulesMap[r]&&(e.gridModulesMap[r]={}),e.gridModulesMap[r][t.moduleName]=t):e.globalModulesMap[t.moduleName]=t,e.setModuleBased(n)}static __unRegisterGridModules(t){delete e.gridModulesMap[t]}static __registerModules(t,n,r){e.setModuleBased(n),t&&t.forEach(t=>e.__register(t,n,r))}static isValidModuleVersion(t){const[n,r]=t.version.split(".")||[],[i,o]=e.currentModuleVersion.split(".")||[];return n===i&&r===o}static runVersionChecks(t){e.currentModuleVersion||(e.currentModuleVersion=t.version);const n=e=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${e} Please update all modules to the same version.`;if(t.version?e.isValidModuleVersion(t)||LH(n(`'${t.moduleName}' is version ${t.version} but the other modules are version ${e.currentModuleVersion}.`)):LH(n(`'${t.moduleName}' is incompatible.`)),t.validate){const e=t.validate();if(!e.isValid){LH(`${e.message}`)}}}static setModuleBased(t){void 0===e.moduleBased?e.moduleBased=t:e.moduleBased!==t&&(LH("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),LH("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information."))}static __setIsBundled(){e.isBundled=!0}static __assertRegistered(t,n,r){if(this.__isRegistered(t,r))return!0;let i;if(e.isBundled)i=`AG Grid: unable to use ${n} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(e.moduleBased||void 0===e.moduleBased){const o=Object.entries(AH).find(e=>{let[n,r]=e;return r===t})?.[0];i=`AG Grid: unable to use ${n} as the ${o} is not registered${e.areGridScopedModules?` for gridId: ${r}`:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${o} } from '${t}';\n    \n    ModuleRegistry.registerModules([ ${o} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else i=`AG Grid: unable to use ${n} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';`;return LH(i),!1}static __isRegistered(t,n){return!!e.globalModulesMap[t]||!!e.gridModulesMap[n]?.[t]}static __getRegisteredModules(t){return[...eV(e.globalModulesMap),...eV(e.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){return eV(e.gridModulesMap[t]??{})||[]}static __isPackageBased(){return!e.moduleBased}};kj.globalModulesMap={},kj.gridModulesMap={},kj.areGridScopedModules=!1;var Mj=kj,Pj=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,e&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){Object.entries(e.providedBeanInstances).forEach(e=>{let[t,n]=e;this.beans[t]=n}),e.beanClasses.forEach(e=>{const t=new e;t.beanName?this.beans[t.beanName]=t:console.error(`Bean ${e.name} is missing beanName`),this.createdBeans.push(t)}),e.derivedBeans?.forEach(e=>{const{beanName:t,bean:n}=e(this);this.beans[t]=n,this.createdBeans.push(n)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.initBeans([e],t),e}initBeans(e,t){e.forEach(e=>{e.preWireBeans?.(this.beans),e.wireBeans?.(this.beans)}),e.forEach(e=>e.preConstruct?.()),t&&e.forEach(t),e.forEach(e=>e.postConstruct?.())}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},Ij=class extends Pj{init(e){this.gridId=e.gridId,this.beans.context=this,super.init(e)}destroy(){super.destroy(),Mj.__unRegisterGridModules(this.gridId)}getGridId(){return this.gridId}},Aj=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(Aj||{}),Dj=class extends nB{constructor(){super(...arguments),this.beanName="dragAndDropService",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.dragService=e.dragService,this.mouseEventService=e.mouseEventService,this.environment=e.environment,this.userComponentFactory=e.userComponentFactory}addDragSource(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:n,dragSource:e}),this.dragService.addDragSource(n)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return e&&e.comp?e.comp:null}removeDragSource(e){const t=this.dragSourceAndParamsList.find(t=>t.dragSource===e);t&&(this.dragService.removeDragSource(t.params),zV(this.dragSourceAndParamsList,t))}destroy(){this.dragSourceAndParamsList.forEach(e=>this.dragService.removeDragSource(e.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.dragSource.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){if(this.dragSource?.onDragStopped?.(),this.lastDropTarget?.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.clearDragAndDropProperties()}onDragCancel(){this.dragSource?.onDragCancelled?.(),this.lastDropTarget?.onDragCancel&&this.lastDropTarget.onDragCancel(this.createDropTargetEvent(this.lastDropTarget,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getHorizontalDirection(e),r=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const i=this.dropTargets.filter(t=>this.isMouseOnDropTarget(e,t)),o=this.findCurrentDropTarget(e,i);if(o!==this.lastDropTarget){if(this.leaveLastTargetIfExists(e,n,r,t),null!==this.lastDropTarget&&null===o&&this.dragSource?.onGridExit?.(this.dragItem),null===this.lastDropTarget&&null!==o&&this.dragSource?.onGridEnter?.(this.dragItem),this.enterDragTargetIfExists(o,e,n,r,t),o&&this.dragAndDropImageComp){const{comp:e,promise:t}=this.dragAndDropImageComp;e?e.setIcon(o.getIconName?o.getIconName():null):t.then(e=>{e&&e.setIcon(o.getIconName?o.getIconName():null)})}this.lastDropTarget=o}else if(o&&o.onDragging){const i=this.createDropTargetEvent(o,e,n,r,t);o.onDragging(i)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,n=[[e.getContainer()]];return t?n.concat(t):n}allContainersIntersect(e,t){for(const n of t){const{width:t,height:r,left:i,right:o,top:s,bottom:a}=n.getBoundingClientRect();if(0===t||0===r)return!1;const l=e.clientX>=i&&e.clientX<o,c=e.clientY>=s&&e.clientY<a;if(!l||!c)return!1}return!0}isMouseOnDropTarget(e,t){const n=this.getAllContainersFromDropTarget(t);let r=!1;for(const s of n)if(this.allContainersIntersect(e,s)){r=!0;break}const{eElement:i,type:o}=this.dragSource;return!(t.targetContainsSource&&!t.getContainer().contains(i))&&(r&&t.isInterestedIn(o,i))}findCurrentDropTarget(e,t){const n=t.length;if(0===n)return null;if(1===n)return t[0];const r=fV(this.gos).elementsFromPoint(e.clientX,e.clientY);for(const i of r)for(const e of t){if(-1!==UV(this.getAllContainersFromDropTarget(e)).indexOf(i))return e}return null}enterDragTargetIfExists(e,t,n,r,i){if(e&&e.onDragEnter){const o=this.createDropTargetEvent(e,t,n,r,i);e.onDragEnter(o)}}leaveLastTargetIfExists(e,t,n,r){if(!this.lastDropTarget)return;if(this.lastDropTarget.onDragLeave){const i=this.createDropTargetEvent(this.lastDropTarget,e,t,n,r);this.lastDropTarget.onDragLeave(i)}const i=this.getDragAndDropImageComponent();i&&i.setIcon(null)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.filter(e=>e.external).find(t=>t.getContainer()===e.getContainer())||null}isDropZoneWithinThisGrid(e){const t=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:n}=e;return t.contains(n)}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,n=e.clientX;return t===n?null:t>n?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,n=e.clientY;return t===n?null:t>n?0:1}createDropTargetEvent(e,t,n,r,i){const o=e.getContainer(),s=o.getBoundingClientRect(),{dragItem:a,dragSource:l}=this,c=t.clientX-s.left,u=t.clientY-s.top;return this.gos.addGridCommonParams({event:t,x:c,y:u,vDirection:r,hDirection:n,dragSource:l,fromNudge:i,dragItem:a,dropZoneTarget:o})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();if(!t)return;const n=t.getGui(),r=n.getBoundingClientRect().height,i=(document.body?.clientWidth??(window.innerHeight||document.documentElement?.clientWidth||-1))-2,o=(document.body?.clientHeight??(window.innerHeight||document.documentElement?.clientHeight||-1))-2;if(!n.offsetParent)return;const s=BW(n.offsetParent),{clientY:a,clientX:l}=e;let c=a-s.top-r/2,u=l-s.left-10;const d=pV(this.gos),h=d.defaultView||window,p=h.pageYOffset||d.documentElement.scrollTop,g=h.pageXOffset||d.documentElement.scrollLeft;i>0&&u+n.clientWidth>i+g&&(u=i+g-n.clientWidth),u<0&&(u=0),o>0&&c+n.clientHeight>o+p&&(c=o+p-n.clientHeight),c<0&&(c=0),n.style.left=`${u}px`,n.style.top=`${c}px`}removeDragAndDropImageComponent(){if(this.dragAndDropImageComp){const{comp:e}=this.dragAndDropImageComp;if(e){const t=e.getGui();this.dragAndDropImageParent&&this.dragAndDropImageParent.removeChild(t),this.destroyBean(e)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e}=this;if(!e)return;const t=this.userComponentFactory.getDragAndDropImageCompDetails({dragSource:e}).newAgStackInstance();this.dragAndDropImageComp={promise:t},t.then(e=>{e&&this.isAlive()&&(this.processDragAndDropImageComponent(e),this.dragAndDropImageComp.comp=e)})}processDragAndDropImageComponent(e){const{dragSource:t,mouseEventService:n,environment:r}=this;if(!t)return;const i=e.getGui();i.style.setProperty("position","absolute"),i.style.setProperty("z-index","9999"),n.stampTopLevelGridCompWithGridInstance(i),r.applyThemeClasses(i),e.setIcon(null);let{dragItemName:o}=t;_H(o)&&(o=o()),e.setLabel(o||""),i.style.top="20px",i.style.left="20px";const s=pV(this.gos);let a=null,l=null;try{a=s.fullscreenElement}catch(c){}finally{a||(a=fV(this.gos));const e=a.querySelector("body");l=e||(a instanceof ShadowRoot?a:a instanceof Document?a?.documentElement:a)}this.dragAndDropImageParent=l,l?l.appendChild(i):NH("Could not find document body, it is needed for drag and drop.")}},Fj=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.shouldSkipVerticalScroll();if(t&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<n.left+r,this.tickRight=e.clientX>n.right-r,this.tickUp=e.clientY<n.top+r&&!t,this.tickDown=e.clientY>n.bottom-r&&!t,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},Oj=class extends nB{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.sortController=e.sortController,this.filterManager=e.filterManager,this.selectionService=e.selectionService,this.mouseEventService=e.mouseEventService,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){nV(this.gos)&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(this,e=>{const t=e.gridBodyCtrl;this.autoScrollService=new Fj({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:e=>t.getScrollFeature().setVerticalScrollPosition(e),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(e){return 2===e}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){if(this.funcColsService.getRowGroupColumns().length)return!0;const e=this.filterManager?.isAnyFilterPresent();if(e)return!0;return!!this.sortController.isSortActive()}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const e=[...this.selectionService.getSelectedNodes()].sort((e,t)=>null==e.rowIndex||null==t.rowIndex?0:this.getRowIndexNumber(e)-this.getRowIndexNumber(t));if(-1!==e.indexOf(t))return e}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach(e=>{e.setDragging(!0)}),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const n=this.isFromThisGrid(e),r=this.gos.get("rowDragManaged"),i=e.dragItem.rowNodes;r&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!n?this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(i[0],t):this.moveRows(i,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(VV(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),n=t&&1===t.highlighted,r=this.mouseEventService.getNormalisedPosition(e).y,i=e.dragItem.rowNodes;let o=n?1:0;if(this.isFromThisGrid(e))i.forEach(e=>{e.rowTop<r&&(o-=1)}),this.moveRows(i,r,o);else{const e=TV(this.gos);let t=this.clientSideRowModel.getRowIndexAtPixel(r)+1;0===this.clientSideRowModel.getHighlightPosition(r)&&t--,this.clientSideRowModel.updateRowData({add:i.filter(t=>!this.clientSideRowModel.getRowNode(e?.({data:t.data,level:0,rowPinned:t.rowPinned})??t.data.id)).map(e=>e.data),addIndex:t})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.clientSideRowModel.ensureRowsAtPixel(e,t,n)&&(this.focusService.clearFocusedCell(),this.rangeService?.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer())return void NH("addRowDropZone - A container target needs to be provided");if(this.dragAndDropService.findExternalZone(e))return void NH("addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=t=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}),e.onDragLeave&&(t.onDragLeave=t=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}),e.onDragging&&(t.onDragging=t=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}),e.onDragStop&&(t.onDragStop=t=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}),e.onDragCancel&&(t.onDragCancel=t=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}));const n={isInterestedIn:e=>2===e,getIconName:()=>"move",external:!0,...t};this.dragAndDropService.addDropTarget(n),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(n))}getRowDropZone(e){const t=this.getContainer.bind(this),n=this.onDragEnter.bind(this),r=this.onDragLeave.bind(this),i=this.onDragging.bind(this),o=this.onDragStop.bind(this),s=this.onDragCancel.bind(this);let a;return a=e?{getContainer:t,onDragEnter:e.onDragEnter?t=>{n(t),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}:n,onDragLeave:e.onDragLeave?t=>{r(t),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}:r,onDragging:e.onDragging?t=>{i(t),e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}:i,onDragStop:e.onDragStop?t=>{o(t),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}:o,onDragCancel:e.onDragCancel?t=>{s(t),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}:s,fromGrid:!0}:{getContainer:t,onDragEnter:n,onDragLeave:r,onDragging:i,onDragStop:o,onDragCancel:s,fromGrid:!0},a}draggingToRowDragEvent(e,t){const n=this.mouseEventService.getNormalisedPosition(t).y;let r,i,o=-1;switch(n>this.pageBoundsService.getCurrentPageHeight()||(o=this.rowModel.getRowIndexAtPixel(n),r=this.rowModel.getRow(o)),t.vDirection){case 1:i="down";break;case 0:i="up";break;default:i=null}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:o,overNode:r,y:n,vDirection:i})}dispatchGridEvent(e,t){const n=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(n)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach(e=>{e.setDragging(!1)})}},Nj=class extends nB{constructor(){super(...arguments),this.beanName="dragService",this.dragEndFunctions=[],this.dragSources=[]}wireBeans(e){this.mouseEventService=e.mouseEventService}destroy(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,n=e.mouseDownListener;if(t.removeEventListener("mousedown",n),e.touchEnabled){const n=e.touchStartListener;t.removeEventListener("touchstart",n,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find(t=>t.dragSource===e);t&&(this.removeListener(t),zV(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:n,includeTouch:r,stopPropagationForTouch:i}=e;n.addEventListener("mousedown",t);let o=null;const s=this.gos.get("suppressTouch");r&&!s&&(o=t=>{AW(t.target)||(i&&t.stopPropagation(),this.onTouchStart(e,t))},n.addEventListener("touchstart",o,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:o,touchEnabled:!!r})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const n=t.touches[0];this.touchLastTime=n,this.touchStart=n;const r=t=>this.onTouchUp(t,e.eElement),i=t.target,o=[{target:fV(this.gos),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:i,type:"touchmove",listener:t=>this.onTouchMove(t,e.eElement),options:{passive:!0}},{target:i,type:"touchend",listener:r,options:{passive:!0}},{target:i,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(o),0===e.dragStartPixels&&this.onCommonMove(n,this.touchStart,e.eElement)}onMouseDown(e,t){const n=t;if(e.skipMouseEvent&&e.skipMouseEvent(t))return;if(n._alreadyProcessedByDragService)return;if(n._alreadyProcessedByDragService=!0,0!==t.button)return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const r=fV(this.gos),i=[{target:r,type:"mousemove",listener:t=>this.onMouseMove(t,e.eElement)},{target:r,type:"mouseup",listener:t=>this.onMouseUp(t,e.eElement)},{target:r,type:"contextmenu",listener:e=>e.preventDefault()},{target:r,type:"keydown",listener:t=>{t.key===Bz.ESCAPE&&this.cancelDrag(e.eElement)}}];this.addTemporaryEvents(i),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(e=>{const{target:t,type:n,listener:r,options:i}=e;t.addEventListener(n,r,i)}),this.dragEndFunctions.push(()=>{e.forEach(e=>{const{target:t,type:n,listener:r,options:i}=e;t.removeEventListener(n,r,i)})})}isEventNearStartEvent(e,t){const{dragStartPixels:n}=this.currentDragParams;return Iz(e,t,$H(n)?n:4)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,n){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventService.dispatchEvent({type:"dragStarted",target:n}),this.currentDragParams.onDragStart(t),!this.currentDragParams)return void(this.dragging=!1);this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){const n=this.getFirstActiveTouch(e.touches);n&&this.onCommonMove(n,this.touchStart,t)}onMouseMove(e,t){if(dz()){const e=pV(this.gos);e.getSelection()?.removeAllRanges()}this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),n="mousemove"===e.type;return t&&n&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,n=t?.tagName.toLocaleLowerCase();return!!n?.match("^a$|textarea|input|select|button")}onTouchUp(e,t){let n=this.getFirstActiveTouch(e.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventService.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventService.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(e=>e()),this.dragEndFunctions.length=0}},Lj=class extends Ez{constructor(e,t,n,r,i,o){super(),this.cellValueFn=e,this.rowNode=t,this.column=n,this.customGui=r,this.dragStartPixels=i,this.suppressVisibilityChange=o,this.dragSource=null}wireBeans(e){this.beans=e}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Mz("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new Vj(this,this.beans,this.rowNode,this.column):new Hj(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&NH("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:e=>{e?.preventDefault()}})[0]);const n=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{const e=this.getDragItem(),t=e.rowNodes?.length||1,r=this.getRowDragText(this.column);return r?r(e,t):1===t?this.cellValueFn():`${t} ${n("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},_j=class extends nB{constructor(e,t,n){super(),this.parent=e,this.rowNode=t,this.column=n}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let e=!0,n=!1;this.column&&(e=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),n=_H(this.column.getColDef().rowDrag)),n?(this.parent.setDisplayed(!0,t),this.parent.setVisible(e,t)):(this.parent.setDisplayed(e,t),this.parent.setVisible(!0,t))}}},Hj=class extends _j{constructor(e,t,n,r){super(e,n,r),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},Vj=class extends _j{constructor(e,t,n,r){super(e,n,r),this.beans=t}postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventService,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),n=this.gos.get("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),i=t&&!r||n;this.setDisplayedOrVisible(i)}},Bj=new Set(["localEventService","__objectId","sticky","__autoHeights","checkAutoHeightsDebounced"]),Wj=class e{constructor(t){this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=e.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const n=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const r=this.createDataChangedEvent(e,n,t);this.localEventService?.dispatchEvent(r)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,n){return{type:"dataChanged",node:this,oldData:t,newData:e,update:n}}getRowIndexString(){return null==this.rowIndex?(LH("Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid."),null):"top"===this.rowPinned?e.ID_PREFIX_TOP_PINNED+this.rowIndex:"bottom"===this.rowPinned?e.ID_PREFIX_BOTTOM_PINNED+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new e(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(e,t){const n=$H(this.id)?this.createDaemonNode():null,r=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,n);const i=this.createDataChangedEvent(e,r,!1);this.localEventService?.dispatchEvent(i)}checkRowSelectable(){const e=FV(this.beans.gos);this.setRowSelectable(!e||e(this))}setRowSelectable(e,t){if(this.selectable!==e){if(this.selectable=e,this.dispatchRowEvent("selectableChanged"),t)return;if(_V(this.beans.gos)){const e=this.calculateSelectedFromChildren();return void this.setSelectedParams({newValue:e??!1,source:"selectableChanged"})}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const n=TV(this.beans.gos);if(n)if(this.data){const t=this.parent?.getRoute()??[];this.id=n({data:this.data,parentKeys:t.length>0?t:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(e.ID_PREFIX_ROW_GROUP)&&LH(`Row IDs cannot start with ${e.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`)}else this.id=void 0;else this.id=t}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.dispatchRowEvent("masterChanged"))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.checkRowSelectable(),this.dispatchRowEvent("groupChanged"))}setRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setRowAutoHeight(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=zH(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let e=!1,t=!0,n=0;const r=this.__autoHeights;if(null==r)return;if(this.beans.visibleColsService.getAllAutoHeightCols().forEach(i=>{let o=r[i.getId()];if(null==o){if(!this.beans.columnModel.isColSpanActive())return void(e=!0);{let t=[];switch(i.getPinned()){case"left":t=this.beans.visibleColsService.getLeftColsForRow(this);break;case"right":t=this.beans.visibleColsService.getRightColsForRow(this);break;case null:t=this.beans.columnViewportService.getColsWithinViewport(this)}if(t.includes(i))return void(e=!0);o=-1}}else t=!1;o>n&&(n=o)}),e)return;if((t||n<10)&&(n=lV(this.beans.gos,this).height),n==this.rowHeight)return;this.setRowHeight(n);const i=this.beans.rowModel;i.onRowHeightChangedDebounced?.()}setExpanded(e,t,n){if(this.expanded===e)return;this.expanded=e,this.dispatchRowEvent("expandedChanged");const r={...this.createGlobalRowEvent("rowGroupOpened"),expanded:e,event:t||null};this.beans.rowNodeEventThrottle.dispatchExpanded(r,n),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return this.beans.gos.addGridCommonParams({type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}setDataValue(e,t,n){const r=(()=>"string"!==typeof e?e:this.beans.columnModel.getCol(e)??this.beans.columnModel.getColDefCol(e))(),i=this.beans.valueService.getValueForDisplay(r,this);if(this.beans.gos.get("readOnlyEdit"))return this.beans.eventService.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:r,colDef:r.getColDef(),data:this.data,node:this,oldValue:i,newValue:t,value:t,source:n}),!1;const o=this.beans.valueService.setValue(this,r,t,n);return this.dispatchCellChangedEvent(r,t,i),this.checkRowSelectable(),o}setGroupValue(e,t){const n=this.beans.columnModel.getCol(e);UH(this.groupData)&&(this.groupData={});const r=n.getColId(),i=this.groupData[r];i!==t&&(this.groupData[r]=t,this.dispatchCellChangedEvent(n,t,i))}setAggData(e){const t=this.aggData;if(this.aggData=e,this.localEventService){const n=e=>{const n=this.aggData?this.aggData[e]:void 0,r=t?t[e]:void 0;if(n===r)return;const i=this.beans.columnModel.getCol(e);i&&this.dispatchCellChangedEvent(i,n,r)};for(const e in t)n(e);for(const r in e)t&&r in t||n(r)}}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(rV(this.beans.gos)){const t=this.beans.gos.get("treeData"),n=this.beans.gos.get("isServerSideGroup");e=!this.stub&&!this.footer&&(t?!!n&&n(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,n){const r={type:"cellChanged",node:this,column:e,newValue:t,oldValue:n};this.localEventService?.dispatchEvent(r)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!this.footer&&(this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(t=>t.depthFirstSearch(e)),e(this)}calculateSelectedFromChildren(){let e=!1,t=!1;if(!this.childrenAfterGroup?.length)return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const r=this.childrenAfterGroup[n];let i=r.isSelected();if(!r.selectable){const e=r.calculateSelectedFromChildren();if(null===e)continue;i=e}switch(i){case!0:e=!0;break;case!1:t=!0;break;default:return}}return e&&t?void 0:!!e||!t&&(this.selectable?this.selected:null)}setSelectedInitialValue(e){this.selected=e}dispatchRowEvent(e){this.localEventService?.dispatchEvent({type:e,node:this})}selectThisNode(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";const r=!this.selectable&&e,i=this.selected===e;if(r||i)return!1;this.selected=e,this.dispatchRowEvent("rowSelected");const o=this.sibling;return o&&o.footer&&o.localEventService&&o.dispatchRowEvent("rowSelected"),this.beans.eventService.dispatchEvent({...this.createGlobalRowEvent("rowSelected"),event:t||null,source:n}),!0}setSelected(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";"boolean"!==typeof n?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:n}):NH("since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(e){return this.rowPinned?(NH("cannot select pinned rows"),0):void 0===this.id?(NH("cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected({...e,nodes:[this.footer?this.sibling:this]})}isRowPinned(){return!!this.rowPinned}addEventListener(e,t){this.localEventService||(this.localEventService=new IH),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.localEventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new gB(this.beans.frameworkOverrides));const n=this.frameworkEventListenerService?.wrap(e,t)??t;this.localEventService.addEventListener(e,n)}removeEventListener(e,t){if(!this.localEventService)return;const n=this.frameworkEventListenerService?.unwrap(e,t)??t;this.localEventService.removeEventListener(e,n),this.localEventService.noRegisteredListenersExist()&&(this.localEventService=null)}onMouseEnter(){this.dispatchRowEvent("mouseEnter")}onMouseLeave(){this.dispatchRowEvent("mouseLeave")}isFullWidthCell(){if(NH("since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option."),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(-1===this.level)return[];if(null==this.key)return;const e=[];let t=this;for(;t&&null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}createFooter(){if(this.sibling)return;const t=new e(this.beans);Object.keys(this).forEach(e=>{Bj.has(e)||(t[e]=this[e])}),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.dispatchRowEvent("lastChildChanged"))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.dispatchRowEvent("childIndexChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.dispatchRowEvent("draggingChanged"))}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.dispatchRowEvent("rowHighlightChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};Wj.ID_PREFIX_ROW_GROUP="row-group-",Wj.ID_PREFIX_TOP_PINNED="t-",Wj.ID_PREFIX_BOTTOM_PINNED="b-",Wj.OBJECT_ID_SEQUENCE=0;var zj=Wj,jj=class extends Ez{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then(()=>{})??rj.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then(t=>{t?.afterGuiAttached?.(e)})}afterGuiDetached(){this.filterWrapper?.filterPromise?.then(e=>{e?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:n}=this;this.filterWrapper=this.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then(r=>{const i=r.getGui();$H(i)||NH(`getGui method from filter returned ${i}; it should be a DOM element.`),this.appendChild(i),e&&this.eventService.dispatchEvent({type:"filterOpened",column:t,source:n,eGui:this.getGui()})})}onFilterDestroyed(e){"api"!==e.source&&"paramsUpdated"!==e.source||e.column.getId()!==this.column.getId()||!this.columnModel.getColDefCol(this.column)||(jW(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},Gj="ag-resizer-wrapper",$j=(e,t)=>`<div data-ref="${e}Resizer" class="ag-resizer ag-resizer-${t}"></div>`,Uj=`<div class="${Gj}">\n        ${$j("eTopLeft","topLeft")}\n        ${$j("eTop","top")}\n        ${$j("eTopRight","topRight")}\n        ${$j("eRight","right")}\n        ${$j("eBottomRight","bottomRight")}\n        ${$j("eBottom","bottom")}\n        ${$j("eBottomLeft","bottomLeft")}\n        ${$j("eLeft","left")}\n    </div>`,Kj=class extends nB{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupService=e.popupService,this.resizeObserverService=e.resizeObserverService,this.dragService=e.dragService}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,n=t/2-this.getWidth()/2,r=e/2-this.getHeight()/2;this.offsetElement(n,r)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:n,width:r,minHeight:i,height:o,x:s,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=UW(this.element);if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const n=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-n}if(null!=t.minHeight){const n=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-n}}if(this.minHeight=i||l,this.minWidth=n||c,r&&this.setWidth(r),o&&this.setHeight(o),r&&o||this.refreshSize(),e)this.center();else if(s||a)this.offsetElement(s,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const n=parseFloat(e.style.top),r=parseFloat(e.style.left);t?this.offsetElement(isNaN(r)?0:r,isNaN(n)?0:n):this.setPosition(r,n)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const n=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(n),this.moveElementDragListener=n):(this.dragService.removeDragSource(n),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{const n=!!e[t],r=this.getResizerElement(t),i={dragStartPixels:0,eElement:r,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragService.addDragSource(i),this.resizeListeners.push(i),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=n)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=`${t}px`),-1!==e&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,n=this.element;let r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))XW(n,e),e=HW(n),r=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(r?(n.style.maxHeight="unset",n.style.minHeight="unset"):t?XW(n,e):(n.style.height=`${e}px`,n.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:n}=this.offsetParent;if(!n)return null;const r=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:r.top,s=e?0:i.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-r.bottom}}return n+s-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:n}=this.config;let r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))qW(t,e),e=VW(t),r=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,r=n?this.position.x:this.element.getBoundingClientRect().left;t&&e+r>t&&(e=t-r)}this.getWidth()!==e&&(r?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?qW(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))}offsetElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{forcePopupParentAsOffsetParent:n}=this.config,r=n?this.boundaryEl:this.element;r&&(this.popupService.positionPopup({ePopup:r,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(r.style.left),parseFloat(r.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height",`${e}px`)};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:n,isTop:r,anywhereWithin:i,topBuffer:o}=e,s=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!n,!!i,s)?0:s,movementY:this.shouldSkipY(t,!!r,o,a)?0:a}}shouldSkipX(e,t,n,r){const i=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:i.left;let l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=s.right;return!!l||(l=t?r<0&&e.clientX>a+o.left||r>0&&e.clientX<a+o.left:n?r<0&&e.clientX>s.right||r>0&&e.clientX<a+o.left:r<0&&e.clientX>s.right||r>0&&e.clientX<s.right,l)}shouldSkipY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const i=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:i.top;let l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=s.bottom;return!!l||(l=t?r<0&&e.clientY>a+o.top+n||r>0&&e.clientY<a+o.top:r<0&&e.clientY>s.bottom||r>0&&e.clientY<s.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[data-ref=eTopLeftResizer]")},top:{element:e.querySelector("[data-ref=eTopResizer]")},topRight:{element:e.querySelector("[data-ref=eTopRightResizer]")},right:{element:e.querySelector("[data-ref=eRightResizer]")},bottomRight:{element:e.querySelector("[data-ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[data-ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[data-ref=eBottomLeftResizer]")},left:{element:e.querySelector("[data-ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const t=(new DOMParser).parseFromString(Uj,"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${Gj}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:n,forcePopupParentAsOffsetParent:r}=this.config;n||r||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter(e=>!e.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,n=0;for(let r=0;r<e.length;r++){const i=e[r],o=!!i.style.flex&&"0 0 auto"!==i.style.flex;if(i===this.element)continue;let s=this.minHeight||0,a=this.minWidth||0;if(o){const e=window.getComputedStyle(i);e.minHeight&&(s=parseInt(e.minHeight,10)),e.minWidth&&(a=parseInt(e.minWidth,10))}else s=i.offsetHeight,a=i.offsetWidth;t+=s,n+=a}return{height:t,width:n}}applySizeToSiblings(e){let t=null;const n=this.getSiblings();if(n){for(let r=0;r<n.length;r++){const i=n[r];i!==t&&(e?i.style.height=`${i.offsetHeight}px`:i.style.width=`${i.offsetWidth}px`,i.style.flex="0 0 auto",i===this.element&&(t=n[r+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:n}=this.config,{isTop:r,isRight:i,isBottom:o,isLeft:s}=this.currentResizer,a=i||s,l=o||r,{movementX:c,movementY:u}=this.calculateMouseMovement({e:e,isLeft:s,isTop:r}),d=this.position.x,h=this.position.y;let p=0,g=0;if(a&&c){const e=s?-1:1,t=this.getWidth(),n=t+c*e;let r=!1;s&&(p=t-n,(d+p<=0||n<=this.minWidth)&&(r=!0,p=0)),r||this.setWidth(n)}if(l&&u){const e=r?-1:1,t=this.getHeight(),n=t+u*e;let i=!1;r?(g=t-n,(h+g<=0||n<=this.minHeight)&&(i=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&t<n&&this.getMinSizeOfSiblings().height+n>this.element.parentElement.offsetHeight&&(i=!0),i||this.setHeight(n)}this.updateDragStartPosition(e.clientX,e.clientY),((t||n)&&p||g)&&this.offsetElement(d+p,h+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:n}=this.position;let r;this.config.calculateTopBuffer&&(r=this.config.calculateTopBuffer());const{movementX:i,movementY:o}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:r});this.offsetElement(t+i,n+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},Yj=class e extends nB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.eFocusableElement=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())},...t}}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.eFocusableElement.classList.add(e.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedElementListeners(this.eFocusableElement,{focusin:this.callbacks.onFocusIn}),this.callbacks.onFocusOut&&this.addManagedElementListeners(this.eFocusableElement,{focusout:this.callbacks.onFocusOut})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:e=>{e.defaultPrevented||JV(e)||(this.callbacks.shouldStopEventPropagation(e)?QV(e):e.key===Bz.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))}})}};Yj.FOCUS_MANAGED_CLASS="ag-focus-managed";var qj=Yj,Xj={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function Qj(e,t){return Jj(e)?(null!=e.debounceMs&&NH("debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}function Jj(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}var Zj=class extends Ez{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=Rz,this.buttonListeners=[]}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.resetTemplate(),this.createManagedBean(new qj(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Kj(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const n=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" data-ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(n,this.getAgComponents(),e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(e){this.providedFilterParams=e,this.applyActive=Jj(e),this.resetButtonsPanel(e)}updateParams(e){this.providedFilterParams=e,this.applyActive=Jj(e),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(e,t){const{buttons:n,readOnly:r}=t??{},{buttons:i,readOnly:o}=e;if(r===o&&JH(n,i))return;const s=i&&i.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(jW(this.eButtonsPanel),this.buttonListeners.forEach(e=>e()),this.buttonListeners=[]):s&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!s)return void(this.eButtonsPanel&&GW(this.eButtonsPanel));const a=document.createDocumentFragment(),l=e=>{let t,n;switch(e){case"apply":t=this.translate("applyFilter"),n=e=>this.onBtApply(!1,!1,e);break;case"clear":t=this.translate("clearFilter"),n=()=>this.onBtClear();break;case"reset":t=this.translate("resetFilter"),n=()=>this.onBtReset();break;case"cancel":t=this.translate("cancelFilter"),n=e=>{this.onBtCancel(e)};break;default:return void NH("Unknown button type specified")}const r=KW(`<button\n                    type="${"apply"===e?"submit":"button"}"\n                    data-ref="${e}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${t}\n                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(r,{click:n})),a.append(r)};i.forEach(e=>l(e)),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Qj(this.providedFilterParams,this.getDefaultDebounceMs()),t=zH(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const n=()=>{this.onUiChanged(!1,"prevent"),t?.()};null!=e?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(){const e=this.getModelFromUi();if(!this.isModelValid(e))return!1;const t=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(t,e)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(n&&n.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")){const n="columnFilter";this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:n})}const{closeOnApply:r}=this.providedFilterParams;r&&this.applyActive&&!e&&!t&&this.close(n)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,n=t&&t.key;let r;"Enter"!==n&&"Space"!==n||(r={keyboardEvent:t}),this.hidePopup(r),this.hidePopup=null}onUiChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi()),t=this.queryForHtmlElement('[data-ref="applyFilterButton"]');t&&FW(t,!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e||"columnFilter"===e,{positionableFeature:n,gos:r}=this;t?(n.restoreLastSize(),n.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.providedFilterParams;return this.providedFilterParams=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,Xj[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}},eG=class extends Gz{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},tG=class extends Ez{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),this.unFocusable||this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case Bz.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case Bz.DOWN:case Bz.UP:e.preventDefault(),this.navigate(t);break;case Bz.PAGE_DOWN:case Bz.PAGE_UP:case Bz.PAGE_HOME:case Bz.PAGE_END:e.preventDefault(),this.navigateToPage(t)}}navigate(e){const t=e===Bz.DOWN;let n;if(this.highlightedEl){let e=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);e=Math.min(Math.max(e,0),this.itemEls.length-1),n=this.itemEls[e]}else n=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(n)}navigateToPage(e){if(!this.highlightedEl||0===this.itemEls.length)return;const t=this.itemEls.indexOf(this.highlightedEl),n=this.options.length-1,r=this.itemEls[0].clientHeight,i=Math.floor(this.getGui().clientHeight/r);let o=-1;e===Bz.PAGE_HOME?o=0:e===Bz.PAGE_END?o=n:e===Bz.PAGE_DOWN?o=Math.min(t+i,n):e===Bz.PAGE_UP&&(o=Math.max(t-i,0)),-1!==o&&this.highlightItem(this.itemEls[o])}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){const{value:t,text:n}=e,r=n||t;return this.options.push({value:t,text:r}),this.renderOption(t,r),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(e=>{GW(e)}),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach((t,n)=>{var r,i;!function(e,t){pW(e,"posinset",t)}(t,n+1),r=t,i=e.length,pW(r,"setsize",i)})}renderOption(e,t){const n=pV(this.gos),r=n.createElement("div");mW(r,"option"),r.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const i=n.createElement("span");r.appendChild(i),i.textContent=t,this.unFocusable||(r.tabIndex=-1),this.itemEls.push(r),this.addManagedListeners(r,{mouseover:()=>this.highlightItem(r),mousedown:t=>{t.preventDefault(),t.stopPropagation(),this.setValue(e)}}),this.createManagedBean(new Sz({getTooltipValue:()=>t,getGui:()=>r,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>i.scrollWidth>i.clientWidth})),this.getGui().appendChild(r)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(t),this;const n=this.options.findIndex(t=>t.value===e);if(-1!==n){const e=this.options[n];this.value=e.value,this.displayValue=e.text,this.highlightItem(this.itemEls[n]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(e=>e.value===this.value);-1!==e&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!UW(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(this.activeClass),MW(this.highlightedEl,!0);const t=this.getGui(),{scrollTop:n,clientHeight:r}=t,{offsetTop:i,offsetHeight:o}=e;(i+o>n+r||i<n)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){this.highlightedEl&&UW(this.highlightedEl)&&(this.highlightedEl.classList.remove(this.activeClass),MW(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},nG=class extends zz{constructor(e){if(super(e,e?.template||'\n            <div class="ag-picker-field" role="presentation">\n                <div data-ref="eLabel"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">\n                    <div data-ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=Rz,this.eWrapper=Rz,this.eDisplayField=Rz,this.eIcon=Rz,this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:n,variableWidth:r,minPickerWidth:i,maxPickerWidth:o}=e;null!=t&&(this.pickerGap=t),this.variableWidth=!!r,null!=n&&this.setPickerMaxHeight(n),null!=i&&this.setPickerMinWidth(i),null!=o&&this.setPickerMaxWidth(o)}wireBeans(e){this.popupService=e.popupService}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:n,inputWidth:r}=this.config;if(n){const e=Mz(n,this.gos);e&&this.eIcon.appendChild(e)}null!=r&&this.setInputWidth(r)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),yW(e,!1),this.ariaRole&&mW(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case Bz.UP:case Bz.DOWN:case Bz.ENTER:case Bz.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case Bz.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:n,pickerAriaLabelValue:r,modalPicker:i=!0}=this.config,o={modal:i,eChild:e,closeOnEsc:!0,closedCallback:()=>{const e=vV(this.gos);this.beforeHidePicker(),e&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(n,r),anchorToElement:this.eWrapper};e.style.position="absolute";const s=this.popupService.addPopup(o),{maxPickerHeight:a,minPickerWidth:l,maxPickerWidth:c,variableWidth:u}=this;u?(l&&(e.style.minWidth=l),e.style.width=QW(VW(this.eWrapper)),c&&(e.style.maxWidth=c)):YW(e,c??VW(this.eWrapper));const d=a??`${LW(this.popupService.getPopupParent())}px`;return e.style.setProperty("max-height",d),this.alignPickerToComponent(),s.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,n=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:n,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;yW(this.getAriaElement(),e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return YW(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return"number"===typeof e&&(e=`${e}px`),this.minPickerWidth=null==e?void 0:e,this}setPickerMaxWidth(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerWidth=null==e?void 0:e,this}setPickerMaxHeight(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerHeight=null==e?void 0:e,this}destroy(){this.hidePicker(),super.destroy()}},rG=class extends nG{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox",...e})}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:n}=this.config;null!=e&&this.addOptions(e),null!=t&&this.setValue(t,!0),n&&null==t&&(this.eDisplayField.textContent=n),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new tG("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),t=`ag-select-list-${this.listComponent.getCompId()}`;var n,r;e.setAttribute("id",t),hW(n=this.getAriaElement(),"controls",(r=e).id),wW(r,n.id),this.listComponent.addManagedListeners(this.listComponent,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})}}),this.listComponent.addManagedListeners(this.listComponent,{fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===Bz.TAB&&this.hidePicker(),t){case Bz.ENTER:case Bz.UP:case Bz.DOWN:case Bz.PAGE_UP:case Bz.PAGE_DOWN:case Bz.PAGE_HOME:case Bz.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case Bz.ESCAPE:super.onKeyDown(e);break;case Bz.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e)}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach(e=>this.addOption(e)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this}setValue(e,t,n){if(this.value===e||!this.listComponent)return this;n||this.listComponent.setValue(e,!0);if(this.listComponent.getValue()===this.getValue())return this;let r=this.listComponent.getDisplayValue();return null==r&&this.config.placeholder&&(r=this.config.placeholder),this.eDisplayField.textContent=r,this.setTooltip({newTooltipText:r??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,t)}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}},iG={selector:"AG-SELECT",component:rG},oG=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(e=>{if("string"===typeof e)return;[["displayKey"],["displayName"],["predicate","test"]].every(t=>!!t.some(t=>null!=e[t])||(NH(`ignoring FilterOptionDef as it doesn't contain one of '${t}'`),!1))?this.customFilterOptions[e.displayKey]=e:this.filterOptions=this.filterOptions.filter(t=>t===e)||[]})}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:NH("invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else NH("no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},sG=class extends Zj{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:"inRange"===e?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,n)=>{0===n?t.setValue(e,!0):t.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const n=!e.operator,r=!t.operator;if(!n&&r||n&&!r)return!1;let i;if(n){const n=e,r=t;i=this.areSimpleModelsEqual(n,r)}else{const n=e,r=t;i=n.operator===r.operator&&BV(n.conditions,r.conditions,(e,t)=>this.areSimpleModelsEqual(e,t))}return i}shouldRefresh(e){const t=this.getModel(),n=t?t.conditions??[t]:null,r=e.filterOptions?.map(e=>"string"===typeof e?e:e.displayKey)??this.getDefaultFilterOptions(),i=!n||n.every(e=>void 0!==r.find(t=>t===e.type));return!!i&&!("number"===typeof e.maxNumConditions&&n&&n.length>e.maxNumConditions)}refresh(e){if(!this.shouldRefresh(e))return!1;return!!super.refresh(e)&&(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const t=e;let n=t.conditions;null==n&&(n=[],NH("Filter model is missing 'conditions'"));const r=this.validateAndUpdateConditions(n),i=this.getNumConditions();if(r<i)this.removeConditionsAndOperators(r);else if(r>i)for(let e=i;e<r;e++)this.createJoinOperatorPanel(),this.createOption();const o="OR"===t.operator;this.eJoinOperatorsAnd.forEach(e=>e.setValue(!o,!0)),this.eJoinOperatorsOr.forEach(e=>e.setValue(o,!0)),n.forEach((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)})}else{const t=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(t.type,!0),this.setConditionIntoUi(t,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),rj.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),NH('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),t=this.maxNumConditions),t}doesFilterPass(e){const t=this.getModel();if(null==t)return!0;const{operator:n}=t,r=[];if(n){const e=t;r.push(...e.conditions??[])}else r.push(t);return r[n&&"OR"===n?"some":"every"](t=>this.individualConditionPasses(e,t))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new oG,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){this.maxNumConditions=e.maxNumConditions??2,this.maxNumConditions<1&&(NH('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=e.numAlwaysVisibleConditions??1,this.numAlwaysVisibleConditions<1&&(NH('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(NH('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new rG);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const n=this.getNumConditions()-1;this.forEachPositionInput(n,e=>this.resetInput(e)),this.addChangedListeners(e,n)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const r=this.eJoinOperatorPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,r,i),this.resetJoinOperatorOr(n,r,i),this.isReadOnly()||(t.onValueChange(this.listener),n.onValueChange(this.listener))}createJoinOperator(e,t,n){const r=this.createManagedBean(new eG);return e.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass(`ag-filter-condition-operator-${n}`),t.appendChild(r.getGui()),r}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map(e=>"string"===typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){this.filterListOptions.forEach(t=>{e.addOption(t)}),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,n=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:n?this.localeService.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(t)}}createBodyTemplate(){return""}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?e=n:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const t=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<t){this.removeConditionsAndOperators(t+1);const n=e+1,r=t-n;r>0&&this.removeConditionsAndOperators(n,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((t,n)=>{const r=this.isConditionDisabled(n,e);t.setDisabled(r||this.filterListOptions.length<=1),1===n&&(FW(this.eJoinOperatorPanels[0],r),this.eJoinOperatorsAnd[0].setDisabled(r),this.eJoinOperatorsOr[0].setDisabled(r))}),this.eConditionBodies.forEach((e,t)=>{DW(e,this.isConditionBodyVisible(t))});const n="OR"===(t??this.getJoinOperator());this.eJoinOperatorsAnd.forEach(e=>{e.setValue(!n,!0)}),this.eJoinOperatorsOr.forEach(e=>{e.setValue(n,!0)}),this.forEachInput((t,n,r,i)=>{this.setElementDisplayed(t,n<i),this.setElementDisabled(t,this.isConditionDisabled(r,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const n=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,n,t),this.removeComponents(this.eJoinOperatorsAnd,n,t),this.removeComponents(this.eJoinOperatorsOr,n,t)}removeElements(e,t,n){this.removeItems(e,t,n).forEach(e=>GW(e))}removeComponents(e,t,n){this.removeItems(e,t,n).forEach(e=>{GW(e.getGui()),this.destroyBean(e)})}removeItems(e,t,n){return null==n?e.splice(t):e.splice(t,n)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus)if(this.isReadOnly())this.eFilterBody.focus();else{const e=this.getInputs(0)[0];if(!e)return;e instanceof jz&&e.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,n=-1,r=!1;const i=this.getJoinOperator();for(let s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))-1===t&&(t=s,n=s);else{const e=s<t;(s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1)||e)&&(this.removeConditionsAndOperators(s,1),r=!0,e&&n--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(n===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(n,i),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=n}getPlaceholderText(e,t){let n=this.translate(e);if(_H(this.filterPlaceholder)){const e=this.filterPlaceholder,r=this.eTypes[t].getValue();n=e({filterOptionKey:r,filterOption:this.translate(r),placeholder:n})}else"string"===typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput((t,n,r,i)=>{if(!(t instanceof jz))return;const o=0===n&&i>1?"inRangeStart":0===n?"filterOoo":"inRangeEnd",s=0===n&&i>1?e("ariaFilterFromValue","Filter from value"):0===n?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(o,r)),t.setInputAriaLabel(s)})}setElementValue(e,t,n){e instanceof jz&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof Ez&&DW(e.getGui(),t)}setElementDisabled(e,t){e instanceof Ez&&FW(e.getGui(),t)}attachElementOnChange(e,t){e instanceof jz&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,n)=>{this.forEachPositionTypeInput(n,t,e)})}forEachPositionInput(e,t){const n=this.getConditionType(e);this.forEachPositionTypeInput(e,n,t)}forEachPositionTypeInput(e,t,n){const r=this.getNumberOfInputs(t),i=this.getInputs(e);for(let o=0;o<i.length;o++){const t=i[o];null!=t&&n(t,o,e,r)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return"empty"!==this.getConditionType(e)&&!this.getValues(e).some(e=>null==e)}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(e=>this.resetType(e)),this.eJoinOperatorsAnd.forEach((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t)),this.eJoinOperatorsOr.forEach((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t)),this.joinOperatorId++,this.forEachInput(e=>this.resetInput(e)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),rj.resolve()}resetType(e){const t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),n)}resetJoinOperatorOr(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),n)}resetJoinOperator(e,t,n,r,i){this.updateJoinOperatorDisabled(e.setValue(n,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${i}`).setLabel(r),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t)),this.eJoinOperatorsOr.forEach((e,t)=>this.updateJoinOperatorDisabled(e,t))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const n=this.mapValuesFromModel(e);this.forEachInput((e,r,i)=>{i===t&&this.setElementValue(e,null!=n[r]?n[r]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,n,r)=>{this.setElementValue(t,0===n&&0===r?e:null,!0)})}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,e=>{this.attachElementOnChange(e,this.listener)}))}individualConditionPasses(e,t){const n=this.getCellValue(e.node),r=this.mapValuesFromModel(t),i=this.optionsFactory.getCustomOption(t.type),o=this.evaluateCustomFilter(i,r,n);return null!=o?o:null==n?this.evaluateNullValue(t.type):this.evaluateNonNullValue(r,n,t,e)}evaluateCustomFilter(e,t,n){if(null==e)return;const{predicate:r}=e;return null==r||t.some(e=>null==e)?void 0:r(t,n)}isBlank(e){return null==e||"string"===typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}},aG=class extends sG{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case"equals":if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case"notEqual":if(this.scalarFilterParams.includeBlanksInNotEqual)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case"lessThan":case"lessThanOrEqual":if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case"inRange":if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,n){const r=this.comparator(),i=null!=e[0]?r(e[0],t):0;switch(n.type){case"equals":return 0===i;case"notEqual":return 0!==i;case"greaterThan":return i>0;case"greaterThanOrEqual":return i>=0;case"lessThan":return i<0;case"lessThanOrEqual":return i<=0;case"inRange":{const n=r(e[1],t);return this.scalarFilterParams.inRangeInclusive?i>=0&&n<=0:i>0&&n<0}case"blank":return this.isBlank(t);case"notBlank":return!this.isBlank(t);default:return NH('Unexpected type of filter "'+n.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}};function lG(e){if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===e.key?.length}function cG(e,t,n,r,i){const o=r?r.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;const s=e.addGridCommonParams({event:t,editing:i,column:r,node:n,data:n.data,colDef:r.getColDef()});if(o){if(o(s))return!0}return!1}var uG=class extends jz{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-text-field",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text")}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=$H(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListeners(this.eInput,{keydown:t=>{lG(t)&&t.key&&!e.test(t.key)&&t.preventDefault()},paste:t=>{const n=t.clipboardData?.getData("text");n&&n.split("").some(t=>!e.test(t))&&t.preventDefault()}})}},dG={selector:"AG-INPUT-TEXT-FIELD",component:uG},hG=class extends uG{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListeners(this.eInput,{blur:()=>{const e=parseFloat(this.eInput.value),t=isNaN(e)?"":this.normalizeValue(e.toString());this.value!==t&&this.setValue(t)},wheel:this.onWheel.bind(this)}),this.eInput.step="any";const{precision:e,min:t,max:n,step:r}=this.config;"number"===typeof e&&this.setPrecision(e),"number"===typeof t&&this.setMin(t),"number"===typeof n&&this.setMax(n),"number"===typeof r&&this.setStep(r)}onWheel(e){mV(this.gos)===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const t=parseFloat(e).toFixed(this.precision);return parseFloat(t).toString()}const n=String(e).split(".");if(n.length>1){if(n[1].length<=this.precision)return e;if(this.precision>0)return`${n[0]}.${n[1].slice(0,this.precision)}`}return n[0]}setMin(e){return this.min===e||(this.min=e,ZW(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,ZW(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,ZW(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue(e=>super.setValue(e,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(e=>super.setValue(e,!0),e=>{this.eInput.value=e},e)}setValueOrInputValue(e,t,n){if($H(n)){let r=this.isScientificNotation(n);if(r&&this.eInput.validity.valid)return e(n);if(!r){r=(n=this.adjustPrecision(n))!=this.normalizeValue(n)}if(r)return t(n)}return e(n)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"===typeof e&&e.includes("e")}},pG={selector:"AG-INPUT-NUMBER-FIELD",component:hG},gG=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],fG=class{constructor(e,t,n){this.localeService=e,this.optionsFactory=t,this.valueFormatter=n}getModelAsString(e){if(!e)return null;const t=null!=e.operator,n=this.localeService.getLocaleTextFunc();if(t){const t=e,r=(t.conditions??[]).map(e=>this.getModelAsString(e)),i="AND"===t.operator?"andCondition":"orCondition";return r.join(` ${n(i,Xj[i])} `)}if("blank"===e.type||"notBlank"===e.type)return n(e.type,e.type);{const t=e,r=this.optionsFactory.getCustomOption(t.type),{displayKey:i,displayName:o,numberOfInputs:s}=r||{};return i&&o&&0===s?(n(i,o),o):this.conditionToString(t,r)}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){return this.valueFormatter?this.valueFormatter(e??null)??"":String(e)}},mG=class extends fG{conditionToString(e,t){const{numberOfInputs:n}=t||{};return"inRange"==e.type||2===n?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:null!=e.filter?this.formatValue(e.filter):`${e.type}`}};function vG(e){const{allowedCharPattern:t}=e??{};return t??null}var wG=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],bG=class extends fG{conditionToString(e,t){const{numberOfInputs:n}=t||{};return"inRange"==e.type||2===n?`${e.filter}-${e.filterTo}`:null!=e.filter?`${e.filter}`:`${e.type}`}};function CG(e){const t=e&&e.trim();return""===t?e:t}function yG(e){if("number"===typeof e)return e;if("string"===typeof e){const t=parseInt(e);if(isNaN(t))return;return t}}function SG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return n=>{const r=yG(n);if(!(null==r||r<e||r>t))return r}}function xG(e,t){return e.toString().padStart(t,"0")}function RG(e,t,n){return"number"!==typeof e?"":e.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}function EG(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(!e)return null;let r=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(e=>xG(e,2)).join(n);return t&&(r+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map(e=>xG(e,2)).join(":")),r}var TG=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function kG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";const n=xG(e.getFullYear(),4),r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={YYYY:()=>n.slice(n.length-4,n.length),YY:()=>n.slice(n.length-2,n.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>r[e.getMonth()],MMM:()=>r[e.getMonth()].slice(0,3),MM:()=>xG(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${TG(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${TG(e.getDate())}`,DD:()=>xG(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>i[e.getDay()],ddd:()=>i[e.getDay()].slice(0,3),dd:()=>i[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${TG(e.getDay())}`,d:()=>`${e.getDay()}`},s=new RegExp(Object.keys(o).join("|"),"g");return t.replace(s,e=>e in o?o[e]():e)}function MG(e){if(!e)return null;const[t,n]=e.split(" ");if(!t)return null;const r=t.split("-").map(e=>parseInt(e,10));if(3!==r.filter(e=>!isNaN(e)).length)return null;const[i,o,s]=r,a=new Date(i,o-1,s);if(a.getFullYear()!==i||a.getMonth()!==o-1||a.getDate()!==s)return null;if(!n||"00:00:00"===n)return a;const[l,c,u]=n.split(":").map(e=>parseInt(e,10));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}var PG=class{constructor(e,t,n,r,i){this.alive=!0,this.context=e,this.eParent=r;t.getDateCompDetails(n).newAgStackInstance().then(t=>{this.alive?(this.dateComp=t,t&&(r.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached(),this.tempValue&&t.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled),i?.(this))):e.destroyBean(t)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){DW(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}updateParams(e){let t=!1;if(this.dateComp?.refresh&&"function"===typeof this.dateComp.refresh){null!==this.dateComp.refresh(e)&&(t=!0)}if(!t&&this.dateComp?.onParamsUpdated&&"function"===typeof this.dateComp.onParamsUpdated){null!==this.dateComp.onParamsUpdated(e)&&NH("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}},IG=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],AG=class extends fG{constructor(e,t,n){super(t,n),this.dateFilterParams=e}conditionToString(e,t){const{type:n}=e,{numberOfInputs:r}=t||{},i="inRange"==n||2===r,o=MG(e.dateFrom),s=MG(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(i){return`${null!==o?kG(o,a):"null"}-${null!==s?kG(s,a):"null"}`}return null!=o?kG(o,a):`${n}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},DG=1/0,FG=class extends nB{constructor(e,t,n,r){super(),this.columnOrGroup=e,this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=r,this.beans=n}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?VV(this.colsSpanning):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=$H(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),n=e.getOldLeft(),r=this.modifyLeftForPrintLayout(e,n),i=this.modifyLeftForPrintLayout(e,t);this.setLeft(r),this.actualLeft=i,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!iV(this.beans.gos,"print"))return t;if("left"===e.getPinned())return t;const n=this.beans.visibleColsService.getColsLeftWidth();if("right"===e.getPinned()){return n+this.beans.visibleColsService.getBodyContainerWidth()+t}return n+t}setLeft(e){if($H(e)&&(this.eCell.style.left=`${e}px`),XB(this.columnOrGroup)){const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&(t=this.ariaEl,n=e.length,pW(t,"colspan",n))}var t,n}};function OG(e,t,n,r){return UH(e)?[]:LG(e.headerClass,e,t,n,r)}function NG(e,t,n){e.addOrRemoveCssClass("ag-column-first",n.isColAtEdge(t,"first")),e.addOrRemoveCssClass("ag-column-last",n.isColAtEdge(t,"last"))}function LG(e,t,n,r,i){if(UH(e))return[];let o;if("function"===typeof e){const s=function(e,t,n,r){return t.addGridCommonParams({colDef:e,column:n,columnGroup:r})}(t,n,r,i);o=e(s)}else o=e;return"string"===typeof o?[o]:Array.isArray(o)?[...o]:[]}var _G=0,HG=class e extends nB{constructor(e,t,n){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=e,this.parentRowCtrl=n,this.beans=t,this.instanceId=e.getUniqueId()+"-"+_G++}wireBeans(e){this.pinnedWidthService=e.pinnedWidthService,this.focusService=e.focusService,this.userComponentFactory=e.userComponentFactory,this.ctrlsService=e.ctrlsService,this.dragAndDropService=e.dragAndDropService,this.menuService=e.menuService}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:n}=this.focusService.getFocusedHeader();return function(e,t,n,r){const i=r.getDefinition(),o=i&&i.suppressHeaderKeyboardEvent;return!!$H(o)&&!!o(e.addGridCommonParams({colDef:i,column:r,headerRowIndex:n,event:t}))}(this.gos,e,t,n)}getWrapperHasFocus(){return mV(this.gos)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onGuiFocus(){this.eventService.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:n,compBean:r}=e,{animationFrameService:i,resizeObserverService:o,columnModel:s,gos:a}=this.beans,l=e=>{if(!this.isAlive()||!r.isAlive())return;const{paddingTop:n,paddingBottom:o,borderBottomWidth:c,borderTopWidth:u}=NW(this.getGui()),d=n+o+c+u,h=t.offsetHeight+d;if(e<5){const n=pV(a);if(!n||!n.contains(t)||0==h)return void i.requestAnimationFrame(()=>l(e+1))}s.setColHeaderHeight(this.column,h)};let c,u=!1;const d=()=>{const e=this.column.isAutoHeaderHeight();e&&!u&&h(),!e&&u&&p()},h=()=>{u=!0,l(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),c=o.observeResize(t,()=>l(0))},p=()=>{u=!1,c&&c(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),c=void 0};d(),r.addDestroyFunc(()=>p()),r.addManagedListeners(this.column,{widthChanged:()=>u&&l(0)}),r.addManagedEventListeners({sortChanged:()=>{u&&window.setTimeout(()=>l(0))}}),n&&n(d)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:n,eGui:r}=this;e&&t&&r&&(NG(e,t,n.visibleColsService),EW(r,n.visibleColsService.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){this.resizeFeature&&e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=this.focusService.isHeaderFocusSuppressed();this.eGui&&ZW(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=mV(this.gos),n=e.key===Bz.LEFT||e.key===Bz.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey)return;if((this.isResizing||n)&&(e.preventDefault(),e.stopImmediatePropagation()),!n)return;const r=e.key===Bz.LEFT!==this.gos.get("enableRtl"),i=Aj[r?"Left":"Right"];if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const t=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(t,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(i)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e);if(this.column.getPinned()){const e=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),r=_W(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(e+n+t>r){if(!(r>e+n))return 0;t=r-e-n}}return t}getResizeDiff(e){let t=e.key===Bz.LEFT!==this.gos.get("enableRtl");const n=this.column.getPinned(),r=this.gos.get("enableRtl");return n&&r!==("right"===n)&&(t=!t),(t?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case Bz.PAGE_DOWN:case Bz.PAGE_UP:case Bz.PAGE_HOME:case Bz.PAGE_END:t&&e.preventDefault()}}addDomData(t){const n=e.DOM_DATA_KEY_HEADER_CTRL;hV(this.gos,this.eGui,n,this),t.addDestroyFunc(()=>hV(this.gos,this.eGui,n,null))}getGui(){return this.eGui}focus(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,n){const r=e??t;this.gos.get("preventDefaultOnContextMenu")&&r.preventDefault(),this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",n)}dispatchColumnMouseEvent(e,t){this.eventService.dispatchEvent({type:e,column:t})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null}};HG.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";var VG=HG,BG=class extends nB{wireBeans(e){this.columnHoverService=e.columnHoverService}constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListeners(this.element,{mouseout:this.onMouseOut.bind(this),mouseover:this.onMouseOver.bind(this)})}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};var WG="32.3.8";var zG={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},jG=["january","february","march","april","may","june","july","august","september","october","november","december"];var GG=class extends Ez{wireBeans(e){this.columnNameService=e.columnNameService}getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e?.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.optionsFactory=new oG,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const n=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(n)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:n}=t||{};return null==n||1==n}isTypeEditable(e){return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&["inRange","empty","blank","notBlank"].indexOf(e)<0}getAriaLabel(e){return`${this.columnNameService.getDisplayNameForColumn(e.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},$G=class extends nB{constructor(e){super(),this.params=e,this.eFloatingFilterTextInput=Rz,this.valueChangedListener=()=>{}}setupGui(e){this.eFloatingFilterTextInput=this.createManagedBean(new uG(this.params?.config));const t=this.eFloatingFilterTextInput.getGui();e.appendChild(t);const n=e=>this.valueChangedListener(e);this.addManagedListeners(t,{input:n,keydown:n})}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},UG=class extends GG{constructor(){super(...arguments),this.eFloatingFilterInputContainer=Rz}postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" data-ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Jj(this.params.filterParams),!this.isReadOnly()){const e=Qj(this.params.filterParams,this.getDefaultDebounceMs()),t=zH(this.syncUpWithParentFilter.bind(this),e);this.floatingFilterInputService.setValueChangedListener(t)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();jW(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===Bz.ENTER;if(this.applyActive&&!t)return;let n=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(n=CG(n),this.floatingFilterInputService.setValue(n,!0)),this.params.parentFilterInstance(e=>{e&&e.onFloatingFilterChanged(this.getLastType()||null,n||null)})}setEditable(e){this.floatingFilterInputService.setEditable(e)}},KG=class extends nB{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new hG),this.eFloatingFilterTextInput=this.createManagedBean(new uG),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),n=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(n),this.setupListeners(t,e=>this.valueChangedListener(e)),this.setupListeners(n,e=>this.valueChangedListener(e))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}};var YG={version:WG,moduleName:"@ag-grid-community/filter-core",beans:[class extends nB{constructor(){super(...arguments),this.beanName="filterManager",this.advancedFilterModelUpdateQueue=[]}wireBeans(e){this.columnModel=e.columnModel,this.dataTypeService=e.dataTypeService,this.quickFilterService=e.quickFilterService,this.advancedFilterService=e.advancedFilterService,this.columnFilterService=e.columnFilterService}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvancedFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:e=>{let{enabled:t}=e;return this.onAdvancedFilterEnabledChanged(t)},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",e=>this.setAdvancedFilterModel(e.currentValue)),this.quickFilterService&&this.addManagedListeners(this.quickFilterService,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return"function"===typeof t&&t(e)}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.isAdvancedFilterEnabled()?this.warnAdvancedFilters():this.columnFilterService?.setFilterModel(e,t)}getFilterModel(){return this.columnFilterService?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.columnFilterService?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.columnFilterService?.isAggregateFilterPresent()}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){e?this.columnFilterService?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilterService?.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){return!!this.advancedFilterService?.isEnabled()}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}resetQuickFilterCache(){this.quickFilterService?.resetQuickFilterCache()}refreshFiltersForAggregations(){yV(this.gos)&&this.onFilterChanged()}onFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{source:t,additionalEventAttributes:n,columns:r=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.columnFilterService?this.columnFilterService.updateBeforeFilterChanged(e):rj.resolve()).then(()=>{const e={source:t,type:"filterChanged",columns:r};n&&CB(e,n),this.eventService.dispatchEvent(e),this.columnFilterService?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.columnFilterService?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilterService?.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!yV(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.columnFilterService.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&(!(this.isColumnFilterPresent()&&!this.columnFilterService.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))))}isFilterActive(e){return!!this.columnFilterService?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.columnFilterService?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.columnFilterService.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.columnFilterService.createFilterParams(e,t)}isFilterAllowed(e){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.columnFilterService?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.columnFilterService?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.columnFilterService?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.columnFilterService?.areFilterCompsDifferent(e,t)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){this.isAdvancedFilterEnabled()&&(this.dataTypeService?.isPendingInference()?this.advancedFilterModelUpdateQueue.push(e):(this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})))}toggleAdvancedFilterBuilder(e,t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.hasFloatingFilters()}getFilterInstance(e,t){if(!this.isAdvancedFilterEnabled())return this.columnFilterService?.getFilterInstance(e,t);this.warnAdvancedFilters()}getColumnFilterInstance(e){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve(void 0)):this.columnFilterService?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvancedFilters(){NH("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){this.advancedFilterService?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advancedFilterModelUpdateQueue.forEach(e=>this.setAdvancedFilterModel(e)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.columnFilterService?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve()):this.columnFilterService?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,n){this.columnFilterService?.setColDefPropertiesForDataType(e,t,n)}}]},qG={version:WG,moduleName:"@ag-grid-community/filter-api",apiFunctions:{isAnyFilterPresent:function(e){return!!e.filterManager?.isAnyFilterPresent()},onFilterChanged:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e.filterManager?.onFilterChanged({source:t})}},dependantModules:[YG]},XG={version:WG,moduleName:"@ag-grid-community/column-filter",beans:[class extends nB{constructor(){super(...arguments),this.beanName="columnFilterService",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.userComponentFactory=e.userComponentFactory,this.rowRenderer=e.rowRenderer,this.dataTypeService=e.dataTypeService,this.filterManager=e.filterManager}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),rowDataUpdated:()=>this.onNewRowsLoaded("rowDataUpdated"),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(this.dataTypeService?.isPendingInference())return void this.filterModelUpdateQueue.push({model:e,source:t});const n=[],r=this.getFilterModel(!0);if(e){const t=new Set(Object.keys(e));this.allColumnFilters.forEach((r,i)=>{const o=e[i];n.push(this.setModelOnFilterWrapper(r.filterPromise,o)),t.delete(i)}),t.forEach(t=>{const r=this.columnModel.getColDefCol(t)||this.columnModel.getCol(t);if(!r)return void NH("setFilterModel() - no column found for colId: "+t);if(!r.isFilterAllowed())return void NH("setFilterModel() - unable to fully apply model, filtering disabled for colId: "+t);const i=this.getOrCreateFilterWrapper(r);i?n.push(this.setModelOnFilterWrapper(i.filterPromise,e[t])):NH("setFilterModel() - unable to fully apply model, unable to create filter for colId: "+t)})}else this.allColumnFilters.forEach(e=>{n.push(this.setModelOnFilterWrapper(e.filterPromise,null))});rj.all(n).then(()=>{const e=this.getFilterModel(!0),n=[];this.allColumnFilters.forEach((t,i)=>{JH(r?r[i]:null,e?e[i]:null)||n.push(t.column)}),n.length>0&&this.filterManager?.onFilterChanged({columns:n,source:t})})}setModelOnFilterWrapper(e,t){return new rj(n=>{e.then(e=>{"function"!==typeof e.setModel&&(NH("filter missing setModel method, which is needed for setFilterModel"),n()),(e.setModel(t)||rj.resolve()).then(()=>n())})})}getFilterModel(e){const t={},{allColumnFilters:n,initialFilterModel:r}=this;return n.forEach((e,n)=>{const r=this.getModelFromFilterWrapper(e);$H(r)&&(t[n]=r)}),e||Object.entries(r).forEach(e=>{let[r,i]=e;$H(i)&&!n.has(r)&&this.columnModel.getCol(r)?.isFilterAllowed()&&(t[r]=i)}),t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?"function"!==typeof t.getModel?(NH("filter API missing getModel method, which is needed for getFilterModel"),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){return!!this.allColumnFilters.size&&(this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"advancedFilterEnabled")),!0)}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=!!yV(this.gos),t=t=>{if(!t.isPrimary())return!0;const n=!this.columnModel.isPivotActive();return!(!t.isValueActive()||!n)&&(!!this.columnModel.isPivotMode()||e)},n=[],r=[];return this.forEachColumnFilter((e,i)=>{const o=(e=>!!e&&(e.isFilterActive?e.isFilterActive():(NH("Filter is missing isFilterActive() method"),!1)))(e);o&&(t(i.column)?n.push(e):r.push(e))}).then(()=>{this.activeAggregateFilters=n,this.activeColumnFilters=r})}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter((n,r)=>r.column.setFilterActive(n.isFilterActive(),e,t))}forEachColumnFilter(e){return rj.all(Array.from(this.allColumnFilters.values()).map(t=>t.filterPromise.then(n=>e(n,t))))}doColumnFiltersPass(e,t,n){const{data:r,aggData:i}=e,o=n?this.activeAggregateFilters:this.activeColumnFilters,s=n?i:r;for(let a=0;a<o.length;a++){const n=o[a];if(null!=n&&n!==t){if("function"!==typeof n.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!n.doesFilterPass({node:e,data:s}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const t=()=>this.filterManager?.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}updateBeforeFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{filterInstance:t,additionalEventAttributes:n}=e;return this.updateDependentFilters(),this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",n).then(()=>{this.allColumnFilters.forEach(e=>{e.filterPromise&&e.filterPromise.then(e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()})}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter(e=>{e.onNewRowsLoaded&&e.onNewRowsLoaded()}).then(()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0})).then(()=>this.updateActiveFilters())}createValueGetter(e){return t=>{let{node:n}=t;return this.valueService.getValue(e,n,!0)}}createGetValue(e){return(t,n)=>{const r=n?this.columnModel.getCol(n):e;return r?this.valueService.getValue(r,t,!0):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():null!=this.getModelFromInitialState(e)}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(HV(this.gos))t="agSetColumnFilter";else{const n=this.dataTypeService?.getBaseDataType(e);t="number"===n?"agNumberColumnFilter":"date"===n||"dateString"===n?"agDateColumnFilter":"agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(HV(this.gos))t="agSetColumnFloatingFilter";else{const n=this.dataTypeService?.getBaseDataType(e);t="number"===n?"agNumberColumnFloatingFilter":"date"===n||"dateString"===n?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const n=this.getDefaultFilter(e),r=e.getColDef();let i;const o={...this.createFilterParams(e,r),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(i,e)(),filterChangedCallback:t=>this.filterChangedCallbackFactory(i,e)(t),doesRowPassOtherFilter:e=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(i,e)},s=this.userComponentFactory.getFilterDetails(r,o,n);return s?{filterPromise:()=>{const e=s.newAgStackInstance();return null!=e&&e.then(e=>{i=e,t&&(t.filter=e)}),e},compDetails:s}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:vB(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:n,compDetails:r}=this.createFilterInstance(e,t);return t.filterPromise=n?.()??null,t.compDetails=r,t}onColumnsChanged(){const e=[];this.allColumnFilters.forEach((t,n)=>{let r;r=t.column.isPrimary()?this.columnModel.getColDefCol(n):this.columnModel.getCol(n),r&&r===t.column||(e.push(t.column),this.disposeFilterWrapper(t,"columnChanged"),this.disposeColumnListener(n))});const t=e.every(e=>"agGroupColumnFilter"===e.getColDef().filter);e.length>0&&!t?this.filterManager?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){const e=this.columnModel.getAutoCols();e?.forEach(e=>{"agGroupColumnFilter"===e.getColDef().filter&&this.getOrCreateFilterWrapper(e)})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:t}=this.allColumnFilters.get(e.getColId())??{};return!t||("function"!==typeof t?.isFilterAllowed||t.isFilterAllowed())}getFloatingFilterCompDetails(e,t){const n=t=>{const n=this.getOrCreateFilterWrapper(e)?.filterPromise;null!=n&&n.then(e=>{t(Tj(e))})},r=e.getColDef(),i={...this.createFilterParams(e,r),filterChangedCallback:()=>n(t=>this.filterChangedCallbackFactory(t,e)())},o=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(r,mj,i);let s=function(e,t,n){if(null==t)return null;let r=null;const{compName:i,jsComp:o,fwComp:s}=Ej.getCompKeys(e,t,mj);i?r={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[i]:null==o&&null==s&&!0===t.filter&&(r=n());return r}(this.frameworkOverrides,r,()=>this.getDefaultFloatingFilter(e));null==s&&(s="agReadOnlyFloatingFilter");const a={column:e,filterParams:o,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:n,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(r,a,s)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const n=e.getColId(),r=this.allColumnFilters.get(n);this.disposeColumnListener(n),delete this.initialFilterModel[n],r&&(this.disposeFilterWrapper(r,t),this.filterManager?.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then(n=>{this.destroyBean(n),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventService.dispatchEvent({type:"filterDestroyed",source:t,column:e.column})})}filterModifiedCallbackFactory(e,t){return()=>{this.eventService.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return n=>{const r={filter:e,additionalEventAttributes:n,columns:[t],source:n?.source??"columnFilter"};this.callOnFilterChangedOutsideRenderCycle(r)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const n=t.column,{compDetails:r}=n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,r))return void this.destroyFilter(n,"paramsUpdated");const i=n.getColDef().filterParams;t.filterPromise?t.filterPromise.then(e=>{const t=!e?.refresh||e.refresh({...this.createFilterParams(n,n.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(e,n),filterChangedCallback:this.filterChangedCallbackFactory(e,n),doesRowPassOtherFilter:t=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(e,t),...i});!1===t&&this.destroyFilter(n,"paramsUpdated")}):this.destroyFilter(n,"paramsUpdated")}setColumnFilterWrapper(e,t){const n=e.getColId();this.allColumnFilters.set(n,t),this.allColumnListeners.set(n,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(n)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:n}=e,{componentClass:r}=t;return!(n===r||n?.render&&r?.render&&n.render===r.render)}hasFloatingFilters(){return this.columnModel.getCols().some(e=>e.getColDef().floatingFilter)}getFilterInstance(e,t){t&&this.getFilterInstanceImpl(e).then(e=>{const n=Tj(e);t(n)})}getColumnFilterInstance(e){return new Promise(t=>{this.getFilterInstanceImpl(e).then(e=>{t(Tj(e))})})}getFilterInstanceImpl(e){const t=this.columnModel.getColDefCol(e);if(!t)return rj.resolve(void 0);const n=this.getOrCreateFilterWrapper(t)?.filterPromise;return n??rj.resolve(null)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(e=>{let{model:t,source:n}=e;return this.setFilterModel(t,n)}),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(e=>{let{key:t,model:n,resolve:r}=e;this.setColumnFilterModel(t,n).then(()=>r())}),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){if(this.dataTypeService?.isPendingInference()){let n=()=>{};const r=new Promise(e=>{n=e});return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:n}),r}const n=this.columnModel.getColDefCol(e),r=n?this.getOrCreateFilterWrapper(n):null;return r?(i=this.setModelOnFilterWrapper(r.filterPromise,t),new Promise(e=>{i.then(t=>e(t))})):Promise.resolve();var i}getFilterWrapper(e){const t=this.columnModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,n){const r=HV(this.gos),i=this.localeService.getLocaleTextFunc(),o=t=>{const{filterParams:n}=e;e.filterParams="object"===typeof n?{...n,...t}:t};switch(t.baseDataType){case"number":r&&o({comparator:(e,t)=>{const n=null==e?0:parseInt(e),r=null==t?0:parseInt(t);return n===r?0:n>r?1:-1}});break;case"boolean":o(r?{valueFormatter:e=>$H(e.value)?i(String(e.value),e.value?"True":"False"):i("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":r&&o({valueFormatter:e=>{const t=n(e);return $H(t)?t:i("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=jG[Number(e)-1];return i(t,zG[t])}return e??i("blanks","(Blanks)")}});break;case"dateString":{const e=t.dateParser;o(r?{valueFormatter:e=>{const t=n(e);return $H(t)?t:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:t=>{const n=e(t??void 0);return n?[String(n.getFullYear()),String(n.getMonth()+1),String(n.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=jG[Number(e)-1];return i(t,zG[t])}return e??i("blanks","(Blanks)")}}:{comparator:(t,n)=>{const r=e(n);return null==n||r<t?-1:r>t?1:0}});break}case"object":r?o({valueFormatter:e=>{const t=n(e);return $H(t)?t:i("blanks","(Blanks)")}}):e.filterValueGetter=e=>n({column:e.column,node:e.node,value:this.valueService.getValue(e.column,e.node)})}}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear()}}],dependantModules:[YG]},QG={version:WG,moduleName:"@ag-grid-community/column-filter-api",apiFunctions:{isColumnFilterPresent:function(e){return!!e.filterManager?.isColumnFilterPresent()||!!e.filterManager?.isAggregateFilterPresent()},getFilterInstance:function(e,t,n){return e.filterManager?.getFilterInstance(t,n)},getColumnFilterInstance:function(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)},destroyFilter:function(e,t){const n=e.columnModel.getColDefCol(t);if(n)return e.filterManager?.destroyFilter(n,"api")},setFilterModel:function(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))},getFilterModel:function(e){return e.filterManager?.getFilterModel()??{}},getColumnFilterModel:function(e,t){return e.filterManager?.getColumnFilterModel(t)??null},setColumnFilterModel:function(e,t,n){return e.filterManager?.setColumnFilterModel(t,n)??Promise.resolve()},showColumnFilter:function(e,t){const n=e.columnModel.getCol(t);n?e.menuService.showFilterMenu({column:n,containerType:"columnFilter",positionBy:"auto"}):LH(`column '${t}' not found`)}},dependantModules:[XG,qG]},JG={version:WG,moduleName:"@ag-grid-community/floating-filter-core",controllers:[{name:"headerFilterCell",classImp:class extends VG{constructor(e,t,n){super(e,t,n),this.iconCreated=!1,this.column=e}setComp(e,t,n,r,i){this.comp=e,i=uW(this,this.beans.context,i),this.eButtonShowMainFilter=n,this.eFloatingFilterBody=r,this.setGui(t,i),this.setupActive(),this.setupWidth(i),this.setupLeft(i),this.setupHover(i),this.setupFocus(i),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(i),this.setupUi(),i.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(i),i.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(i)}),i.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,n=!!e.floatingFilter;this.active=t&&n}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=Mz("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new qj(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();vW(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(mV(this.gos)===this.eGui)return;const t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();const n=this.findNextColumnWithFloatingFilter(e.shiftKey);n&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:n},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleColsService;let n=this.column;do{if(n=e?t.getColBefore(n):t.getColAfter(n),!n)break}while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case Bz.UP:case Bz.DOWN:t||e.preventDefault();case Bz.LEFT:case Bz.RIGHT:if(t)return;e.stopPropagation();case Bz.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case Bz.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&OW(e.relatedTarget,"ag-floating-filter");if(t&&n&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==Bz.TAB);if(e&&t){const t=e.shiftKey;this.focusService.focusInto(this.eGui,t)}}const r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.column)}setupHover(e){e.createManagedBean(new BG([this.column],this.eGui));const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}setupLeft(e){const t=new FG(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,n=e=>{if("filterDestroyed"===e?.source&&!this.isAlive())return;const n=this.comp.getFloatingFilterComp();n&&n.then(n=>{if(n){const r=t?.getCurrentFloatingFilterParentModel(this.column),i=e?{...e,columns:e.columns??[],source:"api"===e.source?"api":"columnFilter"}:null;n.onParentModelChanged(r,i)}})};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:n}),t?.isFilterActive(this.column)&&n(null)}setupWidth(e){const t=()=>{const e=`${this.column.getActualWidth()}px`;this.comp.setWidth(e)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const n=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const r=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,i=this.comp.getFloatingFilterComp();i&&r?i.then(t=>{!t||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,r)?this.updateCompDetails(e,r,n):this.updateFloatingFilterParams(r)}):this.updateCompDetails(e,r,n)}updateCompDetails(e,t,n){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),n&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then(e=>{let n=!1;if(e?.refresh&&"function"===typeof e.refresh){null!==e.refresh(t)&&(n=!0)}if(!n&&e?.onParamsUpdated&&"function"===typeof e.onParamsUpdated){null!==e.onParamsUpdated(t)&&NH("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}})}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}}}],dependantModules:[XG]},ZG={version:WG,moduleName:"@ag-grid-community/read-only-floating-filter",userComponents:[{name:"agReadOnlyFloatingFilter",classImp:class extends Ez{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>\n            </div>',[dG]),this.eFloatingFilterText=Rz}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),n=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${n("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){null!=e?this.params.parentFilterInstance(t=>{if(t.getModelAsString){const n=t.getModelAsString(e);this.eFloatingFilterText.setValue(n)}}):this.eFloatingFilterText.setValue("")}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}}}],dependantModules:[JG]},e$={version:WG,moduleName:"@ag-grid-community/simple-filter",dependantModules:[XG],userComponents:[{name:"agTextColumnFilter",classImp:class extends sG{constructor(){super("textFilter"),this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>null==e?null:e.toString().toLowerCase(),this.defaultMatcher=e=>{let{filterOption:t,value:n,filterText:r}=e;if(null==r)return!1;switch(t){case"contains":return n.indexOf(r)>=0;case"notContains":return n.indexOf(r)<0;case"equals":return n===r;case"notEqual":return n!=r;case"startsWith":return 0===n.indexOf(r);case"endsWith":{const e=n.lastIndexOf(r);return e>=0&&e===n.length-r.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[]}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new bG(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(NH("textCustomComparator is deprecated, use textMatcher instead."),t=>{let{filterOption:n,value:r,filterText:i}=t;return e(n,r,i)}):this.textFilterParams.textMatcher||this.defaultMatcher}createCondition(e){const t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},r=this.getValuesWithSideEffects(e,!0);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const n=[];return this.forEachPositionInput(e,(e,r,i,o)=>{if(r<o){let r=GH(e.getValue());t&&this.textFilterParams.trimInput&&(r=CG(r)??null,e.setValue(r,!0)),n.push(r)}}),n}getDefaultFilterOptions(){return wG}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),mW(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,n){const r=this.createManagedBean(new uG);r.addCssClass(`ag-filter-${n}`),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:r}=e||{};return[t||null,n||null].slice(0,this.getNumberOfInputs(r))}evaluateNullValue(e){return!!e&&["notEqual","notContains","blank"].indexOf(e)>=0}evaluateNonNullValue(e,t,n,r){const i=e.map(e=>this.formatter(e))||[],o=this.formatter(t),{api:s,colDef:a,column:l,context:c,textFormatter:u}=this.textFilterParams;if("blank"===n.type)return this.isBlank(t);if("notBlank"===n.type)return!this.isBlank(t);const d={api:s,colDef:a,column:l,context:c,node:r.node,data:r.data,filterOption:n.type,value:o,textFormatter:u};return i.some(e=>this.matcher({...d,filterText:e}))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agNumberColumnFilter",classImp:class extends aG{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern===e.allowedCharPattern&&super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:r}=e||{};return[this.processValue(t),this.processValue(n)].slice(0,this.getNumberOfInputs(r))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new mG(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return gG}setElementValue(e,t,n){const r=!n&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(t??null):t;super.setElementValue(e,r)}createValueElement(){const e=vG(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),mW(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,n,r){const i=this.createManagedBean(r?new uG({allowedCharPattern:r}):new hG);i.addCssClass(`ag-filter-${n}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const t=[];return this.forEachPositionInput(e,(e,n,r,i)=>{n<i&&t.push(this.processValue(this.stringToFloat(e.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"===typeof e)return e;let t=GH(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},r=this.getValues(e);return r.length>0&&(n.filter=r[0]),r.length>1&&(n.filterTo=r[1]),n}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{t.getInputElement().validity.valid||(e=!0)}),e}}},{name:"agDateColumnFilter",classImp:class extends aG{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=DG,this.minValidDate=null,this.maxValidDate=null}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:n,type:r}=e||{};return[t&&MG(t)||null,n&&MG(n)||null].slice(0,this.getNumberOfInputs(r))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(t,n)=>{if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?n:Number(e[t]);NH(`DateFilter ${t} is not a number`)}return n};this.minValidYear=t("minValidYear",1e3),this.maxValidYear=t("maxValidYear",DG),this.minValidYear>this.maxValidYear&&NH("DateFilter minValidYear should be <= maxValidYear"),e.minValidDate?this.minValidDate=e.minValidDate instanceof Date?e.minValidDate:MG(e.minValidDate):this.minValidDate=null,e.maxValidDate?this.maxValidDate=e.maxValidDate instanceof Date?e.maxValidDate:MG(e.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&NH("DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new AG(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new PG(this.context,this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc(()=>t.destroy()),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return IG}createValueElement(){const e=pV(this.gos).createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,n,r){const i=pV(this.gos).createElement("div");i.classList.add(`ag-filter-${r}`),i.classList.add(`ag-filter-date-${r}`),t.push(i),e.appendChild(i),n.push(this.createDateCompWrapper(i))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,n){this.removeItems(e,t,n).forEach(e=>e.destroy())}isValidDateValue(e){if(null===e)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((n,r,i,o)=>{i!==e||!t||r>=o||(t=t&&this.isValidDateValue(n.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),n={},r=this.getValues(e);return r.length>0&&(n.dateFrom=EG(r[0])),r.length>1&&(n.dateTo=EG(r[1])),{dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t,...n}}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),n=e("ariaFilterValue","Filter Value");this.forEachInput(e=>{e.setInputPlaceholder(t),e.setInputAriaLabel(n)})}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(e,n,r,i)=>{n<i&&t.push(e.getDate())}),t}translate(e){return"lessThan"===e?super.translate("before"):"greaterThan"===e?super.translate("after"):super.translate(e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agDateInput",classImp:class extends Ez{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" data-ref="eDateInput"></ag-input-text-field>\n            </div>',[dG]),this.eDateInput=Rz}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()},input:e=>{e.target===mV(this.gos)&&(this.eDateInput.isDisabled()||this.params.onDateChanged())}})}setParams(e){const t=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=n&&dz(),t.type=n?"date":"text";const{minValidYear:r,maxValidYear:i,minValidDate:o,maxValidDate:s}=e.filterParams||{};if(o&&r&&NH("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),s&&i&&NH("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),o&&s){const[e,t]=[o,s].map(e=>e instanceof Date?e:MG(e));e&&t&&e.getTime()>t.getTime()&&NH("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}o?o instanceof Date?t.min=kG(o):t.min=o:r&&(t.min=`${r}-01-01`),s?s instanceof Date?t.max=kG(s):t.max=s:i&&(t.max=`${i}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return MG(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(EG(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:function(){if(void 0===rz){const e=window;rz=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return rz}()||pz()||dz()&&hz()>=14.1}}}]},t$={version:WG,moduleName:"@ag-grid-community/simple-floating-filter",dependantModules:[e$,JG],userComponents:[{name:"agTextColumnFloatingFilter",classImp:class extends UG{init(e){super.init(e),this.filterModelFormatter=new bG(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return wG}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new $G)}}},{name:"agNumberColumnFloatingFilter",classImp:class extends UG{init(e){super.init(e),this.filterModelFormatter=new mG(this.localeService,this.optionsFactory,e.filterParams?.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){vG(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return gG}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=vG(e.filterParams),this.allowedCharPattern?this.createManagedBean(new $G({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new KG)}}},{name:"agDateColumnFloatingFilter",classImp:class extends GG{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eReadOnlyText"></ag-input-text-field>\n                <div data-ref="eDateWrapper" style="display: flex;"></div>\n            </div>',[dG]),this.eReadOnlyText=Rz,this.eDateWrapper=Rz}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}getDefaultFilterOptions(){return IG}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new AG(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const t=e;this.dateComp.setDate(MG(t.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){DW(this.eDateWrapper,e),DW(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=EG(this.dateComp.getDate());this.params.parentFilterInstance(t=>{if(t){const n=MG(e);t.onFloatingFilterChanged(this.getLastType()||null,n)}})}getDateComponentParams(){const e=Qj(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:zH(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new PG(this.context,this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}}}]},n$={version:WG,moduleName:"@ag-grid-community/quick-filter-core",beans:[class extends nB{constructor(){super(...arguments),this.beanName="quickFilterService",this.quickFilter=null,this.quickFilterParts=null}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.pivotResultColsService=e.pivotResultColsService}postConstruct(){const e=this.resetQuickFilterCache.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}refreshQuickFilterCols(){const e=this.columnModel.isPivotMode(),t=this.columnModel.getAutoCols(),n=this.columnModel.getColDefCols();let r=(e&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.pivotResultColsService.getPivotResultCols()?.list:n)??[];t&&(r=r.concat(t)),this.colsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?r:r.filter(e=>e.isVisible()||e.isRowGroupActive())}isQuickFilterPresent(){return null!==this.quickFilter}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every(n=>t?this.doesRowPassQuickFilterCache(e,n):this.doesRowPassQuickFilterNoCache(e,n))}resetQuickFilterCache(){this.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;this.quickFilterParts=e?t?t(e):e.split(" "):null}parseQuickFilter(e){return $H(e)?nV(this.gos)?e.toUpperCase():(NH("Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!==typeof e)return void NH("Grid option quickFilterText only supports string inputs, received: "+typeof e);const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),n=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,n&&(this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onQuickFilterColumnConfigChanged(){this.refreshQuickFilterCols(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassQuickFilterNoCache(e,t){return this.colsForQuickFilter.some(n=>{const r=this.getQuickFilterTextForColumn(n,e);return $H(r)&&r.indexOf(t)>=0})}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let n;e?(this.checkGenerateQuickFilterAggregateText(t),n=t.quickFilterAggregateText):n=this.getQuickFilterAggregateText(t);const{quickFilterParts:r,matcher:i}=this;return i(r,n)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let n=this.valueService.getValue(e,t,!0);const r=e.getColDef();if(r.getQuickFilterText){const i=this.gos.addGridCommonParams({value:n,node:t,data:t.data,column:e,colDef:r});n=r.getQuickFilterText(i)}return $H(n)?n.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.colsForQuickFilter.forEach(n=>{const r=this.getQuickFilterTextForColumn(n,e);$H(r)&&t.push(r)}),t.join("\n")}}],dependantModules:[YG]},r$={version:WG,moduleName:"@ag-grid-community/filter",dependantModules:[t$,ZG,{version:WG,moduleName:"@ag-grid-community/quick-filter",dependantModules:[n$,{version:WG,moduleName:"@ag-grid-community/quick-filter-api",apiFunctions:{isQuickFilterPresent:function(e){return!!e.filterManager?.isQuickFilterPresent()},getQuickFilter:function(e){return e.gos.get("quickFilterText")},resetQuickFilter:function(e){e.filterManager?.resetQuickFilterCache()}},dependantModules:[n$]}]},QG]},i$=(e=>(e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter",e))(i$||{}),o$=class extends nB{constructor(){super(...arguments),this.beanName="headerNavigationService",this.currentHeaderRowWithoutSpan=-1}wireBeans(e){this.focusService=e.focusService,this.headerPositionUtils=e.headerPositionUtils,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.visibleColService=e.visibleColsService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl});const e=pV(this.gos);this.addManagedElementListeners(e,{mousedown:()=>this.setCurrentHeaderRowWithoutSpan(-1)})}getHeaderRowCount(){return this.ctrlsService.getHeaderRowContainerCtrl()?.getRowCount()??0}getHeaderPositionForColumn(e,t){let n;if("string"===typeof e?(n=this.columnModel.getCol(e),n||(n=this.visibleColService.getColumnGroup(e))):n=e,!n)return null;const r=this.ctrlsService.getHeaderRowContainerCtrl(),i=r?.getAllCtrls(),o="filter"===VV(i||[]).getType(),s=this.getHeaderRowCount()-1;let a=-1,l=n;for(;l;)a++,l=l.getParent();let c=a;return t&&o&&c===s-1&&c++,-1===c?null:{headerRowIndex:c,column:n}}navigateVertically(e,t,n){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:r}=t,i=t.column,o=this.getHeaderRowCount(),s=0===e;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:c}=s?this.headerPositionUtils.getColumnVisibleParent(i,r):this.headerPositionUtils.getColumnVisibleChild(i,r),u=!1;return a<0&&(a=0,l=i,u=!0),a>=o?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):void 0!==c&&(this.currentHeaderRowWithoutSpan=c),!(!u&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:n})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=this.focusService.getFocusedHeader(),i=2===e,o=this.gos.get("enableRtl");let s,a;if(-1!==this.currentHeaderRowWithoutSpan?r.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=r.headerRowIndex,i!==o?(a="Before",s=this.headerPositionUtils.findHeader(r,a)):(a="After",s=this.headerPositionUtils.findHeader(r,a)),s||!t)return this.focusService.focusHeaderPosition({headerPosition:s,direction:a,fromTab:t,allowUserOverride:!0,event:n});if(t){const e=this.gos.getCallback("tabToNextHeader");if(e)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:e,headerPosition:s,direction:a})}return this.focusNextHeaderRow(r,a,n)}focusNextHeaderRow(e,t,n){const r=e.headerRowIndex;let i,o=null;if("Before"===t?r>0&&(i=r-1,this.currentHeaderRowWithoutSpan-=1,o=this.headerPositionUtils.findColAtEdgeForHeaderRow(i,"end")):(i=r+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),o=this.headerPositionUtils.findColAtEdgeForHeaderRow(i,"start")),!o)return!1;const{column:s,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(o.column,o?.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:s,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:n})}scrollToColumn(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"After";if(!e.getPinned()){if(XB(e)){const r=e.getDisplayedLeafColumns();t="Before"===n?VV(r):r[0]}else t=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(t)}}},s$=class extends nB{wireBeans(e){this.animationFrameService=e.animationFrameService,this.headerNavigationService=e.headerNavigationService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.menuService=e.menuService}setComp(e,t,n){this.comp=e,this.eGui=t,this.createManagedBean(new qj(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.onPivotModeChanged(),this.setupHeaderHeight();const r=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:r}),this.mockContextMenuForIPad(r),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>this.animationFrameService.requestAnimationFrame(()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t=0;const n=this.columnModel.getGroupRowsHeight().reduce((e,t)=>e+t,0),r=this.columnModel.getColumnHeaderRowHeight();if(this.filterManager?.hasFloatingFilters()&&(t+=e.getFloatingFiltersHeight()),t+=n,t+=r,this.headerHeight===t)return;this.headerHeight=t;const i=`${t+1}px`;this.comp.setHeightAndMinHeight(i),this.eventService.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const e=this.visibleColsService.getAllCols().some(e=>e.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),n=e.shiftKey,r=n!==t?2:3;(this.headerNavigationService.navigateHorizontally(r,!0,e)||!n&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(n,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case Bz.LEFT:t=2;case Bz.RIGHT:$H(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e)&&e.preventDefault();break;case Bz.UP:t=0;case Bz.DOWN:$H(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(mV(this.gos))||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,n){if(!e&&!n||!this.menuService.isHeaderContextMenuEnabled())return;const{target:r}=e??t;r!==this.eGui&&r!==this.ctrlsService.getHeaderRowContainerCtrl()?.getViewportElement()||this.menuService.showHeaderContextMenu(void 0,e,n)}mockContextMenuForIPad(e){if(!fz())return;const t=new Az(this.eGui);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc(()=>t.destroy())}},a$=class extends nB{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.callback=e,this.addSpacer=t}wireBeans(e){this.visibleColsService=e.visibleColsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=iV(this.gos,"print"),t=this.visibleColsService.getBodyContainerWidth(),n=this.visibleColsService.getColsLeftWidth(),r=this.visibleColsService.getDisplayedColumnsRightWidth();let i;if(e)i=t+n+r;else if(i=t,this.addSpacer){0===(this.gos.get("enableRtl")?n:r)&&this.scrollVisibleService.isVerticalScrollShowing()&&(i+=this.scrollVisibleService.getScrollbarWidth())}this.callback(i)}},l$=class extends nB{constructor(e){super(),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}wireBeans(e){this.funcColsService=e.funcColsService}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach(e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.funcColsService.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.funcColsService.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.funcColsService.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function c$(e){const{isFromHeader:t,fromLeft:n,xPosition:r,fromEnter:i,fakeEvent:o,pinned:s,gos:a,columnModel:l,columnMoveService:c,visibleColsService:u}=e;let{allMovingColumns:d}=e;if(t){const e=[];d.forEach(t=>{let n=null,r=t.getParent();for(;null!=r&&1===r.getDisplayedLeafColumns().length;)n=r,r=r.getParent();if(null!=n){(!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns()).forEach(t=>{e.includes(t)||e.push(t)})}else e.includes(t)||e.push(t)}),d=e}const h=d.slice();l.sortColsLikeCols(h);const p=function(e){const{movingCols:t,draggingRight:n,xPosition:r,pinned:i,gos:o,columnModel:s,visibleColsService:a}=e,l=o.get("suppressMovableColumns")||t.some(e=>e.getColDef().suppressMovable);if(l)return[];const c=function(e,t){switch(t){case"left":return e.getLeftCols();case"right":return e.getRightCols();default:return e.getCenterCols()}}(a,i),u=s.getCols(),d=c.filter(e=>$V(t,e)),h=c.filter(e=>!$V(t,e)),p=u.filter(e=>!$V(t,e));let g,f=0,m=r;if(n){let e=0;d.forEach(t=>e+=t.getActualWidth()),m-=e}if(m>0){for(let e=0;e<h.length;e++){if(m-=h[e].getActualWidth(),m<0)break;f++}n&&f++}if(f>0){const e=h[f-1];g=p.indexOf(e)+1}else g=p.indexOf(h[0]),-1===g&&(g=0);const v=[g],w=(e,t)=>e-t;if(n){let e=g+1;const t=u.length-1;for(;e<=t;)v.push(e),e++;v.sort(w)}else{let e=g;const t=u.length-1;let n=u[e];for(;e<=t&&c.indexOf(n)<0;)e++,v.push(e),n=u[e];e=g-1;const r=0;for(;e>=r;)v.push(e),e--;v.sort(w).reverse()}return v}({movingCols:h,draggingRight:n,xPosition:r,pinned:s,gos:a,columnModel:l,visibleColsService:u}),g=function(e,t){const n=t.getCols(),r=(s=e.map(e=>n.indexOf(e)),s.sort((e,t)=>e-t)),i=r[0],o=VV(r);var s;return o-i!==r.length-1?null:i}(h,l);if(0===p.length)return;const f=p[0];let m=null!==g&&!i;if(t&&(m=null!==g),m&&!o){if(!n&&f>=g)return;if(n&&f<=g)return}const v=u.getAllCols(),w=[];let b=null;for(let y=0;y<p.length;y++){const e=p[y],t=c.getProposedColumnOrder(h,e);if(!c.doesOrderPassRules(t))continue;const n=t.filter(e=>v.includes(e));if(null===b)b=n;else if(!BV(n,b))break;const r=d$(t);w.push({move:e,fragCount:r})}if(0===w.length)return;w.sort((e,t)=>e.fragCount-t.fragCount);const C=w[0].move;return C>l.getCols().length-d.length?void 0:{columns:d,toIndex:C}}function u$(e){const{columns:t,toIndex:n}=c$(e)||{},{finished:r,columnMoveService:i}=e;return t&&null!=n?(i.moveColumns(t,n,"uiColumnMoved",r),r?null:{columns:t,toIndex:n}):null}function d$(e){function t(e){const t=[];let n=e.getOriginalParent();for(;null!=n;)t.push(n),n=n.getOriginalParent();return t}let n=0;for(let r=0;r<e.length-1;r++){let i=t(e[r]),o=t(e[r+1]);[i,o]=i.length>o.length?[i,o]:[o,i],i.forEach(e=>{-1===o.indexOf(e)&&n++})}return n}function h$(e){const{pinned:t,fromKeyboard:n,gos:r,ctrlsService:i,useHeaderRow:o,skipScrollPadding:s}=e;let a=i.getHeaderRowContainerCtrl(t)?.getViewportElement(),{x:l}=e;return a?(n&&(l-=a.getBoundingClientRect().left),r.get("enableRtl")&&(o&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),null!=t||s||(l+=i.get("center").getCenterViewportScrollLeft()),l):0}function p$(e,t){for(const n of e)n.setMoving(t,"uiColumnMoved")}var g$=class extends nB{constructor(e){super(),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!$H(e)}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnMoveService=e.columnMoveService,this.dragAndDropService=e.dragAndDropService,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const e=this.lastDraggingEvent?.dragItem.columns??[];for(const t of e){const e=t.getPinned();if(t.getColDef().lockPinned){if(e==this.pinned)return"move"}else{if(e===this.pinned||!this.pinned)return"move";if(!e&&this.pinned)return"pinned"}}return"notAllowed"}onDragEnter(e){const t=e.dragItem.columns;if(0===e.dragSource.type)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const n=e.dragItem.visibleState,r=(t||[]).filter(e=>n[e.getId()]);this.setColumnsVisible(r,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(t,this.pinned),this.onDragging(e,!0,!0)}onDragging(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastDraggingEvent,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=this.gos.get("suppressMoveWhenColumnDragging");if(r&&!i)return void this.finishColumnMoving();if(this.lastDraggingEvent=e,!e||!r&&UH(e.hDirection))return;const{pinned:o,gos:s,ctrlsService:a}=this,l=h$({x:e.x,pinned:o,gos:s,ctrlsService:a});t||this.checkCenterForScrolling(l),i?this.handleColumnDragWhileSuppressingMovement(e,t,n,l,r):this.handleColumnDragWhileAllowingMovement(e,t,n,l,r)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,n){if(!e)return;const r=e.filter(e=>!e.getColDef().lockVisible);this.columnModel.setColsVisible(r,t,n)}finishColumnMoving(){if(this.clearHighlighted(),!this.lastMovedInfo)return;const{columns:e,toIndex:t}=this.lastMovedInfo;this.columnMoveService.moveColumns(e,t,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,n,r,i){const o=this.getAllMovingColumns(e,!0);if(i){const e=this.isAttemptingToPin(o);e&&this.attemptToPinColumns(o,void 0,!0);const{fromLeft:r,xPosition:i}=this.getNormalisedXPositionInfo(o,e)||{};if(null==r||null==i)return void this.finishColumnMoving();this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:i,fromEnter:t,fakeEvent:n,fromLeft:r})}else{if(!this.dragAndDropService.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,r)}}handleColumnDragWhileAllowingMovement(e,t,n,r,i){const o=this.getAllMovingColumns(e),s=1===this.normaliseDirection(e.hDirection),a=1===e.dragSource.type,l=u$({...this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:r,fromLeft:s,fromEnter:t,fakeEvent:n}),finished:i});l&&(this.lastMovedInfo=l)}getAllMovingColumns(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.dragSource.getDragItem();let r=null;t?(r=n.columnsInSplit,r||(r=n.columns)):r=n.columns;return r?r.filter(e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:n,xPosition:r,fromLeft:i,fromEnter:o,fakeEvent:s}=e,{pinned:a,gos:l,columnModel:c,columnMoveService:u,visibleColsService:d}=this;return{allMovingColumns:t,isFromHeader:n,fromLeft:i,xPosition:r,pinned:a,fromEnter:o,fakeEvent:s,gos:l,columnModel:c,columnMoveService:u,visibleColsService:d}}findFirstAndLastMovingColumns(e){const t=e.length;let n,r;for(let i=0;i<=t;i++){if(!n){const t=e[i];null!=t.getLeft()&&(n=t)}if(!r){const n=e[t-1-i];null!=n.getLeft()&&(r=n)}if(n&&r)break}return{firstMovingCol:n,lastMovingCol:r}}highlightHoveredColumn(e,t){const{gos:n,columnModel:r}=this,i=n.get("enableRtl"),o=r.getCols().filter(e=>e.isVisible()&&e.getPinned()===this.pinned);let s,a=null,l=null,c=null;for(const u of o){if(l=u.getActualWidth(),a=this.getNormalisedColumnLeft(u,0,i),null!=a){if(a<=t&&a+l>=t){c=u;break}}a=null,l=null}if(c)-1!==e.indexOf(c)&&(c=null);else{for(let e=o.length-1;e>=0;e--){const t=o[e],n=o[e].getParent();if(!n){c=t;break}const r=n?.getDisplayedLeafColumns();if(r.length){c=VV(r);break}}if(!c)return;a=this.getNormalisedColumnLeft(c,0,i),l=c.getActualWidth()}this.lastHighlightedColumn?.column!==c&&this.clearHighlighted(),null!=c&&null!=a&&null!=l&&(s=t-a<l/2!==i?0:1,c.setHighlighted(s),this.lastHighlightedColumn={column:c,position:s})}getNormalisedXPositionInfo(e,t){const{gos:n,visibleColsService:r}=this,i=n.get("enableRtl"),{firstMovingCol:o,column:s,position:a}=this.getColumnMoveAndTargetInfo(e,t,i);if(!o||!s||null==a)return;const l=r.getAllCols(),c=l.indexOf(o),u=l.indexOf(s),d=0===a!==i,h=c<u||c===u&&!d;let p=0;if(d?h&&(p-=1):h||(p+=1),u+p===c)return;const g=l[u+p];if(!g)return;return{fromLeft:h,xPosition:this.getNormalisedColumnLeft(g,20,i)}}getColumnMoveAndTargetInfo(e,t,n){const r=this.lastHighlightedColumn||{},{firstMovingCol:i,lastMovingCol:o}=this.findFirstAndLastMovingColumns(e);if(!i||!o||r.column||!t)return{firstMovingCol:i,...r};const s="left"===this.getPinDirection();return{firstMovingCol:i,position:s?1:0,column:s!==n?i:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0}return e}getNormalisedColumnLeft(e,t,n){const{gos:r,ctrlsService:i}=this,o=e.getLeft();if(null==o)return null;const s=e.getActualWidth();return h$({x:n?o+s-t:o+t,pinned:e.getPinned(),useHeaderRow:n,skipScrollPadding:!0,gos:r,ctrlsService:i})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,n=this.failedMoveAttempts>7;return t&&n||e.some(e=>e.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:n,fromEnter:r,fakeEvent:i,fromLeft:o}=e,s=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:n,fromLeft:o,fromEnter:r,fakeEvent:i}),{columns:a,toIndex:l}=c$(s)||{};a&&null!=l&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){this.lastHighlightedColumn&&(this.lastHighlightedColumn.column.setHighlighted(null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.ctrlsService.get("center"),n=t.getCenterViewportScrollLeft(),r=n+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<n+50,this.needToMoveLeft=e>r-50):(this.needToMoveLeft=e<n+50,this.needToMoveRight=e>r-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=n.scrollHorizontally(-e):this.needToMoveRight&&(t=n.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{if(this.failedMoveAttempts++,this.failedMoveAttempts<=8)return;if(this.dragAndDropService.getDragAndDropImageComponent()?.setIcon("pinned"),!this.gos.get("suppressMoveWhenColumnDragging")){const e=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(e,void 0,!0)}}}getPinDirection(){return this.needToMoveLeft||"left"===this.pinned?"left":this.needToMoveRight||"right"===this.pinned?"right":void 0}attemptToPinColumns(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(e||[]).filter(e=>!e.getColDef().lockPinned);return r.length?(n&&(t=this.getPinDirection()),this.columnModel.setColsPinned(r,t,"uiColumnDragged"),n&&this.dragAndDropService.nudge(),r.length):0}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}},f$=class extends nB{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(this,e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]]}}),this.moveColumnFeature=this.createManagedBean(new g$(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new l$(this.pinned)),this.dragAndDropService.addDropTarget(this),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(this))}isInterestedIn(e){return 1===e||0===e&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&0===e.dragSource.type}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},m$=class extends nB{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.pinnedWidthService=e.pinnedWidthService,this.ctrlsService=e.ctrlsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,n,r,i){super(),this.pinned=e,this.column=t,this.eResize=n,this.comp=r,this.ctrl=i}postConstruct(){const e=[];let t,n;const r=()=>{if(DW(this.eResize,t),!t)return;const r=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(r),n){const t=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.columnAutosizeService.autoSizeColumn(this.column,"uiColumnResized",t)};this.eResize.addEventListener("dblclick",n);const r=new Az(this.eResize);r.addEventListener("doubleTap",n),e.push(()=>{this.eResize.removeEventListener("dblclick",n),r.removeEventListener("doubleTap",n),r.destroy()})}},i=()=>{e.forEach(e=>e()),e.length=0},o=()=>{const e=this.column.isResizable(),o=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(e!==t||o!==n)&&(t=e,n=o,i(),r())};o(),this.addDestroyFunc(i),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){const{column:n,lastResizeAmount:r,resizeStartWidth:i}=this,o=this.normaliseResizeAmount(t),s=[{key:n,newWidth:i+o}];if(this.column.getPinned()){if(this.pinnedWidthService.getPinnedLeftWidth()+this.pinnedWidthService.getPinnedRightWidth()+(o-r)>_W(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50)return}this.lastResizeAmount=o,this.columnSizeService.setColumnWidths(s,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const n="left"!==this.pinned,r="right"===this.pinned;return this.gos.get("enableRtl")?n&&(t*=-1):r&&(t*=-1),t}},v$=class extends nB{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(mV(this.gos))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new Gz),this.cbSelectAll.addCssClass("ag-header-select-all"),mW(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:this.onNewColumnsLoaded.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedListeners(this.cbSelectAll,{fieldValueChanged:this.onCbSelectAll.bind(this)}),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${n} (${t})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(e("ariaHeaderSelection","Column with Header Selection")),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return!!NV(this.gos)||(NH(`${e} is only available if using 'multiRow' selection mode.`),!1)}checkRightRowModelType(e){return!(!nV(this.gos)&&!rV(this.gos))||(NH(`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${this.rowModel.getType()}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),n=this.isCurrentPageOnly();let r="uiSelectAll";n?r="uiSelectAllCurrentPage":t&&(r="uiSelectAllFiltered");const i={source:r,justFiltered:t,justCurrentPage:n};e?this.selectionService.selectAllRowNodes(i):this.selectionService.deselectAllRowNodes(i)}isCheckboxSelection(){const e=this.gos.get("rowSelection"),t="object"===typeof e&&MV(e)&&hB(this.column),n=this.column.getColDef().headerCheckboxSelection;let r=!1;return r=!!t||("function"===typeof n?n(this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()})):!!n),r&&this.checkRightRowModelType(t?"headerCheckbox":"headerCheckboxSelection")&&this.checkSelectionType(t?"headerCheckbox":"headerCheckboxSelection")}isFilteredOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"filtered"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"currentPage"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},w$=class extends VG{constructor(e,t,n){super(e,t,n),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,n,r,i){this.comp=e,i=uW(this,this.beans.context,i),this.setGui(t,i),this.updateState(),this.setupWidth(i),this.setupMovingCss(i),this.setupMenuClass(i),this.setupSortableClass(i),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:r,checkMeasuringCallback:e=>this.setRefreshFunction("measuring",e),compBean:i}),this.addColumnHoverListener(i),this.setupFilterClass(i),this.setupClassesFromColDef(),this.setupTooltip(i),this.addActiveHeaderMouseListeners(i),this.setupSelectAll(i),this.setupUserComp(i),this.refreshAria(),this.resizeFeature=i.createManagedBean(new m$(this.getPinned(),this.column,n,e,this)),i.createManagedBean(new BG([this.column],t)),i.createManagedBean(new FG(this.column,t,this.beans)),i.createManagedBean(new qj(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(i),i.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],()=>this.refresh(i)),i.addManagedListeners(this.column,{colDefChanged:()=>this.refresh(i)}),i.addManagedListeners(this.column,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const o=()=>this.checkDisplayName(i);i.addManagedEventListeners({columnValueChanged:o,columnRowGroupChanged:o,columnPivotChanged:o,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),i.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){if(!this.column.isResizable())return;const n=this.column.getActualWidth(),r=this.column.getMinWidth(),i=this.column.getMaxWidth(),o=Math.min(Math.max(n+e,r),i);this.beans.columnSizeService.setColumnWidths([{key:this.column,newWidth:o}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,beans:n,column:r,ctrlsService:i}=this,{gos:o,columnModel:s,columnMoveService:a,visibleColsService:l}=n,c=this.getPinned(),u=t.getBoundingClientRect().left,d=r.getActualWidth(),h=h$({x:0===e!==o.get("enableRtl")?u-20:u+d+20,pinned:c,fromKeyboard:!0,gos:o,ctrlsService:i}),p=this.focusService.getFocusedHeader();u$({allMovingColumns:[r],isFromHeader:!0,fromLeft:1===e,xPosition:h,pinned:c,fromEnter:!1,fakeEvent:!1,gos:o,columnModel:s,columnMoveService:a,visibleColsService:l,finished:!0}),i.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!p||this.restoreFocus(p)}restoreFocus(e){this.focusService.focusHeaderPosition({headerPosition:{...e,column:this.column}})}setupUserComp(e){const t=this.lookupUserCompDetails(e);this.setCompDetails(t)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(e){const t=this.createParams(e),n=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(n,t)}createParams(e){const t=this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:e=>{this.menuService.showColumnMenu({column:this.column,buttonElement:e,positionBy:"button"})},showColumnMenuAfterMouseClick:e=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:e,positionBy:"mouse"})},showFilter:e=>{this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"columnFilter",positionBy:"button"})},progressSort:e=>{this.beans.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,t)=>{this.beans.sortController.setSortForColumn(this.column,e,!!t,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,n)=>{this.setupTooltip(e,t,n)}});return t}setupSelectAll(e){this.selectAllFeature=e.createManagedBean(new v$(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===Bz.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===Bz.ENTER&&this.onEnterKeyDown(e),e.key===Bz.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const n=this.comp.getUserCompInstance();n&&n instanceof Lz&&n.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t,n){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r="whenTruncated"===this.gos.get("tooltipShowMode"),i=this.eGui,o=this.column.getColDef();n||!r||o.headerComponent||(n=()=>{const e=i.querySelector(".ag-header-cell-text");return!e||e.scrollWidth>e.clientWidth});const s={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>i,getLocation:()=>"header",getTooltipValue:()=>{if(null!=t)return t;return this.column.getColDef().headerTooltip},shouldDisplayTooltip:n},a=e.createManagedBean(new Sz(s));this.setRefreshFunction("tooltip",()=>a.refreshToolTip())}setupClassesFromColDef(){const e=()=>{const e=OG(this.column.getColDef(),this.gos,this.column,null),t=this.userHeaderClasses;this.userHeaderClasses=new Set(e),e.forEach(e=>{t.has(e)?t.delete(e):this.comp.addOrRemoveCssClass(e,!0)}),t.forEach(e=>this.comp.addOrRemoveCssClass(e,!1))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:n,displayName:r,dragAndDropService:i,gos:o}=this,{columnModel:s}=n;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(t),dragItemName:r,onDragStarted:()=>{a=!o.get("suppressDragLeaveHidesColumns"),p$([t],!0)},onDragStopped:()=>p$([t],!1),onDragCancelled:()=>p$([t],!1),onGridEnter:e=>{if(a){const t=e?.columns?.filter(e=>!e.getColDef().lockVisible)||[];s.setColsVisible(t,!0,"uiColumnMoved")}},onGridExit:e=>{if(a){const t=e?.columns?.filter(e=>!e.getColDef().lockVisible)||[];s.setColsVisible(t,!1,"uiColumnMoved")}}};i.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(e){this.updateState(),this.refreshHeaderComp(e),this.refreshAria(),Object.values(this.refreshFunctions).forEach(e=>e())}refreshHeaderComp(e){const t=this.lookupUserCompDetails(e);!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass)&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.beans.columnNameService.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(e){this.displayName!==this.calculateDisplayName()&&this.refresh(e)}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const e=this.column.getActualWidth();this.comp.setWidth(`${e}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const e=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",e),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=0===e,n=1===e;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",n)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:n,beans:r}=this,i=this.beans.columnModel.getGroupRowsHeight(),o=0===i.reduce((e,t)=>e+t,0);if(n.addOrRemoveCssClass("ag-header-parent-hidden",o),!t.isSpanHeaderHeight())return e.style.removeProperty("top"),e.style.removeProperty("height"),n.addOrRemoveCssClass("ag-header-span-height",!1),void n.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents:s,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();n.addOrRemoveCssClass("ag-header-span-height",s>0);const{columnModel:l}=r,c=l.getColumnHeaderRowHeight();if(0===s)return n.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",`${c}px`);n.addOrRemoveCssClass("ag-header-span-total",a);let u=0;for(let d=0;d<s;d++)u+=i[i.length-1-d];e.style.setProperty("top",-u+"px"),e.style.setProperty("height",`${c+u}px`)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(function(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(mV(this.beans.gos)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort((e,t)=>"filter"===e?-1:t.charCodeAt(0)-e.charCodeAt(0)).map(e=>this.ariaDescriptionProperties.get(e)).join(". ");this.beans.ariaAnnouncementService.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column)})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof Lz?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy()}},b$=class extends nB{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.autoWidthCalculator=e.autoWidthCalculator,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,n,r){super(),this.eResize=t,this.comp=e,this.pinned=n,this.columnGroup=r}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const e=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const t=[];this.columnGroup.getDisplayedLeafColumns().forEach(e=>{e.getColDef().suppressAutoSize||t.push(e.getColId())}),t.length>0&&this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uiColumnResized";const r=this.normaliseDragChange(t),i=this.resizeStartWidth+r;this.resizeColumnsFromLocalValues(i,n,e)}getInitialValues(e){const t=this.getColumnsToResize(),n=this.getInitialSizeOfColumns(t),r={columnsToResize:t,resizeStartWidth:n,resizeRatios:this.getSizeRatiosOfColumns(t,n)};let i=null;if(e&&(i=this.visibleColsService.getGroupAtDirection(this.columnGroup,"After")),i){const e=i.getDisplayedLeafColumns(),t=r.groupAfterColumns=e.filter(e=>e.isResizable()),n=r.groupAfterStartWidth=this.getInitialSizeOfColumns(t);r.groupAfterRatios=this.getSizeRatiosOfColumns(t,n)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:n,resizeRatios:r,groupAfterColumns:i,groupAfterStartWidth:o,groupAfterRatios:s}=e;this.resizeCols=t,this.resizeStartWidth=n,this.resizeRatios=r,this.resizeTakeFromCols=i,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=s}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),n=this.getInitialValues();t>n.resizeStartWidth&&this.resizeColumns(n,t,e,!0)}resizeColumnsFromLocalValues(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.resizeCols||!this.resizeRatios)return;const r={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols??void 0,groupAfterStartWidth:this.resizeTakeFromStartWidth??void 0,groupAfterRatios:this.resizeTakeFromRatios??void 0};this.resizeColumns(r,e,t,n)}resizeColumns(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{columnsToResize:i,resizeStartWidth:o,resizeRatios:s,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:i,ratios:s,width:t}),a){const e=t-o;u.push({columns:a,ratios:c,width:l-e})}this.columnSizeService.resizeColumnSets({resizeSets:u,finished:r,source:n}),r&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(e=>e.isResizable())}getInitialSizeOfColumns(e){return e.reduce((e,t)=>e+t.getActualWidth(),0)}getSizeRatiosOfColumns(e,t){return e.map(e=>e.getActualWidth()/t)}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}},C$=class extends nB{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}},y$=class extends VG{constructor(e,t,n){super(e,t,n),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const e=this.getGui();this.setDragSource(e)}},this.column=e}setComp(e,t,n,r,i){this.comp=e,i=uW(this,this.beans.context,i),this.setGui(t,i),this.displayName=this.beans.columnNameService.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(i),this.setupExpandable(i),this.setupTooltip(i),this.setupAutoHeight({wrapperElement:r,compBean:i}),this.setupUserComp(i),this.addHeaderMouseListeners(i),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const o=this.getParentRowCtrl().getPinned(),s=this.column.getProvidedColumnGroup().getLeafColumns();i.createManagedBean(new BG(s,t)),i.createManagedBean(new FG(this.column,t,this.beans)),i.createManagedBean(new C$(e,this.column)),this.resizeFeature=i.createManagedBean(new b$(e,n,o,this.column)),i.createManagedBean(new qj(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(i,s),i.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(i),i.addDestroyFunc(()=>this.clearComponent())}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,n=e.get("groupHeaderHeight");null!=n?0===n?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(n):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const n of t)e.addManagedListeners(n,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,n)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),n=t[0]===e,r=VV(t)===e;if(!n&&!r)return;const i=e.getHighlighted();let o=!1,s=!1;if(!!this.getParentRowCtrl().findHeaderCellCtrl(e=>e.getColumnGroupChild().isMoving())){const e=this.beans.gos.get("enableRtl"),t=1===i,a=0===i;n&&(e?s=t:o=a),r&&(e?o=a:s=t)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",o),this.comp.addOrRemoveCssClass("ag-header-highlight-after",s)}getColumn(){return this.column}resizeHeader(e,t){if(!this.resizeFeature)return;const n=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:n,column:r,ctrlsService:i}=this,{gos:o,columnModel:s,columnMoveService:a,visibleColsService:l}=t,c=o.get("enableRtl"),u=0===e,d=this.getPinned(),h=n.getBoundingClientRect(),p=h.left,g=h.width,f=h$({x:u!==c?p-20:p+g+20,pinned:d,fromKeyboard:!0,gos:o,ctrlsService:i}),m=r.getGroupId(),v=this.focusService.getFocusedHeader();u$({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,fromLeft:1===e,xPosition:f,pinned:d,fromEnter:!1,fakeEvent:!1,gos:o,columnModel:s,columnMoveService:a,visibleColsService:l,finished:!0});const w=r.getDisplayedLeafColumns(),b=u?w[0]:VV(w);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(b,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!v||this.restoreFocus(m,r,v)}restoreFocus(e,t,n){const r=t.getLeafColumns();if(!r.length)return;const i=r[0].getParent();if(!i)return;const o=this.findGroupWidthId(i,e);o&&this.focusService.focusHeaderPosition({headerPosition:{...n,column:o}})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(e){const t=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:e=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),e,"gridInitializing")},setTooltip:(t,n)=>{this.setupTooltip(e,t,n)}}),n=this.userComponentFactory.getHeaderGroupCompDetails(t);this.comp.setUserCompDetails(n)}addHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column.getProvidedColumnGroup())})}handleMouseOverChange(e){this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t,n){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r=this.column.getColGroupDef(),i="whenTruncated"===this.gos.get("tooltipShowMode"),o=this.eGui;n||!i||r?.headerGroupComponent||(n=()=>{const e=o.querySelector(".ag-header-group-text");return!e||e.scrollWidth>e.clientWidth});const s={getColumn:()=>this.column,getGui:()=>o,getLocation:()=>"headerGroup",getTooltipValue:()=>t??(r&&r.headerTooltip),shouldDisplayTooltip:n};r&&(s.getColDef=()=>r),e.createManagedBean(new Sz(s))}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const n=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:n,expandableChanged:n})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=OG(e,this.gos,null,this.column);if(this.column.isPadding()){t.push("ag-header-group-cell-no-group");this.column.getLeafColumns().every(e=>e.isSpanHeaderHeight())&&t.push("ag-header-span-height")}else t.push("ag-header-group-cell-with-group"),e?.wrapHeaderText&&t.push("ag-header-cell-wrap-text");t.forEach(e=>this.comp.addOrRemoveCssClass(e,!0))}setupMovingCss(e){const t=this.column.getProvidedColumnGroup().getLeafColumns(),n=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach(t=>{e.addManagedListeners(t,{movingChanged:n})}),n()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===Bz.ENTER){const e=this.column,t=!e.isExpanded();this.beans.columnModel.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving())return;if(this.removeDragSource(),!e)return;const{beans:t,column:n,displayName:r,gos:i,dragAndDropService:o}=this,{columnModel:s}=t,a=n.getProvidedColumnGroup().getLeafColumns();let l=!i.get("suppressDragLeaveHidesColumns");const c=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?"hide":"notAllowed",dragItemName:r,getDragItem:()=>this.getDragItemForGroup(n),onDragStarted:()=>{l=!i.get("suppressDragLeaveHidesColumns"),p$(a,!0)},onDragStopped:()=>p$(a,!1),onDragCancelled:()=>p$(a,!1),onGridEnter:e=>{if(l){const{columns:t=[],visibleState:n}=e??{},r=t.filter(e=>!e.getColDef().lockVisible&&(!n||n[e.getColId()]));s.setColsVisible(r,!0,"uiColumnMoved")}},onGridExit:e=>{if(l){const t=e?.columns?.filter(e=>!e.getColDef().lockVisible)||[];s.setColsVisible(t,!1,"uiColumnMoved")}}};o.addDragSource(c,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),n={};t.forEach(e=>n[e.getId()]=e.isVisible());const r=[];this.beans.visibleColsService.getAllCols().forEach(e=>{t.indexOf(e)>=0&&(r.push(e),zV(t,e))}),t.forEach(e=>r.push(e));const i=[],o=e.getLeafColumns();for(const s of r)-1!==o.indexOf(s)&&i.push(s);return{columns:r,columnsInSplit:i,visibleState:n}}isSuppressMoving(){let e=!1;this.column.getLeafColumns().forEach(t=>{(t.getColDef().suppressMovable||t.getColDef().lockPosition)&&(e=!0)});return e||this.gos.get("suppressMovableColumns")}destroy(){super.destroy()}},S$=0,x$=class extends nB{constructor(e,t,n){super(),this.instanceId=S$++,this.rowIndex=e,this.pinned=t,this.type=n;const r="group"==n?"ag-header-row-column-group":"filter"==n?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${r}`}wireBeans(e){this.beans=e}postConstruct(){this.isPrintLayout=iV(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return!!this.comp&&this.getHeaderCellCtrls().every(e=>null!=e.getGui())}setComp(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.comp=e,t=uW(this,this.beans.context,t),n&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this);e.addManagedEventListeners({columnResized:this.onColumnResized.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:e=>this.onVirtualColumnsChanged(e.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),e.addManagedPropertyListener("ensureDomOrder",e=>this.isEnsureDomOrder=e.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}getHeaderCellCtrl(e){if(this.headerCellCtrls)return eV(this.headerCellCtrls).find(t=>t.getColumnGroupChild()===e)}onDisplayedColumnsChanged(){this.isPrintLayout=iV(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleColsService:e}=this.beans;if(this.isPrintLayout){return null!=this.pinned?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null)}return e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans,n=[],r=e.getGroupRowsHeight(),i=e.getColumnHeaderRowHeight();n.push(...r),n.push(i),t?.hasFloatingFilters()&&n.push(e.getFloatingFiltersHeight());let o=0;for(let s=0;s<this.rowIndex;s++)o+=n[s];return{topOffset:o,rowHeight:n[this.rowIndex]}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getHeaderCtrls(),n=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,n,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const r of t)this.recycleAndCreateHeaderCtrls(r,e);const n=e=>{const{focusService:t,visibleColsService:n}=this.beans;if(!t.isHeaderWrapperFocused(e))return!1;return n.isVisible(e.getColumnGroupChild())};if(e)for(const[r,i]of e){n(i)?this.headerCellCtrls.set(r,i):this.destroyBean(i)}return this.getHeaderCellCtrls()}getHeaderCellCtrls(){return Array.from(this.headerCellCtrls?.values()??[])}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls)return;if(e.isEmptyGroup())return;const n=e.getUniqueId();let r;t&&(r=t.get(n),t.delete(n));if(r&&r.getColumnGroupChild()!=e&&(this.destroyBean(r),r=void 0),null==r)switch(this.type){case"filter":r=this.createBean(this.beans.ctrlsFactory.getInstance("headerFilterCell",e,this.beans,this));break;case"group":r=this.createBean(new y$(e,this.beans,this));break;default:r=this.createBean(new w$(e,this.beans,this))}this.headerCellCtrls.set(n,r)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let e=[];const t=this.getActualDepth(),{columnViewportService:n}=this.beans;return["left",null,"right"].forEach(r=>{const i=n.getHeadersToRender(r,t);e=e.concat(i)}),e}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnViewportService.getHeadersToRender(this.pinned,this.getActualDepth())}findHeaderCellCtrl(e){if(!this.headerCellCtrls)return;const t=this.getHeaderCellCtrls();let n;return n="function"===typeof e?t.find(e):t.find(t=>t.getColumnGroupChild()==e),n}focusHeader(e,t){const n=this.findHeaderCellCtrl(e);if(!n)return!1;return n.focus(t)}destroy(){this.headerCellCtrls?.forEach(e=>{this.destroyBean(e)}),this.headerCellCtrls=void 0,super.destroy()}},R$=class extends nB{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}wireBeans(e){this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.focusService=e.focusService,this.filterManager=e.filterManager}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport);const n=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:n,advancedFilterEnabledChanged:n});const r=`${"string"===typeof this.pinned?this.pinned:"center"}Header`;this.ctrlsService.register(r,this),this.columnModel.isReady()&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new uz,n=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const e=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let n=0;n<e;n++){const e=this.createBean(new x$(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(e)}})(),(()=>{const n=t.next(),r=!this.hidden&&(null==this.columnsRowCtrl||!e||this.columnsRowCtrl.getRowIndex()!==n);(r||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),r&&(this.columnsRowCtrl=this.createBean(new x$(n,this.pinned,"column")))})(),(()=>{this.includeFloatingFilter=!!this.filterManager?.hasFloatingFilters()&&!this.hidden;const n=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void n();const r=t.next();if(this.filtersRowCtrl){const t=this.filtersRowCtrl.getRowIndex()!==r;e&&!t||n()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new x$(r,this.pinned,"filter")))})();const r=this.getAllCtrls();this.comp.setCtrls(r),this.restoreFocusOnHeader(n)}getHeaderCtrlForColumn(e){if(TB(e))return this.columnsRowCtrl?.getHeaderCellCtrl(e);if(0!==this.groupsRowCtrls.length)for(let t=0;t<this.groupsRowCtrls.length;t++){const n=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(n)return n}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const t=this.getAllCtrls()[e];return t?t.getType():void 0}focusHeader(e,t,n){const r=this.getAllCtrls()[e];return!!r&&r.focusHeader(t,n)}getViewportElement(){return this.eViewport}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}setupDragAndDrop(e){const t=new f$(this.pinned,e);this.createManagedBean(t)}restoreFocusOnHeader(e){if(!e)return;const{column:t}=e;t.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.filterManager?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new a$(e=>this.comp.setCenterWidth(`${e}px`),!0))}setupPinnedWidth(){if(null==this.pinned)return;const e="left"===this.pinned,t="right"===this.pinned;this.hidden=!0;const n=()=>{const n=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==n)return;const r=0==n,i=this.hidden!==r,o=this.gos.get("enableRtl"),s=this.scrollVisibleService.getScrollbarWidth(),a=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?n+s:n;this.comp.setPinnedContainerWidth(`${a}px`),this.comp.setDisplayed(!r),i&&(this.hidden=r,this.refresh())};this.addManagedEventListeners({leftPinnedWidthChanged:n,rightPinnedWidthChanged:n,scrollVisibilityChanged:n,scrollbarWidthChanged:n})}},E$=class extends nB{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},n=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(n,t)}getDomLayout(){const e=this.gos.get("domLayout")??"normal";return-1===["normal","print","autoHeight"].indexOf(e)?(NH(`${e} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):e}},T$=class extends Ez{constructor(){super('\n            <div class="ag-overlay" role="presentation">\n                <div class="ag-overlay-panel" role="presentation">\n                    <div class="ag-overlay-wrapper" data-ref="eOverlayWrapper" role="presentation"></div>\n                </div>\n            </div>'),this.eOverlayWrapper=Rz,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeOverlayWrapperCssClass=null,this.elToFocusAfter=null}wireBeans(e){this.overlayService=e.overlayService,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}handleKeyDown(e){if(e.key!==Bz.TAB||e.defaultPrevented||JV(e))return;if(this.focusService.findNextFocusableElement(this.eOverlayWrapper,!1,e.shiftKey))return;let t=!1;t=e.shiftKey?this.focusService.focusGridView(VV(this.visibleColsService.getAllCols()),!0,!1):this.focusService.focusNextGridCoreContainer(!1),t&&e.preventDefault()}updateLayoutClasses(e,t){const n=this.eOverlayWrapper.classList;n.toggle("ag-layout-auto-height",t.autoHeight),n.toggle("ag-layout-normal",t.normal),n.toggle("ag-layout-print",t.print)}postConstruct(){this.createManagedBean(new E$(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&t.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,t.toggle(e,!0)}showOverlay(e,t,n,r){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),n&&this.focusService.isGridFocused()){const e=mV(this.gos);e&&!vV(this.gos)&&(this.elToFocusAfter=e)}e.then(t=>{if(this.activePromise!==e)return void(this.activeOverlay!==t&&(this.destroyBean(t),t=null));if(this.activePromise=null,!t)return;if(this.activeOverlay!==t&&(this.eOverlayWrapper.appendChild(t.getGui()),this.activeOverlay=t,r)){const e=t;this.updateListenerDestroyFunc=this.addManagedPropertyListener(r,t=>{let{currentValue:n}=t;e.refresh?.(this.gos.addGridCommonParams({...n??{}}))})}const i=this.focusService;n&&i.isGridFocused()&&i.focusInto(this.eOverlayWrapper)})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.focusService.isGridFocused()&&(t=null);const n=this.updateListenerDestroyFunc;n&&(n(),this.updateListenerDestroyFunc=null),this.destroyBean(e),jW(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.overlayService.setOverlayWrapperComp(void 0),super.destroy()}},k$=class extends Ez{constructor(e,t){super(),this.direction=t,this.eViewport=Rz,this.eContainer=Rz,this.hideTimeout=null,this.setTemplate(e)}wireBeans(e){this.animationFrameService=e.animationFrameService}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",gz()||fz())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=bz(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),n=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:n,touchend:n})}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)}})}attemptSettingScrollPosition(e){const t=this.getViewportElement();!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3?arguments[3]:void 0;const i=(new Date).getTime();let o=null,s=!1;const a=()=>{const a=(new Date).getTime()-i>n;(e()||a)&&(t(),s=!0,null!=o&&(window.clearInterval(o),o=null),a&&r&&NH(r))};a(),s||(o=window.setInterval(a,10))}(()=>UW(t),()=>this.setScrollPosition(e),100)}getViewportElement(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}},M$=class extends k${constructor(){super('<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" data-ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" data-ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" data-ref="eRightSpacer"></div>\n        </div>',"horizontal"),this.eLeftSpacer=Rz,this.eRightSpacer=Rz}wireBeans(e){super.wireBeans(e),this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new a$(e=>this.eContainer.style.width=`${e}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.visibleColsService.getDisplayedColumnsRightWidth();const n=!this.enableRtl&&e,r=this.scrollVisibleService.getScrollbarWidth();n&&(t+=r),qW(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=r);let i=this.visibleColsService.getColsLeftWidth();this.enableRtl&&e&&(i+=r),qW(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=r)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,n=this.gos.get("suppressHorizontalScroll"),r=e&&this.scrollVisibleService.getScrollbarWidth()||0,i=n?0:0===r&&t?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),XW(this.getGui(),i),XW(this.eViewport,i),XW(this.eContainer,i),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return WW(this.getViewportElement(),this.enableRtl)}setScrollPosition(e){UW(this.getViewportElement())||this.attemptSettingScrollPosition(e),zW(this.getViewportElement(),e,this.enableRtl)}},P$=class extends nB{wireBeans(e){this.maxDivHeightScaler=e.rowContainerHeightService}constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this)})}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}},I$=class extends k${wireBeans(e){super.wireBeans(e),this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}constructor(){super('<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" data-ref="eContainer"></div>\n            </div>\n        </div>',"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new P$(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this)})}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,n=e&&this.scrollVisibleService.getScrollbarWidth()||0,r=0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),qW(this.getGui(),r),qW(this.eViewport,r),qW(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,t=e.getGridBodyCtrl().getBodyViewportElement(),n=this.getScrollPosition(),r=t.scrollTop;n!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.getViewportElement().scrollTop}setScrollPosition(e,t){t||UW(this.getViewportElement())||this.attemptSettingScrollPosition(e),this.getViewportElement().scrollTop=e}},A$=(e=>(e.FakeHScrollbar="fakeHScrollComp",e.Header="centerHeader",e.PinnedTop="topCenter",e.PinnedBottom="bottomCenter",e.StickyTop="stickyTopCenter",e.StickyBottom="stickyBottomCenter",e))(A$||{}),D$=class extends nB{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=zH(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=zH(()=>this.lastScrollSource[0]=null,500)}wireBeans(e){this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.rowModel=e.rowModel,this.heightScaler=e.rowContainerHeightService,this.rowRenderer=e.rowRenderer,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)}),this.ctrlsService.whenReady(this,e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.getViewportElement(),{scroll:this.onHScroll.bind(this,"Viewport")});for(const e of Object.values(A$)){const t=this.ctrlsService.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsService.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),n=t?zH(this.onVScroll.bind(this,"Viewport"),100):this.onVScroll.bind(this,"Viewport"),r=t?zH(this.onVScroll.bind(this,"fakeVScrollComp"),100):this.onVScroll.bind(this,"fakeVScrollComp");this.addManagedElementListeners(this.eBodyViewport,{scroll:n}),this.registerScrollPartner(e,r)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){null==this.centerRowsCtrl||(void 0===e&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...Object.values(A$),"Viewport"]){if(this.lastScrollSource[1]===t)continue;zW(this.getViewportForSource(t),e,this.enableRtl)}}getViewportForSource(e){return"Viewport"===e?this.centerRowsCtrl.getViewportElement():this.ctrlsService.get(e).getViewportElement()}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(0===t?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:n}=t;if(this.shouldBlockScrollUpdate(1,n,!0))return;const r=WW(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(r),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;t="Viewport"===e?this.eBodyViewport.scrollTop:this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,"Viewport"===e?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:1===e?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{this.eventService.dispatchEvent({...t,type:"bodyScrollEnd"})},100)}shouldBlockScrollUpdate(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&!fz())&&(0===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=LW(this.eBodyViewport),{scrollHeight:n}=this.eBodyViewport;return e<0||e+t>n}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:n}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>n}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll("Viewport")}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(e=this.enableRtl?e>0?0:n:Math.min(Math.max(e,0),n)),zW(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight;return{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.rowModel.getRowCount();let r=-1;for(let i=0;i<n;i++){const t=this.rowModel.getRow(i);if("function"===typeof e){if(t&&e(t)){r=i;break}}else if(e===t||e===t.data){r=i;break}}r>=0&&this.ensureIndexVisible(r,t)}ensureIndexVisible(e,t){if(iV(this.gos,"print"))return;const n=this.rowModel.getRowCount();if("number"!==typeof e||e<0||e>=n)return void NH("Invalid row index for ensureIndexVisible: "+e);const r=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{r||this.paginationService?.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),i=n.getStickyTopHeight(),o=n.getStickyBottomHeight(),s=this.rowModel.getRow(e);let a;do{const e=s.rowTop,n=s.rowHeight,r=this.pageBoundsService.getPixelOffset(),l=s.rowTop-r,c=l+s.rowHeight,u=this.getVScrollPosition(),d=this.heightScaler.getDivStretchOffset(),h=u.top+d,p=u.bottom+d,g=p-h,f=this.heightScaler.getScrollPositionForPixel(l),m=this.heightScaler.getScrollPositionForPixel(c-g),v=Math.min((f+m)/2,l);let w=null;"top"===t?w=f:"bottom"===t?w=m:"middle"===t?w=v:h+i>l?w=f-i:p-o<c&&(w=m+o),null!==w&&(this.setVerticalScrollPosition(w),this.rowRenderer.redraw({afterScroll:!0})),a=e!==s.rowTop||n!==s.rowHeight}while(a);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const n=this.columnModel.getCol(e);if(!n)return;if(n.isPinned())return;if(!this.visibleColsService.isColDisplayed(n))return;const r=this.getPositionedHorizontalScroll(n,t);this.getFrameworkOverrides().wrapIncoming(()=>{null!==r&&this.centerRowsCtrl.setCenterViewportScrollLeft(r),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:n,columnAfterEnd:r}=this.isColumnOutsideViewport(e),i=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),s=this.enableRtl;let a=(s?n:r)||i,l=s?r:n;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:n,colRight:r}=this.getColumnBounds(e);return c?n-o/2:a?s?r:t:s?t-o:r-o}return null}isColumnOutsideViewport(e){const{start:t,end:n}=this.getViewportBounds(),{colLeft:r,colRight:i}=this.getColumnBounds(e),o=this.enableRtl;return{columnBeforeStart:o?t>i:n<i,columnAfterEnd:o?n<r:t>r}}getColumnBounds(e){const t=this.enableRtl,n=this.visibleColsService.getBodyContainerWidth(),r=e.getActualWidth(),i=e.getLeft(),o=t?-1:1,s=t?n-i:i;return{colLeft:s,colMiddle:s+r/2*o,colRight:s+r*o}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}},F$=class extends nB{wireBeans(e){this.animationFrameService=e.animationFrameService,this.ctrlsService=e.ctrlsService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.columnViewportService=e.columnViewportService}constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const e=()=>{this.animationFrameService.requestAnimationFrame(()=>{this.onCenterViewportResized()})};this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleService.onCentreViewportResized(),this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnSizeService.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=_W(this.gridBodyCtrl.getBodyViewportElement());if(e<=50)return;let t=this.getPinnedColumnsOverflowingViewport(e-50);const n=this.gos.getCallback("processUnpinnedColumns");if(t.length){if(n){t=n({columns:t,viewportWidth:e})}this.columnModel.setColsPinned(t,null,"viewportSizeFeature")}}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth()+this.pinnedWidthService.getPinnedLeftWidth();if(t<e)return[];const n=[...this.visibleColsService.getLeftCols()],r=[...this.visibleColsService.getRightCols()];let i=0,o=0;const s=[];let a=t-0-e;for(;(o<n.length||i<r.length)&&a>0;){if(i<r.length){const e=r[i++];a-=e.getActualWidth(),s.push(e)}if(o<n.length&&a>0){const e=n[o++];a-=e.getActualWidth(),s.push(e)}}return s}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=LW(this.gridBodyCtrl.getBodyViewportElement());this.bodyHeight!==e&&(this.bodyHeight=e,this.eventService.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnViewportService.setScrollPosition(e,t)}},O$=class extends nB{wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{PV(this.gos)?this.enableFeature():this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature());PV(this.gos)&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},N$=class extends Ez{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[$z]),this.eCheckbox=Rz}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),n=PW(e,t),[r,i]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],o=e(r,i);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${o} (${n})`)}onClicked(e,t,n){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:n.shiftKey,groupSelectsFiltered:t,event:n,source:"checkboxSelected"})}init(e){this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:e=>QV(e),click:e=>{QV(e);const t="filteredDescendants"===LV(this.gos),n=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(n,t)){0===this.onClicked(!0,t,e||{})&&this.onClicked(!1,t,e)}else n?this.onClicked(!1,t,e):this.onClicked(!0,t,e||{})}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)});if(FV(this.gos)||"function"===typeof this.getIsVisible()){const e=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&nV(this.gos)}showOrHideSelect(){let e=this.rowNode.selectable;const t=this.getIsVisible();if(e)if("function"===typeof t){const n=this.overrides?.callbackParams;if(this.column){const r=this.column.createColumnFunctionCallbackParams(this.rowNode);e=t({...n,...r})}else e=t({...n,node:this.rowNode,data:this.rowNode.data})}else e=t??!1;const n=this.gos.get("rowSelection"),r=n&&"string"!==typeof n?!function(e){return e?.hideDisabledCheckboxes??!1}(n):this.column?.getColDef().showDisabledCheckboxes;if(r)return this.eCheckbox.setDisabled(!e),this.setVisible(!0),void this.setDisplayed(!0);this.overrides?.removeHidden?this.setDisplayed(e):this.setVisible(e)}getIsVisible(){if(this.overrides)return this.overrides.isVisible;const e=this.gos.get("rowSelection");return e&&"string"!==typeof e?kV(e):this.column?.getColDef()?.checkboxSelection}},L$=class extends Ez{constructor(e,t,n){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=n}postConstruct(){this.getGui().appendChild(Mz("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const n=()=>{try{const t=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",t),e.dataTransfer.setData("text/plain",t)}catch(t){}};if(t){t(this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e}))}else n()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}},_$=class extends nB{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,n=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,n,e=>this.cellComp.addOrRemoveCssClass(e,!0),e=>this.cellComp.addOrRemoveCssClass(e,!1)),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if("function"===typeof e.cellStyle){const n=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});t=(0,e.cellStyle)(n)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach(e=>this.cellComp.addOrRemoveCssClass(e,!0))}destroy(){super.destroy()}},H$=class extends nB{constructor(e,t,n,r,i){super(),this.cellCtrl=e,this.beans=t,this.rowNode=r,this.rowCtrl=i}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case Bz.ENTER:this.onEnterKeyDown(e);break;case Bz.F2:this.onF2KeyDown(e);break;case Bz.ESCAPE:this.onEscapeKeyDown(e);break;case Bz.TAB:this.onTabKeyDown(e);break;case Bz.BACKSPACE:case Bz.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case Bz.DOWN:case Bz.UP:case Bz.RIGHT:case Bz.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:n,beans:r,rowNode:i}=this,{gos:o,rangeService:s,eventService:a}=r;if(!n.isEditing()){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===Bz.DELETE||!t&&e===Bz.BACKSPACE&&gz()}(e,o.get("enableCellEditingOnBackspace"))){if(s&&PV(o))s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(n.isCellEditable()){const e=n.getColumn(),t=this.beans.valueService.getDeleteValue(e,i);i.setDataValue(e,t,"cellClear")}}else n.startRowOrCellEdit(e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?Bz.UP:Bz.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(Bz.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Bz.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const t=e.key;" "===t?this.onSpaceKeyDown(e):this.cellCtrl.startRowOrCellEdit(t,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&oV(t)){const n=this.rowNode.isSelected(),r=!n,i="filteredDescendants"===LV(t),o=this.rowNode.setSelectedParams({newValue:r,rangeSelect:e.shiftKey,groupSelectsFiltered:i,event:e,source:"spaceKey"});void 0===n&&0===o&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:i,event:e,source:"spaceKey"})}e.preventDefault()}destroy(){super.destroy()}},V$=class extends nB{constructor(e,t,n){super(),this.cellCtrl=e,this.beans=t,this.column=n}onMouseEvent(e,t){if(!JV(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:n,gos:r}=this.beans,i=e.ctrlKey||e.metaKey;n&&i&&n.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&n.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(o);const s=this.column.getColDef();s.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{s.onCellClicked(o)})},0);!((r.get("singleClickEdit")||s.singleClickEdit)&&!r.get("suppressClickEdit"))||e.shiftKey&&0!=n?.getCellRanges().length||this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!fz()||ZV("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const{column:t,beans:n,cellCtrl:r}=this,{eventService:i,frameworkOverrides:o,gos:s}=n,a=t.getColDef(),l=r.createEvent(e,"cellDoubleClicked");i.dispatchEvent(l),"function"===typeof a.onCellDoubleClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{a.onCellDoubleClicked(l)})},0);!s.get("singleClickEdit")&&!s.get("suppressClickEdit")&&r.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:n,shiftKey:r}=e,i=e.target,{cellCtrl:o,beans:s}=this,{eventService:a,rangeService:l,focusService:c,gos:u}=s;if(this.isRightClickInExistingRange(e))return;const d=l&&0!=l.getCellRanges().length;if(!r||!d){const t=u.get("enableCellTextSelection")&&e.defaultPrevented,n=(dz()||t)&&!o.isEditing()&&!AW(i);o.focusCell(n)}if(r&&d&&!c.isCellFocused(o.getCellPosition())){e.preventDefault();const t=c.getFocusedCell();if(t){const{column:e,rowIndex:n,rowPinned:r}=t,i=s.rowRenderer.getRowByPosition({rowIndex:n,rowPinned:r}),o=i?.getCellCtrl(e);o?.isEditing()&&o.stopEditing(),c.setFocusedCell({column:e,rowIndex:n,rowPinned:r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(i)){if(l){const e=this.cellCtrl.getCellPosition();if(r)l.extendLatestRangeToCell(e);else{const r=t||n;l.setRangeToCell(e,r)}}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const n=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),r=2===e.button||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(n&&r)return!0}return!1}containsWidget(e){return OW(e,"ag-selection-checkbox",3)}onMouseOut(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),this.beans.columnHoverService.clearMouseOver())}onMouseOver(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),this.beans.columnHoverService.setMouseOver([this.column]))}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),n=t.contains(e.target),r=t.contains(e.relatedTarget);return n&&r}destroy(){super.destroy()}},B$=class extends nB{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();BV(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else{let n=this.column;const r=this.column.getPinned();for(let i=0;n&&i<e&&(t.push(n),n=this.beans.visibleColsService.getColAfter(n),n&&!UH(n))&&r===n.getPinned();i++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gos.get("enableRtl")&&this.colsSpanning?VV(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.visibleColsService.getColsLeftWidth();if("right"===this.column.getPinned()){return t+this.beans.visibleColsService.getBodyContainerWidth()+(e||0)}return t+(e||0)}applyRowSpan(e){if(1===this.rowSpan&&!e)return;const t=cV(this.beans.gos)*this.rowSpan;this.eGui.style.height=`${t}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},W$="ag-cell-range-selected",z$=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onCellSelectionChanged()}onCellSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(W$,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(`${W$}-1`,1===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${W$}-2`,2===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${W$}-3`,3===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${W$}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),MW(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),n=!t&&e.top,r=!t&&e.right,i=!t&&e.bottom,o=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",o)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every(e=>$V([1,0],e.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,n=!1,r=!1,i=!1;const o=this.cellCtrl.getCellPosition().column,s=this.beans.visibleColsService;let a,l;e?(a=s.getColAfter(o),l=s.getColBefore(o)):(a=s.getColBefore(o),l=s.getColAfter(o));const c=this.rangeService.getCellRanges().filter(e=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),e));a||(i=!0),l||(n=!0);for(let u=0;u<c.length&&!(t&&n&&r&&i);u++){const e=c[u],o=this.rangeService.getRangeStartRow(e),s=this.rangeService.getRangeEndRow(e);!t&&this.beans.rowPositionUtils.sameRow(o,this.cellCtrl.getCellPosition())&&(t=!0),!r&&this.beans.rowPositionUtils.sameRow(s,this.cellCtrl.getCellPosition())&&(r=!0),!i&&a&&e.columns.indexOf(a)<0&&(i=!0),!n&&l&&e.columns.indexOf(l)<0&&(n=!0)}return{top:t,right:n,bottom:r,left:i}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),n=t.length;if(this.rangeCount<1||n<1)return!1;const r=VV(t),i=this.cellCtrl.getCellPosition(),o=IV(e)&&!this.cellCtrl.isSuppressFillHandle(),s=function(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&"range"===t.handle?.mode:e.get("enableRangeHandle")}(e);let a=1===n&&!this.cellCtrl.isEditing()&&(o||s);if(this.hasChartRange){const e=1===t[0].type&&this.rangeService.isCellInSpecificRange(i,t[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",e),a=0===r.type}return a&&null!=r.endRow&&this.rangeService.isContiguousRange(r)&&this.rangeService.isBottomRightCell(r,i)}addSelectionHandle(){const e=VV(this.rangeService.getCellRanges()).type,t=IV(this.beans.gos)&&UH(e)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(t)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},j$=0,G$=class e extends nB{constructor(e,t,n,r){super(),this.column=e,this.rowNode=t,this.beans=n,this.rowCtrl=r,this.cellRangeFeature=void 0,this.cellPositionFeature=void 0,this.cellCustomStyleFeature=void 0,this.tooltipFeature=void 0,this.cellMouseListenerFeature=void 0,this.cellKeyboardListenerFeature=void 0,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],this.instanceId=e.getId()+"-"+j$++,this.colIdSanitised=$B(this.column.getId()),this.createCellPosition(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}onFocusOut(){this.beans.focusService.clearRestoreFocus()}addFeatures(){this.cellPositionFeature=new B$(this,this.beans),this.cellCustomStyleFeature=new _$(this,this.beans),this.cellMouseListenerFeature=new V$(this,this.beans,this.column),this.cellKeyboardListenerFeature=new H$(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();this.beans.rangeService&&PV(this.beans.gos)&&(this.cellRangeFeature=new z$(this.beans,this))}removeFeatures(){const e=this.beans.context;this.cellPositionFeature=e.destroyBean(this.cellPositionFeature),this.cellCustomStyleFeature=e.destroyBean(this.cellCustomStyleFeature),this.cellMouseListenerFeature=e.destroyBean(this.cellMouseListenerFeature),this.cellKeyboardListenerFeature=e.destroyBean(this.cellKeyboardListenerFeature),this.cellRangeFeature=e.destroyBean(this.cellRangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){const n="whenTruncated"===this.beans.gos.get("tooltipShowMode");t||!n||this.isCellRenderer()||(t=()=>{const e=this.getGui(),t=0===e.children.length?e:e.querySelector(".ag-cell-value");return!t||t.scrollWidth>t.clientWidth});const r={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:null!=e?()=>e:()=>{const e=this.column.getColDef(),t=this.rowNode.data;if(e.tooltipField&&$H(t))return yB(t,e.tooltipField,this.column.isTooltipFieldContainsDots());const n=e.tooltipValueGetter;return n?n(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:t};this.tooltipFeature=new Sz(r,this.beans)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,n,r,i,o){this.cellComp=e,this.eGui=t,this.printLayout=r,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.cellPositionFeature?.setComp(t),this.cellCustomStyleFeature?.setComp(e),this.tooltipFeature?.refreshToolTip(),this.cellKeyboardListenerFeature?.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),i&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(e=>e()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(e,t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!e)return;const n=e.parentElement,r=lV(this.beans.gos,this.rowNode).height,i=o=>{if(this.editing)return;if(!this.isAlive()||!t.isAlive())return;const{paddingTop:s,paddingBottom:a,borderBottomWidth:l,borderTopWidth:c}=NW(n),u=s+a+l+c,d=e.offsetHeight+u;if(o<5){const t=pV(this.beans.gos);if(!t||!t.contains(e)||0==d)return void window.setTimeout(()=>i(o+1),0)}const h=Math.max(d,r);this.rowNode.setRowAutoHeight(h,this.column)},o=()=>i(0);o();const s=this.beans.resizeObserverService.observeResize(e,o);t.addDestroyFunc(()=>{s(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return null!=e.cellRenderer||null!=e.cellRendererSelector}getValueToDisplay(){return this.valueFormatted??this.value}showValue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{beans:t,column:n,rowNode:r,cellRangeFeature:i,cellComp:o}=this,{userComponentFactory:s,animationFrameService:a}=t,l=this.getValueToDisplay();let c;if(r.stub&&null==r.groupData?.[this.column.getId()]){const e=this.createCellRendererParams();c=s.getLoadingCellRendererDetails(n.getColDef(),e)}else if(this.isCellRenderer()){const e=this.createCellRendererParams();c=s.getCellRendererDetails(n.getColDef(),e)}o.setRenderDetails(c,l,e),a.requestAnimationFrame(()=>i?.refreshHandle())}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)}isCheckboxSelection(e){const{rowSelection:t}=this.beans.gridOptions;return e.checkboxSelection||hB(this.column)&&t&&"string"!==typeof t&&kV(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),n=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),r=this.includeDndSource!=this.isIncludeControl(e.dndSource),i=this.isAutoHeight!=this.column.isAutoHeight();return t||n||r||i}startEditing(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{editService:r}=this.beans;return!(this.isCellEditable()&&!this.editing&&r)||(this.cellComp?r.startEditing(this,e,t,n):(this.onCellCompAttachedFuncs.push(()=>{this.startEditing(e,t,n)}),!0))}setEditing(e,t){this.editCompDetails=t,this.editing!==e&&(this.editing=e)}stopRowOrCellEdit(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.stopEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.editing&&this.stopEditingAndFocus()}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onCellEditorAttachedFuncs=[];const{editService:t}=this.beans;return!(!this.editing||!t)&&t.stopEditing(this,e)}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.beans.valueService.getValueForDisplay(this.column,this.rowNode),setValue:e=>this.beans.valueService.setValue(this.rowNode,this.column,e),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(e,t,n,r)=>this.registerRowDragger(e,t,r),setTooltip:(e,t)=>{this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(e,t),this.tooltipFeature?.refreshToolTip()}})}setFocusOutOnEditor(){this.editing&&this.beans.editService?.setFocusOutOnEditor(this)}setFocusInOnEditor(){this.editing&&this.beans.editService?.setFocusInOnEditor(this)}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e)}refreshCell(e){if(this.suppressRefreshCell||this.editing)return;const t=this.column.getColDef(),n=null!=e&&!!e.newData,r=null!=e&&!!e.suppressFlash||!!t.suppressCellFlash,i=null==t.field&&null==t.valueGetter&&null==t.showRowGroup,o=e&&e.forceRefresh||i||n,s=!!this.cellComp,a=this.updateAndFormatValue(s);if(s){if(o||a){this.showValue(n);const e=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!r&&!e&&(this.beans.gos.get("enableCellChangeFlash")||t.enableCellChangeFlash)&&this.flashCell(),this.cellCustomStyleFeature?.applyUserStyles(),this.cellCustomStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshToolTip(),this.cellCustomStyleFeature?.applyCellClassRules()}}stopEditingAndFocus(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.beans.editService?.stopEditingAndFocus(this,e,t)}flashCell(e){const t=e?.flashDuration??e?.flashDelay,n=e?.fadeDuration??e?.fadeDelay;this.animateCell("data-changed",t,n)}animateCell(e,t,n){if(!this.cellComp)return;const{gos:r}=this.beans;if(t||(t=r.get("cellFlashDuration")),0===t)return;$H(n)||(n=r.get("cellFadeDuration"));const i=`ag-cell-${e}`,o=`ag-cell-${e}-animation`;this.cellComp.addOrRemoveCssClass(i,!0),this.cellComp.addOrRemoveCssClass(o,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(i,!1),this.cellComp.addOrRemoveCssClass(o,!0),this.eGui.style.transition=`background-color ${n}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(o,!1),this.eGui.style.transition="")},n))},t)})}onFlashCells(e){if(!this.cellComp)return;const t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,n=this.valueFormatted;return this.value=this.beans.valueService.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=n)}valuesAreEqual(e,t){const n=this.column.getColDef();return n.equals?n.equals(e,t):e===t}getComp(){return this.cellComp}getValue(){return this.value}addDomData(t){const n=this.getGui();hV(this.beans.gos,n,e.DOM_DATA_KEY_CELL_CTRL,this),t.addDestroyFunc(()=>hV(this.beans.gos,n,e.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(e,t){return this.beans.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex})}processCharacter(e){this.cellKeyboardListenerFeature?.processCharacter(e)}onKeyDown(e){this.cellKeyboardListenerFeature?.onKeyDown(e)}onMouseEvent(e,t){this.cellMouseListenerFeature?.onMouseEvent(e,t)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){this.cellComp&&this.cellPositionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:e,column:t,beans:n}=this;NG(e,t,n.visibleColsService)}refreshAriaColIndex(){const e=this.beans.visibleColsService.getAriaColIndex(this.column);EW(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){return this.cellPositionFeature?.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cellComp?"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t):(this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(e,t)}),!0)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}onSuppressCellFocusChanged(e){this.eGui&&ZW(this.eGui,"tabindex",e?void 0:-1)}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}onCellFocused(e){if(this.beans.focusService.isCellFocusSuppressed())return;const t=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp)return void(t&&e?.forceBrowserFocus&&(this.focusEventToRestore=e));if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus){let t=this.cellComp.getFocusableElement();if(this.editing){const e=this.beans.focusService.findFocusableElements(t,null,!0);e.length&&(t=e[0])}t.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const n="fullRow"===this.beans.gos.get("editType");t||n||!this.editing||this.stopRowOrCellEdit(),t&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:GH(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}onColDefChanged(){if(!this.cellComp)return;this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editService?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0})}setWrapText(){const e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),n=this.createEvent(e,"cellContextMenu");this.beans.eventService.dispatchEvent(n),t.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(n)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new N$;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new L$(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,t,n){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const r=this.createRowDragComp(e,t,n);r&&(this.customRowDragComp=r,this.addDestroyFunc(()=>{this.beans.context.destroyBean(r),this.customRowDragComp=null}))}createRowDragComp(e,t,n){const r=this.beans.gos.get("pagination"),i=this.beans.gos.get("rowDragManaged"),o=nV(this.beans.gos);if(i){if(!o)return void NH("managed row dragging is only allowed in the Client Side Row Model");if(r)return void NH("managed row dragging is not possible when doing pagination")}const s=new Lj(()=>this.value,this.rowNode,this.column,e,t,n);return this.beans.context.createBean(s),s}setSuppressRefreshCell(e){this.suppressRefreshCell=e}getEditCompDetails(){return this.editCompDetails}onCellEditorAttached(e){this.onCellEditorAttachedFuncs.push(e)}cellEditorAttached(){this.onCellEditorAttachedFuncs.forEach(e=>e()),this.onCellEditorAttachedFuncs=[]}};G$.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var $$=G$,U$=0,K$=class e extends nB{constructor(e,t,n,r,i){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=t,this.gos=t.gos,this.rowNode=e,this.paginationPage=t.paginationService?.getCurrentPage()??0,this.useAnimationFrameForCreate=r,this.printLayout=i,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+U$++,this.rowId=$B(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=t.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(n),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!==typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=$B(e)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}isSticky(){return this.rowNode.sticky}updateGui(e,t){"left"===e?this.leftGui=t:"right"===e?this.rightGui=t:"fullWidth"===e?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,n,r){const i={rowComp:e,element:t,containerType:n,compBean:r=uW(this,this.beans.context,r)};this.allRowGuis.push(i),this.updateGui(n,i),this.initialiseRowComp(i),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach(e=>e.element.style.display=t)}initialiseRowComp(t){const n=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),oV(n)&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=t.rowComp;this.getInitialRowClasses(t.containerType).forEach(e=>r.addOrRemoveCssClass(e,!0)),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&yW(t.element,1==this.rowNode.expanded),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),hV(n,t.element,e.DOM_DATA_KEY_ROW_CTRL,this),t.compBean.addDestroyFunc(()=>hV(n,t.element,e.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t),this.isFullWidth()&&this.setupFullWidth(t),n.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(e){this.rowId=$B(this.rowNode.id),null!=this.rowId&&e.setRowId(this.rowId)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(WH(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(WH(()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){if(PV(this.gos))return void NH("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `cellSelection: true`");const t=this.beans.localeService.getLocaleTextFunc(),n=new Lj(()=>`1 ${t("rowDragRow","row")}`,this.rowNode,void 0,e.element,void 0,!0),r=this.createBean(n,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(e=>e!==r),this.destroyBean(r,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType);if("FullWidthDetail"==this.rowType&&!this.gos.assertModuleRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)"))return;const n=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(n)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}getCellElement(e){const t=this.getCellCtrl(e);return t?t.getGui():null}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;e({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const e=!!this.leftGui||!this.beans.visibleColsService.isPinningLeft(),t=!!this.centerGui,n=!!this.rightGui||!this.beans.visibleColsService.isPinningRight();return e&&t&&n}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this.rowNode})}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),n=this.gos.get("masterDetail")&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),i=!!this.rowNode.group&&!this.rowNode.footer&&EV(this.gos,r);this.rowType=e?"FullWidthLoading":n?"FullWidthDetail":t?"FullWidth":i?"FullWidthGroup":"Normal"}updateColumnLists(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isFullWidth())return;e||this.gos.get("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r={list:[],map:{}},i=(e,t,n)=>{null!=n?r.list.splice(n,0,t):r.list.push(t),r.map[e]=t},o=[];for(const s of t){const t=s.getInstanceId();let n=e.map[t];n||(n=new $$(s,this.rowNode,this.beans,this)),i(t,n)}for(const s of e.list){const e=s.getColumn().getInstanceId();if(null!=r.map[e])continue;!this.isCellEligibleToBeRemoved(s,n)?o.push([e,s]):s.destroy()}if(o.length)for(const[s,a]of o){const e=r.list.findIndex(e=>e.getColumn().getLeft()>a.getColumn().getLeft()),t=-1===e?void 0:Math.max(e-1,0);i(s,a,t)}return r}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach(t=>{const n=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(n,e)})}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.columnViewportService,t=this.beans.visibleColsService;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllCols()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const n=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);const r=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,r,"left");const i=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}}isCellEligibleToBeRemoved(e,t){const n=!0;if(e.getColumn().getPinned()!=t)return n;const r=e.isEditing(),i=this.beans.focusService.isCellFocused(e.getCellPosition());if(r||i){const t=e.getColumn();return!(this.beans.visibleColsService.getAllCols().indexOf(t)>=0)&&n}return n}getDomOrder(){return this.gos.get("ensureDomOrder")||iV(this.gos,"print")}listenOnDomOrder(e){e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],()=>{e.rowComp.setDomOrder(this.getDomOrder())})}setAnimateFlags(e){if(this.isSticky()||!e)return;const t=$H(this.rowNode.oldRowTop),n=this.beans.visibleColsService.isPinningLeft(),r=this.beans.visibleColsService.isPinningRight();if(t){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.slideInAnimation.fullWidth=!0);this.slideInAnimation.center=!0,this.slideInAnimation.left=n,this.slideInAnimation.right=r}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.fadeInAnimation.fullWidth=!0);this.fadeInAnimation.center=!0,this.fadeInAnimation.left=n,this.fadeInAnimation.right=r}}isEditing(){return this.editingRow}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const e=(e,t)=>!e||e.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(e.element,t).params),t=e(this.fullWidthGui,null),n=e(this.centerGui,null),r=e(this.leftGui,"left"),i=e(this.rightGui,"right");return t&&n&&r&&i}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),expandedChanged:this.updateExpandedCss.bind(this),hasChildrenChanged:this.updateExpandedCss.bind(this)}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventService,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach(e=>{this.addRowDraggerToRow(e)}):this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged())},cellChanged:e=>{this.getAllCellCtrls().forEach(t=>t.onCellChanged(e))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell())this.beans.rowRenderer.redrawRow(this.rowNode);else{if(this.isFullWidth()){return void(this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode))}this.getAllCellCtrls().forEach(t=>t.refreshCell({suppressFlash:!e.update,newData:!e.update})),this.allRowGuis.forEach(e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)}),this.onRowSelected(),this.postProcessCss()}}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach(t=>{const n=0===e,r=1===e;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)})}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e))}updateExpandedCss(){const e=this.rowNode.isExpandable(),t=1==this.rowNode.expanded;this.allRowGuis.forEach(n=>{n.rowComp.addOrRemoveCssClass("ag-row-group",e),n.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&t),n.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!t),yW(n.element,e&&t)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:GH(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}onKeyboardNavigate(e){const t=this.findFullWidthRowGui(e.target);if(!((t?t.element:null)===e.target))return;const n=this.rowNode,r=this.beans.focusService.getFocusedCell(),i={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:r?.column??this.getColumnForFullWidth(t)};this.beans.navigationService.navigateToNextCell(e,e.key,i,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||JV(e))return;const t=this.allRowGuis.find(t=>t.element.contains(e.target)),n=t?t.element:null,r=n===e.target,i=mV(this.gos);let o=!1;n&&i&&(o=n.contains(i)&&i.classList.contains("ag-cell"));let s=null;r||o||(s=this.beans.focusService.findNextFocusableElement(n,!1,e.shiftKey)),(this.isFullWidth()&&r||!s)&&this.beans.navigationService.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find(e=>UW(e.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach(e=>{ZW(e.element,"tabindex",t)})}onFullWidthRowFocused(e){const t=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned),r=this.fullWidthGui?this.fullWidthGui.element:this.centerGui?.element;r&&(r.classList.toggle("ag-full-width-focus",n),n&&e?.forceBrowserFocus&&r.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const n={list:[],map:{}};return e.list.forEach(e=>{e!==t&&(n.list.push(e),n.map[e.getColumn().getInstanceId()]=e)}),n}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){return this.gos.addGridCommonParams({type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:t})}createRowEventWithSource(e,t){const n=this.createRowEvent(e,t);return n.source=this,n}onRowDblClick(e){JV(e)||this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}getColumnForFullWidth(e){const{visibleColsService:t}=this.beans;switch(e?.containerType){case"center":return t.getCenterCols()[0];case"left":return t.getLeftCols()[0];case"right":return t.getRightCols()[0];default:return t.getAllCols()[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=OW(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges();const n=this.findFullWidthRowGui(e.target),r=n?.element,i=e.target;let o=!0;r&&r.contains(i)&&AW(i)&&(o=!1),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:this.getColumnForFullWidth(n),rowPinned:t.rowPinned,forceBrowserFocus:o})}onRowClick(e){if(JV(e)||this.lastMouseDownOnDragger)return;const{gos:t}=this;this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowClicked",e));const n=e.ctrlKey||e.metaKey,r=e.shiftKey,i=this.rowNode.isSelected(),o=_V(t),s=DV(t),a=function(e){const t=AV(e);return!0===t||"enableSelection"===t}(t);if(o&&this.rowNode.group||this.isRowSelectionBlocked()||!a&&!i||!s&&i)return;const l=function(e){const t=e.get("rowSelection");return"string"===typeof t?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}(t),c="rowClicked";if(i)l?this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):n?s&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):a&&this.rowNode.setSelectedParams({newValue:!0,clearSelection:!r,rangeSelect:r,event:e,source:c});else{const t=!l&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:t,rangeSelect:r,event:e,source:c})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!oV(this.gos)}setupDetailRowAutoHeight(e){if("FullWidthDetail"!==this.rowType)return;if(!this.gos.get("detailRowAutoHeight"))return;const t=()=>{const t=e.clientHeight;if(null!=t&&t>0){const e=()=>{this.rowNode.setRowHeight(t),(nV(this.gos)||rV(this.gos))&&this.beans.rowModel.onRowHeightChanged()};window.setTimeout(e,0)}},n=this.beans.resizeObserverService.observeResize(e,t);this.addDestroyFunc(n),t()}createFullWidthCompDetails(e,t){const{gos:n,rowNode:r}=this,i=n.addGridCommonParams({fullWidth:!0,data:r.data,node:r,value:r.key,valueFormatted:r.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,n,r)=>this.addFullWidthRowDragging(e,t,n,r),setTooltip:(e,t)=>this.refreshRowTooltip(e,t)}),o=this.beans.userComponentFactory;switch(this.rowType){case"FullWidthDetail":return o.getFullWidthDetailCellRendererDetails(i);case"FullWidthGroup":return o.getFullWidthGroupCellRendererDetails(i);case"FullWidthLoading":return o.getFullWidthLoadingCellRendererDetails(i);default:return o.getFullWidthCellRendererDetails(i)}}refreshRowTooltip(e,t){if(!this.fullWidthGui)return;const n={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>e,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:t};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new Sz(n,this.beans))}addFullWidthRowDragging(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;if(!this.isFullWidth())return;const i=new Lj(()=>n,this.rowNode,void 0,e,t,r);this.createBean(i,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(i,this.beans.context)})}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(n,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass("ag-row-first",e))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-row-last",t)))}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stoppingRowEdit||this.beans.rowEditService?.stopEditing(this,e)}setInlineEditingCss(){const e=this.editingRow||this.getAllCellCtrls().some(e=>e.isEditing());this.allRowGuis.forEach(t=>{t.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),t.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)})}setEditingRow(e){this.editingRow=e}startRowEditing(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!!this.editingRow||(this.beans.rowEditService?.startEditing(this,e,t,n)??!0)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach(e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!0))},e=>{this.allRowGuis.forEach(t=>t.rowComp.addOrRemoveCssClass(e,!1))})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,e=>e.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return"left"===e||"right"===e?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)}processStylesFromGridOptions(){const e=this.gos.get("rowStyle");if(e&&"function"===typeof e)return void NH("rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const t=this.gos.getCallback("getRowStyle");let n;if(t){n=t({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return n||e?Object.assign({},e,n):this.emptyStyle}onRowSelected(e){const t=!!this.rowNode.isSelected();this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-selected",t),MW(e.element,t);!e.element.contains(mV(this.gos))||e!==this.centerGui&&e!==this.fullWidthGui||this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const e=this.rowNode.isSelected();if(e&&!DV(this.gos))return;const t=this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(t,"rowSelection")}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:n}=e,{rowNode:r,beans:i,gos:o}=this;n.addManagedListeners(t,{mouseenter:()=>r.onMouseEnter(),mouseleave:()=>r.onMouseLeave()}),n.addManagedListeners(r,{mouseEnter:()=>{i.dragService.isDragging()||o.get("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),r.setHovered(!0))},mouseLeave:()=>{t.classList.remove("ag-row-hover"),r.setHovered(!1)}})}roundRowTopToBounds(e){const t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),n=this.applyPaginationOffset(t.top,!0)-100,r=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(n,e),r)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),r=aV(this.gos)?lV(this.gos,this.rowNode).height:void 0,i=r?Math.min(n,r)-2+"px":void 0;this.forEachGui(e,e=>{e.element.style.height=`${t}px`,i&&e.element.style.setProperty("--ag-line-height",i)})}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}destroyFirstPass(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.active=!1,!e&&wV(this.gos)&&!this.isSticky()){if(null!=this.rowNode.rowTop){const e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach(e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0))}this.rowNode.setHovered(!1);const t=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(t),this.beans.eventService.dispatchEvent(t),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const e=e=>(e.list.forEach(e=>e.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const e=this.beans.paginationService?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.pageBoundsService.getPixelOffset()*(t?1:-1)}setRowTop(e){if(!this.printLayout&&$H(e)){const t=this.applyPaginationOffset(e),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeightService.getRealPixelPosition(t)}px`;this.setRowTopStyle(n)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let n;if(this.isSticky())n=t.stickyRowTop;else{const r=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,i=this.applyPaginationOffset(r);n=t.isRowPinned()?i:this.beans.rowContainerHeightService.getRealPixelPosition(i)}return n+"px"}setRowTopStyle(e){this.allRowGuis.forEach(t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`))}getRowNode(){return this.rowNode}getCellCtrl(e){let t=null;return this.getAllCellCtrls().forEach(n=>{n.getColumn()==e&&(t=n)}),null!=t||this.getAllCellCtrls().forEach(n=>{n.getColSpanningList().indexOf(e)>=0&&(t=n)}),t}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(null===t)return;const n=this.beans.headerNavigationService.getHeaderRowCount()+(this.beans.filterManager?.getHeaderRowCount()??0),r=this.rowNode.rowIndex%2===0,i=n+this.rowNode.rowIndex+1;this.forEachGui(e,e=>{e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",r),e.rowComp.addOrRemoveCssClass("ag-row-odd",!r),xW(e.element,i)})}setStoppingRowEdit(e){this.stoppingRowEdit=e}};K$.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Y$=K$,q$=class extends nB{wireBeans(e){this.mouseEventService=e.mouseEventService,this.valueService=e.valueService,this.menuService=e.menuService,this.ctrlsService=e.ctrlsService,this.navigationService=e.navigationService,this.focusService=e.focusService,this.undoRedoService=e.undoRedoService,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService,this.clipboardService=e.clipboardService}constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",ZV("touchstart")?"touchstart":"mousedown"].forEach(e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})})}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||JV(t))return;const n=this.getRowForEvent(t),r=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,void 0,n,r):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!fz())return;const e=new Az(this.element);this.addManagedListeners(e,{longTap:e=>{const t=this.getRowForEvent(e.touchEvent),n=this.mouseEventService.getRenderedCellForEvent(e.touchEvent);this.handleContextMenuMouseEvent(void 0,e.touchEvent,t,n)}}),this.addDestroyFunc(()=>e.destroy())}getRowForEvent(e){let t=e.target;for(;t;){const e=dV(this.gos,t,Y$.DOM_DATA_KEY_ROW_CTRL);if(e)return e;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,n,r){const i=n?n.getRowNode():null,o=r?r.getColumn():null;let s=null;if(o){const n=e||t;r.dispatchCellContextMenuEvent(n??null),s=this.valueService.getValue(o,i)}const a=this.ctrlsService.getGridBodyCtrl(),l=r?r.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:i,column:o,value:s,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:eB(this.gos,e,$$.DOM_DATA_KEY_CELL_CTRL),rowCtrl:eB(this.gos,e,Y$.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:n,rowCtrl:r}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(n?this.processCellKeyboardEvent(n,e,t):r&&r.isFullWidth()&&this.processFullWidthRowKeyboardEvent(r,e,t))}processCellKeyboardEvent(e,t,n){const r=e.getRowNode(),i=e.getColumn(),o=e.isEditing();if(!cG(this.gos,n,r,i,o)&&"keydown"===t){!o&&this.navigationService.handlePageScrollingKey(n)||e.onKeyDown(n),this.doGridOperations(n,e.isEditing()),lG(n)&&e.processCharacter(n)}"keydown"===t&&this.eventService.dispatchEvent(e.createEvent(n,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,n){const r=e.getRowNode(),i=this.focusService.getFocusedCell(),o=i&&i.column;if(!cG(this.gos,n,r,o,!1)){const r=n.key;if("keydown"===t)switch(r){case Bz.PAGE_HOME:case Bz.PAGE_END:case Bz.PAGE_UP:case Bz.PAGE_DOWN:this.navigationService.handlePageScrollingKey(n,!0);break;case Bz.UP:case Bz.DOWN:e.onKeyboardNavigate(n);break;case Bz.TAB:e.onTabKeyDown(n)}}"keydown"===t&&this.eventService.dispatchEvent(e.createRowEvent("cellKeyDown",n))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!this.mouseEventService.isEventFromThisGrid(e))return;const n=function(e){const{keyCode:t}=e;let n;switch(t){case 65:n=Bz.A;break;case 67:n=Bz.C;break;case 86:n=Bz.V;break;case 68:n=Bz.D;break;case 90:n=Bz.Z;break;case 89:n=Bz.Y;break;default:n=e.code}return n}(e);return n===Bz.A?this.onCtrlAndA(e):n===Bz.C?this.onCtrlAndC(e):n===Bz.D?this.onCtrlAndD(e):n===Bz.V?this.onCtrlAndV(e):n===Bz.X?this.onCtrlAndX(e):n===Bz.Y?this.onCtrlAndY():n===Bz.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(e){const{pinnedRowModel:t,rowModel:n,rangeService:r}=this;if(r&&n.isRowsToRender()){const[e,i]=[t.isEmpty("top"),t.isEmpty("bottom")],o=e?null:"top";let s,a;i?(s=null,a=n.getRowCount()-1):(s="bottom",a=t.getPinnedBottomRowCount()-1);const l=this.visibleColsService.getAllCols();if(KH(l))return;r.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:a,rowEndPinned:s,columnStart:l[0],columnEnd:VV(l)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gos.get("undoRedoCellEditing")&&this.undoRedoService&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService?.redo("ui")}},X$=class extends nB{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({leftPinnedWidthChanged:this.onPinnedLeftWidthChanged.bind(this)})}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;DW(this.element,t),qW(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},Q$=class extends nB{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({rightPinnedWidthChanged:this.onPinnedRightWidthChanged.bind(this)})}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;DW(this.element,t),qW(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},J$=e=>e.getTopRowCtrls(),Z$=e=>e.getStickyTopRowCtrls(),eU=e=>e.getStickyBottomRowCtrls(),tU=e=>e.getBottomRowCtrls(),nU=e=>e.getCentreRowCtrls(),rU={center:{type:"center",container:"ag-center-cols-container",viewport:"ag-center-cols-viewport",getRowCtrls:nU},left:{type:"left",container:"ag-pinned-left-cols-container",pinnedType:"left",getRowCtrls:nU},right:{type:"right",container:"ag-pinned-right-cols-container",pinnedType:"right",getRowCtrls:nU},fullWidth:{type:"fullWidth",container:"ag-full-width-container",fullWidth:!0,getRowCtrls:nU},topCenter:{type:"center",container:"ag-floating-top-container",viewport:"ag-floating-top-viewport",getRowCtrls:J$},topLeft:{type:"left",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:J$},topRight:{type:"right",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:J$},topFullWidth:{type:"fullWidth",container:"ag-floating-top-full-width-container",fullWidth:!0,getRowCtrls:J$},stickyTopCenter:{type:"center",container:"ag-sticky-top-container",viewport:"ag-sticky-top-viewport",getRowCtrls:Z$},stickyTopLeft:{type:"left",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Z$},stickyTopRight:{type:"right",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Z$},stickyTopFullWidth:{type:"fullWidth",container:"ag-sticky-top-full-width-container",fullWidth:!0,getRowCtrls:Z$},stickyBottomCenter:{type:"center",container:"ag-sticky-bottom-container",viewport:"ag-sticky-bottom-viewport",getRowCtrls:eU},stickyBottomLeft:{type:"left",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:eU},stickyBottomRight:{type:"right",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:eU},stickyBottomFullWidth:{type:"fullWidth",container:"ag-sticky-bottom-full-width-container",fullWidth:!0,getRowCtrls:eU},bottomCenter:{type:"center",container:"ag-floating-bottom-container",viewport:"ag-floating-bottom-viewport",getRowCtrls:tU},bottomLeft:{type:"left",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:tU},bottomRight:{type:"right",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:tU},bottomFullWidth:{type:"fullWidth",container:"ag-floating-bottom-full-width-container",fullWidth:!0,getRowCtrls:tU}};function iU(e){return rU[e]}var oU=["center","left","right","fullWidth"],sU=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],aU=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],lU=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],cU=["stickyTopCenter","stickyTopLeft","stickyTopRight"],uU=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],dU=[...cU,"stickyTopFullWidth",...uU,"stickyBottomFullWidth"],hU=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right",...cU,...uU],pU=class extends nB{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.options=iU(e)}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService,this.columnViewportService=e.columnViewportService,this.resizeObserverService=e.resizeObserverService,this.rowRenderer=e.rowRenderer}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new F$(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.ctrlsService.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,n){this.comp=e,this.eContainer=t,this.eViewport=n,this.createManagedBean(new q$(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const r=()=>this.onPinnedWidthChanged();this.forContainers(aU,()=>{this.pinnedWidthFeature=this.createManagedBean(new X$(this.eContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:r})}),this.forContainers(lU,()=>{this.pinnedWidthFeature=this.createManagedBean(new Q$(this.eContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:r})}),this.forContainers(oU,()=>this.createManagedBean(new P$(this.eContainer,"center"===this.name?n:void 0))),this.forContainers(hU,()=>this.createManagedBean(new O$(this.eContainer))),this.forContainers(sU,()=>this.createManagedBean(new a$(e=>this.comp.setContainerWidth(`${e}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}addListeners(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(dU.indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gos.get("ensureDomOrder"),t=iV(this.gos,"print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const e=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",e))}onHorizontalViewportChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getCenterWidth(),n=this.getCenterViewportScrollLeft();this.columnViewportService.setScrollPosition(t,n,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return _W(this.eViewport)}getCenterViewportScrollLeft(){return WW(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return $W(this.eViewport)}getViewportScrollLeft(){return WW(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||(e=this.eViewport).clientWidth<e.scrollWidth;var e}getViewportElement(){return this.eViewport}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){zW(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(null!=this.options.pinnedType)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.options.getRowCtrls(this.rowRenderer);if(!this.visible||0===t.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const n=iV(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||n,i=t.filter(e=>{const t=e.isFullWidth();return this.options.fullWidth?!r&&t:r||!t});this.comp.setRowCtrls({rowCtrls:i,useFlushSync:e})}},gU="ag-force-vertical-scroll",fU=class extends nB{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.menuService=e.menuService,this.headerNavigationService=e.headerNavigationService,this.dragAndDropService=e.dragAndDropService,this.pinnedRowModel=e.pinnedRowModel,this.rowRenderer=e.rowRenderer,this.popupService=e.popupService,this.mouseEventService=e.mouseEventService,this.rowModel=e.rowModel,this.filterManager=e.filterManager,this.environment=e.environment}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,n,r,i,o,s){this.comp=e,this.eGridBody=t,this.eBodyViewport=n,this.eTop=r,this.eBottom=i,this.eStickyTop=o,this.eStickyBottom=s,this.eCenterColsViewport=n.querySelector(`.${iU("center").viewport}`),this.eFullWidthContainer=n.querySelector(`.${iU("fullWidth").container}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${iU("stickyTopFullWidth").container}`),this.eStickyBottomFullWidthContainer=s.querySelector(`.${iU("stickyBottomFullWidth").container}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",e=>this.setCellTextSelection(e.currentValue)),this.createManagedBean(new E$(this.comp)),this.bodyScrollFeature=this.createManagedBean(new D$(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([r,n,i,o,s]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvancedFilterHeaderComp(r),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){const e=this.setFloatingHeights.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.onScrollGapChanged.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}addFocusListeners(e){e.forEach(e=>{this.addManagedElementListeners(e,{focusin:t=>{const{target:n}=t,r=OW(n,"ag-root",e);e.classList.toggle("ag-has-focus",!r)},focusout:t=>{const{target:n,relatedTarget:r}=t,i=e.contains(r),o=OW(r,"ag-root",e);OW(n,"ag-root",e)||i&&!o||e.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=`calc(100% + ${(e&&this.scrollVisibleService.getScrollbarWidth()||0)+(bz()?16:0)}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(t)),this.updateScrollingClasses()}onScrollGapChanged(){this.updateScrollingClasses()}updateScrollingClasses(){this.eGridBody.classList.toggle("ag-body-vertical-content-no-gap",!this.scrollVisibleService.hasVerticalScrollGap()),this.eGridBody.classList.toggle("ag-body-horizontal-content-no-gap",!this.scrollVisibleService.hasHorizontalScrollGap())}onGridColumnsChanged(){const e=this.columnModel.getCols();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=e=>{const n=e.relatedTarget;if(null===vz(n))return void this.rowRenderer.stopEditing();let r=t.some(e=>e.contains(n))&&this.mouseEventService.isElementInThisGrid(n);if(!r){const e=this.popupService;r=e.getActivePopups().some(e=>e.contains(n))||e.isElementWithinCustomPopup(n)}r||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach(t=>this.addManagedElementListeners(t,{focusout:e}))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount()+(this.filterManager?.getHeaderRowCount()??0),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===t?-1:e+t;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?gU:null,n=iV(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||n&&(r=this.eBodyViewport).clientHeight<r.scrollHeight;var r}setupRowAnimationCssClass(){let e=this.environment.hasMeasuredSizes();const t=()=>{const t=e&&wV(this.gos)&&!this.rowContainerHeightService.isStretching(),n=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(n,t)};t(),this.addManagedEventListeners({heightScaleChanged:t}),this.addManagedPropertyListener("animateRows",t),this.addManagedEventListeners({gridStylesChanged:()=>{!e&&this.environment.hasMeasuredSizes()&&(e=!0,t())}})}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:e}),this.mockContextMenuForIPad(e),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:n,shiftKey:r}=e;(r||Math.abs(t)>Math.abs(n))&&this.mouseEventService.isEventFromThisGrid(e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:n,shiftKey:r}=e,i=r||Math.abs(t)>Math.abs(n),o=e.target;i?(this.eStickyTopFullWidthContainer.contains(o)||this.eStickyBottomFullWidthContainer.contains(o))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(n))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:n}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||n})}onBodyViewportContextMenu(e,t,n){if(!e&&!n)return;if(this.gos.get("preventDefaultOnContextMenu")){(e||n).preventDefault()}const{target:r}=e||t;r!==this.eBodyViewport&&r!==this.ctrlsService.get("center").getViewportElement()||this.menuService.showContextMenu({mouseEvent:e,touchEvent:n,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!fz())return;const t=new Az(this.eBodyViewport);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc(()=>t.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new Oj(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature),this.addDestroyFunc(()=>this.dragAndDropService.removeDropTarget(this.rowDragFeature))}getRowDragFeature(){return this.rowDragFeature}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e.getPinnedTopTotalHeight(),n=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(n),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(n?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(e){const e=this.scrollVisibleService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${e}px)`)}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const e=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+(this.filterManager?.getHeaderHeight()??0),t=this.pinnedRowModel.getPinnedTopTotalHeight();let n=0;e>0&&(n+=e),t>0&&(n+=t),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight()+(this.scrollVisibleService.isHorizontalScrollShowing()&&this.scrollVisibleService.getScrollbarWidth()||0);this.comp.setStickyBottomBottom(`${e}px`)}sizeColumnsToFit(e,t){const n=this.isVerticalScrollShowing()?this.scrollVisibleService.getScrollbarWidth():0,r=_W(this.eGridBody)-n;r>0?this.columnSizeService.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,100)},0):100===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,500)},100):500===t?window.setTimeout(()=>{this.sizeColumnsToFit(e,-1)},500):NH("tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}};function mU(e){return e.map(e=>`<ag-row-container name="${e}"></ag-row-container>`).join("")}mU(["topLeft","topCenter","topRight","topFullWidth"]),mU(["left","center","right","fullWidth"]),mU(["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]),mU(["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]),mU(["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]);var vU=class extends nB{constructor(){super(...arguments),this.beanName="scrollVisibleService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnAnimationService=e.columnAnimationService}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)})}onDisplayedColumnsChanged(){this.updateScrollVisible()}onDisplayedColumnsWidthChanged(){this.updateScrollVisible()}onCentreViewportResized(){this.updateScrollGap()}updateScrollVisible(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsService.get("center"),t=e.hasHorizontalScrollGap(),n=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==n)&&(this.horizontalScrollGap=t,this.verticalScrollGap=n,this.eventService.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventService.dispatchEvent({type:"scrollVisibilityChanged"}))}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}hasHorizontalScrollGap(){return this.horizontalScrollGap}hasVerticalScrollGap(){return this.verticalScrollGap}getScrollbarWidth(){if(null==this.scrollbarWidth){const e=this.gos.get("scrollbarWidth"),t="number"===typeof e&&e>=0?e:(null==lz&&wz(),lz);null!=t&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},wU="__ag_grid_instance",bU=class e extends nB{constructor(){super(...arguments),this.beanName="mouseEventService",this.gridInstanceId=e.gridInstanceSequence.next()}wireBeans(e){this.ctrlsService=e.ctrlsService}stampTopLevelGridCompWithGridInstance(e){e[wU]=this.gridInstanceId}getRenderedCellForEvent(e){return eB(this.gos,e.target,$$.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const e=t[wU];if($H(e)){return e===this.gridInstanceId}t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=iV(this.gos,"normal"),n=e;let r,i;if(null!=n.clientX||null!=n.clientY?(r=n.clientX,i=n.clientY):(r=n.x,i=n.y),t){const e=this.ctrlsService.getGridBodyCtrl(),t=e.getScrollFeature().getVScrollPosition();r+=e.getScrollFeature().getHScrollPosition().left,i+=t.top}return{x:r,y:i}}};bU.gridInstanceSequence=new uz;var CU=bU,yU=class extends nB{constructor(){super(),this.beanName="navigationService",this.onPageDown=jH(this.onPageDown,100),this.onPageUp=jH(this.onPageUp,100)}wireBeans(e){this.mouseEventService=e.mouseEventService,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.ctrlsService=e.ctrlsService,this.rowRenderer=e.rowRenderer,this.headerNavigationService=e.headerNavigationService,this.rowPositionUtils=e.rowPositionUtils,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.scrollVisibleService=e.scrollVisibleService,this.rangeService=e.rangeService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.key,r=e.altKey,i=e.ctrlKey||e.metaKey,o=!!this.rangeService&&e.shiftKey,s=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(n){case Bz.PAGE_HOME:case Bz.PAGE_END:i||r||(this.onHomeOrEndKey(n),a=!0);break;case Bz.LEFT:case Bz.RIGHT:case Bz.UP:case Bz.DOWN:if(!s)return!1;!i||r||o||(this.onCtrlUpDownLeftRight(n,s),a=!0);break;case Bz.PAGE_DOWN:case Bz.PAGE_UP:i||r||(a=this.handlePageUpDown(n,s,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,n){return n&&(t=this.focusService.getFocusedCell()),!!t&&(e===Bz.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:n,scrollColumn:r,focusIndex:i,focusColumn:o}=e;$H(r)&&!r.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(r),$H(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,n),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(i),this.focusService.setFocusedCell({rowIndex:i,column:o,rowPinned:null,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:i,rowPinned:null,column:o})}onPageDown(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),r=this.pageBoundsService.getPixelOffset(),i=t.top+n,o=this.rowModel.getRowIndexAtPixel(i+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.pageBoundsService.getPixelOffset(),r=t.top,i=this.rowModel.getRowIndexAtPixel(r+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,i,!0):this.navigateToNextPage(e,i,!0)}navigateToNextPage(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.getViewportHeight(),i=this.pageBoundsService.getFirstRow(),o=this.pageBoundsService.getLastRow(),s=this.pageBoundsService.getPixelOffset(),a=this.rowModel.getRow(e.rowIndex),l=n?a?.rowHeight-r-s:r-s,c=a?.rowTop+l;let u,d=this.rowModel.getRowIndexAtPixel(c+s);if(d===e.rowIndex){const r=n?-1:1;t=d=e.rowIndex+r}n?(u="bottom",d<i&&(d=i),t<i&&(t=i)):(u="top",d>o&&(d=o),t>o&&(t=o)),this.isRowTallerThanView(d)&&(t=d,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const r=this.getNextFocusIndexForAutoHeight(e,n);this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:r,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?-1:1,n=this.getViewportHeight(),r=this.pageBoundsService.getLastRow();let i=0,o=e.rowIndex;for(;o>=0&&o<=r;){const e=this.rowModel.getRow(o);if(e){const t=e.rowHeight??0;if(i+t>n)break;i+=t}o+=t}return Math.max(0,Math.min(o,r))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.scrollVisibleService.getScrollbarWidth();let n=e.bottom-e.top;return this.ctrlsService.get("center").isHorizontalScrollShowing()&&(n-=t),n}isRowTallerThanView(e){const t=this.rowModel.getRow(e);if(!t)return!1;const n=t.rowHeight;return"number"===typeof n&&n>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const n=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:r}=n,i=n.column;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:i,focusIndex:r,focusColumn:i})}onHomeOrEndKey(e){const t=e===Bz.PAGE_HOME,n=this.visibleColsService.getAllCols(),r=t?n[0]:VV(n),i=t?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow();this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onTabKeyDown(e,t){const n=t.shiftKey,r=this.tabToNextCellCommon(e,n,t);if(!1===r)if(n){const{rowIndex:n,rowPinned:r}=e.getRowPosition();(r?0===n:n===this.pageBoundsService.getFirstRow())&&(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof $$&&e.focusCell(!0),(!n&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(n))&&t.preventDefault();else r?t.preventDefault():null===r&&this.focusService.allowFocusForNextGridCoreContainer(n)}tabToNextCell(e,t){const n=this.focusService.getFocusedCell();if(!n)return!1;let r=this.getCellByPosition(n);return!!(r||(r=this.rowRenderer.getRowByPosition(n),r&&r.isFullWidth()))&&!!this.tabToNextCellCommon(r,e,t)}tabToNextCellCommon(e,t,n){let r,i=e.isEditing();if(!i&&e instanceof $$){const t=e.getRowCtrl();t&&(i=t.isEditing())}return r=i?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(e,t,n):this.moveToNextEditingCell(e,t,n):this.moveToNextCellNotEditing(e,t),null===r?r:r||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.getCellPosition();e.getGui().focus(),e.stopEditing();const i=this.findNextCellToFocusOn(r,t,!0);return!1===i?null:null!=i&&(i.startEditing(null,!0,n),i.focusCell(!1),!0)}moveToNextEditingRow(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.getCellPosition(),i=this.findNextCellToFocusOn(r,t,!0);if(!1===i)return null;if(null==i)return!1;const o=i.getCellPosition(),s=this.isCellEditable(r),a=this.isCellEditable(o),l=o&&r.rowIndex===o.rowIndex&&r.rowPinned===o.rowPinned;if(s&&e.setFocusOutOnEditor(),!l){e.getRowCtrl().stopEditing();i.getRowCtrl().startRowEditing(void 0,void 0,n)}return a?(i.setFocusInOnEditor(),i.focusCell()):i.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const n=this.visibleColsService.getAllCols();let r;r=e instanceof Y$?{...e.getRowPosition(),column:t?n[0]:VV(n)}:e.getCellPosition();const i=this.findNextCellToFocusOn(r,t,!1);if(!1===i)return null;if(i instanceof $$)i.focusCell(!0);else if(i)return this.tryToFocusFullWidthRow(i.getRowPosition(),t);return $H(i)}findNextCellToFocusOn(e,t,n){let r=e;for(;;){e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,t);const i=this.gos.getCallback("tabToNextCell");if($H(i)){const o=i({backwards:t,editing:n,previousCellPosition:e,nextCellPosition:r||null});if(!0===o||null===o)null===o&&NH("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),r=e;else{if(!1===o)return!1;r={rowIndex:o.rowIndex,column:o.column,rowPinned:o.rowPinned}}}if(!r)return null;if(r.rowIndex<0){const e=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:e+r.rowIndex,column:r.column},fromCell:!0}),null}const o="fullRow"===this.gos.get("editType");if(n&&!o){if(!this.isCellEditable(r))continue}this.ensureCellVisible(r);const s=this.getCellByPosition(r);if(!s){const e=this.rowRenderer.getRowByPosition(r);if(!e||!e.isFullWidth()||n)continue;return e}if(!s.isSuppressNavigable())return this.rangeService?.setRangeToCell(r),s}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.rowModel.getRow(e.rowIndex)}navigateToNextCell(e,t,n,r){let i=n,o=!1;for(;i&&(i===n||!this.isValidNavigateCell(i));)this.gos.get("enableRtl")?t===Bz.LEFT&&(i=this.getLastCellOfColSpan(i)):t===Bz.RIGHT&&(i=this.getLastCellOfColSpan(i)),i=this.cellNavigationService.getNextCellToFocus(t,i),o=UH(i);if(o&&e&&e.key===Bz.UP&&(i={rowIndex:-1,rowPinned:null,column:n.column}),r){const r=this.gos.getCallback("navigateToNextCell");if($H(r)){const o=r({key:t,previousCellPosition:n,nextCellPosition:i||null,event:e});i=$H(o)?{rowPinned:o.rowPinned,rowIndex:o.rowIndex,column:o.column}:null}}if(!i)return;if(i.rowIndex<0){const t=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:t+i.rowIndex,column:n.column},event:e||void 0,fromCell:!0})}const s=this.getNormalisedPosition(i);s?this.focusPosition(s):this.tryToFocusFullWidthRow(i)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const n=this.visibleColsService.getAllCols(),r=this.rowRenderer.getRowByPosition(e);if(!r||!r.isFullWidth())return!1;const i=this.focusService.getFocusedCell(),o={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?VV(n):n[0])};this.focusPosition(o);const s=null==t?null!=i&&this.rowPositionUtils.before(o,i):t;return this.eventService.dispatchEvent({type:"fullWidthRowFocused",rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:o.column,isFullWidthCell:!0,fromBelow:s}),!0}focusPosition(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const n=t.getColSpanningList();return 1===n.length?e:{rowIndex:e.rowIndex,column:VV(n),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=bV(this.gos),n=this.rowModel.getRow(e.rowIndex);!(t&&n?.sticky)&&UH(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}},SU=class extends nB{constructor(){super(...arguments),this.beanName="horizontalResizeService"}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(t);return()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const n=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(n)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},xU=class extends nB{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.menuService=e.menuService}hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,n){this.showPopup(e,r=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:n,mouseEvent:t,ePopup:r})},n,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,n){let r=-1,i="left";const o=this.menuService.isLegacyMenuEnabled();!o&&this.gos.get("enableRtl")&&(r=1,i="right");const s=o?void 0:4*r,a=o?void 0:4;this.showPopup(e,r=>{this.popupService.positionPopupByComponent({type:n,eventSource:t,ePopup:r,nudgeX:s,nudgeY:a,alignSide:i,keepWithinBounds:!0,position:"under",column:e})},n,t,o)}showPopup(e,t,n,r,i){const o=e?this.createBean(new jj(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const s=document.createElement("div");let a;mW(s,"presentation"),s.classList.add("ag-menu"),i||s.classList.add("ag-filter-menu"),[this.tabListener]=this.addManagedElementListeners(s,{keydown:e=>this.trapFocusWithin(e,s)}),s.appendChild(o?.getGui());const l=this.menuService.isColumnMenuAnchoringEnabled()?r??this.ctrlsService.getGridBodyCtrl().getGui():void 0,c=this.localeService.getLocaleTextFunc(),u=i&&"columnFilter"!==n?c("ariaLabelColumnMenu","Column Menu"):c("ariaLabelColumnFilter","Column Filter"),d=this.popupService.addPopup({modal:!0,eChild:s,closeOnEsc:!0,closedCallback:t=>{e.setMenuVisible(!1,"contextMenu");const i=t instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),i&&r&&UW(r)){const e=this.focusService.findTabbableParent(r);e&&e.focus()}o?.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,n,e)},positionCallback:()=>t(s),anchorToElement:l,ariaLabel:u});d&&(this.hidePopup=a=d.hideFunc),o.afterInit().then(()=>{t(s),o.afterGuiAttached({container:n,hidePopup:a})}),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,n,e)}trapFocusWithin(e,t){e.key!==Bz.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,n){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:n??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},RU=class extends nB{constructor(){super(...arguments),this.beanName="resizeObserverService"}observeResize(e,t){const n=gV(this.gos).ResizeObserver,r=n?new n(t):null;return r?.observe(e),()=>r?.disconnect()}},EU=class extends nB{constructor(){super(...arguments),this.beanName="animationFrameService",this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){const e=this.paginationService?.getCurrentPage()??0;e!==this.lastPage&&(this.lastPage=e,this.scrollGoingDown=!0)}this.lastScrollTop=e}postConstruct(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&NH(`AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,n){this.verifyAnimationFrameOn(n);const r={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[n],r),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((e,n)=>e.index!==n.index?t*(n.index-e.index):n.createOrder-e.createOrder),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,n=t.list,r=this.createTasksP2,i=r.list,o=this.destroyTasks,s=(new Date).getTime();let a=(new Date).getTime()-s;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let e;if(n.length)this.sortTaskList(t),e=n.pop().task;else if(i.length)this.sortTaskList(r),e=i.pop().task;else{if(!o.length){this.cancelledTasks.clear();break}e=o.pop()}this.cancelledTasks.has(e)||e()}a=(new Date).getTime()-s}n.length||i.length||o.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=gV(this.gos);t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask(()=>{t=!1,e()})):window.setTimeout(e,0)}}},TU=class extends nB{constructor(){super(...arguments),this.beanName="expansionService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.isClientSideRowModel=nV(this.gos)}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode(e=>{e.id&&t.has(e.id)&&(e.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode(t=>{let{expanded:n,id:r}=t;n&&r&&e.push(r)}),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,n,r){e&&(n&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,n,r),e.setExpanded(t,void 0,r))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},kU=class extends nB{constructor(){super(...arguments),this.beanName="menuService"}wireBeans(e){this.valueService=e.valueService,this.filterMenuFactory=e.filterMenuFactory,this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.filterManager=e.filterManager,this.rowRenderer=e.rowRenderer,this.columnChooserFactory=e.columnChooserFactory,this.contextMenuFactory=e.contextMenuFactory,this.enterpriseMenuFactory=e.enterpriseMenuFactory}postConstruct(){this.activeMenuFactory=this.enterpriseMenuFactory??this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,n){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,n)}getContextMenuPosition(e,t){const n=this.getRowCtrl(e),r=this.getCellGui(n,t);if(!r)return n?{x:0,y:n.getRowYPosition()}:{x:0,y:0};const i=r.getBoundingClientRect();return{x:i.x+i.width/2,y:i.y+i.height/2}}showContextMenu(e){const t=e.rowNode,n=e.column;let{anchorToElement:r,value:i}=e;t&&n&&null==i&&(i=this.valueService.getValueForDisplay(n,t)),null==r&&(r=this.getContextMenuAnchorElement(t,n)),this.contextMenuFactory?.onContextMenu(e.mouseEvent??null,e.touchEvent??null,t??null,n??null,i,r)}showColumnChooser(e){this.columnChooserFactory?.showColumnChooser(e)}hidePopupMenu(){this.contextMenuFactory?.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){this.columnChooserFactory?.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:n}=e.getColDef();return!(n??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){const t=e&&TB(e)?e.getColDef():e?.getColGroupDef();return!t?.suppressHeaderContextMenu&&"new"===this.getColumnMenuType()}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(fz()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.filterManager?.isFilterAllowed(e)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return"new"===this.getColumnMenuType()}isLegacyMenuEnabled(){return"legacy"===this.getColumnMenuType()}isFloatingFilterButtonEnabled(e){const t=e.getColDef(),n=t.floatingFilterComponentParams?.suppressFilterButton;return null!=n&&NH("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),null==t.suppressFloatingFilterButton?!n:!t.suppressFloatingFilterButton}getColumnMenuType(){return this.gos.get("columnMenu")}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?!!this.gos.exists("suppressMenuHide")&&e:e}showColumnMenuCommon(e,t,n,r){const{positionBy:i}=t,o=t.column;if("button"===i){const{buttonElement:i}=t;e.showMenuAfterButtonClick(o,i,n,r)}else if("mouse"===i){const{mouseEvent:i}=t;e.showMenuAfterMouseEvent(o,i,n,r)}else o&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(o,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const t=this.ctrlsService.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);t&&e.showMenuAfterButtonClick(o,t.getAnchorElementForMenu(r),n,!0)}))}getRowCtrl(e){const{rowIndex:t,rowPinned:n}=e||{};if(null!=t)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n})||void 0}getCellGui(e,t){if(!e||!t)return;const n=e.getCellCtrl(t);return n?.getGui()||void 0}getContextMenuAnchorElement(e,t){const n=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),r=this.getRowCtrl(e);if(!r)return n;const i=this.getCellGui(r,t);return i||(r.isFullWidth()?r.getFullWidthElement():n)}},MU={selector:"AG-INPUT-TEXT-AREA",component:class extends jz{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const n=super.setValue(e,t);return this.eInput.value=e,n}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}},PU=class extends Jz{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){hV(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedElementListeners(e,{keydown:e=>{cG(this.gos,e,t.node,t.column,!0)||t.onKeyDown(e)}})}},IU=class extends Jz{constructor(e){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${e.getTemplate()}\n            </div>`,e.getAgComponents()),this.cellEditorInput=e,this.eInput=Rz}init(e){this.params=e;const{cellStartedEdit:t,eventKey:n,suppressPreventDefault:r}=e,i=this.eInput;let o;this.cellEditorInput.init(i,e);let s=!0;t?(this.focusAfterAttached=!0,n===Bz.BACKSPACE||n===Bz.DELETE?o="":n&&1===n.length?r?s=!1:o=n:(o=this.cellEditorInput.getStartValue(),n!==Bz.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,o=this.cellEditorInput.getStartValue()),s&&null!=o&&i.setStartValue(o),this.addManagedElementListeners(i.getGui(),{keydown:e=>{const{key:t}=e;t!==Bz.PAGE_UP&&t!==Bz.PAGE_DOWN||e.preventDefault()}})}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;dz()||t.getFocusableElement().focus();const n=t.getInputElement();this.highlightAllOnFocus?n.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),n=e.getInputElement();t.focus(),n.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},AU=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" data-ref="eInput"></ag-input-text-field>'}getAgComponents(){return[dG]}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return $H(e)||$H(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=$H(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},DU=class extends IU{constructor(){super(new AU)}},FU=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" data-ref="eInput"></ag-input-number-field>'}getAgComponents(){return[pG]}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step);const n=e.getInputElement();t.preventStepping?e.addManagedElementListeners(n,{keydown:this.preventStepping}):t.showStepperButtons&&n.classList.add("ag-number-field-input-stepper")}preventStepping(e){e.key!==Bz.UP&&e.key!==Bz.DOWN||e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!$H(e)&&!$H(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"===typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}setCaret(){dz()&&this.eInput.getInputElement().focus({preventScroll:!0})}},OU={selector:"AG-INPUT-DATE-FIELD",component:class extends uG{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=dz();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){mV(this.gos)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?EG(e??null,!1)??void 0:e;return this.min===t||(this.min=t,ZW(this.eInput,"min",t)),this}setMax(e){const t=e instanceof Date?EG(e??null,!1)??void 0:e;return this.max===t||(this.max=t,ZW(this.eInput,"max",t)),this}setStep(e){return this.step===e||(this.step=e,ZW(this.eInput,"step",e)),this}getDate(){if(this.eInput.validity.valid)return MG(this.getValue())??void 0}setDate(e,t){this.setValue(EG(e??null,!1),t)}}},NU=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[OU]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return $H(e)||$H(this.params.value)?e??null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return EG(e,!1)}},LU=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[OU]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return $H(e)||$H(this.params.value)?this.params.parseValue(e??""):this.params.value}getStartValue(){return EG(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):MG(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):EG(e??null,!1)??void 0}},_U=class{constructor(e){this.cellValueChanges=e}},HU=class extends _U{constructor(e,t,n,r){super(e),this.initialRange=t,this.finalRange=n,this.ranges=r}},VU=class{constructor(e){this.actionStack=[],this.maxStackSize=e||10,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};function BU(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(t,n),"ensureVisible")}function WU(e,t,n){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureIndexVisible(t,n),"ensureVisible")}var zU={version:WG,moduleName:"@ag-grid-community/edit-core",beans:[class extends nB{constructor(){super(...arguments),this.beanName="editService"}wireBeans(e){this.navigationService=e.navigationService,this.userComponentFactory=e.userComponentFactory,this.valueService=e.valueService}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i=this.createCellEditorParams(e,t,n),o=e.getColumn().getColDef(),s=this.userComponentFactory.getCellEditorDetails(o,i),a=null!=s?.popupFromSelector?s.popupFromSelector:!!o.cellEditorPopup,l=null!=s?.popupPositionFromSelector?s.popupPositionFromSelector:o.cellEditorPopupPosition;return e.setEditing(!0,s),e.getComp().setEditDetails(s,a,l,this.gos.get("reactiveCustomComponents")),this.eventService.dispatchEvent(e.createEvent(r,"cellEditingStarted")),!s?.params?.suppressPreventDefault}stopEditing(e,t){const n=e.getComp(),{newValue:r,newValueExists:i}=this.takeValueFromCellEditor(t,n),o=e.getRowNode(),s=e.getColumn(),a=this.valueService.getValueForDisplay(s,o);let l=!1;return i&&(l=this.saveNewValue(e,a,r,o,s)),e.setEditing(!1,void 0),n.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventService.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:r,valueChanged:l}),l}handleColDefChanged(e){const t=e.getCellEditor();if(t?.refresh){const{eventKey:n,cellStartedEdit:r}=e.getEditCompDetails().params,i=this.createCellEditorParams(e,n,r),o=e.getColumn().getColDef(),s=this.userComponentFactory.getCellEditorDetails(o,i);t.refresh(s.params)}}setFocusOutOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){const t=e.getComp(),n=t.getCellEditor();n?.focusIn?n.focusIn():(e.focusCell(!0),e.onCellEditorAttached(()=>t.getCellEditor()?.focusIn?.()))}stopEditingAndFocus(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.stopRowOrCellEdit(),e.focusCell(!0),t||this.navigateAfterEdit(n,e.getCellPosition())}createPopupEditorWrapper(e){return new PU(e)}takeValueFromCellEditor(e,t){const n={newValueExists:!1};if(e)return n;const r=t.getCellEditor();if(!r)return n;if(r.isCancelAfterEnd&&r.isCancelAfterEnd())return n;return{newValue:r.getValue(),newValueExists:!0}}saveNewValue(e,t,n,r,i){if(n===t)return!1;e.setSuppressRefreshCell(!0);const o=r.setDataValue(i,n,"edit");return e.setSuppressRefreshCell(!1),o}createCellEditorParams(e,t,n){const r=e.getColumn(),i=e.getRowNode();return this.gos.addGridCommonParams({value:this.valueService.getValueForDisplay(r,i),eventKey:t,column:r,colDef:r.getColDef(),rowIndex:e.getCellPosition().rowIndex,node:i,data:i.data,cellStartedEdit:n,onKeyDown:e.onKeyDown.bind(e),stopEditing:e.stopEditingAndFocus.bind(e),eGridCell:e.getGui(),parseValue:t=>this.valueService.parseValue(r,i,t,e.getValue()),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const n=e?Bz.UP:Bz.DOWN;this.navigationService.navigateToNextCell(null,n,t,!1)}}}]},jU={version:WG,moduleName:"@ag-grid-community/edit-api",apiFunctions:{undoCellEditing:function(e){e.undoRedoService?.undo("api")},redoCellEditing:function(e){e.undoRedoService?.redo("api")},getCellEditorInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellEditorInstances(t).map(Tj)},getEditingCells:function(e){return e.rowRenderer.getEditingCells()},stopEditing:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.rowRenderer.stopEditing(t)},startEditingCell:function(e,t){const n=e.columnModel.getCol(t.colKey);if(!n)return void NH(`no column found for ${t.colKey}`);const r={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:n};null==t.rowPinned&&WU(e,t.rowIndex),BU(e,t.colKey);const i=e.navigationService.getCellByPosition(r);if(!i)return;const{focusService:o,gos:s}=e,a=s.get("stopEditingWhenCellsLoseFocus")&&(()=>{const e=mV(s),t=i.getGui();return e!==t&&!!t?.contains(e)})();!a&&o.isCellFocused(r)||o.setFocusedCell({...r,forceBrowserFocus:a,preventScrollOnBrowserFocus:!0}),i.startRowOrCellEdit(t.key)},getCurrentUndoSize:function(e){return e.undoRedoService?.getCurrentUndoStackSize()??0},getCurrentRedoSize:function(e){return e.undoRedoService?.getCurrentRedoStackSize()??0}},dependantModules:[zU]},GU={version:WG,moduleName:"@ag-grid-community/undo-redo-edit",beans:[class extends nB{constructor(){super(...arguments),this.beanName="undoRedoService",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},n=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),r=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(n||r||this.isPasting||this.isRangeInAction))return;const{rowPinned:i,rowIndex:o,column:s,oldValue:a,value:l}=e,c={rowPinned:i,rowIndex:o,columnId:s.getColId(),newValue:l,oldValue:a};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}wireBeans(e){this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.columnModel=e.columnModel,this.rangeService=e.rangeService}postConstruct(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");if(e<=0)return;this.undoStack=new VU(e),this.redoStack=new VU(e),this.addListeners();const t=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:e=>{e.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:t,newColumnsLoaded:t,columnGroupOpened:t,columnRowGroupChanged:t,columnMoved:t,columnPinned:t,columnVisible:t,rowDragEnd:t}),this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){this.eventService.dispatchEvent({type:"undoStarted",source:e});const t=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo");this.eventService.dispatchEvent({type:"undoEnded",source:e,operationPerformed:t})}redo(e){this.eventService.dispatchEvent({type:"redoStarted",source:e});const t=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo");this.eventService.dispatchEvent({type:"redoEnded",source:e,operationPerformed:t})}undoRedo(e,t,n,r,i){if(!e)return!1;const o=e.pop();return!(!o||!o.cellValueChanges)&&(this.processAction(o,e=>e[r],i),o instanceof HU?this.processRange(this.rangeService,o.ranges||[o[n]]):this.processCell(o.cellValueChanges),t.push(o),!0)}processAction(e,t,n){e.cellValueChanges.forEach(e=>{const{rowIndex:r,rowPinned:i,columnId:o}=e,s={rowIndex:r,rowPinned:i},a=this.rowPositionUtils.getRowNode(s);a.displayed&&a.setDataValue(o,t(e),n)})}processRange(e,t){let n;e.removeAllCellRanges(!0),t.forEach((r,i)=>{if(!r)return;const o=r.startRow,s=r.endRow;i===t.length-1&&(n={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:r.startColumn.getColId()},this.setLastFocusedCell(n));const a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:r.startColumn,columns:r.columns};e.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:n,rowPinned:r}=t,i={rowIndex:n,rowPinned:r},o=this.rowPositionUtils.getRowNode(i),s={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(s,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:n,columnId:r,rowPinned:i}=e,o=this.gridBodyCtrl.getScrollFeature(),s=this.columnModel.getCol(r);if(!s)return;o.ensureIndexVisible(n),o.ensureColumnVisible(s);const a={rowIndex:n,column:s,rowPinned:i};this.focusService.setFocusedCell({...a,forceBrowserFocus:!0}),t?.setRangeToCell(a)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new _U(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const e=new _U(this.cellValueChanges);this.pushActionsToUndoStack(e)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new _U(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new HU(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;e=this.rangeService&&PV(this.gos)?new HU(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new _U(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}}],dependantModules:[zU]},$U={version:WG,moduleName:"@ag-grid-community/full-row-edit",beans:[class extends nB{constructor(){super(...arguments),this.beanName="rowEditService"}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=!0;const o=e.getAllCellCtrls().reduce((e,o)=>{const s=o===n;return s?i=o.startEditing(t,s,r):o.startEditing(null,s,r),!!e||o.isEditing()},!1);return o&&this.setEditing(e,!0),i}stopEditing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.getAllCellCtrls(),r=e.isEditing();e.setStoppingRowEdit(!0);let i=!1;for(const o of n){const e=o.stopEditing(t);r&&!t&&!i&&e&&(i=!0)}i&&this.eventService.dispatchEvent(e.createRowEvent("rowValueChanged")),r&&this.setEditing(e,!1),e.setStoppingRowEdit(!1)}setEditing(e,t){e.setEditingRow(t),e.forEachGui(void 0,e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t));const n=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventService.dispatchEvent(n)}}],dependantModules:[zU]},UU={version:WG,moduleName:"@ag-grid-community/default-editor",userComponents:[{name:"agCellEditor",classImp:DU}],dependantModules:[zU]},KU={version:WG,moduleName:"@ag-grid-community/data-type-editors",userComponents:[{name:"agTextCellEditor",classImp:DU},{name:"agNumberCellEditor",classImp:class extends IU{constructor(){super(new FU)}},params:{suppressPreventDefault:!0}},{name:"agDateCellEditor",classImp:class extends IU{constructor(){super(new NU)}}},{name:"agDateStringCellEditor",classImp:class extends IU{wireBeans(e){this.dataTypeService=e.dataTypeService}constructor(){super(new LU(()=>this.dataTypeService))}}},{name:"agCheckboxCellEditor",classImp:class extends Jz{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[$z]),this.eCheckbox=Rz}init(e){this.params=e;const t=e.value??void 0;this.eCheckbox.setValue(t);this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(this.eCheckbox,{fieldValueChanged:e=>this.setAriaLabel(e.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),n=PW(t,e),r=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${r} (${n})`)}}}],dependantModules:[UU]},YU={version:WG,moduleName:"@ag-grid-community/select-editor",userComponents:[{name:"agSelectCellEditor",classImp:class extends Jz{constructor(){super('<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" data-ref="eSelect"></ag-select>\n            </div>',[iG]),this.eSelect=Rz,this.startedByEnter=!1}wireBeans(e){this.valueService=e.valueService}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:n,gos:r}=this,{values:i,value:o,eventKey:s}=e;if(UH(i))return void NH("no values found for select cellEditor");this.startedByEnter=null!=s&&s===Bz.ENTER;let a=!1;i.forEach(r=>{const i={value:r},s=n.formatValue(e.column,null,r),l=null!==s&&void 0!==s;i.text=l?s:r,t.addOption(i),a=a||o===r}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;null!=l&&t.setPickerGap(l),null!=u&&t.setPickerMaxHeight(u),null!=c&&t.setPickerMaxWidth(c),"fullRow"!==r.get("editType")&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}}],dependantModules:[zU]},qU={version:WG,moduleName:"@ag-grid-community/editing",dependantModules:[zU,GU,$U,{version:WG,moduleName:"@ag-grid-community/all-editors",dependantModules:[UU,KU,YU,{version:WG,moduleName:"@ag-grid-community/large-text-editor",userComponents:[{name:"agLargeTextCellEditor",classImp:class extends Jz{constructor(){super('<div class="ag-large-text">\n        <ag-input-text-area data-ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',[MU]),this.eTextArea=Rz}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),$H(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===Bz.LEFT||t===Bz.UP||t===Bz.RIGHT||t===Bz.DOWN||e.shiftKey&&t===Bz.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return $H(e)||$H(this.params.value)?this.params.parseValue(e):this.params.value}}}],dependantModules:[zU]}]},jU]},XU=class extends nB{constructor(){super(...arguments),this.beanName="autoWidthCalculator"}wireBeans(e){this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const n=this.getHeaderCellForColumn(e);if(!n)return-1;const r=this.rowRenderer.getAllCellsForColumn(e);return t||r.push(n),this.addElementsToContainerAndGetWidth(r)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const n=this.centerRowContainerCtrl.getContainerElement();e.forEach(e=>this.cloneItemIntoDummy(e,t)),n.appendChild(t);const r=t.offsetWidth;n.removeChild(t);return r+this.getAutoSizePadding()}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(n=>{const r=n.getHtmlElementForColumnHeader(e);null!=r&&(t=r)}),t}cloneItemIntoDummy(e,t){const n=e.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";const r=document.createElement("div"),i=r.classList;["ag-header-cell","ag-header-group-cell"].some(e=>n.classList.contains(e))?(i.add("ag-header","ag-header-row"),r.style.position="static"):i.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(e=>o.classList.contains(e))){for(let e=0;e<o.classList.length;e++){const t=o.classList[e];"ag-row-position-absolute"!=t&&i.add(t)}break}o=o.parentElement}r.appendChild(n),t.appendChild(r)}},QU=class extends nB{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.isClientSide=nV(this.gos),this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl}),this.resetStickyContainers()}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventService.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getExtraTopHeight(){return this.extraTopHeight}getExtraBottomHeight(){return this.extraBottomHeight}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.childStore?.getStoreBounds();return e.footer&&(t=e.sibling.childStore?.getStoreBounds()),(t?.heightPx??0)+(t?.topPx??0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){if(e.footer&&0===e.rowIndex)return Number.MAX_SAFE_INTEGER;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.footer?e.sibling:e;for(;t.isExpandable()&&t.expanded;)if(t.master)t=t.detailNode;else if(t.childrenAfterSort){if(0===t.childrenAfterSort.length)break;t=VV(t.childrenAfterSort)}return t.rowTop+t.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t="top"===e;let n=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,n);const r=t?this.rowRenderer.getFirstVisibleVerticalPixel()-this.extraTopHeight:this.rowRenderer.getLastVisibleVerticalPixel()-this.extraTopHeight,i=new Set,o=e=>{if(i.add(e),t){const t=this.getLastPixelOfGroup(e),i=r+n+e.rowHeight;e.stickyRowTop=t<i?n+(t-i):n}else{const t=this.getFirstPixelOfGroup(e),i=r-(n+e.rowHeight);e.stickyRowTop=t>i?n-(t-i):n}n=0,i.forEach(e=>{const t=e.stickyRowTop+e.rowHeight;n<t&&(n=t)})},s=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=t=>{if(!t.displayed)return!1;if(t.footer){if(!0===s)return!1;if("grand"===s&&-1===t.level)return!1;if("group"===s&&t.level>-1)return!1;const n=!!t.sibling.rowIndex&&t.sibling.rowIndex+1===t.rowIndex;if("bottom"===e&&n)return!1;return!i.has(t)}if(t.isExpandable()){if(!0===a)return!1;if("bottom"===e)return!1;return!i.has(t)&&t.expanded}return!1};for(let c=0;c<100;c++){let e=r+n;t||(e=r-n);const i=this.rowModel.getRowIndexAtPixel(e),s=this.rowModel.getRow(i);if(null==s)break;const a=this.getStickyAncestors(s).find(e=>(t?e.rowIndex<i:e.rowIndex>i)&&l(e));if(a){o(a);continue}if(!(t?s.rowTop<e:s.rowTop+s.rowHeight>e)||!l(s))break;o(s)}return t||i.forEach(e=>{e.stickyRowTop=n-(e.stickyRowTop+e.rowHeight)}),this.refreshNodesAndContainerHeight(e,i,n)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(!0===e)return!0;const t=!!this.gos.get("groupIncludeFooter")||"group"===e,n=!!this.gos.get("groupIncludeTotalFooter")||"grand"===e;return!(!t||!n)||(n?"grand":!!t&&"group")}canRowsBeSticky(){const e=bV(this.gos),t=this.areFooterRowsStickySuppressed(),n=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!n)}getStickyAncestors(e){const t=[];let n=e.footer?e.sibling:e.parent;for(;n;)n.sibling&&t.push(n.sibling),t.push(n),n=n.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some(t=>t.getRowNode()===e)){for(let n=0;n<this.stickyTopRowCtrls.length;n++){const r=this.stickyTopRowCtrls[n].getRowNode();r!==e&&t.add(r)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows()}else{for(let n=0;n<this.stickyBottomRowCtrls.length;n++){const r=this.stickyBottomRowCtrls[n].getRowNode();r!==e&&t.add(r)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(e,t,n){const r="top"===e,i=r?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,o={},s=[];for(let h=0;h<i.length;h++){const e=i[h].getRowNode();!t.has(e)?(o[e.id]=i[h],e.sticky=!1):s.push(i[h])}const a=new Set;for(let h=0;h<s.length;h++)a.add(s[h].getRowNode());const l=[];t.forEach(e=>{a.has(e)||(e.sticky=!0,l.push(this.createRowCon(e,!1,!1)))});let c=!!l.length||s.length!==i.length;r?this.topContainerHeight!==n&&(this.topContainerHeight=n,this.gridBodyCtrl.setStickyTopHeight(n),c=!0):this.bottomContainerHeight!==n&&(this.bottomContainerHeight=n,this.gridBodyCtrl.setStickyBottomHeight(n),c=!0),this.destroyRowCtrls(o,!1);const u=[...s,...l];u.sort((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex),r||u.reverse(),u.forEach(e=>e.setRowTop(e.getRowNode().stickyRowTop));let d=0;return r?(t.forEach(e=>{e.rowIndex<this.pageBoundsService.getFirstRow()&&(d+=e.rowHeight)}),d>this.topContainerHeight&&(d=this.topContainerHeight),this.setOffsetTop(d)):(t.forEach(e=>{e.rowIndex>this.pageBoundsService.getLastRow()&&(d+=e.rowHeight)}),d>this.bottomContainerHeight&&(d=this.bottomContainerHeight),this.setOffsetBottom(d)),!!c&&(r?this.stickyTopRowCtrls=u:this.stickyBottomRowCtrls=u,!0)}ensureRowHeightsValid(){let e=!1;const t=t=>{const n=t.getRowNode();if(n.rowHeightEstimated){const t=lV(this.gos,n);n.setRowHeight(t.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}},JU=class extends nB{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach(e=>e.onCellSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(e=>e.updateRangeBordersIfRangeCount())},n=()=>{this.eventService.addEventListener("cellSelectionChanged",e),this.eventService.addEventListener("columnMoved",t),this.eventService.addEventListener("columnPinned",t),this.eventService.addEventListener("columnVisible",t)},r=()=>{this.eventService.removeEventListener("cellSelectionChanged",e),this.eventService.removeEventListener("columnMoved",t),this.eventService.removeEventListener("columnPinned",t),this.eventService.removeEventListener("columnVisible",t)};this.addDestroyFunc(()=>r()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{PV(this.gos)?n():r()});PV(this.gos)&&n()}}wireBeans(e){this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusService=e.focusService,this.beans=e,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",e=>this.onSuppressCellFocusChanged(e.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection","rowSelection"],()=>this.redrawRows()),bV(this.gos)&&(nV(this.gos)||rV(this.gos))&&(this.stickyRowFeature=this.createManagedBean(new QU(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))),this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=iV(this.gos,"print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new ZU(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=bB(this.rowCtrlsByRowIndex),t=bB(this.zombieRowCtrls),n=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||n.length>0?this.allRowCtrls=[...e,...t,...n]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onSuppressCellFocusChanged(e)),this.getFullWidthRowCtrls().forEach(t=>t.onSuppressCellFocusChanged(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>{this.onCellFocusChanged(e)},cellFocusCleared:()=>this.onCellFocusChanged(),flashCells:e=>{this.getAllCellCtrls().forEach(t=>t.onFlashCells(e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();this.columnModel.getCols().forEach(e=>{const t=t=>{this.getAllCellCtrls().forEach(n=>{n.getColumn()===e&&t(n)})},n=()=>{t(e=>e.onLeftChanged())},r=()=>{t(e=>e.onWidthChanged())},i=()=>{t(e=>e.onFirstRightPinnedChanged())},o=()=>{t(e=>e.onLastLeftPinnedChanged())},s=()=>{t(e=>e.onColDefChanged())};e.addEventListener("leftChanged",n),e.addEventListener("widthChanged",r),e.addEventListener("firstRightPinnedChanged",i),e.addEventListener("lastLeftPinnedChanged",o),e.addEventListener("colDefChanged",s),this.destroyFuncsForColumnListeners.push(()=>{e.removeEventListener("leftChanged",n),e.removeEventListener("widthChanged",r),e.removeEventListener("firstRightPinnedChanged",i),e.removeEventListener("lastLeftPinnedChanged",o),e.removeEventListener("colDefChanged",s)})})}onDomLayoutChanged(){const e=iV(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),n=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach(n=>{const r=n.getCellElement(e);r&&t.push(r)}),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){const{pinnedRowModel:n,beans:r,printLayout:i}=this,o=Object.fromEntries(e.map(e=>[e.getRowNode().id,e]));n.forEachPinnedRow(t,(s,a)=>{const l=e[a];l&&void 0===n.getPinnedRowById(l.getRowNode().id,t)&&(l.destroyFirstPass(),l.destroySecondPass()),s.id in o?(e[a]=o[s.id],delete o[s.id]):e[a]=new Y$(s,r,!1,!1,i)});const s="top"===t?n.getPinnedTopRowCount():n.getPinnedBottomRowCount();e.length=s}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else{if(this.cachedRowCtrls?.has(e))return void this.cachedRowCtrls.removeRow(e);{const t=t=>{const n=t[e.rowIndex];n&&n.getRowNode()===e&&(n.destroyFirstPass(),n.destroySecondPass(),t[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":t(this.topRowCtrls);break;case"bottom":t(this.bottomRowCtrls);break;default:t(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(null!=e)return e?.forEach(e=>this.redrawRow(e,!0)),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e?.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const n=mV(this.gos),r=dV(this.gos,n,$$.DOM_DATA_KEY_CELL_CTRL),i=dV(this.gos,n,Y$.DOM_DATA_KEY_ROW_CTRL);return r||i?t:null}redrawAfterModelUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const n=!e.domLayoutChanged&&!!e.recycleRows,r=e.animate&&wV(this.gos),i=n?this.getRowsToRecycle():null;if(n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature){this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}this.recycleRows(i,r),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,n=this.gos.get("suppressScrollOnNewData");t&&!n&&(this.gridBodyCtrl.getScrollFeature().scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let t=this.pageBoundsService.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0,this.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&this.focusService.restoreFocusedCell(e,()=>{this.onCellFocusChanged(this.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))})}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getAllRowCtrls().forEach(t=>{t.stopEditing(e)})}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),n=t.length;for(let r=0;r<n;r++){const n=t[r].getAllCellCtrls(),i=n.length;for(let t=0;t<i;t++)e.push(n[t])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],n=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const r in this.rowCtrlsByRowIndex)n.push(this.rowCtrlsByRowIndex[r]);return n}addRenderedRowListener(e,t,n){const r=this.rowCtrlsByRowIndex[t];r&&r.addEventListener(e,n)}flashCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getCellCtrls(e.rowNodes,e.columns).forEach(t=>t.flashCell(e))}refreshCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const n of this.getCellCtrls(e.rowNodes,e.columns))n.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=null;this.stickyRowFeature&&mz()&&(t=this.getCellToRestoreFocusToAfterRefresh()||null);for(const n of this.getRowCtrls(e)){if(!n.isFullWidth())continue;n.refreshFullWidth()||this.redrawRow(n.getRowNode(),!0)}this.dispatchDisplayedRowsChanged(!1),t&&this.restoreFocusedCell(t)}getCellRendererInstances(e){const t=this.getCellCtrls(e.rowNodes,e.columns).map(e=>e.getCellRenderer()).filter(e=>null!=e);if(e.columns?.length)return t;const n=[],r=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach(e=>{if(r&&!this.isRowInMap(e.getRowNode(),r))return;if(!e.isFullWidth())return;const t=e.getFullWidthCellRenderers();for(let r=0;r<t.length;r++){const e=t[r];null!=e&&n.push(e)}}),[...n,...t]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach(e=>{const n=e.getCellEditor();n&&t.push(n)}),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach(t=>{if(t.isEditing()){const n=t.getCellPosition();e.push(n)}}),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach(e=>{const n=e.id;switch(e.rowPinned){case"top":t.top[n]=e;break;case"bottom":t.bottom[n]=e;break;default:t.normal[n]=e}}),t}isRowInMap(e,t){const n=e.id;switch(e.rowPinned){case"top":return null!=t.top[n];case"bottom":return null!=t.bottom[n];default:return null!=t.normal[n]}}getRowCtrls(e){const t=this.mapRowNodes(e),n=this.getAllRowCtrls();return e&&t?n.filter(e=>{const n=e.getRowNode();return this.isRowInMap(n,t)}):n}getCellCtrls(e,t){let n;$H(t)&&(n={},t.forEach(e=>{const t=this.columnModel.getCol(e);$H(t)&&(n[t.getId()]=!0)}));const r=[];return this.getRowCtrls(e).forEach(e=>{e.getAllCellCtrls().forEach(e=>{const t=e.getColumn().getId();n&&!n[t]||r.push(e)})}),r}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];mB(this.rowCtrlsByRowIndex,(t,n)=>{null==n.getRowNode().id&&e.push(t)}),this.removeRowCtrls(e);const t={};return mB(this.rowCtrlsByRowIndex,(e,n)=>{const r=n.getRowNode();t[r.id]=n}),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach(e=>{const n=this.rowCtrlsByRowIndex[e];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]})}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{afterScroll:t}=e;let n;this.stickyRowFeature&&mz()&&(n=this.getCellToRestoreFocusToAfterRefresh()||void 0);const r=this.firstRenderedRow,i=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let o=!1;if(this.stickyRowFeature){o=this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}const s=this.firstRenderedRow!==r||this.lastRenderedRow!==i;if((!t||o||s)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!o),null!=n)){const e=this.getCellToRestoreFocusToAfterRefresh();null!=n&&null==e&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(n))}}removeRowCompsNotToDraw(e,t){const n={};e.forEach(e=>n[e]=!0);const r=Object.keys(this.rowCtrlsByRowIndex).filter(e=>!n[e]);this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){const t=function(e,t){const n=[];for(let r=e;r<=t;r++)n.push(r);return n}(this.firstRenderedRow,this.lastRenderedRow),n=(e,n)=>{const r=n.getRowNode().rowIndex;null!=r&&(r<this.firstRenderedRow||r>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(r)};mB(this.rowCtrlsByRowIndex,n),mB(e,n),t.sort((e,t)=>e-t);const r=[];for(let i=0;i<t.length;i++){const e=t[i],n=this.rowModel.getRow(e);n&&!n.sticky&&r.push(e)}return r}recycleRows(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.calculateIndexesToDraw(e);(this.printLayout||n)&&(t=!1),this.removeRowCompsNotToDraw(r,!t);const i=[];if(r.forEach(r=>{const o=this.createOrUpdateRowCtrl(r,e,t,n);$H(o)&&i.push(o)}),e){n&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.eventService.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const e=this.visibleColsService.isPinningLeft(),t=this.visibleColsService.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach(t=>{const n=t.getRowNode().rowIndex;e.push(n.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter(e=>{if(!e.isFullWidth())return!1;const n=e.getRowNode();return!(null!=t&&!this.isRowInMap(n,t))})}createOrUpdateRowCtrl(e,t,n,r){let i,o=this.rowCtrlsByRowIndex[e];o||(i=this.rowModel.getRow(e),$H(i)&&$H(t)&&t[i.id]&&i.alreadyRendered&&(o=t[i.id],t[i.id]=null));if(!o){if(i||(i=this.rowModel.getRow(e)),!$H(i))return;o=this.createRowCon(i,n,r)}return i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o,o}destroyRowCtrls(e,t){const n=[];mB(e,(e,r)=>{if(r)if(this.cachedRowCtrls&&r.isCacheable())this.cachedRowCtrls.addRow(r);else if(r.destroyFirstPass(!t),t){const e=r.instanceId;this.zombieRowCtrls[e]=r,n.push(()=>{r.destroySecondPass(),delete this.zombieRowCtrls[e]})}else r.destroySecondPass()}),t&&(n.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),HH(n))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*cV(this.gos)}workOutFirstAndLastRowsToRender(){let e,t;if(this.rowContainerHeightService.updateOffset(),this.rowModel.isRowsToRender())if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.pageBoundsService.getFirstRow(),t=this.pageBoundsService.getLastRow();else{const n=this.getRowBufferInPixels(),r=this.ctrlsService.getGridBodyCtrl(),i=this.gos.get("suppressRowVirtualisation");let o,s,a=!1;do{const e=this.pageBoundsService.getPixelOffset(),{pageFirstPixel:t,pageLastPixel:l}=this.pageBoundsService.getCurrentPagePixelRange(),c=this.rowContainerHeightService.getDivStretchOffset(),u=r.getScrollFeature().getVScrollPosition(),d=u.top,h=u.bottom;i?(o=t+c,s=l+c):(o=Math.max(d+e-n,t)+c,s=Math.min(h+e+n,l)+c),this.firstVisibleVPixel=Math.max(d+e,t)+c,this.lastVisibleVPixel=Math.min(h+e,l)+c,a=this.ensureAllRowsInRangeHaveHeightsCalculated(o,s)}while(a);let l=this.rowModel.getRowIndexAtPixel(o),c=this.rowModel.getRowIndexAtPixel(s);const u=this.pageBoundsService.getFirstRow(),d=this.pageBoundsService.getLastRow();l<u&&(l=u),c>d&&(c=d),e=l,t=c}else e=0,t=-1;const n=iV(this.gos,"normal"),r=this.gos.get("suppressMaxRenderedRowRestriction"),i=Math.max(this.getRowBuffer(),500);n&&!r&&t-e>i&&(t=e+i);const o=e!==this.firstRenderedRow,s=t!==this.lastRenderedRow;(o||s)&&(this.firstRenderedRow=e,this.lastRenderedRow=t,this.eventService.dispatchEvent({type:"viewportChanged",firstRow:e,lastRow:t}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const n=this.pinnedRowModel?.ensureRowHeightsValid(),r=this.stickyRowFeature?.ensureRowHeightsValid(),i=this.rowModel.ensureRowHeightsValid(e,t,this.pageBoundsService.getFirstRow(),this.pageBoundsService.getLastRow());return(i||r)&&this.eventService.dispatchEvent({type:"recalculateRowBounds"}),!!(r||i||n)&&(this.updateContainerHeights(),!0)}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const t=!1,n=e.getRowNode(),r=this.focusService.isRowNodeFocused(n),i=e.isEditing(),o=n.detail;if(!(r||i||o))return t;return!!this.isRowPresent(n)||t}isRowPresent(e){return!!this.rowModel.isRowPresent(e)&&(!this.paginationService||this.paginationService.isRowPresent(e))}createRowCon(e,t,n){const r=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(r)return r;const i=this.gos.get("suppressAnimationFrame"),o=n&&!i&&!this.printLayout;return new Y$(e,this.beans,t,o,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map(e=>e.getRowNode())}getRowByPosition(e){let t;const{rowIndex:n}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[n];break;case"bottom":t=this.bottomRowCtrls[n];break;default:t=this.rowCtrlsByRowIndex[n],t||(t=this.getStickyTopRowCtrls().find(e=>e.getRowNode().rowIndex===n)||null,t||(t=this.getStickyBottomRowCtrls().find(e=>e.getRowNode().rowIndex===n)||null))}return t}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},ZU=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.getRowNode()!=e?null:t}has(e){return null!=this.entriesMap[e.id]}removeRow(e){const t=e.id,n=this.entriesMap[t];delete this.entriesMap[t],zV(this.entriesList,n)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],zV(this.entriesList,e)}getEntries(){return this.entriesList}},eK=class extends nB{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows=new tK,this.pinnedBottomRows=new tK}wireBeans(e){this.beans=e}postConstruct(){this.setPinnedRowData(this.gos.get("pinnedTopRowData"),"top"),this.setPinnedRowData(this.gos.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",e=>this.setPinnedRowData(e.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",e=>this.setPinnedRowData(e.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return("top"===e?this.pinnedTopRows:this.pinnedBottomRows).isEmpty()}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const e=e=>{e.setRowHeight(e.rowHeight,!0)};this.pinnedBottomRows.forEach(e),this.pinnedTopRows.forEach(e)}}ensureRowHeightsValid(){let e=!1,t=0;const n=n=>{if(n.rowHeightEstimated){const r=lV(this.gos,n);n.setRowTop(t),n.setRowHeight(r.height),t+=r.height,e=!0}};return this.pinnedBottomRows?.forEach(n),t=0,this.pinnedTopRows?.forEach(n),this.eventService.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventService.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const n="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(void 0===e)return void n.clear();const r=TV(this.gos),i="top"===t?zj.ID_PREFIX_TOP_PINNED:zj.ID_PREFIX_BOTTOM_PINNED,o=n.getIds(),s=[],a=new Set;let l=0,c=-1;for(const u of e){const e=r?.({data:u,level:0,rowPinned:t})??i+this.nextId++;if(a.has(e)){NH("Duplicate ID",e,"found for pinned row with data",u,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter.");continue}c++,a.add(e),s.push(e);const d=n.getById(e);if(void 0!==d)d.data!==u&&d.setData(u),l+=this.setRowTopAndRowIndex(d,l,c),o.delete(e);else{const r=new zj(this.beans);r.id=e,r.data=u,r.rowPinned=t,l+=this.setRowTopAndRowIndex(r,l,c),n.push(r)}}o.forEach(e=>{n.getById(e)?.clearRowTopAndRowIndex()}),n.removeAllById(o),n.setOrder(s)}setRowTopAndRowIndex(e,t,n){return e.setRowTop(t),e.setRowHeight(lV(this.gos,e).height),e.setRowIndex(n),e.rowHeight}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getPinnedTopRowCount(){return this.pinnedTopRows.getSize()}getPinnedBottomRowCount(){return this.pinnedBottomRows.getSize()}getPinnedTopRow(e){return this.pinnedTopRows.getByIndex(e)}getPinnedBottomRow(e){return this.pinnedBottomRows.getByIndex(e)}getPinnedRowById(e,t){return"top"===t?this.pinnedTopRows.getById(e):this.pinnedBottomRows.getById(e)}forEachPinnedRow(e,t){return"top"===e?this.pinnedTopRows.forEach(t):this.pinnedBottomRows.forEach(t)}getTotalHeight(e){const t=e.getSize();if(0===t)return 0;const n=e.getByIndex(t-1);return void 0===n?0:n.rowTop+n.rowHeight}},tK=class{constructor(){this.cache={},this.ordering=[]}getById(e){return this.cache[e]}getByIndex(e){const t=this.ordering[e];return this.cache[t]}push(e){this.cache[e.id]=e,this.ordering.push(e.id)}removeAllById(e){for(const t of e)delete this.cache[t];this.ordering=this.ordering.filter(t=>!e.has(t))}setOrder(e){this.ordering=e}forEach(e){this.ordering.forEach((t,n)=>{const r=this.cache[t];r&&e(r,n)})}clear(){this.ordering.length=0,this.cache={}}isEmpty(){return 0===this.ordering.length}getSize(){return this.ordering.length}getIds(){return new Set(this.ordering)}},nK=class extends nB{constructor(e){super(),this.state="needsLoading",this.version=0,this.id=e}getId(){return this.id}load(){this.state="loading",this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed",this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,n){this.successCommon(e,{rowData:t,rowCount:n})}isRequestMostRecentAndLive(e){const t=e===this.version,n=this.isAlive();return t&&n}successCommon(e,t){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}dispatchLoadCompleted(){const e={type:"loadComplete",success:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],block:this};this.dispatchLocalEvent(e)}},rK={version:WG,moduleName:"@ag-grid-community/row-node-block",beans:[class extends nB{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=zH(this.performCheckBlocksToLoad.bind(this),e))}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){zV(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchLocalEvent({type:"blockLoaded"}),0==this.activeBlockLoadsCount&&this.dispatchLocalEvent({type:"blockLoaderFinished"})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void(this.gos.get("debug")&&OH("RowNodeBlockLoader - checkBlockToLoad: max loads exceeded"));const e=this.getAvailableLoadingCount(),t=this.blocks.filter(e=>"needsLoading"===e.getState()).slice(0,e);this.registerLoads(t.length),t.forEach(e=>e.load()),this.printCacheStatus()}getBlockState(){if(rV(this.gos)){return this.rowModel.getBlockStates()}const e={};return this.blocks.forEach(t=>{const{id:n,state:r}=t.getBlockStateJson();e[n]=r}),e}printCacheStatus(){this.gos.get("debug")&&OH(`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}}]},iK=class{constructor(){this.root=null,this.end=null,this.cachedRange=[]}init(e){this.rowModel=e}reset(){this.root=null,this.end=null,this.cachedRange.length=0}setRoot(e){this.root=e,this.end=null,this.cachedRange.length=0}setEndRange(e){this.end=e,this.cachedRange.length=0}getRange(){if(0===this.cachedRange.length){const e=this.getRoot(),t=this.getEnd();if(null==e||null==t)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)}return this.cachedRange}isInRange(e){return null!==this.root&&this.getRange().some(t=>t.id===e.id)}getRoot(){return this.root&&null===this.root?.key&&(this.root=this.rowModel.getRowNode(this.root.id)??null),this.root}getEnd(){return this.end&&null===this.end?.key&&(this.end=this.rowModel.getRowNode(this.end.id)??null),this.end}truncate(e){const t=this.getRange();if(0===t.length)return{keep:[],discard:[]};const n=t[0].id===this.root.id,r=t.findIndex(t=>t.id===e.id);if(r>-1){const i=t.slice(0,r),o=t.slice(r+1);return this.setEndRange(e),n?{keep:i,discard:o}:{keep:o,discard:i}}return{keep:t,discard:[]}}extend(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getRoot();if(null==n){const n=this.getRange().slice();return t&&e.depthFirstSearch(e=>!e.group&&n.push(e)),n.push(e),this.setRoot(e),{keep:n,discard:[]}}if(this.rowModel.getNodesInRangeForSelection(n,e).find(e=>e.id===this.end?.id))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const t=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:t}}}},oK=class extends nB{constructor(){super(...arguments),this.beanName="stylingService"}wireBeans(e){this.expressionService=e.expressionService}processAllCellClasses(e,t,n,r){this.processClassRules(void 0,e.cellClassRules,t,n,r),this.processStaticCellClasses(e,t,n)}processClassRules(e,t,n,r,i){if(null==t&&null==e)return;const o={},s={},a=(e,t)=>{e.split(" ").forEach(e=>{""!=e.trim()&&t(e)})};if(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const i=e[r],l=t[i];let c;"string"===typeof l?c=this.expressionService.evaluate(l,n):"function"===typeof l&&(c=l(n)),a(i,e=>{c?o[e]=!0:s[e]=!0})}}e&&i&&Object.keys(e).forEach(e=>a(e,e=>{o[e]||(s[e]=!0)})),i&&Object.keys(s).forEach(i),Object.keys(o).forEach(r)}getStaticCellClasses(e,t){const{cellClass:n}=e;if(!n)return[];let r;if("function"===typeof n){r=n(t)}else r=n;return"string"===typeof r&&(r=[r]),r||[]}processStaticCellClasses(e,t,n){this.getStaticCellClasses(e,t).forEach(e=>{n(e)})}},sK=(e=>(e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",e))(sK||{}),aK=class extends nB{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:n,eBottomGuard:r,focusTrapActive:i,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:s,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:d,handleKeyDown:h,eFocusableElement:p}=e;this.comp=t,this.eTopGuard=n,this.eBottomGuard=r,this.providedFocusInnerElement=a,this.eFocusableElement=p,this.focusTrapActive=!!i,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!s,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.createManagedBean(new qj(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty){if(0===this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=pV(this.gos),n=this.focusService.findFocusableElements(t.body,null,!0),r=n.indexOf(e?this.eTopGuard:this.eBottomGuard);if(-1===r)return;let i,o;e?(i=0,o=r):(i=r+1,o=n.length);const s=n.slice(i,o),a=this.gos.get("tabIndex");s.sort((e,t)=>{const n=parseInt(e.getAttribute("tabindex")||"0"),r=parseInt(t.getAttribute("tabindex")||"0");return r===a?1:n===a?-1:0===n?1:0===r?-1:n-r}),s[e?s.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive)return;if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const n=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),n&&(n.focus(),e.preventDefault())}focusInnerElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},lK=class extends nB{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:n,eFocusableElement:r}=this,i=[t,n],o={setTabIndex:e=>{i.forEach(t=>null!=e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex"))}};this.addTabGuards(t,n);const{focusTrapActive:s=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}=e;this.tabGuardCtrl=this.createManagedBean(new aK({comp:o,focusTrapActive:s,eTopGuard:t,eBottomGuard:n,eFocusableElement:r,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=pV(this.gos).createElement("div"),n="top"===e?"ag-tab-guard-top":"ag-tab-guard-bottom";return t.classList.add("ag-tab-guard",n),mW(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];jW(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,n){JW(t)||(t=t.getGui());const{eBottomGuard:r}=this;r?r.insertAdjacentElement("beforebegin",t):e(t,n)}},cK=class extends Ez{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new lK(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},uK=0,dK=class extends nB{constructor(){super(...arguments),this.beanName="popupService",this.popupList=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.resizeObserverService=e.resizeObserverService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:n}=e,r=this.getPopupIndex(n);if(-1!==r){this.popupList[r].alignedToElement=t}const i=t.getBoundingClientRect(),o=this.getParentRect(),s=this.keepXYWithinBounds(n,i.top-o.top,0),a=n.clientWidth>0?n.clientWidth:200;n.style.minWidth=`${a}px`;const l=o.right-o.left-a;let c;function u(){return i.right-o.left-2}function d(){return i.left-o.left-a}this.gos.get("enableRtl")?(c=d(),c<0&&(c=u(),this.setAlignedStyles(n,"left")),c>l&&(c=0,this.setAlignedStyles(n,"right"))):(c=u(),c>l&&(c=d(),this.setAlignedStyles(n,"right")),c<0&&(c=0,this.setAlignedStyles(n,"left"))),n.style.left=`${c}px`,n.style.top=`${s}px`}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:n,nudgeY:r,skipObserver:i}=e;this.positionPopup({ePopup:t,nudgeX:n,nudgeY:r,keepWithinBounds:!0,skipObserver:i,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:n,nudgeY:r,keepWithinBounds:i,eventSource:o,alignSide:s="left",position:a="over",column:l,rowNode:c,type:u}=e,d=o.getBoundingClientRect(),h=this.getParentRect(),p=this.getPopupIndex(t);if(-1!==p){this.popupList[p].alignedToElement=o}this.positionPopup({ePopup:t,nudgeX:n,nudgeY:r,keepWithinBounds:i,updatePosition:()=>{let n,i=d.left-h.left;if("right"===s&&(i-=t.offsetWidth-d.width),"over"===a)n=d.top-h.top,this.setAlignedStyles(t,"over");else{this.setAlignedStyles(t,"under");n="under"===this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)?d.top-h.top+d.height:d.top-t.offsetHeight-2*(r||0)-h.top}return{x:i,y:n}},postProcessCallback:()=>this.callPostProcessPopup(u,t,o,null,l,c)})}shouldRenderUnderOrAbove(e,t,n,r){const i=n.bottom-t.bottom,o=t.top-n.top,s=e.offsetHeight+r;return i>s?"under":o>s||o>i?"above":"under"}setAlignedStyles(e,t){const n=this.getPopupIndex(e);if(-1===n)return;const r=this.popupList[n],{alignedToElement:i}=r;if(!i)return;["right","left","over","above","under"].forEach(t=>{i.classList.remove(`ag-has-popup-positioned-${t}`),e.classList.remove(`ag-popup-positioned-${t}`)}),t&&(i.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,n,r,i,o){const s=this.gos.getCallback("postProcessPopup");if(s){s({column:i,rowNode:o,ePopup:t,type:e,eventSource:n,mouseEvent:r})}}positionPopup(e){var t=this;const{ePopup:n,keepWithinBounds:r,nudgeX:i,nudgeY:o,skipObserver:s,updatePosition:a}=e,l={width:0,height:0},c=function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{x:c,y:u}=a();s&&n.clientWidth===l.width&&n.clientHeight===l.height||(l.width=n.clientWidth,l.height=n.clientHeight,i&&(c+=i),o&&(u+=o),r&&(c=t.keepXYWithinBounds(n,c,1),u=t.keepXYWithinBounds(n,u,0)),n.style.left=`${c}px`,n.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(c(),!s){const e=this.resizeObserverService.observeResize(n,()=>c(!0));setTimeout(()=>e(),200)}}getActivePopups(){return this.popupList.map(e=>e.element)}getPopupList(){return this.popupList}getParentRect(){const e=pV(this.gos);let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),BW(t)}keepXYWithinBounds(e,t,n){const r=0===n,i=r?"clientHeight":"clientWidth",o=r?"top":"left",s=r?"height":"width",a=r?"scrollTop":"scrollLeft",l=pV(this.gos),c=l.documentElement,u=this.getPopupParent(),d=e.getBoundingClientRect(),h=u.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=u===l.body,f=Math.ceil(d[s]);let m=g?(r?HW:VW)(c)+c[a]:u[i];g&&(m-=Math.abs(p[o]-h[o]));const v=m-f;return Math.min(Math.max(t,0),Math.abs(v))}addPopup(e){const t=pV(this.gos),{eChild:n,ariaLabel:r,alwaysOnTop:i,positionCallback:o,anchorToElement:s}=e;if(!t)return NH("could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(n);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(n);const l=this.createPopupWrapper(n,r,!!i),c=this.addEventListenersToPopup({...e,wrapperEl:l});return o&&o(),this.addPopupToPopupList(n,l,c,s),{hideFunc:c}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();$H(e.style.top)||(e.style.top=-1*t.top+"px"),$H(e.style.left)||(e.style.left=-1*t.left+"px")}createPopupWrapper(e,t,n){const r=this.getPopupParent(),i=document.createElement("div");return this.environment.applyThemeClasses(i),i.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||mW(e,"dialog"),vW(e,t),i.appendChild(e),r.appendChild(i),n?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),i}handleThemeChange(e){if(e.themeChanged)for(const t of this.popupList)this.environment.applyThemeClasses(t.wrapper)}addEventListenersToPopup(e){var t=this;const n=pV(this.gos),r=this.getPopupParent(),{wrapperEl:i,eChild:o,closedCallback:s,afterGuiAttached:a,closeOnEsc:l,modal:c}=e;let u=!1;const d=e=>{if(!i.contains(mV(this.gos)))return;e.key!==Bz.ESCAPE||JV(e)||g({keyboardEvent:e})},h=e=>g({mouseEvent:e}),p=e=>g({touchEvent:e}),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mouseEvent:a,touchEvent:l,keyboardEvent:c,forceHide:g}=e;(g||!t.isEventFromCurrentPopup({mouseEvent:a,touchEvent:l},o)&&!u)&&(u=!0,r.removeChild(i),n.removeEventListener("keydown",d),n.removeEventListener("mousedown",h),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",h),t.eventService.removeEventListener("dragStarted",h),s&&s(a||l||c),t.removePopupFromPopupList(o))};return a&&a({hidePopup:g}),window.setTimeout(()=>{l&&n.addEventListener("keydown",d),c&&(n.addEventListener("mousedown",h),this.eventService.addEventListener("dragStarted",h),n.addEventListener("touchstart",p),n.addEventListener("contextmenu",h))},0),g}addPopupToPopupList(e,t,n,r){this.popupList.push({element:e,wrapper:t,hideFunc:n,instanceId:uK++,isAnchored:!!r}),r&&this.setPopupPositionRelatedToElement(e,r)}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const n=this.getPopupIndex(e);if(-1===n)return;const r=this.popupList[n];if(r.stopAnchoringPromise&&r.stopAnchoringPromise.then(e=>e&&e()),r.stopAnchoringPromise=void 0,r.isAnchored=!1,!t)return;const i=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:r.hideFunc});return r.stopAnchoringPromise=i,r.isAnchored=!0,i}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter(t=>t.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),n=t.getBoundingClientRect(),{element:r,ePopup:i}=e,o=r.getBoundingClientRect(),s=e=>parseInt(e.substring(0,e.length-1),10),a=(e,t)=>{const r=n[e]-o[e],a=s(i.style[e]);return{initialDiff:r,lastDiff:r,initial:a,last:a,direction:t}},l=a("top",0),c=a("left",1),u=this.getFrameworkOverrides();return new rj(n=>{u.wrapIncoming(()=>{u.setInterval(()=>{const n=t.getBoundingClientRect(),o=r.getBoundingClientRect();if(0==o.top&&0==o.left&&0==o.height&&0==o.width)return void e.hidePopup();const a=(e,t)=>{const r=s(i.style[t]);e.last!==r&&(e.initial=r,e.last=r);const a=n[t]-o[t];if(a!=e.lastDiff){const n=this.keepXYWithinBounds(i,e.initial+e.initialDiff-a,e.direction);i.style[t]=`${n}px`,e.last=n}e.lastDiff=a};a(l,"top"),a(c,"left")},200).then(e=>{n(()=>{null!=e&&window.clearInterval(e)})})},"popupPositioning")})}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isEventFromCurrentPopup(e,t){const{mouseEvent:n,touchEvent:r}=e,i=n||r;if(!i)return!1;const o=this.getPopupIndex(t);if(-1===o)return!1;for(let s=o;s<this.popupList.length;s++){if(tB(this.popupList[s].element,i))return!0}return this.isElementWithinCustomPopup(i.target)}isElementWithinCustomPopup(e){const t=pV(this.gos);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const n=this.getWrapper(e);n&&(n.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(n))}bringPopupToFront(e){const t=this.getPopupParent(),n=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),r=n.length,i=this.getWrapper(e);if(!i||r<=1||!t.contains(e))return;const o=[],s=[];for(const u of n)u!==i&&(u.classList.contains("ag-always-on-top")?s.push(u):o.push(u));const a=[],l=s.length,c=i.classList.contains("ag-always-on-top")||!l?[...o,...s,i]:[...o,i,...s];for(let u=0;u<=r;u++){const e=c[u];if(n[u]===c[u]||e===i)continue;e.querySelectorAll("div").forEach(e=>{0!==e.scrollTop&&a.push([e,e.scrollTop])}),0===u?t.insertAdjacentElement("afterbegin",e):c[u-1].insertAdjacentElement("afterend",e)}for(;a.length;){const e=a.pop();e[0].scrollTop=e[1]}}},hK=["touchstart","touchend","touchmove","touchcancel"],pK=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"javascript";this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e()}setInterval(e,t){return new rj(n=>{n(window.setInterval(e,t))})}addEventListener(e,t,n,r){const i=$V(hK,t);e.addEventListener(t,n,{capture:!!r,passive:i})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${"solid"===this.frameworkName?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},gK=class extends nB{constructor(){super(...arguments),this.beanName="cellNavigationService"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.pinnedRowModel=e.pinnedRowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}getNextCellToFocus(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const n=e===Bz.UP,r=e===Bz.DOWN,i=e===Bz.LEFT;let o,s;if(n||r)s=n?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow(),o=t.column;else{const e=this.visibleColsService.getAllCols(),n=this.gos.get("enableRtl");s=t.rowIndex,o=i!==n?e[0]:VV(e)}return{rowIndex:s,rowPinned:null,column:o}}getNextCellToFocusWithoutCtrlPressed(e,t){let n=t,r=!1;for(;!r;){switch(e){case Bz.UP:n=this.getCellAbove(n);break;case Bz.DOWN:n=this.getCellBelow(n);break;case Bz.RIGHT:n=this.gos.get("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case Bz.LEFT:n=this.gos.get("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,NH("unknown key for navigation ",e)}r=!n||this.isCellGoodToFocusOn(n)}return n}isCellGoodToFocusOn(e){const t=e.column;let n;switch(e.rowPinned){case"top":n=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":n=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:n=this.rowModel.getRow(e.rowIndex)}if(!n)return!1;return!t.isSuppressNavigable(n)}getCellToLeft(e){if(!e)return null;const t=this.visibleColsService.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.visibleColsService.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,n=e.rowPinned;let r=!1;if(this.isLastRowInContainer(e))switch(n){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.pageBoundsService.getFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}else n&&(r=!0);const i=this.rowModel.getRow(e.rowIndex),o=r?void 0:this.getNextStickyPosition(i);return o||{rowIndex:t+1,rowPinned:n}}getNextStickyPosition(e,t){if(!bV(this.gos)||!e||!e.sticky)return;let n=[];n=this.rowRenderer.getStickyTopRowCtrls().some(t=>t.getRowNode().rowIndex===e.rowIndex)?[...this.rowRenderer.getStickyTopRowCtrls()].sort((e,t)=>e.getRowNode().rowIndex-t.getRowNode().rowIndex):[...this.rowRenderer.getStickyBottomRowCtrls()].sort((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex);const r=t?-1:1,i=n.findIndex(t=>t.getRowNode().rowIndex===e.rowIndex),o=n[i+r];return o?{rowIndex:o.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,n=e.rowIndex;if("top"===t){return this.pinnedRowModel.getPinnedTopRowCount()-1<=n}if("bottom"===t){return this.pinnedRowModel.getPinnedBottomRowCount()-1<=n}return this.pageBoundsService.getLastRow()<=n}getRowAbove(e){const t=e.rowIndex,n=e.rowPinned;let r=!1;if(n?0===t:t===this.pageBoundsService.getFirstRow())return"top"===n?null:n&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;n&&(r=!0);const i=this.rowModel.getRow(e.rowIndex),o=r?void 0:this.getNextStickyPosition(i,!0);return o||{rowIndex:t-1,rowPinned:n}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.pageBoundsService.getLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowCount()-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.visibleColsService.getAllCols();let n=e.rowIndex,r=e.rowPinned,i=this.visibleColsService.getColAfter(e.column);if(!i){i=t[0];const o=this.getRowBelow(e);if(UH(o))return null;if(!o.rowPinned&&!(this.paginationService?.isRowInPage(o)??1))return null;n=o?o.rowIndex:null,r=o?o.rowPinned:null}return{rowIndex:n,column:i,rowPinned:r}}getNextTabbedCellBackwards(e){const t=this.visibleColsService.getAllCols();let n=e.rowIndex,r=e.rowPinned,i=this.visibleColsService.getColBefore(e.column);if(!i){i=VV(t);const o=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(UH(o))return null;if(!o.rowPinned&&!(this.paginationService?.isRowInPage(o)??1))return null;n=o?o.rowIndex:null,r=o?o.rowPinned:null}return{rowIndex:n,column:i,rowPinned:r}}},fK=(e,t)=>{for(const n in t)t[n]=e;return t},mK={...fK("@ag-grid-community/core",{dispatchEvent:0,destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,getState:0,setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0,redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRow:0,getFirstDisplayedRowIndex:0,getLastDisplayedRow:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0,getModel:0,getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0,getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0,addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0,expireValueCache:0,getValue:0,getCellValue:0,showColumnMenuAfterButtonClick:0,showColumnMenuAfterMouseClick:0,showColumnMenu:0,hidePopupMenu:0,onSortChanged:0,getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0,setGridAriaProperty:0,refreshCells:0,flashCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0,addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getColumnDef:0,getColumnDefs:0,sizeColumnsToFit:0,setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumn:0,getDisplayNameForColumnGroup:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnVisible:0,setColumnsVisible:0,setColumnPinned:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0,moveColumn:0,moveColumnByIndex:0,moveColumns:0,setColumnWidth:0,setColumnWidths:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0,autoSizeColumn:0,autoSizeColumns:0,autoSizeAllColumns:0,undoCellEditing:0,redoCellEditing:0,getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0,getCurrentUndoSize:0,getCurrentRedoSize:0,isAnyFilterPresent:0,onFilterChanged:0,isColumnFilterPresent:0,getFilterInstance:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0,paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0,expandAll:0,collapseAll:0,onRowHeightChanged:0,setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...fK("@ag-grid-community/client-side-row-model",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...fK("@ag-grid-community/csv-export",{getDataAsCsv:0,exportDataAsCsv:0}),...fK("@ag-grid-community/infinite-row-model",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...fK("@ag-grid-enterprise/advanced-filter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...fK("@ag-grid-enterprise/charts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...fK("@ag-grid-enterprise/clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...fK("@ag-grid-enterprise/excel-export",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...fK("@ag-grid-enterprise/master-detail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...fK("@ag-grid-enterprise/menu",{showContextMenu:0,showColumnChooser:0,hideColumnChooser:0}),...fK("@ag-grid-enterprise/range-selection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...fK("@ag-grid-enterprise/row-grouping",{addAggFunc:0,addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0,isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumn:0,removeValueColumns:0,addValueColumn:0,addValueColumns:0,setRowGroupColumns:0,removeRowGroupColumn:0,removeRowGroupColumns:0,addRowGroupColumn:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0,setPivotColumns:0,removePivotColumn:0,removePivotColumns:0,addPivotColumn:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...fK("@ag-grid-enterprise/server-side-row-model",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...fK("@ag-grid-enterprise/side-bar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...fK("@ag-grid-enterprise/status-bar",{getStatusPanel:0})},vK={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},wK=(e,t)=>e.eventService.dispatchEvent(t),bK=class{};Reflect.defineProperty(bK,"name",{value:"GridApi"});var CK=class extends nB{constructor(){super(),this.beanName="apiFunctionService",this.api=new bK,this.fns={...vK,dispatchEvent:wK},this.beans=null,this.preDestroyLink="";const{api:e}=this;for(const t in mK)e[t]=this.makeApi(t)[t]}wireBeans(e){this.beans=e}postConstruct(){this.preDestroyLink=this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:n,beans:r}=this;n!==vK&&(n[e]=r?.validationService?.validateApiFunction(e,t)??t)}makeApi(e){var t=this;return{[e]:function(){const{beans:n,fns:{[e]:r}}=t;for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r?r(n,...o):t.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:n,preDestroyLink:r}=this;if(t){const t=mK[e];n.assertModuleRegistered(t,`api.${e}`)&&NH(`API function '${e}' not registered to module '${t}'`)}else NH(`Grid API function ${e}() cannot be called as the grid has been destroyed.\nEither clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\nTo run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${r}`)}destroy(){super.destroy(),this.fns=vK,this.beans=null}};function yK(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionService").api}}var SK=class extends nB{constructor(){super(...arguments),this.beanName="columnDefFactory"}buildColumnDefs(e,t,n){const r=[],i={};return e.forEach(e=>{let o=!0,s=this.createDefFromColumn(e,t,n),a=e.getOriginalParent(),l=null;for(;a;){let e=null;if(a.isPadding()){a=a.getOriginalParent();continue}const t=i[a.getGroupId()];if(t){t.children.push(s),o=!1;break}if(e=this.createDefFromGroup(a),e&&(e.children=[s],i[e.groupId]=e,s=e,a=a.getOriginalParent()),null!=a&&l===a){o=!1;break}l=a}o&&r.push(s)}),r}createDefFromGroup(e){const t=wB(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,n){const r=wB(e.getColDef());return r.colId=e.getColId(),r.width=e.getActualWidth(),r.rowGroup=e.isRowGroupActive(),r.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,r.pivot=e.isPivotActive(),r.pivotIndex=e.isPivotActive()?n.indexOf(e):null,r.aggFunc=e.isValueActive()?e.getAggFunc():null,r.hide=!e.isVisible()||void 0,r.pinned=e.isPinned()?e.getPinned():null,r.sort=e.getSort()?e.getSort():null,r.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,r}},xK=class extends nB{constructor(){super(...arguments),this.beanName="columnEventDispatcher"}visibleCols(e){this.eventService.dispatchEvent({type:"displayedColumnsChanged",source:e})}gridColumns(){this.eventService.dispatchEvent({type:"gridColumnsChanged"})}headerHeight(e){this.eventService.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"})}groupHeaderHeight(e){this.eventService.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}groupOpened(e){this.eventService.dispatchEvent({type:"columnGroupOpened",columnGroup:1===e.length?e[0]:void 0,columnGroups:e})}rowGroupChanged(e,t){this.eventService.dispatchEvent({type:"columnRowGroupChanged",columns:e,column:1===e.length?e[0]:null,source:t})}genericColumnEvent(e,t,n){this.eventService.dispatchEvent({type:e,columns:t,column:1===t.length?t[0]:null,source:n})}pivotModeChanged(){this.eventService.dispatchEvent({type:"columnPivotModeChanged"})}virtualColumnsChanged(e){this.eventService.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}newColumnsLoaded(e){this.eventService.dispatchEvent({type:"newColumnsLoaded",source:e})}everythingChanged(e){this.eventService.dispatchEvent({type:"columnEverythingChanged",source:e})}columnMoved(e){const{movedColumns:t,source:n,toIndex:r,finished:i}=e;this.eventService.dispatchEvent({type:"columnMoved",columns:t,column:t&&1===t.length?t[0]:null,toIndex:r,finished:i,source:n})}columnPinned(e,t){if(!e.length)return;const n=1===e.length?e[0]:null,r=this.getCommonValue(e,e=>e.getPinned());this.eventService.dispatchEvent({type:"columnPinned",pinned:null!=r?r:null,columns:e,column:n,source:t})}columnVisible(e,t){if(!e.length)return;const n=1===e.length?e[0]:null,r=this.getCommonValue(e,e=>e.isVisible());this.eventService.dispatchEvent({type:"columnVisible",visible:r,columns:e,column:n,source:t})}getCommonValue(e,t){if(!e||0==e.length)return;const n=t(e[0]);for(let r=1;r<e.length;r++)if(n!==t(e[r]))return;return n}columnChanged(e,t,n){this.eventService.dispatchEvent({type:e,columns:t,column:t&&1==t.length?t[0]:null,source:n})}columnResized(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e&&e.length&&this.eventService.dispatchEvent({type:"columnResized",columns:e,column:1===e.length?e[0]:null,flexColumns:r,finished:t,source:n})}},RK=class extends nB{constructor(){super(...arguments),this.beanName="columnGetStateService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}getColumnState(){if(UH(this.columnModel.getColDefCols())||!this.columnModel.isAlive())return[];const e=this.columnModel.getAllCols().map(e=>this.createStateItemFromColumn(e));return this.orderColumnStateList(e),e}createStateItemFromColumn(e){const t=this.funcColsService.getRowGroupColumns(),n=this.funcColsService.getPivotColumns(),r=e.isRowGroupActive()?t.indexOf(e):null,i=e.isPivotActive()?n.indexOf(e):null,o=e.isValueActive()?e.getAggFunc():null,s=null!=e.getSort()?e.getSort():null,a=null!=e.getSortIndex()?e.getSortIndex():null,l=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:s,sortIndex:a,aggFunc:o,rowGroup:e.isRowGroupActive(),rowGroupIndex:r,pivot:e.isPivotActive(),pivotIndex:i,flex:l}}orderColumnStateList(e){const t=this.columnModel.getCols(),n=new Map(t.map((e,t)=>[e.getColId(),t]));e.sort((e,t)=>(n.has(e.colId)?n.get(e.colId):-1)-(n.has(t.colId)?n.get(t.colId):-1))}},EK=class extends nB{constructor(){super(...arguments),this.beanName="columnGroupStateService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService}getColumnGroupState(){const e=[];return AB(null,this.columnModel.getColTree(),t=>{rB(t)&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})}),e}resetColumnGroupState(e){const t=this.columnModel.getColDefColTree();if(!t)return;const n=[];AB(null,t,e=>{if(rB(e)){const t=e.getColGroupDef(),r={groupId:e.getGroupId(),open:t?t.openByDefault:void 0};n.push(r)}}),this.setColumnGroupState(n,e)}setColumnGroupState(e,t){if(!this.columnModel.getColTree())return;this.columnAnimationService.start();const n=[];e.forEach(e=>{const t=e.groupId,r=e.open,i=this.columnModel.getProvidedColGroup(t);i&&i.isExpanded()!==r&&(i.setExpanded(r),n.push(i))}),this.visibleColsService.refresh(t,!0),n.length&&this.eventDispatcher.groupOpened(n),this.columnAnimationService.finish()}},TK=class extends nB{constructor(){super(...arguments),this.beanName="columnViewportService",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.visibleColsService.isBodyWidthDirty();if(!(e===this.scrollWidth&&t===this.scrollPosition&&!r)){if(this.scrollWidth=e,this.scrollPosition=t,this.visibleColsService.setBodyWidthDirty(),this.gos.get("enableRtl")){const e=this.visibleColsService.getBodyContainerWidth();this.viewportLeft=e-this.scrollPosition-this.scrollWidth,this.viewportRight=e-this.scrollPosition}else this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition;this.columnModel.isReady()&&this.checkViewportColumns(n)}}getHeadersToRender(e,t){let n;switch(e){case"left":n=this.rowsOfHeadersToRenderLeft[t];break;case"right":n=this.rowsOfHeadersToRenderRight[t];break;default:n=this.rowsOfHeadersToRenderCenter[t]}return n||[]}extractViewportColumns(){const e=this.visibleColsService.getCenterCols();this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return!(!e.isAutoHeaderHeight()&&!this.isAnyParentAutoHeaderHeight(e))||this.isColumnInRowViewport(e)}isAnyParentAutoHeaderHeight(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,n=t+e.getActualWidth(),r=this.viewportLeft-200,i=this.viewportRight+200;return!(t<r&&n<r)&&!(t>i&&n>i)}getViewportColumns(){const e=this.visibleColsService.getLeftCols(),t=this.visibleColsService.getRightCols();return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.columnModel.isColSpanActive())return this.colsWithinViewport;const t=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),n=this.visibleColsService.getColsCenter();return this.visibleColsService.getColsForRow(e,n,t,e=>{const t=e.getLeft();return $H(t)&&t>this.viewportLeft})}checkViewportColumns(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.extractViewport()&&this.eventDispatcher.virtualColumnsChanged(e)}calculateHeaderRows(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={};const e={},t=this.visibleColsService.getLeftCols(),n=this.visibleColsService.getRightCols();this.headerColsWithinViewport.concat(t).concat(n).forEach(t=>e[t.getId()]=!0);const r=(t,n,i)=>{let o=!1;for(let s=0;s<t.length;s++){const a=t[s];let l=!1;if(TB(a))l=!0===e[a.getId()];else{const e=a.getDisplayedChildren();e&&(l=r(e,n,i+1))}l&&(o=!0,n[i]||(n[i]=[]),n[i].push(a))}return o};r(this.visibleColsService.getTreeLeft(),this.rowsOfHeadersToRenderLeft,0),r(this.visibleColsService.getTreeRight(),this.rowsOfHeadersToRenderRight,0),r(this.visibleColsService.getTreeCenter(),this.rowsOfHeadersToRenderCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.getViewportColumns().map(e=>`${e.getId()}-${e.getPinned()||"normal"}`).join("#"),t=this.colsWithinViewportHash!==e;return t&&(this.colsWithinViewportHash=e,this.calculateHeaderRows()),t}},kK=class extends nB{constructor(){super(...arguments),this.beanName="agComponentUtils"}wireBeans(e){this.componentMetadataProvider=e.componentMetadataProvider}adaptFunction(e,t){const n=this.componentMetadataProvider.retrieve(e);return n&&n.functionAdapter?n.functionAdapter(t):null}adaptCellRendererFunction(e){return class{refresh(){return!1}getGui(){return this.eGui}init(t){const n=e(t),r=typeof n;this.eGui="string"!==r&&"number"!==r&&"boolean"!==r?null!=n?n:KW("<span></span>"):KW("<span>"+n+"</span>")}}}doesImplementIComponent(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}},MK=class extends nB{constructor(){super(...arguments),this.beanName="componentMetadataProvider"}wireBeans(e){this.agComponentUtils=e.agComponentUtils}postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},dragAndDropImageComponent:{mandatoryMethodList:["setIcon","setLabel"],optionalMethodList:[]},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}},PK=Object.fromEntries(["rowPositionUtils","cellPositionUtils","headerPositionUtils","paginationAutoPageSizeService","apiFunctionService","gridApi","userComponentRegistry","agComponentUtils","componentMetadataProvider","resizeObserverService","userComponentFactory","rowContainerHeightService","horizontalResizeService","localeService","validationService","pinnedRowModel","dragService","visibleColsService","eventService","gos","popupService","selectionService","columnFilterService","quickFilterService","filterManager","columnModel","headerNavigationService","pageBoundsService","paginationService","pageBoundsListener","rowRenderer","expressionService","columnFactory","alignedGridsService","navigationService","valueCache","valueService","loggerFactory","autoWidthCalculator","filterMenuFactory","dragAndDropService","focusService","mouseEventService","environment","cellNavigationService","stylingService","scrollVisibleService","sortController","columnHoverService","columnAnimationService","selectableService","autoColService","controlsColService","changeDetectionService","animationFrameService","undoRedoService","columnDefFactory","rowCssClassCalculator","rowNodeBlockLoader","rowNodeSorter","ctrlsService","pinnedWidthService","rowNodeEventThrottle","ctrlsFactory","dataTypeService","syncService","overlayService","stateService","expansionService","apiEventService","ariaAnnouncementService","menuService","columnApplyStateService","columnEventDispatcher","columnMoveService","columnAutosizeService","columnGetStateService","columnGroupStateService","columnSizeService","funcColsService","columnNameService","columnViewportService","pivotResultColsService","showRowGroupColsService"].map((e,t)=>[e,t]));function IK(e,t){return((e.beanName?PK[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER)-((t.beanName?PK[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER)}function AK(e,t){return"gridDestroyService"===e?.beanName?-1:0}var DK=class extends nB{constructor(){super(...arguments),this.beanName="ctrlsFactory",this.registry={}}register(e){this.registry[e.name]=e.classImp}getInstance(e){const t=this.registry[e];if(null!=t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new t(...r)}}},FK=class extends nB{constructor(){super(...arguments),this.beanName="ctrlsService",this.params={gridCtrl:void 0,gridBodyCtrl:void 0,center:void 0,left:void 0,right:void 0,bottomCenter:void 0,bottomLeft:void 0,bottomRight:void 0,topCenter:void 0,topLeft:void 0,topRight:void 0,stickyTopCenter:void 0,stickyTopLeft:void 0,stickyTopRight:void 0,stickyBottomCenter:void 0,stickyBottomLeft:void 0,stickyBottomRight:void 0,fakeHScrollComp:void 0,fakeVScrollComp:void 0,gridHeaderCtrl:void 0,centerHeader:void 0,leftHeader:void 0,rightHeader:void 0},this.ready=!1,this.readyCallbacks=[],this.runReadyCallbacksAsync=!1}wireBeans(e){this.runReadyCallbacksAsync=e.frameworkOverrides.runWhenReadyAsync?.()??!1}postConstruct(){this.addEventListener("ready",()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach(e=>e(this.params)),this.readyCallbacks.length=0)},this.runReadyCallbacksAsync)}updateReady(){this.ready=Object.values(this.params).every(e=>e?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const e=this.readyCallbacks.indexOf(t);e>=0&&this.readyCallbacks.splice(e,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:n}=this.params;return[e,n,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}},OK=class extends nB{constructor(){super(...arguments),this.beanName="cellPositionUtils"}createId(e){const{rowIndex:t,rowPinned:n,column:r}=e;return this.createIdFromValues({rowIndex:t,column:r,rowPinned:n})}createIdFromValues(e){const{rowIndex:t,rowPinned:n,column:r}=e;return`${t}.${null==n?"null":n}.${r.getId()}`}equals(e,t){const n=e.column===t.column,r=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return n&&r&&i}},NK=class extends nB{constructor(){super(...arguments),this.beanName="rowNodeEventThrottle",this.events=[]}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowModel=e.rowModel}postConstruct(){nV(this.gos)&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const n=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(e=>this.eventService.dispatchEvent(e)),this.events=[]};t?n():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(n)),this.dispatchExpandedDebounced())}},LK=class extends nB{constructor(){super(...arguments),this.beanName="rowPositionUtils"}wireBeans(e){this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.pageBoundsService=e.pageBoundsService}getFirstRow(){let e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.pageBoundsService.getFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}getLastRow(){let e,t=null;const n=this.pinnedRowModel.getPinnedBottomRowCount(),r=this.pinnedRowModel.getPinnedTopRowCount();return n?(t="bottom",e=n-1):this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getLastRow()):r&&(t="top",e=r-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRow(e.rowIndex);case"bottom":return this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if($H(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}},_K={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},HK={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},VK={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},BK=class extends nB{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.ancestorThemeClasses=[],this.sizesMeasured=!1,this.gridTheme=null}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.eGridDiv=e.eGridDiv}postConstruct(){this.addManagedPropertyListener("theme",()=>this.handleThemeGridOptionChange()),this.handleThemeGridOptionChange(),this.addDestroyFunc(()=>this.stopUsingTheme()),this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.ancestorThemeClasses=this.readAncestorThemeClasses(),this.setUpThemeClassObservers(),this.getSizeEl(_K),this.getSizeEl(HK),this.getSizeEl(VK)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(_K)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(HK)}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(VK)}hasMeasuredSizes(){return this.sizesMeasured}getGridThemeClass(){return this.gridTheme?.getCssClass()||null}getThemeClasses(){return this.gridTheme?[this.gridTheme.getCssClass()]:this.ancestorThemeClasses}applyThemeClasses(e){const t=this.getThemeClasses();for(const n of Array.from(e.classList))n.startsWith("ag-theme-")&&!t.includes(n)&&e.classList.remove(n);e.classList.add(...t)}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(null==t||isNaN(t)||!isFinite(t))return null!==e&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const n=`${t}px`;return e!=n?(this.eGridDiv.style.setProperty("--ag-line-height",n),t):""!=e?parseFloat(e):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(null!=t)return t;const n=this.measureSizeEl(e);return"detached"===n||"no-styles"===n?e.defaultValue:(this.lastKnownValues.set(e,n),n)}measureSizeEl(e){const t=this.getSizeEl(e);if(null==t.offsetParent)return"detached";const n=t.offsetWidth;return n===zK?"no-styles":(this.sizesMeasured=!0,n)}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let n=this.eMeasurementContainer;n||(n=this.eMeasurementContainer=document.createElement("div"),n.className="ag-measurement-container",this.gos.get("theme")&&this.applyThemeClasses(n),this.eGridDiv.appendChild(n)),t=document.createElement("div"),t.style.width=`var(${e.cssName}, ${zK}px)`,n.appendChild(t),this.sizeEls.set(e,t);let r=this.measureSizeEl(e);"no-styles"===r&&NH(`no value for ${e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e.defaultValue} will be used and updated when styles load.`);const i=this.resizeObserverService.observeResize(t,()=>{const t=this.measureSizeEl(e);"detached"!==t&&"no-styles"!==t&&(this.lastKnownValues.set(e,t),t!==r&&(r=t,this.fireGridStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>i()),t}fireGridStylesChangedEvent(e){this.eventService.dispatchEvent({type:"gridStylesChanged",[e]:!0})}setUpThemeClassObservers(){const e=new MutationObserver(()=>{const e=this.readAncestorThemeClasses();WK(e,this.ancestorThemeClasses)||(this.ancestorThemeClasses=e,this.fireGridStylesChangedEvent("themeChanged"))});let t=this.eGridDiv;for(;t;)e.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement;this.addDestroyFunc(()=>e.disconnect())}readAncestorThemeClasses(){let e=this.eGridDiv;const t=[];for(;e;){const n=Array.from(e.classList).filter(e=>e.startsWith("ag-theme-"));for(const e of n)t.includes(e)||t.unshift(e);e=e.parentElement}return Object.freeze(t)}handleThemeGridOptionChange(){const{gos:e,eMeasurementContainer:t,gridTheme:n}=this,r=e.get("theme")||null;r!==n&&(n?.stopUse(),this.gridTheme=r,r?.startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),container:this.eGridDiv}),t&&this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged"))}stopUsingTheme(){this.gridTheme?.stopUse(),this.gridTheme=null}},WK=(e,t)=>e.length===t.length&&-1===e.findIndex((n,r)=>e[r]!==t[r]),zK=15538,jK=class extends nB{constructor(){super(...arguments),this.beanName="eventService",this.globalEventService=new IH}wireBeans(e){this.globalEventListener=e.globalEventListener,this.globalSyncEventListener=e.globalSyncEventListener}postConstruct(){if(this.globalEventListener){const e=sV(this.gos);this.addGlobalListener(this.globalEventListener,e)}this.globalSyncEventListener&&this.addGlobalListener(this.globalSyncEventListener,!1)}addEventListener(e,t,n){this.globalEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.globalEventService.removeEventListener(e,t,n)}addGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(this.gos.addGridCommonParams(e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(this.gos.addGridCommonParams(e))}},GK=class e extends nB{constructor(){super(...arguments),this.beanName="focusService"}wireBeans(e){this.eGridDiv=e.eGridDiv,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.headerNavigationService=e.headerNavigationService,this.headerPositionUtils=e.headerPositionUtils,this.rowRenderer=e.rowRenderer,this.rowPositionUtils=e.rowPositionUtils,this.cellPositionUtils=e.cellPositionUtils,this.navigationService=e.navigationService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.rangeService=e.rangeService,this.advancedFilterService=e.advancedFilterService,this.overlayService=e.overlayService}static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",e.toggleKeyboardMode),t.addEventListener("mousedown",e.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.removeEventListener("keydown",e.toggleKeyboardMode),t.removeEventListener("mousedown",e.toggleKeyboardMode))}static toggleKeyboardMode(t){const n=e.keyboardModeActive,r="keydown"===t.type;r&&(t.ctrlKey||t.metaKey||t.altKey)||n!==r&&(e.keyboardModeActive=r)}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(this,e=>{this.gridCtrl=e.gridCtrl})}registerKeyboardFocusEvents(){const t=pV(this.gos);e.addKeyboardModeEvents(t),e.instanceCount++,this.addDestroyFunc(()=>{e.instanceCount--,e.removeKeyboardModeEvents(t)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return e.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(mV(this.gos),Y$.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(mV(this.gos),VG.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let n=e;for(;n;){if(dV(this.gos,n,t))return!1;n=n.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return!!this.isCellRestoreFocused(e)&&(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0)}clearRestoreFocus(){this.restoredFocusedCellPosition=null,this.awaitRestoreFocusedCell=!1}restoreFocusedCell(e,t){this.awaitRestoreFocusedCell=!0,setTimeout(()=>{this.awaitRestoreFocusedCell&&(this.setRestoreFocusedCell(e),t())})}isCellRestoreFocused(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(e){const{rowIndex:t,rowPinned:n,column:r}=e,i={rowIndex:t,rowPinned:n,column:r,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n});return o&&(i.isFullWidthCell=o.isFullWidth()),i}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const e=this.getFocusEventParams(this.focusedCellPosition);this.focusedCellPosition=null,this.eventService.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){const{column:t,rowIndex:n,rowPinned:r,forceBrowserFocus:i=!1,preventScrollOnBrowserFocus:o=!1}=e,s=this.columnModel.getCol(t);s?(this.focusedCellPosition={rowIndex:n,rowPinned:GH(r),column:s},this.eventService.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCellPosition),forceBrowserFocus:i,preventScrollOnBrowserFocus:o})):this.focusedCellPosition=null}isCellFocused(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(null==this.focusedHeaderPosition)return!1;const t=e.getColumnGroupChild(),n=e.getRowIndex(),r=e.getPinned(),{column:i,headerRowIndex:o}=this.focusedHeaderPosition;return t===i&&n===o&&r==i.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}isHeaderFocusSuppressed(){return this.gos.get("suppressHeaderFocus")||this.overlayService.isExclusive()}isCellFocusSuppressed(){return this.gos.get("suppressCellFocus")||this.overlayService.isExclusive()}focusHeaderPosition(e){if(this.isHeaderFocusSuppressed())return!1;const{direction:t,fromTab:n,allowUserOverride:r,event:i,fromCell:o,rowWithoutSpanValue:s}=e;let{headerPosition:a}=e;if(o&&this.filterManager?.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(a);if(r){const e=this.getFocusedHeader(),r=this.headerNavigationService.getHeaderRowCount();if(n){const n=this.gos.getCallback("tabToNextHeader");n&&(a=this.getHeaderPositionFromUserFunc({userFunc:n,direction:t,currentPosition:e,headerPosition:a,headerRowCount:r}))}else{const t=this.gos.getCallback("navigateToNextHeader");if(t&&i){a=t({key:i.key,previousHeaderPosition:e,nextHeaderPosition:a,headerRowCount:r,event:i})}}}return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:i,fromCell:o,rowWithoutSpanValue:s})}focusHeaderPositionFromUserFunc(e){if(this.isHeaderFocusSuppressed())return!1;const{userFunc:t,headerPosition:n,direction:r,event:i}=e,o=this.getFocusedHeader(),s=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:r,currentPosition:o,headerPosition:n,headerRowCount:s});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:r,event:i})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:n,currentPosition:r,headerPosition:i,headerRowCount:o}=e,s=t({backwards:"Before"===n,previousHeaderPosition:r,nextHeaderPosition:i,headerRowCount:o});return!0===s||null===s?(null===s&&NH("Since v31.3 Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),r):!1===s?null:s}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:n,fromCell:r,rowWithoutSpanValue:i,event:o}=e,{column:s,headerRowIndex:a}=t;if(-1===a)return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView(s);this.headerNavigationService.scrollToColumn(s,n);const l=this.ctrlsService.getHeaderRowContainerCtrl(s.getPinned()),c=l?.focusHeader(t.headerRowIndex,s,o)||!1;return c&&(null!=i||r)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(i??-1),c}focusFirstHeader(){if(this.overlayService.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleColsService.getAllCols()[0];if(!e)return!1;e.getParent()&&(e=this.visibleColsService.getColGroupAtLevel(e,0));const t=this.headerPositionUtils.getHeaderIndexToFocus(e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlayService.isExclusive()&&this.focusOverlay(!0))return!0;const t=this.headerNavigationService.getHeaderRowCount()-1,n=VV(this.visibleColsService.getAllCols());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:n},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===GH(t))}findFocusableElements(e,t){let n=IW;t&&(n+=", "+t),arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(n+=', [tabindex="-1"]');const r=Array.prototype.slice.apply(e.querySelectorAll("[tabindex], input, select, button, textarea, [href]")).filter(e=>UW(e)),i=Array.prototype.slice.apply(e.querySelectorAll(n));if(!i.length)return r;return o=i,r.filter(e=>-1===o.indexOf(e));var o}focusInto(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.findFocusableElements(e,null,n),i=t?VV(r):r[0];return!!i&&(i.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const n=this.findFocusableElements(e),r=n.indexOf(t);if(-1===r)return null;let i=-1;for(let o=r-1;o>=0;o--)if(n[o].classList.contains("ag-tab-guard-top")){i=o;break}return i<=0?null:n[i-1]}findNextFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eGridDiv,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const r=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),i=mV(this.gos);let o;o=t?r.findIndex(e=>e.contains(i)):r.indexOf(i);const s=o+(n?-1:1);return s<0||s>=r.length?null:r[s]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const n=e.querySelectorAll(`.${qj.FOCUS_MANAGED_CLASS}`);if(!n.length)return!1;for(let r=0;r<n.length;r++)if(n[r].contains(t))return!0;return!1}findTabbableParent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=0;for(;e&&null===vz(e)&&++n<=t;)e=e.parentElement;return null===vz(e)?null:e}focusOverlay(e){const t=this.overlayService.isVisible()&&this.overlayService.getOverlayWrapper()?.getGui();return!!t&&this.focusInto(t,e)}focusGridViewFailed(e,t){return t&&this.focusOverlay(e)||e&&this.focusLastHeader()}focusGridView(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.overlayService.isExclusive())return n&&this.focusOverlay(t);if(this.isCellFocusSuppressed())return t&&!this.isHeaderFocusSuppressed()?this.focusLastHeader():!(!n||!this.focusOverlay(t))||this.focusNextGridCoreContainer(!1);const r=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(r){const{rowIndex:n,rowPinned:i}=r;if(e??(e=this.getFocusedHeader()?.column),e&&void 0!==n&&null!==n){if(this.navigationService.ensureCellVisible({rowIndex:n,column:e,rowPinned:i}),t){const e=this.rowRenderer.getRowByPosition(r);if(e?.isFullWidth()&&this.navigationService.tryToFocusFullWidthRow(r,t))return!0}return this.setFocusedCell({rowIndex:n,column:e,rowPinned:GH(i),forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:n,rowPinned:i,column:e}),!0}}return!(!n||!this.focusOverlay(t))||!(!t||!this.focusLastHeader())}isGridFocused(){const e=mV(this.gos);return!!e&&this.eGridDiv.contains(e)}focusNextGridCoreContainer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}focusAdvancedFilter(e){return this.advancedFilterFocusColumn=e?.column,this.advancedFilterService?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const n=(t?void 0:this.advancedFilterFocusColumn)??this.visibleColsService.getAllCols()?.[0];return e?this.focusHeaderPosition({headerPosition:{column:n,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(n)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}addFocusableContainer(e){this.gridCtrl.addFocusableContainer(e)}removeFocusableContainer(e){this.gridCtrl.removeFocusableContainer(e)}focusGridInnerElement(e){return this.gridCtrl.focusInnerElement(e)}allowFocusForNextGridCoreContainer(e){this.gridCtrl.allowFocusForNextCoreContainer(e)}};GK.keyboardModeActive=!1,GK.instanceCount=0;var $K=GK,UK=class extends nB{constructor(){super(...arguments),this.beanName="pinnedWidthService"}wireBeans(e){this.visibleColsService=e.visibleColsService}postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=iV(this.gos,"print"),t=e?0:this.visibleColsService.getColsLeftWidth(),n=e?0:this.visibleColsService.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:"leftPinnedWidthChanged"})),n!=this.rightWidth&&(this.rightWidth=n,this.eventService.dispatchEvent({type:"rightPinnedWidthChanged"}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},KK=class extends nB{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}wireBeans(e){this.beans=e,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}setComp(e,t,n){this.view=e,this.eGridHostDiv=t,this.eGui=n,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDropService:r,mouseEventService:i,ctrlsService:o,resizeObserverService:s}=this.beans,a={getContainer:()=>this.eGui,isInterestedIn:e=>1===e||0===e,getIconName:()=>"notAllowed"};r.addDropTarget(a),this.addDestroyFunc(()=>r.removeDropTarget(a)),i.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new E$(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr"),this.updateGridThemeClass(),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)});const l=s.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>l()),o.register("gridCtrl",this)}isDetailGrid(){const e=this.focusService.findTabbableParent(this.getGui());return e?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.paginationService?.getPaginationSelector(),gridHeaderDropZonesSelector:e.columnDropZonesService?.getDropZoneSelector(),sideBarSelector:e.sideBarService?.getSideBarSelector(),statusBarSelector:e.statusBarService?.getStatusPanelSelector(),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventService.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:n,nextIndex:r}=this.getNextFocusableIndex(t,e);if(r<0||r>=t.length)return!1;if(0===r){if(n>0){const e=VV(this.visibleColsService.getAllCols());if(this.focusService.focusGridView(e,!0))return!0}return!1}return this.focusContainer(t[r],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const n=this.getFocusableContainers(),r=this.visibleColsService.getAllCols();if(e){if(n.length>1)return this.focusContainer(VV(n),!0);const e=VV(r);if(this.focusService.focusGridView(e,!0))return!0}if(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()){if(this.focusService.focusGridView(r[0]))return!0;for(let e=1;e<n.length;e++)if(this.focusService.focusInto(n[e].getGui()))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:n,indexWithFocus:r}=this.getNextFocusableIndex(t,e);if(-1===r||n<0||n>=t.length)return;const i=t[n];i.setAllowFocus?.(!0),setTimeout(()=>{i.setAllowFocus?.(!1)})}getNextFocusableIndex(e,t){const n=mV(this.gos),r=e.findIndex(e=>e.getGui().contains(n));return{indexWithFocus:r,nextIndex:r+(t?-1:1)}}focusContainer(e,t){e.setAllowFocus?.(!0);const n=this.focusService.focusInto(e.getGui(),t);return e.setAllowFocus?.(!1),n}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}updateGridThemeClass(){const e=this.beans.environment.getGridThemeClass();e&&this.view.setGridThemeClass(e)}handleThemeChange(e){e.themeChanged&&this.updateGridThemeClass()}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},YK={version:WG,moduleName:"@ag-grid-community/aligned-grid",beans:[class extends nB{constructor(){super(...arguments),this.beanName="alignedGridsService",this.consuming=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.ctrlsService=e.ctrlsService,this.columnApplyStateService=e.columnApplyStateService}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t="function"===typeof e;"function"===typeof e&&(e=e());const n=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return e.map(e=>{if(!e)return LH("alignedGrids contains an undefined option."),t||LH('You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"'),void LH(n());if(this.isGridApi(e))return e;const r=e;return"current"in r?r.current?.api:(r.api||LH(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${n()}`),r.api)}).filter(e=>!!e&&!e.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:e=>{let{event:t}=e;return this.onColumnEvent(t)},alignedGridScroll:e=>{let{event:t}=e;return this.onScrollEvent(t)}})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){"horizontal"===e.direction&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const n=[];return e.columns?e.columns.forEach(e=>{n.push(t(e))}):e.column&&n.push(t(e.column)),n}getMasterColumns(e){return this.extractDataFromEvent(e,e=>e)}getColumnIds(e){return this.extractDataFromEvent(e,e=>e.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":this.processColumnEvent(e);break;case"columnGroupOpened":this.processGroupOpenedEvent(e);break;case"columnPivotChanged":NH("pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})}processGroupOpenedEvent(e){const{columnModel:t}=this;e.columnGroups.forEach(e=>{let n=null;e&&(n=t.getProvidedColGroup(e.getGroupId())),e&&!n||t.setColumnGroupOpened(n,e.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){const t=e.column;let n=null;if(t&&(n=this.columnModel.getColDefCol(t.getColId())),t&&!n)return;const r=this.getMasterColumns(e),{columnApplyStateService:i,columnSizeService:o,ctrlsService:s}=this;switch(e.type){case"columnMoved":{const t=e.api.getColumnState().map(e=>({colId:e.colId}));i.applyColumnState({state:t,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const t=e.api.getColumnState().map(e=>({colId:e.colId,hide:e.hide}));i.applyColumnState({state:t},"alignedGridChanged")}break;case"columnPinned":{const t=e.api.getColumnState().map(e=>({colId:e.colId,pinned:e.pinned}));i.applyColumnState({state:t},"alignedGridChanged")}break;case"columnResized":{const t=e,n={};r.forEach(e=>{n[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}}),t.flexColumns?.forEach(e=>{n[e.getId()]&&delete n[e.getId()]}),o.setColumnWidths(Object.values(n),!1,t.finished,"alignedGridChanged");break}}const a=s.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(e=>{e.setGridOption("alwaysShowVerticalScroll",a)})}}]};var qK={version:WG,moduleName:"@ag-grid-community/data-type",beans:[class extends nB{constructor(){super(...arguments),this.beanName="dataTypeService",this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.columnApplyStateService=e.columnApplyStateService,this.filterManager=e.filterManager}postConstruct(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(FB(e.source))})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes();this.dataTypeDefinitions={},this.formatValueFuncs={};const t=e=>t=>{const{column:n,node:r,value:i}=t;let o=n.getColDef().valueFormatter;return o===e.groupSafeValueFormatter&&(o=e.valueFormatter),this.valueService.formatValue(n,r,i,o)};Object.entries(e).forEach(e=>{let[n,r]=e;const i={...r,groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)};this.dataTypeDefinitions[n]=i,this.formatValueFuncs[n]=t(i)});const n=this.gos.get("dataTypeDefinitions")??{};this.dataTypeMatchers={},Object.entries(n).forEach(r=>{let[i,o]=r;const s=this.processDataTypeDefinition(o,n,[i],e);s&&(this.dataTypeDefinitions[i]=s,o.dataTypeMatcher&&(this.dataTypeMatchers[i]=o.dataTypeMatcher),this.formatValueFuncs[i]=t(s))}),this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach(t=>{const n=this.dataTypeMatchers[t];n&&delete this.dataTypeMatchers[t],this.dataTypeMatchers[t]=n??e[t].dataTypeMatcher})}mergeDataTypeDefinitions(e,t){const n={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(n.columnTypes=[...pB(e.columnTypes),...pB(t.columnTypes)]),n}processDataTypeDefinition(e,t,n,r){let i;const o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let n=r[o];const s=t[o];if(n&&s&&(n=s),!this.validateDataTypeDefinition(e,n,o))return;i=this.mergeDataTypeDefinitions(n,e)}else{if(n.includes(o))return void NH('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');const s=t[o];if(!this.validateDataTypeDefinition(e,s,o))return;const a=this.processDataTypeDefinition(s,t,[...n,o],r);if(!a)return;i=this.mergeDataTypeDefinitions(a,e)}return{...i,groupSafeValueFormatter:this.createGroupSafeValueFormatter(i)}}validateDataTypeDefinition(e,t,n){return t?t.baseDataType===e.baseDataType||(NH('The "baseDataType" property of a data type definition must match that of its parent.'),!1):(NH(`The data type definition ${n} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{if(t.node?.group){const n=(t.colDef.pivotValueColumn??t.column).getAggFunc();if(n){if("first"===n||"last"===n)return e.valueFormatter(t);if("number"===e.baseDataType&&"count"!==n){if("number"===typeof t.value)return e.valueFormatter(t);if("object"===typeof t.value){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter({...t,value:t.value.toNumber()});if("value"in t.value)return e.valueFormatter({...t,value:t.value.value})}}return}if((this.gos.get("suppressGroupMaintainValueType")||"groupRows"===this.gos.get("groupDisplayType"))&&!this.gos.get("treeData"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()&&"string"===typeof t.value&&!e.dataTypeMatcher?.(t.value))return;return e.valueFormatter(t)}}updateColDefAndGetColumnType(e,t,n){let{cellDataType:r}=t;const{field:i}=t;if(void 0===r&&(r=e.cellDataType),null!=r&&!0!==r||(r=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(i,n)),!r)return void(e.cellDataType=!1);const o=this.dataTypeDefinitions[r];if(o)return e.cellDataType=r,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,r,o,n),o.columnTypes;NH(`Missing data type definition - "${r}"`)}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const n=e=>{t.add(e.key)};e.addEventListener("columnStateUpdated",n),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.removeEventListener("columnStateUpdated",n))}canInferCellDataType(e,t){if(!nV(this.gos))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,n))return!1;const r=null===t.type?e.type:t.type;if(r){const e=this.gos.get("columnTypes")??{};if(pB(r).some(t=>{const r=e[t.trim()];return r&&this.doColDefPropsPreventInference(r,n)}))return!1}return!this.doColDefPropsPreventInference(e,n)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(n=>{let[r,i]=n;return this.doesColDefPropPreventInference(e,t,r,i)})}doesColDefPropPreventInference(e,t,n,r){if(!t[n])return!1;const i=e[n];return null===i?(t[n]=!1,!1):void 0===r?!!i:i===r}inferCellDataType(e,t){if(!e)return;let n;const r=this.getInitialData();if(r){const t=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");n=yB(r,e,t)}else this.initWaitForRowData(t);if(null==n)return;const[i]=Object.entries(this.dataTypeMatchers).find(e=>{let[t,r]=e;return r(n)})??["object"];return i}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(e?.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const[n]=this.addManagedEventListeners({rowDataUpdateStarted:e=>{const{firstRowData:r}=e;r&&(n?.(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations(),this.eventService.dispatchEvent({type:"dataTypesInferred"}))}})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const n=[];this.destroyColumnStateUpdateListeners();const r={},i={};Object.entries(this.columnStateUpdatesPendingInference).forEach(e=>{let[o,s]=e;const a=this.columnModel.getCol(o);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const e=this.getUpdatedColumnState(a,s);e.rowGroup&&null==e.rowGroupIndex&&(r[o]=e),e.pivot&&null==e.pivotIndex&&(i[o]=e),n.push(e)}}),t&&n.push(...this.funcColsService.generateColumnStateForRowGroupAndPivotIndexes(r,i)),n.length&&this.columnApplyStateService.applyColumnState({state:n},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const n=this.columnApplyStateService.getColumnStateFromColDef(e);return t.forEach(e=>{delete n[e],"rowGroup"===e?delete n.rowGroupIndex:"pivot"===e&&delete n.pivotIndex}),n}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,n=e.object;this.hasObjectValueParser=t.valueParser!==n.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==n.valueFormatter}getDateStringTypeDefinition(e){return e?this.getDataTypeDefinition(e)??this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(null==t)return!0;const n=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!n||n(t)}validateColDef(e){const t=e=>NH(`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`);"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||t("Formatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&t("Parser"))}getFormatValue(e){return this.formatValueFuncs[e]}setColDefPropertiesForBaseDataType(e,t,n,r){const i=this.formatValueFuncs[t];switch(n.baseDataType){case"number":e.cellEditor="agNumberCellEditor";break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===Bz.SPACE;break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=i;break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=i;break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=(e,t)=>{const n=this.columnModel.getColDefCol(r),o=n?.getColDef();if(!n||!o)return 0;const s=null==e?"":i({column:n,node:null,value:e}),a=null==t?"":i({column:n,node:null,value:t});return s===a?0:s>a?1:-1},e.keyCreator=i}this.filterManager?.setColDefPropertiesForDataType(e,n,i)}getDefaultDataTypes(){const e=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>""===e.newValue?.trim?.()?null:Number(e.newValue),valueFormatter:e=>null==e.value?"":"number"!==typeof e.value||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"===typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:YH(e.newValue),dataTypeMatcher:e=>"string"===typeof e},boolean:{baseDataType:"boolean",valueParser:e=>null==e.newValue?e.newValue:""===e.newValue?.trim?.()?null:"true"===String(e.newValue).toLowerCase(),valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"===typeof e},date:{baseDataType:"date",valueParser:e=>MG(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?EG(e.value,!1)??"":t("invalidDate","Invalid Date"),dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>MG(e)??void 0,dateFormatter:e=>EG(e??null,!1)??void 0,valueParser:t=>e(String(t.newValue))?t.newValue:null,valueFormatter:t=>e(String(t.value))?t.value:"",dataTypeMatcher:t=>"string"===typeof t&&e(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>YH(e.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}}]},XK={version:WG,moduleName:"@ag-grid-community/column-api",apiFunctions:{getColumnDef:function(e,t){const n=e.columnModel.getColDefCol(t);return n?n.getColDef():null},getColumnDefs:function(e){return e.columnModel.getColumnDefs()},sizeColumnsToFit:function(e,t){"number"===typeof t?e.columnSizeService.sizeColumnsToFit(t,"api"):e.ctrlsService.getGridBodyCtrl().sizeColumnsToFit(t)},setColumnGroupOpened:function(e,t,n){e.columnModel.setColumnGroupOpened(t,n,"api")},getColumnGroup:function(e,t,n){return e.visibleColsService.getColumnGroup(t,n)},getProvidedColumnGroup:function(e,t){return e.columnModel.getProvidedColGroup(t)},getDisplayNameForColumn:function(e,t,n){return e.columnNameService.getDisplayNameForColumn(t,n)||""},getDisplayNameForColumnGroup:function(e,t,n){return e.columnNameService.getDisplayNameForColumnGroup(t,n)||""},getColumn:function(e,t){return e.columnModel.getColDefCol(t)},getColumns:function(e){return e.columnModel.getColDefCols()},applyColumnState:function(e,t){return e.columnApplyStateService.applyColumnState(t,"api")},getColumnState:function(e){return e.columnGetStateService.getColumnState()},resetColumnState:function(e){e.columnApplyStateService.resetColumnState("api")},getColumnGroupState:function(e){return e.columnGroupStateService.getColumnGroupState()},setColumnGroupState:function(e,t){e.columnGroupStateService.setColumnGroupState(t,"api")},resetColumnGroupState:function(e){e.columnGroupStateService.resetColumnGroupState("api")},isPinning:function(e){return e.visibleColsService.isPinningLeft()||e.visibleColsService.isPinningRight()},isPinningLeft:function(e){return e.visibleColsService.isPinningLeft()},isPinningRight:function(e){return e.visibleColsService.isPinningRight()},getDisplayedColAfter:function(e,t){return e.visibleColsService.getColAfter(t)},getDisplayedColBefore:function(e,t){return e.visibleColsService.getColBefore(t)},setColumnVisible:function(e,t,n){e.columnModel.setColsVisible([t],n,"api")},setColumnsVisible:function(e,t,n){e.columnModel.setColsVisible(t,n,"api")},setColumnPinned:function(e,t,n){e.columnModel.setColsPinned([t],n,"api")},setColumnsPinned:function(e,t,n){e.columnModel.setColsPinned(t,n,"api")},getAllGridColumns:function(e){return e.columnModel.getCols()},getDisplayedLeftColumns:function(e){return e.visibleColsService.getLeftCols()},getDisplayedCenterColumns:function(e){return e.visibleColsService.getCenterCols()},getDisplayedRightColumns:function(e){return e.visibleColsService.getRightCols()},getAllDisplayedColumns:function(e){return e.visibleColsService.getAllCols()},getAllDisplayedVirtualColumns:function(e){return e.columnViewportService.getViewportColumns()},moveColumn:function(e,t,n){e.columnMoveService.moveColumns([t],n,"api")},moveColumnByIndex:function(e,t,n){e.columnMoveService.moveColumnByIndex(t,n,"api")},moveColumns:function(e,t,n){e.columnMoveService.moveColumns(t,n,"api")},setColumnWidth:function(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api";e.columnSizeService.setColumnWidths([{key:t,newWidth:n}],!1,r,i)},setColumnWidths:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api";e.columnSizeService.setColumnWidths(t,!1,n,r)},getLeftDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeLeft()},getCenterDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeCenter()},getRightDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeRight()},getAllDisplayedColumnGroups:function(e){return e.visibleColsService.getAllTrees()},autoSizeColumn:function(e,t,n){return e.columnAutosizeService.autoSizeCols({colKeys:[t],skipHeader:n,source:"api"})},autoSizeColumns:function(e,t,n){e.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:n,source:"api"})},autoSizeAllColumns:function(e,t){e.columnAutosizeService.autoSizeAllColumns("api",t)}}};var QK={version:WG,moduleName:"@ag-grid-community/pinned-row-api",apiFunctions:{getPinnedTopRowCount:function(e){return e.pinnedRowModel.getPinnedTopRowCount()},getPinnedBottomRowCount:function(e){return e.pinnedRowModel.getPinnedBottomRowCount()},getPinnedTopRow:function(e,t){return e.pinnedRowModel.getPinnedTopRow(t)},getPinnedBottomRow:function(e,t){return e.pinnedRowModel.getPinnedBottomRow(t)}}};function JK(e,t){const{colKey:n,rowNode:r,useFormatter:i}=t,o=e.columnModel.getColDefCol(n)??e.columnModel.getCol(n);if(UH(o))return null;const s=e.valueService.getValueForDisplay(o,r);if(i){return e.valueService.formatValue(o,r,s)??$B(s,!0)}return s}function ZK(e,t){e.gos.updateGridOptions({options:t})}function eY(e){return e.rowRenderer.getFirstVirtualRenderedRow()}function tY(e){return e.rowRenderer.getLastVirtualRenderedRow()}var nY={version:WG,moduleName:"@ag-grid-community/row-selection-api",apiFunctions:{setNodesSelected:function(e,t){const n=t.nodes.every(e=>e.rowPinned?(NH("cannot select pinned rows"),!1):void 0!==e.id||(NH("cannot select node until id for node is known"),!1));if(!n)return;const{nodes:r,source:i,newValue:o}=t,s=r;e.selectionService.setNodesSelected({nodes:s,source:i??"api",newValue:o})},selectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.selectAllRowNodes({source:t})},deselectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.deselectAllRowNodes({source:t})},selectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},deselectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},selectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},deselectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},getSelectedNodes:function(e){return e.selectionService.getSelectedNodes()},getSelectedRows:function(e){return e.selectionService.getSelectedRows()}}},rY={version:WG,moduleName:"@ag-grid-community/row-api",apiFunctions:{redrawRows:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(n))},setRowNodeExpanded:function(e,t,n,r,i){e.expansionService.setRowNodeExpanded(t,n,r,i)},getRowNode:function(e,t){return e.rowModel.getRowNode(t)},addRenderedRowListener:function(e,t,n,r){e.rowRenderer.addRenderedRowListener(t,n,r)},getRenderedNodes:function(e){return e.rowRenderer.getRenderedNodes()},forEachNode:function(e,t,n){e.rowModel.forEachNode(t,n)},getFirstDisplayedRow:function(e){return eY(e)},getFirstDisplayedRowIndex:eY,getLastDisplayedRow:function(e){return tY(e)},getLastDisplayedRowIndex:tY,getDisplayedRowAtIndex:function(e,t){return e.rowModel.getRow(t)},getDisplayedRowCount:function(e){return e.rowModel.getRowCount()},getModel:function(e){return e.rowModel}}},iY={version:WG,moduleName:"@ag-grid-community/scroll-api",apiFunctions:{getVerticalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition()},getHorizontalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getHScrollPosition()},ensureColumnVisible:BU,ensureIndexVisible:WU,ensureNodeVisible:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureNodeVisible(t,n),"ensureVisible")}}},oY={version:WG,moduleName:"@ag-grid-community/menu-api",apiFunctions:{showColumnMenuAfterButtonClick:function(e,t,n){const r=e.columnModel.getCol(t);e.menuService.showColumnMenu({column:r,buttonElement:n,positionBy:"button"})},showColumnMenuAfterMouseClick:function(e,t,n){let r=e.columnModel.getCol(t);r||(r=e.columnModel.getColDefCol(t)),r?e.menuService.showColumnMenu({column:r,mouseEvent:n,positionBy:"mouse"}):LH(`column '${t}' not found`)},showColumnMenu:function(e,t){const n=e.columnModel.getCol(t);n?e.menuService.showColumnMenu({column:n,positionBy:"auto"}):LH(`column '${t}' not found`)},hidePopupMenu:function(e){e.menuService.hidePopupMenu()}}},sY={version:WG,moduleName:"@ag-grid-community/api",dependantModules:[{version:WG,moduleName:"@ag-grid-community/core-api",apiFunctions:{getGridId:function(e){return e.context.getGridId()},destroy:function(e){e.gridDestroyService.destroy()},isDestroyed:function(e){return e.gridDestroyService.isDestroyCalled()},getGridOption:function(e,t){return e.gos.get(t)},setGridOption:function(e,t,n){ZK(e,{[t]:n})},updateGridOptions:ZK}},QK,nY,XK,rY,{version:WG,moduleName:"@ag-grid-community/drag-api",apiFunctions:{addRowDropZone:function(e,t){e.ctrlsService.getGridBodyCtrl().getRowDragFeature().addRowDropZone(t)},removeRowDropZone:function(e,t){const n=e.dragAndDropService.findExternalZone(t);n&&e.dragAndDropService.removeDropTarget(n)},getRowDropZoneParams:function(e,t){return e.ctrlsService.getGridBodyCtrl().getRowDragFeature().getRowDropZone(t)}}},iY,{version:WG,moduleName:"@ag-grid-community/overlay-api",apiFunctions:{showLoadingOverlay:function(e){e.overlayService.showLoadingOverlay()},showNoRowsOverlay:function(e){e.overlayService.showNoRowsOverlay()},hideOverlay:function(e){e.overlayService.hideOverlay()}}},{version:WG,moduleName:"@ag-grid-community/keyboard-navigation-api",apiFunctions:{getFocusedCell:function(e){return e.focusService.getFocusedCell()},clearFocusedCell:function(e){return e.focusService.clearFocusedCell()},setFocusedCell:function(e,t,n,r){e.focusService.setFocusedCell({rowIndex:t,column:n,rowPinned:r,forceBrowserFocus:!0})},setFocusedHeader:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.headerNavigationService.getHeaderPositionForColumn(t,n);r&&e.focusService.focusHeaderPosition({headerPosition:r})},tabToNextCell:function(e,t){return e.navigationService.tabToNextCell(!1,t)},tabToPreviousCell:function(e,t){return e.navigationService.tabToNextCell(!0,t)}}},{version:WG,moduleName:"@ag-grid-community/event-api",apiFunctions:{addEventListener:function(e,t,n){e.apiEventService.addEventListener(t,n)},addGlobalListener:function(e,t){e.apiEventService.addGlobalListener(t)},removeEventListener:function(e,t,n){e.apiEventService.removeEventListener(t,n)},removeGlobalListener:function(e,t){e.apiEventService.removeGlobalListener(t)}}},{version:WG,moduleName:"@ag-grid-community/render-api",apiFunctions:{setGridAriaProperty:function(e,t,n){if(!t)return;const r=e.ctrlsService.getGridBodyCtrl().getGui(),i=`aria-${t}`;null===n?r.removeAttribute(i):r.setAttribute(i,n)},refreshCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))},flashCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e=>NH(`Since v31.1 api.flashCells parameter '${e}Delay' is deprecated. Please use '${e}Duration' instead.`);$H(t.fadeDelay)&&n("fade"),$H(t.flashDelay)&&n("flash"),e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.flashCells(t))},refreshHeader:function(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsService.getHeaderRowContainerCtrls().forEach(e=>e.refresh()))},isAnimationFrameQueueEmpty:function(e){return e.animationFrameService.isQueueEmpty()},flushAllAnimationFrames:function(e){e.animationFrameService.flushAllFrames()},getSizesForCurrentTheme:function(e){return{rowHeight:cV(e.gos),headerHeight:e.columnModel.getHeaderHeight()}},getCellRendererInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellRendererInstances(t).map(Tj)}}},{version:WG,moduleName:"@ag-grid-community/cell-api",apiFunctions:{expireValueCache:function(e){e.valueCache.expire()},getValue:function(e,t,n){return JK(e,{colKey:t,rowNode:n})},getCellValue:JK}},oY,{version:WG,moduleName:"@ag-grid-community/sort-api",apiFunctions:{onSortChanged:function(e){e.sortController.onSortChanged("api")}}}]};function aY(e){if((e={...e}).version||(e.version="32.1.0"),"32.1.0"===e.version)e=function(e){return e.cellSelection=function(e,t){if(e&&"object"===typeof e)return e[t]}(e,"rangeSelection"),e}(e);return e}var lY={version:WG,moduleName:"@ag-grid-community/state-core",beans:[class extends nB{constructor(){super(...arguments),this.beanName="stateService",this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=zH(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=zH(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=zH(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}wireBeans(e){this.filterManager=e.filterManager,this.ctrlsService=e.ctrlsService,this.pivotResultColsService=e.pivotResultColsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnGroupStateService=e.columnGroupStateService,this.columnGetStateService=e.columnGetStateService,this.paginationService=e.paginationService,this.selectionService=e.selectionService,this.expansionService=e.expansionService,this.columnAnimationService=e.columnAnimationService,this.columnApplyStateService=e.columnApplyStateService,this.sideBarService=e.sideBarService,this.rangeService=e.rangeService}postConstruct(){this.isClientSideRowModel=nV(this.gos),this.cachedState=this.getInitialState(),this.setCachedStateValue("version",WG),this.ctrlsService.whenReady(this,()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const[e,t,n]=this.addManagedEventListeners({newColumnsLoaded:t=>{let{source:n}=t;"gridInitializing"===n&&(e(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))},rowCountReady:()=>{t?.(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())},firstDataRendered:()=>{n?.(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())}})}getInitialState(){return aY(this.gos.get("initialState")??{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState());const e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=e=>()=>this.updateColumnState([e]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:n,pagination:r}=this.getInitialState(),i=this.gos.get("advancedFilterModel");(e||i)&&this.setFilterState(e,i),t&&this.setRowGroupExpansionState(t),n&&this.setRowSelectionState(n),r&&this.setPaginationState(r),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState());const o=()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState());this.addManagedEventListeners({filterChanged:()=>this.updateCachedState("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:o,columnRowGroupChanged:o,rowDataUpdated:()=>{0!==this.gos.get("groupDefaultExpanded")&&setTimeout(()=>{o()})},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:e=>{(e.newPage||e.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:n,columnOrder:r}=this.getInitialState();n&&this.setFocusedCellState(n),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!r?.orderedColIds),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState());const i=this.getRangeSelectionState();this.updateCachedState("rangeSelection",i),this.updateCachedState("cellSelection",i),this.updateCachedState("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>this.updateCachedState("focusedCell",this.getFocusedCellState()),cellSelectionChanged:e=>{if(e.finished){const e=this.getRangeSelectionState();this.updateCachedState("rangeSelection",e),this.updateCachedState("cellSelection",e)}},bodyScrollEnd:()=>this.updateCachedState("scroll",this.getScrollState())})}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],n=[],r=[],i=[],o=[],s=[],a=[],l=[],c=[];let u=0;const d=this.columnGetStateService.getColumnState();for(let h=0;h<d.length;h++){const{colId:e,sort:p,sortIndex:g,rowGroup:f,rowGroupIndex:m,aggFunc:v,pivot:w,pivotIndex:b,pinned:C,hide:y,width:S,flex:x}=d[h];c.push(e),p&&(t[g??u++]={colId:e,sort:p}),f&&(n[m??0]=e),"string"===typeof v&&r.push({colId:e,aggFunc:v}),w&&(i[b??0]=e),C&&("right"===C?s:o).push(e),y&&a.push(e),(x||S)&&l.push({colId:e,flex:x??void 0,width:S})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:n.length?{groupColIds:n}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:i.length||e?{pivotMode:e,pivotColIds:i}:void 0,columnPinning:o.length||s.length?{leftColIds:o,rightColIds:s}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:n,aggregation:r,pivot:i,columnPinning:o,columnVisibility:s,columnSizing:a,columnOrder:l,partialColumnState:c}=e,u={},d=e=>{let t=u[e];return t||(t={colId:e},u[e]=t,t)},h=c?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach((e,t)=>{let{colId:n,sort:r}=e;const i=d(n);i.sort=r,i.sortIndex=t}),h.sort=null,h.sortIndex=null),n&&(n.groupColIds.forEach((e,t)=>{const n=d(e);n.rowGroup=!0,n.rowGroupIndex=t}),h.rowGroup=null,h.rowGroupIndex=null),r&&(r.aggregationModel.forEach(e=>{let{colId:t,aggFunc:n}=e;d(t).aggFunc=n}),h.aggFunc=null),i&&(i.pivotColIds.forEach((e,t)=>{const n=d(e);n.pivot=!0,n.pivotIndex=t}),this.gos.updateGridOptions({options:{pivotMode:i.pivotMode},source:"gridInitializing"}),h.pivot=null,h.pivotIndex=null),o&&(o.leftColIds.forEach(e=>{d(e).pinned="left"}),o.rightColIds.forEach(e=>{d(e).pinned="right"}),h.pinned=null),s&&(s.hiddenColIds.forEach(e=>{d(e).hide=!0}),h.hide=null),a&&(a.columnSizingModel.forEach(e=>{let{colId:t,flex:n,width:r}=e;const i=d(t);i.flex=n??null,i.width=r}),h.flex=null);const p=l?.orderedColIds,g=!!p?.length,f=g?p.map(e=>d(e)):Object.values(u);f.length&&(this.columnStates=f,this.columnApplyStateService.applyColumnState({state:f,applyOrder:g,defaultState:h},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;if(this.columnGroupStates=void 0,this.pivotResultColsService.isPivotResultColsPresent()){if(t){const n=[];for(const e of t)this.pivotResultColsService.getPivotResultCol(e.colId)&&n.push(e);this.columnApplyStateService.applyColumnState({state:n,applyOrder:e},"gridInitializing")}n&&this.columnGroupStateService.setColumnGroupState(n,"gridInitializing")}}getColumnGroupState(){const e=this.columnGroupStateService.getColumnGroupState(),t=[];return e.forEach(e=>{let{groupId:n,open:r}=e;r&&t.push(n)}),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){if(!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const t=new Set(e.columnGroup?.openColumnGroupIds),n=this.columnGroupStateService.getColumnGroupState().map(e=>{let{groupId:n}=e;const r=t.has(n);return r&&t.delete(n),{groupId:n,open:r}});t.forEach(e=>{n.push({groupId:e,open:!0})}),n.length&&(this.columnGroupStates=n),this.columnGroupStateService.setColumnGroupState(n,"gridInitializing")}getFilterState(){let e=this.filterManager?.getFilterModel();e&&0===Object.keys(e).length&&(e=void 0);const t=this.filterManager?.getAdvancedFilterModel()??void 0;return e||t?{filterModel:e,advancedFilterModel:t}:void 0}setFilterState(e,t){const{filterModel:n,advancedFilterModel:r}=e??{advancedFilterModel:t};n&&this.filterManager?.setFilterModel(n,"columnFilter"),r&&this.filterManager?.setAdvancedFilterModel(r)}getRangeSelectionState(){const e=this.rangeService?.getCellRanges().map(e=>{const{id:t,type:n,startRow:r,endRow:i,columns:o,startColumn:s}=e;return{id:t,type:n,startRow:r,endRow:i,colIds:o.map(e=>e.getColId()),startColId:s.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeService:n,columnModel:r,visibleColsService:i}=this;if(!PV(t)||!n)return;const o=[];if(e.cellRanges.forEach(e=>{const t=[];if(e.colIds.forEach(e=>{const n=r.getCol(e);n&&t.push(n)}),!t.length)return;let n=r.getCol(e.startColId);if(!n){const e=i.getAllCols(),r=new Set(t);n=e.find(e=>r.has(e))}o.push({...e,columns:t,startColumn:n})}),function(e){return void 0!==e.get("cellSelection")}(t)&&function(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&(t?.suppressMultiRanges??!1):e.get("suppressMultiRangeSelection")}(t)&&o.length>1)return NH("cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`");n.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.ctrlsService.getGridBodyCtrl()?.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:n}=e?.getVScrollPosition()??{top:0};return n||t?{top:n,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:n}=e;this.ctrlsService.getGridBodyCtrl()?.getScrollFeature().setScrollPosition(t,n)}getSideBarState(){return this.sideBarService?.getSideBarComp()?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:n,rowPinned:r}=e;return{colId:t.getColId(),rowIndex:n,rowPinned:r}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:n,rowPinned:r}=e;this.focusService.setFocusedCell({column:this.columnModel.getCol(t),rowIndex:n,rowPinned:r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){if(!this.paginationService)return;const e=this.paginationService.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationService.getPageSize();return e||t?{page:e,pageSize:t}:void 0}setPaginationState(e){this.paginationService&&(e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationService.setPageSize(e.pageSize,"initialState"),"number"===typeof e.page&&this.paginationService.setPage(e.page))}getRowSelectionState(){const e=this.selectionService.getSelectionState();return!e||!Array.isArray(e)&&(!1===e.selectAll||!1===e.selectAllChildren)&&!e?.toggledNodes?.length?void 0:e}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let n=!1;Object.entries(t).forEach(e=>{let[t,r]=e;JH(r,this.cachedState[t])||(n=!0)}),this.cachedState={...this.cachedState,...t},n&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const n=this.cachedState[e];this.setCachedStateValue(e,t),JH(t,n)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){this.staleStateKeys.forEach(e=>{if("rowSelection"===e)this.setCachedStateValue(e,this.getRowSelectionState())}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(e=>this.queuedUpdateSources.add(e)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear(),this.eventService.dispatchEvent({type:"stateUpdated",sources:e,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}}]},cY={version:WG,moduleName:"@ag-grid-community/state",dependantModules:[lY,{version:WG,moduleName:"@ag-grid-community/state-api",apiFunctions:{getState:function(e){return e.stateService?.getState()??{}}},dependantModules:[lY]}]};var uY="paginationPageSizeSelector",dY={selector:"AG-PAGE-SIZE-SELECTOR",component:class extends Ez{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationService.getPageSize()||(this.paginationService.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.paginationService=e.paginationService}postConstruct(){this.addManagedPropertyListener(uY,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.paginationService.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){jW(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get(uY)}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationService.getPageSize(),n=!t||!e.includes(t);if(n){const n=this.gos.exists("paginationPageSize"),r=!0!==this.gos.get(uY);NH(`'paginationPageSize=${t}'${n?"":" (default value)"}, but ${t} is not included in${r?"":" the default"} paginationPageSizeSelector=[${e.join(", ")}].`),r||NH(`Either set '${uY}' to an array that includes ${t} or to 'false' to disable the page size selector.`),e.unshift("")}const r=String(n?"":t);this.selectPageSizeComp?(BV(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(r,!0)):this.createPageSizeSelectorComp(e,r),this.hasEmptyOption=n}createPageSizeSelectOptions(e){return e.map(e=>({value:String(e)}))}createPageSizeSelectorComp(e,t){const n=this.localeService.getLocaleTextFunc(),r=n("pageSizeSelectorLabel","Page Size:"),i=n("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new rG).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(i).setLabel(r).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(uY);return!Array.isArray(t)||KH(t)?e:[...t].sort((e,t)=>e-t)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}}},hY={selector:"AG-PAGINATION",component:class extends cK{constructor(){super(),this.btFirst=Rz,this.btPrevious=Rz,this.btNext=Rz,this.btLast=Rz,this.lbRecordCount=Rz,this.lbFirstRowOnPage=Rz,this.lbLastRowOnPage=Rz,this.lbCurrent=Rz,this.lbTotal=Rz,this.pageSizeComp=Rz,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.focusService=e.focusService,this.ariaAnnouncementService=e.ariaAnnouncementService}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[dY]);const{btFirst:t,btPrevious:n,btNext:r,btLast:i}=this;this.activateTabIndex([t,n,r,i]),t.insertAdjacentElement("afterbegin",Mz(e?"last":"first",this.gos)),n.insertAdjacentElement("afterbegin",Mz(e?"next":"previous",this.gos)),r.insertAdjacentElement("afterbegin",Mz(e?"previous":"next",this.gos)),i.insertAdjacentElement("afterbegin",Mz(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>{this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(e):this.focusService.focusGridInnerElement(e)},forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){var e,t,n;this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{const{el:t,fn:n}=e;this.addManagedListeners(t,{click:n,keydown:e=>{e.key!==Bz.ENTER&&e.key!==Bz.SPACE||(e.preventDefault(),n())}})}),e=this,t=this.getGui(),n=this.focusService,e.addManagedElementListeners(t,{keydown:e=>{if(!e.defaultPrevented&&e.key===Bz.TAB){const r=e.shiftKey;n.findNextFocusableElement(t,!1,r)||n.focusNextGridCoreContainer(r)&&e.preventDefault()}}}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationService.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t){return t({value:e})}const n=this.localeService.getLocaleTextFunc();return RG(e,n("thousandSeparator",","),n("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),n=e("to","to"),r=e("of","of"),i=e("firstPage","First Page"),o=e("previousPage","Previous Page"),s=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">\n                <ag-page-size-selector data-ref="pageSizeComp"></ag-page-size-selector>\n                <span class="ag-paging-row-summary-panel">\n                    <span id="ag-${l}-first-row" data-ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-to">${n}</span>\n                    <span id="ag-${l}-last-row" data-ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-of">${r}</span>\n                    <span id="ag-${l}-row-count" data-ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div data-ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${i}"></div>\n                    <div data-ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>\n                    <span class="ag-paging-description">\n                        <span id="ag-${l}-start-page">${t}</span>\n                        <span id="ag-${l}-start-page-number" data-ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${l}-of-page">${r}</span>\n                        <span id="ag-${l}-of-page-number" data-ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div data-ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>\n                    <div data-ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationService.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationService.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationService.goToLastPage()}enableOrDisableButtons(){const e=this.paginationService.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),n=this.paginationService.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const r=this.isZeroPagesToDisplay(),i=e===n-1;this.nextButtonDisabled=i||r,this.lastButtonDisabled=!t||r||e===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){!function(e,t){hW(e,"disabled",t)}(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages();return e&&0===t}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages(),n=this.paginationService.getMasterRowCount(),r=e?n:null;if(1===r){const e=this.rowModel.getRow(0);if(e&&e.group&&!(e.groupData||e.aggData))return void this.setTotalLabelsToZero()}const i=this.paginationService.getCurrentPage(),o=this.paginationService.getPageSize();let s,a;this.isZeroPagesToDisplay()?s=a=0:(s=o*i+1,a=s+o-1,e&&a>r&&(a=r));const l=!e&&n<s+o-1,c=this.formatNumber(s);let u;this.lbFirstRowOnPage.textContent=c;const d=this.localeService.getLocaleTextFunc();u=l?d("pageLastRowUnknown","?"):this.formatNumber(a),this.lbLastRowOnPage.textContent=u;const h=t>0?i+1:0,p=this.formatNumber(h);let g,f;if(this.lbCurrent.textContent=p,e)g=this.formatNumber(t),f=this.formatNumber(r);else{const e=d("more","more");g=e,f=e}this.lbTotal.textContent=g,this.lbRecordCount.textContent=f,this.announceAriaStatus(c,u,f,p,g)}announceAriaStatus(e,t,n,r,i){const o=this.localeService.getLocaleTextFunc(),s=o("page","Page"),a=o("to","to"),l=o("of","of"),c=`${e} ${a} ${t} ${l} ${n}`,u=`${s} ${r} ${l} ${i}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnouncementService.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,this.ariaAnnouncementService.announceValue(u,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}}},pY={version:WG,moduleName:"@ag-grid-community/pagination-core",beans:[class extends nB{constructor(){super(...arguments),this.beanName="paginationService",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return hY}isPaginateChildRows(){return!(!this.gos.get("groupRemoveSingleChildren")&&!this.gos.get("groupRemoveLowestSingleChildren"))||this.gos.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){this.active&&this.currentPage!==e&&"number"===typeof this.currentPage&&(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}isRowPresent(e){return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){if(!this.active)return!0;return this.getPageForIndex(e.rowIndex)===this.currentPage}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return $H(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:$H(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:$H(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:$H(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.pageBoundsService.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const n=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}n!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let n=this.pageSize*(this.currentPage+1)-1;if(n>e&&(n=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),n===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const e=this.rowModel.getTopLevelRowDisplayedIndex(n+1);this.bottomDisplayedRowIndex=e-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:n=!1,newPageSize:r=!1}=e;this.eventService.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:n,newPageSize:r,keepRenderedRows:t})}},class extends nB{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}postConstruct(){this.ctrlsService.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.paginationService.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const t=Math.max(cV(this.gos),1),n=Math.floor(e/t);this.paginationService.setPageSize(n,"autoCalculated")};this.isBodyRendered?zH(()=>t(),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}]},gY={version:WG,moduleName:"@ag-grid-community/pagination",dependantModules:[pY,{version:WG,moduleName:"@ag-grid-community/pagination-api",dependantModules:[pY],apiFunctions:{paginationIsLastPageFound:function(e){return e.rowModel.isLastRowIndexKnown()},paginationGetPageSize:function(e){return e.paginationService?.getPageSize()??100},paginationGetCurrentPage:function(e){return e.paginationService?.getCurrentPage()??0},paginationGetTotalPages:function(e){return e.paginationService?.getTotalPages()??1},paginationGetRowCount:function(e){return e.paginationService?e.paginationService.getMasterRowCount():e.rowModel.getRowCount()},paginationGoToNextPage:function(e){e.paginationService?.goToNextPage()},paginationGoToPreviousPage:function(e){e.paginationService?.goToPreviousPage()},paginationGoToFirstPage:function(e){e.paginationService?.goToFirstPage()},paginationGoToLastPage:function(e){e.paginationService?.goToLastPage()},paginationGoToPage:function(e,t){e.paginationService?.goToPage(t)}}}]},fY="clientSide",mY="serverSide",vY="infinite",wY={onGroupExpandedOrCollapsed:[fY],refreshClientSideRowModel:[fY],isRowDataEmpty:[fY],forEachLeafNode:[fY],forEachNodeAfterFilter:[fY],forEachNodeAfterFilterAndSort:[fY],resetRowHeights:[fY],applyTransaction:[fY],applyTransactionAsync:[fY],flushAsyncTransactions:[fY],getBestCostNodeSelection:[fY],getServerSideSelectionState:[mY],setServerSideSelectionState:[mY],applyServerSideTransaction:[mY],applyServerSideTransactionAsync:[mY],applyServerSideRowData:[mY],retryServerSideLoads:[mY],flushServerSideAsyncTransactions:[mY],refreshServerSide:[mY],getServerSideGroupLevelState:[mY],refreshInfiniteCache:[vY],purgeInfiniteCache:[vY],getInfiniteRowCount:[vY],isLastRowIndexKnown:[vY,mY],expandAll:[fY,mY],collapseAll:[fY,mY],onRowHeightChanged:[fY,mY],setRowCount:[vY,mY],getCacheBlockState:[vY,mY]},bY={getValue:{version:"v31.3",new:"getCellValue"},getFirstDisplayedRow:{version:"v31.1",new:"getFirstDisplayedRowIndex"},getLastDisplayedRow:{version:"v31.1",new:"getLastDisplayedRowIndex"},getModel:{version:"v31.1",message:"Please use the appropriate grid API methods instead."},setColumnVisible:{version:"v31.1",old:"setColumnVisible(key,visible)",new:"setColumnsVisible([key],visible)"},setColumnPinned:{version:"v31.1",old:"setColumnPinned(key,pinned)",new:"setColumnsPinned([key],pinned)"},moveColumn:{version:"v31.1",old:"moveColumn(key, toIndex)",new:"moveColumns([key], toIndex)"},setColumnWidth:{version:"v31.1",old:"setColumnWidth(col, width)",new:"setColumnWidths([{key: col, newWidth: width}])"},autoSizeColumn:{version:"v31.1",old:"autoSizeColumn(key, skipHeader)",new:"autoSizeColumns([key], skipHeader)"},addAggFunc:{version:"v31.1",old:"addAggFunc(key, func)",new:"addAggFuncs({ key: func })"},removeValueColumn:{version:"v31.1",old:"removeValueColumn(colKey)",new:"removeValueColumns([colKey])"},addValueColumn:{version:"v31.1",old:"addValueColumn(colKey)",new:"addValueColumns([colKey])"},removeRowGroupColumn:{version:"v31.1",old:"removeRowGroupColumn(colKey)",new:"removeRowGroupColumns([colKey])"},addRowGroupColumn:{version:"v31.1",old:"addRowGroupColumn(colKey)",new:"addRowGroupColumns([colKey])"},removePivotColumn:{version:"v31.1",old:"removePivotColumn(colKey)",new:"removePivotColumns([colKey])"},addPivotColumn:{version:"v31.1",old:"addPivotColumn(colKey)",new:"addPivotColumns([colKey])"},showColumnMenuAfterButtonClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere."},showColumnMenuAfterMouseClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere."},getFilterInstance:{version:"v31.1",message:"'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."},showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"}};var CY=(e,t)=>{const n=t.rowModelType??"clientSide";return"clientSide"===n||"serverSide"===n?{module:"@ag-grid-enterprise/row-grouping"}:null},yY={enableRowGroup:CY,rowGroup:CY,rowGroupIndex:CY,enablePivot:CY,enableValue:CY,pivot:CY,pivotIndex:CY,aggFunc:CY,cellEditor:e=>"agRichSelect"===e.cellEditor||"agRichSelectCellEditor"===e.cellEditor?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(e=>t.includes(e))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelection is only supported with rowSelection=multiple"}},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"}},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"}},children:()=>SY},SY={objectName:"colDef",allProperties:Object.keys({headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0}),docsUrl:"column-properties/",deprecations:{columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}},validations:yY},xY={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1};var RY={version:WG,moduleName:"@ag-grid-community/core"},EY={version:WG,moduleName:"@ag-grid-community/core-validations",beans:[class extends nB{constructor(){super(...arguments),this.beanName="validationService"}wireBeans(e){this.beans=e,this.gridOptions=e.gridOptions}postConstruct(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,{objectName:"gridOptions",allProperties:[...sW.ALL_PROPERTIES,...lW.EVENT_CALLBACKS],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:{advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."},suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."}},validations:{sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",validate:e=>{const t=e.rowModelType??"clientSide";switch(t){case"clientSide":{const n=`treeData requires 'getDataPath' in the ${t} row model.`;return e.getDataPath?null:n}case"serverSide":{const n=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${t} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:n}}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],validate:e=>{switch(e.rowModelType??"clientSide"){case"clientSide":return null;case"serverSide":{const t="groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll";return e.suppressServerSideInfiniteScroll?t:null}}return null}},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:[void 0,"bottom"]}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},paginationPageSizeSelector:{validate:e=>{const t=e.paginationPageSizeSelector;return"boolean"===typeof t||null==t||t.length?null:"'paginationPageSizeSelector' cannot be an empty array.\n                    If you want to hide the page size selector, set paginationPageSizeSelector to false."}},rowSelection:{validate(e){let{rowSelection:t}=e;return t&&"string"===typeof t?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':t&&"object"!==typeof t?"Expected `RowSelectionOptions` object for the `rowSelection` property.":null}},cellSelection:{module:"@ag-grid-enterprise/range-selection"},columnDefs:()=>SY,defaultColDef:()=>SY,defaultColGroupDef:()=>SY,autoGroupColumnDef:()=>SY,selectionColumnDef:()=>SY}})}validateApiFunction(e,t){return function(e,t,n){const r=bY[e];if(r){const{version:n,new:i,old:o,message:s}=r,a=o??e;return function(){NH(`Since ${n} api.${a} is deprecated. ${i?`Please use ${i} instead. `:""}${s??""}`);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return t.apply(t,r)}}const i=wY[e];return i?function(){const r=n.rowModel.getType();if(i.includes(r)){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(t,s)}LH(`api.${e} can only be called when gridOptions.rowModelType is ${i.join(" or ")}`)}:t}(e,t,this.beans)}processOptions(e,t){const{validations:n,deprecations:r,allProperties:i,propertyExceptions:o,objectName:s,docsUrl:a}=t;i&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(e,[...o??[],...Object.keys(r)],i,s,a);const l=new Set;Object.keys(e).forEach(t=>{const i=r[t];if(i)if("renamed"in i){const{renamed:n,version:r}=i;l.add(`As of v${r}, ${String(t)} is deprecated. Please use ${String(n)} instead.`),e[n]=e[t]}else{const{message:e,version:n}=i;l.add(`As of v${n}, ${String(t)} is deprecated. ${e??""}`)}const o=e[t];if(null==o||!1===o)return;const s=n[t];let a;if(!s)return;if("function"===typeof s){const n=s(e,this.gridOptions);if(!n)return;if("objectName"in n){const r=e[t];return Array.isArray(r)?void r.forEach(e=>{this.processOptions(e,n)}):void this.processOptions(e[t],n)}a=n}else a=s;const{module:c,dependencies:u,validate:d,supportedRowModels:h}=a;if(h){const e=this.gridOptions.rowModelType??"clientSide";if(!h.includes(e))return void l.add(`${String(t)} is not supported with the '${e}' row model.`)}if(c){const e=Array.isArray(c)?c:[c];let n=!0;if(e.forEach(e=>{this.gos.assertModuleRegistered(e,String(t))||(n=!1,l.add(`${String(t)} is only available when ${e} is loaded.`))}),!n)return}if(u){const n=this.checkForRequiredDependencies(t,u,e);if(n)return void l.add(n)}if(d){const t=d(e,this.gridOptions);if(t)return void l.add(t)}}),l.size>0&&l.forEach(e=>{NH(e)})}checkForRequiredDependencies(e,t,n){const r=Object.entries(t).find(e=>{let[t,r]=e;const i=n[t];return!r.includes(i)});if(!r)return null;const[i,o]=r;return o.length>1?`'${String(e)}' requires '${i}' to be one of [${o.join(", ")}].`:`'${String(e)}' requires '${i}' to be ${o[0]}.`}checkProperties(e,t,n,r,i){const o=function(e,t,n){const r={},i=e.filter(e=>!t.some(t=>t===e));i.length>0&&i.forEach(e=>r[e]=ej({inputValue:e,allSuggestions:n}).values);return r}(Object.getOwnPropertyNames(e),["__ob__","__v_skip","__metadata__",...t,...n],n);if(mB(o,(e,t)=>{let i=`invalid ${r} property '${e}' did you mean any of these: ${t.slice(0,8).join(", ")}.`;n.includes("context")&&(i+=`\nIf you are trying to annotate ${r} with application data, use the '${r}.context' property instead.`),NH(i)}),Object.keys(o).length>0&&i){const e=this.getFrameworkOverrides().getDocLink(i);NH(`to see all the valid ${r} properties please check: ${e}`)}}}]},TY={version:WG,moduleName:"@ag-grid-community/core-community-features",dependantModules:[RY,EY,qU,r$,cY,qK,YK,gY,sY]},kY=class extends nB{constructor(){super(...arguments),this.beanName="gridDestroyService",this.destroyCalled=!1}wireBeans(e){this.beans=e}destroy(){this.destroyCalled||(this.eventService.dispatchEvent({type:"gridPreDestroyed",state:this.beans.stateService?.getState()??{}}),this.destroyCalled=!0,this.beans.ctrlsService.get("gridCtrl")?.destroyGridUi(),this.beans.context.destroy(),super.destroy())}isDestroyCalled(){return this.destroyCalled}},MY=new Set(["gridPreDestroyed","fillStart","pasteStart"]),PY=new Map([...sW.BOOLEAN_PROPERTIES.map(e=>[e,QH]),...sW.NUMBER_PROPERTIES.map(e=>[e,yG]),["groupAggFiltering",e=>"function"===typeof e?e:QH(e)],["pageSize",SG(1)],["autoSizePadding",SG(0)],["keepDetailRowsCount",SG(1)],["rowBuffer",SG(0)],["infiniteInitialRowCount",SG(1)],["cacheOverflowSize",SG(1)],["cacheBlockSize",SG(1)],["serverSideInitialRowCount",SG(1)],["viewportRowModelPageSize",SG(1)],["viewportRowModelBufferSize",SG(0)]]);function IY(e,t){const n=PY.get(e);return n?n(t):t}var AY=class e extends nB{constructor(){super(...arguments),this.beanName="gos",this.gridReadyFired=!1,this.queueEvents=[],this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new IH,this.globalEventHandlerFactory=e=>(t,n)=>{if(!this.isAlive())return;const r=MY.has(t);if(r&&!e||!r&&e)return;const i=(e,t)=>{const r=this.gridOptions[lW.getCallbackForEvent(e)];"function"===typeof r&&this.frameworkOverrides.wrapOutgoing(()=>r(n))};if(this.gridReadyFired)i(t);else if("gridReady"===t){i(t),this.gridReadyFired=!0;for(const e of this.queueEvents)i(e.eventName,e.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:n})}}wireBeans(e){this.gridOptions=e.gridOptions,this.eGridDiv=e.eGridDiv,this.validationService=e.validationService,this.environment=e.environment,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){const e=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),e),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:e=>{let{options:t}=e;this.updateGridOptions({options:t,force:!0,source:"gridOptionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??xY[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return $H(this.gridOptions[e])}mergeGridCommonParams(e){if(e){return t=>{const n=t;return n.api=this.api,n.context=this.gridOptionsContext,e(n)}}return e}updateGridOptions(t){let{options:n,force:r,source:i="api"}=t;const o={id:e.changeSetId++,properties:[]},s=[];Object.entries(n).forEach(e=>{let[t,n]=e;"api"===i&&iW[t]&&NH(`${t} is an initial property and cannot be updated.`);const a=IY(t,n),l=r||"object"===typeof a&&"api"===i,c=this.gridOptions[t];if(l||c!==a){this.gridOptions[t]=a;const e={type:t,currentValue:a,previousValue:c,changeSet:o,source:i};s.push(e)}}),this.validationService?.processGridOptions(this.gridOptions),o.properties=s.map(e=>e.type),s.forEach(e=>{this.gridOptions.debug&&OH(`Updated property ${e.type} from`,e.previousValue," to ",e.currentValue),this.propertyEventService.dispatchEvent(e)})}addPropertyEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removePropertyEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}getGridCommonParams(){return{api:this.api,context:this.gridOptionsContext}}addGridCommonParams(e){const t=e;return t.api=this.api,t.context=this.gridOptionsContext,t}assertModuleRegistered(e,t){return Mj.__assertRegistered(e,t,this.gridId)}isModuleRegistered(e){return Mj.__isRegistered(e,this.gridId)}};AY.changeSetId=0;var DY=AY,FY=class extends nB{constructor(){super(...arguments),this.beanName="headerPositionUtils"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}findHeader(e,t){let n,r;if(XB(e.column)?n=this.visibleColsService.getGroupAtDirection(e.column,t):(r=`getCol${t}`,n=this.visibleColsService[r](e.column)),!n)return;const{headerRowIndex:i}=e;if("filter"!==this.getHeaderRowType(i)){const e=[n];for(;n.getParent();)n=n.getParent(),e.push(n);n=e[e.length-1-i]}const{column:o,headerRowIndex:s}=this.getHeaderIndexToFocus(n,i);return{column:o,headerRowIndex:s}}getHeaderIndexToFocus(e,t){let n;if(XB(e)&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const r=e;n=r.getLeafColumns()[0];let i=n;for(;i!==r;)t++,i=i.getParent()}return{column:n||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some(e=>e.isSpanHeaderHeight())}getColumnVisibleParent(e,t){const n=this.getHeaderRowType(t),r="column"===n;let i="filter"===n?e:e.getParent(),o=t-1,s=o;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;i&&i.isPadding();)i=i.getParent(),o--;s=o,o<0&&(i=e,o=t,s=void 0)}return{column:i,headerRowIndex:o,headerRowIndexWithoutSpan:s}}getColumnVisibleChild(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"After";let r=e,i=t+1;const o=i;if("group"===this.getHeaderRowType(t)){const t=e.getDisplayedLeafColumns(),o="After"===n?t[0]:VV(t),s=[];let a=o;for(;a.getParent()!==e;)a=a.getParent(),s.push(a);if(r=o,o.isSpanHeaderHeight())for(let e=s.length-1;e>=0;e--){const t=s[e];if(!t.isPadding()){r=t;break}i++}else r=VV(s),r||(r=o)}return{column:r,headerRowIndex:i,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const n=this.visibleColsService.getAllCols(),r=n["start"===t?0:n.length-1];if(!r)return;const i=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()),o=i?.getRowType(e);if("group"==o){return{headerRowIndex:e,column:this.visibleColsService.getColGroupAtLevel(r,e)}}return{headerRowIndex:null==o?-1:e,column:r}}},OY=class extends nB{constructor(){super(...arguments),this.beanName="localeService"}getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(t,n,r)=>e({key:t,defaultValue:n,variableValues:r});const t=this.gos.get("localeText");return(e,n,r)=>{let i=t&&t[e];if(i&&r&&r.length){let e=0;for(;!(e>=r.length);){if(-1===i.indexOf("${variable}"))break;i=i.replace("${variable}",r[e++])}}return i??n}}},NY=class extends nB{constructor(){super(...arguments),this.beanName="apiEventService",this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new gB(this.getFrameworkOverrides())}addEventListener(e,t){const n=this.frameworkEventWrappingService.wrap(e,t),r=sV(this.gos)&&!MY.has(e),i=r?this.asyncEventListeners:this.syncEventListeners;i.has(e)||i.set(e,new Set),i.get(e).add(n),this.eventService.addEventListener(e,n,r)}removeEventListener(e,t){const n=this.frameworkEventWrappingService.unwrap(e,t),r=this.asyncEventListeners.get(e),i=!!r?.delete(n);i||this.syncEventListeners.get(e)?.delete(n),this.eventService.removeEventListener(e,n,i)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(sV(this.gos)){const n=(e,n)=>{MY.has(e)&&t(e,n)},r=(e,n)=>{MY.has(e)||t(e,n)};this.globalEventListenerPairs.set(e,{syncListener:n,asyncListener:r}),this.eventService.addGlobalListener(n,!1),this.eventService.addGlobalListener(r,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:n,asyncListener:r}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(n,!1),this.eventService.removeGlobalListener(r,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach((e,n)=>{e.forEach(e=>this.eventService.removeEventListener(n,e,t)),e.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(e=>this.eventService.removeGlobalListener(e,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(e=>{let{syncListener:t,asyncListener:n}=e;this.eventService.removeGlobalListener(t,!1),this.eventService.removeGlobalListener(n,!0)}),this.globalEventListenerPairs.clear()}},LY=class extends nB{constructor(){super(...arguments),this.beanName="pageBoundsListener"}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventService.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){this.paginationService?this.paginationService.calculatePages():this.pageBoundsService.calculateBounds(0,this.rowModel.getRowCount()-1)}},_Y=class extends nB{constructor(){super(...arguments),this.beanName="pageBoundsService",this.pixelOffset=0}wireBeans(e){this.rowModel=e.rowModel}getFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getCurrentPageHeight(){return UH(this.topRowBounds)||UH(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}calculateBounds(e,t){this.topRowBounds=this.rowModel.getRowBounds(e),this.topRowBounds&&(this.topRowBounds.rowIndex=e),this.bottomRowBounds=this.rowModel.getRowBounds(t),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=t),this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=$H(this.topRowBounds)?this.topRowBounds.rowTop:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},HY=class extends nB{constructor(){super(),this.beanName="ariaAnnouncementService",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.updateAnnouncement=zH(this.updateAnnouncement.bind(this),200)}wireBeans(e){this.eGridDiv=e.eGridDiv}postConstruct(){const e=pV(this.gos),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),bW(t,"polite"),hW(t,"relevant","additions text"),function(e,t){hW(e,"atomic",t)}(t,!0),this.eGridDiv.appendChild(t)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)},50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(jW(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null,this.pendingAnnouncements.clear()}},VY=class extends nB{constructor(){super(...arguments),this.beanName="columnAnimationService",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(e,t){if(0===this.executeNextFuncs.length&&0===this.executeLaterFuncs.length)return e(),void t();const n=e=>{for(;e.length;){const t=e.pop();t&&t()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{e(),n(this.executeNextFuncs)},0),window.setTimeout(()=>{t(),n(this.executeLaterFuncs)},200)})}},BY=class extends nB{constructor(){super(...arguments),this.beanName="columnHoverService"}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}updateState(e){this.selectedColumns=e,this.eventService.dispatchEvent({type:"columnHoverChanged"})}},WY=class extends nB{constructor(){super(...arguments),this.beanName="overlayService",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}postConstruct(){this.isClientSide=nV(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.onGridSizeChanged.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.overlayWrapperComp=e,this.updateOverlayVisibility()}isVisible(){return 0!==this.state&&!!this.overlayWrapperComp}isExclusive(){return 1===this.state&&!!this.overlayWrapperComp}getOverlayWrapper(){return this.overlayWrapperComp}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos.get("loading");(e||void 0===e&&!this.gos.get("suppressLoadingOverlay"))&&this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")||this.gos.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")?NH("Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead."):this.doHideOverlay()}updateOverlayVisibility(){if(!this.overlayWrapperComp)return void(this.state=0);let e=this.gos.get("loading");this.showInitialOverlay&&void 0===e&&!this.gos.get("suppressLoadingOverlay")&&(e=!this.gos.get("columnDefs")||!this.columnModel.isReady()||!this.gos.get("rowData")&&this.isClientSide),e?1!==this.state&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,this.rowModel.isEmpty()&&!this.gos.get("suppressNoRowsOverlay")&&this.isClientSide?2!==this.state&&this.doShowNoRowsOverlay():0!==this.state&&this.doHideOverlay())}doShowLoadingOverlay(){this.overlayWrapperComp&&(this.state=1,this.showOverlay(this.userComponentFactory.getLoadingOverlayCompDetails({}),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.overlayWrapperComp&&(this.state=2,this.showOverlay(this.userComponentFactory.getNoRowsOverlayCompDetails({}),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.overlayWrapperComp&&(this.state=0,this.overlayWrapperComp.hideOverlay(),this.updateExclusive())}showOverlay(e,t,n){const r=e.newAgStackInstance();this.overlayWrapperComp?.showOverlay(r,t,this.isExclusive(),n),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventService.dispatchEvent({type:"overlayExclusiveChanged"})}onGridSizeChanged(){this.refreshWrapperPadding()}refreshWrapperPadding(){if(!this.overlayWrapperComp)return;let e=0;if(2===this.state){const t=this.ctrlsService.get("gridHeaderCtrl");e=t?.getHeaderHeight()||0}else 0!==this.wrapperPadding&&(e=0);this.wrapperPadding!==e&&(this.wrapperPadding=e,this.overlayWrapperComp.updateOverlayWrapperPaddingTop(e))}},zY=class extends nB{constructor(){super(...arguments),this.beanName="rowCssClassCalculator"}wireBeans(e){this.stylingService=e.stylingService}getInitialRowClasses(e){const t=[];return $H(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),KV(t,this.processClassesFromGridOptions(e.rowNode)),KV(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],n=e=>{"string"===typeof e?t.push(e):Array.isArray(e)&&e.forEach(e=>t.push(e))},r=this.gos.get("rowClass");if(r){if("function"===typeof r)return NH("rowClass should not be a function, please use getRowClass instead"),[];n(r)}const i=this.gos.getCallback("getRowClass");if(i){n(i({data:e.data,node:e,rowIndex:e.rowIndex}))}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,e=>{t.push(e)},()=>{}),t}processRowClassRules(e,t,n){const r=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),r,t,n)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}},jY=class extends nB{constructor(){super(...arguments),this.beanName="rowContainerHeightService",this.scrollY=0,this.uiBodyHeight=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=function(){if(void 0!==cz)return cz;if(!document.body)return-1;let e=1e6;const t=pz()?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const r=2*e;if(n.style.height=r+"px",r>t||n.clientHeight!==r)break;e=r}return document.body.removeChild(n),cz=e,e}(),this.gos.get("debug")&&OH("RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.gos.get("debug")&&OH(`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}},GY=class extends nB{constructor(){super(...arguments),this.beanName="rowNodeSorter"}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.showRowGroupColsService=e.showRowGroupColsService}postConstruct(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=CV(this.gos),this.addManagedPropertyListener("accentedSort",e=>this.isAccentedSort=e.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=CV(this.gos))}doFullSort(e,t){const n=e.map((e,t)=>({currentPos:t,rowNode:e}));return n.sort(this.compareRowNodes.bind(this,t)),n.map(e=>e.rowNode)}compareRowNodes(e,t,n){const r=t.rowNode,i=n.rowNode;for(let o=0,s=e.length;o<s;o++){const t=e[o],n="desc"===t.sort,s=this.getValue(r,t.column),a=this.getValue(i,t.column);let l;const c=this.getComparator(t,r);l=c?c(s,a,r,i,n):ZH(s,a,this.isAccentedSort);if(!isNaN(l)&&0!==l)return"asc"===t.sort?l:-1*l}return t.currentPos-n.currentPos}getComparator(e,t){const n=e.column,r=n.getColDef().comparator;if(null!=r)return r;if(!n.getColDef().showRowGroup)return;const i=!t.group&&n.getColDef().field;if(!i)return;const o=this.columnModel.getColDefCol(i);return o?o.getColDef().comparator:void 0}getValue(e,t){if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(EV(this.gos,this.columnModel.isPivotActive())){const n=e.allLeafChildren?.[0];return n?this.valueService.getValue(t,n,!1,!1):void 0}const n=this.showRowGroupColsService?.getShowRowGroupCol(t.getId());if(!n)return;return e.groupData?.[n.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)}},$Y=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let n=0;n<e.children.length;n++)this.depthFirstSearchChangedPath(e.children[n],t);t(e.rowNode)}depthFirstSearchEverything(e,t,n){if(e.childrenAfterGroup)for(let r=0;r<e.childrenAfterGroup.length;r++){const i=e.childrenAfterGroup[r];i.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[r],t,n):n&&t(i)}t(e)}forEachChangedNodeDepthFirst(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,n=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,n++,t=t.parent}return n}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let n=e;for(;n;)this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach(e=>this.nodeIdsToColumns[n.id][e.getId()]=!0),n=n.parent}linkPathItems(e,t){let n=e;for(let r=0;r<t;r++){const e=this.mapToItems[n.id],t=this.mapToItems[n.parent.id];t.children||(t.children=[]),t.children.push(e),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const n=this.createPathItems(e);this.linkPathItems(e,n),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const n=this.nodeIdsToColumns[e.id];return t.filter(e=>n[e.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const n=this.nodeIdsToColumns[e.id];return t.filter(e=>!n[e.getId()])}},UY=class extends nB{constructor(){super(...arguments),this.beanName="selectionService",this.selectedNodes=new Map,this.selectionCtx=new iK,this.rowSelectionMode=void 0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){const{gos:e,rowModel:t,onRowSelected:n}=this;this.selectionCtx.init(t),this.rowSelectionMode=OV(e),this.groupSelectsChildren=_V(e),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{const t=_V(e),n=OV(e);t===this.groupSelectsChildren&&n===this.rowSelectionMode||(this.groupSelectsChildren=t,this.rowSelectionMode=n,this.deselectAllRowNodes({source:"api"}))}),this.addManagedEventListeners({rowSelected:n.bind(this)})}destroy(){super.destroy(),this.resetNodes(),this.selectionCtx.reset()}isMultiSelect(){return"multiRow"===this.rowSelectionMode}overrideSelectionValue(e,t){if(!(e=>"checkboxSelected"===e||"rowClicked"===e||"spaceKey"===e||"uiSelectAll"===e||"uiSelectAllCurrentPage"===e||"uiSelectAllFiltered"===e)(t))return e;const n=this.selectionCtx.getRoot();return!n||(n.isSelected()??!1)}setNodesSelected(e){const{newValue:t,clearSelection:n,suppressFinishActions:r,rangeSelect:i,nodes:o,event:s,source:a}=e;if(0===o.length)return 0;if(o.length>1&&!this.isMultiSelect())return NH("cannot multi select unless selection mode is 'multiRow'"),0;const l=this.groupSelectsChildren&&!0===e.groupSelectsFiltered,c=o.map(e=>e.footer?e.sibling:e);if(i){if(c.length>1)return NH("cannot range select while selecting multiple rows"),0;const e=c[0],n=this.overrideSelectionValue(t,a);if(this.isMultiSelect()){if(this.selectionCtx.isInRange(e)){const t=this.selectionCtx.truncate(e);return n&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,n,a)}if(this.selectionCtx.getRoot()!==e){const t=this.selectionCtx.extend(e,this.groupSelectsChildren);return n&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,n,a)}}else;}r||this.selectionCtx.setRoot(c[0]);let u=0;for(let d=0;d<c.length;d++){const e=c[d];if(!(l&&e.group)){e.selectThisNode(t,s,a)&&u++}this.groupSelectsChildren&&e.childrenAfterGroup?.length&&(u+=this.selectChildren(e,t,l,a))}if(!r){t&&(n||!this.isMultiSelect())&&(u+=this.clearOtherNodes(c[0],a)),u>0&&(this.updateGroupsFromChildrenSelections(a),this.dispatchSelectionChanged(a))}return u}selectRange(e,t,n){let r=0;return e.forEach(e=>{if(e.group&&this.groupSelectsChildren)return;e.selectThisNode(t,void 0,n)&&r++}),r>0&&(this.updateGroupsFromChildrenSelections(n),this.dispatchSelectionChanged(n)),r}selectChildren(e,t,n,r){const i=n?e.childrenAfterAggFilter:e.childrenAfterGroup;return UH(i)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:n,source:r,nodes:i})}getSelectedNodes(){const e=[];return this.selectedNodes.forEach(t=>{t&&e.push(t)}),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>{t&&t.data&&e.push(t.data)}),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((n,r)=>{n&&e(n)&&t.set(r,n)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren)return!1;if(!nV(this.gos))return!1;const n=this.rowModel.getRootNode();t||(t=new $Y(!0,n)).setInactive();let r=!1;return t.forEachChangedNodeDepthFirst(t=>{if(t!==n){const n=t.calculateSelectedFromChildren();r=t.selectThisNode(null!==n&&n,void 0,e)||r}}),r}clearOtherNodes(e,t){const n=new Map;let r=0;return this.selectedNodes.forEach(i=>{if(i&&i.id!==e.id){const e=this.selectedNodes.get(i.id);r+=e.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&i.parent&&n.set(i.parent.id,i.parent)}}),n.forEach(e=>{const n=e.calculateSelectedFromChildren();e.selectThisNode(null!==n&&n,void 0,t)}),r}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if($H(t)&&e.id!==t.id&&t){const n=t.id;this.selectedNodes.get(n)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes?.clear()}getBestCostNodeSelection(){if(!nV(this.gos))return;const e=this.rowModel.getTopLevelNodes();if(null===e)return;const t=[];return function e(n){for(let r=0,i=n.length;r<i;r++){const i=n[r];if(i.isSelected())t.push(i);else{const t=i;t.group&&t.children&&e(t.children)}}}(e),t}isEmpty(){let e=0;return this.selectedNodes.forEach(t=>{t&&e++}),0===e}deselectAllRowNodes(e){const t=e=>e.selectThisNode(!1,void 0,r),n=nV(this.gos),{source:r,justFiltered:i,justCurrentPage:o}=e;if(o||i){if(!n)return void LH("selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(i,o).forEach(t)}else this.selectedNodes.forEach(e=>{e&&t(e)}),this.reset(r);this.selectionCtx.reset(),n&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)}getSelectedCounts(e,t){let n=0,r=0;return this.getNodesToSelect(e,t).forEach(e=>{this.groupSelectsChildren&&e.group||(e.isSelected()?n++:e.selectable&&r++)}),{selectedCount:n,notSelectedCount:r}}getSelectAllState(e,t){const{selectedCount:n,notSelectedCount:r}=this.getSelectedCounts(e,t);return(0!==n||0!==r)&&(n>0&&r>0?null:n>0)}hasNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getNodesToSelect(e,t).filter(e=>e.selectable).length>0}getNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.validateSelectAllType();const n=[];if(t)return this.forEachNodeOnPage(e=>{if(e.group){if(!e.expanded){const t=e=>{n.push(e),e.childrenAfterFilter?.length&&e.childrenAfterFilter.forEach(t)};return void t(e)}this.groupSelectsChildren||n.push(e)}else n.push(e)}),n;const r=this.rowModel;return e?(r.forEachNodeAfterFilter(e=>{n.push(e)}),n):(r.forEachNode(e=>{n.push(e)}),n)}forEachNodeOnPage(e){const t=this.pageBoundsService.getFirstRow(),n=this.pageBoundsService.getLastRow();for(let r=t;r<=n;r++){const t=this.rowModel.getRow(r);t&&e(t)}}selectAllRowNodes(e){if("string"!==typeof this.gos.get("rowSelection")&&!NV(this.gos))return NH("cannot multi select unless selection mode is 'multiRow'");this.validateSelectAllType();const{source:t,justFiltered:n,justCurrentPage:r}=e,i=this.getNodesToSelect(n,r);i.forEach(e=>e.selectThisNode(!0,void 0,t)),this.selectionCtx.setRoot(i[0]??null),this.selectionCtx.setEndRange(VV(i)??null),nV(this.gos)&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t),this.dispatchSelectionChanged(t)}getSelectionState(){const e=[];return this.selectedNodes.forEach(t=>{t?.id&&e.push(t.id)}),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return LH("Invalid selection state. When using client-side row model, the state must conform to `string[]`.");const n=new Set(e),r=[];this.rowModel.forEachNode(e=>{n.has(e.id)&&r.push(e)}),this.setNodesSelected({newValue:!0,nodes:r,source:t})}dispatchSelectionChanged(e){this.eventService.dispatchEvent({type:"selectionChanged",source:e})}validateSelectAllType(){if(!nV(this.gos))throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`)}},KY=class extends nB{constructor(){super(...arguments),this.beanName="selectableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{gos:t}=this,n=oV(t),r=FV(t);if(!n||!r)return;const i=_V(t),o=nV(t)&&i,s=[],a=t=>{if(e&&!t.group)return;if(o&&t.group){const e=t.childrenAfterGroup.some(e=>!0===e.selectable);return void t.setRowSelectable(e,!0)}const n=r?.(t)??!0;t.setRowSelectable(n,!0),!n&&t.isSelected()&&s.push(t)};if(o){const e=this.rowModel;new $Y(!1,e.getRootNode()).forEachChangedNodeDepthFirst(a,!0,!0)}else this.rowModel.forEachNode(a);s.length&&this.selectionService.setNodesSelected({nodes:s,newValue:!1,source:"selectableChanged"}),o&&this.selectionService instanceof UY&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},YY=["asc","desc",null],qY=class extends nB{constructor(){super(...arguments),this.beanName="sortController"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.showRowGroupColsService=e.showRowGroupColsService}progressSort(e,t,n){const r=this.getNextSortDirection(e);this.setSortForColumn(e,r,t,n)}setSortForColumn(e,t,n,r){"asc"!==t&&"desc"!==t&&(t=null);let i=[e];if(CV(this.gos)&&e.getColDef().showRowGroup){const t=this.funcColsService.getSourceColumnsForGroupColumn(e),n=t?.filter(e=>e.isSortable());n&&(i=[e,...n])}i.forEach(e=>e.setSort(t,r));const o=[];if(!((n||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"))){const e=this.clearSortBarTheseColumns(i,r);o.push(...e)}this.updateSortIndex(e),o.push(...i),this.dispatchSortChangedEvents(r,o)}updateSortIndex(e){const t=CV(this.gos),n=this.showRowGroupColsService?.getShowRowGroupCol(e.getId()),r=t&&n||e,i=this.getColumnsWithSortingOrdered();this.columnModel.getAllCols().forEach(e=>e.setSortIndex(null));const o=i.filter(e=>(!t||!e.getColDef().showRowGroup)&&e!==r);(r.getSort()?[...o,r]:o).forEach((e,t)=>{e.setSortIndex(t)})}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const e=this.columnModel.getAllCols().filter(e=>!!e.getSort());return e&&e.length>0}dispatchSortChangedEvents(e,t){const n={type:"sortChanged",source:e};t&&(n.columns=t),this.eventService.dispatchEvent(n)}clearSortBarTheseColumns(e,t){const n=[];return this.columnModel.getAllCols().forEach(r=>{e.includes(r)||(r.getSort()&&n.push(r),r.setSort(void 0,t))}),n}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gos.get("sortingOrder")?this.gos.get("sortingOrder"):YY,!Array.isArray(t)||t.length<=0)return NH(`sortingOrder must be an array with at least one element, currently it's ${t}`),null;const n=t.indexOf(e.getSort()),r=n<0,i=n==t.length-1;let o;return o=r||i?t[0]:t[n+1],YY.indexOf(o)<0?(NH("invalid sort type ",o),null):o}getIndexedSortMap(){let e=this.columnModel.getAllCols().filter(e=>!!e.getSort());if(this.columnModel.isPivotMode()){const t=CV(this.gos);e=e.filter(e=>{const n=!!e.getAggFunc(),r=!e.isPrimary(),i=t?this.showRowGroupColsService?.getShowRowGroupCol(e.getId()):e.getColDef().showRowGroup;return n||r||i})}const t=this.funcColsService.getRowGroupColumns().filter(e=>!!e.getSort()),n={};e.forEach((e,t)=>n[e.getId()]=t),e.sort((e,t)=>{const r=e.getSortIndex(),i=t.getSortIndex();if(null!=r&&null!=i)return r-i;if(null==r&&null==i){return n[e.getId()]>n[t.getId()]?1:-1}return null==i?-1:1});const r=CV(this.gos)&&!!t.length;r&&(e=[...new Set(e.map(e=>this.showRowGroupColsService?.getShowRowGroupCol(e.getId())??e))]);const i=new Map;return e.forEach((e,t)=>i.set(e,t)),r&&t.forEach(e=>{const t=this.showRowGroupColsService.getShowRowGroupCol(e.getId());i.set(e,i.get(t))}),i}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort((e,t)=>{let[n,r]=e,[i,o]=t;return r-o}).map(e=>{let[t]=e;return t})}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){const t=CV(this.gos),n=!!e.getColDef().showRowGroup;return t&&n}getDisplaySortForColumn(e){const t=this.funcColsService.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const n=null!=e.getColDef().field||!!e.getColDef().valueGetter?[e,...t]:t,r=n[0].getSort();return n.every(e=>e.getSort()==r)?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}},XY=class extends nB{constructor(){super(...arguments),this.beanName="syncService",this.waitingForColumns=!1}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.rowModel=e.rowModel}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.ctrlsService.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.eventService.dispatchEvent({type:"gridReady"});const e=this.gos.isModuleRegistered("@ag-grid-enterprise/core");this.gos.get("debug")&&OH(`initialised successfully, enterprise = ${e}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t)return this.waitingForColumns?(this.waitingForColumns=!1,void this.setColumnsAndData(t)):void this.columnModel.setColumnDefs(t,FB(e.source))}},QY=class extends nB{constructor(){super(...arguments),this.beanName="changeDetectionService"}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer}postConstruct(){nV(this.gos)&&(this.clientSideRowModel=this.rowModel),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const n=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const r=this.gos.get("aggregateOnlyChangedColumns"),i=new $Y(r,this.clientSideRowModel.getRootNode());i.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(i),i.forEachChangedNodeDepthFirst(e=>{n.push(e)})}this.rowRenderer.refreshCells({rowNodes:n})}},JY=class extends nB{constructor(){super(...arguments),this.beanName="expressionService",this.expressionToFunctionCache={}}evaluate(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);LH("value should be either a string or a function",e)}evaluateExpression(e,t){try{const n=this.createExpressionFunction(e);return n(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(n){return OH("Processing of the expression failed"),OH("Expression = ",e),OH("Params = ",t),OH("Exception = ",n),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=n,n}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},ZY=class extends nB{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,n){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=n)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}},eq=class extends nB{constructor(){super(...arguments),this.beanName="valueService",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionService=e.expressionService,this.columnModel=e.columnModel,this.valueCache=e.valueCache,this.dataTypeService=e.dataTypeService}postConstruct(){this.initialised||this.init()}init(){this.isSsrm=rV(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=e=>this.callColumnCellValueChangedHandler(e),t=sV(this.gos);this.eventService.addEventListener("cellValueChanged",e,t),this.addDestroyFunc(()=>this.eventService.removeEventListener("cellValueChanged",e,t)),this.addManagedPropertyListener("treeData",e=>this.isTreeData=e.currentValue)}getValueForDisplay(e,t){const n=t.leafGroup&&this.columnModel.isPivotMode(),r=t.group&&t.expanded&&!t.footer&&!n,i=this.gos.get("groupSuppressBlankHeader");if(!r||i)return this.getValue(e,t);let o=!1;const s=this.gos.get("groupTotalRow")??this.gos.get("groupIncludeFooter");if("function"!==typeof s)o=!!s;else{o=!!(this.gos.getCallback("groupTotalRow")??this.gos.getCallback("groupIncludeFooter"))({node:this})}const a=r&&o;return this.getValue(e,t,!1,a)}getValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.initialised||this.init(),!t)return;const i=e.getColDef(),o=i.field,s=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[s],u=!r&&t.aggData&&void 0!==t.aggData[s],d=this.isSsrm&&r&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(n&&i.filterValueGetter?l=this.executeFilterValueGetter(i.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[s]:this.isTreeData&&i.valueGetter?l=this.executeValueGetter(i.valueGetter,a,e,t):this.isTreeData&&o&&a?l=yB(a,o,e.isFieldContainsDots()):c?l=t.groupData[s]:u?l=t.aggData[s]:i.valueGetter?l=this.executeValueGetter(i.valueGetter,a,e,t):h?l=yB(a,t.field,e.isFieldContainsDots()):o&&a&&!d&&(l=yB(a,o,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof l&&0===l.indexOf("=")){const n=l.substring(1);l=this.executeValueGetter(n,a,e,t)}if(null==l){const n=this.getOpenedGroup(t,e);if(null!=n)return n}return l}parseValue(e,t,n,r){const i=e.getColDef(),o=i.valueParser;if($H(o)){const s=this.gos.addGridCommonParams({node:t,data:t?.data,oldValue:r,newValue:n,colDef:i,column:e});return"function"===typeof o?o(s):this.expressionService.evaluate(o,s)}return n}getDeleteValue(e,t){return $H(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,n,r){let i,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=null;const a=e.getColDef();if(r?i=r:o&&(i=a.valueFormatter),i){const r=this.gos.addGridCommonParams({value:n,node:t,data:t?t.data:null,colDef:a,column:e});s="function"===typeof i?i(r):this.expressionService.evaluate(i,r)}else if(a.refData)return a.refData[n]||"";return null==s&&Array.isArray(n)&&(s=n.join(", ")),s}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup"))return;if(!t.getColDef().showRowGroup)return;const n=t.getColDef().showRowGroup;let r=e.parent;for(;null!=r;){if(r.rowGroupColumn&&(!0===n||n===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}setValue(e,t,n,r){const i=this.columnModel.getColDefCol(t);if(!e||!i)return!1;UH(e.data)&&(e.data={});const{field:o,valueSetter:s}=i.getColDef();if(UH(o)&&UH(s))return NH("you need either field or valueSetter set on colDef for editing to work"),!1;if(this.dataTypeService&&!this.dataTypeService.checkType(i,n))return NH("Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(i,e),newValue:n,colDef:i.getColDef(),column:i});let l;if(a.newValue=n,l=$H(s)?"function"===typeof s?s(a):this.expressionService.evaluate(s,a):this.setValueUsingField(e.data,o,n,i.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged();const c=this.getValue(i,e);return this.eventService.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:c,value:c,source:r}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"===typeof t&&this.getFrameworkOverrides().wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,n,r){if(!t)return!1;let i=!1;if(r){const r=t.split(".");let o=e;for(;r.length>0&&o;){const e=r.shift();0===r.length?(i=o[e]===n,i||(o[e]=n)):o=o[e]}}else i=e[t]===n,i||(e[t]=n);return!i}executeFilterValueGetter(e,t,n,r){const i=this.gos.addGridCommonParams({data:t,node:r,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,r)});return"function"===typeof e?e(i):this.expressionService.evaluate(e,i)}executeValueGetter(e,t,n,r){const i=n.getColId(),o=this.valueCache.getValue(r,i);if(void 0!==o)return o;const s=this.gos.addGridCommonParams({data:t,node:r,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,r)});let a;return a="function"===typeof e?e(s):this.expressionService.evaluate(e,s),this.valueCache.setValue(r,i,a),a}getValueCallback(e,t){const n=this.columnModel.getColDefCol(t);return n?this.getValue(n,e):null}getKeyForNode(e,t){const n=this.getValue(e,t),r=e.getColDef().keyCreator;let i=n;if(r){i=r(this.gos.addGridCommonParams({value:n,colDef:e.getColDef(),column:e,node:t,data:t.data}))}return"string"===typeof i||null==i||(i=String(i),"[object Object]"===i&&NH("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),i}},tq=class e{static applyGlobalGridOptions(t){if(!e.gridOptions)return t;let n={};return CB(n,e.gridOptions,!0,!0),"deep"===e.mergeStrategy?CB(n,t,!0,!0):n={...n,...t},e.gridOptions.context&&(n.context=e.gridOptions.context),t.context&&("deep"===e.mergeStrategy&&n.context&&CB(t.context,n.context,!0,!0),n.context=t.context),n}};tq.gridOptions=void 0,tq.mergeStrategy="shallow";var nq=tq;var rq=1,iq=class{create(e,t,n,r,i){const o=function(e){const t={};return Object.entries(e).forEach(e=>{let[n,r]=e;const i=IY(n,r);t[n]=i}),t}(nq.applyGlobalGridOptions(t)),s=o.gridId??String(rq++),a=this.getRegisteredModules(i,s),l=this.createBeansList(o.rowModelType,a,s),c=this.createProvidedBeans(e,o,i);if(!l)return void LH("Failed to create grid.");const u=new Ij({providedBeanInstances:c,beanClasses:l,gridId:s,beanInitComparator:IK,beanDestroyComparator:AK,derivedBeans:[yK]});return this.registerModuleUserComponents(u,a),this.registerControllers(u,a),this.registerModuleApiFunctions(u,a),n(u),u.getBean("syncService").start(),r&&r(u),u.getBean("gridApi")}registerControllers(e,t){const n=e.getBean("ctrlsFactory");t.forEach(e=>{e.controllers&&e.controllers.forEach(e=>n.register(e))})}getRegisteredModules(e,t){const n=e?e.modules:null,r=Mj.__getRegisteredModules(t),i=[],o={},s=(e,t,n)=>{var r;o[(r=t).moduleName]||(o[r.moduleName]=!0,i.push(r),Mj.__register(r,e,n)),t.dependantModules&&t.dependantModules.forEach(t=>s(e,t,n))};return s(!!n?.length||!Mj.__isPackageBased(),TY,void 0),n&&n.forEach(e=>s(!0,e,t)),r&&r.forEach(e=>s(!Mj.__isPackageBased(),e,void 0)),i}registerModuleUserComponents(e,t){const n=this.extractModuleEntity(t,e=>e.userComponents?e.userComponents:[]),r=e.getBean("userComponentRegistry");n.forEach(e=>{let{name:t,classImp:n,params:i}=e;r.registerDefaultComponent(t,n,i)})}registerModuleApiFunctions(e,t){const n=e.getBean("apiFunctionService");t.forEach(e=>{const t=e.apiFunctions;if(t){Object.keys(t).forEach(e=>{n?.addFunction(e,t[e])})}})}createProvidedBeans(e,t,n){let r=n?n.frameworkOverrides:null;UH(r)&&(r=new pK);const i={gridOptions:t,eGridDiv:e,globalEventListener:n?n.globalEventListener:null,globalSyncEventListener:n?n.globalSyncEventListener:null,frameworkOverrides:r};return n&&n.providedBeanInstances&&Object.assign(i,n.providedBeanInstances),i}createBeansList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clientSide",t=arguments.length>2?arguments[2]:void 0;const n=(arguments.length>1?arguments[1]:void 0).filter(t=>!t.rowModel||t.rowModel===e),r={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!r[e])return void LH("Could not find row model for rowModelType = ",e);if(!Mj.__assertRegistered(r[e],`rowModelType = '${e}'`,t))return;const i=[LK,OK,FY,kY,CK,nj,kK,MK,RU,Ej,jY,SU,OY,eK,Nj,ZB,jK,DY,dK,UY,DB,o$,_Y,LY,JU,JY,IB,yU,ZY,eq,XU,xU,Dj,$K,CU,BK,gK,oK,vU,qY,BY,VY,KY,QY,EU,SK,zY,GY,FK,UK,NK,DK,XY,WY,TU,NY,HY,kU,VB,xK,WB,_B,RK,EK,YB,HB,UB,TK,KB,sB],o=this.extractModuleEntity(n,e=>e.beans?e.beans:[]);i.push(...o);const s=[];return i.forEach(e=>{s.indexOf(e)<0&&s.push(e)}),s}extractModuleEntity(e,t){return[].concat(...e.map(t))}},oq=class extends nB{constructor(){super(...arguments),this.beanName="rowModelHelperService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){const e=this.rowModel;switch(e.getType()){case"clientSide":this.clientSideRowModel=e;break;case"infinite":this.infiniteRowModel=e;break;case"serverSide":this.serverSideRowModel=e}}getClientSideRowModel(){return this.clientSideRowModel}getInfiniteRowModel(){return this.infiniteRowModel}getServerSideRowModel(){return this.serverSideRowModel}};var sq={version:WG,moduleName:"@ag-grid-community/csrm-ssrm-shared-api",apiFunctions:{expandAll:function(e){e.expansionService.expandAll(!0)},collapseAll:function(e){e.expansionService.expandAll(!1)},onRowHeightChanged:function(e){const t=e.rowModelHelperService?.getClientSideRowModel(),n=e.rowModelHelperService?.getServerSideRowModel();t?t.onRowHeightChanged():n&&n.onRowHeightChanged()}}},aq={version:WG,moduleName:"@ag-grid-community/ssrm-infinite-shared-api",apiFunctions:{setRowCount:function(e,t,n){const r=e.rowModelHelperService?.getServerSideRowModel();if(r)return e.funcColsService.isRowGroupEmpty()?void r.setRowCount(t,n):void LH("setRowCount cannot be used while using row grouping.");const i=e.rowModelHelperService?.getInfiniteRowModel();i&&i.setRowCount(t,n)},getCacheBlockState:function(e){return e.rowNodeBlockLoader?.getBlockState()??{}},isLastRowIndexKnown:function(e){return e.rowModel.isLastRowIndexKnown()}}},lq=class{wrap(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;const i=this.createWrapper(e,r);return t.forEach(e=>{this.createMethod(i,e,!0)}),n.forEach(e=>{this.createMethod(i,e,!1)}),i}createMethod(e,t,n){e.addMethod(t,this.createMethodProxy(e,t,n))}createMethodProxy(e,t,n){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(n&&NH("Framework component is missing the method "+t+"()"),null)}}},cq=class{};cq.CHART_TYPE_TO_SERIES_TYPE={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall"},cq.COMBO_CHART_TYPES=["columnLineCombo","areaColumnCombo","customCombo"],cq.SERIES_GROUP_TYPES=["grouped","stacked","normalized"];var uq="undefined"===typeof global?{}:global;uq.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,uq.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,uq.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,uq.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,uq.Node="undefined"===typeof Node?{}:Node,uq.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var dq=class{constructor(e,t,n,r,i,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=n,this.funcColsService=r,this.beans=o,this.selectionService=i,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id="ROOT_NODE_ID",this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return vB(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"===typeof e)return void NH("rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,n=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map((e,t)=>this.createNode(e,this.rootNode,0,t)):(t.allLeafChildren=[],t.childrenAfterGroup=[]),n&&(n.childrenAfterFilter=t.childrenAfterFilter,n.childrenAfterGroup=t.childrenAfterGroup,n.childrenAfterAggFilter=t.childrenAfterAggFilter,n.childrenAfterSort=t.childrenAfterSort,n.childrenMapped=t.childrenMapped,n.allLeafChildren=t.allLeafChildren)}updateRowData(e){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const t={rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},n=[];return this.executeRemove(e,t,n),this.executeUpdate(e,t,n),this.executeAdd(e,t),this.updateSelection(n,"rowDataChanged"),t}updateRowOrderFromRowData(e){const t=this.rootNode.allLeafChildren,n=t?.length??0,r=new Map;let i=-1,o=-1;for(let s=0;s<n;++s){const n=t[s],a=n.data;a!==e[s]&&(o<0&&(i=s),o=s,r.set(a,n))}if(i<0)return!1;for(let s=i;s<=o;++s){const n=r.get(e[s]);void 0!==n&&(t[s]=n,n.sourceRowIndex=s)}return!0}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){this.eventService.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}updateSelection(e,t){const n=e.length>0;n&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),n&&this.eventService.dispatchEvent({type:"selectionChanged",source:t})}executeAdd(e,t){const n=e.add;if(KH(n))return;const r=this.rootNode.allLeafChildren;let i=r.length;if("number"===typeof e.addIndex&&(i=this.sanitizeAddIndex(e.addIndex),i>0)){if(this.gos.get("treeData"))for(let e=0;e<r.length;e++){const t=r[e];if(t?.rowIndex==i-1){i=e+1;break}}}const o=n.map((e,t)=>this.createNode(e,this.rootNode,0,i+t));if(i<r.length){const e=r.slice(0,i),n=r.slice(i,r.length),s=e.length+o.length;for(let t=0,r=n.length;t<r;++t)n[t].sourceRowIndex=s+t;this.rootNode.allLeafChildren=[...e,...o,...n],t.rowsInserted=!0}else this.rootNode.allLeafChildren=r.concat(o);const s=this.rootNode.sibling;s&&(s.allLeafChildren=r),t.rowNodeTransaction.add=o}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}executeRemove(e,t,n){let{rowNodeTransaction:r}=t;const{remove:i}=e;if(KH(i))return;const o={};i.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.isSelected()&&n.push(t),t.clearRowTopAndRowIndex(),o[t.id]=!0,delete this.allNodesMap[t.id],r.remove.push(t))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren?.filter(e=>!o[e.id])??null,this.rootNode.allLeafChildren?.forEach((e,t)=>{e.sourceRowIndex=t});const s=this.rootNode.sibling;s&&(s.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,t,n){let{rowNodeTransaction:r}=t;const{update:i}=e;KH(i)||i.forEach(e=>{const t=this.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&n.push(t),this.setMasterForRow(t,e,0,!1),r.update.push(t))})}lookupRowNode(e){const t=TV(this.gos);let n;if(t){const r=t({data:e,level:0});if(n=this.allNodesMap[r],!n)return LH(`could not find row id=${r}, data item was not found for this id`),null}else if(n=this.rootNode.allLeafChildren?.find(t=>t.data===e),!n)return LH("could not find data item as object was not found",e),LH("Consider using getRowId to help the Grid find matching row data"),null;return n||null}createNode(e,t,n,r){const i=new zj(this.beans);return i.sourceRowIndex=r,i.group=!1,this.setMasterForRow(i,e,n,!0),t&&(i.parent=t),i.level=n,i.setDataAndId(e,this.nextId.toString()),this.allNodesMap[i.id]&&NH(`duplicate node id '${i.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[i.id]=i,this.nextId++,i}setMasterForRow(e,t,n,r){if(this.gos.get("treeData"))e.setMaster(!1),r&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const n=this.gos.get("isRowMaster");n?e.setMaster(n(t)):e.setMaster(!0)}else e.setMaster(!1);if(r){const t=this.funcColsService.getRowGroupColumns(),r=n+(t?t.length:0);e.expanded=!!e.master&&this.isExpanded(r)}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return-1===t||e<t}};var hq="32.3.8",pq={version:hq,moduleName:"@ag-grid-community/client-side-row-model-core",rowModel:"clientSide",beans:[class extends nB{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=zH(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new zj(this.beans),this.nodeManager=new dq(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),n=new Set(["excludeChildrenWhenTreeDataFiltering"]),r=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),i=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),o=new Set(["postSortRows","groupDisplayType","accentedSort"]),s=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...n,...r,...r,...i,...o,...s,...a];this.addManagedPropertyListeners(l,l=>{const c=l.changeSet?.properties;if(!c)return;const u=e=>c.some(t=>e.has(t));u(e)?this.setRowData(this.rootNode.allLeafChildren.map(e=>e.data)):u(t)?this.refreshModel({step:"group"}):u(n)?this.refreshModel({step:"filter"}):u(r)?this.refreshModel({step:"pivot"}):u(i)?this.refreshModel({step:"aggregate"}):u(o)?this.refreshModel({step:"sort"}):u(s)?this.refreshModel({step:"filter_aggregates"}):u(a)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,n,r){let i,o=!1;do{i=!1;const s=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(s,n),c=Math.min(a,r);for(let e=l;e<=c;e++){const t=this.getRow(e);if(t.rowHeightEstimated){const e=lV(this.gos,t);t.setRowHeight(e.height),i=!0,o=!0}}i&&this.setRowTopAndRowIndex()}while(i);return o}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const n=new Set,r=iV(this.gos,"normal");for(let i=0;i<this.rowsToDisplay.length;i++){const o=this.rowsToDisplay[i];if(null!=o.id&&n.add(o.id),null==o.rowHeight){const t=lV(this.gos,o,r,e);o.setRowHeight(t.height,t.estimated)}o.setRowTop(t),o.setRowIndex(i),t+=o.rowHeight}return n}clearRowTopAndRowIndex(e,t){const n=e.isActive(),r=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},i=e=>{if(r(e),r(e.detailNode),r(e.sibling),e.hasChildren()&&e.childrenAfterGroup){const t=-1==e.level;n&&!t&&!e.expanded||e.childrenAfterGroup.forEach(i)}};i(this.rootNode)}ensureRowsAtPixel(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.getRowIndexAtPixel(t),i=this.getRow(r),o=!this.gos.get("suppressAnimationFrame");if(i===e[0])return!1;const s=this.rootNode.allLeafChildren;return e.forEach(e=>{zV(s,e)}),e.forEach((e,t)=>{jV(s,e,Math.max(r+n,0)+t)}),e.forEach((e,t)=>{e.sourceRowIndex=t}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:o,rowNodesOrderChanged:!0}),!0}highlightRowAtPixel(e,t){const n=null!=t?this.getRowIndexAtPixel(t):null,r=null!=n?this.getRow(n):null;if(!r||!e||null==t)return void this.clearHighlightedRow();const i=this.getHighlightPosition(t,r),o=this.isHighlightingCurrentPosition(e,r,i),s=null!=this.lastHighlightedRow&&this.lastHighlightedRow!==r;(o||s)&&(this.clearHighlightedRow(),o)||(r.setHighlighted(i),this.lastHighlightedRow=r)}getHighlightPosition(e,t){if(!t){const n=this.getRowIndexAtPixel(e);if(!(t=this.getRow(n||0)))return 1}const{rowTop:n,rowHeight:r}=t;return e-n<r/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,n){if(e===t)return!0;const r=0===n?-1:1;return this.getRow(t.rowIndex+r)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter,t=this.rootNode.sibling?1:0;return(e?e.length:0)+t}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let t=e;if(this.rowsToDisplay[0].footer){if(0===e)return 0;t-=1}const n=this.rowsToDisplay[this.rowsToDisplay.length-1],r=t>=this.rootNode.childrenAfterSort.length;if(n.footer&&r)return n.rowIndex;let i=this.rootNode.childrenAfterSort[t];if(this.gos.get("groupHideOpenParents"))for(;i.expanded&&i.childrenAfterSort&&i.childrenAfterSort.length>0;)i=i.childrenAfterSort[0];return i.rowIndex}getRowBounds(e){if(UH(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=wV(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=wV(this.gos),n=0===e.columns.length||e.columns.some(e=>e.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=wV(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=KH(e),n=new $Y(!1,this.rootNode);return t&&n.setInactive(),n}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter(e=>null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0);return null==t||0==t.length}buildRefreshModelParams(e){let t="group";const n={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",filter_aggregates:"filter_aggregates",sort:"sort",pivot:"pivot",nothing:"nothing"};if($H(e)&&(t=n[e]),UH(t))return void LH(`invalid step ${e}, available steps are ${Object.keys(n).join(", ")}`);return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t="object"===typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const n=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,n,!!t.rowNodesOrderChanged,!!t.afterColumnsChanged);case"filter":this.doFilter(n);case"pivot":this.doPivot(n);case"aggregate":this.doAggregate(n);case"filter_aggregates":this.doFilterAggregates(n);case"sort":this.doSort(t.rowNodeTransactions,n);case"map":this.doRowsToDisplay()}const r=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(n,r),this.isRefreshingModel=!1,this.eventService.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){const e=UH(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return UH(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return $H(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let n=!1,r=!1;const i=[],o=_V(this.gos);return this.forEachNodeAfterFilterAndSort(s=>{if(r)return;if(n&&(s===t||s===e)&&(r=!0,s.group&&o))return void i.push(...s.allLeafChildren);if(!n){if(s!==t&&s!==e)return;n=!0}(!s.group||!o)&&i.push(s)}),i}setDatasource(e){LH("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let t=0,n=this.rowsToDisplay.length-1;if(e<=0)return 0;if(VV(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let r=-1,i=-1;for(;;){const o=Math.floor((t+n)/2),s=this.rowsToDisplay[o];if(this.isRowInPixel(s,e))return o;s.rowTop<e?t=o+1:s.rowTop>e&&(n=o-1);if(r===t&&i===n)return o;r=t,i=n}}isRowInPixel(e,t){const n=e.rowTop,r=e.rowTop+e.rowHeight;return n<=t&&r>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((t,n)=>e(t,n))}forEachNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:n,recursionType:r,includeFooterNodes:i}=e;let{index:o}=e;const s=e=>{const r=t[0]?.parent;if(!r)return;const s=i&&SV(this.gos),a=xV(this.gos),l=i&&a({node:r});r===this.rootNode?s===e&&(r.createFooter(),n(r.sibling,o++)):l===e&&(r.createFooter(),n(r.sibling,o++))};s("top");for(let a=0;a<t.length;a++){const e=t[a];if(n(e,o++),e.hasChildren()&&!e.footer){let t=null;switch(r){case 0:t=e.childrenAfterGroup;break;case 1:t=e.childrenAfterAggFilter;break;case 2:t=e.childrenAfterSort;break;case 3:t=e.leafGroup?null:e.childrenAfterSort}t&&(o=this.recursivelyWalkNodesAndCallback({nodes:[...t],callback:n,recursionType:r,index:o,includeFooterNodes:i}))}}return s("bottom"),o}doAggregate(e){this.aggregationStage?.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),n=this.columnModel.isPivotActive(),r=i=>{i&&i.forEach(i=>{const o=()=>{i.expanded=e,r(i.childrenAfterGroup)};if(t){return void($H(i.childrenAfterGroup)&&o())}if(n){return void(!i.leafGroup&&o())}i.group&&o()})};this.rootNode&&r(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"}),this.eventService.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,n,r){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodesOrderChanged:n,changedPath:t}):this.groupStage.execute({rowNode:this.rootNode,changedPath:t,afterColumnsChanged:r}),_V(this.gos)){this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",t)&&this.eventService.dispatchEvent({type:"selectionChanged",source:"rowGroupChanged"})}}else{const e=this.rootNode,t=e.sibling;e.childrenAfterGroup=e.allLeafChildren,t&&(t.childrenAfterGroup=e.childrenAfterGroup),this.rootNode.updateHasChildren()}this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getNodeManager(){return this.nodeManager}getRowNode(e){if("string"==typeof e&&0==e.indexOf(zj.ID_PREFIX_ROW_GROUP)){let t;return this.forEachNode(n=>{n.id===e&&(t=n)}),t}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let n=!1;this.rowDataTransactionBatch?.forEach(r=>{const{rowNodeTransaction:i,rowsInserted:o}=this.nodeManager.updateRowData(r.rowDataTransaction);o&&(n=!0),t.push(i),r.callback&&e.push(r.callback.bind(null,i))}),this.commonUpdateRowData(t,n),e.length>0&&window.setTimeout(()=>{e.forEach(e=>e())},0),t.length>0&&this.eventService.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache.onDataChanged();const{rowNodeTransaction:t,rowsInserted:n}=this.nodeManager.updateRowData(e);return this.commonUpdateRowData([t],n),t}afterImmutableDataChange(e,t){this.commonUpdateRowData([e],t)}commonUpdateRowData(e,t){if(!this.hasStarted)return;const n=!this.gos.get("suppressAnimationFrame");this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodesOrderChanged:t,keepRenderedRows:!0,keepEditingRows:!0,animate:n})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const n=t.detailNode;n&&n.setRowHeight(n.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow()}},class extends nB{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const n=(t,n)=>{t.hasChildren()?t.childrenAfterFilter=e&&!n?t.childrenAfterGroup.filter(e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,n=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||n}):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const e=(t,r)=>{if(t.childrenAfterGroup)for(let i=0;i<t.childrenAfterGroup.length;i++){const o=t.childrenAfterGroup[i],s=r||this.filterManager.doesRowPassFilter({rowNode:o});o.childrenAfterGroup?e(t.childrenAfterGroup[i],s):n(o,s)}n(t,r)},r=t=>e(t,!1);t.executeFromRootNode(r)}else{const e=e=>n(e,!1);t.forEachChangedNodeDepthFirst(e,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},class extends nB{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),n=$H(t)&&t.length>0,r=n&&$H(e.rowNodeTransactions)&&this.gos.get("deltaSort"),i=t.some(e=>CV(this.gos)?e.column.isPrimary()&&e.column.isRowGroupActive():!!e.column.getColDef().showRowGroup);this.sortService.sort(t,n,r,e.rowNodeTransactions,e.changedPath,i)}},class extends nB{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,n=[],r=this.columnModel.isPivotMode(),i=r&&t.leafGroup,o=i?[t]:t.childrenAfterSort,s=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(s,o,n,r,0);if(!i&&n.length>0&&s.grandTotalRow){t.createFooter();const e="top"===s.grandTotalRow;this.addRowNodeToRowsToDisplay(s,t.sibling,n,0,e)}return n}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:RV(this.gos),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:SV(this.gos),groupTotalRow:xV(this.gos)}}recursivelyAddToRowsToDisplay(e,t,n,r,i){if(!KH(t))for(let o=0;o<t.length;o++){const s=t[o],a=s.hasChildren(),l=r&&!a,c=e.groupRemoveSingleChildren&&a&&1===s.childrenAfterGroup.length,u=e.groupRemoveLowestSingleChildren&&a&&s.leafGroup&&1===s.childrenAfterGroup.length,d=r&&s.leafGroup,h=e.hideOpenParents&&s.expanded&&!s.master&&!d;if(!l&&!h&&!c&&!u&&this.addRowNodeToRowsToDisplay(e,s,n,i),!r||!s.leafGroup)if(a){const t=c||u;if(s.expanded||t){const o=e.groupTotalRow({node:s});o||s.destroyFooter();const a=t?i:i+1;"top"===o&&(s.createFooter(),this.addRowNodeToRowsToDisplay(e,s.sibling,n,a)),this.recursivelyAddToRowsToDisplay(e,s.childrenAfterSort,n,r,a),"bottom"===o&&(s.createFooter(),this.addRowNodeToRowsToDisplay(e,s.sibling,n,a))}}else if(s.master&&s.expanded){const t=this.createDetailNode(s);this.addRowNodeToRowsToDisplay(e,t,n,i)}}}addRowNodeToRowsToDisplay(e,t,n,r,i){i?n.unshift(t):n.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:r)}createDetailNode(e){if($H(e.detailNode))return e.detailNode;const t=new zj(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,$H(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},class extends nB{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,n,r,i,o){const s=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some(e=>e.isRowGroupActive());let l={};n&&r&&(l=this.calculateDirtyNodes(r));const c=this.columnModel.isPivotMode(),u=this.gos.getCallback("postSortRows"),d=r=>{this.pullDownGroupDataForHideOpenParents(r.childrenAfterAggFilter,!0);const d=c&&r.leafGroup;if(s&&a&&!r.leafGroup&&!o){const e=this.funcColsService.getRowGroupColumns()?.[r.level+1],t=null===e?.getSort(),n=r.childrenAfterAggFilter.slice(0);if(r.childrenAfterSort&&!t){const e={};r.childrenAfterSort.forEach((t,n)=>{e[t.id]=n}),n.sort((t,n)=>(e[t.id]??0)-(e[n.id]??0))}r.childrenAfterSort=n}else r.childrenAfterSort=!t||d?r.childrenAfterAggFilter.slice(0):n?this.doDeltaSort(r,l,i,e):this.rowNodeSorter.doFullSort(r.childrenAfterAggFilter,e);if(r.sibling&&(r.sibling.childrenAfterSort=r.childrenAfterSort),this.updateChildIndexes(r),u){const e={nodes:r.childrenAfterSort};u(e)}};i&&i.forEachChangedNodeDepthFirst(d),this.updateGroupDataForHideOpenParents(i)}calculateDirtyNodes(e){const t={},n=e=>{e&&e.forEach(e=>t[e.id]=!0)};return e&&e.forEach(e=>{n(e.add),n(e.update),n(e.remove)}),t}doDeltaSort(e,t,n,r){const i=e.childrenAfterAggFilter,o=e.childrenAfterSort;if(!o)return this.rowNodeSorter.doFullSort(i,r);const s={},a=[];i.forEach(e=>{t[e.id]||!n.canSkip(e)?a.push(e):s[e.id]=!0});const l=o.filter(e=>s[e.id]),c=(e,t)=>({currentPos:t,rowNode:e}),u=a.map(c).sort((e,t)=>this.rowNodeSorter.compareRowNodes(r,e,t));return this.mergeSortedArrays(r,u,l.map(c)).map(e=>{let{rowNode:t}=e;return t})}mergeSortedArrays(e,t,n){const r=[];let i=0,o=0;for(;i<t.length&&o<n.length;){this.rowNodeSorter.compareRowNodes(e,t[i],n[o])<0?r.push(t[i++]):r.push(n[o++])}for(;i<t.length;)r.push(t[i++]);for(;o<n.length;)r.push(n[o++]);return r}updateChildIndexes(e){if(UH(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let n=0;n<t.length;n++){const r=t[n],i=0===n,o=n===e.childrenAfterSort.length-1;r.setFirstChild(i),r.setLastChild(o),r.setChildIndex(n)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return NH("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach(e=>{e.hasChildren()&&t(e)})};e&&e.executeFromRootNode(e=>t(e))}pullDownGroupDataForHideOpenParents(e,t){this.gos.get("groupHideOpenParents")&&!UH(e)&&e.forEach(e=>{(this.showRowGroupColsService?.getShowRowGroupCols()??[]).forEach(n=>{const r=n.getColDef().showRowGroup;if("string"!==typeof r)return void LH("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const i=r,o=this.columnModel.getColDefCol(i);if(!(o===e.rowGroupColumn))if(t)e.setGroupValue(n.getId(),void 0);else{const t=this.getFirstChildOfFirstChild(e,o);t&&e.setGroupValue(n.getId(),t.key)}})})}getFirstChildOfFirstChild(e,t){let n=e;for(;n;){const e=n.parent;if(!e||!n.firstChild)return null;if(e.rowGroupColumn===t)return e;n=e}return null}},class extends nB{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){nV(this.gos)&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const e=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const n=this.clientSideRowModel.getNodeManager(),{rowNodeTransaction:r,rowsInserted:i}=n.updateRowData(t);let o=!1;this.gos.get("suppressMaintainUnsortedOrder")||(o=n.updateRowOrderFromRowData(e)),this.clientSideRowModel.afterImmutableDataChange(r,o||i)}createTransactionForRowData(e){if(!nV(this.gos))return LH("ImmutableService only works with ClientSideRowModel"),null;const t=TV(this.gos);if(null==t)return LH("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!"),null;const n=this.clientSideRowModel.getNodeManager().getCopyOfNodesMap(),r=[],i=[],o=[];return $H(e)&&e.forEach(e=>{const r=t({data:e,level:0}),s=n[r];if(s){s.data!==e&&i.push(e),n[r]=void 0}else o.push(e)}),mB(n,(e,t)=>{t&&r.push(t.data)}),{remove:r,update:i,add:o}}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}}]},gq={version:hq,moduleName:"@ag-grid-community/client-side-row-model-api",beans:[oq],apiFunctions:{onGroupExpandedOrCollapsed:function(e){e.expansionService.onGroupExpandedOrCollapsed()},refreshClientSideRowModel:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.refreshModel(t)},isRowDataEmpty:function(e){return e.rowModelHelperService?.getClientSideRowModel()?.isEmpty()??!0},forEachLeafNode:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachLeafNode(t)},forEachNodeAfterFilter:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilter(t)},forEachNodeAfterFilterAndSort:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilterAndSort(t)},resetRowHeights:function(e){e.columnModel.isAutoRowHeightActive()?NH("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height."):e.rowModelHelperService?.getClientSideRowModel()?.resetRowHeights()},applyTransaction:function(e,t){return e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.updateRowData(t))},applyTransactionAsync:function(e,t,n){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.batchUpdateRowData(t,n))},flushAsyncTransactions:function(e){e.frameworkOverrides.wrapIncoming(()=>e.rowModelHelperService?.getClientSideRowModel()?.flushAsyncTransactions())},getBestCostNodeSelection:function(e){return e.selectionService.getBestCostNodeSelection()}},dependantModules:[pq,sq]},fq={version:hq,moduleName:"@ag-grid-community/client-side-row-model",dependantModules:[pq,gq]},mq=class extends nB{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},vq=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:n,columnNameService:r,valueService:i,gos:o,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.funcColsService=n,this.columnNameService=r,this.valueService=i,this.gos=o,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter(e=>!!e.getColDef().showRowGroup)}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,n,r,i){const o=this.gos.get("groupHideOpenParents")&&!i.footer||!this.shouldRenderGroupSummaryCell(i,e,t)?this.valueService.getValue(e,i):this.createValueForGroupNode(e,i);return this.processCell({accumulatedRowIndex:n,rowNode:i,column:e,value:o,processCellCallback:this.processCellCallback,type:r})}shouldRenderGroupSummaryCell(e,t,n){if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){const n=e.groupData?.[t.getId()],r=this.gos.get("suppressGroupMaintainValueType");if(r&&null!=n||!r&&void 0!==n)return!0;if(rV(this.gos)&&e.group)return!0;if(e.footer&&-1===e.level){const e=t.getColDef();return null==e||!0===e.showRowGroup||e.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const r=EV(this.gos,this.columnModel.isPivotMode());return 0===n&&r}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const n=this.gos.get("treeData"),r=this.gos.get("suppressGroupMaintainValueType"),i=t=>{if(n||r)return t.key;const i=t.groupData?.[e.getId()];return i&&t.rowGroupColumn&&!1!==t.rowGroupColumn.getColDef().useValueFormatterForExport?this.valueService.formatValue(t.rowGroupColumn,t,i)??i:i},o=t.footer,s=[i(t)];if(!RV(this.gos))for(;t.parent;)t=t.parent,s.push(i(t));const a=s.reverse().join(" -> ");return o?`Total ${a}`:a}processCell(e){const{accumulatedRowIndex:t,rowNode:n,column:r,value:i,processCellCallback:o,type:s}=e;return o?{value:o(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:r,node:n,value:i,type:s,parseValue:e=>this.valueService.parseValue(r,n,e,this.valueService.getValue(r,n)),formatValue:e=>this.valueService.formatValue(r,n,e)??e}))??""}:!1!==r.getColDef().useValueFormatterForExport?{value:i??"",valueFormatted:this.valueService.formatValue(r,n,i)}:{value:i??""}}},wq=class{static download(e,t){const n=document.defaultView||window;if(!n)return void NH("There is no `window` associated with the current `document`");const r=document.createElement("a"),i=n.URL.createObjectURL(t);r.setAttribute("href",i),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(r),n.setTimeout(()=>{n.URL.revokeObjectURL(i)},0)}},bq=class extends vq{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:n}=e;this.suppressQuotes=t,this.columnSeparator=n}addCustomContent(e){e&&("string"===typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach(e=>{this.beginNewLine(),e.forEach((e,t)=>{0!==t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e.data.value||""),e.mergeAcross&&this.appendEmptyCells(e.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,n,r){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(r)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,n){0!=t&&(this.result+=this.columnSeparator);const r=this.extractRowCellValue(e,t,t,"csv",n);this.result+=this.putInQuotes(r.valueFormatted??r.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null===e||void 0===e)return'""';let t;"string"===typeof e?t=e:"function"===typeof e.toString?t=e.toString():(NH("unknown value type during csv conversion"),t="");return'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}};var Cq="32.3.8",yq={version:Cq,moduleName:"@ag-grid-community/csv-export-core",beans:[class extends mq{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void NH("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),n=this.getData(t),r=new Blob(["\ufeff",n],{type:"text/plain"}),i="function"===typeof t.fileName?t.fileName(this.gos.getGridCommonParams()):t.fileName;wq.download(this.getFileName(i),r)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object.assign({},e):this.getMergedParams(e);return this.getData(t)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:n,funcColsService:r,valueService:i,gos:o}=this,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new bq({columnModel:t,columnNameService:n,funcColsService:r,valueService:i,gos:o,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}},class extends nB{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{allColumns:n,columnKeys:r,skipRowGroups:i}=t,o=this.getColumnsToExport(n,i,r),s=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.reduce((e,t)=>t(e),e)}(this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t));return s(e).parse()}processRow(e,t,n,r){const i=t.shouldRowBeSkipped||(()=>!1),o=this.gos.get("groupRemoveSingleChildren"),s=this.gos.get("groupRemoveLowestSingleChildren"),a=null!=t.rowPositions||!!t.onlySelected,l=this.gos.get("groupHideOpenParents")&&!a,c=this.columnModel.isPivotMode()?r.leafGroup:!r.group,u=!!r.footer,d=s&&r.leafGroup,h=1===r.allChildrenCount&&1===r.childrenAfterGroup?.length&&(o||d);if(!c&&!u&&(t.skipRowGroups||h||l)||t.onlySelected&&!r.isSelected()||t.skipPinnedTop&&"top"===r.rowPinned||t.skipPinnedBottom&&"bottom"===r.rowPinned)return;if(-1===r.level&&!c&&!u)return;if(i(this.gos.addGridCommonParams({node:r})))return;const p=e.onNewBodyRow(r);if(n.forEach((e,t)=>{p.onColumn(e,t,r)}),t.getCustomContentBelowRow){const n=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:r}));n&&e.addCustomContent(n)}}appendContent(e){return t=>{const n=e.appendContent;return n&&t.addCustomContent(n),t}}prependContent(e){return t=>{const n=e.prependContent;return n&&t.addCustomContent(n),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return n=>{if(!e.skipColumnGroupHeaders){const r=new JB,i=this.visibleColsService.createGroups({columns:t,idCreator:r,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(i,n,e.processGroupHeaderCallback)}return n}}exportHeaders(e,t){return n=>{if(!e.skipColumnHeaders){const e=n.onNewHeaderRow();t.forEach((t,n)=>{e.onColumn(t,n,void 0)})}return n}}processPinnedTopRows(e,t){return n=>{const r=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(e=>"top"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedTopRow(e.rowIndex)).forEach(r):this.pinnedRowModel.forEachPinnedRow("top",r),n}}processRows(e,t){return n=>{const r=this.rowModel,i=nV(this.gos),o=rV(this.gos),s=!i&&e.onlySelected,a=this.processRow.bind(this,n,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(e=>null==e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>r.getRow(e.rowIndex)).forEach(a);else if(this.columnModel.isPivotMode())i?r.forEachPivotNode(a,!0):o?r.forEachNodeAfterFilterAndSort(a,!0):r.forEachNode(a);else if(e.onlySelectedAllPages||s){const e=this.selectionService.getSelectedNodes();this.replicateSortedOrder(e),e.forEach(a)}else"all"===l?r.forEachNode(a):i||o?r.forEachNodeAfterFilterAndSort(a,!0):r.forEachNode(a);return n}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),n=(e,r)=>null!=e.rowIndex&&null!=r.rowIndex?e.rowIndex-r.rowIndex:e.level===r.level?e.parent?.id===r.parent?.id?this.rowNodeSorter.compareRowNodes(t,{rowNode:e,currentPos:e.rowIndex??-1},{rowNode:r,currentPos:r.rowIndex??-1}):n(e.parent,r.parent):e.level>r.level?n(e.parent,r):n(e,r.parent);e.sort(n)}processPinnedBottomRows(e,t){return n=>{const r=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter(e=>"bottom"===e.rowPinned).sort((e,t)=>e.rowIndex-t.rowIndex).map(e=>this.pinnedRowModel.getPinnedBottomRow(e.rowIndex)).forEach(r):this.pinnedRowModel.forEachPinnedRow("bottom",r),n}}getColumnsToExport(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=this.columnModel.isPivotMode();if(n&&n.length)return this.columnModel.getColsForKeys(n);const i=this.gos.get("treeData");let o=[];return o=e&&!r?this.columnModel.getCols():this.visibleColsService.getAllCols(),t&&!i&&(o=o.filter(e=>!dB(e)&&!hB(e))),o}recursivelyAddHeaderGroups(e,t,n){const r=[];e.forEach(e=>{const t=e;t.getChildren&&t.getChildren().forEach(e=>r.push(e))}),e.length>0&&XB(e[0])&&this.doAddHeaderHeader(t,e,n),r&&r.length>0&&this.recursivelyAddHeaderGroups(r,t,n)}doAddHeaderHeader(e,t,n){const r=e.onNewHeaderGroupingRow();let i=0;t.forEach(e=>{const t=e;let o;o=n?n(this.gos.addGridCommonParams({columnGroup:t})):this.columnNameService.getDisplayNameForColumnGroup(t,"header");const s=t.getLeafColumns().reduce((e,t,n,r)=>{let i=VV(e);return"open"===t.getColumnGroupShow()?i&&null==i[1]||(i=[n],e.push(i)):i&&null==i[1]&&(i[1]=n-1),n===r.length-1&&i&&null==i[1]&&(i[1]=n),e},[]);r.onColumn(t,o||"",i++,t.getLeafColumns().length-1,s)})}}]},Sq={version:Cq,moduleName:"@ag-grid-community/csv-export",dependantModules:[yq,{version:Cq,moduleName:"@ag-grid-community/csv-export-api",apiFunctions:{getDataAsCsv:function(e,t){return e.csvCreator?.getDataAsCsv(t)},exportDataAsCsv:function(e,t){e.csvCreator?.exportDataAsCsv(t)}},dependantModules:[yq]}]};var xq=async e=>{const t=new Blob([e]),{size:n,content:r}=await(async e=>{let t=0;const n=[],r=new WritableStream({write:e=>{n.push(e),t+=e.length}}),i=new ReadableStream({start:t=>{const n=new FileReader;n.onload=e=>{e.target?.result&&t.enqueue(e.target.result),t.close()},n.readAsArrayBuffer(e)}}),o=new window.CompressionStream("deflate-raw");return await i.pipeThrough(o).pipeTo(r),{size:t,content:new Blob(n)}})(t);return{size:n,content:new Uint8Array(await r.arrayBuffer())}};function Rq(e,t){let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}var Eq=e=>{if(!e.length)return 0;let t=~0,n=0,r=0,i=0;for(let o=0;o<e.length;o++)n=e[o],r=255&(t^n),i=kq[r],t=t>>>8^i;return-1^t},Tq=e=>e.length?Eq("string"===typeof e?(new TextEncoder).encode(e):e):0,kq=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),Mq=(e,t,n,r,i,o)=>{const{content:s,path:a,created:l}=e,c=(e=>{let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t})(l),u=(e=>{let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t})(l),d=Tq(i),h=void 0!==o?o:r,p=GB(a),g=p!==a;let f="";if(g){const e=Rq(1,1)+Rq(Tq(p),4)+p;f="up"+Rq(e.length,2)+e}const m="\x14\0"+(g?"\0\b":"\0\0")+Rq(t?8:0,2)+Rq(c,2)+Rq(u,2)+Rq(h?d:0,4)+Rq(o??r,4)+Rq(r,4)+Rq(p.length,2)+Rq(f.length,2),v="PK\x03\x04"+m+p+f,w="PK\x01\x02\x14\0"+m+"\0\0\0\0\0\0"+(s?"\0\0\0\0":"\x10\0\0\0")+Rq(n,4)+p+f;return{localFileHeader:Uint8Array.from(v,e=>e.charCodeAt(0)),centralDirectoryHeader:Uint8Array.from(w,e=>e.charCodeAt(0))}},Pq=e=>{let t;if("string"===typeof e){const n=atob(e.split(";base64,")[1]);t=Uint8Array.from(n,e=>e.charCodeAt(0))}else t=e;return{size:t.length,content:t}},Iq=async(e,t)=>{const{content:n}=e,{size:r,content:i}=n?Pq(n):{size:0,content:Uint8Array.from([])};let o,s,a=!1;if("file"===e.type&&i&&r>0){const e=await xq(i);o=e.content,s=e.size,a=!0}return{...Mq(e,a,t,r,i,s),content:o||i,isCompressed:a}},Aq=(e,t)=>{const{content:n}=e,{content:r}=n?Pq(n):{content:Uint8Array.from([])};return{...Mq(e,!1,t,r.length,r,void 0),content:r,isCompressed:!1}},Dq=class{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1,type:"folder"})}static addFile(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.files.push({path:e,created:new Date,content:n?t:(new TextEncoder).encode(t),isBase64:n,type:"file"})}static async getZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=await this.buildCompressedFileStream();return this.clearStream(),new Blob([t],{type:e})}static getUncompressedZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=this.buildFileStream();return this.clearStream(),new Blob([t],{type:e})}static clearStream(){this.folders=[],this.files=[]}static packageFiles(e){let t=0,n=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:r,content:i}=c;t+=e.length+i.length,n+=r.length}const r=new Uint8Array(t),i=new Uint8Array(n);let o=0,s=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:t,content:n}=c;r.set(e,o),o+=e.length,r.set(n,o),o+=n.length,i.set(t,s),s+=t.length}const a=((e,t,n)=>{const r="PK\x05\x06\0\0\0\0"+Rq(e,2)+Rq(e,2)+Rq(t,4)+Rq(n,4)+"\0\0";return Uint8Array.from(r,e=>e.charCodeAt(0))})(e.length,n,t),l=new Uint8Array(r.length+i.length+a.length);return l.set(r),l.set(i,r.length),l.set(a,r.length+i.length),l}static async buildCompressedFileStream(){const e=[...this.folders,...this.files],t=[];let n=0;for(const r of e){const e=await Iq(r,n),{localFileHeader:i,content:o}=e;t.push(e),n+=i.length+o.length}return this.packageFiles(t)}static buildFileStream(){const e=[...this.folders,...this.files],t=[];let n=0;for(const r of e){const e=Aq(r,n),{localFileHeader:i,content:o}=e;t.push(e),n+=i.length+o.length}return this.packageFiles(t)}};Dq.folders=[],Dq.files=[];var Fq=class extends nK{wireBeans(e){this.beans=e}constructor(e,t,n){super(e),this.parentCache=t,this.params=n,this.startRow=e*n.blockSize,this.endRow=this.startRow+n.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,n){$H(t)?e.setDataAndId(t,n.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();UH(this.params.datasource.getRows)?NH("datasource is missing getRows method"):window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,n){this.rowNodes.forEach((r,i)=>{this.startRow+i<n&&e(r,t.next())})}getLastAccessed(){return this.lastAccessed}getRow(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.lastAccessed=this.params.lastAccessedSequence.next());const t=e-this.startRow;return this.rowNodes[t]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,n=new zj(this.beans);n.setRowHeight(this.params.rowHeight),n.uiLevel=0,n.setRowIndex(t),n.setRowTop(this.params.rowHeight*t),this.rowNodes.push(n)}}processServerResult(e){this.rowNodes.forEach((t,n)=>{const r=e.rowData?e.rowData[n]:void 0;!t.id&&t.alreadyRendered&&r&&(this.rowNodes[n]=new zj(this.beans),this.rowNodes[n].setRowIndex(t.rowIndex),this.rowNodes[n].setRowTop(t.rowTop),this.rowNodes[n].setRowHeight(t.rowHeight),t.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[n],r,this.startRow+n)});const t=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},Oq=class extends nB{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}wireBeans(e){this.rowRenderer=e.rowRenderer,this.focusService=e.focusService}getRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Math.floor(e/this.params.blockSize);let r=this.blocks[n];if(!r){if(t)return;r=this.createBlock(n)}return r.getRow(e)}createBlock(e){const t=this.createBean(new Fq(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(e=>e.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.gos.get("debug")&&OH(`InfiniteCache - onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(t=>t!=e);t.sort((e,t)=>t.getLastAccessed()-e.getLastAccessed());const n=this.params.maxBlocksInCache>0,r=n?this.params.maxBlocksInCache-1:null;t.forEach((e,t)=>{if("needsLoading"===e.getState()&&t>=1||!!n&&t>=r){if(this.isBlockCurrentlyDisplayed(e))return;if(this.isBlockFocused(e))return;this.removeBlockFromCache(e)}})}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;const n=e.getStartRow(),r=e.getEndRow();return t.rowIndex>=n&&t.rowIndex<r}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),n=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,n)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"===typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const t=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<t&&(this.rowCount=t)}}setRowCount(e,t){this.rowCount=e,$H(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t=new uz;this.getBlocksInOrder().forEach(n=>n.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){return bB(this.blocks).sort((e,t)=>e.getId()-t.getId())}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventService.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach(t=>{t.getId()*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(e=>this.destroyBlock(e))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const n=[];let r=-1,i=!1;const o=new uz;let s=!1;this.getBlocksInOrder().forEach(a=>{s||(i&&r+1!==a.getId()?s=!0:(r=a.getId(),a.forEachNode(r=>{const o=r===e||r===t;(i||o)&&n.push(r),o&&(i=!i)},o,this.rowCount)))});return s||i?[]:n}};var Nq="32.3.8",Lq={version:Nq,moduleName:"@ag-grid-community/infinite-row-model-core",rowModel:"infinite",beans:[class extends nB{constructor(){super(...arguments),this.beanName="rowModel"}wireBeans(e){this.filterManager=e.filterManager,this.sortController=e.sortController,this.selectionService=e.selectionService,this.rowRenderer=e.rowRenderer,this.rowNodeBlockLoader=e.rowNodeBlockLoader}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){"infinite"===this.gos.get("rowModelType")&&(this.rowHeight=cV(this.gos),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&NH("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onCacheUpdated.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=cV(this.gos),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!JH(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;null!=TV(this.gos)||this.selectionService.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventService.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager?.getFilterModel()??{},sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:cV(this.gos),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new uz},this.infiniteCache=this.createBean(new Oq(this.cacheParams)),this.eventService.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){this.dispatchModelUpdatedEvent()}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode(n=>{n.id===e&&(t=n)}),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(0!==this.rowHeight){const t=Math.floor(e/this.rowHeight),n=this.getRowCount()-1;return t>n?n:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}}],dependantModules:[rK]},_q={version:Nq,moduleName:"@ag-grid-community/infinite-row-model",dependantModules:[Lq,{version:Nq,moduleName:"@ag-grid-community/infinite-row-model-api",beans:[oq],apiFunctions:{refreshInfiniteCache:function(e){e.rowModelHelperService?.getInfiniteRowModel()?.refreshCache()},purgeInfiniteCache:function(e){e.rowModelHelperService?.getInfiniteRowModel()?.purgeCache()},getInfiniteRowCount:function(e){return e.rowModelHelperService?.getInfiniteRowModel()?.getRowCount()}},dependantModules:[Lq,aq]}]};(e=>{const t=new Map})(e=>{if(/Color$/.test(e))return"color";if(/Scale?$/.test(e))return"scale";if("spacing"===e||/(Padding|Spacing|Size|Width|Height|Radius|Indent|Start|End|Top|Bottom|Horizontal|Vertical)$/.test(e))return"length";if(/Border$/.test(e))return"border";if(/BorderStyle$/.test(e))return"borderStyle";if(/Shadow$/.test(e))return"shadow";if(/Image$/.test(e))return"image";if(/Family$/.test(e))return"fontFamily";if(/Weight$/.test(e))return"fontWeight";if(/Duration$/.test(e))return"duration";if(/ColorScheme$/.test(e))return"colorScheme";throw new Error(`"${e}" is not a valid theme parameter.`)}),"object"!==typeof window||!window||"object"!==typeof document||(window.document,document);Mj.__registerModules([TY,fq,_q,Sq],!1,void 0);var Hq=t.createContext({}),Vq=(e,t,n,r)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const i=e.newAgStackInstance();if(null==i)return;let o,s,a=!1;return i.then(e=>{a?t.destroyBean(e):(o=e,s=o.getGui(),n.appendChild(s),Bq(r,o))}),()=>{a=!0,o&&(s?.parentElement?.removeChild(s),t.destroyBean(o),r&&Bq(r,void 0))}},Bq=(e,t)=>{if(e)if(e instanceof Function){e(t)}else{e.current=t}},Wq=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>null!=e&&""!==e).join(" ")},zq=class e{constructor(){this.classesMap={};for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(e=>{this.classesMap[e]=!0})}setClass(t,n){if(!!this.classesMap[t]==n)return this;const r=new e;return r.classesMap={...this.classesMap},r.classesMap[t]=n,r}toString(){return Object.keys(this.classesMap).filter(e=>this.classesMap[e]).join(" ")}},jq=e=>"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115),Gq=t.version?.split(".")[0],$q="16"===Gq||"17"===Gq;var Uq=!1;var Kq=(e,t)=>{$q||!e||Uq?t():o.flushSync(t)};function Yq(e,t,n){if(null==t||null==e)return t;if(e===t||0===t.length&&0===e.length)return e;if(n||0===e.length&&t.length>0||e.length>0&&0===t.length)return t;const r=[],i=[],o=new Map,s=new Map;for(let a=0;a<t.length;a++){const e=t[a];s.set(e.instanceId,e)}for(let a=0;a<e.length;a++){const t=e[a];o.set(t.instanceId,t),s.has(t.instanceId)&&r.push(t)}for(let a=0;a<t.length;a++){const e=t[a],n=e.instanceId;o.has(n)||i.push(e)}return r.length===e.length&&0===i.length?e:0===r.length&&i.length===t.length?t:0===r.length?i:0===i.length?r:[...r,...i]}var qq=(0,t.forwardRef)((e,n)=>{const{ctrlsFactory:r,context:i}=(0,t.useContext)(Hq),o=(0,t.useRef)(null),s=(0,t.useRef)(null),a=(0,t.useRef)(null),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(),[d,h]=(0,t.useState)(),[p,g]=(0,t.useState)(),[f,m]=(0,t.useState)(),[v,w]=(0,t.useState)(()=>new zq),[b,C]=(0,t.useState)(()=>new zq("ag-hidden")),[y,S]=(0,t.useState)(()=>new zq("ag-hidden")),[x,R]=(0,t.useState)(()=>new zq("ag-invisible"));(0,t.useImperativeHandle)(n,()=>({refresh:()=>!1})),(0,t.useLayoutEffect)(()=>Vq(d,i,s.current),[d]);const E=(0,t.useCallback)(t=>{if(o.current=t,!t)return void(u.current=i.destroyBean(u.current));const n={setInnerRenderer:(e,t)=>{h(e),m(t)},setChildCount:e=>g(e),addOrRemoveCssClass:(e,t)=>w(n=>n.setClass(e,t)),setContractedDisplayed:e=>S(t=>t.setClass("ag-hidden",!e)),setExpandedDisplayed:e=>C(t=>t.setClass("ag-hidden",!e)),setCheckboxVisible:e=>R(t=>t.setClass("ag-invisible",!e))},s=r.getInstance("groupCellRendererCtrl");s&&(u.current=i.createBean(s),u.current.init(n,t,a.current,l.current,c.current,qq,e))},[]),T=(0,t.useMemo)(()=>`ag-cell-wrapper ${v.toString()}`,[v]),k=(0,t.useMemo)(()=>`ag-group-expanded ${b.toString()}`,[b]),M=(0,t.useMemo)(()=>`ag-group-contracted ${y.toString()}`,[y]),P=(0,t.useMemo)(()=>`ag-group-checkbox ${x.toString()}`,[x]),I=d&&d.componentFromFramework,A=I?d.componentClass:void 0,D=null==d&&null!=f,F=$B(f,!0);return t.createElement("span",{className:T,ref:E,...e.colDef?{}:{role:u.current?.getCellAriaRole()}},t.createElement("span",{className:k,ref:l}),t.createElement("span",{className:M,ref:c}),t.createElement("span",{className:P,ref:a}),t.createElement("span",{className:"ag-group-value",ref:s},D&&t.createElement(t.Fragment,null,F),I&&t.createElement(A,{...d.params})),t.createElement("span",{className:"ag-group-child-count"},p))}),Xq=qq,Qq=(0,t.createContext)({setMethods:()=>{}}),Jq=(0,t.memo)(e=>{const{initialProps:n,addUpdateCallback:r,CustomComponentClass:i,setMethods:o}=e,[{key:s,...a},l]=(0,t.useState)(n);return(0,t.useEffect)(()=>{r(e=>l(e))},[]),t.createElement(Qq.Provider,{value:{setMethods:o}},t.createElement(i,{key:s,...a}))}),Zq=0;function eX(){return"agPortalKey_"+ ++Zq}var tX=class{constructor(e,t,n,r){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=n,this.suppressFallbackMethods=!!r,this.statelessComponent=this.isStateless(this.reactComponent),this.key=eX(),this.portalKey=eX(),this.instanceCreated=this.isStatelessComponent()?rj.resolve(!1):new rj(e=>{this.resolveInstanceCreated=e})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),n=document.createElement(t||"div");return n.classList.add("ag-react-container"),e.reactContainer=n,n}addParentContainerStyleAndClasses(){if(this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&(NH('Since v31.1 "getReactContainerStyle" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle())),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses())){NH('Since v31.1 "getReactContainerClasses" is deprecated. Apply styling directly to ".ag-react-container" if needed.');this.componentInstance.getReactContainerClasses().forEach(e=>this.eParentElement.classList.add(e))}}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return"function"===typeof Symbol&&Symbol.for}isStateless(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&null!=t[e]||this.fallbackMethodAvailable(e)}callMethod(e,t){const n=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!n)return void setTimeout(()=>this.callMethod(e,t));const r=n[e];return r?r.apply(n,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new rj(e=>this.createReactComponent(e))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=e=>{this.componentInstance=e,this.addParentContainerStyleAndClasses(),this.resolveInstanceCreated?.(!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=(0,o.createPortal)(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,n){return(0,t.createElement)(e,n)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const n=this[`${e}Component`];if(!this.suppressFallbackMethods&&n)return n.bind(this)(t)}fallbackMethodAvailable(e){if(this.suppressFallbackMethods)return!1;return!!this[`${e}Component`]}};function nX(e,t,n){e.forEach(e=>{const r=t[e];r&&(n[e]=r)})}var rX=class extends tX{constructor(){super(...arguments),this.awaitUpdateCallback=new rj(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=Jq}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:e=>this.setMethods(e),addUpdateCallback:e=>{this.updateCallback=()=>(e(this.getProps()),new rj(e=>{setTimeout(()=>{e()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,nX(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new rj(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},iX=class extends rX{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},oX=class extends rX{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},sX=class extends rX{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:n,shake:r}=this;return e.label=t,e.icon=n,e.shake=r,e}},aX=class extends rX{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterChangedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1}isFilterActive(){return null!=this.model}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){!1===this.expectingNewMethods&&this.hasBeenActive&&this.providedMethods?.doesFilterPass!==e?.doesFilterPass&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e)}updateModel(e){this.setModel(e).then(()=>this.sourceParams.filterChangedCallback())}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,delete e.valueGetter,e}};function lX(e,t){e.parentFilterInstance(n=>{(n.setModel(t)||rj.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var cX=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=e=>this.updateModel(e)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){nX(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),lX(this.floatingFilterParams,e)}},uX=class extends rX{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),lX(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},dX=class extends rX{refresh(e){this.sourceParams=e,this.refreshProps()}},hX=class extends rX{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},pX=class extends rX{refresh(e){this.sourceParams=e,this.refreshProps()}},gX=class extends rX{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},fX=class extends rX{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function mX(){NH("As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.")}var vX=class{constructor(e,t,n){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=n||1e3}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(t=>t!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,n){this.portals=[...this.portals,e],this.waitForInstance(t,n),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return;window.setTimeout(()=>{this.waitForInstance(e,t,n)})}}},wX=(0,t.memo)(e=>{let{ctrl:n}=e;const r=n.isAlive(),{context:i}=(0,t.useContext)(Hq),o=r?n.getColId():void 0,[s,a]=(0,t.useState)(),l=(0,t.useRef)(),c=(0,t.useRef)(null),u=(0,t.useRef)(null),d=(0,t.useRef)(null),h=(0,t.useRef)(),p=(0,t.useRef)();r&&!p.current&&(p.current=new dW(()=>c.current));const g=(0,t.useCallback)(e=>{if(c.current=e,l.current=e?i.createBean(new cW):i.destroyBean(l.current),!e||!r)return;const t={setWidth:e=>{c.current&&(c.current.style.width=e)},addOrRemoveCssClass:(e,t)=>p.current.addOrRemoveCssClass(e,t),setAriaSort:e=>{c.current&&(e?TW(c.current,e):kW(c.current))},setUserCompDetails:e=>a(e),getUserCompInstance:()=>h.current||void 0};n.setComp(t,e,u.current,d.current,l.current);const o=n.getSelectAllGui();u.current?.insertAdjacentElement("afterend",o),l.current.addDestroyFunc(()=>o.remove())},[]);(0,t.useLayoutEffect)(()=>Vq(s,i,d.current,h),[s]),(0,t.useEffect)(()=>{n.setDragSource(c.current)},[s]);const f=(0,t.useMemo)(()=>!!(s?.componentFromFramework&&jq(s.componentClass)),[s]),m=s&&s.componentFromFramework,v=s&&s.componentClass;return t.createElement("div",{ref:g,className:"ag-header-cell","col-id":o,role:"columnheader"},t.createElement("div",{ref:u,className:"ag-header-cell-resize",role:"presentation"}),t.createElement("div",{ref:d,className:"ag-header-cell-comp-wrapper",role:"presentation"},m&&f&&t.createElement(v,{...s.params}),m&&!f&&t.createElement(v,{...s.params,ref:h})))}),bX=(0,t.memo)(e=>{let{ctrl:n}=e;const{context:r,gos:i}=(0,t.useContext)(Hq),[o,s]=(0,t.useState)(()=>new zq("ag-header-cell","ag-floating-filter")),[a,l]=(0,t.useState)(()=>new zq),[c,u]=(0,t.useState)(()=>new zq("ag-floating-filter-button","ag-hidden")),[d,h]=(0,t.useState)("false"),[p,g]=(0,t.useState)(),[,f]=(0,t.useState)(1),m=(0,t.useRef)(),v=(0,t.useRef)(null),w=(0,t.useRef)(null),b=(0,t.useRef)(null),C=(0,t.useRef)(null),y=(0,t.useRef)(),S=(0,t.useRef)(),x=e=>{null!=e&&y.current&&y.current(e)},R=(0,t.useCallback)(e=>{if(v.current=e,m.current=e?r.createBean(new cW):r.destroyBean(m.current),!e)return;S.current=new rj(e=>{y.current=e});const t={addOrRemoveCssClass:(e,t)=>s(n=>n.setClass(e,t)),addOrRemoveBodyCssClass:(e,t)=>l(n=>n.setClass(e,t)),setButtonWrapperDisplayed:e=>{u(t=>t.setClass("ag-hidden",!e)),h(e?"false":"true")},setWidth:e=>{v.current&&(v.current.style.width=e)},setCompDetails:e=>g(e),getFloatingFilterComp:()=>S.current?S.current:null,setMenuIcon:e=>C.current?.appendChild(e)};n.setComp(t,e,C.current,w.current,m.current)},[]);(0,t.useLayoutEffect)(()=>Vq(p,r,w.current,x),[p]);const E=(0,t.useMemo)(()=>o.toString(),[o]),T=(0,t.useMemo)(()=>a.toString(),[a]),k=(0,t.useMemo)(()=>c.toString(),[c]),M=(0,t.useMemo)(()=>!!(p&&p.componentFromFramework&&jq(p.componentClass)),[p]),P=(0,t.useMemo)(()=>i.get("reactiveCustomComponents"),[]),I=(0,t.useMemo)(()=>{if(p){if(P){const e=new cX(p.params,()=>f(e=>e+1));return x(e),e}p.componentFromFramework&&mX()}},[p]),A=I?.getProps(),D=p&&p.componentFromFramework,F=p&&p.componentClass;return t.createElement("div",{ref:R,className:E,role:"gridcell"},t.createElement("div",{ref:w,className:T,role:"presentation"},D&&!P&&t.createElement(F,{...p.params,ref:M?()=>{}:x}),D&&P&&t.createElement(Qq.Provider,{value:{setMethods:e=>I.setMethods(e)}},t.createElement(F,{...A}))),t.createElement("div",{ref:b,"aria-hidden":d,className:k,role:"presentation"},t.createElement("button",{ref:C,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))}),CX=(0,t.memo)(e=>{let{ctrl:n}=e;const{context:r}=(0,t.useContext)(Hq),[i,o]=(0,t.useState)(()=>new zq),[s,a]=(0,t.useState)(()=>new zq),[l,c]=(0,t.useState)("false"),[u,d]=(0,t.useState)(),[h,p]=(0,t.useState)(),g=(0,t.useMemo)(()=>n.getColId(),[]),f=(0,t.useRef)(),m=(0,t.useRef)(null),v=(0,t.useRef)(null),w=(0,t.useRef)(null),b=(0,t.useRef)(),C=(0,t.useCallback)(e=>{if(m.current=e,f.current=e?r.createBean(new cW):r.destroyBean(f.current),!e)return;const t={setWidth:e=>{m.current&&(m.current.style.width=e)},addOrRemoveCssClass:(e,t)=>o(n=>n.setClass(e,t)),setHeaderWrapperHidden:e=>{const t=w.current;t&&(e?t.style.setProperty("display","none"):t.style.removeProperty("display"))},setHeaderWrapperMaxHeight:e=>{const t=w.current;t&&(null!=e?t.style.setProperty("max-height",`${e}px`):t.style.removeProperty("max-height"),t.classList.toggle("ag-header-cell-comp-wrapper-limited-height",null!=e))},setUserCompDetails:e=>p(e),setResizableDisplayed:e=>{a(t=>t.setClass("ag-hidden",!e)),c(e?"false":"true")},setAriaExpanded:e=>d(e),getUserCompInstance:()=>b.current||void 0};n.setComp(t,e,v.current,w.current,f.current)},[]);(0,t.useLayoutEffect)(()=>Vq(h,r,w.current),[h]),(0,t.useEffect)(()=>{m.current&&n.setDragSource(m.current)},[h]);const y=(0,t.useMemo)(()=>!!(h?.componentFromFramework&&jq(h.componentClass)),[h]),S=(0,t.useMemo)(()=>"ag-header-group-cell "+i.toString(),[i]),x=(0,t.useMemo)(()=>"ag-header-cell-resize "+s.toString(),[s]),R=h&&h.componentFromFramework,E=h&&h.componentClass;return t.createElement("div",{ref:C,className:S,"col-id":g,role:"columnheader","aria-expanded":u},t.createElement("div",{ref:w,className:"ag-header-cell-comp-wrapper",role:"presentation"},R&&y&&t.createElement(E,{...h.params}),R&&!y&&t.createElement(E,{...h.params,ref:b})),t.createElement("div",{ref:v,"aria-hidden":l,className:x}))}),yX=(0,t.memo)(e=>{let{ctrl:n}=e;const{context:r}=(0,t.useContext)(Hq),{topOffset:i,rowHeight:o}=(0,t.useMemo)(()=>n.getTopAndHeight(),[]),s=n.getAriaRowIndex(),a=n.getHeaderRowClass(),[l,c]=(0,t.useState)(()=>o+"px"),[u,d]=(0,t.useState)(()=>i+"px"),h=(0,t.useRef)(null),p=(0,t.useRef)(null),[g,f]=(0,t.useState)(()=>n.getHeaderCtrls()),m=(0,t.useRef)(),v=(0,t.useRef)(null),w=(0,t.useCallback)(e=>{if(v.current=e,m.current=e?r.createBean(new cW):r.destroyBean(m.current),!e)return;const t={setHeight:e=>c(e),setTop:e=>d(e),setHeaderCtrls:(e,t,n)=>{p.current=h.current,h.current=e;const r=Yq(p.current,e,t);r!==p.current&&Kq(n,()=>f(r))},setWidth:e=>{v.current&&(v.current.style.width=e)}};n.setComp(t,m.current,!1)},[]),b=(0,t.useMemo)(()=>({height:l,top:u}),[l,u]),C=(0,t.useCallback)(e=>{switch(n.getType()){case i$.COLUMN_GROUP:return t.createElement(CX,{ctrl:e,key:e.instanceId});case i$.FLOATING_FILTER:return t.createElement(bX,{ctrl:e,key:e.instanceId});default:return t.createElement(wX,{ctrl:e,key:e.instanceId})}},[]);return t.createElement("div",{ref:w,className:a,role:"row",style:b,"aria-rowindex":s},g.map(C))}),SX=(0,t.memo)(e=>{let{pinned:n}=e;const[r,i]=(0,t.useState)(!0),[o,s]=(0,t.useState)([]),{context:a}=(0,t.useContext)(Hq),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(),d="left"===n,h="right"===n,p=!d&&!h,g=(0,t.useCallback)(e=>{if(l.current=e,u.current=e?a.createBean(new R$(n)):a.destroyBean(u.current),!e)return;const t={setDisplayed:i,setCtrls:e=>s(e),setCenterWidth:e=>{c.current&&(c.current.style.width=e)},setViewportScrollLeft:e=>{l.current&&(l.current.scrollLeft=e)},setPinnedContainerWidth:e=>{l.current&&(l.current.style.width=e,l.current.style.minWidth=e,l.current.style.maxWidth=e)}};u.current.setComp(t,l.current)},[]),f=r?"":"ag-hidden",m=()=>o.map(e=>t.createElement(yX,{ctrl:e,key:e.instanceId}));return t.createElement(t.Fragment,null,d&&t.createElement("div",{ref:g,className:"ag-pinned-left-header "+f,"aria-hidden":!r,role:"rowgroup"},m()),h&&t.createElement("div",{ref:g,className:"ag-pinned-right-header "+f,"aria-hidden":!r,role:"rowgroup"},m()),p&&t.createElement("div",{ref:g,className:"ag-header-viewport "+f,role:"presentation"},t.createElement("div",{ref:c,className:"ag-header-container",role:"rowgroup"},m())))}),xX=(0,t.memo)(()=>{const[e,n]=(0,t.useState)(()=>new zq),[r,i]=(0,t.useState)(),{context:o}=(0,t.useContext)(Hq),s=(0,t.useRef)(null),a=(0,t.useRef)(),l=(0,t.useCallback)(e=>{if(s.current=e,a.current=e?o.createBean(new s$):o.destroyBean(a.current),!e)return;const t={addOrRemoveCssClass:(e,t)=>n(n=>n.setClass(e,t)),setHeightAndMinHeight:e=>i(e)};a.current.setComp(t,e,e)},[]),c=(0,t.useMemo)(()=>"ag-header "+e.toString(),[e]),u=(0,t.useMemo)(()=>({height:r,minHeight:r}),[r]);return t.createElement("div",{ref:l,className:c,style:u,role:"presentation"},t.createElement(SX,{pinned:"left"}),t.createElement(SX,{pinned:null}),t.createElement(SX,{pinned:"right"}))}),RX=(e,n)=>{(0,t.useEffect)(()=>{const t=n.current;if(t){const n=t.parentElement;if(n){const r=document.createComment(e);return n.insertBefore(r,t),()=>{n.removeChild(r)}}}},[e])},EX=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new rj(e=>{this.resolveInstanceCreated=e}),this.onValueChange=e=>this.updateValue(e),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){nX(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){this.componentInstance=e,this.resolveInstanceCreated?.(),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},TX=(0,t.memo)(e=>{const[n,r]=(0,t.useState)(),{context:i,popupService:s,localeService:a,gos:l,editService:c}=(0,t.useContext)(Hq);return(e=>{const n=(0,t.useRef)(e),r=(0,t.useRef)(),i=(0,t.useRef)(!1),o=(0,t.useRef)(!1),[,s]=(0,t.useState)(0);i.current&&(o.current=!0),(0,t.useEffect)(()=>(i.current||(r.current=n.current(),i.current=!0),s(e=>e+1),()=>{o.current&&r.current?.()}),[])})(()=>{const{editDetails:t,cellCtrl:n,eParentCell:o}=e,{compDetails:u}=t,d=l.get("stopEditingWhenCellsLoseFocus"),h=i.createBean(c.createPopupEditorWrapper(u.params)),p=h.getGui();if(e.jsChildComp){const t=e.jsChildComp.getGui();t&&p.appendChild(t)}const g={column:n.getColumn(),rowNode:n.getRowNode(),type:"popupCellEditor",eventSource:o,ePopup:p,position:t.popupPosition,keepWithinBounds:!0},f=s.positionPopupByComponent.bind(s,g),m=a.getLocaleTextFunc(),v=s.addPopup({modal:d,eChild:p,closeOnEsc:!0,closedCallback:()=>{n.onPopupEditorClosed()},anchorToElement:o,positionCallback:f,ariaLabel:m("ariaLabelCellEditor","Cell Editor")}),w=v?v.hideFunc:void 0;return r(h),e.jsChildComp?.afterGuiAttached?.(),()=>{w?.(),i.destroyBean(h)}}),t.createElement(t.Fragment,null,n&&e.wrappedContent&&(0,o.createPortal)(e.wrappedContent,n.getGui()))}),kX=(e,n,r,i,o,s)=>{const{context:a}=(0,t.useContext)(Hq),l=(0,t.useCallback)(()=>{const e=o.current;if(!e)return;const t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),a.destroyBean(e),o.current=void 0},[]);(0,t.useEffect)(()=>{const t=null!=e,i=e?.compDetails&&!e.compDetails.componentFromFramework;if(!(t&&i&&!(n&&null==r)))return void l();const a=e.compDetails;if(o.current){const t=o.current,n=!!(null!=t.refresh&&0==e.force)&&t.refresh(a.params);if(!0===n||void 0===n)return;l()}const c=a.newAgStackInstance();null!=c&&c.then(e=>{if(!e)return;const t=e.getGui();if(!t)return;(n?r:s.current).appendChild(t),o.current=e})},[e,n,i]),(0,t.useEffect)(()=>l,[])},MX=(e,n,r)=>{const i=e.compProxy;return t.createElement(t.Fragment,null,i?((e,n,r)=>{const{compProxy:i}=e;r(i);const o=i.getProps(),s=jq(n);return t.createElement(Qq.Provider,{value:{setMethods:e=>i.setMethods(e)}},s?t.createElement(n,{...o}):t.createElement(n,{...o,ref:e=>i.setRef(e)}))})(e,n,r):t.createElement(n,{...e.compDetails.params,ref:r}))},PX=(0,t.memo)(e=>{let{cellCtrl:n,printLayout:r,editingRow:i}=e;const{context:o}=(0,t.useContext)(Hq),{colIdSanitised:s,instanceId:a}=n,l=(0,t.useRef)(),[c,u]=(0,t.useState)(()=>n.isCellRenderer()?void 0:{compDetails:void 0,value:n.getValueToDisplay(),force:!1}),[d,h]=(0,t.useState)(),[p,g]=(0,t.useState)(1),[f,m]=(0,t.useState)(),[v,w]=(0,t.useState)(!1),[b,C]=(0,t.useState)(!1),[y,S]=(0,t.useState)(!1),[x,R]=(0,t.useState)(),E=(0,t.useMemo)(()=>n.isForceWrapper(),[n]),T=(0,t.useMemo)(()=>n.getCellAriaRole(),[n]),k=(0,t.useRef)(null),M=(0,t.useRef)(null),P=(0,t.useRef)(),I=(0,t.useRef)(),A=(0,t.useRef)(),D=(0,t.useRef)([]),F=(0,t.useRef)(),[O,N]=(0,t.useState)(0),L=(0,t.useCallback)(e=>{F.current=e,N(e=>e+1)},[]),_=E||null!=c&&(v||y||b),H=(0,t.useCallback)(e=>{if(I.current=e,e){const t=e.isCancelBeforeStart&&e.isCancelBeforeStart();setTimeout(()=>{t?(n.stopEditing(!0),n.focusCell(!0)):n.cellEditorAttached()})}},[n]),V=(0,t.useRef)();V.current||(V.current=new dW(()=>k.current)),kX(c,_,F.current,O,P,k);const B=(0,t.useRef)();(0,t.useLayoutEffect)(()=>{const e=B.current,t=c;if(B.current=c,null==e||null==e.compDetails||null==t||null==t.compDetails)return;const n=e.compDetails,r=t.compDetails;if(n.componentClass!=r.componentClass)return;if(null==M.current?.refresh)return;1!=M.current.refresh(r.params)&&g(e=>e+1)},[c]),(0,t.useLayoutEffect)(()=>{if(!(d&&!d.compDetails.componentFromFramework))return;const e=d.compDetails,t=!0===d.popup,n=e.newAgStackInstance();return n.then(e=>{if(!e)return;const n=e.getGui();if(H(e),!t){const t=(E?A:k).current;t?.appendChild(n),e.afterGuiAttached&&e.afterGuiAttached()}R(e)}),()=>{n.then(e=>{const t=e.getGui();o.destroyBean(e),H(void 0),R(void 0),t?.parentElement?.removeChild(t)})}},[d]);const W=(0,t.useCallback)(e=>{if(A.current=e,!e)return D.current.forEach(e=>e()),void(D.current=[]);const t=t=>{if(t){const n=t.getGui();e.insertAdjacentElement("afterbegin",n),D.current.push(()=>{o.destroyBean(t),GW(n)})}return t};if(v){t(n.createSelectionCheckbox())}y&&t(n.createDndSource()),b&&t(n.createRowDragComp())},[n,o,y,b,v]),z=(0,t.useCallback)(e=>{if(k.current=e,l.current=e?o.createBean(new cW):o.destroyBean(l.current),!e||!n)return;const t={addOrRemoveCssClass:(e,t)=>V.current.addOrRemoveCssClass(e,t),setUserStyles:e=>m(e),getFocusableElement:()=>k.current,setIncludeSelection:e=>w(e),setIncludeRowDrag:e=>C(e),setIncludeDndSource:e=>S(e),getCellEditor:()=>I.current||null,getCellRenderer:()=>M.current??P.current,getParentOfValue:()=>F.current??A.current??k.current,setRenderDetails:(e,t,n)=>{u(r=>r?.compDetails!==e||r?.value!==t||r?.force!==n?{value:t,compDetails:e,force:n}:r)},setEditDetails:(e,t,n,r)=>{if(e){let i;r?i=new EX(e.params,()=>g(e=>e+1)):e.componentFromFramework&&mX(),h({compDetails:e,popup:t,popupPosition:n,compProxy:i}),t||u(void 0)}else h(e=>{e?.compProxy&&(I.current=void 0)})}},s=A.current||void 0;n.setComp(t,e,s,r,i,l.current)},[]),j=(0,t.useMemo)(()=>!!(c?.compDetails?.componentFromFramework&&jq(c.compDetails.componentClass)),[c]);(0,t.useLayoutEffect)(()=>{k.current&&(V.current.addOrRemoveCssClass("ag-cell-value",!_),V.current.addOrRemoveCssClass("ag-cell-inline-editing",!!d&&!d.popup),V.current.addOrRemoveCssClass("ag-cell-popup-editing",!!d&&!!d.popup),V.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!d||!!d.popup),n.getRowCtrl()?.setInlineEditingCss(),n.shouldRestoreFocus()&&!n.isEditing()&&k.current.focus({preventScroll:!0}))});const G=()=>t.createElement(t.Fragment,null,null!=c&&((e,n,r,i,o,s,a)=>{const{compDetails:l,value:c}=e,u=!l,d=l&&l.componentFromFramework,h=l&&l.componentClass,p=c?.toString?c.toString():c,g=()=>t.createElement(t.Fragment,null,u&&t.createElement(t.Fragment,null,p),d&&!s&&t.createElement(h,{...l.params,key:n,ref:i}),d&&s&&t.createElement(h,{...l.params,key:n}));return t.createElement(t.Fragment,null,o?t.createElement("span",{role:"presentation",id:`cell-${r}`,className:"ag-cell-value",ref:a},g()):g())})(c,p,a,M,_,j,L),null!=d&&((e,n,r,i,o)=>{const s=e.compDetails,a=s.componentClass,l=s.componentFromFramework&&!e.popup,c=s.componentFromFramework&&e.popup,u=!s.componentFromFramework&&e.popup;return t.createElement(t.Fragment,null,l&&MX(e,a,n),c&&t.createElement(TX,{editDetails:e,cellCtrl:i,eParentCell:r,wrappedContent:MX(e,a,n)}),u&&o&&t.createElement(TX,{editDetails:e,cellCtrl:i,eParentCell:r,jsChildComp:o}))})(d,H,k.current,n,x)),$=(0,t.useCallback)(()=>n.onFocusOut(),[]);return t.createElement("div",{ref:z,style:f,role:T,"col-id":s,onBlur:$},_?t.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:W},G()):G())}),IX=(0,t.memo)(e=>{let{rowCtrl:n,containerType:r}=e;const{context:i,gos:o}=(0,t.useContext)(Hq),s=(0,t.useRef)(),a=(0,t.useRef)(n.getDomOrder()),l=n.isFullWidth(),c=n.getRowNode().displayed,[u,d]=(0,t.useState)(()=>c?n.getRowIndex():null),[h,p]=(0,t.useState)(()=>n.getRowId()),[g,f]=(0,t.useState)(()=>n.getBusinessKey()),[m,v]=(0,t.useState)(()=>n.getRowStyles()),w=(0,t.useRef)(null),b=(0,t.useRef)(null),[C,y]=(0,t.useState)(()=>null),[S,x]=(0,t.useState)(),[R,E]=(0,t.useState)(()=>c?n.getInitialRowTop(r):void 0),[T,k]=(0,t.useState)(()=>c?n.getInitialTransform(r):void 0),M=(0,t.useRef)(null),P=(0,t.useRef)(),I=(0,t.useRef)(!1),[A,D]=(0,t.useState)(0);(0,t.useEffect)(()=>{if(I.current||!S||A>10)return;const e=M.current?.firstChild;e?(n.setupDetailRowAutoHeight(e),I.current=!0):D(e=>e+1)},[S,A]);const F=(0,t.useRef)();F.current||(F.current=new dW(()=>M.current));const O=(0,t.useCallback)(e=>{if(M.current=e,s.current=e?i.createBean(new cW):i.destroyBean(s.current),!e)return void n.unsetComp(r);if(!n.isAlive())return;const t={setTop:E,setTransform:k,addOrRemoveCssClass:(e,t)=>F.current.addOrRemoveCssClass(e,t),setDomOrder:e=>a.current=e,setRowIndex:d,setRowId:p,setRowBusinessKey:f,setUserStyles:v,setCellCtrls:(e,t)=>{b.current=w.current;const n=Yq(b.current,e,a.current);n!==b.current&&(w.current=n,Kq(t,()=>y(n)))},showFullWidth:e=>x(e),getFullWidthCellRenderer:()=>P.current,refreshFullWidth:e=>V.current?(x(t=>({...t,params:e()})),!0):!(!P.current||!P.current.refresh)&&P.current.refresh(e())};n.setComp(t,e,r,s.current)},[]);(0,t.useLayoutEffect)(()=>Vq(S,i,M.current,P),[S]);const N=(0,t.useMemo)(()=>{const e={top:R,transform:T};return Object.assign(e,m),e},[R,T,m]),L=l&&S?.componentFromFramework,_=!l&&null!=C,H=(0,t.useMemo)(()=>!!(S?.componentFromFramework&&jq(S.componentClass)),[S]),V=(0,t.useRef)(!1);(0,t.useEffect)(()=>{V.current=H&&!!S&&!!o.get("reactiveCustomComponents")},[H,S]);return t.createElement("div",{ref:O,role:"row",style:N,"row-index":u,"row-id":h,"row-business-key":g},_&&C?.map(e=>t.createElement(PX,{cellCtrl:e,editingRow:n.isEditing(),printLayout:n.isPrintLayout(),key:e.instanceId})),L&&(()=>{const e=S.componentClass;return t.createElement(t.Fragment,null,H?t.createElement(e,{...S.params}):t.createElement(e,{...S.params,ref:P}))})())}),AX=(0,t.memo)(e=>{let{name:n}=e;const{context:r}=(0,t.useContext)(Hq),i=(0,t.useMemo)(()=>iU(n),[n]),o=(0,t.useRef)(null),s=(0,t.useRef)(null),a=(0,t.useRef)([]),l=(0,t.useRef)([]),[c,u]=(0,t.useState)(()=>[]),d=(0,t.useRef)(!1),h=(0,t.useRef)(),p=(0,t.useMemo)(()=>Wq(i.viewport),[i]),g=(0,t.useMemo)(()=>Wq(i.container),[i]),f="center"===i.type;RX(" AG Row Container "+n+" ",f?o:s);const m=(0,t.useCallback)(()=>f?null!=o.current&&null!=s.current:null!=s.current,[]),v=(0,t.useCallback)(()=>f?null==o.current&&null==s.current:null==s.current,[]),w=(0,t.useCallback)(()=>{if(v()&&(h.current=r.destroyBean(h.current)),m()){const e=e=>{const t=Yq(l.current,a.current,d.current);t!==l.current&&(l.current=t,Kq(e,()=>u(t)))},t={setHorizontalScroll:e=>{o.current&&(o.current.scrollLeft=e)},setViewportHeight:e=>{o.current&&(o.current.style.height=e)},setRowCtrls:t=>{let{rowCtrls:n,useFlushSync:r}=t;const i=!!r&&a.current.length>0&&n.length>0;a.current=n,e(i)},setDomOrder:t=>{d.current!=t&&(d.current=t,e(!1))},setContainerWidth:e=>{s.current&&(s.current.style.width=e)},setOffsetTop:e=>{s.current&&(s.current.style.transform=`translateY(${e})`)}};h.current=r.createBean(new pU(n)),h.current.setComp(t,s.current,o.current)}},[m,v]),b=(0,t.useCallback)(e=>{s.current=e,w()},[w]),C=(0,t.useCallback)(e=>{o.current=e,w()},[w]),y=()=>t.createElement("div",{className:g,ref:b,role:"rowgroup"},c.map(e=>t.createElement(IX,{rowCtrl:e,containerType:i.type,key:e.instanceId})));return t.createElement(t.Fragment,null,f?t.createElement("div",{className:p,ref:C,role:"presentation"},y()):y())}),DX=(0,t.memo)(()=>{const{context:e,resizeObserverService:n}=(0,t.useContext)(Hq),[r,i]=(0,t.useState)(""),[o,s]=(0,t.useState)(0),[a,l]=(0,t.useState)(0),[c,u]=(0,t.useState)("0px"),[d,h]=(0,t.useState)("0px"),[p,g]=(0,t.useState)("100%"),[f,m]=(0,t.useState)("0px"),[v,w]=(0,t.useState)("0px"),[b,C]=(0,t.useState)("100%"),[y,S]=(0,t.useState)(""),[x,R]=(0,t.useState)(""),[E,T]=(0,t.useState)(null),[k,M]=(0,t.useState)(""),[P,I]=(0,t.useState)(null),[A,D]=(0,t.useState)("ag-layout-normal"),F=(0,t.useRef)();F.current||(F.current=new dW(()=>O.current));const O=(0,t.useRef)(null),N=(0,t.useRef)(null),L=(0,t.useRef)(null),_=(0,t.useRef)(null),H=(0,t.useRef)(null),V=(0,t.useRef)(null),B=(0,t.useRef)(null),W=(0,t.useRef)([]),z=(0,t.useRef)([]);RX(" AG Grid Body ",O),RX(" AG Pinned Top ",N),RX(" AG Sticky Top ",L),RX(" AG Middle ",V),RX(" AG Pinned Bottom ",B);const j=(0,t.useCallback)(t=>{if(O.current=t,!t)return W.current=e.destroyBeans(W.current),z.current.forEach(e=>e()),void(z.current=[]);if(!e)return;const r=(e,t)=>{e.appendChild(t),z.current.push(()=>e.removeChild(t))},o=(t,n,i)=>{r(t,document.createComment(i)),r(t,(t=>{const n=e.createBean(new t);return W.current.push(n),n})(n).getGui())};o(t,M$," AG Fake Horizontal Scroll "),o(t,T$," AG Overlay Wrapper "),H.current&&o(H.current,I$," AG Fake Vertical Scroll ");const a={setRowAnimationCssOnBodyViewport:i,setColumnCount:e=>{O.current&&RW(O.current,e)},setRowCount:e=>{O.current&&SW(O.current,e)},setTopHeight:s,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:h,setStickyTopWidth:g,setTopDisplay:S,setBottomDisplay:R,setColumnMovingCss:(e,t)=>F.current.addOrRemoveCssClass(e,t),updateLayoutClasses:D,setAlwaysVerticalScrollClass:T,setPinnedTopBottomOverflowY:M,setCellSelectableCss:(e,t)=>I(t?e:null),setBodyViewportWidth:e=>{V.current&&(V.current.style.width=e)},registerBodyViewportResizeListener:e=>{if(V.current){const t=n.observeResize(V.current,e);z.current.push(()=>t())}},setStickyBottomHeight:m,setStickyBottomBottom:w,setStickyBottomWidth:C},c=e.createBean(new fU);W.current.push(c),c.setComp(a,t,V.current,N.current,B.current,L.current,_.current)},[]),G=(0,t.useMemo)(()=>Wq("ag-root","ag-unselectable",A),[A]),$=(0,t.useMemo)(()=>Wq("ag-body-viewport",r,A,E,P),[r,A,E,P]),U=(0,t.useMemo)(()=>Wq("ag-body",A),[A]),K=(0,t.useMemo)(()=>Wq("ag-floating-top",P),[P]),Y=(0,t.useMemo)(()=>Wq("ag-sticky-top",P),[P]),q=(0,t.useMemo)(()=>Wq("ag-sticky-bottom","0px"===f?"ag-hidden":null,P),[P,f]),X=(0,t.useMemo)(()=>Wq("ag-floating-bottom",P),[P]),Q=(0,t.useMemo)(()=>({height:o,minHeight:o,display:y,overflowY:k}),[o,y,k]),J=(0,t.useMemo)(()=>({height:c,top:d,width:p}),[c,d,p]),Z=(0,t.useMemo)(()=>({height:f,bottom:v,width:b}),[f,v,b]),ee=(0,t.useMemo)(()=>({height:a,minHeight:a,display:x,overflowY:k}),[a,x,k]),te=e=>t.createElement(AX,{name:e,key:`${e}-container`}),ne=e=>{let{section:n,children:r,className:i,style:o}=e;return t.createElement("div",{ref:n,className:i,role:"presentation",style:o},r.map(te))};return t.createElement("div",{ref:j,className:G,role:"treegrid"},t.createElement(xX,null),ne({section:N,className:K,style:Q,children:["topLeft","topCenter","topRight","topFullWidth"]}),t.createElement("div",{className:U,ref:H,role:"presentation"},ne({section:V,className:$,children:["left","center","right","fullWidth"]})),ne({section:L,className:Y,style:J,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),ne({section:_,className:q,style:Z,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),ne({section:B,className:X,style:ee,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))}),FX=(0,t.forwardRef)((e,n)=>{const{children:r,eFocusableElement:i,onTabKeyDown:o,gridCtrl:s,forceFocusOutWhenTabGuardsAreEmpty:a}=e,{context:l}=(0,t.useContext)(Hq),c=(0,t.useRef)(null),u=(0,t.useRef)(null),d=(0,t.useRef)(),h=e=>{const t=null==e?void 0:parseInt(e,10).toString();[c,u].forEach(e=>{void 0===t?e.current?.removeAttribute("tabindex"):e.current?.setAttribute("tabindex",t)})};(0,t.useImperativeHandle)(n,()=>({forceFocusOutOfContainer(e){d.current?.forceFocusOutOfContainer(e)}}));const p=(0,t.useCallback)(()=>{const e=c.current,t=u.current;if(e||t){if(e&&t){const n={setTabIndex:h};d.current=l.createBean(new aK({comp:n,eTopGuard:e,eBottomGuard:t,eFocusableElement:i,onTabKeyDown:o,forceFocusOutWhenTabGuardsAreEmpty:a,focusInnerElement:e=>s.focusInnerElement(e)}))}}else d.current=l.destroyBean(d.current)},[]),g=(0,t.useCallback)(e=>{c.current=e,p()},[p]),f=(0,t.useCallback)(e=>{u.current=e,p()},[p]),m=e=>{const n="top"===e?sK.TAB_GUARD_TOP:sK.TAB_GUARD_BOTTOM;return t.createElement("div",{className:`${sK.TAB_GUARD} ${n}`,role:"presentation",ref:"top"===e?g:f})};return t.createElement(t.Fragment,null,m("top"),r,m("bottom"))}),OX=(0,t.memo)(FX),NX=(0,t.memo)(e=>{let{context:n}=e;const[r,i]=(0,t.useState)(""),[o,s]=(0,t.useState)(""),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(null),[d,h]=(0,t.useState)(null),[p,g]=(0,t.useState)(!1),[f,m]=(0,t.useState)(),v=(0,t.useRef)(),w=(0,t.useRef)(null),b=(0,t.useRef)(),[C,y]=(0,t.useState)(null),S=(0,t.useRef)(()=>{}),x=(0,t.useRef)(),R=(0,t.useRef)([]),E=(0,t.useCallback)(()=>{},[]),T=(0,t.useMemo)(()=>n.isDestroyed()?null:n.getBeans(),[n]);RX(" AG Grid ",w);const k=(0,t.useCallback)(e=>{if(w.current=e,v.current=e?n.createBean(new KK):n.destroyBean(v.current),!e||n.isDestroyed())return;const t=v.current;S.current=t.focusInnerElement.bind(t);const r={destroyGridUi:()=>{},setRtlClass:i,setGridThemeClass:s,forceFocusOutOfContainer:e=>{e||!x.current?.isDisplayed()?b.current?.forceFocusOutOfContainer(e):x.current.forceFocusOutOfContainer(e)},updateLayoutClasses:l,getFocusableContainers:()=>{const e=[],t=w.current?.querySelector(".ag-root");return t&&e.push({getGui:()=>t}),R.current.forEach(t=>{t.isDisplayed()&&e.push(t)}),e},setCursor:u,setUserSelect:h};t.setComp(r,e,e),g(!0)},[]);(0,t.useEffect)(()=>{const e=v.current,t=w.current;if(!f||!T||!e||!C||!t)return;const r=[],{watermarkSelector:i,paginationSelector:o,sideBarSelector:s,statusBarSelector:a,gridHeaderDropZonesSelector:l}=e.getOptionalSelectors(),c=[];if(l){const e=n.createBean(new l.component),i=e.getGui();t.insertAdjacentElement("afterbegin",i),c.push(i),r.push(e)}if(s){const e=n.createBean(new s.component),t=e.getGui(),i=C.querySelector(".ag-tab-guard-bottom");i&&(i.insertAdjacentElement("beforebegin",t),c.push(t)),r.push(e),R.current.push(e)}const u=e=>{const i=n.createBean(new e),o=i.getGui();return t.insertAdjacentElement("beforeend",o),c.push(o),r.push(i),i};if(a&&u(a.component),o){const e=u(o.component);x.current=e,R.current.push(e)}return i&&u(i.component),()=>{n.destroyBeans(r),c.forEach(e=>{e.parentElement?.removeChild(e)})}},[f,C,T]);const M=(0,t.useMemo)(()=>Wq("ag-root-wrapper",r,o,a),[r,o,a]),P=(0,t.useMemo)(()=>Wq("ag-root-wrapper-body","ag-focus-managed",a),[a]),I=(0,t.useMemo)(()=>({userSelect:null!=d?d:"",WebkitUserSelect:null!=d?d:"",cursor:null!=c?c:""}),[d,c]),A=(0,t.useCallback)(e=>{b.current=e,m(null!==e)},[]);return t.createElement("div",{ref:k,className:M,style:I,role:"presentation"},t.createElement("div",{className:P,ref:y,role:"presentation"},p&&C&&T&&t.createElement(Hq.Provider,{value:T},t.createElement(OX,{ref:A,eFocusableElement:C,onTabKeyDown:E,gridCtrl:v.current,forceFocusOutWhenTabGuardsAreEmpty:!0},t.createElement(DX,null)))))}),LX=class extends nB{wireBeans(e){this.ctrlsService=e.ctrlsService}areHeaderCellsRendered(){return this.ctrlsService.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(e=>e.areCellsRendered()))}},_X=e=>{const n=(0,t.useRef)(),r=(0,t.useRef)(null),i=(0,t.useRef)(null),o=(0,t.useRef)([]),s=(0,t.useRef)([]),a=(0,t.useRef)(e),l=(0,t.useRef)(),c=(0,t.useRef)(),u=(0,t.useRef)(!1),[d,h]=(0,t.useState)(void 0),[,p]=(0,t.useState)(0),g=(0,t.useCallback)(t=>{if(r.current=t,!t)return o.current.forEach(e=>e()),void(o.current.length=0);const a=e.modules||[];i.current||(i.current=new vX(()=>p(e=>e+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),o.current.push(()=>{i.current?.destroy(),i.current=null}));const d=function(e,t){"object"!==typeof e&&(e={});const n={...e};return lW.ALL_PROPERTIES_AND_CALLBACKS.forEach(e=>{const r=t[e];"undefined"!==typeof r&&r!==lW.VUE_OMITTED_PROPERTY&&(n[e]=r)}),n}(e.gridOptions,e),g=new BX(()=>{if(u.current){const e=()=>l.current?.shouldQueueUpdates()?void 0:s.current.shift();let t=e();for(;t;)t(),t=e()}});l.current=g;const f=new LX,m={providedBeanInstances:{frameworkComponentWrapper:new HX(i.current,d.reactiveCustomComponents??(v="reactiveCustomComponents",nq.gridOptions?.[v])??!0),renderStatusService:f},modules:a,frameworkOverrides:g};var v;const w=new iq;d.gridId??(d.gridId=c.current),n.current=w.create(t,d,t=>{h(t),t.createBean(f),o.current.push(()=>{t.destroy()}),t.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{o.current.push(e)}},()=>{if(t.isDestroyed())return;const r=n.current;r&&e.setGridApi?.(r)})},e=>{e.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{o.current.push(e)}},()=>{s.current.forEach(e=>e()),s.current.length=0,u.current=!0})},m),o.current.push(()=>{n.current=void 0}),n.current&&(c.current=n.current.getGridId())},[]),f=(0,t.useMemo)(()=>({height:"100%",...e.containerStyle||{}}),[e.containerStyle]),m=(0,t.useCallback)(e=>{u.current&&!l.current?.shouldQueueUpdates()?e():s.current.push(e)},[]);return(0,t.useEffect)(()=>{const t=function(e,t){const n={};return Object.keys(t).forEach(r=>{const i=t[r];e[r]!==i&&(n[r]=i)}),n}(a.current,e);a.current=e,m(()=>{n.current&&function(e,t){if(!e)return;const n={};let r=!1;if(Object.keys(e).filter(e=>lW.ALL_PROPERTIES_AND_CALLBACKS_SET.has(e)).forEach(t=>{n[t]=e[t],r=!0}),!r)return;const i={type:"gridOptionsChanged",options:n};t.dispatchEvent(i);const o={type:"componentStateChanged"};mB(n,(e,t)=>{o[e]=t}),t.dispatchEvent(o)}(t,n.current)})},[e]),t.createElement("div",{style:f,className:e.className,ref:g},d&&!d.isDestroyed()?t.createElement(NX,{context:d}):null,i.current?.getPortals()??null)};var HX=class extends lq{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const n=(e=>{switch(e){case"filter":return aX;case"floatingFilterComponent":return uX;case"dateComponent":return oX;case"dragAndDropImageComponent":return sX;case"loadingOverlayComponent":return dX;case"noRowsOverlayComponent":return pX;case"statusPanel":return gX;case"toolPanel":return fX;case"menuItem":return hX;case"cellRenderer":return iX}})(t.propertyName);if(n)return new n(e,this.parent,t)}else switch(t.propertyName){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":mX()}const n=!t.cellRenderer&&"toolPanel"!==t.propertyName;return new tX(e,this.parent,t,n)}},VX=(0,t.forwardRef)((e,n)=>{const{ctrlsFactory:r,context:i,gos:o,resizeObserverService:s,rowModel:a}=(0,t.useContext)(Hq),[l,c]=(0,t.useState)(()=>new zq),[u,d]=(0,t.useState)(()=>new zq),[h,p]=(0,t.useState)(),[g,f]=(0,t.useState)(),m=(0,t.useRef)(),v=(0,t.useRef)(null),w=(0,t.useRef)(),b=(0,t.useMemo)(()=>Mj.__getGridRegisteredModules(e.api.getGridId()),[e]),C=(0,t.useMemo)(()=>l.toString()+" ag-details-row",[l]),y=(0,t.useMemo)(()=>u.toString()+" ag-details-grid",[u]);n&&(0,t.useImperativeHandle)(n,()=>({refresh:()=>m.current?.refresh()??!1})),e.template&&NH("detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/");const S=(0,t.useCallback)(t=>{if(v.current=t,!t)return m.current=i.destroyBean(m.current),void w.current?.();const n={addOrRemoveCssClass:(e,t)=>c(n=>n.setClass(e,t)),addOrRemoveDetailGridCssClass:(e,t)=>d(n=>n.setClass(e,t)),setDetailGrid:e=>p(e),setRowData:e=>f(e),getGui:()=>v.current},l=r.getInstance("detailCellRenderer");if(l&&(i.createBean(l),l.init(n,e),m.current=l,o.get("detailRowAutoHeight"))){const n=()=>{if(null==v.current)return;const t=v.current.clientHeight;if(null!=t&&t>0){setTimeout(()=>{e.node.setRowHeight(t),(nV(o)||rV(o))&&a.onRowHeightChanged()},0)}};w.current=s.observeResize(t,n),n()}},[]),x=(0,t.useCallback)(e=>{m.current?.registerDetailWithMaster(e)},[]);return t.createElement("div",{className:C,ref:S},h&&t.createElement(_X,{className:y,...h,modules:b,rowData:g,setGridApi:x}))}),BX=class extends pK{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.frameworkComponents={agGroupCellRenderer:Xq,agGroupRowRenderer:Xq,agDetailCellRenderer:VX},this.wrapIncoming=(e,t)=>"ensureVisible"===t?function(e){return Uq||setTimeout(()=>Uq=!1,0),Uq=!0,e()}(e):e(),this.renderingEngine="react"}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return"19"===Gq}},WX=class extends t.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e,this.apiListeners.forEach(t=>t(e))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return t.createElement(_X,{...this.props,setGridApi:this.setGridApi})}};const zX=e=>{let{data:n,onDataChange:r}=e;const i=(0,t.useRef)(null),[o,s]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),c=(0,t.useMemo)(()=>{if(!n||0===n.length){const e=5,t=5,n=[];for(let r=0;r<e;r++){const e={};for(let n=0;n<t;n++)e[n.toString()]="";n.push(e)}return n}return n},[n]),u=(0,t.useMemo)(()=>{if(!c||0===c.length)return[];const e=new Set;return c.forEach(t=>{Object.keys(t).forEach(t=>e.add(t))}),Array.from(e).sort((e,t)=>parseInt(e)-parseInt(t)).map(e=>({field:e,headerName:`Column ${e}`,editable:!0,sortable:!0,filter:!0,resizable:!0,minWidth:100,flex:1}))},[c]),d=(0,t.useCallback)(e=>e.trim().split("\n").map(e=>e.split("\t")),[]),h=(0,t.useCallback)(async()=>{if(o)try{const n=await navigator.clipboard.readText(),i=d(n);if(0===i.length)return;const s=o.getCellRanges();if(s&&0!==s.length){var e,t;const n=s[0],o=(null===(e=n.startRow)||void 0===e?void 0:e.rowIndex)||0,a=(null===(t=n.startColumn)||void 0===t?void 0:t.getColId())||"0",l=u.findIndex(e=>e.field===a),d=l>=0?l:0,h=[...c];i.forEach((e,t)=>{if(o+t>=h.length){const e={};u.forEach((t,n)=>{e[t.field]=""}),h.push(e)}e.forEach((e,n)=>{const r=u[d+n],i=r?r.field:void 0,s=h[o+t];"string"===typeof i&&s&&"object"===typeof s&&(s[i]=e)})}),r(h)}else{const e=0,t=0,n=[...c];i.forEach((r,i)=>{if(e+i>=n.length){const e={};u.forEach((t,n)=>{e[t.field]=""}),n.push(e)}r.forEach((r,o)=>{const s=u[t+o],a=s?s.field:void 0,l=n[e+i];"string"===typeof a&&l&&"object"===typeof l&&(l[a]=r)})}),r(n)}}catch(Wn){console.error("Error pasting data:",Wn)}},[o,c,u,d,r]);(0,t.useEffect)(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"v"===e.key&&(e.preventDefault(),h())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h]);const p=(0,t.useCallback)(e=>{console.log("AG Grid Ready Event:",e),s(e.api),l(!0),setTimeout(()=>{e.api.sizeColumnsToFit()},100)},[]),g=(0,t.useCallback)(e=>{if(console.log("Cell value changed:",e),o){const e=o.getRenderedNodes().map(e=>e.data);r(e)}},[o,r]);(0,t.useEffect)(()=>{o&&a&&n.length>0&&setTimeout(()=>{o.sizeColumnsToFit()},100)},[n,o,a]);const f=(0,t.useMemo)(()=>({sortable:!0,filter:!0,resizable:!0,editable:!0,minWidth:100}),[]),m=(0,t.useCallback)(()=>{const e={};n.length>0?Object.keys(n[0]).forEach(t=>{e[t]=""}):e[0]="",r([...n,e])},[n,r]),v=(0,t.useCallback)(()=>{const e=Math.max(...n.flatMap(e=>Object.keys(e).map(e=>parseInt(e))),-1)+1,t=n.map(t=>({...t,[e]:""}));r(t)},[n,r]);return(0,MH.jsxs)("div",{className:"ag-grid-spreadsheet-container",children:[(0,MH.jsxs)("div",{className:"ag-grid-header",children:[(0,MH.jsxs)("div",{className:"ag-grid-header-left",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcca AG Grid Spreadsheet"}),(0,MH.jsxs)("div",{className:"ag-grid-features",children:[(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udd04 Real-time Editing"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udd0d Advanced Filtering"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udcc8 Sorting & Grouping"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udcf1 Responsive"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udccb Paste Data (Ctrl+V)"})]})]}),(0,MH.jsxs)("div",{className:"ag-grid-controls",children:[(0,MH.jsx)("button",{className:"control-btn add-row-btn",onClick:m,children:"\u2795 Add Row"}),(0,MH.jsx)("button",{className:"control-btn add-column-btn",onClick:v,children:"\u2795 Add Column"}),(0,MH.jsx)("button",{className:"control-btn paste-btn",onClick:h,title:"Paste data from clipboard (Ctrl+V)",children:"\ud83d\udccb Paste Data"})]})]}),(0,MH.jsx)("div",{className:"ag-grid-wrapper",children:(0,MH.jsx)("div",{className:"ag-theme-alpine",style:{height:"500px",width:"100%"},children:(0,MH.jsx)(WX,{ref:i,rowData:c,columnDefs:u,defaultColDef:f,onGridReady:p,onCellValueChanged:g,animateRows:!0,enableRangeSelection:!0,enableFillHandle:!0,suppressRowClickSelection:!0,suppressCellFocus:!1,suppressRowDeselection:!0,rowSelection:"multiple",pagination:!1})})}),(0,MH.jsxs)("div",{className:"ag-grid-info",children:[(0,MH.jsx)("h4",{children:"\ud83c\udfaf AG Grid Features"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Enterprise Performance:"})," Optimized for large datasets"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Advanced Filtering:"})," Built-in filter components"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Column Management:"})," Resize, reorder, and hide columns"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Selection:"})," Row and cell selection with keyboard navigation"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Customization:"})," Extensive theming and styling options"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Paste Support:"})," Paste tabular data from Excel or other sources (Ctrl+V)"]})]})]}),(0,MH.jsxs)("div",{style:{padding:"10px",background:"#f0f0f0",marginTop:"10px"},children:[(0,MH.jsx)("p",{children:(0,MH.jsx)("strong",{children:"Debug Info:"})}),(0,MH.jsxs)("p",{children:["Row Data Count: ",c.length]}),(0,MH.jsxs)("p",{children:["Column Defs Count: ",u.length]}),(0,MH.jsxs)("p",{children:["Grid API: ",o?"Ready":"Not Ready"]}),(0,MH.jsxs)("p",{children:["Grid Ready: ",a?"Yes":"No"]}),(0,MH.jsxs)("p",{children:["Grid Ref: ",i.current?"Exists":"Null"]}),(0,MH.jsx)("p",{children:"Component Rendered: Yes"}),(0,MH.jsx)("p",{children:"Paste Functionality: \u2705 Active (Ctrl+V)"})]})]})};function jX(e,t){return"function"===typeof e?e(t):e}function GX(e,t){return n=>{t.setState(t=>({...t,[e]:jX(n,t[e])}))}}function $X(e){return e instanceof Function}function UX(e,t){const n=[],r=e=>{e.forEach(e=>{n.push(e);const i=t(e);null!=i&&i.length&&r(i)})};return r(e),n}function KX(e,t,n){let r,i=[];return o=>{let s;n.key&&n.debug&&(s=Date.now());const a=e(o),l=a.length!==i.length||a.some((e,t)=>i[t]!==e);if(!l)return r;let c;if(i=a,n.key&&n.debug&&(c=Date.now()),r=t(...a),null==n||null==n.onChange||n.onChange(r),n.key&&n.debug&&null!=n&&n.debug()){const e=Math.round(100*(Date.now()-s))/100,t=Math.round(100*(Date.now()-c))/100,r=t/16,i=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};console.info(`%c\u23f1 ${i(t,5)} /${i(e,5)} ms`,`\n            font-size: .6rem;\n            font-weight: bold;\n            color: hsl(${Math.max(0,Math.min(120-120*r,120))}deg 100% 31%);`,null==n?void 0:n.key)}return r}}function YX(e,t,n,r){return{debug:()=>{var n;return null!=(n=null==e?void 0:e.debugAll)?n:e[t]},key:!1,onChange:r}}const qX="debugHeaders";function XX(e,t,n){var r;let i={id:null!=(r=n.id)?r:t.id,column:t,index:n.index,isPlaceholder:!!n.isPlaceholder,placeholderId:n.placeholderId,depth:n.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const e=[],t=n=>{n.subHeaders&&n.subHeaders.length&&n.subHeaders.map(t),e.push(n)};return t(i),e},getContext:()=>({table:e,header:i,column:t})};return e._features.forEach(t=>{null==t.createHeader||t.createHeader(i,e)}),i}const QX={createTable:e=>{e.getHeaderGroups=KX(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,r,i)=>{var o,s;const a=null!=(o=null==r?void 0:r.map(e=>n.find(t=>t.id===e)).filter(Boolean))?o:[],l=null!=(s=null==i?void 0:i.map(e=>n.find(t=>t.id===e)).filter(Boolean))?s:[],c=n.filter(e=>!(null!=r&&r.includes(e.id))&&!(null!=i&&i.includes(e.id)));return JX(t,[...a,...c,...l],e)},YX(e.options,qX)),e.getCenterHeaderGroups=KX(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,n,r,i)=>(n=n.filter(e=>!(null!=r&&r.includes(e.id))&&!(null!=i&&i.includes(e.id))),JX(t,n,e,"center")),YX(e.options,qX)),e.getLeftHeaderGroups=KX(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,n,r)=>{var i;return JX(t,null!=(i=null==r?void 0:r.map(e=>n.find(t=>t.id===e)).filter(Boolean))?i:[],e,"left")},YX(e.options,qX)),e.getRightHeaderGroups=KX(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,n,r)=>{var i;return JX(t,null!=(i=null==r?void 0:r.map(e=>n.find(t=>t.id===e)).filter(Boolean))?i:[],e,"right")},YX(e.options,qX)),e.getFooterGroups=KX(()=>[e.getHeaderGroups()],e=>[...e].reverse(),YX(e.options,qX)),e.getLeftFooterGroups=KX(()=>[e.getLeftHeaderGroups()],e=>[...e].reverse(),YX(e.options,qX)),e.getCenterFooterGroups=KX(()=>[e.getCenterHeaderGroups()],e=>[...e].reverse(),YX(e.options,qX)),e.getRightFooterGroups=KX(()=>[e.getRightHeaderGroups()],e=>[...e].reverse(),YX(e.options,qX)),e.getFlatHeaders=KX(()=>[e.getHeaderGroups()],e=>e.map(e=>e.headers).flat(),YX(e.options,qX)),e.getLeftFlatHeaders=KX(()=>[e.getLeftHeaderGroups()],e=>e.map(e=>e.headers).flat(),YX(e.options,qX)),e.getCenterFlatHeaders=KX(()=>[e.getCenterHeaderGroups()],e=>e.map(e=>e.headers).flat(),YX(e.options,qX)),e.getRightFlatHeaders=KX(()=>[e.getRightHeaderGroups()],e=>e.map(e=>e.headers).flat(),YX(e.options,qX)),e.getCenterLeafHeaders=KX(()=>[e.getCenterFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),YX(e.options,qX)),e.getLeftLeafHeaders=KX(()=>[e.getLeftFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),YX(e.options,qX)),e.getRightLeafHeaders=KX(()=>[e.getRightFlatHeaders()],e=>e.filter(e=>{var t;return!(null!=(t=e.subHeaders)&&t.length)}),YX(e.options,qX)),e.getLeafHeaders=KX(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(e,t,n)=>{var r,i,o,s,a,l;return[...null!=(r=null==(i=e[0])?void 0:i.headers)?r:[],...null!=(o=null==(s=t[0])?void 0:s.headers)?o:[],...null!=(a=null==(l=n[0])?void 0:l.headers)?a:[]].map(e=>e.getLeafHeaders()).flat()},YX(e.options,qX))}};function JX(e,t,n,r){var i,o;let s=0;const a=function(e,t){void 0===t&&(t=1),s=Math.max(s,t),e.filter(e=>e.getIsVisible()).forEach(e=>{var n;null!=(n=e.columns)&&n.length&&a(e.columns,t+1)},0)};a(e);let l=[];const c=(e,t)=>{const i={depth:t,id:[r,`${t}`].filter(Boolean).join("_"),headers:[]},o=[];e.forEach(e=>{const s=[...o].reverse()[0];let a,l=!1;if(e.column.depth===i.depth&&e.column.parent?a=e.column.parent:(a=e.column,l=!0),s&&(null==s?void 0:s.column)===a)s.subHeaders.push(e);else{const i=XX(n,a,{id:[r,t,a.id,null==e?void 0:e.id].filter(Boolean).join("_"),isPlaceholder:l,placeholderId:l?`${o.filter(e=>e.column===a).length}`:void 0,depth:t,index:o.length});i.subHeaders.push(e),o.push(i)}i.headers.push(e),e.headerGroup=i}),l.push(i),t>0&&c(o,t-1)},u=t.map((e,t)=>XX(n,e,{depth:s,index:t}));c(u,s-1),l.reverse();const d=e=>e.filter(e=>e.column.getIsVisible()).map(e=>{let t=0,n=0,r=[0];e.subHeaders&&e.subHeaders.length?(r=[],d(e.subHeaders).forEach(e=>{let{colSpan:n,rowSpan:i}=e;t+=n,r.push(i)})):t=1;return n+=Math.min(...r),e.colSpan=t,e.rowSpan=n,{colSpan:t,rowSpan:n}});return d(null!=(i=null==(o=l[0])?void 0:o.headers)?i:[]),l}const ZX=(e,t,n,r,i,o,s)=>{let a={id:t,index:r,original:n,depth:i,parentId:s,_valuesCache:{},_uniqueValuesCache:{},getValue:t=>{if(a._valuesCache.hasOwnProperty(t))return a._valuesCache[t];const n=e.getColumn(t);return null!=n&&n.accessorFn?(a._valuesCache[t]=n.accessorFn(a.original,r),a._valuesCache[t]):void 0},getUniqueValues:t=>{if(a._uniqueValuesCache.hasOwnProperty(t))return a._uniqueValuesCache[t];const n=e.getColumn(t);return null!=n&&n.accessorFn?n.columnDef.getUniqueValues?(a._uniqueValuesCache[t]=n.columnDef.getUniqueValues(a.original,r),a._uniqueValuesCache[t]):(a._uniqueValuesCache[t]=[a.getValue(t)],a._uniqueValuesCache[t]):void 0},renderValue:t=>{var n;return null!=(n=a.getValue(t))?n:e.options.renderFallbackValue},subRows:null!=o?o:[],getLeafRows:()=>UX(a.subRows,e=>e.subRows),getParentRow:()=>a.parentId?e.getRow(a.parentId,!0):void 0,getParentRows:()=>{let e=[],t=a;for(;;){const n=t.getParentRow();if(!n)break;e.push(n),t=n}return e.reverse()},getAllCells:KX(()=>[e.getAllLeafColumns()],t=>t.map(t=>function(e,t,n,r){const i={id:`${t.id}_${n.id}`,row:t,column:n,getValue:()=>t.getValue(r),renderValue:()=>{var t;return null!=(t=i.getValue())?t:e.options.renderFallbackValue},getContext:KX(()=>[e,n,t,i],(e,t,n,r)=>({table:e,column:t,row:n,cell:r,getValue:r.getValue,renderValue:r.renderValue}),YX(e.options,"debugCells"))};return e._features.forEach(r=>{null==r.createCell||r.createCell(i,n,t,e)},{}),i}(e,a,t,t.id)),YX(e.options,"debugRows")),_getAllCellsByColumnId:KX(()=>[a.getAllCells()],e=>e.reduce((e,t)=>(e[t.column.id]=t,e),{}),YX(e.options,"debugRows"))};for(let l=0;l<e._features.length;l++){const t=e._features[l];null==t||null==t.createRow||t.createRow(a,e)}return a},eQ={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},tQ=(e,t,n)=>{var r,i;const o=null==n||null==(r=n.toString())?void 0:r.toLowerCase();return Boolean(null==(i=e.getValue(t))||null==(i=i.toString())||null==(i=i.toLowerCase())?void 0:i.includes(o))};tQ.autoRemove=e=>dQ(e);const nQ=(e,t,n)=>{var r;return Boolean(null==(r=e.getValue(t))||null==(r=r.toString())?void 0:r.includes(n))};nQ.autoRemove=e=>dQ(e);const rQ=(e,t,n)=>{var r;return(null==(r=e.getValue(t))||null==(r=r.toString())?void 0:r.toLowerCase())===(null==n?void 0:n.toLowerCase())};rQ.autoRemove=e=>dQ(e);const iQ=(e,t,n)=>{var r;return null==(r=e.getValue(t))?void 0:r.includes(n)};iQ.autoRemove=e=>dQ(e);const oQ=(e,t,n)=>!n.some(n=>{var r;return!(null!=(r=e.getValue(t))&&r.includes(n))});oQ.autoRemove=e=>dQ(e)||!(null!=e&&e.length);const sQ=(e,t,n)=>n.some(n=>{var r;return null==(r=e.getValue(t))?void 0:r.includes(n)});sQ.autoRemove=e=>dQ(e)||!(null!=e&&e.length);const aQ=(e,t,n)=>e.getValue(t)===n;aQ.autoRemove=e=>dQ(e);const lQ=(e,t,n)=>e.getValue(t)==n;lQ.autoRemove=e=>dQ(e);const cQ=(e,t,n)=>{let[r,i]=n;const o=e.getValue(t);return o>=r&&o<=i};cQ.resolveFilterValue=e=>{let[t,n]=e,r="number"!==typeof t?parseFloat(t):t,i="number"!==typeof n?parseFloat(n):n,o=null===t||Number.isNaN(r)?-1/0:r,s=null===n||Number.isNaN(i)?1/0:i;if(o>s){const e=o;o=s,s=e}return[o,s]},cQ.autoRemove=e=>dQ(e)||dQ(e[0])&&dQ(e[1]);const uQ={includesString:tQ,includesStringSensitive:nQ,equalsString:rQ,arrIncludes:iQ,arrIncludesAll:oQ,arrIncludesSome:sQ,equals:aQ,weakEquals:lQ,inNumberRange:cQ};function dQ(e){return void 0===e||null===e||""===e}const hQ={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:GX("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const n=t.getCoreRowModel().flatRows[0],r=null==n?void 0:n.getValue(e.id);return"string"===typeof r?uQ.includesString:"number"===typeof r?uQ.inNumberRange:"boolean"===typeof r||null!==r&&"object"===typeof r?uQ.equals:Array.isArray(r)?uQ.arrIncludes:uQ.weakEquals},e.getFilterFn=()=>{var n,r;return $X(e.columnDef.filterFn)?e.columnDef.filterFn:"auto"===e.columnDef.filterFn?e.getAutoFilterFn():null!=(n=null==(r=t.options.filterFns)?void 0:r[e.columnDef.filterFn])?n:uQ[e.columnDef.filterFn]},e.getCanFilter=()=>{var n,r,i;return(null==(n=e.columnDef.enableColumnFilter)||n)&&(null==(r=t.options.enableColumnFilters)||r)&&(null==(i=t.options.enableFilters)||i)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var n;return null==(n=t.getState().columnFilters)||null==(n=n.find(t=>t.id===e.id))?void 0:n.value},e.getFilterIndex=()=>{var n,r;return null!=(n=null==(r=t.getState().columnFilters)?void 0:r.findIndex(t=>t.id===e.id))?n:-1},e.setFilterValue=n=>{t.setColumnFilters(t=>{const r=e.getFilterFn(),i=null==t?void 0:t.find(t=>t.id===e.id),o=jX(n,i?i.value:void 0);var s;if(pQ(r,o,e))return null!=(s=null==t?void 0:t.filter(t=>t.id!==e.id))?s:[];const a={id:e.id,value:o};var l;return i?null!=(l=null==t?void 0:t.map(t=>t.id===e.id?a:t))?l:[]:null!=t&&t.length?[...t,a]:[a]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const n=e.getAllLeafColumns();null==e.options.onColumnFiltersChange||e.options.onColumnFiltersChange(e=>{var r;return null==(r=jX(t,e))?void 0:r.filter(e=>{const t=n.find(t=>t.id===e.id);if(t){if(pQ(t.getFilterFn(),e.value,t))return!1}return!0})})},e.resetColumnFilters=t=>{var n,r;e.setColumnFilters(t?[]:null!=(n=null==(r=e.initialState)?void 0:r.columnFilters)?n:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function pQ(e,t,n){return!(!e||!e.autoRemove)&&e.autoRemove(t,n)||"undefined"===typeof t||"string"===typeof t&&!t}const gQ={sum:(e,t,n)=>n.reduce((t,n)=>{const r=n.getValue(e);return t+("number"===typeof r?r:0)},0),min:(e,t,n)=>{let r;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(r>n||void 0===r&&n>=n)&&(r=n)}),r},max:(e,t,n)=>{let r;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(r<n||void 0===r&&n>=n)&&(r=n)}),r},extent:(e,t,n)=>{let r,i;return n.forEach(t=>{const n=t.getValue(e);null!=n&&(void 0===r?n>=n&&(r=i=n):(r>n&&(r=n),i<n&&(i=n)))}),[r,i]},mean:(e,t)=>{let n=0,r=0;if(t.forEach(t=>{let i=t.getValue(e);null!=i&&(i=+i)>=i&&(++n,r+=i)}),n)return r/n},median:(e,t)=>{if(!t.length)return;const n=t.map(t=>t.getValue(e));if(r=n,!Array.isArray(r)||!r.every(e=>"number"===typeof e))return;var r;if(1===n.length)return n[0];const i=Math.floor(n.length/2),o=n.sort((e,t)=>e-t);return n.length%2!==0?o[i]:(o[i-1]+o[i])/2},unique:(e,t)=>Array.from(new Set(t.map(t=>t.getValue(e))).values()),uniqueCount:(e,t)=>new Set(t.map(t=>t.getValue(e))).size,count:(e,t)=>t.length},fQ={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,n;return null!=(t=null==(n=e.getValue())||null==n.toString?void 0:n.toString())?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:GX("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(t=>null!=t&&t.includes(e.id)?t.filter(t=>t!==e.id):[...null!=t?t:[],e.id])},e.getCanGroup=()=>{var n,r;return(null==(n=e.columnDef.enableGrouping)||n)&&(null==(r=t.options.enableGrouping)||r)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var n;return null==(n=t.getState().grouping)?void 0:n.includes(e.id)},e.getGroupedIndex=()=>{var n;return null==(n=t.getState().grouping)?void 0:n.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const t=e.getCanGroup();return()=>{t&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const n=t.getCoreRowModel().flatRows[0],r=null==n?void 0:n.getValue(e.id);return"number"===typeof r?gQ.sum:"[object Date]"===Object.prototype.toString.call(r)?gQ.extent:void 0},e.getAggregationFn=()=>{var n,r;if(!e)throw new Error;return $X(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:"auto"===e.columnDef.aggregationFn?e.getAutoAggregationFn():null!=(n=null==(r=t.options.aggregationFns)?void 0:r[e.columnDef.aggregationFn])?n:gQ[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>null==e.options.onGroupingChange?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var n,r;e.setGrouping(t?[]:null!=(n=null==(r=e.initialState)?void 0:r.grouping)?n:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=n=>{if(e._groupingValuesCache.hasOwnProperty(n))return e._groupingValuesCache[n];const r=t.getColumn(n);return null!=r&&r.columnDef.getGroupingValue?(e._groupingValuesCache[n]=r.columnDef.getGroupingValue(e.original),e._groupingValuesCache[n]):e.getValue(n)},e._groupingValuesCache={}},createCell:(e,t,n,r)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===n.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var t;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!(null==(t=n.subRows)||!t.length)}}};const mQ={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:GX("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=KX(e=>[xQ(t,e)],t=>t.findIndex(t=>t.id===e.id),YX(t.options,"debugColumns")),e.getIsFirstColumn=n=>{var r;return(null==(r=xQ(t,n)[0])?void 0:r.id)===e.id},e.getIsLastColumn=n=>{var r;const i=xQ(t,n);return(null==(r=i[i.length-1])?void 0:r.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>null==e.options.onColumnOrderChange?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var n;e.setColumnOrder(t?[]:null!=(n=e.initialState.columnOrder)?n:[])},e._getOrderColumnsFn=KX(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(e,t,n)=>r=>{let i=[];if(null!=e&&e.length){const t=[...e],n=[...r];for(;n.length&&t.length;){const e=t.shift(),r=n.findIndex(t=>t.id===e);r>-1&&i.push(n.splice(r,1)[0])}i=[...i,...n]}else i=r;return function(e,t,n){if(null==t||!t.length||!n)return e;const r=e.filter(e=>!t.includes(e.id));return"remove"===n?r:[...t.map(t=>e.find(e=>e.id===t)).filter(Boolean),...r]}(i,t,n)},YX(e.options,"debugTable"))}},vQ={getInitialState:e=>({columnPinning:{left:[],right:[]},...e}),getDefaultOptions:e=>({onColumnPinningChange:GX("columnPinning",e)}),createColumn:(e,t)=>{e.pin=n=>{const r=e.getLeafColumns().map(e=>e.id).filter(Boolean);t.setColumnPinning(e=>{var t,i,o,s,a,l;return"right"===n?{left:(null!=(o=null==e?void 0:e.left)?o:[]).filter(e=>!(null!=r&&r.includes(e))),right:[...(null!=(s=null==e?void 0:e.right)?s:[]).filter(e=>!(null!=r&&r.includes(e))),...r]}:"left"===n?{left:[...(null!=(a=null==e?void 0:e.left)?a:[]).filter(e=>!(null!=r&&r.includes(e))),...r],right:(null!=(l=null==e?void 0:e.right)?l:[]).filter(e=>!(null!=r&&r.includes(e)))}:{left:(null!=(t=null==e?void 0:e.left)?t:[]).filter(e=>!(null!=r&&r.includes(e))),right:(null!=(i=null==e?void 0:e.right)?i:[]).filter(e=>!(null!=r&&r.includes(e)))}})},e.getCanPin=()=>e.getLeafColumns().some(e=>{var n,r,i;return(null==(n=e.columnDef.enablePinning)||n)&&(null==(r=null!=(i=t.options.enableColumnPinning)?i:t.options.enablePinning)||r)}),e.getIsPinned=()=>{const n=e.getLeafColumns().map(e=>e.id),{left:r,right:i}=t.getState().columnPinning,o=n.some(e=>null==r?void 0:r.includes(e)),s=n.some(e=>null==i?void 0:i.includes(e));return o?"left":!!s&&"right"},e.getPinnedIndex=()=>{var n,r;const i=e.getIsPinned();return i?null!=(n=null==(r=t.getState().columnPinning)||null==(r=r[i])?void 0:r.indexOf(e.id))?n:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=KX(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(e,t,n)=>{const r=[...null!=t?t:[],...null!=n?n:[]];return e.filter(e=>!r.includes(e.column.id))},YX(t.options,"debugRows")),e.getLeftVisibleCells=KX(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"left"})),YX(t.options,"debugRows")),e.getRightVisibleCells=KX(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.column.id===t)).filter(Boolean).map(e=>({...e,position:"right"})),YX(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>null==e.options.onColumnPinningChange?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var n,r;return e.setColumnPinning(t?{left:[],right:[]}:null!=(n=null==(r=e.initialState)?void 0:r.columnPinning)?n:{left:[],right:[]})},e.getIsSomeColumnsPinned=t=>{var n;const r=e.getState().columnPinning;var i,o;return t?Boolean(null==(n=r[t])?void 0:n.length):Boolean((null==(i=r.left)?void 0:i.length)||(null==(o=r.right)?void 0:o.length))},e.getLeftLeafColumns=KX(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),YX(e.options,"debugColumns")),e.getRightLeafColumns=KX(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(e,t)=>(null!=t?t:[]).map(t=>e.find(e=>e.id===t)).filter(Boolean),YX(e.options,"debugColumns")),e.getCenterLeafColumns=KX(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(e,t,n)=>{const r=[...null!=t?t:[],...null!=n?n:[]];return e.filter(e=>!r.includes(e.id))},YX(e.options,"debugColumns"))}};const wQ={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},bQ={getDefaultColumnDef:()=>wQ,getInitialState:e=>({columnSizing:{},columnSizingInfo:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]},...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:GX("columnSizing",e),onColumnSizingInfoChange:GX("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var n,r,i;const o=t.getState().columnSizing[e.id];return Math.min(Math.max(null!=(n=e.columnDef.minSize)?n:wQ.minSize,null!=(r=null!=o?o:e.columnDef.size)?r:wQ.size),null!=(i=e.columnDef.maxSize)?i:wQ.maxSize)},e.getStart=KX(e=>[e,xQ(t,e),t.getState().columnSizing],(t,n)=>n.slice(0,e.getIndex(t)).reduce((e,t)=>e+t.getSize(),0),YX(t.options,"debugColumns")),e.getAfter=KX(e=>[e,xQ(t,e),t.getState().columnSizing],(t,n)=>n.slice(e.getIndex(t)+1).reduce((e,t)=>e+t.getSize(),0),YX(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(t=>{let{[e.id]:n,...r}=t;return r})},e.getCanResize=()=>{var n,r;return(null==(n=e.columnDef.enableResizing)||n)&&(null==(r=t.options.enableColumnResizing)||r)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let t=0;const n=e=>{var r;e.subHeaders.length?e.subHeaders.forEach(n):t+=null!=(r=e.column.getSize())?r:0};return n(e),t},e.getStart=()=>{if(e.index>0){const t=e.headerGroup.headers[e.index-1];return t.getStart()+t.getSize()}return 0},e.getResizeHandler=n=>{const r=t.getColumn(e.column.id),i=null==r?void 0:r.getCanResize();return o=>{if(!r||!i)return;if(null==o.persist||o.persist(),yQ(o)&&o.touches&&o.touches.length>1)return;const s=e.getSize(),a=e?e.getLeafHeaders().map(e=>[e.column.id,e.column.getSize()]):[[r.id,r.getSize()]],l=yQ(o)?Math.round(o.touches[0].clientX):o.clientX,c={},u=(e,n)=>{"number"===typeof n&&(t.setColumnSizingInfo(e=>{var r,i;const o="rtl"===t.options.columnResizeDirection?-1:1,s=(n-(null!=(r=null==e?void 0:e.startOffset)?r:0))*o,a=Math.max(s/(null!=(i=null==e?void 0:e.startSize)?i:0),-.999999);return e.columnSizingStart.forEach(e=>{let[t,n]=e;c[t]=Math.round(100*Math.max(n+n*a,0))/100}),{...e,deltaOffset:s,deltaPercentage:a}}),"onChange"!==t.options.columnResizeMode&&"end"!==e||t.setColumnSizing(e=>({...e,...c})))},d=e=>u("move",e),h=e=>{u("end",e),t.setColumnSizingInfo(e=>({...e,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},p=n||("undefined"!==typeof document?document:null);const g={moveHandler:e=>d(e.clientX),upHandler:e=>{null==p||p.removeEventListener("mousemove",g.moveHandler),null==p||p.removeEventListener("mouseup",g.upHandler),h(e.clientX)}},f={moveHandler:e=>(e.cancelable&&(e.preventDefault(),e.stopPropagation()),d(e.touches[0].clientX),!1),upHandler:e=>{var t;null==p||p.removeEventListener("touchmove",f.moveHandler),null==p||p.removeEventListener("touchend",f.upHandler),e.cancelable&&(e.preventDefault(),e.stopPropagation()),h(null==(t=e.touches[0])?void 0:t.clientX)}},m=!!function(){if("boolean"===typeof CQ)return CQ;let e=!1;try{const t={get passive(){return e=!0,!1}},n=()=>{};window.addEventListener("test",n,t),window.removeEventListener("test",n)}catch(t){e=!1}return CQ=e,CQ}()&&{passive:!1};yQ(o)?(null==p||p.addEventListener("touchmove",f.moveHandler,m),null==p||p.addEventListener("touchend",f.upHandler,m)):(null==p||p.addEventListener("mousemove",g.moveHandler,m),null==p||p.addEventListener("mouseup",g.upHandler,m)),t.setColumnSizingInfo(e=>({...e,startOffset:l,startSize:s,deltaOffset:0,deltaPercentage:0,columnSizingStart:a,isResizingColumn:r.id}))}}},createTable:e=>{e.setColumnSizing=t=>null==e.options.onColumnSizingChange?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>null==e.options.onColumnSizingInfoChange?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var n;e.setColumnSizing(t?{}:null!=(n=e.initialState.columnSizing)?n:{})},e.resetHeaderSizeInfo=t=>{var n;e.setColumnSizingInfo(t?{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}:null!=(n=e.initialState.columnSizingInfo)?n:{startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]})},e.getTotalSize=()=>{var t,n;return null!=(t=null==(n=e.getHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getLeftTotalSize=()=>{var t,n;return null!=(t=null==(n=e.getLeftHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getCenterTotalSize=()=>{var t,n;return null!=(t=null==(n=e.getCenterHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0},e.getRightTotalSize=()=>{var t,n;return null!=(t=null==(n=e.getRightHeaderGroups()[0])?void 0:n.headers.reduce((e,t)=>e+t.getSize(),0))?t:0}}};let CQ=null;function yQ(e){return"touchstart"===e.type}const SQ={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:GX("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=n=>{e.getCanHide()&&t.setColumnVisibility(t=>({...t,[e.id]:null!=n?n:!e.getIsVisible()}))},e.getIsVisible=()=>{var n,r;const i=e.columns;return null==(n=i.length?i.some(e=>e.getIsVisible()):null==(r=t.getState().columnVisibility)?void 0:r[e.id])||n},e.getCanHide=()=>{var n,r;return(null==(n=e.columnDef.enableHiding)||n)&&(null==(r=t.options.enableHiding)||r)},e.getToggleVisibilityHandler=()=>t=>{null==e.toggleVisibility||e.toggleVisibility(t.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=KX(()=>[e.getAllCells(),t.getState().columnVisibility],e=>e.filter(e=>e.column.getIsVisible()),YX(t.options,"debugRows")),e.getVisibleCells=KX(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(e,t,n)=>[...e,...t,...n],YX(t.options,"debugRows"))},createTable:e=>{const t=(t,n)=>KX(()=>[n(),n().filter(e=>e.getIsVisible()).map(e=>e.id).join("_")],e=>e.filter(e=>null==e.getIsVisible?void 0:e.getIsVisible()),YX(e.options,"debugColumns"));e.getVisibleFlatColumns=t(0,()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t(0,()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t(0,()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t(0,()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t(0,()=>e.getCenterLeafColumns()),e.setColumnVisibility=t=>null==e.options.onColumnVisibilityChange?void 0:e.options.onColumnVisibilityChange(t),e.resetColumnVisibility=t=>{var n;e.setColumnVisibility(t?{}:null!=(n=e.initialState.columnVisibility)?n:{})},e.toggleAllColumnsVisible=t=>{var n;t=null!=(n=t)?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((e,n)=>({...e,[n.id]:t||!(null!=n.getCanHide&&n.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(e=>!(null!=e.getIsVisible&&e.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(e=>null==e.getIsVisible?void 0:e.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>t=>{var n;e.toggleAllColumnsVisible(null==(n=t.target)?void 0:n.checked)}}};function xQ(e,t){return t?"center"===t?e.getCenterVisibleLeafColumns():"left"===t?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const RQ={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},EQ={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:GX("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var n;const r=null==(n=e.getCoreRowModel().flatRows[0])||null==(n=n._getAllCellsByColumnId()[t.id])?void 0:n.getValue();return"string"===typeof r||"number"===typeof r}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var n,r,i,o;return(null==(n=e.columnDef.enableGlobalFilter)||n)&&(null==(r=t.options.enableGlobalFilter)||r)&&(null==(i=t.options.enableFilters)||i)&&(null==(o=null==t.options.getColumnCanGlobalFilter?void 0:t.options.getColumnCanGlobalFilter(e))||o)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>uQ.includesString,e.getGlobalFilterFn=()=>{var t,n;const{globalFilterFn:r}=e.options;return $X(r)?r:"auto"===r?e.getGlobalAutoFilterFn():null!=(t=null==(n=e.options.filterFns)?void 0:n[r])?t:uQ[r]},e.setGlobalFilter=t=>{null==e.options.onGlobalFilterChange||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},TQ={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:GX("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,n=!1;e._autoResetExpanded=()=>{var r,i;if(t){if(null!=(r=null!=(i=e.options.autoResetAll)?i:e.options.autoResetExpanded)?r:!e.options.manualExpanding){if(n)return;n=!0,e._queue(()=>{e.resetExpanded(),n=!1})}}else e._queue(()=>{t=!0})},e.setExpanded=t=>null==e.options.onExpandedChange?void 0:e.options.onExpandedChange(t),e.toggleAllRowsExpanded=t=>{(null!=t?t:!e.getIsAllRowsExpanded())?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=t=>{var n,r;e.setExpanded(t?{}:null!=(n=null==(r=e.initialState)?void 0:r.expanded)?n:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(e=>e.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>t=>{null==t.persist||t.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const t=e.getState().expanded;return!0===t||Object.values(t).some(Boolean)},e.getIsAllRowsExpanded=()=>{const t=e.getState().expanded;return"boolean"===typeof t?!0===t:!!Object.keys(t).length&&!e.getRowModel().flatRows.some(e=>!e.getIsExpanded())},e.getExpandedDepth=()=>{let t=0;return(!0===e.getState().expanded?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(e=>{const n=e.split(".");t=Math.max(t,n.length)}),t},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=n=>{t.setExpanded(r=>{var i;const o=!0===r||!(null==r||!r[e.id]);let s={};if(!0===r?Object.keys(t.getRowModel().rowsById).forEach(e=>{s[e]=!0}):s=r,n=null!=(i=n)?i:!o,!o&&n)return{...s,[e.id]:!0};if(o&&!n){const{[e.id]:t,...n}=s;return n}return r})},e.getIsExpanded=()=>{var n;const r=t.getState().expanded;return!!(null!=(n=null==t.options.getIsRowExpanded?void 0:t.options.getIsRowExpanded(e))?n:!0===r||(null==r?void 0:r[e.id]))},e.getCanExpand=()=>{var n,r,i;return null!=(n=null==t.options.getRowCanExpand?void 0:t.options.getRowCanExpand(e))?n:(null==(r=t.options.enableExpanding)||r)&&!(null==(i=e.subRows)||!i.length)},e.getIsAllParentsExpanded=()=>{let n=!0,r=e;for(;n&&r.parentId;)r=t.getRow(r.parentId,!0),n=r.getIsExpanded();return n},e.getToggleExpandedHandler=()=>{const t=e.getCanExpand();return()=>{t&&e.toggleExpanded()}}}},kQ={getInitialState:e=>({...e,pagination:{pageIndex:0,pageSize:10,...null==e?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:GX("pagination",e)}),createTable:e=>{let t=!1,n=!1;e._autoResetPageIndex=()=>{var r,i;if(t){if(null!=(r=null!=(i=e.options.autoResetAll)?i:e.options.autoResetPageIndex)?r:!e.options.manualPagination){if(n)return;n=!0,e._queue(()=>{e.resetPageIndex(),n=!1})}}else e._queue(()=>{t=!0})},e.setPagination=t=>null==e.options.onPaginationChange?void 0:e.options.onPaginationChange(e=>jX(t,e)),e.resetPagination=t=>{var n;e.setPagination(t?{pageIndex:0,pageSize:10}:null!=(n=e.initialState.pagination)?n:{pageIndex:0,pageSize:10})},e.setPageIndex=t=>{e.setPagination(n=>{let r=jX(t,n.pageIndex);const i="undefined"===typeof e.options.pageCount||-1===e.options.pageCount?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return r=Math.max(0,Math.min(r,i)),{...n,pageIndex:r}})},e.resetPageIndex=t=>{var n,r;e.setPageIndex(t?0:null!=(n=null==(r=e.initialState)||null==(r=r.pagination)?void 0:r.pageIndex)?n:0)},e.resetPageSize=t=>{var n,r;e.setPageSize(t?10:null!=(n=null==(r=e.initialState)||null==(r=r.pagination)?void 0:r.pageSize)?n:10)},e.setPageSize=t=>{e.setPagination(e=>{const n=Math.max(1,jX(t,e.pageSize)),r=e.pageSize*e.pageIndex,i=Math.floor(r/n);return{...e,pageIndex:i,pageSize:n}})},e.setPageCount=t=>e.setPagination(n=>{var r;let i=jX(t,null!=(r=e.options.pageCount)?r:-1);return"number"===typeof i&&(i=Math.max(-1,i)),{...n,pageCount:i}}),e.getPageOptions=KX(()=>[e.getPageCount()],e=>{let t=[];return e&&e>0&&(t=[...new Array(e)].fill(null).map((e,t)=>t)),t},YX(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:t}=e.getState().pagination,n=e.getPageCount();return-1===n||0!==n&&t<n-1},e.previousPage=()=>e.setPageIndex(e=>e-1),e.nextPage=()=>e.setPageIndex(e=>e+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var t;return null!=(t=e.options.pageCount)?t:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var t;return null!=(t=e.options.rowCount)?t:e.getPrePaginationRowModel().rows.length}}},MQ={getInitialState:e=>({rowPinning:{top:[],bottom:[]},...e}),getDefaultOptions:e=>({onRowPinningChange:GX("rowPinning",e)}),createRow:(e,t)=>{e.pin=(n,r,i)=>{const o=r?e.getLeafRows().map(e=>{let{id:t}=e;return t}):[],s=i?e.getParentRows().map(e=>{let{id:t}=e;return t}):[],a=new Set([...s,e.id,...o]);t.setRowPinning(e=>{var t,r,i,o,s,l;return"bottom"===n?{top:(null!=(i=null==e?void 0:e.top)?i:[]).filter(e=>!(null!=a&&a.has(e))),bottom:[...(null!=(o=null==e?void 0:e.bottom)?o:[]).filter(e=>!(null!=a&&a.has(e))),...Array.from(a)]}:"top"===n?{top:[...(null!=(s=null==e?void 0:e.top)?s:[]).filter(e=>!(null!=a&&a.has(e))),...Array.from(a)],bottom:(null!=(l=null==e?void 0:e.bottom)?l:[]).filter(e=>!(null!=a&&a.has(e)))}:{top:(null!=(t=null==e?void 0:e.top)?t:[]).filter(e=>!(null!=a&&a.has(e))),bottom:(null!=(r=null==e?void 0:e.bottom)?r:[]).filter(e=>!(null!=a&&a.has(e)))}})},e.getCanPin=()=>{var n;const{enableRowPinning:r,enablePinning:i}=t.options;return"function"===typeof r?r(e):null==(n=null!=r?r:i)||n},e.getIsPinned=()=>{const n=[e.id],{top:r,bottom:i}=t.getState().rowPinning,o=n.some(e=>null==r?void 0:r.includes(e)),s=n.some(e=>null==i?void 0:i.includes(e));return o?"top":!!s&&"bottom"},e.getPinnedIndex=()=>{var n,r;const i=e.getIsPinned();if(!i)return-1;const o=null==(n="top"===i?t.getTopRows():t.getBottomRows())?void 0:n.map(e=>{let{id:t}=e;return t});return null!=(r=null==o?void 0:o.indexOf(e.id))?r:-1}},createTable:e=>{e.setRowPinning=t=>null==e.options.onRowPinningChange?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var n,r;return e.setRowPinning(t?{top:[],bottom:[]}:null!=(n=null==(r=e.initialState)?void 0:r.rowPinning)?n:{top:[],bottom:[]})},e.getIsSomeRowsPinned=t=>{var n;const r=e.getState().rowPinning;var i,o;return t?Boolean(null==(n=r[t])?void 0:n.length):Boolean((null==(i=r.top)?void 0:i.length)||(null==(o=r.bottom)?void 0:o.length))},e._getPinnedRows=(t,n,r)=>{var i;const o=null==(i=e.options.keepPinnedRows)||i?(null!=n?n:[]).map(t=>{const n=e.getRow(t,!0);return n.getIsAllParentsExpanded()?n:null}):(null!=n?n:[]).map(e=>t.find(t=>t.id===e));return o.filter(Boolean).map(e=>({...e,position:r}))},e.getTopRows=KX(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,n)=>e._getPinnedRows(t,n,"top"),YX(e.options,"debugRows")),e.getBottomRows=KX(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,n)=>e._getPinnedRows(t,n,"bottom"),YX(e.options,"debugRows")),e.getCenterRows=KX(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(e,t,n)=>{const r=new Set([...null!=t?t:[],...null!=n?n:[]]);return e.filter(e=>!r.has(e.id))},YX(e.options,"debugRows"))}},PQ={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:GX("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>null==e.options.onRowSelectionChange?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var n;return e.setRowSelection(t?{}:null!=(n=e.initialState.rowSelection)?n:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(n=>{t="undefined"!==typeof t?t:!e.getIsAllRowsSelected();const r={...n},i=e.getPreGroupedRowModel().flatRows;return t?i.forEach(e=>{e.getCanSelect()&&(r[e.id]=!0)}):i.forEach(e=>{delete r[e.id]}),r})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(n=>{const r="undefined"!==typeof t?t:!e.getIsAllPageRowsSelected(),i={...n};return e.getRowModel().rows.forEach(t=>{IQ(i,t.id,r,!0,e)}),i}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=KX(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,n)=>Object.keys(t).length?AQ(e,n):{rows:[],flatRows:[],rowsById:{}},YX(e.options,"debugTable")),e.getFilteredSelectedRowModel=KX(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,n)=>Object.keys(t).length?AQ(e,n):{rows:[],flatRows:[],rowsById:{}},YX(e.options,"debugTable")),e.getGroupedSelectedRowModel=KX(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,n)=>Object.keys(t).length?AQ(e,n):{rows:[],flatRows:[],rowsById:{}},YX(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:n}=e.getState();let r=Boolean(t.length&&Object.keys(n).length);return r&&t.some(e=>e.getCanSelect()&&!n[e.id])&&(r=!1),r},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(e=>e.getCanSelect()),{rowSelection:n}=e.getState();let r=!!t.length;return r&&t.some(e=>!n[e.id])&&(r=!1),r},e.getIsSomeRowsSelected=()=>{var t;const n=Object.keys(null!=(t=e.getState().rowSelection)?t:{}).length;return n>0&&n<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return!e.getIsAllPageRowsSelected()&&t.filter(e=>e.getCanSelect()).some(e=>e.getIsSelected()||e.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(n,r)=>{const i=e.getIsSelected();t.setRowSelection(o=>{var s;if(n="undefined"!==typeof n?n:!i,e.getCanSelect()&&i===n)return o;const a={...o};return IQ(a,e.id,n,null==(s=null==r?void 0:r.selectChildren)||s,t),a})},e.getIsSelected=()=>{const{rowSelection:n}=t.getState();return DQ(e,n)},e.getIsSomeSelected=()=>{const{rowSelection:n}=t.getState();return"some"===FQ(e,n)},e.getIsAllSubRowsSelected=()=>{const{rowSelection:n}=t.getState();return"all"===FQ(e,n)},e.getCanSelect=()=>{var n;return"function"===typeof t.options.enableRowSelection?t.options.enableRowSelection(e):null==(n=t.options.enableRowSelection)||n},e.getCanSelectSubRows=()=>{var n;return"function"===typeof t.options.enableSubRowSelection?t.options.enableSubRowSelection(e):null==(n=t.options.enableSubRowSelection)||n},e.getCanMultiSelect=()=>{var n;return"function"===typeof t.options.enableMultiRowSelection?t.options.enableMultiRowSelection(e):null==(n=t.options.enableMultiRowSelection)||n},e.getToggleSelectedHandler=()=>{const t=e.getCanSelect();return n=>{var r;t&&e.toggleSelected(null==(r=n.target)?void 0:r.checked)}}}},IQ=(e,t,n,r,i)=>{var o;const s=i.getRow(t,!0);n?(s.getCanMultiSelect()||Object.keys(e).forEach(t=>delete e[t]),s.getCanSelect()&&(e[t]=!0)):delete e[t],r&&null!=(o=s.subRows)&&o.length&&s.getCanSelectSubRows()&&s.subRows.forEach(t=>IQ(e,t.id,n,r,i))};function AQ(e,t){const n=e.getState().rowSelection,r=[],i={},o=function(e,t){return e.map(e=>{var t;const s=DQ(e,n);if(s&&(r.push(e),i[e.id]=e),null!=(t=e.subRows)&&t.length&&(e={...e,subRows:o(e.subRows)}),s)return e}).filter(Boolean)};return{rows:o(t.rows),flatRows:r,rowsById:i}}function DQ(e,t){var n;return null!=(n=t[e.id])&&n}function FQ(e,t,n){var r;if(null==(r=e.subRows)||!r.length)return!1;let i=!0,o=!1;return e.subRows.forEach(e=>{if((!o||i)&&(e.getCanSelect()&&(DQ(e,t)?o=!0:i=!1),e.subRows&&e.subRows.length)){const n=FQ(e,t);"all"===n?o=!0:"some"===n?(o=!0,i=!1):i=!1}}),i?"all":!!o&&"some"}const OQ=/([0-9]+)/gm;function NQ(e,t){return e===t?0:e>t?1:-1}function LQ(e){return"number"===typeof e?isNaN(e)||e===1/0||e===-1/0?"":String(e):"string"===typeof e?e:""}function _Q(e,t){const n=e.split(OQ).filter(Boolean),r=t.split(OQ).filter(Boolean);for(;n.length&&r.length;){const e=n.shift(),t=r.shift(),i=parseInt(e,10),o=parseInt(t,10),s=[i,o].sort();if(isNaN(s[0])){if(e>t)return 1;if(t>e)return-1}else{if(isNaN(s[1]))return isNaN(i)?-1:1;if(i>o)return 1;if(o>i)return-1}}return n.length-r.length}const HQ={alphanumeric:(e,t,n)=>_Q(LQ(e.getValue(n)).toLowerCase(),LQ(t.getValue(n)).toLowerCase()),alphanumericCaseSensitive:(e,t,n)=>_Q(LQ(e.getValue(n)),LQ(t.getValue(n))),text:(e,t,n)=>NQ(LQ(e.getValue(n)).toLowerCase(),LQ(t.getValue(n)).toLowerCase()),textCaseSensitive:(e,t,n)=>NQ(LQ(e.getValue(n)),LQ(t.getValue(n))),datetime:(e,t,n)=>{const r=e.getValue(n),i=t.getValue(n);return r>i?1:r<i?-1:0},basic:(e,t,n)=>NQ(e.getValue(n),t.getValue(n))},VQ={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:GX("sorting",e),isMultiSortEvent:e=>e.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const n=t.getFilteredRowModel().flatRows.slice(10);let r=!1;for(const t of n){const n=null==t?void 0:t.getValue(e.id);if("[object Date]"===Object.prototype.toString.call(n))return HQ.datetime;if("string"===typeof n&&(r=!0,n.split(OQ).length>1))return HQ.alphanumeric}return r?HQ.text:HQ.basic},e.getAutoSortDir=()=>{const n=t.getFilteredRowModel().flatRows[0];return"string"===typeof(null==n?void 0:n.getValue(e.id))?"asc":"desc"},e.getSortingFn=()=>{var n,r;if(!e)throw new Error;return $X(e.columnDef.sortingFn)?e.columnDef.sortingFn:"auto"===e.columnDef.sortingFn?e.getAutoSortingFn():null!=(n=null==(r=t.options.sortingFns)?void 0:r[e.columnDef.sortingFn])?n:HQ[e.columnDef.sortingFn]},e.toggleSorting=(n,r)=>{const i=e.getNextSortingOrder(),o="undefined"!==typeof n&&null!==n;t.setSorting(s=>{const a=null==s?void 0:s.find(t=>t.id===e.id),l=null==s?void 0:s.findIndex(t=>t.id===e.id);let c,u=[],d=o?n:"desc"===i;var h;(c=null!=s&&s.length&&e.getCanMultiSort()&&r?a?"toggle":"add":null!=s&&s.length&&l!==s.length-1?"replace":a?"toggle":"replace","toggle"===c&&(o||i||(c="remove")),"add"===c)?(u=[...s,{id:e.id,desc:d}],u.splice(0,u.length-(null!=(h=t.options.maxMultiSortColCount)?h:Number.MAX_SAFE_INTEGER))):u="toggle"===c?s.map(t=>t.id===e.id?{...t,desc:d}:t):"remove"===c?s.filter(t=>t.id!==e.id):[{id:e.id,desc:d}];return u})},e.getFirstSortDir=()=>{var n,r;return(null!=(n=null!=(r=e.columnDef.sortDescFirst)?r:t.options.sortDescFirst)?n:"desc"===e.getAutoSortDir())?"desc":"asc"},e.getNextSortingOrder=n=>{var r,i;const o=e.getFirstSortDir(),s=e.getIsSorted();return s?!!(s===o||null!=(r=t.options.enableSortingRemoval)&&!r||n&&null!=(i=t.options.enableMultiRemove)&&!i)&&("desc"===s?"asc":"desc"):o},e.getCanSort=()=>{var n,r;return(null==(n=e.columnDef.enableSorting)||n)&&(null==(r=t.options.enableSorting)||r)&&!!e.accessorFn},e.getCanMultiSort=()=>{var n,r;return null!=(n=null!=(r=e.columnDef.enableMultiSort)?r:t.options.enableMultiSort)?n:!!e.accessorFn},e.getIsSorted=()=>{var n;const r=null==(n=t.getState().sorting)?void 0:n.find(t=>t.id===e.id);return!!r&&(r.desc?"desc":"asc")},e.getSortIndex=()=>{var n,r;return null!=(n=null==(r=t.getState().sorting)?void 0:r.findIndex(t=>t.id===e.id))?n:-1},e.clearSorting=()=>{t.setSorting(t=>null!=t&&t.length?t.filter(t=>t.id!==e.id):[])},e.getToggleSortingHandler=()=>{const n=e.getCanSort();return r=>{n&&(null==r.persist||r.persist(),null==e.toggleSorting||e.toggleSorting(void 0,!!e.getCanMultiSort()&&(null==t.options.isMultiSortEvent?void 0:t.options.isMultiSortEvent(r))))}}},createTable:e=>{e.setSorting=t=>null==e.options.onSortingChange?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var n,r;e.setSorting(t?[]:null!=(n=null==(r=e.initialState)?void 0:r.sorting)?n:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},BQ=[QX,SQ,mQ,vQ,eQ,hQ,RQ,EQ,VQ,fQ,TQ,kQ,MQ,PQ,bQ];function WQ(e){var t,n;const r=[...BQ,...null!=(t=e._features)?t:[]];let i={_features:r};const o=i._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultOptions?void 0:t.getDefaultOptions(i)),{});let s={...null!=(n=e.initialState)?n:{}};i._features.forEach(e=>{var t;s=null!=(t=null==e.getInitialState?void 0:e.getInitialState(s))?t:s});const a=[];let l=!1;const c={_features:r,options:{...o,...e},initialState:s,_queue:e=>{a.push(e),l||(l=!0,Promise.resolve().then(()=>{for(;a.length;)a.shift()();l=!1}).catch(e=>setTimeout(()=>{throw e})))},reset:()=>{i.setState(i.initialState)},setOptions:e=>{const t=jX(e,i.options);i.options=(e=>i.options.mergeOptions?i.options.mergeOptions(o,e):{...o,...e})(t)},getState:()=>i.options.state,setState:e=>{null==i.options.onStateChange||i.options.onStateChange(e)},_getRowId:(e,t,n)=>{var r;return null!=(r=null==i.options.getRowId?void 0:i.options.getRowId(e,t,n))?r:`${n?[n.id,t].join("."):t}`},getCoreRowModel:()=>(i._getCoreRowModel||(i._getCoreRowModel=i.options.getCoreRowModel(i)),i._getCoreRowModel()),getRowModel:()=>i.getPaginationRowModel(),getRow:(e,t)=>{let n=(t?i.getPrePaginationRowModel():i.getRowModel()).rowsById[e];if(!n&&(n=i.getCoreRowModel().rowsById[e],!n))throw new Error;return n},_getDefaultColumnDef:KX(()=>[i.options.defaultColumn],e=>{var t;return e=null!=(t=e)?t:{},{header:e=>{const t=e.header.column.columnDef;return t.accessorKey?t.accessorKey:t.accessorFn?t.id:null},cell:e=>{var t,n;return null!=(t=null==(n=e.renderValue())||null==n.toString?void 0:n.toString())?t:null},...i._features.reduce((e,t)=>Object.assign(e,null==t.getDefaultColumnDef?void 0:t.getDefaultColumnDef()),{}),...e}},YX(e,"debugColumns")),_getColumnDefs:()=>i.options.columns,getAllColumns:KX(()=>[i._getColumnDefs()],e=>{const t=function(e,n,r){return void 0===r&&(r=0),e.map(e=>{const o=function(e,t,n,r){var i,o;const s={...e._getDefaultColumnDef(),...t},a=s.accessorKey;let l,c=null!=(i=null!=(o=s.id)?o:a?"function"===typeof String.prototype.replaceAll?a.replaceAll(".","_"):a.replace(/\./g,"_"):void 0)?i:"string"===typeof s.header?s.header:void 0;if(s.accessorFn?l=s.accessorFn:a&&(l=a.includes(".")?e=>{let t=e;for(const r of a.split(".")){var n;t=null==(n=t)?void 0:n[r]}return t}:e=>e[s.accessorKey]),!c)throw new Error;let u={id:`${String(c)}`,accessorFn:l,parent:r,depth:n,columnDef:s,columns:[],getFlatColumns:KX(()=>[!0],()=>{var e;return[u,...null==(e=u.columns)?void 0:e.flatMap(e=>e.getFlatColumns())]},YX(e.options,"debugColumns")),getLeafColumns:KX(()=>[e._getOrderColumnsFn()],e=>{var t;if(null!=(t=u.columns)&&t.length){let t=u.columns.flatMap(e=>e.getLeafColumns());return e(t)}return[u]},YX(e.options,"debugColumns"))};for(const d of e._features)null==d.createColumn||d.createColumn(u,e);return u}(i,e,r,n),s=e;return o.columns=s.columns?t(s.columns,o,r+1):[],o})};return t(e)},YX(e,"debugColumns")),getAllFlatColumns:KX(()=>[i.getAllColumns()],e=>e.flatMap(e=>e.getFlatColumns()),YX(e,"debugColumns")),_getAllFlatColumnsById:KX(()=>[i.getAllFlatColumns()],e=>e.reduce((e,t)=>(e[t.id]=t,e),{}),YX(e,"debugColumns")),getAllLeafColumns:KX(()=>[i.getAllColumns(),i._getOrderColumnsFn()],(e,t)=>{let n=e.flatMap(e=>e.getLeafColumns());return t(n)},YX(e,"debugColumns")),getColumn:e=>i._getAllFlatColumnsById()[e]};Object.assign(i,c);for(let u=0;u<i._features.length;u++){const e=i._features[u];null==e||null==e.createTable||e.createTable(i)}return i}function zQ(e,t,n){return n.options.filterFromLeafRows?function(e,t,n){var r;const i=[],o={},s=null!=(r=n.options.maxLeafRowFilterDepth)?r:100,a=function(e,r){void 0===r&&(r=0);const l=[];for(let u=0;u<e.length;u++){var c;let d=e[u];const h=ZX(n,d.id,d.original,d.index,d.depth,void 0,d.parentId);if(h.columnFilters=d.columnFilters,null!=(c=d.subRows)&&c.length&&r<s){if(h.subRows=a(d.subRows,r+1),d=h,t(d)&&!h.subRows.length){l.push(d),o[d.id]=d,i.push(d);continue}if(t(d)||h.subRows.length){l.push(d),o[d.id]=d,i.push(d);continue}}else d=h,t(d)&&(l.push(d),o[d.id]=d,i.push(d))}return l};return{rows:a(e),flatRows:i,rowsById:o}}(e,t,n):function(e,t,n){var r;const i=[],o={},s=null!=(r=n.options.maxLeafRowFilterDepth)?r:100,a=function(e,r){void 0===r&&(r=0);const l=[];for(let u=0;u<e.length;u++){let d=e[u];if(t(d)){var c;if(null!=(c=d.subRows)&&c.length&&r<s){const e=ZX(n,d.id,d.original,d.index,d.depth,void 0,d.parentId);e.subRows=a(d.subRows,r+1),d=e}l.push(d),i.push(d),o[d.id]=d}}return l};return{rows:a(e),flatRows:i,rowsById:o}}(e,t,n)}function jQ(e,n){return e?function(e){return"function"===typeof e&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}(r=e)||"function"===typeof r||function(e){return"object"===typeof e&&"symbol"===typeof e.$$typeof&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}(r)?t.createElement(e,n):e:null;var r}const GQ=e=>{let{data:n,onDataChange:r}=e;const[i,o]=(0,t.useState)([]),[s,a]=(0,t.useState)([]),[l,c]=(0,t.useState)(null),[u,d]=(0,t.useState)(""),[h,p]=(0,t.useState)(null),[g,f]=(0,t.useState)(!1),m=((0,t.useRef)(null),{accessor:(e,t)=>"function"===typeof e?{...t,accessorFn:e}:{...t,accessorKey:e},display:e=>e,group:e=>e}),v=(0,t.useCallback)((e,t,n)=>{if(!h)return!1;const{startRow:r,endRow:i,startCol:o,endCol:s}=h,a=n.indexOf(o),l=n.indexOf(s),c=n.indexOf(t),u=Math.min(r,i),d=Math.max(r,i),p=Math.min(a,l),g=Math.max(a,l);return e>=u&&e<=d&&c>=p&&c<=g},[h]),w=(0,t.useCallback)((e,t,n)=>{0===n.button&&(f(!0),p({startRow:e,startCol:t,endRow:e,endCol:t}),c(null))},[]),b=(0,t.useCallback)((e,t)=>{g&&h&&p({...h,endRow:e,endCol:t})},[g,h]),C=(0,t.useCallback)(()=>{f(!1)},[]);t.useEffect(()=>(document.addEventListener("mouseup",C),()=>{document.removeEventListener("mouseup",C)}),[C]);const y=(0,t.useMemo)(()=>{if(!n||0===n.length)return[];const e=new Set;n.forEach(t=>{Object.keys(t).forEach(t=>e.add(t))});const t=Array.from(e).sort((e,t)=>parseInt(e)-parseInt(t));return t.map(e=>m.accessor(e,{id:e,header:`Column ${e}`,cell:e=>{let{row:i,column:o,getValue:s}=e;const a=s(),h=(null===l||void 0===l?void 0:l.rowIndex)===i.index&&(null===l||void 0===l?void 0:l.columnId)===o.id,p=v(i.index,o.id,t);return(0,MH.jsx)("div",{className:`cell ${h?"editing":""} ${p?"selected":""}`,onMouseDown:e=>w(i.index,o.id,e),onMouseEnter:()=>b(i.index,o.id),onClick:()=>{g||(c({rowIndex:i.index,columnId:o.id}),d((null===a||void 0===a?void 0:a.toString())||""))},children:h?(0,MH.jsx)("input",{type:"text",value:u,onChange:e=>d(e.target.value),onBlur:()=>{const e=[...n];e[i.index]&&(e[i.index]={...e[i.index],[o.id]:u},r(e)),c(null)},onKeyDown:e=>{if("Enter"===e.key){const e=[...n];e[i.index]&&(e[i.index]={...e[i.index],[o.id]:u},r(e)),c(null)}else"Escape"===e.key&&c(null)},autoFocus:!0}):(0,MH.jsx)("span",{children:(null===a||void 0===a?void 0:a.toString())||""})})},enableSorting:!0,enableColumnFilter:!0}))},[n,l,u,m,r,v,w,b,g]),S=(0,t.useCallback)(()=>{if(!h)return[];const{startRow:e,endRow:t,startCol:r,endCol:i}=h,o=new Set;n.forEach(e=>{Object.keys(e).forEach(e=>o.add(e))});const s=Array.from(o).sort((e,t)=>parseInt(e)-parseInt(t)),a=s.indexOf(r),l=s.indexOf(i),c=Math.min(e,t),u=Math.max(e,t),d=Math.min(a,l),p=Math.max(a,l),g=[];for(let h=c;h<=u;h++)for(let e=d;e<=p;e++){const t=s[e];t&&h<n.length&&g.push({rowIndex:h,columnId:t})}return g},[h,n]),x=(0,t.useCallback)(()=>{if(!h)return;const e=S();if(0===e.length)return;const t=[...n];e.forEach(e=>{let{rowIndex:n,columnId:r}=e;t[n]&&(t[n]={...t[n],[r]:""})}),r(t)},[h,S,n,r]);t.useEffect(()=>{const e=e=>{!h||l||"Delete"!==e.key&&"Backspace"!==e.key||(e.preventDefault(),x())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h,l,x]);const R=(0,t.useCallback)(async()=>{try{var e;const t=(e=>e.trim().split("\n").map(e=>e.split("\t")))(await navigator.clipboard.readText());if(0===t.length)return;let i=0,o=(null===(e=y[0])||void 0===e?void 0:e.id)||"0";l&&(i=l.rowIndex,o=l.columnId);const s=y.map(e=>e.id),a=s.indexOf(o),c=a>=0?a:0,u=[...n];t.forEach((e,t)=>{if(i+t>=u.length){const e={};s.forEach(t=>{e[t]=""}),u.push(e)}e.forEach((e,n)=>{const r=s[c+n];r&&u[i+t]&&(u[i+t][r]=e)})}),r(u)}catch(Wn){console.error("Error al pegar datos:",Wn)}},[y,n,l,r]);t.useEffect(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"v"===e.key&&(e.preventDefault(),R())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[R]);const E=(0,t.useCallback)(()=>{const e={};y.forEach(t=>{t.id&&(e[t.id]="")}),r([...n,e])},[n,y,r]),T=(0,t.useCallback)(()=>{const e=Math.max(...n.flatMap(e=>Object.keys(e).map(e=>parseInt(e))),-1)+1,t=n.map(t=>({...t,[e]:""}));r(t)},[n,r]),k=function(e){const n={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=t.useState(()=>({current:WQ(n)})),[i,o]=t.useState(()=>r.current.initialState);return r.current.setOptions(t=>({...t,...e,state:{...i,...e.state},onStateChange:t=>{o(t),null==e.onStateChange||e.onStateChange(t)}})),r.current}({data:n,columns:y,getCoreRowModel:e=>KX(()=>[e.options.data],t=>{const n={rows:[],flatRows:[],rowsById:{}},r=function(t,i,o){void 0===i&&(i=0);const s=[];for(let l=0;l<t.length;l++){const c=ZX(e,e._getRowId(t[l],l,o),t[l],l,i,void 0,null==o?void 0:o.id);var a;n.flatRows.push(c),n.rowsById[c.id]=c,s.push(c),e.options.getSubRows&&(c.originalSubRows=e.options.getSubRows(t[l],l),null!=(a=c.originalSubRows)&&a.length&&(c.subRows=r(c.originalSubRows,i+1,c)))}return s};return n.rows=r(t),n},YX(e.options,"debugTable",0,()=>e._autoResetPageIndex())),getSortedRowModel:e=>KX(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,n)=>{if(!n.rows.length||null==t||!t.length)return n;const r=e.getState().sorting,i=[],o=r.filter(t=>{var n;return null==(n=e.getColumn(t.id))?void 0:n.getCanSort()}),s={};o.forEach(t=>{const n=e.getColumn(t.id);n&&(s[t.id]={sortUndefined:n.columnDef.sortUndefined,invertSorting:n.columnDef.invertSorting,sortingFn:n.getSortingFn()})});const a=e=>{const t=e.map(e=>({...e}));return t.sort((e,t)=>{for(let r=0;r<o.length;r+=1){var n;const i=o[r],a=s[i.id],l=a.sortUndefined,c=null!=(n=null==i?void 0:i.desc)&&n;let u=0;if(l){const n=void 0===e.getValue(i.id),r=void 0===t.getValue(i.id);if(n||r){if("first"===l)return n?-1:1;if("last"===l)return n?1:-1;u=n&&r?0:n?l:-l}}if(0===u&&(u=a.sortingFn(e,t,i.id)),0!==u)return c&&(u*=-1),a.invertSorting&&(u*=-1),u}return e.index-t.index}),t.forEach(e=>{var t;i.push(e),null!=(t=e.subRows)&&t.length&&(e.subRows=a(e.subRows))}),t};return{rows:a(n.rows),flatRows:i,rowsById:n.rowsById}},YX(e.options,"debugTable",0,()=>e._autoResetPageIndex())),getFilteredRowModel:e=>KX(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,n,r)=>{if(!t.rows.length||(null==n||!n.length)&&!r){for(let e=0;e<t.flatRows.length;e++)t.flatRows[e].columnFilters={},t.flatRows[e].columnFiltersMeta={};return t}const i=[],o=[];(null!=n?n:[]).forEach(t=>{var n;const r=e.getColumn(t.id);if(!r)return;const o=r.getFilterFn();o&&i.push({id:t.id,filterFn:o,resolvedValue:null!=(n=null==o.resolveFilterValue?void 0:o.resolveFilterValue(t.value))?n:t.value})});const s=(null!=n?n:[]).map(e=>e.id),a=e.getGlobalFilterFn(),l=e.getAllLeafColumns().filter(e=>e.getCanGlobalFilter());let c,u;r&&a&&l.length&&(s.push("__global__"),l.forEach(e=>{var t;o.push({id:e.id,filterFn:a,resolvedValue:null!=(t=null==a.resolveFilterValue?void 0:a.resolveFilterValue(r))?t:r})}));for(let e=0;e<t.flatRows.length;e++){const n=t.flatRows[e];if(n.columnFilters={},i.length)for(let e=0;e<i.length;e++){c=i[e];const t=c.id;n.columnFilters[t]=c.filterFn(n,t,c.resolvedValue,e=>{n.columnFiltersMeta[t]=e})}if(o.length){for(let e=0;e<o.length;e++){u=o[e];const t=u.id;if(u.filterFn(n,t,u.resolvedValue,e=>{n.columnFiltersMeta[t]=e})){n.columnFilters.__global__=!0;break}}!0!==n.columnFilters.__global__&&(n.columnFilters.__global__=!1)}}return zQ(t.rows,e=>{for(let t=0;t<s.length;t++)if(!1===e.columnFilters[s[t]])return!1;return!0},e)},YX(e.options,"debugTable",0,()=>e._autoResetPageIndex())),onSortingChange:o,onColumnFiltersChange:a,state:{sorting:i,columnFilters:s}});return(0,MH.jsxs)("div",{className:"react-table-spreadsheet-container",children:[(0,MH.jsxs)("div",{className:"react-table-header",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcca React Table Spreadsheet"}),(0,MH.jsxs)("div",{className:"react-table-features",children:[(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udd04 Real-time Editing"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udd0d Sorting & Filtering"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\udcc8 Lightweight"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83c\udfa8 Customizable"}),(0,MH.jsx)("span",{className:"feature-badge",children:"\ud83d\uddd1\ufe0f Delete Selection"})]})]}),(0,MH.jsxs)("div",{className:"react-table-controls",children:[(0,MH.jsx)("button",{className:"control-btn add-row-btn",onClick:E,children:"\u2795 Add Row"}),(0,MH.jsx)("button",{className:"control-btn add-column-btn",onClick:T,children:"\u2795 Add Column"}),(0,MH.jsx)("button",{className:"control-btn clear-selection-btn",onClick:x,disabled:!h,children:"\ud83d\uddd1\ufe0f Clear Selection"})]}),(0,MH.jsx)("div",{className:"react-table-wrapper",children:(0,MH.jsxs)("table",{className:"react-table",children:[(0,MH.jsx)("thead",{children:k.getHeaderGroups().map(e=>(0,MH.jsx)("tr",{children:e.headers.map(e=>{var t;return(0,MH.jsx)("th",{className:"table-header",onClick:e.column.getToggleSortingHandler(),children:(0,MH.jsxs)("div",{className:"header-content",children:[jQ(e.column.columnDef.header,e.getContext()),(0,MH.jsx)("div",{className:"sort-indicator",children:null!==(t={asc:" \ud83d\udd3c",desc:" \ud83d\udd3d"}[e.column.getIsSorted()])&&void 0!==t?t:null})]})},e.id)})},e.id))}),(0,MH.jsx)("tbody",{children:k.getRowModel().rows.map(e=>(0,MH.jsx)("tr",{className:"table-row",children:e.getVisibleCells().map(e=>(0,MH.jsx)("td",{className:"table-cell",children:jQ(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]})}),(0,MH.jsxs)("div",{className:"react-table-info",children:[(0,MH.jsx)("h4",{children:"\ud83c\udfaf React Table Features"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Lightweight:"})," Minimal bundle size with maximum flexibility"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Headless Design:"})," Complete control over styling and behavior"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"TypeScript Support:"})," Excellent type safety and IntelliSense"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Customizable:"})," Build exactly what you need"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Performance:"})," Optimized for large datasets"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Multi-Cell Selection:"})," Click and drag to select multiple cells like Excel"]}),(0,MH.jsxs)("li",{children:[(0,MH.jsx)("strong",{children:"Delete Selection:"})," Press Delete/Backspace or use the button to clear selected cells"]})]})]}),(0,MH.jsxs)("div",{className:"debug-info",children:[(0,MH.jsx)("p",{children:(0,MH.jsx)("strong",{children:"Debug Info:"})}),(0,MH.jsxs)("p",{children:["Row Count: ",n.length]}),(0,MH.jsxs)("p",{children:["Column Count: ",y.length]}),(0,MH.jsxs)("p",{children:["Editing Cell: ",l?`${l.rowIndex}, ${l.columnId}`:"None"]}),(0,MH.jsxs)("p",{children:["Selection: ",h?`${h.startRow},${h.startCol} to ${h.endRow},${h.endCol}`:"None"]}),(0,MH.jsxs)("p",{children:["Selected Cells: ",S().length]}),(0,MH.jsxs)("p",{children:["Sorting: ",i.length>0?i.map(e=>`${e.id} ${e.desc?"desc":"asc"}`).join(", "):"None"]})]})]})};function $Q(){return $Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},$Q.apply(null,arguments)}var UQ=n(5173);const KQ=parseInt(t.version,10),YQ=e=>{if(KQ>=19){const t=t=>e(t,t.ref??null);return t.displayName=e.displayName??e.name,t}return t.forwardRef(e)};function qQ(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}function XQ(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=XQ(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}const QQ=function(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=XQ(e))&&(r&&(r+=" "),r+=t);return r};function JQ(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=t.useRef(void 0),o=t.useCallback(e=>{const t=n.map(t=>{if(null==t)return null;if("function"===typeof t){const n=t,r=n(e);return"function"===typeof r?r:()=>{n(null)}}return t.current=e,()=>{t.current=null}});return()=>{t.forEach(e=>e?.())}},n);return t.useMemo(()=>n.every(e=>null==e)?null:e=>{i.current&&(i.current(),i.current=void 0),null!=e&&(i.current=o(e))},n)}function ZQ(e){const t=new URL(`https://mui.com/production-error/?code=${e}`);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(e=>t.searchParams.append("args[]",e)),`Minified MUI error #${e}; visit ${t} for the full message.`}function eJ(e){if("string"!==typeof e)throw new Error(ZQ(7));return e.charAt(0).toUpperCase()+e.slice(1)}function tJ(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;const r={};for(const i in e){const o=e[i];let s="",a=!0;for(let e=0;e<o.length;e+=1){const r=o[e];r&&(s+=(!0===a?"":" ")+t(r),a=!1,n&&n[r]&&(s+=" "+n[r]))}r[i]=s}return r}const nJ=Object.is;function rJ(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;let n=0,r=0;for(const i in e){if(n+=1,!nJ(e[i],t[i]))return!1;if(!(i in t))return!1}for(const i in t)r+=1;return n===r}function iJ(e){return t.memo(e,rJ)}var oJ=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(r){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),sJ=Math.abs,aJ=String.fromCharCode,lJ=Object.assign;function cJ(e){return e.trim()}function uJ(e,t,n){return e.replace(t,n)}function dJ(e,t){return e.indexOf(t)}function hJ(e,t){return 0|e.charCodeAt(t)}function pJ(e,t,n){return e.slice(t,n)}function gJ(e){return e.length}function fJ(e){return e.length}function mJ(e,t){return t.push(e),e}var vJ=1,wJ=1,bJ=0,CJ=0,yJ=0,SJ="";function xJ(e,t,n,r,i,o,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:vJ,column:wJ,length:s,return:""}}function RJ(e,t){return lJ(xJ("",null,null,"",null,null,0),e,{length:-e.length},t)}function EJ(){return yJ=CJ>0?hJ(SJ,--CJ):0,wJ--,10===yJ&&(wJ=1,vJ--),yJ}function TJ(){return yJ=CJ<bJ?hJ(SJ,CJ++):0,wJ++,10===yJ&&(wJ=1,vJ++),yJ}function kJ(){return hJ(SJ,CJ)}function MJ(){return CJ}function PJ(e,t){return pJ(SJ,e,t)}function IJ(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function AJ(e){return vJ=wJ=1,bJ=gJ(SJ=e),CJ=0,[]}function DJ(e){return SJ="",e}function FJ(e){return cJ(PJ(CJ-1,LJ(91===e?e+2:40===e?e+1:e)))}function OJ(e){for(;(yJ=kJ())&&yJ<33;)TJ();return IJ(e)>2||IJ(yJ)>3?"":" "}function NJ(e,t){for(;--t&&TJ()&&!(yJ<48||yJ>102||yJ>57&&yJ<65||yJ>70&&yJ<97););return PJ(e,MJ()+(t<6&&32==kJ()&&32==TJ()))}function LJ(e){for(;TJ();)switch(yJ){case e:return CJ;case 34:case 39:34!==e&&39!==e&&LJ(yJ);break;case 40:41===e&&LJ(e);break;case 92:TJ()}return CJ}function _J(e,t){for(;TJ()&&e+yJ!==57&&(e+yJ!==84||47!==kJ()););return"/*"+PJ(t,CJ-1)+"*"+aJ(47===e?e:TJ())}function HJ(e){for(;!IJ(kJ());)TJ();return PJ(e,CJ)}var VJ="-ms-",BJ="-moz-",WJ="-webkit-",zJ="comm",jJ="rule",GJ="decl",$J="@keyframes";function UJ(e,t){for(var n="",r=fJ(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function KJ(e,t,n,r){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case GJ:return e.return=e.return||e.value;case zJ:return"";case $J:return e.return=e.value+"{"+UJ(e.children,r)+"}";case jJ:e.value=e.props.join(",")}return gJ(n=UJ(e.children,r))?e.return=e.value+"{"+n+"}":""}function YJ(e){return function(t){t.root||(t=t.return)&&e(t)}}function qJ(e){return DJ(XJ("",null,null,null,[""],e=AJ(e),0,[0],e))}function XJ(e,t,n,r,i,o,s,a,l){for(var c=0,u=0,d=s,h=0,p=0,g=0,f=1,m=1,v=1,w=0,b="",C=i,y=o,S=r,x=b;m;)switch(g=w,w=TJ()){case 40:if(108!=g&&58==hJ(x,d-1)){-1!=dJ(x+=uJ(FJ(w),"&","&\f"),"&\f")&&(v=-1);break}case 34:case 39:case 91:x+=FJ(w);break;case 9:case 10:case 13:case 32:x+=OJ(g);break;case 92:x+=NJ(MJ()-1,7);continue;case 47:switch(kJ()){case 42:case 47:mJ(JJ(_J(TJ(),MJ()),t,n),l);break;default:x+="/"}break;case 123*f:a[c++]=gJ(x)*v;case 125*f:case 59:case 0:switch(w){case 0:case 125:m=0;case 59+u:-1==v&&(x=uJ(x,/\f/g,"")),p>0&&gJ(x)-d&&mJ(p>32?ZJ(x+";",r,n,d-1):ZJ(uJ(x," ","")+";",r,n,d-2),l);break;case 59:x+=";";default:if(mJ(S=QJ(x,t,n,c,u,i,a,b,C=[],y=[],d),o),123===w)if(0===u)XJ(x,t,S,S,C,o,d,a,y);else switch(99===h&&110===hJ(x,3)?100:h){case 100:case 108:case 109:case 115:XJ(e,S,S,r&&mJ(QJ(e,S,S,0,0,i,a,b,i,C=[],d),y),i,y,d,a,r?C:y);break;default:XJ(x,S,S,S,[""],y,0,a,y)}}c=u=p=0,f=v=1,b=x="",d=s;break;case 58:d=1+gJ(x),p=g;default:if(f<1)if(123==w)--f;else if(125==w&&0==f++&&125==EJ())continue;switch(x+=aJ(w),w*f){case 38:v=u>0?1:(x+="\f",-1);break;case 44:a[c++]=(gJ(x)-1)*v,v=1;break;case 64:45===kJ()&&(x+=FJ(TJ())),h=kJ(),u=d=gJ(b=x+=HJ(MJ())),w++;break;case 45:45===g&&2==gJ(x)&&(f=0)}}return o}function QJ(e,t,n,r,i,o,s,a,l,c,u){for(var d=i-1,h=0===i?o:[""],p=fJ(h),g=0,f=0,m=0;g<r;++g)for(var v=0,w=pJ(e,d+1,d=sJ(f=s[g])),b=e;v<p;++v)(b=cJ(f>0?h[v]+" "+w:uJ(w,/&\f/g,h[v])))&&(l[m++]=b);return xJ(e,t,n,0===i?jJ:a,l,c,u)}function JJ(e,t,n){return xJ(e,t,n,zJ,aJ(yJ),pJ(e,2,-2),0)}function ZJ(e,t,n,r){return xJ(e,t,n,GJ,pJ(e,0,r),pJ(e,r+1,-1),r)}var eZ=function(e,t,n){for(var r=0,i=0;r=i,i=kJ(),38===r&&12===i&&(t[n]=1),!IJ(i);)TJ();return PJ(e,CJ)},tZ=function(e,t){return DJ(function(e,t){var n=-1,r=44;do{switch(IJ(r)){case 0:38===r&&12===kJ()&&(t[n]=1),e[n]+=eZ(CJ-1,t,n);break;case 2:e[n]+=FJ(r);break;case 4:if(44===r){e[++n]=58===kJ()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=aJ(r)}}while(r=TJ());return e}(AJ(e),t))},nZ=new WeakMap,rZ=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||nZ.get(n))&&!r){nZ.set(e,!0);for(var i=[],o=tZ(t,i),s=n.props,a=0,l=0;a<o.length;a++)for(var c=0;c<s.length;c++,l++)e.props[l]=i[a]?o[a].replace(/&\f/g,s[c]):s[c]+" "+o[a]}}},iZ=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function oZ(e,t){switch(function(e,t){return 45^hJ(e,0)?(((t<<2^hJ(e,0))<<2^hJ(e,1))<<2^hJ(e,2))<<2^hJ(e,3):0}(e,t)){case 5103:return WJ+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WJ+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return WJ+e+BJ+e+VJ+e+e;case 6828:case 4268:return WJ+e+VJ+e+e;case 6165:return WJ+e+VJ+"flex-"+e+e;case 5187:return WJ+e+uJ(e,/(\w+).+(:[^]+)/,WJ+"box-$1$2"+VJ+"flex-$1$2")+e;case 5443:return WJ+e+VJ+"flex-item-"+uJ(e,/flex-|-self/,"")+e;case 4675:return WJ+e+VJ+"flex-line-pack"+uJ(e,/align-content|flex-|-self/,"")+e;case 5548:return WJ+e+VJ+uJ(e,"shrink","negative")+e;case 5292:return WJ+e+VJ+uJ(e,"basis","preferred-size")+e;case 6060:return WJ+"box-"+uJ(e,"-grow","")+WJ+e+VJ+uJ(e,"grow","positive")+e;case 4554:return WJ+uJ(e,/([^-])(transform)/g,"$1"+WJ+"$2")+e;case 6187:return uJ(uJ(uJ(e,/(zoom-|grab)/,WJ+"$1"),/(image-set)/,WJ+"$1"),e,"")+e;case 5495:case 3959:return uJ(e,/(image-set\([^]*)/,WJ+"$1$`$1");case 4968:return uJ(uJ(e,/(.+:)(flex-)?(.*)/,WJ+"box-pack:$3"+VJ+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WJ+e+e;case 4095:case 3583:case 4068:case 2532:return uJ(e,/(.+)-inline(.+)/,WJ+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(gJ(e)-1-t>6)switch(hJ(e,t+1)){case 109:if(45!==hJ(e,t+4))break;case 102:return uJ(e,/(.+:)(.+)-([^]+)/,"$1"+WJ+"$2-$3$1"+BJ+(108==hJ(e,t+3)?"$3":"$2-$3"))+e;case 115:return~dJ(e,"stretch")?oZ(uJ(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==hJ(e,t+1))break;case 6444:switch(hJ(e,gJ(e)-3-(~dJ(e,"!important")&&10))){case 107:return uJ(e,":",":"+WJ)+e;case 101:return uJ(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WJ+(45===hJ(e,14)?"inline-":"")+"box$3$1"+WJ+"$2$3$1"+VJ+"$2box$3")+e}break;case 5936:switch(hJ(e,t+11)){case 114:return WJ+e+VJ+uJ(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return WJ+e+VJ+uJ(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return WJ+e+VJ+uJ(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return WJ+e+VJ+e+e}return e}var sZ=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case GJ:e.return=oZ(e.value,e.length);break;case $J:return UJ([RJ(e,{value:uJ(e.value,"@","@"+WJ)})],r);case jJ:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return UJ([RJ(e,{props:[uJ(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return UJ([RJ(e,{props:[uJ(t,/:(plac\w+)/,":"+WJ+"input-$1")]}),RJ(e,{props:[uJ(t,/:(plac\w+)/,":-moz-$1")]}),RJ(e,{props:[uJ(t,/:(plac\w+)/,VJ+"input-$1")]})],r)}return""})}}],aZ=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var r,i,o=e.stylisPlugins||sZ,s={},a=[];r=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)s[t[n]]=!0;a.push(e)});var l,c=[rZ,iZ],u=[KJ,YJ(function(e){l.insert(e)})],d=function(e){var t=fJ(e);return function(n,r,i,o){for(var s="",a=0;a<t;a++)s+=e[a](n,r,i,o)||"";return s}}(c.concat(o,u));i=function(e,t,n,r){l=n,function(e){UJ(qJ(e),d)}(e?e+"{"+t.styles+"}":t.styles),r&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new oJ({key:t,container:r,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:i};return h.sheet.hydrate(a),h};function lZ(e,t,n){var r="";return n.split(" ").forEach(function(n){void 0!==e[n]?t.push(e[n]+";"):n&&(r+=n+" ")}),r}var cZ=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},uZ=function(e,t,n){cZ(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do{e.insert(t===i?"."+r:"",i,e.sheet,!0),i=i.next}while(void 0!==i)}};var dZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function hZ(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var pZ=/[A-Z]|^ms/g,gZ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,fZ=function(e){return 45===e.charCodeAt(1)},mZ=function(e){return null!=e&&"boolean"!==typeof e},vZ=hZ(function(e){return fZ(e)?e:e.replace(pZ,"-$&").toLowerCase()}),wZ=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(gZ,function(e,t,n){return CZ={name:t,styles:n,next:CZ},t})}return 1===dZ[e]||fZ(e)||"number"!==typeof t||0===t?t:t+"px"};function bZ(e,t,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var i=n;if(1===i.anim)return CZ={name:i.name,styles:i.styles,next:CZ},i.name;var o=n;if(void 0!==o.styles){var s=o.next;if(void 0!==s)for(;void 0!==s;)CZ={name:s.name,styles:s.styles,next:CZ},s=s.next;return o.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=bZ(e,t,n[i])+";";else for(var o in n){var s=n[o];if("object"!==typeof s){var a=s;null!=t&&void 0!==t[a]?r+=o+"{"+t[a]+"}":mZ(a)&&(r+=vZ(o)+":"+wZ(o,a)+";")}else if(!Array.isArray(s)||"string"!==typeof s[0]||null!=t&&void 0!==t[s[0]]){var l=bZ(e,t,s);switch(o){case"animation":case"animationName":r+=vZ(o)+":"+l+";";break;default:r+=o+"{"+l+"}"}}else for(var c=0;c<s.length;c++)mZ(s[c])&&(r+=vZ(o)+":"+wZ(o,s[c])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=CZ,l=n(e);return CZ=a,bZ(e,t,l)}}var c=n;if(null==t)return c;var u=t[c];return void 0!==u?u:c}var CZ,yZ=/label:\s*([^\s;{]+)\s*(;|$)/g;function SZ(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";CZ=void 0;var o=e[0];null==o||void 0===o.raw?(r=!1,i+=bZ(n,t,o)):i+=o[0];for(var s=1;s<e.length;s++){if(i+=bZ(n,t,e[s]),r)i+=o[s]}yZ.lastIndex=0;for(var a,l="";null!==(a=yZ.exec(i));)l+="-"+a[1];var c=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(i)+l;return{name:c,styles:i,next:CZ}}var xZ=!!r.useInsertionEffect&&r.useInsertionEffect,RZ=xZ||function(e){return e()},EZ=xZ||t.useLayoutEffect,TZ=t.createContext("undefined"!==typeof HTMLElement?aZ({key:"css"}):null),kZ=(TZ.Provider,function(e){return(0,t.forwardRef)(function(n,r){var i=(0,t.useContext)(TZ);return e(n,i,r)})}),MZ=t.createContext({});var PZ={}.hasOwnProperty,IZ="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",AZ=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return cZ(t,n,r),RZ(function(){return uZ(t,n,r)}),null},DZ=kZ(function(e,n,r){var i=e.css;"string"===typeof i&&void 0!==n.registered[i]&&(i=n.registered[i]);var o=e[IZ],s=[i],a="";"string"===typeof e.className?a=lZ(n.registered,s,e.className):null!=e.className&&(a=e.className+" ");var l=SZ(s,void 0,t.useContext(MZ));a+=n.key+"-"+l.name;var c={};for(var u in e)PZ.call(e,u)&&"css"!==u&&u!==IZ&&(c[u]=e[u]);return c.className=a,r&&(c.ref=r),t.createElement(t.Fragment,null,t.createElement(AZ,{cache:n,serialized:l,isStringTag:"string"===typeof o}),t.createElement(o,c))}),FZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,OZ=hZ(function(e){return FZ.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}),NZ=function(e){return"theme"!==e},LZ=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?OZ:NZ},_Z=function(e,t,n){var r;if(t){var i=t.shouldForwardProp;r=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},HZ=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;return cZ(t,n,r),RZ(function(){return uZ(t,n,r)}),null},VZ=function e(n,r){var i,o,s=n.__emotion_real===n,a=s&&n.__emotion_base||n;void 0!==r&&(i=r.label,o=r.target);var l=_Z(n,r,s),c=l||LZ(a),u=!c("as");return function(){var d=arguments,h=s&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==i&&h.push("label:"+i+";"),null==d[0]||void 0===d[0].raw)h.push.apply(h,d);else{var p=d[0];h.push(p[0]);for(var g=d.length,f=1;f<g;f++)h.push(d[f],p[f])}var m=kZ(function(e,n,r){var i=u&&e.as||a,s="",d=[],p=e;if(null==e.theme){for(var g in p={},e)p[g]=e[g];p.theme=t.useContext(MZ)}"string"===typeof e.className?s=lZ(n.registered,d,e.className):null!=e.className&&(s=e.className+" ");var f=SZ(h.concat(d),n.registered,p);s+=n.key+"-"+f.name,void 0!==o&&(s+=" "+o);var m=u&&void 0===l?LZ(i):c,v={};for(var w in e)u&&"as"===w||m(w)&&(v[w]=e[w]);return v.className=s,r&&(v.ref=r),t.createElement(t.Fragment,null,t.createElement(HZ,{cache:n,serialized:f,isStringTag:"string"===typeof i}),t.createElement(i,v))});return m.displayName=void 0!==i?i:"Styled("+("string"===typeof a?a:a.displayName||a.name||"Component")+")",m.defaultProps=n.defaultProps,m.__emotion_real=m,m.__emotion_base=a,m.__emotion_styles=h,m.__emotion_forwardProp=l,Object.defineProperty(m,"toString",{value:function(){return"."+o}}),m.withComponent=function(t,n){return e(t,$Q({},r,n,{shouldForwardProp:_Z(m,n,!0)})).apply(void 0,h)},m}}.bind(null);function BZ(e,t){return VZ(e,t)}["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(e){VZ[e]=VZ(e)});const WZ=[];function zZ(e){return WZ[0]=e,SZ(WZ)}var jZ=n(191);function GZ(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function $Z(e){if(t.isValidElement(e)||(0,jZ.Hy)(e)||!GZ(e))return e;const n={};return Object.keys(e).forEach(t=>{n[t]=$Z(e[t])}),n}function UZ(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0};const i=r.clone?{...e}:e;return GZ(e)&&GZ(n)&&Object.keys(n).forEach(o=>{t.isValidElement(n[o])||(0,jZ.Hy)(n[o])?i[o]=n[o]:GZ(n[o])&&Object.prototype.hasOwnProperty.call(e,o)&&GZ(e[o])?i[o]=UZ(e[o],n[o],r):r.clone?i[o]=GZ(n[o])?$Z(n[o]):n[o]:i[o]=n[o]}),i}function KZ(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=e,o=(e=>{const t=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return t.sort((e,t)=>e.val-t.val),t.reduce((e,t)=>({...e,[t.key]:t.val}),{})})(t),s=Object.keys(o);function a(e){return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n})`}function l(e){return`@media (max-width:${("number"===typeof t[e]?t[e]:e)-r/100}${n})`}function c(e,i){const o=s.indexOf(i);return`@media (min-width:${"number"===typeof t[e]?t[e]:e}${n}) and (max-width:${(-1!==o&&"number"===typeof t[s[o]]?t[s[o]]:i)-r/100}${n})`}return{keys:s,values:o,up:a,down:l,between:c,only:function(e){return s.indexOf(e)+1<s.length?c(e,s[s.indexOf(e)+1]):a(e)},not:function(e){const t=s.indexOf(e);return 0===t?a(s[1]):t===s.length-1?l(s[t]):c(e,s[s.indexOf(e)+1]).replace("@media","@media not all and")},unit:n,...i}}function YZ(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(e=>e.startsWith("@container")).sort((e,t)=>{const n=/min-width:\s*([0-9.]+)/;return+(e.match(n)?.[1]||0)-+(t.match(n)?.[1]||0)});return n.length?n.reduce((e,n)=>{const r=t[n];return delete e[n],e[n]=r,e},{...t}):t}const qZ={borderRadius:4},XZ={xs:0,sm:600,md:900,lg:1200,xl:1536},QZ={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${XZ[e]}px)`},JZ={containerQueries:e=>({up:t=>{let n="number"===typeof t?t:XZ[t]||t;return"number"===typeof n&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function ZZ(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const e=r.breakpoints||QZ;return t.reduce((r,i,o)=>(r[e.up(e.keys[o])]=n(t[o]),r),{})}if("object"===typeof t){const e=r.breakpoints||QZ;return Object.keys(t).reduce((i,o)=>{if(function(e,t){return"@"===t||t.startsWith("@")&&(e.some(e=>t.startsWith(`@${e}`))||!!t.match(/^@\d/))}(e.keys,o)){const e=function(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,o=Number.isNaN(+r)?r||0:+r;return e.containerQueries(i).up(o)}(r.containerQueries?r:JZ,o);e&&(i[e]=n(t[o],o))}else if(Object.keys(e.values||XZ).includes(o)){i[e.up(o)]=n(t[o],o)}else{const e=o;i[e]=t[e]}return i},{})}return n(t)}function e0(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.keys?.reduce((t,n)=>(t[e.up(n)]={},t),{});return t||{}}function t0(e,t){return e.reduce((e,t)=>{const n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e},t)}function n0(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){const n=`vars.${t}`.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,e);if(null!=n)return n}return t.split(".").reduce((e,t)=>e&&null!=e[t]?e[t]:null,e)}function r0(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||i:n0(e,n)||i,t&&(r=t(r,i,e)),r}const i0=function(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,o=e=>{if(null==e[t])return null;const o=e[t],s=n0(e.theme,r)||{};return ZZ(e,o,e=>{let r=r0(s,i,e);return e===r&&"string"===typeof e&&(r=r0(s,i,`${t}${"default"===e?"":eJ(e)}`,e)),!1===n?r:{[n]:r}})};return o.propTypes={},o.filterProps=[t],o};const o0=function(e,t){return t?UZ(e,t,{clone:!1}):e};const s0={m:"margin",p:"padding"},a0={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l0={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c0=function(e){const t={};return n=>(void 0===t[n]&&(t[n]=e(n)),t[n])}(e=>{if(e.length>2){if(!l0[e])return[e];e=l0[e]}const[t,n]=e.split(""),r=s0[t],i=a0[n]||"";return Array.isArray(i)?i.map(e=>r+e):[r+i]}),u0=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],d0=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],h0=[...u0,...d0];function p0(e,t,n,r){const i=n0(e,t,!0)??n;return"number"===typeof i||"string"===typeof i?e=>"string"===typeof e?e:"string"===typeof i?i.startsWith("var(")&&0===e?0:i.startsWith("var(")&&1===e?i:`calc(${e} * ${i})`:i*e:Array.isArray(i)?e=>{if("string"===typeof e)return e;const t=Math.abs(e);const n=i[t];return e>=0?n:"number"===typeof n?-n:"string"===typeof n&&n.startsWith("var(")?`calc(-1 * ${n})`:`-${n}`}:"function"===typeof i?i:()=>{}}function g0(e){return p0(e,"spacing",8)}function f0(e,t){return"string"===typeof t||null==t?t:e(t)}function m0(e,t,n,r){if(!t.includes(n))return null;const i=function(e,t){return n=>e.reduce((e,r)=>(e[r]=f0(t,n),e),{})}(c0(n),r);return ZZ(e,e[n],i)}function v0(e,t){const n=g0(e.theme);return Object.keys(e).map(r=>m0(e,t,r,n)).reduce(o0,{})}function w0(e){return v0(e,u0)}function b0(e){return v0(e,d0)}function C0(e){return v0(e,h0)}w0.propTypes={},w0.filterProps=u0,b0.propTypes={},b0.filterProps=d0,C0.propTypes={},C0.filterProps=h0;function y0(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g0({spacing:e});if(e.mui)return e;const n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(0===n.length?[1]:n).map(e=>{const n=t(e);return"number"===typeof n?`${n}px`:n}).join(" ")};return n.mui=!0,n}const S0=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce((e,t)=>(t.filterProps.forEach(n=>{e[n]=t}),e),{}),i=e=>Object.keys(e).reduce((t,n)=>r[n]?o0(t,r[n](e)):t,{});return i.propTypes={},i.filterProps=t.reduce((e,t)=>e.concat(t.filterProps),[]),i};function x0(e){return"number"!==typeof e?e:`${e}px solid`}function R0(e,t){return i0({prop:e,themeKey:"borders",transform:t})}const E0=R0("border",x0),T0=R0("borderTop",x0),k0=R0("borderRight",x0),M0=R0("borderBottom",x0),P0=R0("borderLeft",x0),I0=R0("borderColor"),A0=R0("borderTopColor"),D0=R0("borderRightColor"),F0=R0("borderBottomColor"),O0=R0("borderLeftColor"),N0=R0("outline",x0),L0=R0("outlineColor"),_0=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){const t=p0(e.theme,"shape.borderRadius",4),n=e=>({borderRadius:f0(t,e)});return ZZ(e,e.borderRadius,n)}return null};_0.propTypes={},_0.filterProps=["borderRadius"];S0(E0,T0,k0,M0,P0,I0,A0,D0,F0,O0,_0,N0,L0);const H0=e=>{if(void 0!==e.gap&&null!==e.gap){const t=p0(e.theme,"spacing",8),n=e=>({gap:f0(t,e)});return ZZ(e,e.gap,n)}return null};H0.propTypes={},H0.filterProps=["gap"];const V0=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){const t=p0(e.theme,"spacing",8),n=e=>({columnGap:f0(t,e)});return ZZ(e,e.columnGap,n)}return null};V0.propTypes={},V0.filterProps=["columnGap"];const B0=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){const t=p0(e.theme,"spacing",8),n=e=>({rowGap:f0(t,e)});return ZZ(e,e.rowGap,n)}return null};B0.propTypes={},B0.filterProps=["rowGap"];S0(H0,V0,B0,i0({prop:"gridColumn"}),i0({prop:"gridRow"}),i0({prop:"gridAutoFlow"}),i0({prop:"gridAutoColumns"}),i0({prop:"gridAutoRows"}),i0({prop:"gridTemplateColumns"}),i0({prop:"gridTemplateRows"}),i0({prop:"gridTemplateAreas"}),i0({prop:"gridArea"}));function W0(e,t){return"grey"===t?t:e}S0(i0({prop:"color",themeKey:"palette",transform:W0}),i0({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:W0}),i0({prop:"backgroundColor",themeKey:"palette",transform:W0}));function z0(e){return e<=1&&0!==e?100*e+"%":e}const j0=i0({prop:"width",transform:z0}),G0=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){const t=t=>{const n=e.theme?.breakpoints?.values?.[t]||XZ[t];return n?"px"!==e.theme?.breakpoints?.unit?{maxWidth:`${n}${e.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:z0(t)}};return ZZ(e,e.maxWidth,t)}return null};G0.filterProps=["maxWidth"];const $0=i0({prop:"minWidth",transform:z0}),U0=i0({prop:"height",transform:z0}),K0=i0({prop:"maxHeight",transform:z0}),Y0=i0({prop:"minHeight",transform:z0}),q0=(i0({prop:"size",cssProperty:"width",transform:z0}),i0({prop:"size",cssProperty:"height",transform:z0}),S0(j0,G0,$0,U0,K0,Y0,i0({prop:"boxSizing"})),{border:{themeKey:"borders",transform:x0},borderTop:{themeKey:"borders",transform:x0},borderRight:{themeKey:"borders",transform:x0},borderBottom:{themeKey:"borders",transform:x0},borderLeft:{themeKey:"borders",transform:x0},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:x0},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:_0},color:{themeKey:"palette",transform:W0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:W0},backgroundColor:{themeKey:"palette",transform:W0},p:{style:b0},pt:{style:b0},pr:{style:b0},pb:{style:b0},pl:{style:b0},px:{style:b0},py:{style:b0},padding:{style:b0},paddingTop:{style:b0},paddingRight:{style:b0},paddingBottom:{style:b0},paddingLeft:{style:b0},paddingX:{style:b0},paddingY:{style:b0},paddingInline:{style:b0},paddingInlineStart:{style:b0},paddingInlineEnd:{style:b0},paddingBlock:{style:b0},paddingBlockStart:{style:b0},paddingBlockEnd:{style:b0},m:{style:w0},mt:{style:w0},mr:{style:w0},mb:{style:w0},ml:{style:w0},mx:{style:w0},my:{style:w0},margin:{style:w0},marginTop:{style:w0},marginRight:{style:w0},marginBottom:{style:w0},marginLeft:{style:w0},marginX:{style:w0},marginY:{style:w0},marginInline:{style:w0},marginInlineStart:{style:w0},marginInlineEnd:{style:w0},marginBlock:{style:w0},marginBlockStart:{style:w0},marginBlockEnd:{style:w0},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:H0},rowGap:{style:B0},columnGap:{style:V0},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:z0},maxWidth:{style:G0},minWidth:{transform:z0},height:{transform:z0},maxHeight:{transform:z0},minHeight:{transform:z0},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}});const X0=function(){function e(e,t,n,r){const i={[e]:t,theme:n},o=r[e];if(!o)return{[e]:t};const{cssProperty:s=e,themeKey:a,transform:l,style:c}=o;if(null==t)return null;if("typography"===a&&"inherit"===t)return{[e]:t};const u=n0(n,a)||{};if(c)return c(i);return ZZ(i,t,t=>{let n=r0(u,l,t);return t===n&&"string"===typeof t&&(n=r0(u,l,`${e}${"default"===t?"":eJ(t)}`,t)),!1===s?n:{[s]:n}})}return function t(n){const{sx:r,theme:i={},nested:o}=n||{};if(!r)return null;const s=i.unstable_sxConfig??q0;function a(n){let r=n;if("function"===typeof n)r=n(i);else if("object"!==typeof n)return n;if(!r)return null;const a=e0(i.breakpoints),l=Object.keys(a);let c=a;return Object.keys(r).forEach(n=>{const o=function(e,t){return"function"===typeof e?e(t):e}(r[n],i);if(null!==o&&void 0!==o)if("object"===typeof o)if(s[n])c=o0(c,e(n,o,i,s));else{const e=ZZ({theme:i},o,e=>({[n]:e}));!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.reduce((e,t)=>e.concat(Object.keys(t)),[]),i=new Set(r);return t.every(e=>i.size===Object.keys(e).length)}(e,o)?c=o0(c,e):c[n]=t({sx:o,theme:i,nested:!0})}else c=o0(c,e(n,o,i,s))}),!o&&i.modularCssLayers?{"@layer sx":YZ(i,t0(l,c))}:YZ(i,t0(l,c))}return Array.isArray(r)?r.map(a):a(r)}}();X0.filterProps=["sx"];const Q0=X0;function J0(e,t){const n=this;if(n.vars){if(!n.colorSchemes?.[e]||"function"!==typeof n.getColorSchemeSelector)return{};let r=n.getColorSchemeSelector(e);return"&"===r?t:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:t})}return n.palette.mode===e?t:{}}const Z0=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t={},palette:n={},spacing:r,shape:i={},...o}=e;let s=UZ({breakpoints:KZ(t),direction:"ltr",components:{},palette:{mode:"light",...n},spacing:y0(r),shape:{...qZ,...i}},o);s=function(e){const t=(e,t)=>e.replace("@media",t?`@container ${t}`:"@container");function n(n,r){n.up=function(){return t(e.breakpoints.up(...arguments),r)},n.down=function(){return t(e.breakpoints.down(...arguments),r)},n.between=function(){return t(e.breakpoints.between(...arguments),r)},n.only=function(){return t(e.breakpoints.only(...arguments),r)},n.not=function(){const n=t(e.breakpoints.not(...arguments),r);return n.includes("not all and")?n.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):n}}const r={},i=e=>(n(r,e),r);return n(i),{...e,containerQueries:i}}(s),s.applyStyles=J0;for(var a=arguments.length,l=new Array(a>1?a-1:0),c=1;c<a;c++)l[c-1]=arguments[c];return s=l.reduce((e,t)=>UZ(e,t),s),s.unstable_sxConfig={...q0,...o?.unstable_sxConfig},s.unstable_sx=function(e){return Q0({sx:e,theme:this})},s};function e1(e){const{variants:t,...n}=e,r={variants:t,style:zZ(n),isProcessed:!0};return r.style===n||t&&t.forEach(e=>{"function"!==typeof e.style&&(e.style=zZ(e.style))}),r}const t1=Z0();function n1(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function r1(e,t){return t&&e&&"object"===typeof e&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function i1(e){return e?(t,n)=>n[e]:null}function o1(e,t,n){const r="function"===typeof t?t(e):t;if(Array.isArray(r))return r.flatMap(t=>o1(e,t,n));if(Array.isArray(r?.variants)){let t;if(r.isProcessed)t=n?r1(r.style,n):r.style;else{const{variants:e,...i}=r;t=n?r1(zZ(i),n):i}return s1(e,r.variants,[t],n)}return r?.isProcessed?n?r1(zZ(r.style),n):r.style:n?r1(zZ(r),n):r}function s1(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;e:for(let o=0;o<t.length;o+=1){const s=t[o];if("function"===typeof s.props){if(n??={...e,...e.ownerState,ownerState:e.ownerState},!s.props(n))continue}else for(const t in s.props)if(e[t]!==s.props[t]&&e.ownerState?.[t]!==s.props[t])continue e;"function"===typeof s.style?(n??={...e,...e.ownerState,ownerState:e.ownerState},r.push(i?r1(zZ(s.style(n)),i):s.style(n))):r.push(i?r1(zZ(s.style),i):s.style)}return r}function a1(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:t,defaultTheme:n=t1,rootShouldForwardProp:r=n1,slotShouldForwardProp:i=n1}=e;function o(e){!function(e,t,n){e.theme=function(e){for(const t in e)return!1;return!0}(e.theme)?n:e.theme[t]||e.theme}(e,t,n)}return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}(e,e=>e.filter(e=>e!==Q0));const{name:n,slot:s,skipVariantsResolver:a,skipSx:l,overridesResolver:c=i1(c1(s)),...u}=t,d=n&&n.startsWith("Mui")||s?"components":"custom",h=void 0!==a?a:s&&"Root"!==s&&"root"!==s||!1,p=l||!1;let g=n1;"Root"===s||"root"===s?g=r:s?g=i:function(e){return"string"===typeof e&&e.charCodeAt(0)>96}(e)&&(g=void 0);const f=BZ(e,{shouldForwardProp:g,label:l1(n,s),...u}),m=e=>{if(e.__emotion_real===e)return e;if("function"===typeof e)return function(t){return o1(t,e,t.theme.modularCssLayers?d:void 0)};if(GZ(e)){const t=e1(e);return function(e){return t.variants?o1(e,t,e.theme.modularCssLayers?d:void 0):e.theme.modularCssLayers?r1(t.style,d):t.style}}return e},v=function(){const t=[];for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];const a=i.map(m),l=[];if(t.push(o),n&&c&&l.push(function(e){const t=e.theme,r=t.components?.[n]?.styleOverrides;if(!r)return null;const i={};for(const n in r)i[n]=o1(e,r[n],e.theme.modularCssLayers?"theme":void 0);return c(e,i)}),n&&!h&&l.push(function(e){const t=e.theme,r=t?.components?.[n]?.variants;return r?s1(e,r,[],e.theme.modularCssLayers?"theme":void 0):null}),p||l.push(Q0),Array.isArray(a[0])){const e=a.shift(),n=new Array(t.length).fill(""),r=new Array(l.length).fill("");let i;i=[...n,...e,...r],i.raw=[...n,...e.raw,...r],t.unshift(i)}const u=[...t,...a,...l],d=f(...u);return e.muiName&&(d.muiName=e.muiName),d};return f.withConfig&&(v.withConfig=f.withConfig),v}}function l1(e,t){}function c1(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}const u1=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MIN_SAFE_INTEGER,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_SAFE_INTEGER;return Math.max(t,Math.min(e,n))};function d1(e){return u1(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)}function h1(e){if(e.type)return e;if("#"===e.charAt(0))return h1(function(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&1===n[0].length&&(n=n.map(e=>e+e)),n?`rgb${4===n.length?"a":""}(${n.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", ")})`:""}(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(ZQ(9,e));let r,i=e.substring(t+1,e.length-1);if("color"===n){if(i=i.split(" "),r=i.shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(r))throw new Error(ZQ(10,r))}else i=i.split(",");return i=i.map(e=>parseFloat(e)),{type:n,values:i,colorSpace:r}}const p1=(e,t)=>{try{return(e=>{const t=h1(e);return t.values.slice(0,3).map((e,n)=>t.type.includes("hsl")&&0!==n?`${e}%`:e).join(" ")})(e)}catch(Wn){return e}};function g1(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map((e,t)=>t<3?parseInt(e,10):e):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),r=t.includes("color")?`${n} ${r.join(" ")}`:`${r.join(", ")}`,`${t}(${r})`}function f1(e){e=h1(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,o=r*Math.min(i,1-i),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return i-o*Math.max(Math.min(t-3,9-t,1),-1)};let a="rgb";const l=[Math.round(255*s(0)),Math.round(255*s(8)),Math.round(255*s(4))];return"hsla"===e.type&&(a+="a",l.push(t[3])),g1({type:a,values:l})}function m1(e){let t="hsl"===(e=h1(e)).type||"hsla"===e.type?h1(f1(e)).values:e.values;return t=t.map(t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function v1(e,t){return e=h1(e),t=d1(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,g1(e)}function w1(e,t,n){try{return v1(e,t)}catch(Wn){return e}}function b1(e,t){if(e=h1(e),t=d1(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return g1(e)}function C1(e,t,n){try{return b1(e,t)}catch(Wn){return e}}function y1(e,t){if(e=h1(e),t=d1(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return g1(e)}function S1(e,t,n){try{return y1(e,t)}catch(Wn){return e}}function x1(e,t,n){try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.15;return m1(e)>.5?b1(e,t):y1(e,t)}(e,t)}catch(Wn){return e}}const R1={black:"#000",white:"#fff"},E1={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},T1={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},k1={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},M1={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},P1={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},I1={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},A1={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function D1(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:R1.white,default:R1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const F1=D1();function O1(){return{text:{primary:R1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:R1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const N1=O1();function L1(e,t,n,r){const i=r.light||r,o=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=y1(e.main,i):"dark"===t&&(e.dark=b1(e.main,o)))}function _1(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=e,o=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:P1[200],light:P1[50],dark:P1[400]}:{main:P1[700],light:P1[400],dark:P1[800]}}(t),s=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:T1[200],light:T1[50],dark:T1[400]}:{main:T1[500],light:T1[300],dark:T1[700]}}(t),a=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:k1[500],light:k1[300],dark:k1[700]}:{main:k1[700],light:k1[400],dark:k1[800]}}(t),l=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:I1[400],light:I1[300],dark:I1[700]}:{main:I1[700],light:I1[500],dark:I1[900]}}(t),c=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:A1[400],light:A1[300],dark:A1[700]}:{main:A1[800],light:A1[500],dark:A1[900]}}(t),u=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:M1[400],light:M1[300],dark:M1[700]}:{main:"#ed6c02",light:M1[500],dark:M1[900]}}(t);function d(e){const t=function(e,t){const n=m1(e),r=m1(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,N1.text.primary)>=n?N1.text.primary:F1.text.primary;return t}const h=e=>{let{color:t,name:n,mainShade:i=500,lightShade:o=300,darkShade:s=700}=e;if(t={...t},!t.main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw new Error(ZQ(11,n?` (${n})`:"",i));if("string"!==typeof t.main)throw new Error(ZQ(12,n?` (${n})`:"",JSON.stringify(t.main)));return L1(t,"light",o,r),L1(t,"dark",s,r),t.contrastText||(t.contrastText=d(t.main)),t};let p;"light"===t?p=D1():"dark"===t&&(p=O1());return UZ({common:{...R1},mode:t,primary:h({color:o,name:"primary"}),secondary:h({color:s,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:a,name:"error"}),warning:h({color:u,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:c,name:"success"}),grey:E1,contrastThreshold:n,getContrastText:d,augmentColor:h,tonalOffset:r,...p},i)}function H1(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(!r.length)return"";const o=r[0];return"string"!==typeof o||o.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, ${o}`:`, var(--${e?`${e}-`:""}${o}${t(...r.slice(1))})`}return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return`var(--${e?`${e}-`:""}${n}${t(...i)})`}}function V1(e){const t={};return Object.entries(e).forEach(e=>{const[n,r]=e;"object"===typeof r&&(t[n]=`${r.fontStyle?`${r.fontStyle} `:""}${r.fontVariant?`${r.fontVariant} `:""}${r.fontWeight?`${r.fontWeight} `:""}${r.fontStretch?`${r.fontStretch} `:""}${r.fontSize||""}${r.lineHeight?`/${r.lineHeight} `:""}${r.fontFamily||""}`)}),t}const B1=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=e;t.forEach((e,o)=>{o===t.length-1?Array.isArray(i)?i[Number(e)]=n:i&&"object"===typeof i&&(i[e]=n):i&&"object"===typeof i&&(i[e]||(i[e]=r.includes(e)?[]:{}),i=i[e])})};function W1(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},i={},o={},s={};return((e,t,n)=>{!function e(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object.entries(r).forEach(r=>{let[s,a]=r;(!n||n&&!n([...i,s]))&&void 0!==a&&null!==a&&("object"===typeof a&&Object.keys(a).length>0?e(a,[...i,s],Array.isArray(a)?[...o,s]:o):t([...i,s],a,o))})}(e)})(e,(e,t,a)=>{if(("string"===typeof t||"number"===typeof t)&&(!r||!r(e,t))){const r=`--${n?`${n}-`:""}${e.join("-")}`,l=((e,t)=>{if("number"===typeof t)return["lineHeight","fontWeight","opacity","zIndex"].some(t=>e.includes(t))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`;return t})(e,t);Object.assign(i,{[r]:l}),B1(o,e,`var(${r})`,a),B1(s,e,`var(${r}, ${l})`,a)}},e=>"vars"===e[0]),{css:i,vars:o,varsWithDefaults:s}}const z1=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{getSelector:n=m,disableCssColorScheme:r,colorSchemeSelector:i}=t,{colorSchemes:o={},components:s,defaultColorScheme:a="light",...l}=e,{vars:c,css:u,varsWithDefaults:d}=W1(l,t);let h=d;const p={},{[a]:g,...f}=o;if(Object.entries(f||{}).forEach(e=>{let[n,r]=e;const{vars:i,css:o,varsWithDefaults:s}=W1(r,t);h=UZ(h,s),p[n]={css:o,vars:i}}),g){const{css:e,vars:n,varsWithDefaults:r}=W1(g,t);h=UZ(h,r),p[a]={css:e,vars:n}}function m(t,n){let r=i;if("class"===i&&(r=".%s"),"data"===i&&(r="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(r=`[${i}="%s"]`),t){if("media"===r){if(e.defaultColorScheme===t)return":root";const r=o[t]?.palette?.mode||t;return{[`@media (prefers-color-scheme: ${r})`]:{":root":n}}}if(r)return e.defaultColorScheme===t?`:root, ${r.replace("%s",String(t))}`:r.replace("%s",String(t))}return":root"}return{vars:h,generateThemeVars:()=>{let e={...c};return Object.entries(p).forEach(t=>{let[,{vars:n}]=t;e=UZ(e,n)}),e},generateStyleSheets:()=>{const t=[],i=e.defaultColorScheme||"light";function s(e,n){Object.keys(n).length&&t.push("string"===typeof e?{[e]:{...n}}:e)}s(n(void 0,{...u}),u);const{[i]:a,...l}=p;if(a){const{css:e}=a,t=o[i]?.palette?.mode,l=!r&&t?{colorScheme:t,...e}:{...e};s(n(i,{...l}),l)}return Object.entries(l).forEach(e=>{let[t,{css:i}]=e;const a=o[t]?.palette?.mode,l=!r&&a?{colorScheme:a,...i}:{...i};s(n(t,{...l}),l)}),t}}};function j1(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}const G1={textTransform:"uppercase"},$1='"Roboto", "Helvetica", "Arial", sans-serif';function U1(e,t){const{fontFamily:n=$1,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:o=400,fontWeightMedium:s=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:c,pxToRem:u,...d}="function"===typeof t?t(e):t;const h=r/14,p=u||(e=>e/l*h+"rem"),g=(e,t,r,i,o)=>{return{fontFamily:n,fontWeight:e,fontSize:p(t),lineHeight:r,...n===$1?{letterSpacing:(s=i/t,Math.round(1e5*s)/1e5)+"em"}:{},...o,...c};var s},f={h1:g(i,96,1.167,-1.5),h2:g(i,60,1.2,-.5),h3:g(o,48,1.167,0),h4:g(o,34,1.235,.25),h5:g(o,24,1.334,0),h6:g(s,20,1.6,.15),subtitle1:g(o,16,1.75,.15),subtitle2:g(s,14,1.57,.1),body1:g(o,16,1.5,.15),body2:g(o,14,1.43,.15),button:g(s,14,1.75,.4,G1),caption:g(o,12,1.66,.4),overline:g(o,12,2.66,1,G1),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return UZ({htmlFontSize:l,pxToRem:p,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:o,fontWeightMedium:s,fontWeightBold:a,...f},d,{clone:!1})}function K1(){return[`${arguments.length<=0?void 0:arguments[0]}px ${arguments.length<=1?void 0:arguments[1]}px ${arguments.length<=2?void 0:arguments[2]}px ${arguments.length<=3?void 0:arguments[3]}px rgba(0,0,0,0.2)`,`${arguments.length<=4?void 0:arguments[4]}px ${arguments.length<=5?void 0:arguments[5]}px ${arguments.length<=6?void 0:arguments[6]}px ${arguments.length<=7?void 0:arguments[7]}px rgba(0,0,0,0.14)`,`${arguments.length<=8?void 0:arguments[8]}px ${arguments.length<=9?void 0:arguments[9]}px ${arguments.length<=10?void 0:arguments[10]}px ${arguments.length<=11?void 0:arguments[11]}px rgba(0,0,0,0.12)`].join(",")}const Y1=["none",K1(0,2,1,-1,0,1,1,0,0,1,3,0),K1(0,3,1,-2,0,2,2,0,0,1,5,0),K1(0,3,3,-2,0,3,4,0,0,1,8,0),K1(0,2,4,-1,0,4,5,0,0,1,10,0),K1(0,3,5,-1,0,5,8,0,0,1,14,0),K1(0,3,5,-1,0,6,10,0,0,1,18,0),K1(0,4,5,-2,0,7,10,1,0,2,16,1),K1(0,5,5,-3,0,8,10,1,0,3,14,2),K1(0,5,6,-3,0,9,12,1,0,3,16,2),K1(0,6,6,-3,0,10,14,1,0,4,18,3),K1(0,6,7,-4,0,11,15,1,0,4,20,3),K1(0,7,8,-4,0,12,17,2,0,5,22,4),K1(0,7,8,-4,0,13,19,2,0,5,24,4),K1(0,7,9,-4,0,14,21,2,0,5,26,4),K1(0,8,9,-5,0,15,22,2,0,6,28,5),K1(0,8,10,-5,0,16,24,2,0,6,30,5),K1(0,8,11,-5,0,17,26,2,0,6,32,5),K1(0,9,11,-5,0,18,28,2,0,7,34,6),K1(0,9,12,-6,0,19,29,2,0,7,36,6),K1(0,10,13,-6,0,20,31,3,0,8,38,7),K1(0,10,13,-6,0,21,33,3,0,8,40,7),K1(0,10,14,-6,0,22,35,3,0,8,42,7),K1(0,11,14,-7,0,23,36,3,0,9,44,8),K1(0,11,15,-7,0,24,38,3,0,9,46,8)],q1={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},X1={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Q1(e){return`${Math.round(e)}ms`}function J1(e){if(!e)return 0;const t=e/36;return Math.min(Math.round(10*(4+15*t**.25+t/5)),3e3)}function Z1(e){const t={...q1,...e.easing},n={...X1,...e.duration};return{getAutoHeightDuration:J1,create:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{duration:i=n.standard,easing:o=t.easeInOut,delay:s=0,...a}=r;return(Array.isArray(e)?e:[e]).map(e=>`${e} ${"string"===typeof i?i:Q1(i)} ${o} ${"string"===typeof s?s:Q1(s)}`).join(",")},...e,easing:t,duration:n}}const e2={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function t2(e){return GZ(e)||"undefined"===typeof e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)}function n2(){const e={...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}};return function e(t){const n=Object.entries(t);for(let r=0;r<n.length;r++){const[i,o]=n[r];!t2(o)||i.startsWith("unstable_")?delete t[i]:GZ(o)&&(t[i]={...o},e(t[i]))}}(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';\n\nconst theme = ${JSON.stringify(e,null,2)};\n\ntheme.breakpoints = createBreakpoints(theme.breakpoints || {});\ntheme.transitions = createTransitions(theme.transitions || {});\n\nexport default theme;`}const r2=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{breakpoints:t,mixins:n={},spacing:r,palette:i={},transitions:o={},typography:s={},shape:a,...l}=e;if(e.vars&&void 0===e.generateThemeVars)throw new Error(ZQ(20));const c=_1(i),u=Z0(e);let d=UZ(u,{mixins:j1(u.breakpoints,n),palette:c,shadows:Y1.slice(),typography:U1(c,s),transitions:Z1(o),zIndex:{...e2}});d=UZ(d,l);for(var h=arguments.length,p=new Array(h>1?h-1:0),g=1;g<h;g++)p[g-1]=arguments[g];return d=p.reduce((e,t)=>UZ(e,t),d),d.unstable_sxConfig={...q0,...l?.unstable_sxConfig},d.unstable_sx=function(e){return Q0({sx:e,theme:this})},d.toRuntimeSource=n2,d};function i2(e){let t;return t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2,Math.round(10*t)/1e3}const o2=[...Array(25)].map((e,t)=>{if(0===t)return"none";const n=i2(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function s2(e){return{inputPlaceholder:"dark"===e?.5:.42,inputUnderline:"dark"===e?.7:.42,switchTrackDisabled:"dark"===e?.2:.12,switchTrack:"dark"===e?.3:.38}}function a2(e){return"dark"===e?o2:[]}function l2(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||"palette"===e[0]&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const c2=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],u2=e=>(t,n)=>{const r=e.rootSelector||":root",i=e.colorSchemeSelector;let o=i;if("class"===i&&(o=".%s"),"data"===i&&(o="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(o=`[${i}="%s"]`),e.defaultColorScheme===t){if("dark"===t){const i={};return c2(e.cssVarPrefix).forEach(e=>{i[e]=n[e],delete n[e]}),"media"===o?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:i}}:o?{[o.replace("%s",t)]:i,[`${r}, ${o.replace("%s",t)}`]:n}:{[r]:{...n,...i}}}if(o&&"media"!==o)return`${r}, ${o.replace("%s",String(t))}`}else if(t){if("media"===o)return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:n}};if(o)return o.replace("%s",String(t))}return r};function d2(e,t,n){!e[t]&&n&&(e[t]=n)}function h2(e){return"string"===typeof e&&e.startsWith("hsl")?f1(e):e}function p2(e,t){`${t}Channel`in e||(e[`${t}Channel`]=p1(h2(e[t])))}const g2=e=>{try{return e()}catch(Wn){}};function f2(e,t,n,r){if(!t)return;t=!0===t?{}:t;const i="dark"===r?"dark":"light";if(!n)return void(e[r]=function(e){const{palette:t={mode:"light"},opacity:n,overlays:r,...i}=e,o=_1(t);return{palette:o,opacity:{...s2(o.mode),...n},overlays:r||a2(o.mode),...i}}({...t,palette:{mode:i,...t?.palette}}));const{palette:o,...s}=r2({...n,palette:{mode:i,...t?.palette}});return e[r]={...t,palette:o,opacity:{...s2(i),...t?.opacity},overlays:t?.overlays||a2(i)},s}function m2(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{colorSchemes:t={light:!0},defaultColorScheme:n,disableCssColorScheme:r=!1,cssVarPrefix:i="mui",shouldSkipGeneratingVar:o=l2,colorSchemeSelector:s=(t.light&&t.dark?"media":void 0),rootSelector:a=":root",...l}=e,c=Object.keys(t)[0],u=n||(t.light&&"light"!==c?"light":c),d=function(){return H1(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mui")}(i),{[u]:h,light:p,dark:g,...f}=t,m={...f};let v=h;if(("dark"===u&&!("dark"in t)||"light"===u&&!("light"in t))&&(v=!0),!v)throw new Error(ZQ(21,u));const w=f2(m,v,l,u);p&&!m.light&&f2(m,p,void 0,"light"),g&&!m.dark&&f2(m,g,void 0,"dark");let b={defaultColorScheme:u,...w,cssVarPrefix:i,colorSchemeSelector:s,rootSelector:a,getCssVar:d,colorSchemes:m,font:{...V1(w.typography),...w.font},spacing:(C=l.spacing,"number"===typeof C?`${C}px`:"string"===typeof C||"function"===typeof C||Array.isArray(C)?C:"8px")};var C;Object.keys(b.colorSchemes).forEach(e=>{const t=b.colorSchemes[e].palette,n=e=>{const n=e.split("-"),r=n[1],i=n[2];return d(e,t[r][i])};if("light"===t.mode&&(d2(t.common,"background","#fff"),d2(t.common,"onBackground","#000")),"dark"===t.mode&&(d2(t.common,"background","#000"),d2(t.common,"onBackground","#fff")),function(e,t){t.forEach(t=>{e[t]||(e[t]={})})}(t,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),"light"===t.mode){d2(t.Alert,"errorColor",C1(t.error.light,.6)),d2(t.Alert,"infoColor",C1(t.info.light,.6)),d2(t.Alert,"successColor",C1(t.success.light,.6)),d2(t.Alert,"warningColor",C1(t.warning.light,.6)),d2(t.Alert,"errorFilledBg",n("palette-error-main")),d2(t.Alert,"infoFilledBg",n("palette-info-main")),d2(t.Alert,"successFilledBg",n("palette-success-main")),d2(t.Alert,"warningFilledBg",n("palette-warning-main")),d2(t.Alert,"errorFilledColor",g2(()=>t.getContrastText(t.error.main))),d2(t.Alert,"infoFilledColor",g2(()=>t.getContrastText(t.info.main))),d2(t.Alert,"successFilledColor",g2(()=>t.getContrastText(t.success.main))),d2(t.Alert,"warningFilledColor",g2(()=>t.getContrastText(t.warning.main))),d2(t.Alert,"errorStandardBg",S1(t.error.light,.9)),d2(t.Alert,"infoStandardBg",S1(t.info.light,.9)),d2(t.Alert,"successStandardBg",S1(t.success.light,.9)),d2(t.Alert,"warningStandardBg",S1(t.warning.light,.9)),d2(t.Alert,"errorIconColor",n("palette-error-main")),d2(t.Alert,"infoIconColor",n("palette-info-main")),d2(t.Alert,"successIconColor",n("palette-success-main")),d2(t.Alert,"warningIconColor",n("palette-warning-main")),d2(t.AppBar,"defaultBg",n("palette-grey-100")),d2(t.Avatar,"defaultBg",n("palette-grey-400")),d2(t.Button,"inheritContainedBg",n("palette-grey-300")),d2(t.Button,"inheritContainedHoverBg",n("palette-grey-A100")),d2(t.Chip,"defaultBorder",n("palette-grey-400")),d2(t.Chip,"defaultAvatarColor",n("palette-grey-700")),d2(t.Chip,"defaultIconColor",n("palette-grey-700")),d2(t.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),d2(t.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),d2(t.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),d2(t.LinearProgress,"primaryBg",S1(t.primary.main,.62)),d2(t.LinearProgress,"secondaryBg",S1(t.secondary.main,.62)),d2(t.LinearProgress,"errorBg",S1(t.error.main,.62)),d2(t.LinearProgress,"infoBg",S1(t.info.main,.62)),d2(t.LinearProgress,"successBg",S1(t.success.main,.62)),d2(t.LinearProgress,"warningBg",S1(t.warning.main,.62)),d2(t.Skeleton,"bg",`rgba(${n("palette-text-primaryChannel")} / 0.11)`),d2(t.Slider,"primaryTrack",S1(t.primary.main,.62)),d2(t.Slider,"secondaryTrack",S1(t.secondary.main,.62)),d2(t.Slider,"errorTrack",S1(t.error.main,.62)),d2(t.Slider,"infoTrack",S1(t.info.main,.62)),d2(t.Slider,"successTrack",S1(t.success.main,.62)),d2(t.Slider,"warningTrack",S1(t.warning.main,.62));const e=x1(t.background.default,.8);d2(t.SnackbarContent,"bg",e),d2(t.SnackbarContent,"color",g2(()=>t.getContrastText(e))),d2(t.SpeedDialAction,"fabHoverBg",x1(t.background.paper,.15)),d2(t.StepConnector,"border",n("palette-grey-400")),d2(t.StepContent,"border",n("palette-grey-400")),d2(t.Switch,"defaultColor",n("palette-common-white")),d2(t.Switch,"defaultDisabledColor",n("palette-grey-100")),d2(t.Switch,"primaryDisabledColor",S1(t.primary.main,.62)),d2(t.Switch,"secondaryDisabledColor",S1(t.secondary.main,.62)),d2(t.Switch,"errorDisabledColor",S1(t.error.main,.62)),d2(t.Switch,"infoDisabledColor",S1(t.info.main,.62)),d2(t.Switch,"successDisabledColor",S1(t.success.main,.62)),d2(t.Switch,"warningDisabledColor",S1(t.warning.main,.62)),d2(t.TableCell,"border",S1(w1(t.divider,1),.88)),d2(t.Tooltip,"bg",w1(t.grey[700],.92))}if("dark"===t.mode){d2(t.Alert,"errorColor",S1(t.error.light,.6)),d2(t.Alert,"infoColor",S1(t.info.light,.6)),d2(t.Alert,"successColor",S1(t.success.light,.6)),d2(t.Alert,"warningColor",S1(t.warning.light,.6)),d2(t.Alert,"errorFilledBg",n("palette-error-dark")),d2(t.Alert,"infoFilledBg",n("palette-info-dark")),d2(t.Alert,"successFilledBg",n("palette-success-dark")),d2(t.Alert,"warningFilledBg",n("palette-warning-dark")),d2(t.Alert,"errorFilledColor",g2(()=>t.getContrastText(t.error.dark))),d2(t.Alert,"infoFilledColor",g2(()=>t.getContrastText(t.info.dark))),d2(t.Alert,"successFilledColor",g2(()=>t.getContrastText(t.success.dark))),d2(t.Alert,"warningFilledColor",g2(()=>t.getContrastText(t.warning.dark))),d2(t.Alert,"errorStandardBg",C1(t.error.light,.9)),d2(t.Alert,"infoStandardBg",C1(t.info.light,.9)),d2(t.Alert,"successStandardBg",C1(t.success.light,.9)),d2(t.Alert,"warningStandardBg",C1(t.warning.light,.9)),d2(t.Alert,"errorIconColor",n("palette-error-main")),d2(t.Alert,"infoIconColor",n("palette-info-main")),d2(t.Alert,"successIconColor",n("palette-success-main")),d2(t.Alert,"warningIconColor",n("palette-warning-main")),d2(t.AppBar,"defaultBg",n("palette-grey-900")),d2(t.AppBar,"darkBg",n("palette-background-paper")),d2(t.AppBar,"darkColor",n("palette-text-primary")),d2(t.Avatar,"defaultBg",n("palette-grey-600")),d2(t.Button,"inheritContainedBg",n("palette-grey-800")),d2(t.Button,"inheritContainedHoverBg",n("palette-grey-700")),d2(t.Chip,"defaultBorder",n("palette-grey-700")),d2(t.Chip,"defaultAvatarColor",n("palette-grey-300")),d2(t.Chip,"defaultIconColor",n("palette-grey-300")),d2(t.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),d2(t.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),d2(t.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),d2(t.LinearProgress,"primaryBg",C1(t.primary.main,.5)),d2(t.LinearProgress,"secondaryBg",C1(t.secondary.main,.5)),d2(t.LinearProgress,"errorBg",C1(t.error.main,.5)),d2(t.LinearProgress,"infoBg",C1(t.info.main,.5)),d2(t.LinearProgress,"successBg",C1(t.success.main,.5)),d2(t.LinearProgress,"warningBg",C1(t.warning.main,.5)),d2(t.Skeleton,"bg",`rgba(${n("palette-text-primaryChannel")} / 0.13)`),d2(t.Slider,"primaryTrack",C1(t.primary.main,.5)),d2(t.Slider,"secondaryTrack",C1(t.secondary.main,.5)),d2(t.Slider,"errorTrack",C1(t.error.main,.5)),d2(t.Slider,"infoTrack",C1(t.info.main,.5)),d2(t.Slider,"successTrack",C1(t.success.main,.5)),d2(t.Slider,"warningTrack",C1(t.warning.main,.5));const e=x1(t.background.default,.98);d2(t.SnackbarContent,"bg",e),d2(t.SnackbarContent,"color",g2(()=>t.getContrastText(e))),d2(t.SpeedDialAction,"fabHoverBg",x1(t.background.paper,.15)),d2(t.StepConnector,"border",n("palette-grey-600")),d2(t.StepContent,"border",n("palette-grey-600")),d2(t.Switch,"defaultColor",n("palette-grey-300")),d2(t.Switch,"defaultDisabledColor",n("palette-grey-600")),d2(t.Switch,"primaryDisabledColor",C1(t.primary.main,.55)),d2(t.Switch,"secondaryDisabledColor",C1(t.secondary.main,.55)),d2(t.Switch,"errorDisabledColor",C1(t.error.main,.55)),d2(t.Switch,"infoDisabledColor",C1(t.info.main,.55)),d2(t.Switch,"successDisabledColor",C1(t.success.main,.55)),d2(t.Switch,"warningDisabledColor",C1(t.warning.main,.55)),d2(t.TableCell,"border",C1(w1(t.divider,1),.68)),d2(t.Tooltip,"bg",w1(t.grey[700],.92))}p2(t.background,"default"),p2(t.background,"paper"),p2(t.common,"background"),p2(t.common,"onBackground"),p2(t,"divider"),Object.keys(t).forEach(e=>{const n=t[e];"tonalOffset"!==e&&n&&"object"===typeof n&&(n.main&&d2(t[e],"mainChannel",p1(h2(n.main))),n.light&&d2(t[e],"lightChannel",p1(h2(n.light))),n.dark&&d2(t[e],"darkChannel",p1(h2(n.dark))),n.contrastText&&d2(t[e],"contrastTextChannel",p1(h2(n.contrastText))),"text"===e&&(p2(t[e],"primary"),p2(t[e],"secondary")),"action"===e&&(n.active&&p2(t[e],"active"),n.selected&&p2(t[e],"selected")))})});for(var y=arguments.length,S=new Array(y>1?y-1:0),x=1;x<y;x++)S[x-1]=arguments[x];b=S.reduce((e,t)=>UZ(e,t),b);const R={prefix:i,disableCssColorScheme:r,shouldSkipGeneratingVar:o,getSelector:u2(b)},{vars:E,generateThemeVars:T,generateStyleSheets:k}=z1(b,R);return b.vars=E,Object.entries(b.colorSchemes[b.defaultColorScheme]).forEach(e=>{let[t,n]=e;b[t]=n}),b.generateThemeVars=T,b.generateStyleSheets=k,b.generateSpacing=function(){return y0(l.spacing,g0(this))},b.getColorSchemeSelector=function(e){return function(t){return"media"===e?`@media (prefers-color-scheme: ${t})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${t}"] &`:"class"===e?`.${t} &`:"data"===e?`[data-${t}] &`:`${e.replace("%s",t)} &`:"&"}}(s),b.spacing=b.generateSpacing(),b.shouldSkipGeneratingVar=o,b.unstable_sxConfig={...q0,...l?.unstable_sxConfig},b.unstable_sx=function(e){return Q0({sx:e,theme:this})},b.toRuntimeSource=n2,b}function v2(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...!0!==n&&n,palette:_1({...!0===n?{}:n.palette,mode:t})})}function w2(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{palette:t,cssVariables:n=!1,colorSchemes:r=(t?void 0:{light:!0}),defaultColorScheme:i=t?.mode,...o}=e,s=i||"light",a=r?.[s],l={...r,...t?{[s]:{..."boolean"!==typeof a&&a,palette:t}}:void 0};for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];if(!1===n){if(!("colorSchemes"in e))return r2(e,...u);let n=t;"palette"in e||l[s]&&(!0!==l[s]?n=l[s].palette:"dark"===s&&(n={mode:"dark"}));const r=r2({...e,palette:n},...u);return r.defaultColorScheme=s,r.colorSchemes=l,"light"===r.palette.mode&&(r.colorSchemes.light={...!0!==l.light&&l.light,palette:r.palette},v2(r,"dark",l.dark)),"dark"===r.palette.mode&&(r.colorSchemes.dark={...!0!==l.dark&&l.dark,palette:r.palette},v2(r,"light",l.light)),r}return t||"light"in l||"light"!==s||(l.light=!0),m2({...o,colorSchemes:l,defaultColorScheme:s,..."boolean"!==typeof n&&n},...u)}const b2=w2(),C2="$$material";const y2=function(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e},S2=e=>y2(e)&&"classes"!==e,x2=a1({themeId:C2,defaultTheme:b2,rootShouldForwardProp:S2}),R2=e=>e,E2=(()=>{let e=R2;return{configure(t){e=t},generate:t=>e(t),reset(){e=R2}}})(),T2={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function k2(e,t){const n=T2[t];return n?`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui"}-${n}`:`${E2.generate(e)}-${t}`}function M2(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui";const r={};return t.forEach(t=>{r[t]=k2(e,t,n)}),r}function P2(e){return k2("MuiDataGrid",e)}const I2=M2("MuiDataGrid",["aiAssistantPanel","aiAssistantPanelHeader","aiAssistantPanelTitleContainer","aiAssistantPanelTitle","aiAssistantPanelBody","aiAssistantPanelEmptyText","aiAssistantPanelFooter","aiAssistantPanelConversation","aiAssistantPanelConversationList","aiAssistantPanelConversationTitle","aiAssistantPanelSuggestions","aiAssistantPanelSuggestionsList","aiAssistantPanelSuggestionsItem","aiAssistantPanelSuggestionsLabel","actionsCell","aggregationColumnHeader","aggregationColumnHeader--alignLeft","aggregationColumnHeader--alignCenter","aggregationColumnHeader--alignRight","aggregationColumnHeaderLabel","aggregationRowOverlayWrapper","autoHeight","autosizing","mainContent","withSidePanel","booleanCell","cell--editable","cell--editing","cell--flex","cell--textCenter","cell--textLeft","cell--textRight","cell--rangeTop","cell--rangeBottom","cell--rangeLeft","cell--rangeRight","cell--pinnedLeft","cell--pinnedRight","cell--selectionMode","cell","cellCheckbox","cellEmpty","cellSkeleton","cellOffsetLeft","checkboxInput","collapsible","collapsibleTrigger","collapsibleIcon","collapsiblePanel","columnHeader","columnHeader--alignCenter","columnHeader--alignLeft","columnHeader--alignRight","columnHeader--dragging","columnHeader--moving","columnHeader--numeric","columnHeader--sortable","columnHeader--sorted","columnHeader--filtered","columnHeader--pinnedLeft","columnHeader--pinnedRight","columnHeader--last","columnHeader--lastUnpinned","columnHeader--siblingFocused","columnHeader--filter","columnHeaderFilterInput","columnHeaderFilterOperatorLabel","columnHeaderCheckbox","columnHeaderDraggableContainer","columnHeaderTitle","columnHeaderTitleContainer","columnHeaderTitleContainerContent","columnHeader--filledGroup","columnHeader--emptyGroup","columnHeaders","columnSeparator--resizable","columnSeparator--resizing","columnSeparator--sideLeft","columnSeparator--sideRight","columnSeparator","columnsManagement","columnsManagementRow","columnsManagementHeader","columnsManagementSearchInput","columnsManagementFooter","columnsManagementScrollArea","columnsManagementEmptyText","container--top","container--bottom","detailPanel","detailPanelToggleCell","detailPanelToggleCell--expanded","footerCell","panel","panelHeader","panelWrapper","panelContent","panelFooter","paper","editBooleanCell","editInputCell","filler","filler--borderBottom","filler--pinnedLeft","filler--pinnedRight","filterForm","filterFormDeleteIcon","filterFormLogicOperatorInput","filterFormColumnInput","filterFormOperatorInput","filterFormValueInput","filterIcon","footerContainer","headerFilterRow","iconButtonContainer","iconSeparator","main","main--hasPinnedRight","main--hiddenContent","menu","menuIcon","menuIconButton","menuOpen","menuList","overlay","overlayWrapper","overlayWrapperInner","root","root--densityStandard","root--densityComfortable","root--densityCompact","root--disableUserSelection","root--noToolbar","row","row--editable","row--editing","row--firstVisible","row--lastVisible","row--dragging","row--dynamicHeight","row--detailPanelExpanded","row--borderBottom","rowReorderCellPlaceholder","rowCount","rowReorderCellContainer","rowReorderCell","rowReorderCell--draggable","rowReorderIcon","rowSkeleton","scrollArea--left","scrollArea--right","scrollArea","scrollbar","scrollbar--vertical","scrollbar--horizontal","scrollbarFiller","scrollbarFiller--header","scrollbarFiller--borderTop","scrollbarFiller--borderBottom","scrollbarFiller--pinnedRight","selectedRowCount","sortButton","sortIcon","shadowScrollArea","sidebar","sidebarHeader","toolbarContainer","toolbar","toolbarLabel","toolbarDivider","toolbarFilterList","toolbarQuickFilter","toolbarQuickFilterTrigger","toolbarQuickFilterControl","virtualScroller","virtualScroller--hasScrollX","virtualScrollerContent","virtualScrollerContent--overflowed","virtualScrollerRenderZone","withVerticalBorder","withBorderColor","cell--withRightBorder","cell--withLeftBorder","columnHeader--withRightBorder","columnHeader--withLeftBorder","treeDataGroupingCell","treeDataGroupingCellToggle","treeDataGroupingCellLoadingContainer","groupingCriteriaCell","groupingCriteriaCellToggle","groupingCriteriaCellLoadingContainer","pinnedRows","pinnedRows--top","pinnedRows--bottom","pivotPanelAvailableFields","pivotPanelField","pivotPanelField--sorted","pivotPanelFieldActionContainer","pivotPanelFieldCheckbox","pivotPanelFieldDragIcon","pivotPanelFieldList","pivotPanelFieldName","pivotPanelHeader","pivotPanelPlaceholder","pivotPanelScrollArea","pivotPanelSearchContainer","pivotPanelSection","pivotPanelSectionTitle","pivotPanelSections","pivotPanelSwitch","pivotPanelSwitchLabel","prompt","promptContent","promptText","promptFeedback","promptChangeList","promptChangesToggle","promptChangesToggleIcon","promptIcon","promptIconContainer","promptError","promptAction"]),A2={values:{xs:0,sm:600,md:900,lg:1200,xl:1536},up:e=>{const t=A2.values;return`@media (min-width:${"number"===typeof t[e]?t[e]:e}px)`}},D2={spacingUnit:"--DataGrid-t-spacing-unit",colors:{border:{base:"--DataGrid-t-color-border-base"},foreground:{base:"--DataGrid-t-color-foreground-base",muted:"--DataGrid-t-color-foreground-muted",accent:"--DataGrid-t-color-foreground-accent",disabled:"--DataGrid-t-color-foreground-disabled",error:"--DataGrid-t-color-foreground-error"},background:{base:"--DataGrid-t-color-background-base",overlay:"--DataGrid-t-color-background-overlay",backdrop:"--DataGrid-t-color-background-backdrop"},interactive:{hover:"--DataGrid-t-color-interactive-hover",hoverOpacity:"--DataGrid-t-color-interactive-hover-opacity",focus:"--DataGrid-t-color-interactive-focus",focusOpacity:"--DataGrid-t-color-interactive-focus-opacity",disabled:"--DataGrid-t-color-interactive-disabled",disabledOpacity:"--DataGrid-t-color-interactive-disabled-opacity",selected:"--DataGrid-t-color-interactive-selected",selectedOpacity:"--DataGrid-t-color-interactive-selected-opacity"}},header:{background:{base:"--DataGrid-t-header-background-base"}},cell:{background:{pinned:"--DataGrid-t-cell-background-pinned"}},radius:{base:"--DataGrid-t-radius-base"},typography:{font:{body:"--DataGrid-t-typography-font-body",small:"--DataGrid-t-typography-font-small",large:"--DataGrid-t-typography-font-large"},fontFamily:{base:"--DataGrid-t-typography-font-family-base"},fontWeight:{light:"--DataGrid-t-typography-font-weight-light",regular:"--DataGrid-t-typography-font-weight-regular",medium:"--DataGrid-t-typography-font-weight-medium",bold:"--DataGrid-t-typography-font-weight-bold"}},transitions:{easing:{easeIn:"--DataGrid-t-transition-easing-ease-in",easeOut:"--DataGrid-t-transition-easing-ease-out",easeInOut:"--DataGrid-t-transition-easing-ease-in-out"},duration:{short:"--DataGrid-t-transition-duration-short",base:"--DataGrid-t-transition-duration-base",long:"--DataGrid-t-transition-duration-long"}},shadows:{base:"--DataGrid-t-shadow-base",overlay:"--DataGrid-t-shadow-overlay"},zIndex:{panel:"--DataGrid-t-z-index-panel",menu:"--DataGrid-t-z-index-menu"}},F2=function e(t){if("string"===typeof t)return`var(${t})`;const n={};for(const r in t)Object.hasOwn(t,r)&&(n[r]=e(t[r]));return n}(D2),O2=$Q({breakpoints:A2,spacing:function(e,t,n,r){if(void 0===e)return N2(1);if(void 0===t)return N2(e);if(void 0===n)return N2(e)+" "+N2(t);if(void 0===r)return N2(e)+" "+N2(t)+" "+N2(n);return N2(e)+" "+N2(t)+" "+N2(n)+" "+N2(r)},transition:function(e,t){const{duration:n=O2.transitions.duration.base,easing:r=O2.transitions.easing.easeInOut,delay:i=0}=t??{};return e.map(e=>`${e} ${n} ${r} ${i}ms`).join(", ")},keys:D2},F2);function N2(e){return 0===e?"0":`calc(var(--DataGrid-t-spacing-unit) * ${e})`}var L2=n(9461);const _2={};function H2(e,n){const r=t.useRef(_2);return r.current===_2&&(r.current=e(n)),r}const V2=Object.is,B2=rJ,W2=(e,t)=>e===t||e.length===t.length&&e.every((e,n)=>e===t[n]),z2=()=>({state:null,equals:null,selector:null,args:void 0}),j2=[],G2=()=>null;function $2(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:V2;const o=H2(z2),s=null!==o.current.selector,[a,l]=t.useState(s?null:n(e,r));o.current.state=a,o.current.equals=i,o.current.selector=n;const c=o.current.args;if(o.current.args=r,s&&!((e,t)=>{let n=Object.is;return t instanceof Array?n=W2:t instanceof Object&&(n=B2),n(e,t)})(c,r)){const t=o.current.selector(e,o.current.args);o.current.equals(o.current.state,t)||(o.current.state=t,l(t))}const u=t.useCallback(()=>(o.current.subscription||(o.current.subscription=e.current.store.subscribe(()=>{const t=o.current.selector(e,o.current.args);o.current.equals(o.current.state,t)||(o.current.state=t,l(t))})),null),j2),d=t.useCallback(()=>()=>{o.current.subscription&&(o.current.subscription(),o.current.subscription=void 0)},j2);return(0,L2.useSyncExternalStore)(d,u,G2),a}const U2=t.createContext(void 0);function K2(){const e=t.useContext(U2);if(void 0===e)throw new Error(["MUI X: Could not find the Data Grid private context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join("\n"));return e}const Y2={width:3,rx:1.5,x:10.5},q2=e=>e.current.state.dimensions.hasScrollX&&(!e.current.state.dimensions.hasScrollY||0===e.current.state.dimensions.scrollbarSize),X2=x2("div",{name:"MuiDataGrid",slot:"Root",overridesResolver:(e,t)=>[t.root,{[`&.${I2.autoHeight}`]:t.autoHeight},{[`&.${I2.autosizing}`]:t.autosizing},{[`&.${I2["root--densityStandard"]}`]:t["root--densityStandard"]},{[`&.${I2["root--densityComfortable"]}`]:t["root--densityComfortable"]},{[`&.${I2["root--densityCompact"]}`]:t["root--densityCompact"]},{[`&.${I2["root--disableUserSelection"]}`]:t["root--disableUserSelection"]},{[`&.${I2["root--noToolbar"]}`]:t["root--noToolbar"]},{[`&.${I2.withVerticalBorder}`]:t.withVerticalBorder},{[`& .${I2.actionsCell}`]:t.actionsCell},{[`& .${I2.booleanCell}`]:t.booleanCell},{[`& .${I2.cell}`]:t.cell},{[`& .${I2["cell--editable"]}`]:t["cell--editable"]},{[`& .${I2["cell--editing"]}`]:t["cell--editing"]},{[`& .${I2["cell--flex"]}`]:t["cell--flex"]},{[`& .${I2["cell--pinnedLeft"]}`]:t["cell--pinnedLeft"]},{[`& .${I2["cell--pinnedRight"]}`]:t["cell--pinnedRight"]},{[`& .${I2["cell--rangeBottom"]}`]:t["cell--rangeBottom"]},{[`& .${I2["cell--rangeLeft"]}`]:t["cell--rangeLeft"]},{[`& .${I2["cell--rangeRight"]}`]:t["cell--rangeRight"]},{[`& .${I2["cell--rangeTop"]}`]:t["cell--rangeTop"]},{[`& .${I2["cell--selectionMode"]}`]:t["cell--selectionMode"]},{[`& .${I2["cell--textCenter"]}`]:t["cell--textCenter"]},{[`& .${I2["cell--textLeft"]}`]:t["cell--textLeft"]},{[`& .${I2["cell--textRight"]}`]:t["cell--textRight"]},{[`& .${I2["cell--withLeftBorder"]}`]:t["cell--withLeftBorder"]},{[`& .${I2["cell--withRightBorder"]}`]:t["cell--withRightBorder"]},{[`& .${I2.cellCheckbox}`]:t.cellCheckbox},{[`& .${I2.cellEmpty}`]:t.cellEmpty},{[`& .${I2.cellOffsetLeft}`]:t.cellOffsetLeft},{[`& .${I2.cellSkeleton}`]:t.cellSkeleton},{[`& .${I2.checkboxInput}`]:t.checkboxInput},{[`& .${I2.columnHeader}`]:t.columnHeader},{[`& .${I2["columnHeader--alignCenter"]}`]:t["columnHeader--alignCenter"]},{[`& .${I2["columnHeader--alignLeft"]}`]:t["columnHeader--alignLeft"]},{[`& .${I2["columnHeader--alignRight"]}`]:t["columnHeader--alignRight"]},{[`& .${I2["columnHeader--dragging"]}`]:t["columnHeader--dragging"]},{[`& .${I2["columnHeader--emptyGroup"]}`]:t["columnHeader--emptyGroup"]},{[`& .${I2["columnHeader--filledGroup"]}`]:t["columnHeader--filledGroup"]},{[`& .${I2["columnHeader--filtered"]}`]:t["columnHeader--filtered"]},{[`& .${I2["columnHeader--last"]}`]:t["columnHeader--last"]},{[`& .${I2["columnHeader--lastUnpinned"]}`]:t["columnHeader--lastUnpinned"]},{[`& .${I2["columnHeader--moving"]}`]:t["columnHeader--moving"]},{[`& .${I2["columnHeader--numeric"]}`]:t["columnHeader--numeric"]},{[`& .${I2["columnHeader--pinnedLeft"]}`]:t["columnHeader--pinnedLeft"]},{[`& .${I2["columnHeader--pinnedRight"]}`]:t["columnHeader--pinnedRight"]},{[`& .${I2["columnHeader--siblingFocused"]}`]:t["columnHeader--siblingFocused"]},{[`& .${I2["columnHeader--sortable"]}`]:t["columnHeader--sortable"]},{[`& .${I2["columnHeader--sorted"]}`]:t["columnHeader--sorted"]},{[`& .${I2["columnHeader--withLeftBorder"]}`]:t["columnHeader--withLeftBorder"]},{[`& .${I2["columnHeader--withRightBorder"]}`]:t["columnHeader--withRightBorder"]},{[`& .${I2.columnHeaderCheckbox}`]:t.columnHeaderCheckbox},{[`& .${I2.columnHeaderDraggableContainer}`]:t.columnHeaderDraggableContainer},{[`& .${I2.columnHeaderTitleContainer}`]:t.columnHeaderTitleContainer},{[`& .${I2.columnHeaderTitleContainerContent}`]:t.columnHeaderTitleContainerContent},{[`& .${I2.columnSeparator}`]:t.columnSeparator},{[`& .${I2["columnSeparator--resizable"]}`]:t["columnSeparator--resizable"]},{[`& .${I2["columnSeparator--resizing"]}`]:t["columnSeparator--resizing"]},{[`& .${I2["columnSeparator--sideLeft"]}`]:t["columnSeparator--sideLeft"]},{[`& .${I2["columnSeparator--sideRight"]}`]:t["columnSeparator--sideRight"]},{[`& .${I2["container--bottom"]}`]:t["container--bottom"]},{[`& .${I2["container--top"]}`]:t["container--top"]},{[`& .${I2.detailPanelToggleCell}`]:t.detailPanelToggleCell},{[`& .${I2["detailPanelToggleCell--expanded"]}`]:t["detailPanelToggleCell--expanded"]},{[`& .${I2.editBooleanCell}`]:t.editBooleanCell},{[`& .${I2.filterIcon}`]:t.filterIcon},{[`& .${I2["filler--borderBottom"]}`]:t["filler--borderBottom"]},{[`& .${I2["filler--pinnedLeft"]}`]:t["filler--pinnedLeft"]},{[`& .${I2["filler--pinnedRight"]}`]:t["filler--pinnedRight"]},{[`& .${I2.groupingCriteriaCell}`]:t.groupingCriteriaCell},{[`& .${I2.groupingCriteriaCellLoadingContainer}`]:t.groupingCriteriaCellLoadingContainer},{[`& .${I2.groupingCriteriaCellToggle}`]:t.groupingCriteriaCellToggle},{[`& .${I2.headerFilterRow}`]:t.headerFilterRow},{[`& .${I2.iconSeparator}`]:t.iconSeparator},{[`& .${I2.menuIcon}`]:t.menuIcon},{[`& .${I2.menuIconButton}`]:t.menuIconButton},{[`& .${I2.menuList}`]:t.menuList},{[`& .${I2.menuOpen}`]:t.menuOpen},{[`& .${I2.overlayWrapperInner}`]:t.overlayWrapperInner},{[`& .${I2.pinnedRows}`]:t.pinnedRows},{[`& .${I2["pinnedRows--bottom"]}`]:t["pinnedRows--bottom"]},{[`& .${I2["pinnedRows--top"]}`]:t["pinnedRows--top"]},{[`& .${I2.row}`]:t.row},{[`& .${I2["row--borderBottom"]}`]:t["row--borderBottom"]},{[`& .${I2["row--detailPanelExpanded"]}`]:t["row--detailPanelExpanded"]},{[`& .${I2["row--dragging"]}`]:t["row--dragging"]},{[`& .${I2["row--dynamicHeight"]}`]:t["row--dynamicHeight"]},{[`& .${I2["row--editable"]}`]:t["row--editable"]},{[`& .${I2["row--editing"]}`]:t["row--editing"]},{[`& .${I2["row--firstVisible"]}`]:t["row--firstVisible"]},{[`& .${I2["row--lastVisible"]}`]:t["row--lastVisible"]},{[`& .${I2.rowReorderCell}`]:t.rowReorderCell},{[`& .${I2["rowReorderCell--draggable"]}`]:t["rowReorderCell--draggable"]},{[`& .${I2.rowReorderCellContainer}`]:t.rowReorderCellContainer},{[`& .${I2.rowReorderCellPlaceholder}`]:t.rowReorderCellPlaceholder},{[`& .${I2.rowSkeleton}`]:t.rowSkeleton},{[`& .${I2.scrollbar}`]:t.scrollbar},{[`& .${I2["scrollbar--horizontal"]}`]:t["scrollbar--horizontal"]},{[`& .${I2["scrollbar--vertical"]}`]:t["scrollbar--vertical"]},{[`& .${I2.scrollbarFiller}`]:t.scrollbarFiller},{[`& .${I2["scrollbarFiller--borderBottom"]}`]:t["scrollbarFiller--borderBottom"]},{[`& .${I2["scrollbarFiller--borderTop"]}`]:t["scrollbarFiller--borderTop"]},{[`& .${I2["scrollbarFiller--header"]}`]:t["scrollbarFiller--header"]},{[`& .${I2["scrollbarFiller--pinnedRight"]}`]:t["scrollbarFiller--pinnedRight"]},{[`& .${I2.sortIcon}`]:t.sortIcon},{[`& .${I2.treeDataGroupingCell}`]:t.treeDataGroupingCell},{[`& .${I2.treeDataGroupingCellLoadingContainer}`]:t.treeDataGroupingCellLoadingContainer},{[`& .${I2.treeDataGroupingCellToggle}`]:t.treeDataGroupingCellToggle},{[`& .${I2.withBorderColor}`]:t.withBorderColor}]})(()=>{const e=$2(K2(),q2),t=O2.colors.background.base,n=O2.header.background.base,r=O2.cell.background.pinned,i=function(e){return Q2(e,1)}(O2.colors.interactive.hover),o=O2.colors.interactive.hoverOpacity,s=O2.colors.interactive.selected,a=O2.colors.interactive.selectedOpacity,l=s,c=`calc(${a} + ${o})`,u=J2(t,i,o),d=J2(t,s,a),h=J2(t,l,c),p=J2(r,i,o),g=J2(r,s,a),f=J2(r,l,c),m=e=>({[`& .${I2["cell--pinnedLeft"]}, & .${I2["cell--pinnedRight"]}`]:{backgroundColor:e,"&.Mui-selected":{backgroundColor:J2(e,d,a),"&:hover":{backgroundColor:J2(e,h,c)}}}}),v=m(p),w=m(g),b=m(f),C={backgroundColor:d,"&:hover":{backgroundColor:h,"@media (hover: none)":{backgroundColor:d}}};return{"--unstable_DataGrid-radius":O2.radius.base,"--unstable_DataGrid-headWeight":O2.typography.fontWeight.medium,"--DataGrid-rowBorderColor":O2.colors.border.base,"--DataGrid-cellOffsetMultiplier":2,"--DataGrid-width":"0px","--DataGrid-hasScrollX":"0","--DataGrid-hasScrollY":"0","--DataGrid-scrollbarSize":"10px","--DataGrid-rowWidth":"0px","--DataGrid-columnsTotalWidth":"0px","--DataGrid-leftPinnedWidth":"0px","--DataGrid-rightPinnedWidth":"0px","--DataGrid-headerHeight":"0px","--DataGrid-headersTotalHeight":"0px","--DataGrid-topContainerHeight":"0px","--DataGrid-bottomContainerHeight":"0px",flex:1,boxSizing:"border-box",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:O2.colors.border.base,borderRadius:"var(--unstable_DataGrid-radius)",backgroundColor:O2.colors.background.base,color:O2.colors.foreground.base,font:O2.typography.font.body,outline:"none",height:"100%",display:"flex",minWidth:0,minHeight:0,flexDirection:"column",overflow:"hidden",overflowAnchor:"none",transform:"translate(0, 0)",[`.${I2.main} > *:first-child/* emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason */`]:{borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"},[`&.${I2.autoHeight}`]:{height:"auto"},[`&.${I2.autosizing}`]:{[`& .${I2.columnHeaderTitleContainerContent} > *`]:{overflow:"visible !important"},"@media (hover: hover)":{[`& .${I2.menuIcon}`]:{width:"0 !important",visibility:"hidden !important"}},[`& .${I2.cell}`]:{overflow:"visible !important",whiteSpace:"nowrap",minWidth:"max-content !important",maxWidth:"max-content !important"},[`& .${I2.groupingCriteriaCell}`]:{width:"unset"},[`& .${I2.treeDataGroupingCell}`]:{width:"unset"}},[`&.${I2.withSidePanel}`]:{flexDirection:"row"},[`& .${I2.mainContent}`]:{display:"flex",flexDirection:"column",overflow:"hidden",flex:1},[`& .${I2.columnHeader}, & .${I2.cell}`]:{WebkitTapHighlightColor:"transparent",padding:"0 10px",boxSizing:"border-box"},[`& .${I2.columnHeader}:focus-within, & .${I2.cell}:focus-within`]:{outline:`solid ${Q2(O2.colors.interactive.focus,.5)} 1px`,outlineOffset:-1},[`& .${I2.columnHeader}:focus, & .${I2.cell}:focus`]:{outline:`solid ${O2.colors.interactive.focus} 1px`,outlineOffset:-1},[`& .${I2.columnHeader}:focus,\n      & .${I2["columnHeader--withLeftBorder"]},\n      & .${I2["columnHeader--withRightBorder"]},\n      & .${I2["columnHeader--siblingFocused"]},\n      & .${I2["virtualScroller--hasScrollX"]} .${I2["columnHeader--lastUnpinned"]},\n      & .${I2["virtualScroller--hasScrollX"]} .${I2["columnHeader--last"]}\n      `]:{[`& .${I2.columnSeparator}`]:{opacity:0},"@media (hover: none)":{[`& .${I2["columnSeparator--resizable"]}`]:{opacity:1}},[`& .${I2["columnSeparator--resizable"]}:hover`]:{opacity:1}},[`&.${I2["root--noToolbar"]} [aria-rowindex="1"] [aria-colindex="1"]`]:{borderTopLeftRadius:"calc(var(--unstable_DataGrid-radius) - 1px)"},[`&.${I2["root--noToolbar"]} [aria-rowindex="1"] .${I2["columnHeader--last"]}`]:{borderTopRightRadius:e?"calc(var(--unstable_DataGrid-radius) - 1px)":void 0},[`& .${I2.columnHeaderCheckbox}, & .${I2.cellCheckbox}`]:{padding:0,justifyContent:"center",alignItems:"center"},[`& .${I2.columnHeader}`]:{position:"relative",display:"flex",alignItems:"center",backgroundColor:n},[`& .${I2["columnHeader--filter"]}`]:{paddingTop:8,paddingBottom:8,paddingRight:5,minHeight:"min-content",overflow:"hidden"},[`& .${I2["virtualScroller--hasScrollX"]} .${I2["columnHeader--last"]}`]:{overflow:"hidden"},[`& .${I2["pivotPanelField--sorted"]} .${I2.iconButtonContainer},\n      & .${I2["columnHeader--sorted"]} .${I2.iconButtonContainer},\n      & .${I2["columnHeader--filtered"]} .${I2.iconButtonContainer}`]:{visibility:"visible",width:"auto"},[`& .${I2.pivotPanelField}:not(.${I2["pivotPanelField--sorted"]}) .${I2.sortButton},\n      & .${I2.columnHeader}:not(.${I2["columnHeader--sorted"]}) .${I2.sortButton}`]:{opacity:0,transition:O2.transition(["opacity"],{duration:O2.transitions.duration.short})},[`& .${I2.columnHeaderTitleContainer}`]:{display:"flex",alignItems:"center",gap:O2.spacing(.25),minWidth:0,flex:1,whiteSpace:"nowrap",overflow:"hidden"},[`& .${I2.columnHeaderTitleContainerContent}`]:{overflow:"hidden",display:"flex",alignItems:"center"},[`& .${I2["columnHeader--filledGroup"]} .${I2.columnHeaderTitleContainer}`]:{borderBottomWidth:"1px",borderBottomStyle:"solid",boxSizing:"border-box"},[`& .${I2.sortIcon}, & .${I2.filterIcon}`]:{fontSize:"inherit"},[`& .${I2["columnHeader--sortable"]}`]:{cursor:"pointer"},[`& .${I2["columnHeader--alignCenter"]} .${I2.columnHeaderTitleContainer}`]:{justifyContent:"center"},[`& .${I2["columnHeader--alignRight"]} .${I2.columnHeaderDraggableContainer}, & .${I2["columnHeader--alignRight"]} .${I2.columnHeaderTitleContainer}`]:{flexDirection:"row-reverse"},[`& .${I2["columnHeader--alignCenter"]} .${I2.menuIcon}`]:{marginLeft:"auto"},[`& .${I2["columnHeader--alignRight"]} .${I2.menuIcon}`]:{marginRight:"auto",marginLeft:-5},[`& .${I2["columnHeader--moving"]}`]:{backgroundColor:u},[`& .${I2["columnHeader--pinnedLeft"]}, & .${I2["columnHeader--pinnedRight"]}`]:{position:"sticky",zIndex:40,background:O2.header.background.base},[`& .${I2.columnSeparator}`]:{position:"absolute",overflow:"hidden",zIndex:30,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",maxWidth:10,color:O2.colors.border.base},[`& .${I2.columnHeaders}`]:{width:"var(--DataGrid-rowWidth)",backgroundColor:n},"@media (hover: hover)":{[`& .${I2.columnHeader}:hover`]:{[`& .${I2.menuIcon}`]:{width:"auto",visibility:"visible"},[`& .${I2.iconButtonContainer}`]:{visibility:"visible",width:"auto"}},[`& .${I2.columnHeader}:not(.${I2["columnHeader--sorted"]}):hover .${I2.sortButton},\n        & .${I2.pivotPanelField}:not(.${I2["pivotPanelField--sorted"]}):hover .${I2.sortButton},\n        & .${I2.pivotPanelField}:not(.${I2["pivotPanelField--sorted"]}) .${I2.sortButton}:focus-visible`]:{opacity:.5}},"@media (hover: none)":{[`& .${I2.columnHeader} .${I2.menuIcon}`]:{width:"auto",visibility:"visible"},[`& .${I2.columnHeader}:focus,\n        & .${I2["columnHeader--siblingFocused"]}`]:{[`.${I2["columnSeparator--resizable"]}`]:{color:O2.colors.foreground.accent}},[`& .${I2.pivotPanelField}:not(.${I2["pivotPanelField--sorted"]}) .${I2.sortButton}`]:{opacity:.5}},[`& .${I2["columnSeparator--sideLeft"]}`]:{left:-5},[`& .${I2["columnSeparator--sideRight"]}`]:{right:-5},[`& .${I2["columnHeader--withRightBorder"]} .${I2["columnSeparator--sideLeft"]}`]:{left:-5.5},[`& .${I2["columnHeader--withRightBorder"]} .${I2["columnSeparator--sideRight"]}`]:{right:-5.5},[`& .${I2["columnSeparator--resizable"]}`]:{cursor:"col-resize",touchAction:"none",[`&.${I2["columnSeparator--resizing"]}`]:{color:O2.colors.foreground.accent},"@media (hover: none)":{[`& .${I2.iconSeparator} rect`]:Y2},"@media (hover: hover)":{"&:hover":{color:O2.colors.foreground.accent,[`& .${I2.iconSeparator} rect`]:Y2}},"& svg":{pointerEvents:"none"}},[`& .${I2.iconSeparator}`]:{color:"inherit",transition:O2.transition(["color","width"],{duration:O2.transitions.duration.short})},[`& .${I2.menuIcon}`]:{width:0,visibility:"hidden",fontSize:20,marginRight:-5,display:"flex",alignItems:"center"},[`.${I2.menuOpen}`]:{visibility:"visible",width:"auto"},[`& .${I2.headerFilterRow}`]:{[`& .${I2.columnHeader}`]:{boxSizing:"border-box",borderBottom:"1px solid var(--DataGrid-rowBorderColor)"}},[`& .${I2["row--borderBottom"]} .${I2.columnHeader},\n      & .${I2["row--borderBottom"]} .${I2.filler},\n      & .${I2["row--borderBottom"]} .${I2.scrollbarFiller}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`& .${I2["row--borderBottom"]} .${I2.cell}`]:{borderBottom:"1px solid var(--rowBorderColor)"},[`.${I2.row}`]:{display:"flex",width:"var(--DataGrid-rowWidth)",breakInside:"avoid","--rowBorderColor":"var(--DataGrid-rowBorderColor)",[`&.${I2["row--firstVisible"]}`]:{"--rowBorderColor":"transparent"},"&:hover":{backgroundColor:u,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${I2.rowSkeleton}:hover`]:{backgroundColor:"transparent"},"&.Mui-selected":C},[`& .${I2.cell}`]:{flex:"0 0 auto",height:"var(--height)",width:"var(--width)",lineHeight:"calc(var(--height) - 1px)",boxSizing:"border-box",borderTop:"1px solid var(--rowBorderColor)",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis","&.Mui-selected":C},[`& .${I2["virtualScrollerContent--overflowed"]} .${I2["row--lastVisible"]} .${I2.cell}`]:{borderTopColor:"transparent"},[`& .${I2.pinnedRows} .${I2.row}, .${I2.aggregationRowOverlayWrapper} .${I2.row}`]:{backgroundColor:r,"&:hover":{backgroundColor:p}},[`& .${I2["pinnedRows--top"]} :first-of-type`]:{[`& .${I2.cell}, .${I2.scrollbarFiller}`]:{borderTop:"none"}},[`&.${I2["root--disableUserSelection"]}`]:{userSelect:"none"},[`& .${I2["row--dynamicHeight"]} > .${I2.cell}`]:{whiteSpace:"initial",lineHeight:"inherit"},[`& .${I2.cellEmpty}`]:{flex:1,padding:0,height:"unset"},[`& .${I2.cell}.${I2["cell--selectionMode"]}`]:{cursor:"default"},[`& .${I2.cell}.${I2["cell--editing"]}`]:{padding:1,display:"flex",boxShadow:O2.shadows.base,backgroundColor:O2.colors.background.overlay,"&:focus-within":{outline:`1px solid ${O2.colors.interactive.focus}`,outlineOffset:-1}},[`& .${I2["row--editing"]}`]:{boxShadow:O2.shadows.base},[`& .${I2["row--editing"]} .${I2.cell}`]:{boxShadow:"none",backgroundColor:O2.colors.background.overlay},[`& .${I2.editBooleanCell}`]:{display:"flex",height:"100%",width:"100%",alignItems:"center",justifyContent:"center"},[`& .${I2.booleanCell}[data-value="true"]`]:{color:O2.colors.foreground.muted},[`& .${I2.booleanCell}[data-value="false"]`]:{color:O2.colors.foreground.disabled},[`& .${I2.actionsCell}`]:{display:"inline-flex",alignItems:"center",gridGap:O2.spacing(1)},[`& .${I2.rowReorderCell}`]:{display:"inline-flex",flex:1,alignItems:"center",justifyContent:"center",opacity:O2.colors.interactive.disabledOpacity},[`& .${I2["rowReorderCell--draggable"]}`]:{cursor:"grab",opacity:1},[`& .${I2.rowReorderCellContainer}`]:{padding:0,display:"flex",alignItems:"stretch"},[`.${I2.withBorderColor}`]:{borderColor:O2.colors.border.base},[`& .${I2["cell--withLeftBorder"]}, & .${I2["columnHeader--withLeftBorder"]}`]:{borderLeftColor:"var(--DataGrid-rowBorderColor)",borderLeftWidth:"1px",borderLeftStyle:"solid"},[`& .${I2["cell--withRightBorder"]}, & .${I2["columnHeader--withRightBorder"]}`]:{borderRightColor:"var(--DataGrid-rowBorderColor)",borderRightWidth:"1px",borderRightStyle:"solid"},[`& .${I2["cell--flex"]}`]:{display:"flex",alignItems:"center",lineHeight:"inherit"},[`& .${I2["cell--textLeft"]}`]:{textAlign:"left",justifyContent:"flex-start"},[`& .${I2["cell--textRight"]}`]:{textAlign:"right",justifyContent:"flex-end"},[`& .${I2["cell--textCenter"]}`]:{textAlign:"center",justifyContent:"center"},[`& .${I2["cell--pinnedLeft"]}, & .${I2["cell--pinnedRight"]}`]:{position:"sticky",zIndex:30,background:O2.cell.background.pinned,"&.Mui-selected":{backgroundColor:g}},[`& .${I2.row}`]:{"&:hover":v,"&.Mui-selected":w,"&.Mui-selected:hover":b},[`& .${I2.cellOffsetLeft}`]:{flex:"0 0 auto",display:"inline-block"},[`& .${I2.cellSkeleton}`]:{flex:"0 0 auto",height:"100%",display:"inline-flex",alignItems:"center"},[`& .${I2.columnHeaderDraggableContainer}`]:{display:"flex",width:"100%",height:"100%"},[`& .${I2.rowReorderCellPlaceholder}`]:{display:"none"},[`& .${I2["columnHeader--dragging"]}, & .${I2["row--dragging"]}`]:{background:O2.colors.background.overlay,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:O2.colors.interactive.disabledOpacity},[`& .${I2["row--dragging"]}`]:{background:O2.colors.background.overlay,padding:"0 12px",borderRadius:"var(--unstable_DataGrid-radius)",opacity:O2.colors.interactive.disabledOpacity,[`& .${I2.rowReorderCellPlaceholder}`]:{display:"flex"}},[`& .${I2.treeDataGroupingCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${I2.treeDataGroupingCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:O2.spacing(2)},[`& .${I2.treeDataGroupingCellLoadingContainer}, .${I2.groupingCriteriaCellLoadingContainer}`]:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"},[`& .${I2.groupingCriteriaCell}`]:{display:"flex",alignItems:"center",width:"100%"},[`& .${I2.groupingCriteriaCellToggle}`]:{flex:"0 0 28px",alignSelf:"stretch",marginRight:O2.spacing(2)},[`& .${I2.columnHeaders} .${I2.scrollbarFiller}`]:{backgroundColor:n},[`.${I2.scrollbarFiller}`]:{minWidth:"calc(var(--DataGrid-hasScrollY) * var(--DataGrid-scrollbarSize))",alignSelf:"stretch",[`&.${I2["scrollbarFiller--borderTop"]}`]:{borderTop:"1px solid var(--DataGrid-rowBorderColor)"},[`&.${I2["scrollbarFiller--borderBottom"]}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`&.${I2["scrollbarFiller--pinnedRight"]}`]:{backgroundColor:O2.cell.background.pinned,position:"sticky",right:0}},[`& .${I2.filler}`]:{flex:"1 0 auto"},[`& .${I2["filler--borderBottom"]}`]:{borderBottom:"1px solid var(--DataGrid-rowBorderColor)"},[`& .${I2.columnHeaders} .${I2.filler}`]:{backgroundColor:n},[`& .${I2["main--hiddenContent"]}`]:{[`& .${I2.virtualScrollerContent}`]:{position:"fixed",visibility:"hidden"},[`& .${I2["scrollbar--vertical"]}, & .${I2.pinnedRows}, & .${I2.virtualScroller} > .${I2.filler}`]:{display:"none"}}}});function Q2(e,t){return`rgba(from ${e} r g b / ${t})`}function J2(e,t,n){return`color-mix(in srgb,${e}, ${t} calc(${n} * 100%))`}const Z2=t.createContext(void 0);const e3=()=>{const e=t.useContext(Z2);if(!e)throw new Error("MUI X: useGridRootProps should only be used inside the DataGrid, DataGridPro or DataGridPremium component.");return e},t3=t.createContext(void 0);const n3=()=>{const e=t.useContext(t3);if(void 0===e)throw new Error(["MUI X: Could not find the Data Grid configuration context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join("\n"));return e},r3=t.createContext({className:"unset",tag:(0,MH.jsx)("style",{href:"/unset"})});function i3(){return t.useContext(r3).className}function o3(e){const n=n3(),r=e3(),i=n.hooks.useCSSVariables(),o=t.useMemo(()=>{const e=`MuiDataGridVariables-${i.id}`,t=`.${e}{${function(e){let t="";for(const n in e)Object.hasOwn(e,n)&&void 0!==e[n]&&(t+=`${n}:${e[n]};`);return t}(i.variables)}}`;return{className:e,tag:(0,MH.jsx)("style",{href:`/${e}`,nonce:r.nonce,children:t})}},[r.nonce,i]);return(0,MH.jsx)(r3.Provider,{value:o,children:e.children})}var s3=Symbol("NOT_FOUND");function a3(e){if("function"!==typeof e)throw new TypeError(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected a function, instead received "+typeof e)}var l3=e=>Array.isArray(e)?e:[e];function c3(e){const t=Array.isArray(e[0])?e[0]:e;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected all items to be functions, instead received the following types: ";if(!e.every(e=>"function"===typeof e)){const n=e.map(e=>"function"===typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}Symbol(),Object.getPrototypeOf({});var u3=(e,t)=>e===t;function d3(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;const{length:r}=t;for(let i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}}function h3(e,t){const n="object"===typeof t?t:{equalityCheck:t},{equalityCheck:r=u3,maxSize:i=1,resultEqualityCheck:o}=n,s=d3(r);let a=0;const l=i<=1?function(e){let t;return{get:n=>t&&e(t.key,n)?t.value:s3,put(e,n){t={key:e,value:n}},getEntries:()=>t?[t]:[],clear(){t=void 0}}}(s):function(e,t){let n=[];function r(e){const r=n.findIndex(n=>t(e,n.key));if(r>-1){const e=n[r];return r>0&&(n.splice(r,1),n.unshift(e)),e.value}return s3}return{get:r,put:function(t,i){r(t)===s3&&(n.unshift({key:t,value:i}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(i,s);function c(){let t=l.get(arguments);if(t===s3){if(t=e.apply(null,arguments),a++,o){const e=l.getEntries().find(e=>o(e.value,t));e&&(t=e.value,0!==a&&a--)}l.put(arguments,t)}return t}return c.clearCache=()=>{l.clear(),c.resetResultsCount()},c.resultsCount=()=>a,c.resetResultsCount=()=>{a=0},c}var p3="undefined"!==typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function g3(){return{s:0,v:void 0,o:null,p:null}}function f3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let i,o=0;function s(){let t=n;const{length:s}=arguments;for(let e=0,n=s;e<n;e++){const n=arguments[e];if("function"===typeof n||"object"===typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=g3(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=g3(),e.set(n,t)):t=r}}const a=t;let l;if(1===t.s)l=t.v;else if(l=e.apply(null,arguments),o++,r){const e=i?.deref?.()??i;null!=e&&r(e,l)&&(l=e,0!==o&&o--);i="object"===typeof l&&null!==l||"function"===typeof l?new p3(l):l}return a.s=1,a.v=l,l}return s.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},s.resetResultsCount()},s.resultsCount=()=>o,s.resetResultsCount=()=>{o=0},s}function m3(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="function"===typeof e?{memoize:e,memoizeOptions:n}:e,o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,o=0,s=0,a={},l=t.pop();"object"===typeof l&&(a=l,l=t.pop()),a3(l,`createSelector expects an output function after the inputs, but received: [${typeof l}]`);const c={...i,...a},{memoize:u,memoizeOptions:d=[],argsMemoize:h=f3,argsMemoizeOptions:p=[],devModeChecks:g={}}=c,f=l3(d),m=l3(p),v=c3(t),w=u(function(){return o++,l.apply(null,arguments)},...f);const b=h(function(){s++;const e=function(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}(v,arguments);return r=w.apply(null,e),r},...m);return Object.assign(b,{resultFunc:l,memoizedResultFunc:w,dependencies:v,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>r,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:u,argsMemoize:h})};return Object.assign(o,{withTypes:()=>o}),o}var v3=m3(f3),w3=Object.assign(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v3;!function(e){if("object"!==typeof e)throw new TypeError(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expected an object, instead received "+typeof e)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e),r=t(n.map(t=>e[t]),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce((e,t,r)=>(e[n[r]]=t,e),{})});return r},{withTypes:()=>w3});const b3=m3({memoize:h3,memoizeOptions:{maxSize:1,equalityCheck:Object.is}}),C3=function(){const e=function(e,t,n,r,i,o){if((arguments.length<=6?0:arguments.length-6)>0)throw new Error("Unsupported number of selectors");let s;if(e&&t&&n&&r&&i&&o)s=(s,a,l,c)=>{const u=e(s,a,l,c),d=t(s,a,l,c),h=n(s,a,l,c),p=r(s,a,l,c),g=i(s,a,l,c);return o(u,d,h,p,g,a,l,c)};else if(e&&t&&n&&r&&i)s=(o,s,a,l)=>{const c=e(o,s,a,l),u=t(o,s,a,l),d=n(o,s,a,l),h=r(o,s,a,l);return i(c,u,d,h,s,a,l)};else if(e&&t&&n&&r)s=(i,o,s,a)=>{const l=e(i,o,s,a),c=t(i,o,s,a),u=n(i,o,s,a);return r(l,c,u,o,s,a)};else if(e&&t&&n)s=(r,i,o,s)=>{const a=e(r,i,o,s),l=t(r,i,o,s);return n(a,l,i,o,s)};else if(e&&t)s=(n,r,i,o)=>{const s=e(n,r,i,o);return t(s,r,i,o)};else{if(!e)throw new Error("Missing arguments");s=e}return s}(...arguments);return(t,n,r,i)=>e(x3(t),n,r,i)},y3=function(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=new WeakMap;let i=1;const o=t[t.length-1],s=t.length-1||1,a=Math.max(o.length-s,0);if(a>3)throw new Error("Unsupported number of arguments");return(e,n,s,l)=>{let c=e.__cacheKey__;c||(c={id:i},e.__cacheKey__=c,i+=1);let u=r.get(c);if(!u){let e=t;const n=[void 0,void 0,void 0];switch(a){case 0:break;case 1:e=[...t.slice(0,-1),()=>n[0],o];break;case 2:e=[...t.slice(0,-1),()=>n[0],()=>n[1],o];break;case 3:e=[...t.slice(0,-1),()=>n[0],()=>n[1],()=>n[2],o];break;default:throw new Error("Unsupported number of arguments")}u=b3(...e),u.selectorArgs=n,r.set(c,u)}switch(a){case 3:u.selectorArgs[2]=l;case 2:u.selectorArgs[1]=s;case 1:u.selectorArgs[0]=n}switch(a){case 0:return u(e);case 1:return u(e,n);case 2:return u(e,n,s);case 3:return u(e,n,s,l);default:throw new Error("unreachable")}}}(...arguments);return(t,n,r,i)=>e(x3(t),n,r,i)},S3=e=>(t,n)=>e(x3(t),n);function x3(e){return"current"in e?e.current.state:e}const R3={compact:.7,comfortable:1.3,standard:1},E3=S3(e=>e.density),T3=C3(E3,e=>R3[e]),k3=()=>()=>{},M3=()=>!1,P3=()=>!0;let I3=function(e){return e.LEFT="left",e.RIGHT="right",e}({});const A3={left:[],right:[]},D3=S3(e=>e.isRtl),F3=S3(e=>e.columns),O3=C3(F3,e=>e.orderedFields),N3=C3(F3,e=>e.lookup),L3=y3(O3,N3,(e,t)=>e.map(e=>t[e])),_3=C3(F3,e=>e.columnVisibilityModel),H3=C3(F3,e=>e.initialColumnVisibilityModel),V3=y3(L3,_3,(e,t)=>e.filter(e=>!1!==t[e.field])),B3=y3(V3,e=>e.map(e=>e.field)),W3=S3(e=>e.pinnedColumns),z3=(y3(W3,O3,D3,(e,t,n)=>j3(e,t,n)),y3(F3,W3,B3,D3,(e,t,n,r)=>{const i=j3(t,n,r);return{left:i.left.map(t=>e.lookup[t]),right:i.right.map(t=>e.lookup[t])}}));function j3(e,t,n){if(!Array.isArray(e.left)&&!Array.isArray(e.right))return A3;if(0===e.left?.length&&0===e.right?.length)return A3;const r=(e,t)=>Array.isArray(e)?e.filter(e=>t.includes(e)):[],i=r(e.left,t),o=t.filter(e=>!i.includes(e)),s=r(e.right,o);return n?{left:s,right:i}:{left:i,right:s}}const G3=y3(V3,e=>{const t=[];let n=0;for(let r=0;r<e.length;r+=1)t.push(n),n+=e[r].computedWidth;return t}),$3=y3(L3,e=>e.filter(e=>e.filterable)),U3=y3(L3,e=>e.reduce((e,t)=>(t.filterable&&(e[t.field]=t),e),{})),K3=y3(L3,e=>e.some(e=>void 0!==e.colSpan)),Y3=S3(e=>e.preferencePanel),q3=C3(Y3,(e,t)=>!(!e.open||e.labelId!==t));var X3=function(e){return e.filters="filters",e.columns="columns",e.aiAssistant="aiAssistant",e}(X3||{});const Q3=t.createContext(void 0);function J3(){const e=t.useContext(Q3);if(void 0===e)throw new Error(["MUI X: Could not find the Data Grid context.","It looks like you rendered your component outside of a DataGrid, DataGridPro or DataGridPremium parent component.","This can also happen if you are bundling multiple versions of the Data Grid."].join("\n"));return e}const Z3=t.createContext(void 0);function e4(){const e=t.useContext(Z3);if(void 0===e)throw new Error("MUI X: Missing context.");return e}function t4(e){let{children:n}=e;const r=t.useRef(null),i=t.useRef(null),o=t.useRef(null),s=t.useMemo(()=>({columnsPanelTriggerRef:r,filterPanelTriggerRef:i,aiAssistantPanelTriggerRef:o}),[]);return(0,MH.jsx)(Z3.Provider,{value:s,children:n})}function n4(){const e=J3(),t=$2(e,L3),n=e3(),r=$2(e,Y3),{columnsPanelTriggerRef:i,filterPanelTriggerRef:o,aiAssistantPanelTriggerRef:s}=e4(),a=e.current.unstable_applyPipeProcessors("preferencePanel",null,r.openedPanelValue??X3.filters);let l=null;switch(r.openedPanelValue){case X3.filters:l=o.current;break;case X3.columns:l=i.current;break;case X3.aiAssistant:l=s.current}return(0,MH.jsx)(n.slots.panel,$Q({id:r.panelId,open:t.length>0&&r.open,"aria-labelledby":r.labelId,target:l,onClose:()=>e.current.hidePreferences()},n.slotProps?.panel,{children:a}))}function r4(){const e=e3();return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(n4,{}),e.showToolbar&&(0,MH.jsx)(e.slots.toolbar,$Q({},e.slotProps?.toolbar))]})}const i4=a1(),o4=S3(e=>e.dimensions),s4=C3(o4,e=>e.columnsTotalWidth),a4=C3(o4,e=>e.rowHeight),l4=C3(o4,e=>e.contentSize.height),c4=C3(o4,e=>e.hasScrollX),u4=C3(o4,e=>e.hasScrollY),d4=C3(o4,e=>e.columnsTotalWidth<e.viewportOuterSize.width),h4=C3(o4,e=>e.headerHeight),p4=C3(o4,e=>e.groupHeaderHeight),g4=(C3(o4,e=>e.headerFilterHeight),C3(o4,e=>e.hasScrollX?e.scrollbarSize:0)),f4=C3(o4,e=>e.hasScrollY?e.scrollbarSize:0),m4=C3(o4,g4,(e,t)=>{const n=e.viewportOuterSize.height-e.minimumSize.height>0;return!(0===t&&!n)}),v4="undefined"!==typeof window?t.useLayoutEffect:t.useEffect;const w4=function(e){const n=t.useRef(e);return v4(()=>{n.current=e}),t.useRef(function(){return(0,n.current)(...arguments)}).current};class b4{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;this.timeouts=new Map,this.cleanupTimeout=1e3,this.cleanupTimeout=e}register(e,t,n){this.timeouts||(this.timeouts=new Map);const r=setTimeout(()=>{"function"===typeof t&&t(),this.timeouts.delete(n.cleanupToken)},this.cleanupTimeout);this.timeouts.set(n.cleanupToken,r)}unregister(e){const t=this.timeouts.get(e.cleanupToken);t&&(this.timeouts.delete(e.cleanupToken),clearTimeout(t))}reset(){this.timeouts&&(this.timeouts.forEach((e,t)=>{this.unregister({cleanupToken:t})}),this.timeouts=void 0)}}class C4{constructor(){this.registry=new FinalizationRegistry(e=>{"function"===typeof e&&e()})}register(e,t,n){this.registry.register(e,t,n)}unregister(e){this.registry.unregister(e)}reset(){}}class y4{static create(){return new y4}}const S4={current:k4()};let x4=0;function R4(e,n,r,i){const o=t.useState(y4.create)[0],s=t.useRef(null),a=t.useRef(null);a.current=r;const l=t.useRef(null);if(!s.current&&a.current){const t=(e,t,n)=>{t.defaultMuiPrevented||a.current?.(e,t,n)};s.current=e.current.subscribeEvent(n,t,i),x4+=1,l.current={cleanupToken:x4},S4.current.register(o,()=>{s.current?.(),s.current=null,l.current=null},l.current)}else!a.current&&s.current&&(s.current(),s.current=null,l.current&&(S4.current.unregister(l.current),l.current=null));t.useEffect(()=>{if(!s.current&&a.current){const t=(e,t,n)=>{t.defaultMuiPrevented||a.current?.(e,t,n)};s.current=e.current.subscribeEvent(n,t,i)}return l.current&&S4.current&&(S4.current.unregister(l.current),l.current=null),()=>{s.current?.(),s.current=null}},[e,n,i])}const E4={isFirst:!0};function T4(e,t,n){R4(e,t,n,E4)}function k4(){return"undefined"!==typeof FinalizationRegistry?new C4:new b4}const M4=[];function P4(e){t.useEffect(e,M4)}class I4{static create(){return new I4}currentId=null;start(e,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},e)}clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function A4(){const e=H2(I4.create).current;return P4(e.disposeEffect),e}function D4(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={...t};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const o=i;if("components"===o||"slots"===o)r[o]={...e[o],...r[o]};else if("componentsProps"===o||"slotProps"===o){const i=e[o],s=t[o];if(s)if(i){r[o]={...s};for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const t=e;r[o][t]=D4(i[t],s[t],n)}}else r[o]=s;else r[o]=i||{}}else"className"===o&&n&&t.className?r.className=QQ(e?.className,t?.className):"style"===o&&n&&t.style?r.style={...e?.style,...t?.style}:void 0===r[o]&&(r[o]=e[o])}return r}function F4(e){throw new Error("Failed assertion: should not be rendered")}const O4=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","isValidating","debounceMs","isProcessingProps","onValueChange","slotProps"],N4=x2(F4,{name:"MuiDataGrid",slot:"EditInputCell"})({font:O2.typography.font.body,padding:"1px 0","& input":{padding:"0 16px",height:"100%"}}),L4=YQ((e,n)=>{const r=e3(),{id:i,value:o,field:s,colDef:a,hasFocus:l,debounceMs:c=200,isProcessingProps:u,onValueChange:d,slotProps:h}=e,p=qQ(e,O4),g=J3(),f=t.useRef(null),[m,v]=t.useState(o),w=(e=>{const{classes:t}=e;return tJ({root:["editInputCell"]},P2,t)})(r),b=t.useCallback(async e=>{const t=e.target.value,n=g.current.getColumn(s);let r=t;n.valueParser&&(r=n.valueParser(t,g.current.getRow(i),n,g)),v(r),g.current.setEditCellValue({id:i,field:s,value:r,debounceMs:c,unstable_skipValueParser:!0},e),d&&await d(e,t)},[g,c,s,i,d]),C=g.current.unstable_getEditCellMeta(i,s);return t.useEffect(()=>{"debouncedSetEditCellValue"!==C?.changeReason&&v(o)},[C,o]),v4(()=>{l&&f.current.focus()},[l]),(0,MH.jsx)(N4,$Q({as:r.slots.baseInput,inputRef:f,className:w.root,ownerState:r,fullWidth:!0,type:"number"===a.type?a.type:"text",value:m??"",onChange:b,endAdornment:u?(0,MH.jsx)(r.slots.loadIcon,{fontSize:"small",color:"action"}):void 0},p,h?.root,{ref:n}))});const _4=S3(e=>e.rows),H4=C3(_4,e=>e.totalRowCount),V4=C3(_4,e=>e.loading),B4=C3(_4,e=>e.totalTopLevelRowCount),W4=C3(_4,e=>e.dataRowIdToModelLookup),z4=(C3(W4,(e,t)=>e[t]),C3(_4,e=>e.tree)),j4=C3(z4,(e,t)=>e[t]),G4=C3(_4,e=>e.groupsToFetch),$4=C3(_4,e=>e.groupingName),U4=C3(_4,e=>e.treeDepths),K4=y3(_4,e=>{const t=Object.entries(e.treeDepths);return 0===t.length?1:(t.filter(e=>{let[,t]=e;return t>0}).map(e=>{let[t]=e;return Number(t)}).sort((e,t)=>t-e)[0]??0)+1}),Y4=C3(_4,e=>e.dataRowIds),q4=y3(Y4,W4,(e,t)=>e.reduce((e,n)=>t[n]?(e.push(t[n]),e):e,[])),X4=y3(C3(_4,e=>e?.additionalRowGroups),e=>{const t=e?.pinnedRows;return{bottom:t?.bottom?.map(e=>({id:e.id,model:e.model??{}}))??[],top:t?.top?.map(e=>({id:e.id,model:e.model??{}}))??[]}}),Q4=C3(X4,e=>(e?.top?.length||0)+(e?.bottom?.length||0)),J4=(e,t)=>t&&e.length>1?[e[0]]:e,Z4=(e,t)=>n=>$Q({},n,{sorting:$Q({},n.sorting,{sortModel:J4(e,t)})}),e5=(e,t)=>{const n=e.map(e=>((e,t)=>{const n=t.current.getColumn(e.field);if(!n||null===e.sort)return null;let r;return r=n.getSortComparator?n.getSortComparator(e.sort):"desc"===e.sort?function(){return-1*n.sortComparator(...arguments)}:n.sortComparator,r?{getSortCellParams:e=>({id:e,field:n.field,rowNode:j4(t,e),value:t.current.getCellValue(e,n.field),api:t.current}),comparator:r}:null})(e,t)).filter(e=>!!e);return 0===n.length?null:e=>e.map(e=>({node:e,params:n.map(t=>t.getSortCellParams(e.id))})).sort((e,t)=>{return r=e,i=t,n.reduce((e,t,n)=>{if(0!==e)return e;const o=r.params[n],s=i.params[n];return t.comparator(o.value,s.value,o,s)},0);var r,i}).map(e=>e.node.id)},t5=(e,t)=>{const n=e.indexOf(t);return t&&-1!==n&&n+1!==e.length?e[n+1]:e[0]},n5=(e,t)=>null==e&&null!=t?-1:null==t&&null!=e?1:null==e&&null==t?0:null,r5=new Intl.Collator,i5=(e,t)=>{const n=n5(e,t);return null!==n?n:Number(e)-Number(t)},o5=(e,t)=>{const n=n5(e,t);return null!==n?n:e>t?1:e<t?-1:0};let s5=0;const a5={...r}.useId;function l5(e){if(void 0!==a5){const t=a5();return e??t}return function(e){const[n,r]=t.useState(e),i=e||n;return t.useEffect(()=>{null==n&&(s5+=1,r(`mui-${s5}`))},[n]),i}(e)}const c5=["item","applyValue","type","apiRef","focusElementRef","tabIndex","disabled","isFilterActive","slotProps","clearButton","headerFilterMenu"];function u5(e){const{item:n,applyValue:r,type:i,apiRef:o,focusElementRef:s,tabIndex:a,disabled:l,slotProps:c,clearButton:u,headerFilterMenu:d}=e,h=qQ(e,c5),p=c?.root,g=A4(),[f,m]=t.useState(d5(n.value)),[v,w]=t.useState(!1),b=l5(),C=e3(),y=t.useCallback(e=>{const t=d5(e.target.value);m(t),w(!0),g.start(C.filterDebounceMs,()=>{const e=$Q({},n,{value:"number"!==i||Number.isNaN(Number(t))?t:Number(t),fromInput:b});r(e),w(!1)})},[g,C.filterDebounceMs,n,i,b,r]);return t.useEffect(()=>{n.fromInput===b&&null!=n.value||m(d5(n.value))},[b,n]),(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(C.slots.baseTextField,$Q({id:b,label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),value:f??"",onChange:y,type:i||"text",disabled:l,slotProps:$Q({},p?.slotProps,{input:$Q({endAdornment:v?(0,MH.jsx)(C.slots.loadIcon,{fontSize:"small",color:"action"}):null},p?.slotProps?.input),htmlInput:$Q({tabIndex:a},p?.slotProps?.htmlInput)}),inputRef:s},C.slotProps?.baseTextField,h,p)),d,u]})}function d5(e){if(null!=e&&""!==e)return String(e)}function h5(e){return"object"===typeof e&&null!==e}function p5(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}const g5=(e,t,n)=>Math.max(t,Math.min(n,e));function f5(e,t){return Array.from({length:t-e}).map((t,n)=>e+n)}function m5(e){return"function"===typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}const v5=(e,t)=>n=>{e&&t(n)};function w5(e){const{item:n,applyValue:r,type:i,apiRef:o,focusElementRef:s,slotProps:a}=e,l=l5(),[c,u]=t.useState([]),[d,h]=t.useState(n.value||[]),p=e3();t.useEffect(()=>{const e=n.value??[];h(e.map(String))},[n.value]);const g=t.useCallback((e,t)=>{h(t.map(String)),r($Q({},n,{value:[...t.map(e=>"number"===i?Number(e):e)]}))},[r,n,i]),f=t.useCallback((e,t)=>{u(""===t?[]:[t])},[u]),m=p.slots.baseAutocomplete;return(0,MH.jsx)(m,$Q({multiple:!0,freeSolo:!0,options:c,id:l,value:d,onChange:g,onInputChange:f,label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),slotProps:{textField:{type:i||"text",inputRef:s}}},a?.root))}var b5=function(e){return e.And="and",e.Or="or",e}(b5||{});const C5={filteredRowsLookup:{},filteredChildrenCountLookup:{},filteredDescendantCountLookup:{}},y5=()=>({items:[],logicOperator:b5.And,quickFilterValues:[],quickFilterLogicOperator:b5.And});function S5(e){return{current:e.current.getPublicApi()}}let x5;const R5=(e,t)=>{const n=$Q({},e);if(null==n.id&&(n.id=Math.round(1e5*Math.random())),null==n.operator){const e=N3(t)[n.field];n.operator=e&&e.filterOperators[0].value}return n},E5=(e,t,n)=>{const r=e.items.length>1;let i;i=r&&t?[e.items[0]]:e.items;const o=r&&i.some(e=>null==e.id);return i.some(e=>null==e.operator)||o?$Q({},e,{items:i.map(e=>R5(e,n))}):e.items!==i?$Q({},e,{items:i}):e},T5=(e,t,n)=>r=>$Q({},r,{filterModel:E5(e,t,n)}),k5=e=>"string"===typeof e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e,M5=(e,t)=>{if(!e.field||!e.operator)return null;const n=t.current.getColumn(e.field);if(!n)return null;let r;if(n.valueParser){const i=n.valueParser;r=Array.isArray(e.value)?e.value?.map(e=>i(e,void 0,n,t)):i(e.value,void 0,n,t)}else r=e.value;const{ignoreDiacritics:i}=t.current.rootProps;i&&(r=k5(r));const o=$Q({},e,{value:r}),s=n.filterOperators;if(!s?.length)throw new Error(`MUI X: No filter operators found for column '${n.field}'.`);const a=s.find(e=>e.value===o.operator);if(!a)throw new Error(`MUI X: No filter operator found for column '${n.field}' and operator value '${o.operator}'.`);const l=S5(t),c=a.getApplyFilterFn(o,n);return"function"!==typeof c?null:{item:o,fn:e=>{let r=t.current.getRowValue(e,n);return i&&(r=k5(r)),c(r,e,n,l)}}};let P5=1;const I5=(e,t,n)=>{const{items:r}=e,i=r.map(e=>M5(e,t)).filter(e=>!!e);if(0===i.length)return null;if(n||!function(){if(void 0!==x5)return x5;try{x5=new Function("return true")()}catch(e){x5=!1}return x5}())return(e,t)=>{const n={};for(let r=0;r<i.length;r+=1){const o=i[r];t&&!t(o.item.field)||(n[o.item.id]=o.fn(e))}return n};const o=new Function("appliers","row","shouldApplyFilter",`"use strict";\n${i.map((e,t)=>`const shouldApply${t} = !shouldApplyFilter || shouldApplyFilter(${JSON.stringify(e.item.field)});`).join("\n")}\n\nconst result$$ = {\n${i.map((e,t)=>`  ${JSON.stringify(String(e.item.id))}: !shouldApply${t} ? false : appliers[${t}].fn(row),`).join("\n")}\n};\n\nreturn result$$;`.replaceAll("$$",String(P5)));P5+=1;return(e,t)=>o(i,e,t)},A5=e=>e.quickFilterExcludeHiddenColumns??!0,D5=(e,t,n)=>{const r=I5(e,t,n),i=((e,t)=>{const n=e.quickFilterValues?.filter(Boolean)??[];if(0===n.length)return null;const r=A5(e)?B3(t):O3(t),i=[],{ignoreDiacritics:o}=t.current.rootProps,s=S5(t);return r.forEach(e=>{const r=t.current.getColumn(e),a=r?.getApplyQuickFilterFn;a&&i.push({column:r,appliers:n.map(e=>{const t=o?k5(e):e;return{fn:a(t,r,s)}})})}),function(e,r){const a={};e:for(let l=0;l<n.length;l+=1){const c=n[l];for(let n=0;n<i.length;n+=1){const{column:u,appliers:d}=i[n],{field:h}=u;if(r&&!r(h))continue;const p=d[l];let g=t.current.getRowValue(e,u);if(null!==p.fn&&(o&&(g=k5(g)),p.fn(g,e,u,s))){a[c]=!0;continue e}}a[c]=!1}return a}})(e,t);return function(e,t,n){n.passingFilterItems=r?.(e,t)??null,n.passingQuickFilterValues=i?.(e,t)??null}},F5=e=>null!=e,O5=(e,t,n,r,i)=>{const o=((e,t,n)=>(e.cleanedFilterItems||(e.cleanedFilterItems=n.filter(e=>null!==M5(e,t))),e.cleanedFilterItems))(i,r,n.items),s=e.filter(F5),a=t.filter(F5);if(s.length>0){const e=e=>s.some(t=>t[e.id]);if((n.logicOperator??y5().logicOperator)===b5.And){if(!o.every(e))return!1}else{if(!o.some(e))return!1}}if(a.length>0&&null!=n.quickFilterValues){const e=e=>a.some(t=>t[e]);if((n.quickFilterLogicOperator??y5().quickFilterLogicOperator)===b5.And){if(!n.quickFilterValues.every(e))return!1}else{if(!n.quickFilterValues.some(e))return!1}}return!0},N5=(e,t)=>n=>{if(!n.value)return null;const r=e?n.value:n.value.trim(),i=new RegExp(p5(r),"i");return e=>{if(null==e)return t;const n=i.test(String(e));return t?!n:n}},L5=(e,t)=>n=>{if(!n.value)return null;const r=e?n.value:n.value.trim(),i=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return e=>{if(null==e)return t;const n=0===i.compare(r,e.toString());return t?!n:n}},_5=e=>()=>t=>{const n=""===t||null==t;return e?!n:n},H5={width:100,minWidth:50,maxWidth:1/0,hideable:!0,sortable:!0,resizable:!0,filterable:!0,groupable:!0,pinnable:!0,aggregable:!0,editable:!1,sortComparator:(e,t)=>{const n=n5(e,t);return null!==n?n:"string"===typeof e?r5.compare(e.toString(),t.toString()):e-t},type:"string",align:"left",filterOperators:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[{value:"contains",getApplyFilterFn:N5(e,!1),InputComponent:u5},{value:"doesNotContain",getApplyFilterFn:N5(e,!0),InputComponent:u5},{value:"equals",getApplyFilterFn:L5(e,!1),InputComponent:u5},{value:"doesNotEqual",getApplyFilterFn:L5(e,!0),InputComponent:u5},{value:"startsWith",getApplyFilterFn:t=>{if(!t.value)return null;const n=e?t.value:t.value.trim(),r=new RegExp(`^${p5(n)}.*$`,"i");return e=>null!=e&&r.test(e.toString())},InputComponent:u5},{value:"endsWith",getApplyFilterFn:t=>{if(!t.value)return null;const n=e?t.value:t.value.trim(),r=new RegExp(`.*${p5(n)}$`,"i");return e=>null!=e&&r.test(e.toString())},InputComponent:u5},{value:"isEmpty",getApplyFilterFn:_5(!1),requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:_5(!0),requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFn:t=>{if(!Array.isArray(t.value)||0===t.value.length)return null;const n=e?t.value:t.value.map(e=>e.trim()),r=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"});return e=>null!=e&&n.some(t=>0===r.compare(t,e.toString()||""))},InputComponent:w5}]}(),renderEditCell:e=>(0,MH.jsx)(L4,$Q({},e)),getApplyQuickFilterFn:e=>{if(!e)return null;const t=new RegExp(p5(e),"i");return(e,n,r,i)=>{let o=i.current.getRowFormattedValue(n,r);return i.current.ignoreDiacritics&&(o=k5(o)),null!=o&&t.test(o.toString())}}},V5=e=>null==e?null:Number(e),B5=$Q({},H5,{type:"number",align:"right",headerAlign:"right",sortComparator:i5,valueParser:e=>""===e?null:Number(e),valueFormatter:e=>function(e){return"number"===typeof e&&!Number.isNaN(e)}(e)?e.toLocaleString():e||"",filterOperators:[{value:"=",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>V5(t)===e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:"!=",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>V5(t)!==e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:">",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>null!=t&&V5(t)>e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:">=",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>null!=t&&V5(t)>=e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:"<",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>null!=t&&V5(t)<e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:"<=",getApplyFilterFn:e=>null==e.value||Number.isNaN(e.value)?null:t=>null!=t&&V5(t)<=e.value,InputComponent:u5,InputComponentProps:{type:"number"}},{value:"isEmpty",getApplyFilterFn:()=>e=>null==e,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:()=>e=>null!=e,requiresFilterValue:!1},{value:"isAnyOf",getApplyFilterFn:e=>Array.isArray(e.value)&&0!==e.value.length?t=>null!=t&&e.value.includes(Number(t)):null,InputComponent:w5,InputComponentProps:{type:"number"}}],getApplyQuickFilterFn:e=>null==e||Number.isNaN(e)||""===e?null:t=>V5(t)===V5(e)}),W5=["item","applyValue","type","apiRef","focusElementRef","slotProps","isFilterActive","headerFilterMenu","clearButton","tabIndex","disabled"];function z5(e,t){if(null==e)return"";const n=new Date(e);return Number.isNaN(n.getTime())?"":"date"===t?n.toISOString().substring(0,10):"datetime-local"===t?(n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n.toISOString().substring(0,19)):n.toISOString().substring(0,10)}function j5(e){const{item:n,applyValue:r,type:i,apiRef:o,focusElementRef:s,slotProps:a,headerFilterMenu:l,clearButton:c,tabIndex:u,disabled:d}=e,h=qQ(e,W5),p=a?.root.slotProps,g=A4(),[f,m]=t.useState(()=>z5(n.value,i)),[v,w]=t.useState(!1),b=l5(),C=e3(),y=t.useCallback(e=>{g.clear();const t=e.target.value;m(t),w(!0),g.start(C.filterDebounceMs,()=>{const e=new Date(t);r($Q({},n,{value:Number.isNaN(e.getTime())?void 0:e})),w(!1)})},[r,n,C.filterDebounceMs,g]);return t.useEffect(()=>{const e=z5(n.value,i);m(e)},[n.value,i]),(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(C.slots.baseTextField,$Q({fullWidth:!0,id:b,label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),value:f,onChange:y,type:i||"text",disabled:d,inputRef:s,slotProps:$Q({},p,{input:$Q({endAdornment:v?(0,MH.jsx)(C.slots.loadIcon,{fontSize:"small",color:"action"}):null},p?.input),htmlInput:$Q({max:"datetime-local"===i?"9999-12-31T23:59":"9999-12-31",tabIndex:u},p?.htmlInput)})},C.slotProps?.baseTextField,h,a?.root)),l,c]})}function G5(e,t,n,r){if(!e.value)return null;const i=new Date(e.value);n?i.setSeconds(0,0):(i.setMinutes(i.getMinutes()+i.getTimezoneOffset()),i.setHours(0,0,0,0));const o=i.getTime();return e=>{if(!e)return!1;if(r)return t(e.getTime(),o);const i=new Date(e);return n?i.setSeconds(0,0):i.setHours(0,0,0,0),t(i.getTime(),o)}}const $5=e=>[{value:"is",getApplyFilterFn:t=>G5(t,(e,t)=>e===t,e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"not",getApplyFilterFn:t=>G5(t,(e,t)=>e!==t,e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"after",getApplyFilterFn:t=>G5(t,(e,t)=>e>t,e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrAfter",getApplyFilterFn:t=>G5(t,(e,t)=>e>=t,e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"before",getApplyFilterFn:t=>G5(t,(e,t)=>e<t,e,!e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"onOrBefore",getApplyFilterFn:t=>G5(t,(e,t)=>e<=t,e),InputComponent:j5,InputComponentProps:{type:e?"datetime-local":"date"}},{value:"isEmpty",getApplyFilterFn:()=>e=>null==e,requiresFilterValue:!1},{value:"isNotEmpty",getApplyFilterFn:()=>e=>null!=e,requiresFilterValue:!1}],U5=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","hasFocus","inputProps","isValidating","isProcessingProps","onValueChange","slotProps"],K5=x2(F4)({fontSize:"inherit"});function Y5(e){const{id:n,value:r,field:i,colDef:o,hasFocus:s,onValueChange:a,slotProps:l}=e,c=qQ(e,U5),u="dateTime"===o.type,d=J3(),h=t.useRef(null),p=t.useMemo(()=>{let e,t;if(e=null==r?null:r instanceof Date?r:new Date((r??"").toString()),null==e||Number.isNaN(e.getTime()))t="";else{t=new Date(e.getTime()-60*e.getTimezoneOffset()*1e3).toISOString().substr(0,u?16:10)}return{parsed:e,formatted:t}},[r,u]),[g,f]=t.useState(p),m=e3(),v=(e=>{const{classes:t}=e;return tJ({root:["editInputCell"]},P2,t)})({classes:m.classes}),w=t.useCallback(e=>{if(""===e)return null;const[t,n]=e.split("T"),[r,i,o]=t.split("-"),s=new Date;if(s.setFullYear(Number(r),Number(i)-1,Number(o)),s.setHours(0,0,0,0),n){const[e,t]=n.split(":");s.setHours(Number(e),Number(t),0,0)}return s},[]),b=t.useCallback(async e=>{const t=e.target.value,r=w(t);a&&await a(e,r),f({parsed:r,formatted:t}),d.current.setEditCellValue({id:n,field:i,value:r},e)},[d,i,n,a,w]);return t.useEffect(()=>{f(e=>p.parsed!==e.parsed&&p.parsed?.getTime()!==e.parsed?.getTime()?p:e)},[p]),v4(()=>{s&&h.current.focus()},[s]),(0,MH.jsx)(K5,$Q({as:m.slots.baseInput,inputRef:h,fullWidth:!0,className:v.root,type:u?"datetime-local":"date",value:g.formatted,onChange:b},c,l?.root,{slotProps:{htmlInput:$Q({max:u?"9999-12-31T23:59":"9999-12-31"},l?.root?.slotProps?.htmlInput)}}))}const q5=e=>(0,MH.jsx)(Y5,$Q({},e));const X5="auto-generated-group-node-root",Q5=Symbol("mui.id_autogenerated");const J5=(e,t,n)=>{const r=t?t(e):e.id;return function(e,t){if(null==e)throw new Error(["MUI X: The Data Grid component requires all rows to have a unique `id` property.","Alternatively, you can use the `getRowId` prop to specify a custom id for each row.",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"A row was provided without id in the rows prop:",JSON.stringify(t)].join("\n"))}(r,e,n),r},Z5=e=>{let{rows:t,getRowId:n,loading:r,rowCount:i}=e;const o={type:"full",rows:[]},s={};for(let a=0;a<t.length;a+=1){const e=t[a],r=J5(e,n);s[r]=e,o.rows.push(r)}return{rowsBeforePartialUpdates:t,loadingPropBeforePartialUpdates:r,rowCountPropBeforePartialUpdates:i,updates:o,dataRowIdToModelLookup:s}},e6=e=>{let{tree:t,rowCountProp:n=0}=e;const r=t[X5];return Math.max(n,r.children.length+(null==r.footerId?0:1))},t6=e=>{let{apiRef:t,rowCountProp:n=0,loadingProp:r,previousTree:i,previousTreeDepths:o,previousGroupsToFetch:s}=e;const a=t.current.caches.rows,{tree:l,treeDepths:c,dataRowIds:u,groupingName:d,groupsToFetch:h=[]}=t.current.applyStrategyProcessor("rowTreeCreation",{previousTree:i,previousTreeDepths:o,updates:a.updates,dataRowIdToModelLookup:a.dataRowIdToModelLookup,previousGroupsToFetch:s}),p=t.current.unstable_applyPipeProcessors("hydrateRows",{tree:l,treeDepths:c,dataRowIds:u,dataRowIdToModelLookup:a.dataRowIdToModelLookup});return t.current.caches.rows.updates={type:"partial",actions:{insert:[],modify:[],remove:[]},idToActionLookup:{}},$Q({},p,{totalRowCount:Math.max(n,p.dataRowIds.length),totalTopLevelRowCount:e6({tree:p.tree,rowCountProp:n}),groupingName:d,loading:r,groupsToFetch:h})},n6=e=>"skeletonRow"===e.type||"footer"===e.type||"group"===e.type&&e.isAutoGenerated||"pinnedRow"===e.type&&e.isAutoGenerated,r6=(e,t,n)=>{const r=e[t];if("group"!==r.type)return[];const i=[];for(let o=0;o<r.children.length;o+=1){const t=r.children[o];n&&n6(e[t])||i.push(t);const s=r6(e,t,n);for(let e=0;e<s.length;e+=1)i.push(s[e])}return n||null==r.footerId||i.push(r.footerId),i},i6=e=>{let{previousCache:t,getRowId:n,updates:r,groupKeys:i}=e;if("full"===t.updates.type)throw new Error("MUI X: Unable to prepare a partial update if a full update is not applied yet.");const o=new Map;r.forEach(e=>{const t=J5(e,n,"A row was provided without id when calling updateRows():");o.has(t)?o.set(t,$Q({},o.get(t),e)):o.set(t,e)});const s={type:"partial",actions:{insert:[...t.updates.actions.insert??[]],modify:[...t.updates.actions.modify??[]],remove:[...t.updates.actions.remove??[]]},idToActionLookup:$Q({},t.updates.idToActionLookup),groupKeys:i},a=$Q({},t.dataRowIdToModelLookup),l={insert:{},modify:{},remove:{}};o.forEach((e,t)=>{const n=s.idToActionLookup[t];if("delete"===e._action){if("remove"===n||!a[t])return;return null!=n&&(l[n][t]=!0),s.actions.remove.push(t),void delete a[t]}const r=a[t];if(r)return"remove"===n?(l.remove[t]=!0,s.actions.modify.push(t)):null==n&&s.actions.modify.push(t),void(a[t]=$Q({},r,e));"remove"===n?(l.remove[t]=!0,s.actions.insert.push(t)):null==n&&s.actions.insert.push(t),a[t]=e});const c=Object.keys(l);for(let u=0;u<c.length;u+=1){const e=c[u],t=l[e];Object.keys(t).length>0&&(s.actions[e]=s.actions[e].filter(e=>!t[e]))}return{dataRowIdToModelLookup:a,updates:s,rowsBeforePartialUpdates:t.rowsBeforePartialUpdates,loadingPropBeforePartialUpdates:t.loadingPropBeforePartialUpdates,rowCountPropBeforePartialUpdates:t.rowCountPropBeforePartialUpdates}},o6="var(--DataGrid-overlayHeight, calc(var(--height) * 2))";function s6(e,t,n){const r=[];return t.forEach(t=>{const i=J5(t,n,"A row was provided without id when calling updateRows():"),o=j4(e,i);if("pinnedRow"===o?.type){const n=e.current.caches.pinnedRows,r=n.idLookup[i];r&&(n.idLookup[i]=$Q({},r,t))}else r.push(t)}),r}const a6=(e,t,n)=>"number"===typeof e&&e>0?e:t,l6=(["MUI X: The `rowHeight` prop should be a number greater than 0.","The default value will be used instead."].join("\n"),["MUI X: The `getRowHeight` prop should return a number greater than 0 or 'auto'.","The default value will be used instead."].join("\n"),S3((e,t)=>Q5 in t?t[Q5]:e.props.getRowId?e.props.getRowId(t):t.id));function c6(e){let{value:t,columnType:n,rowId:r,field:i}=e;if(!(t instanceof Date))throw new Error([`MUI X: \`${n}\` column type only accepts \`Date\` objects as values.`,"Use `valueGetter` to transform the value into a `Date` object.",`Row ID: ${r}, field: "${i}".`].join("\n"))}const u6=$Q({},H5,{type:"date",sortComparator:o5,valueFormatter:(e,t,n,r)=>{if(!e)return"";return c6({value:e,columnType:"date",rowId:l6(r,t),field:n.field}),e.toLocaleDateString()},filterOperators:$5(),renderEditCell:q5,pastedValueParser:e=>new Date(e)}),d6=$Q({},H5,{type:"dateTime",sortComparator:o5,valueFormatter:(e,t,n,r)=>{if(!e)return"";return c6({value:e,columnType:"dateTime",rowId:l6(r,t),field:n.field}),e.toLocaleString()},filterOperators:$5(!0),renderEditCell:q5,pastedValueParser:e=>new Date(e)}),h6="__row_group_by_columns_group__",p6="__detail_panel_toggle__";let g6=function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.VIRTUAL=3]="VIRTUAL",e}({});const f6=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","hasFocus","tabIndex","hideDescendantCount"];function m6(e){const{value:n,rowNode:r}=e,i=qQ(e,f6),o=J3(),s=e3(),a=(e=>{const{classes:t}=e;return tJ({root:["booleanCell"]},P2,t)})({classes:s.classes}),l=$2(o,K4)>0&&"group"===r.type&&!1===s.treeData,c=t.useMemo(()=>n?s.slots.booleanCellTrueIcon:s.slots.booleanCellFalseIcon,[s.slots.booleanCellFalseIcon,s.slots.booleanCellTrueIcon,n]);return l&&void 0===n?null:(0,MH.jsx)(c,$Q({fontSize:"small",className:a.root,titleAccess:o.current.getLocaleText(n?"booleanCellTrueLabel":"booleanCellFalseLabel"),"data-value":Boolean(n)},i))}const v6=t.memo(m6);const w6=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange"];function b6(e){const{id:n,value:r,field:i,className:o,hasFocus:s,onValueChange:a}=e,l=qQ(e,w6),c=J3(),u=t.useRef(null),d=l5(),[h,p]=t.useState(r),g=e3(),f=(e=>{const{classes:t}=e;return tJ({root:["editBooleanCell"]},P2,t)})({classes:g.classes}),m=t.useCallback(async e=>{const t=e.target.checked;a&&await a(e,t),p(t),await c.current.setEditCellValue({id:n,field:i,value:t},e)},[c,i,n,a]);return t.useEffect(()=>{p(r)},[r]),v4(()=>{s&&u.current.focus()},[s]),(0,MH.jsx)("label",$Q({htmlFor:d,className:QQ(f.root,o)},l,{children:(0,MH.jsx)(g.slots.baseCheckbox,$Q({id:d,inputRef:u,checked:Boolean(h),onChange:m,size:"small"},g.slotProps?.baseCheckbox))}))}const C6=["item","applyValue","apiRef","focusElementRef","isFilterActive","headerFilterMenu","clearButton","tabIndex","slotProps"];function y6(e){const{item:n,applyValue:r,apiRef:i,focusElementRef:o,headerFilterMenu:s,clearButton:a,tabIndex:l,slotProps:c}=e,u=qQ(e,C6),[d,h]=t.useState(S6(n.value)),p=e3(),g=l5(),f=l5(),m=p.slotProps?.baseSelect||{},v=m.native??!1,w=p.slotProps?.baseSelectOption||{},b=t.useCallback(e=>{const t=S6(e.target.value);h(t),r($Q({},n,{value:t}))},[r,n]);t.useEffect(()=>{h(S6(n.value))},[n.value]);const C=c?.root.label??i.current.getLocaleText("filterPanelInputLabel"),y=c?.root.slotProps;return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsxs)(p.slots.baseSelect,$Q({fullWidth:!0,labelId:g,id:f,label:C,value:void 0===d?"":String(d),onChange:b,native:v,slotProps:{htmlInput:$Q({ref:o,tabIndex:l},y?.htmlInput)}},m,u,c?.root,{children:[(0,MH.jsx)(p.slots.baseSelectOption,$Q({},w,{native:v,value:"",children:i.current.getLocaleText("filterValueAny")})),(0,MH.jsx)(p.slots.baseSelectOption,$Q({},w,{native:v,value:"true",children:i.current.getLocaleText("filterValueTrue")})),(0,MH.jsx)(p.slots.baseSelectOption,$Q({},w,{native:v,value:"false",children:i.current.getLocaleText("filterValueFalse")}))]})),s,a]})}function S6(e){return"true"===String(e).toLowerCase()||"false"!==String(e).toLowerCase()&&void 0}const x6=$Q({},H5,{type:"boolean",display:"flex",align:"center",headerAlign:"center",renderCell:e=>e.field!==h6&&n6(e.rowNode)?"":(0,MH.jsx)(v6,$Q({},e)),renderEditCell:e=>(0,MH.jsx)(b6,$Q({},e)),sortComparator:i5,valueFormatter:(e,t,n,r)=>e?r.current.getLocaleText("booleanCellTrueLabel"):r.current.getLocaleText("booleanCellFalseLabel"),filterOperators:[{value:"is",getApplyFilterFn:e=>{const t=S6(e.value);return void 0===t?null:e=>Boolean(e)===t},InputComponent:y6}],getApplyQuickFilterFn:()=>null,aggregable:!1,pastedValueParser:e=>(e=>{switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case"null":case"undefined":return!1;default:return}})(e)});var R6=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e.pasteKeyDown="pasteKeyDown",e}(R6||{}),E6=function(e){return e.cellFocusOut="cellFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(E6||{}),T6=function(e){return e.Cell="cell",e.Row="row",e}(T6||{}),k6=function(e){return e.Edit="edit",e.View="view",e}(k6||{}),M6=function(e){return e.Edit="edit",e.View="view",e}(M6||{});function P6(e){return"singleSelect"===e?.type}function I6(e,t){if(e)return"function"===typeof e.valueOptions?e.valueOptions($Q({field:e.field},t)):e.valueOptions}function A6(e,t,n){if(void 0===t)return;const r=t.find(t=>{const r=n(t);return String(r)===String(e)});return n(r)}const D6=["id","value","formattedValue","api","field","row","rowNode","colDef","cellMode","isEditable","tabIndex","className","hasFocus","isValidating","isProcessingProps","error","onValueChange","initialOpen","slotProps"];function F6(e){const n=e3(),{id:r,value:i,field:o,row:s,colDef:a,hasFocus:l,error:c,onValueChange:u,initialOpen:d=n.editMode===T6.Cell,slotProps:h}=e,p=qQ(e,D6),g=J3(),f=t.useRef(null),m=t.useRef(null),[v,w]=t.useState(d),b=(n.slotProps?.baseSelect||{}).native??!1;if(v4(()=>{l&&m.current?.focus()},[l]),!P6(a))return null;const C=I6(a,{id:r,row:s});if(!C)return null;const y=a.getOptionValue,S=a.getOptionLabel;return C&&a?(0,MH.jsx)(n.slots.baseSelect,$Q({ref:f,value:i,onChange:async e=>{if(!P6(a)||!C)return;w(!1);const t=A6(e.target.value,C,y);u&&await u(e,t),await g.current.setEditCellValue({id:r,field:o,value:t},e)},open:v,onOpen:e=>{(function(e){return!!e.key})(e)&&"Enter"===e.key||w(!0)},onClose:(e,t)=>{if(n.editMode!==T6.Row){if("backdropClick"===t||"Escape"===e.key){const t=g.current.getCellParams(r,o);g.current.publishEvent("cellEditStop",$Q({},t,{reason:"Escape"===e.key?E6.escapeKeyDown:E6.cellFocusOut}))}}else w(!1)},error:c,native:b,fullWidth:!0,slotProps:{htmlInput:{ref:m}}},p,h?.root,n.slotProps?.baseSelect,{children:C.map(e=>{const r=y(e);return(0,t.createElement)(n.slots.baseSelectOption,$Q({},n.slotProps?.baseSelectOption||{},{native:b,key:r,value:r}),S(e))})})):null}const O6=["item","applyValue","type","apiRef","focusElementRef","tabIndex","isFilterActive","clearButton","headerFilterMenu","slotProps"],N6=e=>{let{column:n,OptionComponent:r,getOptionLabel:i,getOptionValue:o,isSelectNative:s,baseSelectOptionProps:a}=e;return["",...I6(n)||[]].map(e=>{const n=o(e);let l=i(e);return""===l&&(l="\u2003"),(0,t.createElement)(r,$Q({},a,{native:s,key:n,value:n}),l)})};function L6(e){const{item:n,applyValue:r,type:i,apiRef:o,focusElementRef:s,tabIndex:a,clearButton:l,headerFilterMenu:c,slotProps:u}=e,d=qQ(e,O6),h=n.value??"",p=l5(),g=l5(),f=e3(),m=f.slotProps?.baseSelect?.native??!1;let v=null;if(n.field){const e=o.current.getColumn(n.field);P6(e)&&(v=e)}const w=v?.getOptionValue,b=v?.getOptionLabel,C=t.useMemo(()=>I6(v),[v]),y=t.useCallback(e=>{let t=e.target.value;t=A6(t,C,w),r($Q({},n,{value:t}))},[C,w,r,n]);if(!P6(v))return null;const S=u?.root.label??o.current.getLocaleText("filterPanelInputLabel");return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(f.slots.baseSelect,$Q({fullWidth:!0,id:p,label:S,labelId:g,value:h,onChange:y,slotProps:{htmlInput:$Q({tabIndex:a,ref:s,type:i||"text",placeholder:u?.root.placeholder??o.current.getLocaleText("filterPanelInputPlaceholder")},u?.root.slotProps?.htmlInput)},native:m},f.slotProps?.baseSelect,d,u?.root,{children:N6({column:v,OptionComponent:f.slots.baseSelectOption,getOptionLabel:b,getOptionValue:w,isSelectNative:m,baseSelectOptionProps:f.slotProps?.baseSelectOption})})),c,l]})}const _6=["item","applyValue","type","apiRef","focusElementRef","slotProps"];function H6(e){const{item:n,applyValue:r,type:i,apiRef:o,focusElementRef:s,slotProps:a}=e,l=qQ(e,_6),c=l5(),u=e3();let d=null;if(n.field){const e=o.current.getColumn(n.field);P6(e)&&(d=e)}const h=d?.getOptionValue,p=d?.getOptionLabel,g=t.useCallback((e,t)=>h(e)===h(t),[h]),f=t.useMemo(()=>I6(d)||[],[d]),m=t.useMemo(()=>Array.isArray(n.value)?n.value.reduce((e,t)=>{const n=f.find(e=>h(e)===t);return null!=n&&e.push(n),e},[]):[],[h,n.value,f]),v=t.useCallback((e,t)=>{r($Q({},n,{value:t.map(h)}))},[r,n,h]),w=u.slots.baseAutocomplete;return(0,MH.jsx)(w,$Q({multiple:!0,options:f,isOptionEqualToValue:g,id:c,value:m,onChange:v,getOptionLabel:p,label:o.current.getLocaleText("filterPanelInputLabel"),placeholder:o.current.getLocaleText("filterPanelInputPlaceholder"),slotProps:{textField:{type:i||"text",inputRef:s}}},l,a?.root))}const V6=e=>null!=e&&h5(e)?e.value:e,B6=$Q({},H5,{type:"singleSelect",getOptionLabel:e=>h5(e)?e.label:String(e),getOptionValue:e=>h5(e)?e.value:e,valueFormatter(e,t,n,r){const i=l6(r,t);if(!P6(n))return"";const o=I6(n,{id:i,row:t});if(null==e)return"";if(!o)return e;if("object"!==typeof o[0])return n.getOptionLabel(e);const s=o.find(t=>n.getOptionValue(t)===e);return s?n.getOptionLabel(s):""},renderEditCell:e=>(0,MH.jsx)(F6,$Q({},e)),filterOperators:[{value:"is",getApplyFilterFn:e=>null==e.value||""===e.value?null:t=>V6(t)===V6(e.value),InputComponent:L6},{value:"not",getApplyFilterFn:e=>null==e.value||""===e.value?null:t=>V6(t)!==V6(e.value),InputComponent:L6},{value:"isAnyOf",getApplyFilterFn:e=>{if(!Array.isArray(e.value)||0===e.value.length)return null;const t=e.value.map(V6);return e=>t.includes(V6(e))},InputComponent:H6}],pastedValueParser:(e,t,n)=>{const r=n,i=I6(r)||[],o=r.getOptionValue;if(i.find(t=>o(t)===e))return e}}),W6=t.createContext();const z6=()=>t.useContext(W6)??!1;function j6(e){return 1===e.key.length&&!e.ctrlKey&&!e.metaKey}const G6=e=>0===e.indexOf("Arrow")||0===e.indexOf("Page")||" "===e||"Home"===e||"End"===e,$6=e=>"Tab"===e||"Escape"===e;function U6(e){return(e.ctrlKey||e.metaKey)&&"V"===String.fromCharCode(e.keyCode)&&!e.shiftKey&&!e.altKey}const K6=["open","target","onClose","children","position","className","onExited"],Y6=x2(F4,{name:"MuiDataGrid",slot:"Menu"})({zIndex:O2.zIndex.menu,[`& .${I2.menuList}`]:{outline:0}});function q6(e){const{open:n,target:r,onClose:i,children:o,position:s,className:a,onExited:l}=e,c=qQ(e,K6),u=J3(),d=e3(),h=(e=>{const{classes:t}=e;return tJ({root:["menu"]},P2,t)})(d),p=i3(),g=t.useRef(null);v4(()=>{n?g.current=document.activeElement instanceof HTMLElement?document.activeElement:null:(g.current?.focus?.(),g.current=null)},[n]),t.useEffect(()=>{const e=n?"menuOpen":"menuClose";u.current.publishEvent(e,{target:r})},[u,n,r]);return(0,MH.jsx)(Y6,$Q({as:d.slots.basePopper,className:QQ(h.root,a,p),ownerState:d,open:n,target:r,transition:!0,placement:s,onClickAway:e=>{e.target&&(r===e.target||r?.contains(e.target))||i(e)},onExited:l,clickAwayMouseEvent:"onMouseDown",onKeyDown:e=>{$6(e.key)&&i(e)}},c,d.slotProps?.basePopper,{children:o}))}const X6=["api","colDef","id","hasFocus","isEditable","field","value","formattedValue","row","rowNode","cellMode","tabIndex","position","focusElementRef"];function Q6(e){const{colDef:n,id:r,hasFocus:i,tabIndex:o,position:s="bottom-end",focusElementRef:a}=e,l=qQ(e,X6),[c,u]=t.useState(-1),[d,h]=t.useState(!1),p=J3(),g=t.useRef(null),f=t.useRef(null),m=t.useRef(!1),v=t.useRef({}),w=z6(),b=l5(),C=l5(),y=e3();if(!(e=>"function"===typeof e.getActions)(n))throw new Error("MUI X: Missing the `getActions` property in the `GridColDef`.");const S=n.getActions(p.current.getRowParams(r)),x=S.filter(e=>!e.props.showInMenu),R=S.filter(e=>e.props.showInMenu),E=x.length+(R.length?1:0);t.useLayoutEffect(()=>{i||Object.entries(v.current).forEach(e=>{let[t,n]=e;n?.stop({},()=>{delete v.current[t]})})},[i]),t.useEffect(()=>{if(c<0||!g.current)return;if(c>=g.current.children.length)return;g.current.children[c].focus({preventScroll:!0})},[c]),t.useEffect(()=>{i||(u(-1),m.current=!1)},[i]),t.useImperativeHandle(a,()=>({focus(){if(!m.current){const e=S.findIndex(e=>!e.props.disabled);u(e)}}}),[S]),t.useEffect(()=>{c>=E&&u(E-1)},[c,E]);const T=()=>{h(!1)},k=e=>t=>{v.current[e]=t},M=(e,t)=>n=>{u(e),m.current=!0,t&&t(n)};return(0,MH.jsxs)("div",$Q({role:"menu",ref:g,tabIndex:-1,className:I2.actionsCell,onKeyDown:e=>{if(E<=1)return;const t=(e,n)=>{if(e<0||e>S.length)return e;const r=("left"===n?-1:1)*(w?-1:1);return S[e+r]?.props.disabled?t(e+r,n):e+r};let n=c;"ArrowRight"===e.key?n=t(c,"right"):"ArrowLeft"===e.key&&(n=t(c,"left")),n<0||n>=E||n!==c&&(e.preventDefault(),e.stopPropagation(),u(n))}},l,{children:[x.map((e,n)=>t.cloneElement(e,{key:n,touchRippleRef:k(n),onClick:M(n,e.props.onClick),tabIndex:c===n?o:-1})),R.length>0&&C&&(0,MH.jsx)(y.slots.baseIconButton,$Q({ref:f,id:C,"aria-label":p.current.getLocaleText("actionsCellMore"),"aria-haspopup":"menu","aria-expanded":d,"aria-controls":d?b:void 0,role:"menuitem",size:"small",onClick:e=>{e.stopPropagation(),e.preventDefault(),d?T():(h(!0),u(E-1),m.current=!0)},touchRippleRef:k(C),tabIndex:c===x.length?o:-1},y.slotProps?.baseIconButton,{children:(0,MH.jsx)(y.slots.moreActionsIcon,{fontSize:"small"})})),R.length>0&&(0,MH.jsx)(q6,{open:d,target:f.current,position:s,onClose:T,children:(0,MH.jsx)(y.slots.baseMenuList,{id:b,className:I2.menuList,"aria-labelledby":C,autoFocusItem:!0,children:R.map((e,n)=>t.cloneElement(e,{key:n,closeMenu:T}))})})]}))}const J6="actions",Z6=$Q({},H5,{sortable:!1,filterable:!1,aggregable:!1,width:100,display:"flex",align:"center",headerAlign:"center",headerName:"",disableColumnMenu:!0,disableExport:!0,renderCell:e=>(0,MH.jsx)(Q6,$Q({},e)),getApplyQuickFilterFn:()=>null}),e8=S3(e=>e.headerFiltering),t8=C3(e8,e=>e?.enabled??!1),n8=C3(e8,e=>e.editing),r8=C3(e8,e=>e.menuOpen),i8=S3(e=>e.columnGrouping),o8=y3(i8,e=>e?.unwrappedGroupingModel??{}),s8=y3(i8,e=>e?.lookup??{}),a8=y3(i8,e=>e?.headerStructure??[]),l8=C3(i8,e=>e?.maxDepth??0),c8=["maxWidth","minWidth","width","flex"],u8={string:H5,number:B5,date:u6,dateTime:d6,boolean:x6,singleSelect:B6,[J6]:Z6,custom:H5};const d8=(e,t)=>{const n={};let r=0,i=0;const o=[];e.orderedFields.forEach(t=>{let s=e.lookup[t],a=0,l=!1;!1!==e.columnVisibilityModel[t]&&(s.flex&&s.flex>0?(r+=s.flex,l=!0):a=g5(s.width||H5.width,s.minWidth||H5.minWidth,s.maxWidth||H5.maxWidth),i+=a),s.computedWidth!==a&&(s=$Q({},s,{computedWidth:a})),l&&o.push(s),n[t]=s});const s=void 0===t?0:t.viewportOuterSize.width-(t.hasScrollY?t.scrollbarSize:0),a=Math.max(s-i,0);if(r>0&&s>0){const e=function(e){let{initialFreeSpace:t,totalFlexUnits:n,flexColumns:r}=e;const i=new Set(r.map(e=>e.field)),o={all:{},frozenFields:[],freeze:e=>{const t=o.all[e];t&&!0!==t.frozen&&(o.all[e].frozen=!0,o.frozenFields.push(e))}};return function e(){if(o.frozenFields.length===i.size)return;const s={min:{},max:{}};let a=t,l=n,c=0;o.frozenFields.forEach(e=>{a-=o.all[e].computedWidth,l-=o.all[e].flex});for(let t=0;t<r.length;t+=1){const e=r[t];if(o.all[e.field]&&!0===o.all[e.field].frozen)continue;let n=a/l*e.flex;n<e.minWidth?(c+=e.minWidth-n,n=e.minWidth,s.min[e.field]=!0):n>e.maxWidth&&(c+=e.maxWidth-n,n=e.maxWidth,s.max[e.field]=!0),o.all[e.field]={frozen:!1,computedWidth:n,flex:e.flex}}c<0?Object.keys(s.max).forEach(e=>{o.freeze(e)}):c>0?Object.keys(s.min).forEach(e=>{o.freeze(e)}):r.forEach(e=>{let{field:t}=e;o.freeze(t)}),e()}(),o.all}({initialFreeSpace:a,totalFlexUnits:r,flexColumns:o});Object.keys(e).forEach(t=>{n[t]=$Q({},n[t],{computedWidth:e[t].computedWidth})})}return $Q({},e,{lookup:n})};function h8(e){let t=u8.string;return e&&u8[e]&&(t=u8[e]),t}const p8=e=>{let{apiRef:t,columnsToUpsert:n,initialState:r,columnVisibilityModel:i=_3(t),keepOnlyColumnsToUpsert:o=!1,updateInitialVisibilityModel:s=!1}=e;const a=!t.current.state.columns;let l;if(a)l={orderedFields:[],lookup:{},columnVisibilityModel:i,initialColumnVisibilityModel:i};else{const e=F3(t);l={orderedFields:o?[]:[...e.orderedFields],lookup:$Q({},e.lookup),columnVisibilityModel:i,initialColumnVisibilityModel:s?i:e.initialColumnVisibilityModel}}let c={};o&&!a&&(c=Object.keys(l.lookup).reduce((e,t)=>$Q({},e,{[t]:!1}),{}));const u={};n.forEach(e=>{const{field:t}=e;u[t]=!0,c[t]=!0;let n=l.lookup[t];null==n?(n=$Q({},h8(e.type),{field:t,hasBeenResized:!1}),l.orderedFields.push(t)):o&&l.orderedFields.push(t),n&&n.type!==e.type&&(n=$Q({},h8(e.type),{field:t}));let r=n.hasBeenResized;c8.forEach(t=>{void 0!==e[t]&&(r=!0,-1===e[t]&&(e[t]=1/0))}),l.lookup[t]=D4(n,$Q({},h8(e.type),e,{hasBeenResized:r}))}),o&&!a&&Object.keys(l.lookup).forEach(e=>{c[e]||delete l.lookup[e]});const d=((e,t)=>{if(!t)return e;const{orderedFields:n=[],dimensions:r={}}=t,i=Object.keys(r);if(0===i.length&&0===n.length)return e;const o={},s=[];for(let c=0;c<n.length;c+=1){const t=n[c];e.lookup[t]&&(o[t]=!0,s.push(t))}const a=0===s.length?e.orderedFields:[...s,...e.orderedFields.filter(e=>!o[e])],l=$Q({},e.lookup);for(let c=0;c<i.length;c+=1){const e=i[c],t=$Q({},l[e],{hasBeenResized:!0});Object.entries(r[e]).forEach(e=>{let[n,r]=e;t[n]=-1===r?1/0:r}),l[e]=t}return $Q({},e,{orderedFields:a,lookup:l})})(t.current.unstable_applyPipeProcessors("hydrateColumns",l),r);return d8(d,t.current.getRootDimensions?.()??void 0)};function g8(e,t){if(t.listView)return 0;const n=T3(e),r=l8(e),i=t8(e);return Math.floor(t.columnHeaderHeight*n)+Math.floor((t.columnGroupHeaderHeight??t.columnHeaderHeight)*n)*r+(i?Math.floor((t.headerFilterHeight??t.columnHeaderHeight)*n):0)}const f8=i4("div",{name:"MuiDataGrid",slot:"ScrollArea",overridesResolver:(e,t)=>[{[`&.${I2["scrollArea--left"]}`]:t["scrollArea--left"]},{[`&.${I2["scrollArea--right"]}`]:t["scrollArea--right"]},t.scrollArea]})(()=>({position:"absolute",top:0,zIndex:101,width:20,bottom:0,[`&.${I2["scrollArea--left"]}`]:{left:0},[`&.${I2["scrollArea--right"]}`]:{right:0}})),m8=C3(o4,(e,t)=>"left"===t?e.leftPinnedWidth:"right"===t?e.rightPinnedWidth+(e.hasScrollX?e.scrollbarSize:0):0);function v8(e){const{scrollDirection:n,scrollPosition:r}=e,i=t.useRef(null),o=J3(),s=A4(),a=$2(o,T3),l=$2(o,s4),c=$2(o,m8,n),u=()=>{const e=o4(o);if("left"===n)return r.current.left>0;if("right"===n){const t=l-e.viewportInnerSize.width;return r.current.left<t}return!1},[d,h]=t.useState(u),p=e3(),g=$Q({},p,{scrollDirection:n}),f=(e=>{const{scrollDirection:t,classes:n}=e;return tJ({root:["scrollArea",`scrollArea--${t}`]},P2,n)})(g),m=g8(o,p),v=Math.floor(p.columnHeaderHeight*a),w={height:v,top:m-v};"left"===n?w.left=c:"right"===n&&(w.right=c);const b=w4(e=>{let t;if(e.preventDefault(),"left"===n)t=e.clientX-i.current.getBoundingClientRect().right;else{if("right"!==n)throw new Error("MUI X: Wrong drag direction");t=Math.max(1,e.clientX-i.current.getBoundingClientRect().left)}t=1.5*(t-1)+1,s.start(0,()=>{o.current.scroll({left:r.current.left+t,top:r.current.top})})});return R4(o,"scrollPositionChange",()=>{h(u)}),d?(0,MH.jsx)(f8,{ref:i,className:f.root,ownerState:g,onDragOver:b,style:w}):null}const w8=iJ(function(e){const n=J3(),[r,i]=t.useState(!1);return R4(n,"columnHeaderDragStart",()=>i(!0)),R4(n,"columnHeaderDragEnd",()=>i(!1)),r?(0,MH.jsx)(v8,$Q({},e)):null}),b8=()=>{};function C8(e){for(const t in e)return!1;return!0}const y8=S3(e=>e.sorting),S8=C3(y8,e=>e.sortedRows),x8=y3(S8,W4,z4,(e,t,n)=>e.reduce((e,r)=>{const i=t[r];if(i)e.push({id:r,model:i});else{const t=n[r];t&&n6(t)&&e.push({id:r,model:{[Q5]:r}})}return e},[])),R8=C3(y8,e=>e.sortModel),E8=y3(R8,e=>{const t=e.reduce((t,n,r)=>(t[n.field]={sortDirection:n.sort,sortIndex:e.length>1?r+1:void 0},t),{});return t}),T8=(y3(S8,e=>e.reduce((e,t,n)=>(e[t]=n,e),Object.create(null))),S3(e=>e.filter)),k8=C3(T8,e=>e.filterModel),M8=C3(k8,e=>e.quickFilterValues),P8=S3(e=>e.visibleRowsLookup),I8=C3(T8,e=>e.filteredRowsLookup),A8=(C3(T8,e=>e.filteredChildrenCountLookup),C3(T8,e=>e.filteredDescendantCountLookup),y3(P8,x8,(e,t)=>C8(e)?t:t.filter(t=>!1!==e[t.id]))),D8=y3(A8,e=>e.map(e=>e.id)),F8=y3(I8,x8,(e,t)=>C8(e)?t:t.filter(t=>!1!==e[t.id])),O8=y3(F8,e=>e.map(e=>e.id)),N8=(y3(D8,z4,(e,t)=>{const n={};let r=0;return e.reduce((e,i)=>{const o=t[i];return n[o.depth]||(n[o.depth]=0),o.depth>r&&(n[o.depth]=0),r=o.depth,n[o.depth]+=1,e[i]=n[o.depth],e},{})}),y3(A8,z4,K4,(e,t,n)=>n<2?e:e.filter(e=>0===t[e.id]?.depth))),L8=C3(A8,e=>e.length),_8=C3(N8,e=>e.length),H8=C3(F8,e=>e.length),V8=(C3(H8,_8,(e,t)=>e-t),y3(k8,N3,(e,t)=>e.items?.filter(e=>{if(!e.field)return!1;const n=t[e.field];if(!n?.filterOperators||0===n?.filterOperators?.length)return!1;const r=n.filterOperators.find(t=>t.value===e.operator);return!!r&&(!r.InputComponent||null!=e.value&&""!==e.value?.toString())}))),B8=y3(V8,e=>e.reduce((e,t)=>(e[t.field]?e[t.field].push(t):e[t.field]=[t],e),{}));let W8=function(e){return e.DataGrid="DataGrid",e.DataGridPro="DataGridPro",e.DataGridPremium="DataGridPremium",e}({});const z8=(e,t,n)=>t>0&&e>0?Math.ceil(e/t):-1===e?n+2:0,j8=e=>({page:0,pageSize:e?0:100}),G8=(e,t)=>{if(t===W8.DataGrid&&e>100)throw new Error(["MUI X: `pageSize` cannot exceed 100 in the MIT version of the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join("\n"))},$8=S3(e=>e.pagination),U8=C3($8,e=>e.enabled&&"client"===e.paginationMode),K8=C3($8,e=>e.paginationModel),Y8=C3($8,e=>e.rowCount),q8=C3($8,e=>e.meta),X8=C3(K8,e=>e.page),Q8=C3(K8,e=>e.pageSize),J8=C3(K8,Y8,(e,t)=>z8(t,e.pageSize,e.page)),Z8=y3(U8,K8,z4,K4,A8,N8,(e,t,n,r,i,o)=>{if(!e)return null;const s=o.length,a=Math.min(t.pageSize*t.page,s-1),l=-1===t.pageSize?s-1:Math.min(a+t.pageSize-1,s-1);if(-1===a||-1===l)return null;if(r<2)return{firstRowIndex:a,lastRowIndex:l};const c=o[a],u=l-a+1,d=i.findIndex(e=>e.id===c.id);let h=d,p=0;for(;h<i.length&&p<=u;){const e=i[h],t=n[e.id]?.depth;void 0===t?h+=1:((p<u||t>0)&&(h+=1),0===t&&(p+=1))}return{firstRowIndex:d,lastRowIndex:h-1}}),e7=y3(A8,Z8,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),t7=y3(D8,Z8,(e,t)=>t?e.slice(t.firstRowIndex,t.lastRowIndex+1):[]),n7=y3(U8,Z8,e7,A8,(e,t,n,r)=>e?{rows:n,range:t,rowIdToIndexMap:n.reduce((e,t,n)=>(e.set(t.id,n),e),new Map)}:{rows:r,range:0===r.length?null:{firstRowIndex:0,lastRowIndex:r.length-1},rowIdToIndexMap:r.reduce((e,t,n)=>(e.set(t.id,n),e),new Map)}),r7=(e,t)=>n7(e),i7=(e,t)=>$2(e,n7),o7=("undefined"!==typeof navigator?navigator.userAgent.toLowerCase():"empty").includes("firefox"),s7=S3(e=>e.rowsMeta),a7=S3(e=>e.virtualization),l7=(C3(a7,e=>e.enabled),C3(a7,e=>e.enabledForColumns)),c7=C3(a7,e=>e.enabledForRows),u7=C3(a7,e=>e.renderContext),d7=y3(S3(e=>e.virtualization.renderContext.firstColumnIndex),S3(e=>e.virtualization.renderContext.lastColumnIndex),(e,t)=>({firstColumnIndex:e,lastColumnIndex:t}));function h7(e,n,r){const i=t.useRef(!0);v4(()=>{i.current=!1,e.current.register(r,n)},[e,r,n]),i.current&&e.current.register(r,n)}const p7={firstRowIndex:0,lastRowIndex:0,firstColumnIndex:0,lastColumnIndex:0},g7=(e,t)=>{const{disableVirtualization:n,autoHeight:r}=t;return $Q({},e,{virtualization:{enabled:!n,enabledForColumns:!n,enabledForRows:!n&&!r,renderContext:p7}})};const f7=S3(e=>e.rowSpanning),m7=C3(f7,e=>e.hiddenCells),v7=C3(f7,e=>e.spannedCells),w7=C3(f7,e=>e.hiddenCellOriginMap),b7=S3(e=>e.listViewColumn),C7=S3(e=>e.focus),y7=C3(C7,e=>e.cell),S7=C3(C7,e=>e.columnHeader),x7=(C3(C7,e=>e.columnHeaderFilter),C3(C7,e=>e.columnGroupHeader)),R7=S3(e=>e.tabIndex),E7=C3(R7,e=>e.cell),T7=C3(R7,e=>e.columnHeader),k7=(C3(R7,e=>e.columnHeaderFilter),C3(R7,e=>e.columnGroupHeader)),M7=C3(y7,u7,n7,V3,(e,t,n,r)=>{if(!e)return!1;const i=n.rowIdToIndexMap.get(e.id),o=r.slice(t.firstColumnIndex,t.lastColumnIndex).findIndex(t=>t.field===e.field);return!(void 0!==i&&-1!==o&&i>=t.firstRowIndex&&i<=t.lastRowIndex)}),P7=y3(M7,V3,n7,y7,(e,t,n,r)=>{if(!e)return null;const i=n.rowIdToIndexMap.get(r.id);if(void 0===i)return null;const o=t.findIndex(e=>e.field===r.field);return-1===o?null:$Q({},r,{rowIndex:i,columnIndex:o})});function I7(e,t){return Math.round(e*10**t)/10**t}const A7="undefined"!==typeof window&&/jsdom|HappyDOM/.test(window.navigator.userAgent);class D7{constructor(e){this.data=void 0,this.data=e.ids}has(e){return this.data.has(e)}select(e){this.data.add(e)}unselect(e){this.data.delete(e)}}class F7{constructor(e){this.data=void 0,this.data=e.ids}has(e){return!this.data.has(e)}select(e){this.data.delete(e)}unselect(e){this.data.add(e)}}const O7=e=>"include"===e.type?new D7(e):new F7(e),N7=S3(e=>e.rowSelection),L7=y3(N7,O7),_7=C3(N7,H8,(e,t)=>"include"===e.type?e.ids.size:t-e.ids.size),H7=y3(N7,W4,Y4,(e,t,n)=>{const r=new Map;if("include"===e.type)for(const i of e.ids)r.set(i,t[i]);else for(let i=0;i<n.length;i+=1){const o=n[i];e.ids.has(o)||r.set(o,t[o])}return r});var V7=function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT",e}(V7||{});const B7={top:0,left:0},W7=Object.freeze(new Map),z7=()=>{const e=K2(),n=e3(),{listView:r}=n,i=$2(e,()=>r?[b7(e)]:V3(e)),s=$2(e,c7)&&!A7,a=$2(e,l7)&&!A7,l=$2(e,X4),c=z3(e),u=r?A3:c,d=l.bottom.length>0,[h,p]=t.useState(W7),g=z6(),f=$2(e,L7),m=i7(e),v=e.current.mainElementRef,w=e.current.virtualScrollerRef,b=e.current.virtualScrollbarVerticalRef,C=e.current.virtualScrollbarHorizontalRef,y=$2(e,K3),S=t.useRef(!1),x=$2(e,a4),R=$2(e,l4),E=$2(e,s4),T=$2(e,j7),k=$2(e,f4),M=$2(e,d4),P=t.useRef(null),I=t.useCallback(t=>{if(v.current=t,!t)return;const n=t.getBoundingClientRect();let r={width:I7(n.width,1),height:I7(n.height,1)};if((!P.current||r.width!==P.current.width&&r.height!==P.current.height)&&(P.current=r,e.current.publishEvent("resize",r)),"undefined"===typeof ResizeObserver)return;const i=new ResizeObserver(t=>{const n=t[0];if(!n)return;const i={width:I7(n.contentRect.width,1),height:I7(n.contentRect.height,1)};i.width===r.width&&i.height===r.height||(e.current.publishEvent("resize",i),r=i)});return i.observe(t),KQ>=19?()=>{v.current=null,i.disconnect()}:void 0},[e,v]),A=t.useRef(n.initialState?.scroll??B7),D=t.useRef(!1),F=t.useRef(B7),O=t.useRef(p7),N=$2(e,u7),L=$2(e,P7),_=A4(),H=t.useRef(void 0),V=H2(()=>((e,t,n,r,i)=>({direction:V7.NONE,buffer:Q7(e,V7.NONE,t,n,r,i)}))(g,n.rowBufferPx,n.columnBufferPx,15*x,300)).current,B=t.useCallback(t=>{if(q7(t,e.current.state.virtualization.renderContext))return;const n=t.firstRowIndex!==O.current.firstRowIndex||t.lastRowIndex!==O.current.lastRowIndex;e.current.setState(e=>$Q({},e,{virtualization:$Q({},e.virtualization,{renderContext:t})}));o4(e).isReady&&n&&(O.current=t,e.current.publishEvent("renderedRowsIntervalChange",t)),F.current=A.current},[e]),W=w4(()=>{const t=w.current;if(!t)return;const r=o4(e),i=Math.ceil(r.minimumSize.height-r.viewportOuterSize.height),l=Math.ceil(r.minimumSize.width-r.viewportInnerSize.width),c={top:g5(t.scrollTop,0,i),left:g?g5(t.scrollLeft,-l,0):g5(t.scrollLeft,0,l)},u=c.left-A.current.left,d=c.top-A.current.top,h=0!==u||0!==d;A.current=c;const p=h?function(e,t){if(0===e&&0===t)return V7.NONE;return Math.abs(t)>=Math.abs(e)?t>0?V7.DOWN:V7.UP:e>0?V7.RIGHT:V7.LEFT}(u,d):V7.NONE,f=Math.abs(A.current.top-F.current.top),m=Math.abs(A.current.left-F.current.left),v=f>=x||m>=50,b=V.direction!==p;if(!(v||b))return N;if(b)switch(p){case V7.NONE:case V7.LEFT:case V7.RIGHT:H.current=void 0;break;default:H.current=N}V.direction=p,V.buffer=Q7(g,p,n.rowBufferPx,n.columnBufferPx,15*x,300);const C=$7(G7(e,n,s,a),A.current,V);return q7(C,N)||(o.flushSync(()=>{B(C)}),_.start(1e3,W)),C}),z=()=>{if(!o4(e).isReady&&(s||a))return;const t=$7(G7(e,n,s,a),A.current,V);H.current=void 0,B(t)},j=w4(()=>{if(D.current)return void(D.current=!1);const t=W();e.current.publishEvent("scrollPositionChange",{top:A.current.top,left:A.current.left,renderContext:t})}),G=w4(t=>{e.current.publishEvent("virtualScrollerWheel",{},t)}),$=w4(t=>{e.current.publishEvent("virtualScrollerTouchMove",{},t)}),U=t.useMemo(()=>({overflowX:!T||r?"hidden":void 0,overflowY:n.autoHeight?"hidden":void 0}),[T,n.autoHeight,r]),K=t.useMemo(()=>{const e={width:T?E:"auto",flexBasis:R,flexShrink:0};return 0===e.flexBasis&&(e.flexBasis=o6),e},[E,R,T]),Y=t.useCallback(t=>{t&&e.current.publishEvent("virtualScrollerContentSizeChange",{columnsTotalWidth:E,contentHeight:R})},[e,E,R]);return v4(()=>{S.current&&e.current.updateRenderContext?.()},[e,a,s]),v4(()=>{r&&(w.current.scrollLeft=0)},[r,w]),((e,n)=>{const r=t.useRef(!1);v4(()=>r.current||!e?b8:(r.current=!0,n()),[r.current||e])})(N!==p7,()=>{if(e.current.publishEvent("scrollPositionChange",{top:A.current.top,left:A.current.left,renderContext:N}),S.current=!0,n.initialState?.scroll&&w.current){const t=w.current,{top:r,left:i}=n.initialState.scroll,o={top:!(r>0),left:!(i>0)};if(!o.left&&E&&(t.scrollLeft=i,D.current=!0,o.left=!0),!o.top&&R&&(t.scrollTop=r,D.current=!0,o.top=!0),!o.top||!o.left){const n=e.current.subscribeEvent("virtualScrollerContentSizeChange",e=>{!o.left&&e.columnsTotalWidth&&(t.scrollLeft=i,D.current=!0,o.left=!0),!o.top&&e.contentHeight&&(t.scrollTop=r,D.current=!0,o.top=!0),o.left&&o.top&&n()});return n}}}),e.current.register("private",{updateRenderContext:z}),T4(e,"sortedRowsSet",z),T4(e,"paginationModelChange",z),T4(e,"columnsChange",z),{renderContext:N,setPanels:p,getRows:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.rows&&!m.range)return[];const r=z4(e);let o=N;t.renderContext&&(o=t.renderContext,o.firstColumnIndex=N.firstColumnIndex,o.lastColumnIndex=N.lastColumnIndex);const s=!d&&void 0===t.position||d&&"bottom"===t.position,a=void 0!==t.position;let c;switch(t.position){case"top":c=0;break;case"bottom":c=l.top.length+m.rows.length;break;case void 0:c=l.top.length}const p=t.rows??m.rows,g=o.firstRowIndex,v=Math.min(o.lastRowIndex,p.length),w=t.rows?f5(0,t.rows.length):f5(g,v);let b=-1;!a&&L&&(L.rowIndex<g&&(w.unshift(L.rowIndex),b=L.rowIndex),L.rowIndex>v&&(w.push(L.rowIndex),b=L.rowIndex));const C=[],S=n.slotProps?.row,x=G3(e);return w.forEach(l=>{const{id:d,model:g}=p[l];if(!r[d])return;const v=(m?.range?.firstRowIndex||0)+c+l;if(y){const t=u.left.length,n=i.length-u.right.length;e.current.calculateColSpan({rowId:d,minFirstColumn:t,maxLastColumn:n,columns:i}),u.left.length>0&&e.current.calculateColSpan({rowId:d,minFirstColumn:0,maxLastColumn:u.left.length,columns:i}),u.right.length>0&&e.current.calculateColSpan({rowId:d,minFirstColumn:i.length-u.right.length,maxLastColumn:i.length,columns:i})}const w=e.current.rowHasAutoHeight(d)?"auto":e.current.unstable_getRowHeight(d),R=f.has(d)&&e.current.isRowSelectable(d);let T=!1;void 0===t.position&&(T=0===l);let P=!1;const I=l===p.length-1;if(s)if(a)P=I;else{l===m.rows.length-1&&(P=!0)}let A=o;H.current&&l>=H.current.firstRowIndex&&l<H.current.lastRowIndex&&(A=H.current);const D=l===b,F=L?.rowIndex===v,O=X7(x,A,u.left.length),N=I&&"top"===t.position,_=A.firstColumnIndex,V=A.lastColumnIndex;if(C.push((0,MH.jsx)(n.slots.row,$Q({row:g,rowId:d,index:v,selected:R,offsetLeft:O,columnsTotalWidth:E,rowHeight:w,pinnedColumns:u,visibleColumns:i,firstColumnIndex:_,lastColumnIndex:V,focusedColumnIndex:F?L.columnIndex:void 0,isFirstVisible:T,isLastVisible:P,isNotVisible:D,showBottomBorder:N,scrollbarWidth:k,gridHasFiller:M},S),d)),D)return;const B=h.get(d);B&&C.push(B),void 0===t.position&&I&&C.push(e.current.getInfiniteLoadingTriggerElement?.({lastRowId:d}))}),C},getContainerProps:()=>({ref:I}),getScrollerProps:()=>({ref:w,onScroll:j,onWheel:G,onTouchMove:$,style:U,role:"presentation",tabIndex:o7?-1:void 0}),getContentProps:()=>({style:K,role:"presentation",ref:Y}),getRenderZoneProps:()=>({role:"rowgroup"}),getScrollbarVerticalProps:()=>({ref:b,scrollPosition:A}),getScrollbarHorizontalProps:()=>({ref:C,scrollPosition:A}),getScrollAreaProps:()=>({scrollPosition:A})}};function j7(e){return e.current.state.dimensions.viewportOuterSize.width>0&&e.current.state.dimensions.columnsTotalWidth>e.current.state.dimensions.viewportOuterSize.width}function G7(e,t,n,r){const i=o4(e),o=r7(e),s=t.listView?[b7(e)]:V3(e),a=w7(e),l=e.current.state.rows.dataRowIds.at(-1),c=s.at(-1);return{enabledForRows:n,enabledForColumns:r,apiRef:e,autoHeight:t.autoHeight,rowBufferPx:t.rowBufferPx,columnBufferPx:t.columnBufferPx,leftPinnedWidth:i.leftPinnedWidth,columnsTotalWidth:i.columnsTotalWidth,viewportInnerWidth:i.viewportInnerSize.width,viewportInnerHeight:i.viewportInnerSize.height,lastRowHeight:void 0!==l?e.current.unstable_getRowHeight(l):0,lastColumnWidth:c?.computedWidth??0,rowsMeta:s7(e),columnPositions:G3(e),rows:o.rows,range:o.range,pinnedColumns:z3(e),visibleColumns:s,hiddenCellsOriginMap:a,listView:t.listView??!1,virtualizeColumnsWithAutoRowHeight:t.virtualizeColumnsWithAutoRowHeight}}function $7(e,t,n){const r={firstRowIndex:0,lastRowIndex:e.rows.length,firstColumnIndex:0,lastColumnIndex:e.visibleColumns.length},{top:i,left:o}=t,s=Math.abs(o)+e.leftPinnedWidth;if(e.enabledForRows){let t=Math.min(U7(e,i,{atStart:!0,lastPosition:e.rowsMeta.positions[e.rowsMeta.positions.length-1]+e.lastRowHeight}),e.rowsMeta.positions.length-1);const n=e.hiddenCellsOriginMap[t];if(n){const e=Math.min(...Object.values(n));t=Math.min(t,e)}const o=e.autoHeight?t+e.rows.length:U7(e,i+e.viewportInnerHeight);r.firstRowIndex=t,r.lastRowIndex=o}if(e.listView)return $Q({},r,{lastColumnIndex:1});if(e.enabledForColumns){let t=0,i=e.columnPositions.length,o=!1;const[a,l]=Y7({firstIndex:r.firstRowIndex,lastIndex:r.lastRowIndex,minFirstIndex:0,maxLastIndex:e.rows.length,bufferBefore:n.buffer.rowBefore,bufferAfter:n.buffer.rowAfter,positions:e.rowsMeta.positions,lastSize:e.lastRowHeight});if(!e.virtualizeColumnsWithAutoRowHeight)for(let n=a;n<l&&!o;n+=1){const t=e.rows[n];o=e.apiRef.current.rowHasAutoHeight(t.id)}o&&!e.virtualizeColumnsWithAutoRowHeight||(t=K7(s,e.columnPositions,{atStart:!0,lastPosition:e.columnsTotalWidth}),i=K7(s+e.viewportInnerWidth,e.columnPositions)),r.firstColumnIndex=t,r.lastColumnIndex=i}const a=function(e,t,n){const[r,i]=Y7({firstIndex:t.firstRowIndex,lastIndex:t.lastRowIndex,minFirstIndex:0,maxLastIndex:e.rows.length,bufferBefore:n.buffer.rowBefore,bufferAfter:n.buffer.rowAfter,positions:e.rowsMeta.positions,lastSize:e.lastRowHeight}),[o,s]=Y7({firstIndex:t.firstColumnIndex,lastIndex:t.lastColumnIndex,minFirstIndex:e.pinnedColumns.left.length,maxLastIndex:e.visibleColumns.length-e.pinnedColumns.right.length,bufferBefore:n.buffer.columnBefore,bufferAfter:n.buffer.columnAfter,positions:e.columnPositions,lastSize:e.lastColumnWidth}),a=function(e){let{firstColumnToRender:t,apiRef:n,firstRowToRender:r,lastRowToRender:i,visibleRows:o}=e,s=t,a=!1;for(;!a&&s>=0;){a=!0;for(let e=r;e<i;e+=1)if(o[e]){const t=o[e].id,r=n.current.unstable_getCellColSpanInfo(t,s);if(r&&r.spannedByColSpan&&r.leftVisibleCellIndex<s){s=r.leftVisibleCellIndex,a=!1;break}}}return s}({firstColumnToRender:o,apiRef:e.apiRef,firstRowToRender:r,lastRowToRender:i,visibleRows:e.rows});return{firstRowIndex:r,lastRowIndex:i,firstColumnIndex:a,lastColumnIndex:s}}(e,r,n);return a}function U7(e,t,n){const r=e.apiRef.current.getLastMeasuredRowIndex();let i=r===1/0;e.range?.lastRowIndex&&!i&&(i=r>=e.range.lastRowIndex);const o=g5(r-(e.range?.firstRowIndex||0),0,e.rowsMeta.positions.length);return i||e.rowsMeta.positions[o]>=t?K7(t,e.rowsMeta.positions,n):function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=1;for(;n<t.length&&Math.abs(t[n])<e;)n+=i,i*=2;return K7(e,t,r,Math.floor(n/2),Math.min(n,t.length))}(t,e.rowsMeta.positions,o,n)}function K7(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length;if(t.length<=0)return-1;if(r>=i)return r;const o=r+Math.floor((i-r)/2),s=t[o];let a;if(n?.atStart){a=e-((o===t.length-1?n.lastPosition:t[o+1])-s)<s}else a=e<=s;return a?K7(e,t,n,r,o):K7(e,t,n,o+1,i)}function Y7(e){let{firstIndex:t,lastIndex:n,bufferBefore:r,bufferAfter:i,minFirstIndex:o,maxLastIndex:s,positions:a,lastSize:l}=e;const c=a[t]-r,u=a[n]+i,d=K7(c,a,{atStart:!0,lastPosition:a[a.length-1]+l}),h=K7(u,a);return[g5(d,o,s),g5(h,o,s)]}function q7(e,t){return e===t||e.firstRowIndex===t.firstRowIndex&&e.lastRowIndex===t.lastRowIndex&&e.firstColumnIndex===t.firstColumnIndex&&e.lastColumnIndex===t.lastColumnIndex}function X7(e,t,n){const r=(e[t.firstColumnIndex]??0)-(e[n]??0);return Math.abs(r)}function Q7(e,t,n,r,i,o){if(e)switch(t){case V7.LEFT:t=V7.RIGHT;break;case V7.RIGHT:t=V7.LEFT}switch(t){case V7.NONE:return{rowAfter:n,rowBefore:n,columnAfter:r,columnBefore:r};case V7.LEFT:return{rowAfter:0,rowBefore:0,columnAfter:0,columnBefore:o};case V7.RIGHT:return{rowAfter:0,rowBefore:0,columnAfter:o,columnBefore:0};case V7.UP:return{rowAfter:0,rowBefore:i,columnAfter:0,columnBefore:0};case V7.DOWN:return{rowAfter:i,rowBefore:0,columnAfter:0,columnBefore:0};default:throw new Error("unreachable")}}const J7=i4("div",{name:"MuiDataGrid",slot:"OverlayWrapper",shouldForwardProp:e=>"overlayType"!==e&&"loadingOverlayVariant"!==e&&"right"!==e})(e=>{let{overlayType:t,loadingOverlayVariant:n,right:r}=e;return"skeleton"!==n?{position:"sticky",top:"var(--DataGrid-headersTotalHeight)",left:0,right:`${r}px`,width:0,height:0,zIndex:"loadingOverlay"===t?5:4}:{}}),Z7=i4("div",{name:"MuiDataGrid",slot:"OverlayWrapperInner",shouldForwardProp:e=>"overlayType"!==e&&"loadingOverlayVariant"!==e})({});function e9(e){const t=J3(),n=e3(),r=$2(t,o4);let i=Math.max(r.viewportOuterSize.height-r.topContainerHeight-r.bottomContainerHeight-(r.hasScrollX?r.scrollbarSize:0),0);0===i&&(i=o6);const o=(e=>{const{classes:t}=e;return tJ({root:["overlayWrapper"],inner:["overlayWrapperInner"]},P2,t)})($Q({},e,{classes:n.classes}));return(0,MH.jsx)(J7,$Q({className:o.root},e,{right:r.columnsTotalWidth-r.viewportOuterSize.width,children:(0,MH.jsx)(Z7,$Q({className:o.inner,style:{height:i,width:r.viewportOuterSize.width}},e))}))}const t9=S3(e=>e.pivoting),n9=C3(t9,e=>e?.active),r9=new Map,i9=C3(t9,e=>e?.initialColumns||r9),o9=(C3(t9,e=>e?.panelOpen),S3(e=>e.columnMenu));const s9=iJ(function(){const e=K2(),t=e3(),n=$2(e,V3),r=$2(e,B8),i=$2(e,E8),o=$2(e,T7),s=$2(e,()=>null===E7(e)),a=$2(e,k7),l=$2(e,S7),c=$2(e,x7),u=$2(e,l8),d=$2(e,o9),h=$2(e,_3),p=$2(e,a8),g=!(null===a&&null===o&&s),f=e.current.columnHeadersContainerRef;return(0,MH.jsx)(t.slots.columnHeaders,$Q({ref:f,visibleColumns:n,filterColumnLookup:r,sortColumnLookup:i,columnHeaderTabIndexState:o,columnGroupHeaderTabIndexState:a,columnHeaderFocus:l,columnGroupHeaderFocus:c,headerGroupingMaxDepth:u,columnMenuState:d,columnVisibility:h,columnGroupsHeaderStructure:p,hasOtherElementInTabSequence:g},t.slotProps?.columnHeaders))}),a9=i4("div")({position:"absolute",top:"var(--DataGrid-headersTotalHeight)",left:0,width:"calc(100% - (var(--DataGrid-hasScrollY) * var(--DataGrid-scrollbarSize)))"}),l9=i4("div",{name:"MuiDataGrid",slot:"Main",overridesResolver:(e,t)=>{const{ownerState:n,loadingOverlayVariant:r,overlayType:i}=e,o="skeleton"===r||"noColumnsOverlay"===i;return[t.main,n.hasPinnedRight&&t["main--hasPinnedRight"],o&&t["main--hiddenContent"]]}})({flexGrow:1,position:"relative",overflow:"hidden",display:"flex",flexDirection:"column"}),c9=YQ((e,t)=>{const{ownerState:n}=e,r=e3(),i=n3().hooks.useGridAriaAttributes();return(0,MH.jsxs)(l9,$Q({ownerState:n,className:e.className,tabIndex:-1},i,r.slotProps?.main,{ref:t,children:[(0,MH.jsx)(a9,{role:"presentation","data-id":"gridPanelAnchor"}),e.children]}))});const u9=i4("div")({position:"sticky",zIndex:40,top:0});function d9(e){const t=tJ({root:["topContainer"]},P2,{});return(0,MH.jsx)(u9,$Q({},e,{className:QQ(t.root,I2["container--top"]),role:"presentation"}))}const h9=i4("div",{name:"MuiDataGrid",slot:"VirtualScrollerContent",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.virtualScrollerContent,n.overflowedContent&&t["virtualScrollerContent--overflowed"]]}})({}),p9=YQ(function(e,t){const n=e3(),r=!n.autoHeight&&"auto"===e.style?.minHeight,i=((e,t)=>{const{classes:n}=e;return tJ({root:["virtualScrollerContent",t&&"virtualScrollerContent--overflowed"]},P2,n)})(n,r),o={classes:n.classes,overflowedContent:r};return(0,MH.jsx)(h9,$Q({},e,{ownerState:o,className:QQ(i.root,e.className),ref:t}))});const g9=i4("div")({display:"flex",flexDirection:"row",width:"var(--DataGrid-rowWidth)",boxSizing:"border-box"}),f9=i4("div")({position:"sticky",height:"100%",boxSizing:"border-box",borderTop:"1px solid var(--rowBorderColor)",backgroundColor:O2.cell.background.pinned}),m9=i4(f9)({left:0,borderRight:"1px solid var(--rowBorderColor)"}),v9=i4(f9)({right:0,borderLeft:"1px solid var(--rowBorderColor)"}),w9=i4("div")({flexGrow:1,borderTop:"1px solid var(--rowBorderColor)"});const b9=iJ(function(e){let{rowsLength:t}=e;const n=J3(),{viewportOuterSize:r,minimumSize:i,hasScrollX:o,hasScrollY:s,scrollbarSize:a,leftPinnedWidth:l,rightPinnedWidth:c}=$2(n,o4),u=o?a:0,d=r.height-i.height>0;return 0!==u||d?(0,MH.jsxs)(g9,{className:I2.filler,role:"presentation",style:{height:u,"--rowBorderColor":0===t?"transparent":"var(--DataGrid-rowBorderColor)"},children:[l>0&&(0,MH.jsx)(m9,{className:I2["filler--pinnedLeft"],style:{width:l}}),(0,MH.jsx)(w9,{}),c>0&&(0,MH.jsx)(v9,{className:I2["filler--pinnedRight"],style:{width:c+(s?a:0)}})]}):null}),C9=["className"],y9=i4("div",{name:"MuiDataGrid",slot:"VirtualScrollerRenderZone"})({position:"absolute",display:"flex",flexDirection:"column"}),S9=YQ(function(e,t){const{className:n}=e,r=qQ(e,C9),i=J3(),o=e3(),s=(e=>{const{classes:t}=e;return tJ({root:["virtualScrollerRenderZone"]},P2,t)})(o),a=$2(i,()=>{const e=u7(i);return s7(i).positions[e.firstRowIndex]??0});return(0,MH.jsx)(y9,$Q({className:QQ(s.root,n),ownerState:o,style:{transform:`translate3d(0, ${a}px, 0)`}},r,{ref:t}))});const x9=i4("div")({position:"absolute",display:"inline-block",zIndex:60,"&:hover":{zIndex:70},"--size":"calc(max(var(--DataGrid-scrollbarSize), 14px))"}),R9=i4(x9)({width:"var(--size)",height:"calc(var(--DataGrid-hasScrollY) * (100% - var(--DataGrid-topContainerHeight) - var(--DataGrid-bottomContainerHeight) - var(--DataGrid-hasScrollX) * var(--DataGrid-scrollbarSize)))",overflowY:"auto",overflowX:"hidden",outline:0,"& > div":{width:"var(--size)"},top:"var(--DataGrid-topContainerHeight)",right:"0px"}),E9=i4(x9)({width:"100%",height:"var(--size)",overflowY:"hidden",overflowX:"auto",outline:0,"& > div":{height:"var(--size)"},bottom:"0px"}),T9=YQ(function(e,n){const r=K2(),i=e3(),o=t.useRef(!1),s=t.useRef(0),a=t.useRef(null),l=t.useRef(null),c=((e,t)=>{const{classes:n}=e;return tJ({root:["scrollbar",`scrollbar--${t}`],content:["scrollbarContent"]},P2,n)})(i,e.position),u=$2(r,o4),d="vertical"===e.position?"height":"width",h="vertical"===e.position?"scrollTop":"scrollLeft",p="vertical"===e.position?"top":"left",g="vertical"===e.position?u.hasScrollX:u.hasScrollY,f=u.minimumSize[d]+(g?u.scrollbarSize:0),m=("vertical"===e.position?u.viewportInnerSize.height:u.viewportOuterSize.width)*(f/u.viewportOuterSize[d]),v=w4(()=>{const t=a.current,n=e.scrollPosition.current;if(!t)return;if(n[p]===s.current)return;if(s.current=n[p],o.current)return void(o.current=!1);o.current=!0;const r=n[p]/f;t[h]=r*m}),w=w4(()=>{const e=r.current.virtualScrollerRef.current,t=a.current;if(!t)return;if(o.current)return void(o.current=!1);o.current=!0;const n=t[h]/m;e[h]=n*f});P4(()=>{const e=r.current.virtualScrollerRef.current,t=a.current,n={passive:!0};return e.addEventListener("scroll",v,n),t.addEventListener("scroll",w,n),()=>{e.removeEventListener("scroll",v,n),t.removeEventListener("scroll",w,n)}}),t.useEffect(()=>{l.current.style.setProperty(d,`${m}px`)},[m,d]);const b="vertical"===e.position?R9:E9;return(0,MH.jsx)(b,{ref:JQ(n,a),className:c.root,style:"vertical"===e.position&&i.listView?{height:"100%",top:0}:void 0,tabIndex:-1,"aria-hidden":"true",onFocus:e=>{e.target.blur()},children:(0,MH.jsx)("div",{ref:l,className:c.content})})});const k9=i4("div",{name:"MuiDataGrid",slot:"VirtualScroller",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.virtualScroller,n.hasScrollX&&t["virtualScroller--hasScrollX"]]}})({position:"relative",height:"100%",flexGrow:1,overflow:"scroll",scrollbarWidth:"none",display:"flex",flexDirection:"column","&::-webkit-scrollbar":{display:"none"},"@media print":{overflow:"hidden"},zIndex:0}),M9=e=>e.current.state.dimensions.rightPinnedWidth>0;function P9(e){const t=J3(),n=e3(),r=$2(t,u4),i=$2(t,c4),o=$2(t,M9),s=$2(t,m4),{getOverlay:a,overlaysProps:l}=(()=>{const e=J3(),t=e3(),n=$2(e,H4),r=$2(e,L8),i=$2(e,Q4),o=$2(e,V3),s=0===n&&0===i,a=$2(e,V4),l=$2(e,n9),c=!a&&s,u=!a&&n>0&&0===r,d=!a&&0===o.length;let h=null,p=null;c&&(h="noRowsOverlay"),d&&(h="noColumnsOverlay"),c&&l&&(h="emptyPivotOverlay"),u&&(h="noResultsOverlay"),a&&(h="loadingOverlay",p=t.slotProps?.loadingOverlay?.[s?"noRowsVariant":"variant"]??(s?"skeleton":"linear-progress"));const g={overlayType:h,loadingOverlayVariant:p};return{getOverlay:()=>{if(!h)return null;const e=t.slots?.[h],n=t.slotProps?.[h];return(0,MH.jsx)(e9,$Q({},g,{children:(0,MH.jsx)(e,$Q({},n))}))},overlaysProps:g}})(),c=$Q({classes:n.classes,hasScrollX:i,hasPinnedRight:o},l),u=(e=>{const{classes:t,hasScrollX:n,hasPinnedRight:r,loadingOverlayVariant:i,overlayType:o}=e;return tJ({root:["main",r&&"main--hasPinnedRight",("skeleton"===i||"noColumnsOverlay"===o)&&"main--hiddenContent"],scroller:["virtualScroller",n&&"virtualScroller--hasScrollX"]},P2,t)})(c),d=z7(),{getContainerProps:h,getScrollerProps:p,getContentProps:g,getRenderZoneProps:f,getScrollbarVerticalProps:m,getScrollbarHorizontalProps:v,getRows:w,getScrollAreaProps:b}=d,C=w();return(0,MH.jsxs)(c9,$Q({className:u.root},h(),{ownerState:c,children:[(0,MH.jsx)(w8,$Q({scrollDirection:"left"},b())),(0,MH.jsx)(w8,$Q({scrollDirection:"right"},b())),(0,MH.jsxs)(k9,$Q({className:u.scroller},p(),{ownerState:c,children:[(0,MH.jsxs)(d9,{children:[!n.listView&&(0,MH.jsx)(s9,{}),(0,MH.jsx)(n.slots.pinnedRows,{position:"top",virtualScroller:d})]}),a(),(0,MH.jsx)(p9,$Q({},g(),{children:(0,MH.jsxs)(S9,$Q({},f(),{children:[C,(0,MH.jsx)(n.slots.detailPanels,{virtualScroller:d})]}))})),s&&(0,MH.jsx)(b9,{rowsLength:C.length}),(0,MH.jsx)(n.slots.bottomContainer,{children:(0,MH.jsx)(n.slots.pinnedRows,{position:"bottom",virtualScroller:d})})]})),i&&!n.listView&&(0,MH.jsx)(T9,$Q({position:"horizontal"},v())),r&&(0,MH.jsx)(T9,$Q({position:"vertical"},m())),e.children]}))}function I9(){const e=e3();return e.hideFooter?null:(0,MH.jsx)(e.slots.footer,$Q({},e.slotProps?.footer))}const A9=["className","children","sidePanel"],D9=YQ(function(e,n){const r=e3(),{className:i,children:o,sidePanel:s}=e,a=qQ(e,A9),l=K2(),c=$2(l,E3),u=l.current.rootElementRef,d=t.useCallback(e=>{null!==e&&l.current.publishEvent("rootMount",e)},[l]),h=JQ(u,n,d),p=r,g=((e,t)=>{const{autoHeight:n,classes:r,showCellVerticalBorder:i}=e;return tJ({root:["root",n&&"autoHeight",`root--density${eJ(t)}`,null===e.slots.toolbar&&"root--noToolbar","withBorderColor",i&&"withVerticalBorder"]},P2,r)})(p,c),f=t.useContext(r3);return(0,L2.useSyncExternalStore)(k3,M3,P3)?null:(0,MH.jsxs)(X2,$Q({className:QQ(g.root,i,f.className,s&&I2.withSidePanel),ownerState:p},a,{ref:h,children:[(0,MH.jsxs)("div",{className:I2.mainContent,role:"presentation",children:[(0,MH.jsx)(r4,{}),(0,MH.jsx)(P9,{children:o}),(0,MH.jsx)(I9,{})]}),s,f.tag]}))});const F9=iJ(D9);function O9(e,t){const n=z4(e),r=S8(e),i=I8(e),o=n[t];if(!o||"group"!==o.type)return[];const s=[];for(let a=r.findIndex(e=>e===t)+1;a<r.length&&n[r[a]]?.depth>o.depth;a+=1){const t=r[a];!1!==i[t]&&e.current.isRowSelectable(t)&&s.push(t)}return s}const N9=C3(z4,I8,L7,(e,t,n,r)=>{let{groupId:i,autoSelectParents:o}=r;const s=e[i];if(!s||"group"!==s.type||n.has(i))return{isIndeterminate:!1,isChecked:n.has(i)};let a=!1,l=!1;const c=r=>{if(!1===t[r]||a&&l)return;const i=e[r];"group"===i?.type&&i.children.forEach(c),n.has(r)?a=!0:l=!0};return c(i),{isIndeterminate:a&&l,isChecked:!!o&&(a&&!l)}});function L9(e){return e.signature===W8.DataGrid?e.checkboxSelection&&!0!==e.disableMultipleRowSelection:!e.disableMultipleRowSelection}const _9=function(e,t,n,r,i,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:L7(e);const a=I8(e),l=new Set([]);if((r||i)&&!1!==a[n]){if(r){const r=t[n];if("group"===r?.type){O9(e,n).forEach(e=>{o(e),l.add(e)})}}if(i){const r=e=>{if(!s.has(e)&&!l.has(e))return!1;const n=t[e];return!!n&&("group"!==n.type||n.children.every(r))},i=n=>{const s=((e,t,n)=>{const r=e[n];if(!r)return[];const i=r.parent;return null==i?[]:e[i].children.filter(e=>e!==n&&!1!==t[e])})(t,a,n);if(0===s.length||s.every(r)){const r=t[n],s=r?.parent;null!=s&&s!==X5&&e.current.isRowSelectable(s)&&(o(s),l.add(s),i(s))}};i(n)}}},H9=(e,t,n,r,i,o)=>{const s=L7(e);if(i||r){if(i){const e=((e,t)=>{const n=[];let r=t;for(;null!=r&&r!==X5;){const t=e[r];if(!t)return n;n.push(r),r=t.parent}return n})(t,n);e.forEach(e=>{s.has(e)&&o(e)})}if(r){const r=t[n];if("group"===r?.type){O9(e,n).forEach(e=>{o(e)})}}}};function V9(e){let{privateApiRef:n,configuration:r,props:i,children:o}=e;const s=t.useRef(n.current.getPublicApi());return(0,MH.jsx)(t3.Provider,{value:r,children:(0,MH.jsx)(Z2.Provider,{value:i,children:(0,MH.jsx)(U2.Provider,{value:n,children:(0,MH.jsx)(Q3.Provider,{value:s,children:(0,MH.jsx)(t4,{children:(0,MH.jsx)(o3,{children:o})})})})})})}const B9=function(){try{const e="__some_random_key_you_are_not_going_to_use__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}()&&null!=window.localStorage.getItem("DEBUG"),W9=()=>{},z9={debug:W9,info:W9,warn:W9,error:W9},j9=["debug","info","warn","error"];function G9(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;const r=j9.indexOf(t);if(-1===r)throw new Error(`MUI X: Log level ${t} not recognized.`);const i=j9.reduce((t,i,o)=>(t[i]=o>=r?function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];const[s,...a]=r;n[i](`MUI X: ${e} - ${s}`,...a)}:W9,t),{});return i}function $9(e){return $9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$9(e)}function U9(e){var t=function(e,t){if("object"!=$9(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$9(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$9(t)?t:t+""}let K9=function(e){return e.DataSource="dataSource",e.RowTree="rowTree",e}({});const Y9="none",q9={dataSourceRowsUpdate:K9.DataSource,rowTreeCreation:K9.RowTree,filtering:K9.RowTree,sorting:K9.RowTree,visibleRowsLookupCreation:K9.RowTree},X9=(e,t)=>$Q({},e,{props:{getRowId:t.getRowId}}),Q9=(e,n)=>{(e=>{const n=t.useRef(null),r=t.useRef(null),i=t.useRef(null),o=t.useRef(null),s=t.useRef(null),a=t.useRef(null);e.current.register("public",{rootElementRef:n}),e.current.register("private",{mainElementRef:r,virtualScrollerRef:i,virtualScrollbarVerticalRef:o,virtualScrollbarHorizontalRef:s,columnHeadersContainerRef:a})})(e),((e,n)=>{t.useEffect(()=>{e.current.setState(e=>$Q({},e,{props:{getRowId:n.getRowId}}))},[e,n.getRowId])})(e,n),(e=>{const n=z6();void 0===e.current.state.isRtl&&(e.current.state.isRtl=n);const r=t.useRef(!0);t.useEffect(()=>{r.current?r.current=!1:e.current.setState(e=>$Q({},e,{isRtl:n}))},[e,n])})(e),((e,n)=>{const r=t.useCallback(e=>B9?G9(e,"debug",n.logger):n.logLevel?G9(e,n.logLevel.toString(),n.logger):z9,[n.logLevel,n.logger]);h7(e,{getLogger:r},"private")})(e,n),(e=>{const n=t.useRef({}),r=t.useCallback(e=>{n.current[e.stateId]=e},[]),i=t.useCallback((t,r)=>{let i;if(i="function"===typeof t?t(e.current.state):t,e.current.state===i)return!1;const o={current:{state:i}};let s=!1;const a=[];if(Object.keys(n.current).forEach(t=>{const r=n.current[t],i=r.stateSelector(e),l=r.stateSelector(o);l!==i&&(a.push({stateId:r.stateId,hasPropChanged:l!==r.propModel}),void 0!==r.propModel&&l!==r.propModel&&(s=!0))}),a.length>1)throw new Error(`You're not allowed to update several sub-state in one transaction. You already updated ${a[0].stateId}, therefore, you're not allowed to update ${a.map(e=>e.stateId).join(", ")} in the same transaction.`);if(s||(e.current.state=i,e.current.publishEvent("stateChange",i),e.current.store.update(i)),1===a.length){const{stateId:t,hasPropChanged:i}=a[0],l=n.current[t],c=l.stateSelector(o);l.propOnChange&&i&&l.propOnChange(c,{reason:r,api:e.current}),s||e.current.publishEvent(l.changeEvent,c,{reason:r})}return!s},[e]),o={updateControlState:t.useCallback((t,n,r)=>e.current.setState(e=>$Q({},e,{[t]:n(e[t])}),r),[e]),registerControlState:r};h7(e,{setState:i},"public"),h7(e,o,"private")})(e),(e=>{const n=t.useRef({}),r=t.useRef(!1),i=t.useCallback(e=>{!r.current&&e&&(r.current=!0,Object.values(e.appliers).forEach(e=>{e()}),r.current=!1)},[]),o=t.useCallback((e,t,r)=>{n.current[e]||(n.current[e]={processors:new Map,processorsAsArray:[],appliers:{}});const o=n.current[e];return o.processors.get(t)!==r&&(o.processors.set(t,r),o.processorsAsArray=Array.from(n.current[e].processors.values()).filter(e=>null!==e),i(o)),()=>{n.current[e].processors.set(t,null),n.current[e].processorsAsArray=Array.from(n.current[e].processors.values()).filter(e=>null!==e)}},[i]),s=t.useCallback((e,t,r)=>(n.current[e]||(n.current[e]={processors:new Map,processorsAsArray:[],appliers:{}}),n.current[e].appliers[t]=r,()=>{const r=qQ(n.current[e].appliers,[t].map(U9));n.current[e].appliers=r}),[]),a=t.useCallback(e=>{i(n.current[e])},[i]),l={unstable_applyPipeProcessors:t.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,o,s]=t;if(!n.current[i])return o;const a=n.current[i].processorsAsArray;let l=o;for(let n=0;n<a.length;n+=1)l=a[n](l,s);return l},[])};h7(e,{registerPipeProcessor:o,registerPipeApplier:s,requestPipeProcessorsApplication:a},"private"),h7(e,l,"public")})(e),(e=>{const n=t.useRef(new Map),r=t.useRef({}),i=t.useCallback((t,n,i)=>{const o=()=>{const e=qQ(r.current[n],[t].map(U9));r.current[n]=e};r.current[n]||(r.current[n]={});const s=r.current[n],a=s[t];return s[t]=i,a&&a!==i?(t===e.current.getActiveStrategy(q9[n])&&e.current.publishEvent("activeStrategyProcessorChange",n),o):o},[e]),o=t.useCallback((t,n)=>{const i=e.current.getActiveStrategy(q9[t]);if(null==i)throw new Error("Can't apply a strategy processor before defining an active strategy");const o=r.current[t];if(!o||!o[i])throw new Error(`No processor found for processor "${t}" on strategy "${i}"`);return(0,o[i])(n)},[e]),s=t.useCallback(e=>{const t=Array.from(n.current.entries()).find(t=>{let[,n]=t;return n.group===e&&n.isAvailable()});return t?.[0]??Y9},[]),a=t.useCallback((t,r,i)=>{n.current.set(r,{group:t,isAvailable:i}),e.current.publishEvent("strategyAvailabilityChange")},[e]);h7(e,{registerStrategyProcessor:i,applyStrategyProcessor:o,getActiveStrategy:s,setStrategyAvailability:a},"private")})(e),((e,n)=>{const r=t.useCallback(e=>{if(null==n.localeText[e])throw new Error(`Missing translation for key ${e}.`);return n.localeText[e]},[n.localeText]);e.current.register("public",{getLocaleText:r})})(e,n),e.current.register("private",{rootProps:n})},J9=(e,n,r)=>{const i=t.useRef(!1);i.current||(n.current.state=e(n.current.state,r,n),i.current=!0)};function Z9(e,n){const r=t.useRef(null);if(r.current)return r.current;const i=e.current.getLogger(n);return r.current=i,i}const eee=(e,t,n,r,i)=>{const o=Z9(e,"useNativeEventListener");T4(e,"rootMount",()=>{const e=t();if(e&&n)return o.debug(`Binding native ${n} event`),e.addEventListener(n,r,i),()=>{o.debug(`Clearing native ${n} event`),e.removeEventListener(n,r,i)}})},tee=["field","id","formattedValue","row","rowNode","colDef","isEditable","cellMode","hasFocus","tabIndex","api"],nee=YQ(function(e,n){const{field:r,id:i,rowNode:o,tabIndex:s}=e,a=qQ(e,tee),l=J3(),c=e3(),u=(e=>{const{classes:t}=e;return tJ({root:["checkboxInput"]},P2,t)})({classes:c.classes});t.useLayoutEffect(()=>{if(0===s){const e=l.current.getCellElement(i,r);e&&(e.tabIndex=-1)}},[l,s,i,r]);const d=t.useCallback(e=>{" "===e.key&&e.stopPropagation()},[]),h=l.current.isRowSelectable(i),{isIndeterminate:p,isChecked:g}=$2(l,N9,{groupId:i,autoSelectParents:c.rowSelectionPropagation?.parents??!1});if("footer"===o.type||"pinnedRow"===o.type)return null;const f=l.current.getLocaleText(g&&!p?"checkboxSelectionUnselectRow":"checkboxSelectionSelectRow");return(0,MH.jsx)(c.slots.baseCheckbox,$Q({tabIndex:s,checked:g&&!p,onChange:e=>{const t={value:e.target.checked,id:i};l.current.publishEvent("rowSelectionCheckboxChange",t,e)},className:u.root,slotProps:{htmlInput:{"aria-label":f,name:"select_row"}},onKeyDown:d,indeterminate:p,disabled:!h},c.slotProps?.baseCheckbox,a,{ref:n}))});const ree=nee,iee=["field","colDef"],oee=YQ(function(e,n){const r=qQ(e,iee),[,i]=t.useState(!1),o=J3(),s=e3(),a=(e=>{const{classes:t}=e;return tJ({root:["checkboxInput"]},P2,t)})({classes:s.classes}),l=$2(o,T7),c=$2(o,N7),u=$2(o,D8),d=$2(o,t7),h=t.useMemo(()=>{const e=s.isRowSelectable;if("function"!==typeof e)return c;if("exclude"===c.type)return c;const t={type:"include",ids:new Set};for(const n of c.ids)s.keepNonExistentRowsSelected&&t.ids.add(n),o.current.getRow(n)&&e(o.current.getRowParams(n))&&t.ids.add(n);return t},[o,s.isRowSelectable,s.keepNonExistentRowsSelected,c]),p=t.useMemo(()=>{const e=s.pagination&&s.checkboxSelectionVisibleOnly&&"server"!==s.paginationMode?d:u,t=new Set;for(let n=0;n<e.length;n+=1){const r=e[n];o.current.getRow(r)&&(o.current.isRowSelectable(r)&&t.add(r))}return t},[o,s.pagination,s.paginationMode,s.checkboxSelectionVisibleOnly,d,u]),g=t.useMemo(()=>{const e=O7(h);let t=0;for(const n of p)e.has(n)&&(t+=1);return t},[h,p]),f=t.useMemo(()=>{if(0===h.ids.size)return!1;const e=O7(h);for(const t of p)if(!e.has(t))return!0;return!1},[h,p]),m=g>0,v=null!==l&&l.field===e.field?0:-1;t.useLayoutEffect(()=>{const t=o.current.getColumnHeaderElement(e.field);0===v&&t&&(t.tabIndex=-1)},[v,o,e.field]);const w=t.useCallback(e=>{" "===e.key&&o.current.publishEvent("headerSelectionCheckboxChange",{value:!m})},[o,m]),b=t.useCallback(()=>{i(e=>!e)},[]);t.useEffect(()=>o.current.subscribeEvent("rowSelectionChange",b),[o,b]);const C=o.current.getLocaleText(m&&!f?"checkboxSelectionUnselectAllRows":"checkboxSelectionSelectAllRows");return(0,MH.jsx)(s.slots.baseCheckbox,$Q({indeterminate:f,checked:m&&!f,onChange:e=>{const t={value:e.target.checked};o.current.publishEvent("headerSelectionCheckboxChange",t)},className:a.root,slotProps:{htmlInput:{"aria-label":C,name:"select_all_rows"}},tabIndex:v,onKeyDown:w,disabled:!L9(s)},s.slotProps?.baseCheckbox,r,{ref:n}))});const see="__check__",aee=$Q({},x6,{type:"custom",field:see,width:50,resizable:!1,sortable:!1,filterable:!1,aggregable:!1,disableColumnMenu:!0,disableReorder:!0,disableExport:!0,getApplyQuickFilterFn:()=>null,display:"flex",valueGetter:(e,t,n,r)=>{const i=l6(r,t);return r.current.isRowSelected(i)},renderHeader:e=>(0,MH.jsx)(oee,$Q({},e)),renderCell:e=>(0,MH.jsx)(ree,$Q({},e))});function lee(e,t){if(null===e||void 0===e)return"";const n="string"===typeof e?e:`${e}`;if(t.shouldAppendQuotes||t.escapeFormulas){const e=n.replace(/"/g,'""');return t.escapeFormulas&&["=","+","-","@","\t","\r"].includes(e[0])?`"'${e}"`:[t.delimiter,"\n","\r",'"'].some(e=>n.includes(e))?`"${e}"`:e}return n}const cee=(e,t)=>{const{csvOptions:n,ignoreValueFormatter:r}=t;let i;if(r){const t=e.colDef.type;i="number"===t?String(e.value):"date"===t||"dateTime"===t?e.value?.toISOString():"function"===typeof e.value?.toString?e.value.toString():e.value}else i=e.formattedValue;return lee(i,n)};class uee{constructor(e){this.options=void 0,this.rowString="",this.isEmpty=!0,this.options=e}addValue(e){this.isEmpty||(this.rowString+=this.options.csvOptions.delimiter),"function"===typeof this.options.sanitizeCellValue?this.rowString+=this.options.sanitizeCellValue(e,this.options.csvOptions):this.rowString+=e,this.isEmpty=!1}getRowString(){return this.rowString}}function dee(e){const{columns:t,rowIds:n,csvOptions:r,ignoreValueFormatter:i,apiRef:o}=e,s=n.reduce((e,n)=>`${e}${(e=>{let{id:t,columns:n,getCellParams:r,csvOptions:i,ignoreValueFormatter:o}=e;const s=new uee({csvOptions:i});return n.forEach(e=>{const n=r(t,e.field);s.addValue(cee(n,{ignoreValueFormatter:o,csvOptions:i}))}),s.getRowString()})({id:n,columns:t,getCellParams:o.current.getCellParams,ignoreValueFormatter:i,csvOptions:r})}\r\n`,"").trim();if(!r.includeHeaders)return s;const a=t.filter(e=>e.field!==aee.field),l=[];if(r.includeColumnGroupsHeaders){const e=o.current.getAllGroupDetails();let t=0;const n=a.reduce((e,n)=>{const r=o.current.getColumnGroupPath(n.field);return e[n.field]=r,t=Math.max(t,r.length),e},{});for(let i=0;i<t;i+=1){const t=new uee({csvOptions:r,sanitizeCellValue:lee});l.push(t),a.forEach(r=>{const o=(n[r.field]||[])[i],s=e[o];t.addValue(s?s.headerName||s.groupId:"")})}}const c=new uee({csvOptions:r,sanitizeCellValue:lee});a.forEach(e=>{c.addValue(e.headerName||e.field)}),l.push(c);const u=`${l.map(e=>e.getRowString()).join("\r\n")}\r\n`;return`${u}${s}`.trim()}function hee(e){const t=document.createElement("span");t.style.whiteSpace="pre",t.style.userSelect="all",t.style.opacity="0px",t.textContent=e,document.body.appendChild(t);const n=document.createRange();n.selectNode(t);const r=window.getSelection();r.removeAllRanges(),r.addRange(n);try{document.execCommand("copy")}finally{document.body.removeChild(t)}}const pee=(e,n)=>{const r=n.ignoreValueFormatterDuringExport,i=("object"===typeof r?r?.clipboardExport:r)||!1,o=n.clipboardCopyCellDelimiter,s=t.useCallback(t=>{if(!function(e){return(e.ctrlKey||e.metaKey)&&"C"===String.fromCharCode(e.keyCode)&&!e.shiftKey&&!e.altKey}(t))return;if(n=t.target,window.getSelection()?.toString()||n&&(n.selectionEnd||0)-(n.selectionStart||0)>0)return;var n;let r="";if(_7(e)>0)r=e.current.getDataAsCsv({includeHeaders:!1,delimiter:o,shouldAppendQuotes:!1,escapeFormulas:!1});else{const t=y7(e);if(t){const n=e.current.getCellParams(t.id,t.field);r=cee(n,{csvOptions:{delimiter:o,shouldAppendQuotes:!1,escapeFormulas:!1},ignoreValueFormatter:i})}}var s;r=e.current.unstable_applyPipeProcessors("clipboardCopy",r),r&&(s=r,navigator.clipboard?navigator.clipboard.writeText(s).catch(()=>{hee(s)}):hee(s),e.current.publishEvent("clipboardCopy",r))},[e,i,o]);eee(e,()=>e.current.rootElementRef.current,"keydown",s),T4(e,"clipboardCopy",n.onClipboardCopy)},gee=e=>$Q({},e,{columnMenu:{open:!1}}),fee=e=>{const n=t.useRef(!0);n.current&&(n.current=!1,e())},mee=function(e,n,r){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=t.useRef(null),s=t.useRef(`mui-${Math.round(1e9*Math.random())}`),a=t.useCallback(()=>{o.current=e.current.registerPipeProcessor(n,s.current,r)},[e,r,n]);fee(()=>{i&&a()});const l=t.useRef(!0);t.useEffect(()=>(l.current?l.current=!1:i&&a(),()=>{o.current&&(o.current(),o.current=null)}),[a,i])},vee=(e,n,r)=>{const i=t.useRef(null),o=t.useRef(`mui-${Math.round(1e9*Math.random())}`),s=t.useCallback(()=>{i.current=e.current.registerPipeApplier(n,o.current,r)},[e,r,n]);fee(()=>{s()});const a=t.useRef(!0);t.useEffect(()=>(a.current?a.current=!1:s(),()=>{i.current&&(i.current(),i.current=null)}),[s])},wee=(e,t,n)=>$Q({},e,{columns:p8({apiRef:n,columnsToUpsert:t.columns,initialState:t.initialState?.columns,columnVisibilityModel:t.columnVisibilityModel??t.initialState?.columns?.columnVisibilityModel??{},keepOnlyColumnsToUpsert:!0}),pinnedColumns:e.pinnedColumns??A3});function bee(e,n){const r=Z9(e,"useGridColumns"),i=t.useRef(n.columns);e.current.registerControlState({stateId:"visibleColumns",propModel:n.columnVisibilityModel,propOnChange:n.onColumnVisibilityModelChange,stateSelector:_3,changeEvent:"columnVisibilityModelChange"});const o=t.useCallback(t=>{r.debug("Updating columns state."),e.current.setState(function(e){return t=>$Q({},t,{columns:e})}(t)),e.current.publishEvent("columnsChange",t.orderedFields)},[r,e]),s=t.useCallback(t=>N3(e)[t],[e]),a=t.useCallback(()=>L3(e),[e]),l=t.useCallback(()=>V3(e),[e]),c=t.useCallback(function(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]?V3(e):L3(e)).findIndex(e=>e.field===t)},[e]),u=t.useCallback(t=>{const n=c(t);return G3(e)[n]},[e,c]),d=t.useCallback(t=>{_3(e)!==t&&(e.current.setState(n=>$Q({},n,{columns:p8({apiRef:e,columnsToUpsert:[],initialState:void 0,columnVisibilityModel:t,keepOnlyColumnsToUpsert:!1})})),e.current.updateRenderContext?.())},[e]),h=t.useCallback(t=>{if(n9(e))return void e.current.updateNonPivotColumns(t);const n=p8({apiRef:e,columnsToUpsert:t,initialState:void 0,keepOnlyColumnsToUpsert:!1,updateInitialVisibilityModel:!0});o(n)},[e,o]),p=t.useCallback((t,n)=>{const r=_3(e);if(n!==(r[t]??!0)){const i=$Q({},r,{[t]:n});e.current.setColumnVisibilityModel(i)}},[e]),g=t.useCallback(t=>O3(e).findIndex(e=>e===t),[e]),f=t.useCallback((t,n)=>{const i=O3(e),s=g(t);if(s===n)return;r.debug(`Moving column ${t} to index ${n}`);const a=[...i],l=a.splice(s,1)[0];a.splice(n,0,l),o($Q({},F3(e),{orderedFields:a}));const c={column:e.current.getColumn(t),targetIndex:e.current.getColumnIndexRelativeToVisibleColumns(t),oldIndex:s};e.current.publishEvent("columnIndexChange",c)},[e,r,o,g]),m=t.useCallback((t,n)=>{r.debug(`Updating column ${t} width to ${n}`);const i=F3(e),s=$Q({},i.lookup[t],{width:n,hasBeenResized:!0});o(d8($Q({},i,{lookup:$Q({},i.lookup,{[t]:s})}),e.current.getRootDimensions())),e.current.publishEvent("columnWidthChange",{element:e.current.getColumnHeaderElement(t),colDef:s,width:n})},[e,r,o]),v={setColumnIndex:f};h7(e,{getColumn:s,getAllColumns:a,getColumnIndex:c,getColumnPosition:u,getVisibleColumns:l,getColumnIndexRelativeToVisibleColumns:g,updateColumns:h,setColumnVisibilityModel:d,setColumnVisibility:p,setColumnWidth:m},"public"),h7(e,v,n.signature===W8.DataGrid?"private":"public");const w=t.useCallback((t,r)=>{const i={},o=_3(e);(!r.exportOnlyDirtyModels||null!=n.columnVisibilityModel||Object.keys(n.initialState?.columns?.columnVisibilityModel??{}).length>0||Object.keys(o).length>0)&&(i.columnVisibilityModel=o),i.orderedFields=O3(e);const s=L3(e),a={};return s.forEach(e=>{if(e.hasBeenResized){const t={};c8.forEach(n=>{let r=e[n];r===1/0&&(r=-1),t[n]=r}),a[e.field]=t}}),Object.keys(a).length>0&&(i.dimensions=a),$Q({},t,{columns:i})},[e,n.columnVisibilityModel,n.initialState?.columns]),b=t.useCallback((t,n)=>{const r=n.stateToRestore.columns,i=r?.columnVisibilityModel;if(null==r)return t;const o=p8({apiRef:e,columnsToUpsert:[],initialState:r,columnVisibilityModel:i,keepOnlyColumnsToUpsert:!1});return null!=r&&e.current.setState(e=>$Q({},e,{columns:$Q({},e.columns,{lookup:o.lookup,orderedFields:o.orderedFields,initialColumnVisibilityModel:o.initialColumnVisibilityModel})})),null!=i&&e.current.setState(e=>$Q({},e,{columns:$Q({},e.columns,{columnVisibilityModel:i})})),null!=r&&e.current.publishEvent("columnsChange",o.orderedFields),t},[e]),C=t.useCallback((e,t)=>{if(t===X3.columns){const e=n.slots.columnsPanel;return(0,MH.jsx)(e,$Q({},n.slotProps?.columnsPanel))}return e},[n.slots.columnsPanel,n.slotProps?.columnsPanel]),y=t.useCallback(t=>{const r=n9(e);return n.disableColumnSelector||r?t:[...t,"columnMenuColumnsItem"]},[n.disableColumnSelector,e]);mee(e,"columnMenu",y),mee(e,"exportState",w),mee(e,"restoreState",b),mee(e,"preferencePanel",C);const S=t.useRef(null);R4(e,"viewportInnerSizeChange",t=>{if(S.current!==t.width){S.current=t.width;if(!V3(e).some(e=>e.flex&&e.flex>0))return;o(d8(F3(e),e.current.getRootDimensions()))}});const x=t.useCallback(()=>{r.info("Columns pipe processing have changed, regenerating the columns");const t=p8({apiRef:e,columnsToUpsert:[],initialState:void 0,keepOnlyColumnsToUpsert:!1});o(t)},[e,r,o]);vee(e,"hydrateColumns",x);const R=t.useRef(!0);t.useEffect(()=>{if(R.current)return void(R.current=!1);if(r.info(`GridColumns have changed, new length ${n.columns.length}`),i.current===n.columns)return;const t=p8({apiRef:e,initialState:void 0,columnsToUpsert:n.columns,keepOnlyColumnsToUpsert:!0,updateInitialVisibilityModel:!0});i.current=n.columns,o(t)},[r,e,o,n.columns]),t.useEffect(()=>{void 0!==n.columnVisibilityModel&&e.current.setColumnVisibilityModel(n.columnVisibilityModel)},[e,r,n.columnVisibilityModel])}const Cee=(e,t)=>$Q({},e,{density:t.initialState?.density??t.density??"standard"});const yee=e=>{let{apiRef:t,options:n}=e;const r=L3(t);if(n.fields)return n.fields.reduce((e,t)=>{const n=r.find(e=>e.field===t);return n&&e.push(n),e},[]);return(n.allColumns?r:V3(t)).filter(e=>!e.disableExport)},See=e=>{let{apiRef:t}=e;const n=O8(t),r=z4(t),i=_7(t),o=n.filter(e=>"footer"!==r[e].type),s=X4(t),a=s?.top?.map(e=>e.id)||[],l=s?.bottom?.map(e=>e.id)||[];if(o.unshift(...a),o.push(...l),i>0){const e=H7(t);return o.filter(t=>e.has(t))}return o},xee=YQ(function(e,n){const{children:r,slotProps:i={}}=e,o=i.button||{},s=i.tooltip||{},a=J3(),l=e3(),c=l5(),u=l5(),[d,h]=t.useState(!1),p=t.useRef(null),g=JQ(n,p),f=()=>h(!1);return null==r?null:(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(l.slots.baseTooltip,$Q({title:a.current.getLocaleText("toolbarExportLabel"),enterDelay:1e3},l.slotProps?.baseTooltip,s,{children:(0,MH.jsx)(l.slots.baseButton,$Q({size:"small",startIcon:(0,MH.jsx)(l.slots.exportIcon,{}),"aria-expanded":d,"aria-label":a.current.getLocaleText("toolbarExportLabel"),"aria-haspopup":"menu","aria-controls":d?u:void 0,id:c},l.slotProps?.baseButton,o,{onClick:e=>{h(e=>!e),o.onClick?.(e)},ref:g,children:a.current.getLocaleText("toolbarExport")}))})),(0,MH.jsx)(q6,{open:d,target:p.current,onClose:f,position:"bottom-end",children:(0,MH.jsx)(l.slots.baseMenuList,{id:u,className:I2.menuList,"aria-labelledby":c,autoFocusItem:d,children:t.Children.map(r,e=>t.isValidElement(e)?t.cloneElement(e,{hideMenu:f}):e)})})]})});const Ree=["hideMenu","options"],Eee=["hideMenu","options"],Tee=["csvOptions","printOptions","excelOptions"];function kee(e){const t=J3(),n=e3(),{hideMenu:r,options:i}=e,o=qQ(e,Ree);return(0,MH.jsx)(n.slots.baseMenuItem,$Q({onClick:()=>{t.current.exportDataAsCsv(i),r?.()}},o,{children:t.current.getLocaleText("toolbarExportCSV")}))}function Mee(e){const t=J3(),n=e3(),{hideMenu:r,options:i}=e,o=qQ(e,Eee);return(0,MH.jsx)(n.slots.baseMenuItem,$Q({onClick:()=>{t.current.exportDataAsPrint(i),r?.()}},o,{children:t.current.getLocaleText("toolbarExportPrint")}))}YQ(function(e,n){const r=e,{csvOptions:i={},printOptions:o={},excelOptions:s}=r,a=qQ(r,Tee),l=J3().current.unstable_applyPipeProcessors("exportMenu",[],{excelOptions:s,csvOptions:i,printOptions:o}).sort((e,t)=>e.componentName>t.componentName?1:-1);return 0===l.length?null:(0,MH.jsx)(xee,$Q({},a,{ref:n,children:l.map((e,n)=>t.cloneElement(e.component,{key:n}))}))});const Pee=(e,n)=>{const r=Z9(e,"useGridCsvExport"),i=n.ignoreValueFormatterDuringExport,o=("object"===typeof i?i?.csvExport:i)||!1,s=t.useCallback(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.debug("Get data as CSV");return dee({columns:yee({apiRef:e,options:t}),rowIds:(t.getRowsToExport??See)({apiRef:e}),csvOptions:{delimiter:t.delimiter||",",shouldAppendQuotes:t.shouldAppendQuotes??!0,includeHeaders:t.includeHeaders??!0,includeColumnGroupsHeaders:t.includeColumnGroupsHeaders??!0,escapeFormulas:t.escapeFormulas??!0},ignoreValueFormatter:o,apiRef:e})},[r,e,o]),a=t.useCallback(e=>{r.debug("Export data as CSV");const t=s(e);!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv";const n=`${arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.title||"untitled"}.${t}`;if("download"in HTMLAnchorElement.prototype){const t=URL.createObjectURL(e),r=document.createElement("a");return r.href=t,r.download=n,r.click(),void setTimeout(()=>{URL.revokeObjectURL(t)})}throw new Error("MUI X: exportAs not supported.")}(new Blob([e?.utf8WithBom?new Uint8Array([239,187,191]):"",t],{type:"text/csv"}),"csv",e?.fileName)},[r,s]);h7(e,{getDataAsCsv:s,exportDataAsCsv:a},"public");const l=t.useCallback((e,t)=>t.csvOptions?.disableToolbarButton?e:[...e,{component:(0,MH.jsx)(kee,{options:t.csvOptions}),componentName:"csvExport"}],[]);mee(e,"exportMenu",l)};function Iee(e){return e&&e.ownerDocument||document}function Aee(e,t){if(e===t)return!0;if(e&&t&&"object"===typeof e&&"object"===typeof t){if(e.constructor!==t.constructor)return!1;if(Array.isArray(e)){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r+=1)if(!Aee(e[r],t[r]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;const n=Array.from(e.entries());for(let e=0;e<n.length;e+=1)if(!t.has(n[e][0]))return!1;for(let e=0;e<n.length;e+=1){const r=n[e];if(!Aee(r[1],t.get(r[0])))return!1}return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;const n=Array.from(e.entries());for(let e=0;e<n.length;e+=1)if(!t.has(n[e][0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r+=1)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();const n=Object.keys(e),r=n.length;if(r!==Object.keys(t).length)return!1;for(let e=0;e<r;e+=1)if(!Object.prototype.hasOwnProperty.call(t,n[e]))return!1;for(let i=0;i<r;i+=1){const r=n[i];if(!Aee(e[r],t[r]))return!1}return!0}return e!==e&&t!==t}const Dee=(e,t,n)=>{let r=e.paginationModel;const i=e.rowCount,o=n?.pageSize??r.pageSize,s=n?.page??r.page,a=z8(i,o,s);!n||n?.page===r.page&&n?.pageSize===r.pageSize||(r=n);const l=-1===o?0:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return 0===t?e:Math.max(Math.min(e,t-1),0)}(r.page,a);return l!==r.page&&(r=$Q({},r,{page:l})),G8(r.pageSize,t),r};const Fee=(e,n)=>{const r=null!==e.current.rootElementRef.current,i=Z9(e,"useGridPrintExport"),o=t.useRef(null),s=t.useRef(null),a=t.useRef({}),l=t.useRef([]),c=t.useRef(null);t.useEffect(()=>{o.current=Iee(e.current.rootElementRef.current)},[e,r]);const u=t.useCallback((t,n,r)=>new Promise(i=>{const o=yee({apiRef:e,options:{fields:t,allColumns:n}}).map(e=>e.field),s=L3(e),a={};s.forEach(e=>{a[e.field]=o.includes(e.field)}),r&&(a[aee.field]=!0),e.current.setColumnVisibilityModel(a),i()}),[e]),d=t.useCallback(t=>{const n=t({apiRef:e}).reduce((t,n)=>{const r=e.current.getRow(n);return r[Q5]||t.push(r),t},[]);e.current.setRows(n)},[e]),h=t.useCallback((t,r)=>{const i=$Q({copyStyles:!0,hideToolbar:!1,hideFooter:!1,includeCheckboxes:!1},r),s=t.contentDocument;if(!s)return;const a=s7(e),l=e.current.rootElementRef.current,c=l.cloneNode(!0);c.querySelector(`.${I2.main}`).style.overflow="visible",c.style.contain="size";let u=l.querySelector(`.${I2.toolbarContainer}`)?.offsetHeight||0,d=l.querySelector(`.${I2.footerContainer}`)?.offsetHeight||0;const h=c.querySelector(`.${I2.footerContainer}`);i.hideToolbar&&(c.querySelector(`.${I2.toolbarContainer}`)?.remove(),u=0),i.hideFooter&&h&&(h.remove(),d=0);const p=a.currentPageTotalHeight+g8(e,n)+u+d;c.style.height=`${p}px`,c.style.boxSizing="content-box",!i.hideFooter&&h&&(h.style.position="absolute",h.style.width="100%",h.style.top=p-d+"px");const g=document.createElement("div");g.appendChild(c),s.body.style.marginTop="0px",s.body.innerHTML=g.innerHTML;const f="function"===typeof i.pageStyle?i.pageStyle():i.pageStyle;if("string"===typeof f){const e=s.createElement("style");e.appendChild(s.createTextNode(f)),s.head.appendChild(e)}i.bodyClassName&&s.body.classList.add(...i.bodyClassName.split(" "));let m=[];if(i.copyStyles){const e=l.getRootNode();m=function(e,t){const n=[],r=t.querySelectorAll("style, link[rel='stylesheet']");for(let i=0;i<r.length;i+=1){const t=r[i];if("STYLE"===t.tagName){const n=e.createElement(t.tagName),r=t.sheet;if(r){let t="";for(let e=0;e<r.cssRules.length;e+=1)"string"===typeof r.cssRules[e].cssText&&(t+=`${r.cssRules[e].cssText}\r\n`);n.appendChild(e.createTextNode(t)),e.head.appendChild(n)}}else if(t.getAttribute("href")){const r=e.createElement(t.tagName);for(let e=0;e<t.attributes.length;e+=1){const n=t.attributes[e];n&&r.setAttribute(n.nodeName,n.nodeValue||"")}n.push(new Promise(e=>{r.addEventListener("load",()=>e())})),e.head.appendChild(r)}}return n}(s,"ShadowRoot"===e.constructor.name?e:o.current)}Promise.all(m).then(()=>{t.contentWindow.print()})},[e,o,n]),p=t.useCallback(t=>{o.current.body.removeChild(t),e.current.restoreState(s.current||{}),s.current?.columns?.columnVisibilityModel||e.current.setColumnVisibilityModel(a.current),e.current.setState(e=>$Q({},e,{virtualization:c.current})),e.current.setRows(l.current),s.current=null,a.current={},l.current=[]},[e]),g=t.useCallback(async t=>{if(i.debug("Export data as Print"),!e.current.rootElementRef.current)throw new Error("MUI X: No grid root element available.");if(s.current=e.current.exportState(),a.current=_3(e),l.current=e.current.getSortedRows().filter(e=>!e[Q5]),n.pagination){const t={page:0,pageSize:L8(e)};e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{paginationModel:Dee(e.pagination,"DataGridPro",t)})}))}c.current=e.current.state.virtualization,e.current.setState(e=>$Q({},e,{virtualization:$Q({},e.virtualization,{enabled:!1,enabledForColumns:!1})})),await u(t?.fields,t?.allColumns,t?.includeCheckboxes),d(t?.getRowsToExport??See),await new Promise(e=>{requestAnimationFrame(()=>{e()})});const r=function(e){const t=document.createElement("iframe");return t.style.position="absolute",t.style.width="0px",t.style.height="0px",t.title=e||document.title,t}(t?.fileName);r.onload=()=>{h(r,t);r.contentWindow.matchMedia("print").addEventListener("change",e=>{!1===e.matches&&p(r)})},o.current.body.appendChild(r)},[n,i,e,h,p,u,d]);h7(e,{exportDataAsPrint:g},"public");const f=t.useCallback((e,t)=>t.printOptions?.disableToolbarButton?e:[...e,{component:(0,MH.jsx)(Mee,{options:t.printOptions}),componentName:"printExport"}],[]);mee(e,"exportMenu",f)},Oee=(e,n,r,i)=>{const o=t.useCallback(()=>{e.current.registerStrategyProcessor(n,r,i)},[e,i,r,n]);fee(()=>{o()});const s=t.useRef(!0);t.useEffect(()=>{s.current?s.current=!1:o()},[o])},Nee=(e,t,n)=>{const r=t.filterModel??t.initialState?.filter?.filterModel??y5();return $Q({},e,{filter:$Q({filterModel:E5(r,t.disableMultipleColumnsFiltering,n)},C5),visibleRowsLookup:{}})},Lee=e=>e.filteredRowsLookup;function _ee(e,t){return e.current.applyStrategyProcessor("visibleRowsLookupCreation",{tree:t.rows.tree,filteredRowsLookup:t.filter.filteredRowsLookup})}function Hee(){return h3(Object.values)}const Vee=e=>$Q({},e,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},tabIndex:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}});function Bee(e,t){return e.closest(`.${t}`)}function Wee(e){return e.replace(/["\\]/g,"\\$&")}function zee(e){return`.${I2.row}[data-id="${Wee(String(e))}"]`}function jee(e){return 1===e.target.nodeType&&!e.currentTarget.contains(e.target)}function Gee(e,t){return e.rootElementRef.current.querySelector(`.${I2[t]}`)}const $ee=e=>{let{api:t,colIndex:n,position:r,filterFn:i}=e;if(null===n)return[];const o=[];return Kee(t).forEach(e=>{e.getAttribute("data-id")&&e.querySelectorAll(`.${I2["left"===r?"cell--pinnedLeft":"cell--pinnedRight"]}`).forEach(e=>{const t=Yee(e);null!==t&&i(t)&&o.push(e)})}),o};const Uee=e=>{let{api:t,colIndex:n,position:r,filterFn:i}=e;if(!t.columnHeadersContainerRef?.current)return[];if(null===n)return[];const o=[];return t.columnHeadersContainerRef.current.querySelectorAll(`.${I2["left"===r?"columnHeader--pinnedLeft":"columnHeader--pinnedRight"]}`).forEach(e=>{const t=Yee(e);null!==t&&i(t,e)&&o.push(e)}),o};function Kee(e){return e.virtualScrollerRef.current.querySelectorAll(`:scope > div > div > .${I2.row}`)}function Yee(e){const t=e.getAttribute("aria-colindex");return t?Number(t)-1:null}const qee=e=>{let{currentColIndex:t,firstColIndex:n,lastColIndex:r,isRtl:i}=e;if(i){if(t<r)return t+1}else if(!i&&t>n)return t-1;return null},Xee=e=>{let{currentColIndex:t,firstColIndex:n,lastColIndex:r,isRtl:i}=e;if(i){if(t>n)return t-1}else if(!i&&t<r)return t+1;return null};const Qee=y3(n7,X4,(e,t)=>(t.top||[]).concat(e.rows,t.bottom||[])),Jee=(e,n)=>{const r=Z9(e,"useGridKeyboardNavigation"),i=z6(),o=n.listView,s=t.useCallback(()=>Qee(e),[e]),a="DataGrid"!==n.signature&&n.headerFilters,l=t.useCallback(function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"up";const a=A8(e),l=e.current.unstable_getCellColSpanInfo(n,t);l&&l.spannedByColSpan&&("left"===i?t=l.leftVisibleCellIndex:"right"===i&&(t=l.rightVisibleCellIndex));const c=o?b7(e).field:B3(e)[t],u=function(e,t,n,r){const i=m7(e);if(!i[t]?.[n])return t;const o=O8(e);let s=o.indexOf(t)+("down"===r?1:-1);for(;s>=0&&s<o.length;){const e=o[s];if(!i[e]?.[n])return e;s+="down"===r?1:-1}return t}(e,n,c,s),d=a.findIndex(e=>e.id===u);r.debug(`Navigating to cell row ${d}, col ${t}`),e.current.scrollToIndexes({colIndex:t,rowIndex:d}),e.current.setCellFocus(u,c)},[e,r,o]),c=t.useCallback((t,n)=>{r.debug(`Navigating to header col ${t}`),e.current.scrollToIndexes({colIndex:t});const i=e.current.getVisibleColumns()[t].field;e.current.setColumnHeaderFocus(i,n)},[e,r]),u=t.useCallback((t,n)=>{r.debug(`Navigating to header filter col ${t}`),e.current.scrollToIndexes({colIndex:t});const i=e.current.getVisibleColumns()[t].field;e.current.setColumnHeaderFilterFocus(i,n)},[e,r]),d=t.useCallback((t,n,i)=>{r.debug(`Navigating to header col ${t}`),e.current.scrollToIndexes({colIndex:t});const{field:o}=e.current.getVisibleColumns()[t];e.current.setColumnGroupHeaderFocus(o,n,i)},[e,r]),h=t.useCallback(e=>s()[e]?.id,[s]),p=t.useCallback((t,n)=>{const r=n.currentTarget.querySelector(`.${I2.columnHeaderTitleContainerContent}`);if(!!r&&r.contains(n.target)&&t.field!==aee.field)return;const o=s(),p=e.current.getViewportPageSize(),g=t.field?e.current.getColumnIndex(t.field):0,f=o.length>0?0:null,m=o.length-1,v=V3(e).length-1,w=l8(e);let b=!0;switch(n.key){case"ArrowDown":a?u(g,n):null!==f&&l(g,h(f));break;case"ArrowRight":{const e=Xee({currentColIndex:g,firstColIndex:0,lastColIndex:v,isRtl:i});null!==e&&c(e,n);break}case"ArrowLeft":{const e=qee({currentColIndex:g,firstColIndex:0,lastColIndex:v,isRtl:i});null!==e&&c(e,n);break}case"ArrowUp":w>0&&d(g,w-1,n);break;case"PageDown":null!==f&&null!==m&&l(g,h(Math.min(f+p,m)));break;case"Home":c(0,n);break;case"End":c(v,n);break;case"Enter":(n.ctrlKey||n.metaKey)&&e.current.toggleColumnMenu(t.field);break;case" ":break;default:b=!1}b&&n.preventDefault()},[e,s,a,u,l,h,i,c,d]),g=t.useCallback((t,n)=>{const r=n8(e)===t.field,o=r8(e)===t.field;if(r||o||!G6(n.key))return;const a=s(),d=e.current.getViewportPageSize(),p=t.field?e.current.getColumnIndex(t.field):0,g=a.length-1,f=V3(e).length-1;let m=!0;switch(n.key){case"ArrowDown":{const e=h(0);null!=e&&l(p,e);break}case"ArrowRight":{const e=Xee({currentColIndex:p,firstColIndex:0,lastColIndex:f,isRtl:i});null!==e&&u(e,n);break}case"ArrowLeft":{const r=qee({currentColIndex:p,firstColIndex:0,lastColIndex:f,isRtl:i});null!==r?u(r,n):e.current.setColumnHeaderFilterFocus(t.field,n);break}case"ArrowUp":c(p,n);break;case"PageDown":null!==g&&l(p,h(Math.min(0+d,g)));break;case"Home":u(0,n);break;case"End":u(f,n);break;case" ":break;default:m=!1}m&&n.preventDefault()},[e,s,u,i,c,l,h]),f=t.useCallback((t,n)=>{const r=x7(e);if(null===r)return;const{field:i,depth:o}=r,{fields:a,depth:u,maxDepth:p}=t,g=s(),f=e.current.getViewportPageSize(),m=e.current.getColumnIndex(i),v=i?e.current.getColumnIndex(i):0,w=g.length-1,b=V3(e).length-1;let C=!0;switch(n.key){case"ArrowDown":u===p-1?c(m,n):d(m,o+1,n);break;case"ArrowUp":u>0&&d(m,o-1,n);break;case"ArrowRight":{const e=a.length-a.indexOf(i)-1;m+e+1<=b&&d(m+e+1,o,n);break}case"ArrowLeft":{const e=a.indexOf(i);m-e-1>=0&&d(m-e-1,o,n);break}case"PageDown":null!==w&&l(v,h(Math.min(0+f,w)));break;case"Home":d(0,o,n);break;case"End":d(b,o,n);break;case" ":break;default:C=!1}C&&n.preventDefault()},[e,s,c,d,l,h]),m=t.useCallback((t,n)=>{if(jee(n))return;const r=e.current.getCellParams(t.id,t.field);if(r.cellMode===k6.Edit||!G6(n.key))return;if(!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:n,cell:r}))return;const d=s();if(0===d.length)return;const p=e.current.getViewportPageSize(),g=o?()=>0:e.current.getColumnIndex,f=t.field?g(t.field):0,m=d.findIndex(e=>e.id===t.id),v=d.length-1,w=(o?[b7(e)]:V3(e)).length-1;let b=!0;switch(n.key){case"ArrowDown":m<v&&l(f,h(m+1),i?"right":"left","down");break;case"ArrowUp":m>0?l(f,h(m-1)):a?u(f,n):c(f,n);break;case"ArrowRight":{const e=Xee({currentColIndex:f,firstColIndex:0,lastColIndex:w,isRtl:i});null!==e&&l(e,h(m),i?"left":"right");break}case"ArrowLeft":{const e=qee({currentColIndex:f,firstColIndex:0,lastColIndex:w,isRtl:i});null!==e&&l(e,h(m),i?"right":"left");break}case"Tab":n.shiftKey&&f>0?l(f-1,h(m),"left"):!n.shiftKey&&f<w&&l(f+1,h(m),"right");break;case" ":{if(t.field===p6)break;const e=t.colDef;if(e&&("__tree_data_group__"===e.field||(e=>e===h6||null!==(e=>{const t=e.match(/^__row_group_by_columns_group_(.*)__$/);return t?t[1]:null})(e))(e.field)))break;!n.shiftKey&&m<v&&l(f,h(Math.min(m+p,v)));break}case"PageDown":m<v&&l(f,h(Math.min(m+p,v)));break;case"PageUp":{const e=Math.max(m-p,0);e!==m&&e>=0?l(f,h(e)):c(f,n);break}case"Home":n.ctrlKey||n.metaKey||n.shiftKey?l(0,h(0)):l(0,h(m));break;case"End":n.ctrlKey||n.metaKey||n.shiftKey?l(w,h(v)):l(w,h(m));break;default:b=!1}b&&n.preventDefault()},[e,s,i,l,h,a,u,c,o]),v=t.useCallback((e,t)=>{let{event:n}=t;return" "!==n.key&&e},[]);mee(e,"canStartEditing",v),R4(e,"columnHeaderKeyDown",p),R4(e,"headerFilterKeyDown",g),R4(e,"columnGroupHeaderKeyDown",f),R4(e,"cellKeyDown",m)},Zee=(e,t)=>{const n=$Q({},j8(t.autoPageSize),t.paginationModel??t.initialState?.pagination?.paginationModel);G8(n.pageSize,t.signature);const r=t.rowCount??t.initialState?.pagination?.rowCount??("client"===t.paginationMode?e.rows?.totalRowCount:void 0),i=t.paginationMeta??t.initialState?.pagination?.meta??{};return $Q({},e,{pagination:$Q({},e.pagination,{paginationModel:n,rowCount:r,meta:i,enabled:!0===t.pagination,paginationMode:t.paginationMode})})},ete=(e,n)=>{((e,n)=>{const r=Z9(e,"useGridPaginationMeta"),i=$2(e,q8);e.current.registerControlState({stateId:"paginationMeta",propModel:n.paginationMeta,propOnChange:n.onPaginationMetaChange,stateSelector:q8,changeEvent:"paginationMetaChange"});const o=t.useCallback(t=>{i!==t&&(r.debug("Setting 'paginationMeta' to",t),e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{meta:t})})))},[e,r,i]);h7(e,{setPaginationMeta:o},"public");const s=t.useCallback((t,r)=>{const i=q8(e);return r.exportOnlyDirtyModels&&null==n.paginationMeta&&null==n.initialState?.pagination?.meta?t:$Q({},t,{pagination:$Q({},t.pagination,{meta:i})})},[e,n.paginationMeta,n.initialState?.pagination?.meta]),a=t.useCallback((t,n)=>{const r=n.stateToRestore.pagination?.meta?n.stateToRestore.pagination.meta:q8(e);return e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{meta:r})})),t},[e]);mee(e,"exportState",s),mee(e,"restoreState",a),t.useEffect(()=>{n.paginationMeta&&e.current.setPaginationMeta(n.paginationMeta)},[e,n.paginationMeta])})(e,n),((e,n)=>{const r=Z9(e,"useGridPaginationModel"),i=$2(e,T3),o=t.useRef(k8(e)),s=Math.floor(n.rowHeight*i);e.current.registerControlState({stateId:"paginationModel",propModel:n.paginationModel,propOnChange:n.onPaginationModelChange,stateSelector:K8,changeEvent:"paginationModelChange"});const a=t.useCallback(t=>{const n=K8(e);t!==n.page&&(r.debug(`Setting page to ${t}`),e.current.setPaginationModel({page:t,pageSize:n.pageSize}))},[e,r]),l=t.useCallback(t=>{const n=K8(e);t!==n.pageSize&&(r.debug(`Setting page size to ${t}`),e.current.setPaginationModel({pageSize:t,page:n.page}))},[e,r]),c=t.useCallback(t=>{const i=K8(e);t!==i&&(r.debug("Setting 'paginationModel' to",t),e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{paginationModel:Dee(e.pagination,n.signature,t)})}),"setPaginationModel"))},[e,r,n.signature]);h7(e,{setPage:a,setPageSize:l,setPaginationModel:c},"public");const u=t.useCallback((t,r)=>{const i=K8(e);return!r.exportOnlyDirtyModels||null!=n.paginationModel||null!=n.initialState?.pagination?.paginationModel||0!==i.page&&i.pageSize!==(n.autoPageSize?0:100)?$Q({},t,{pagination:$Q({},t.pagination,{paginationModel:i})}):t},[e,n.paginationModel,n.initialState?.pagination?.paginationModel,n.autoPageSize]),d=t.useCallback((t,r)=>{const i=r.stateToRestore.pagination?.paginationModel?$Q({},j8(n.autoPageSize),r.stateToRestore.pagination?.paginationModel):K8(e);return e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{paginationModel:Dee(e.pagination,n.signature,i)})}),"stateRestorePreProcessing"),t},[e,n.autoPageSize,n.signature]);mee(e,"exportState",u),mee(e,"restoreState",d);const h=t.useCallback(()=>{if(!n.autoPageSize)return;const t=e.current.getRootDimensions(),r=Math.max(1,Math.floor(t.viewportInnerSize.height/s));e.current.setPageSize(r)},[e,n.autoPageSize,s]),p=t.useCallback(t=>{if(null==t)return;const n=K8(e);if(0===n.page)return;const r=J8(e);n.page>r-1&&e.current.setPage(Math.max(0,r-1))},[e]),g=t.useCallback(()=>{0!==K8(e).page&&e.current.setPage(0),0!==e.current.getScrollPosition().top&&e.current.scroll({top:0})},[e]),f=t.useCallback(t=>{const n=$Q({},t,{items:V8(e)});Aee(n,o.current)||(o.current=n,g())},[e,g]);R4(e,"viewportInnerSizeChange",h),R4(e,"paginationModelChange",()=>{const t=K8(e);e.current.virtualScrollerRef?.current&&e.current.scrollToIndexes({rowIndex:t.page*t.pageSize})}),R4(e,"rowCountChange",p),R4(e,"sortModelChange",g),R4(e,"filterModelChange",f);const m=t.useRef(!0);t.useEffect(()=>{m.current?m.current=!1:n.pagination&&e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{paginationModel:Dee(e.pagination,n.signature,n.paginationModel)})}))},[e,n.paginationModel,n.signature,n.pagination]),t.useEffect(()=>{e.current.setState(e=>{const t=!0===n.pagination;return e.pagination.paginationMode===n.paginationMode||e.pagination.enabled===t?e:$Q({},e,{pagination:$Q({},e.pagination,{paginationMode:n.paginationMode,enabled:!0===n.pagination})})})},[e,n.paginationMode,n.pagination]),t.useEffect(h,[h])})(e,n),((e,n)=>{const r=Z9(e,"useGridRowCount"),i=$2(e,_8),o=$2(e,Y8),s=$2(e,q8),a=$2(e,K8),l=H2(()=>K8(e).pageSize);e.current.registerControlState({stateId:"paginationRowCount",propModel:n.rowCount,propOnChange:n.onRowCountChange,stateSelector:Y8,changeEvent:"rowCountChange"});const c=t.useCallback(t=>{o!==t&&(r.debug("Setting 'rowCount' to",t),e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{rowCount:t})})))},[e,r,o]);h7(e,{setRowCount:c},"public");const u=t.useCallback((t,r)=>{const i=Y8(e);return r.exportOnlyDirtyModels&&null==n.rowCount&&null==n.initialState?.pagination?.rowCount?t:$Q({},t,{pagination:$Q({},t.pagination,{rowCount:i})})},[e,n.rowCount,n.initialState?.pagination?.rowCount]),d=t.useCallback((t,n)=>{const r=n.stateToRestore.pagination?.rowCount?n.stateToRestore.pagination.rowCount:Y8(e);return e.current.setState(e=>$Q({},e,{pagination:$Q({},e.pagination,{rowCount:r})})),t},[e]);mee(e,"exportState",u),mee(e,"restoreState",d);const h=t.useCallback(t=>{"client"!==n.paginationMode&&l.current&&t.pageSize!==l.current&&(l.current=t.pageSize,-1===o&&e.current.setPage(0))},[n.paginationMode,l,o,e]);R4(e,"paginationModelChange",h),t.useEffect(()=>{"client"===n.paginationMode?e.current.setRowCount(i):null!=n.rowCount&&e.current.setRowCount(n.rowCount)},[e,n.paginationMode,i,n.rowCount]);const p=!1===s.hasNextPage;t.useEffect(()=>{p&&-1===o&&e.current.setRowCount(a.pageSize*a.page+i)},[e,i,p,o,a])})(e,n)},tte=(e,t)=>$Q({},e,{preferencePanel:t.initialState?.preferencePanel??{open:!1}}),nte=S3(e=>e.editRows),rte=C3(nte,(e,t)=>{let{rowId:n,editMode:r}=t;return r===T6.Row&&Boolean(e[n])}),ite=C3(nte,(e,t)=>{let{rowId:n,field:r}=t;return e[n]?.[r]??null}),ote=e=>{switch(e.type){case"boolean":return!1;case"date":case"dateTime":case"number":return;case"singleSelect":return null;default:return""}},ste=["id","field"],ate=["id","field"];var lte=function(e){return e.enterKeyDown="enterKeyDown",e.cellDoubleClick="cellDoubleClick",e.printableKeyDown="printableKeyDown",e.deleteKeyDown="deleteKeyDown",e}(lte||{}),cte=function(e){return e.rowFocusOut="rowFocusOut",e.escapeKeyDown="escapeKeyDown",e.enterKeyDown="enterKeyDown",e.tabKeyDown="tabKeyDown",e.shiftTabKeyDown="shiftTabKeyDown",e}(cte||{});const ute=["id"],dte=["id"],hte=e=>$Q({},e,{editRows:{}}),pte=(e,n)=>{((e,n)=>{const[r,i]=t.useState({}),o=t.useRef(r),s=t.useRef({}),{processRowUpdate:a,onProcessRowUpdateError:l,cellModesModel:c,onCellModesModelChange:u}=n,d=e=>function(){n.editMode===T6.Cell&&e(...arguments)},h=t.useCallback((t,n)=>{const r=e.current.getCellParams(t,n);if(!e.current.isCellEditable(r))throw new Error(`MUI X: The cell with id=${t} and field=${n} is not editable.`)},[e]),p=t.useCallback((t,n,r)=>{if(e.current.getCellMode(t,n)!==r)throw new Error(`MUI X: The cell with id=${t} and field=${n} is not in ${r} mode.`)},[e]),g=t.useCallback((t,n)=>{if(!t.isEditable)return;if(t.cellMode===k6.Edit)return;const r=$Q({},t,{reason:R6.cellDoubleClick});e.current.publishEvent("cellEditStart",r,n)},[e]),f=t.useCallback((t,n)=>{if(t.cellMode===k6.View)return;if(e.current.getCellMode(t.id,t.field)===k6.View)return;const r=$Q({},t,{reason:E6.cellFocusOut});e.current.publishEvent("cellEditStop",r,n)},[e]),m=t.useCallback((t,n)=>{if(t.cellMode===k6.Edit){if(229===n.which)return;let r;if("Escape"===n.key?r=E6.escapeKeyDown:"Enter"===n.key?r=E6.enterKeyDown:"Tab"===n.key&&(r=n.shiftKey?E6.shiftTabKeyDown:E6.tabKeyDown,n.preventDefault()),r){const i=$Q({},t,{reason:r});e.current.publishEvent("cellEditStop",i,n)}}else if(t.isEditable){let r;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:n,cellParams:t,editMode:"cell"}))return;if(j6(n)?r=R6.printableKeyDown:U6(n)?r=R6.pasteKeyDown:"Enter"===n.key?r=R6.enterKeyDown:"Backspace"!==n.key&&"Delete"!==n.key||(r=R6.deleteKeyDown),r){const i=$Q({},t,{reason:r,key:n.key});e.current.publishEvent("cellEditStart",i,n)}}},[e]),v=t.useCallback(t=>{const{id:n,field:r,reason:i}=t,o={id:n,field:r};i!==R6.printableKeyDown&&i!==R6.deleteKeyDown&&i!==R6.pasteKeyDown||(o.deleteValue=!0),e.current.startCellEditMode(o)},[e]),w=t.useCallback(t=>{const{id:n,field:r,reason:i}=t;let o;e.current.runPendingEditCellValueMutation(n,r),i===E6.enterKeyDown?o="below":i===E6.tabKeyDown?o="right":i===E6.shiftTabKeyDown&&(o="left");const s="escapeKeyDown"===i;e.current.stopCellEditMode({id:n,field:r,ignoreModifications:s,cellToFocusAfter:o})},[e]);R4(e,"cellDoubleClick",d(g)),R4(e,"cellFocusOut",d(f)),R4(e,"cellKeyDown",d(m)),R4(e,"cellEditStart",d(v)),R4(e,"cellEditStop",d(w)),T4(e,"cellEditStart",n.onCellEditStart),T4(e,"cellEditStop",(t=>async function(){if(t){const{id:n,field:r}=arguments.length<=0?void 0:arguments[0],i=e.current.state.editRows,o=i[n][r]?.error;o||t(...arguments)}})(n.onCellEditStop));const b=t.useCallback((t,n)=>{const r=nte(e);return r[t]&&r[t][n]?k6.Edit:k6.View},[e]),C=w4(t=>{const r=t!==n.cellModesModel;u&&r&&u(t,{api:e.current}),n.cellModesModel&&r||(i(t),o.current=t,e.current.publishEvent("cellModesModelChange",t))}),y=t.useCallback((e,t,n)=>{const r=$Q({},o.current);if(null!==n)r[e]=$Q({},r[e],{[t]:$Q({},n)});else{const n=qQ(r[e],[t].map(U9));r[e]=n,0===Object.keys(r[e]).length&&delete r[e]}C(r)},[C]),S=t.useCallback((t,n,r)=>{e.current.setState(e=>{const i=$Q({},e.editRows);return null!==r?i[t]=$Q({},i[t],{[n]:$Q({},r)}):(delete i[t][n],0===Object.keys(i[t]).length&&delete i[t]),$Q({},e,{editRows:i})})},[e]),x=t.useCallback(e=>{const{id:t,field:n}=e,r=qQ(e,ste);h(t,n),p(t,n,k6.View),y(t,n,$Q({mode:k6.Edit},r))},[h,p,y]),R=w4(async t=>{const{id:n,field:r,deleteValue:i,initialValue:o}=t,s=e.current.getCellValue(n,r);let a=s;i?a=ote(e.current.getColumn(r)):o&&(a=o);const l=e.current.getColumn(r),c=!!l.preProcessEditCellProps&&i;let u={value:a,error:!1,isProcessingProps:c};if(S(n,r,u),e.current.setCellFocus(n,r),c&&(u=await Promise.resolve(l.preProcessEditCellProps({id:n,row:e.current.getRow(n),props:u,hasChanged:a!==s})),e.current.getCellMode(n,r)===k6.Edit)){const t=nte(e);S(n,r,$Q({},u,{value:t[n][r].value,isProcessingProps:!1}))}}),E=t.useCallback(e=>{const{id:t,field:n}=e,r=qQ(e,ate);p(t,n,k6.Edit),y(t,n,$Q({mode:k6.View},r))},[p,y]),T=w4(async t=>{const{id:r,field:i,ignoreModifications:o,cellToFocusAfter:c="none"}=t;p(r,i,k6.Edit),e.current.runPendingEditCellValueMutation(r,i);const u=()=>{S(r,i,null),y(r,i,null),"none"!==c&&e.current.moveFocusToRelativeCell(r,i,c)};if(o)return void u();const d=nte(e),{error:h,isProcessingProps:g}=d[r][i],f=e.current.getRow(r);if(h||g)return s.current[r][i].mode=k6.Edit,void y(r,i,{mode:k6.Edit});const m=e.current.getRowWithUpdatedValuesFromCellEditing(r,i);if(n.dataSource?.updateRow){if(Aee(f,m))return void u();const t=()=>{s.current[r][i].mode=k6.Edit,y(r,i,{mode:k6.Edit})},n={rowId:r,updatedRow:m,previousRow:f};try{await e.current.dataSource.editRow(n),u()}catch{t()}}else if(a){const t=e=>{s.current[r][i].mode=k6.Edit,y(r,i,{mode:k6.Edit}),l&&l(e)};try{Promise.resolve(a(m,f,{rowId:r})).then(t=>{e.current.updateRows([t]),u()}).catch(t)}catch(v){t(v)}}else e.current.updateRows([m]),u()}),k=t.useCallback(async t=>{const{id:n,field:r,value:i,debounceMs:o,unstable_skipValueParser:s}=t;h(n,r),p(n,r,k6.Edit);const a=e.current.getColumn(r),l=e.current.getRow(n);let c=i;a.valueParser&&!s&&(c=a.valueParser(i,l,a,e));let u=nte(e),d=$Q({},u[n][r],{value:c,changeReason:o?"debouncedSetEditCellValue":"setEditCellValue"});if(a.preProcessEditCellProps){const e=i!==u[n][r].value;d=$Q({},d,{isProcessingProps:!0}),S(n,r,d),d=await Promise.resolve(a.preProcessEditCellProps({id:n,row:l,props:d,hasChanged:e}))}return e.current.getCellMode(n,r)!==k6.View&&(u=nte(e),d=$Q({},d,{isProcessingProps:!1}),d.value=a.preProcessEditCellProps?u[n][r].value:c,S(n,r,d),u=nte(e),!u[n]?.[r]?.error)},[e,h,p,S]),M=t.useCallback((t,n)=>{const r=e.current.getColumn(n),i=nte(e),o=e.current.getRow(t);if(!i[t]||!i[t][n])return e.current.getRow(t);const{value:s}=i[t][n];return r.valueSetter?r.valueSetter(s,o,r,e):$Q({},o,{[n]:s})},[e]),P={setCellEditingEditCellValue:k,getRowWithUpdatedValuesFromCellEditing:M};h7(e,{getCellMode:b,startCellEditMode:x,stopCellEditMode:E},"public"),h7(e,P,"private"),t.useEffect(()=>{c&&C(c)},[c,C]),v4(()=>{const t=W4(e),n=s.current;s.current=m5(r),Object.entries(r).forEach(r=>{let[i,o]=r;Object.entries(o).forEach(r=>{let[o,s]=r;const a=n[i]?.[o]?.mode||k6.View,l=t[i]?e.current.getRowId(t[i]):i;s.mode===k6.Edit&&a===k6.View?R($Q({id:l,field:o},s)):s.mode===k6.View&&a===k6.Edit&&T($Q({id:l,field:o},s))})})},[e,r,R,T])})(e,n),((e,n)=>{const[r,i]=t.useState({}),o=t.useRef(r),s=t.useRef({}),a=t.useRef({}),l=t.useRef(void 0),c=t.useRef(null),{processRowUpdate:u,onProcessRowUpdateError:d,rowModesModel:h,onRowModesModelChange:p}=n,g=e=>function(){n.editMode===T6.Row&&e(...arguments)},f=t.useCallback((t,n)=>{const r=e.current.getCellParams(t,n);if(!e.current.isCellEditable(r))throw new Error(`MUI X: The cell with id=${t} and field=${n} is not editable.`)},[e]),m=t.useCallback((t,n)=>{if(e.current.getRowMode(t)!==n)throw new Error(`MUI X: The row with id=${t} is not in ${n} mode.`)},[e]),v=t.useCallback(t=>{const n=nte(e);return Object.values(n[t]).some(e=>e.error)},[e]),w=t.useCallback((t,n)=>{if(!t.isEditable)return;if(e.current.getRowMode(t.id)===M6.Edit)return;const r=$Q({},e.current.getRowParams(t.id),{field:t.field,reason:lte.cellDoubleClick});e.current.publishEvent("rowEditStart",r,n)},[e]),b=t.useCallback(e=>{c.current=e},[]),C=t.useCallback((t,n)=>{t.isEditable&&e.current.getRowMode(t.id)!==M6.View&&(c.current=null,l.current=setTimeout(()=>{if(c.current?.id!==t.id){if(!e.current.getRow(t.id))return;if(e.current.getRowMode(t.id)===M6.View)return;if(v(t.id))return;const r=$Q({},e.current.getRowParams(t.id),{field:t.field,reason:cte.rowFocusOut});e.current.publishEvent("rowEditStop",r,n)}}))},[e,v]);t.useEffect(()=>()=>{clearTimeout(l.current)},[]);const y=t.useCallback((t,n)=>{if(t.cellMode===M6.Edit){if(229===n.which)return;let r;if("Escape"===n.key)r=cte.escapeKeyDown;else if("Enter"===n.key)r=cte.enterKeyDown;else if("Tab"===n.key){const i=B3(e).filter(n=>e.current.getColumn(n).type===J6||e.current.isCellEditable(e.current.getCellParams(t.id,n)));if(n.shiftKey?t.field===i[0]&&(r=cte.shiftTabKeyDown):t.field===i[i.length-1]&&(r=cte.tabKeyDown),n.preventDefault(),!r){const r=i.findIndex(e=>e===t.field),o=i[n.shiftKey?r-1:r+1];e.current.setCellFocus(t.id,o)}}if(r){if(r!==cte.escapeKeyDown&&v(t.id))return;const i=$Q({},e.current.getRowParams(t.id),{reason:r,field:t.field});e.current.publishEvent("rowEditStop",i,n)}}else if(t.isEditable){let r;if(!e.current.unstable_applyPipeProcessors("canStartEditing",!0,{event:n,cellParams:t,editMode:"row"}))return;if(j6(n)||U6(n)?r=lte.printableKeyDown:"Enter"===n.key?r=lte.enterKeyDown:"Backspace"!==n.key&&"Delete"!==n.key||(r=lte.deleteKeyDown),r){const i=$Q({},e.current.getRowParams(t.id),{field:t.field,reason:r});e.current.publishEvent("rowEditStart",i,n)}}},[e,v]),S=t.useCallback(t=>{const{id:n,field:r,reason:i}=t,o={id:n,fieldToFocus:r};i!==lte.printableKeyDown&&i!==lte.deleteKeyDown||(o.deleteValue=!!r),e.current.startRowEditMode(o)},[e]),x=t.useCallback(t=>{const{id:n,reason:r,field:i}=t;let o;e.current.runPendingEditCellValueMutation(n),r===cte.enterKeyDown?o="below":r===cte.tabKeyDown?o="right":r===cte.shiftTabKeyDown&&(o="left");const s="escapeKeyDown"===r;e.current.stopRowEditMode({id:n,ignoreModifications:s,field:i,cellToFocusAfter:o})},[e]);R4(e,"cellDoubleClick",g(w)),R4(e,"cellFocusIn",g(b)),R4(e,"cellFocusOut",g(C)),R4(e,"cellKeyDown",g(y)),R4(e,"rowEditStart",g(S)),R4(e,"rowEditStop",g(x)),T4(e,"rowEditStart",n.onRowEditStart),T4(e,"rowEditStop",n.onRowEditStop);const R=t.useCallback(t=>rte(e,{rowId:t,editMode:n.editMode})?M6.Edit:M6.View,[e,n.editMode]),E=w4(t=>{const r=t!==n.rowModesModel;p&&r&&p(t,{api:e.current}),n.rowModesModel&&r||(i(t),o.current=t,e.current.publishEvent("rowModesModelChange",t))}),T=t.useCallback((e,t)=>{const n=$Q({},o.current);null!==t?n[e]=$Q({},t):delete n[e],E(n)},[E]),k=t.useCallback((t,n)=>{e.current.setState(e=>{const r=$Q({},e.editRows);return null!==n?r[t]=n:delete r[t],$Q({},e,{editRows:r})})},[e]),M=t.useCallback((t,n,r)=>{e.current.setState(e=>{const i=$Q({},e.editRows);return null!==r?i[t]=$Q({},i[t],{[n]:$Q({},r)}):(delete i[t][n],0===Object.keys(i[t]).length&&delete i[t]),$Q({},e,{editRows:i})})},[e]),P=t.useCallback(e=>{const{id:t}=e,n=qQ(e,ute);m(t,M6.View),T(t,$Q({mode:M6.Edit},n))},[m,T]),I=w4(t=>{const{id:n,fieldToFocus:r,deleteValue:i,initialValue:o}=t,s=e.current.getRow(n),l=L3(e),c=l.reduce((t,s)=>{const a=s.field;if(!e.current.getCellParams(n,a).isEditable)return t;const l=e.current.getColumn(a);let c=e.current.getCellValue(n,a);return r===a&&(i||o)&&(i?c=ote(l):o&&(c=o)),t[a]={value:c,error:!1,isProcessingProps:l.editable&&!!l.preProcessEditCellProps&&i},t},{});a.current[n]=s,k(n,c),r&&e.current.setCellFocus(n,r),l.filter(e=>e.editable&&!!e.preProcessEditCellProps&&i).forEach(t=>{const r=t.field,a=e.current.getCellValue(n,r),l=i?ote(t):o??a;Promise.resolve(t.preProcessEditCellProps({id:n,row:s,props:c[r],hasChanged:l!==a})).then(t=>{if(e.current.getRowMode(n)===M6.Edit){const i=nte(e);M(n,r,$Q({},t,{value:i[n][r].value,isProcessingProps:!1}))}})})}),A=t.useCallback(e=>{const{id:t}=e,n=qQ(e,dte);m(t,M6.Edit),T(t,$Q({mode:M6.View},n))},[m,T]),D=w4(async t=>{const{id:r,ignoreModifications:i,field:o,cellToFocusAfter:l="none"}=t;e.current.runPendingEditCellValueMutation(r);const c=()=>{"none"!==l&&o&&e.current.moveFocusToRelativeCell(r,o,l),k(r,null),T(r,null),delete a.current[r]};if(i)return void c();const h=nte(e),p=a.current[r];if(Object.values(h[r]).some(e=>e.isProcessingProps))return void(s.current[r].mode=M6.Edit);if(v(r))return s.current[r].mode=M6.Edit,void T(r,{mode:M6.Edit});const g=e.current.getRowWithUpdatedValuesFromRowEditing(r);if(n.dataSource?.updateRow){if(Aee(p,g))return void c();const t=()=>{s.current[r].mode=M6.Edit,T(r,{mode:M6.Edit})},n={rowId:r,updatedRow:g,previousRow:p};try{await e.current.dataSource.editRow(n),c()}catch{t()}}else if(u){const t=e=>{s.current[r]&&(s.current[r].mode=M6.Edit,T(r,{mode:M6.Edit})),d&&d(e)};try{Promise.resolve(u(g,p,{rowId:r})).then(t=>{e.current.updateRows([t]),c()}).catch(t)}catch(f){t(f)}}else e.current.updateRows([g]),c()}),F=t.useCallback(t=>{const{id:n,field:r,value:i,debounceMs:o,unstable_skipValueParser:s}=t;f(n,r);const a=e.current.getColumn(r),l=e.current.getRow(n);let c=i;a.valueParser&&!s&&(c=a.valueParser(i,l,a,e));let u=nte(e),d=$Q({},u[n][r],{value:c,changeReason:o?"debouncedSetEditCellValue":"setEditCellValue"});return a.preProcessEditCellProps||M(n,r,d),new Promise(t=>{const i=[];if(a.preProcessEditCellProps){const o=d.value!==u[n][r].value;d=$Q({},d,{isProcessingProps:!0}),M(n,r,d);const s=qQ(u[n],[r].map(U9)),h=Promise.resolve(a.preProcessEditCellProps({id:n,row:l,props:d,hasChanged:o,otherFieldsProps:s})).then(i=>{e.current.getRowMode(n)!==M6.View?(u=nte(e),(i=$Q({},i,{isProcessingProps:!1})).value=a.preProcessEditCellProps?u[n][r].value:c,M(n,r,i)):t(!1)});i.push(h)}Object.entries(u[n]).forEach(o=>{let[s,a]=o;if(s===r)return;const c=e.current.getColumn(s);if(!c.preProcessEditCellProps)return;a=$Q({},a,{isProcessingProps:!0}),M(n,s,a),u=nte(e);const d=qQ(u[n],[s].map(U9)),h=Promise.resolve(c.preProcessEditCellProps({id:n,row:l,props:a,hasChanged:!1,otherFieldsProps:d})).then(r=>{e.current.getRowMode(n)!==M6.View?(r=$Q({},r,{isProcessingProps:!1}),M(n,s,r)):t(!1)});i.push(h)}),Promise.all(i).then(()=>{e.current.getRowMode(n)===M6.Edit?(u=nte(e),t(!u[n][r].error)):t(!1)})})},[e,f,M]),O=t.useCallback(t=>{const n=nte(e),r=e.current.getRow(t);if(!n[t])return e.current.getRow(t);let i=$Q({},a.current[t],r);return Object.entries(n[t]).forEach(t=>{let[n,r]=t;const o=e.current.getColumn(n);o?.valueSetter?i=o.valueSetter(r.value,i,o,e):i[n]=r.value}),i},[e]),N={setRowEditingEditCellValue:F,getRowWithUpdatedValuesFromRowEditing:O};h7(e,{getRowMode:R,startRowEditMode:P,stopRowEditMode:A},"public"),h7(e,N,"private"),t.useEffect(()=>{h&&E(h)},[h,E]),v4(()=>{const t=W4(e),n=s.current;s.current=m5(r);const i=new Set([...Object.keys(r),...Object.keys(n)]);Array.from(i).forEach(i=>{const o=r[i]??{mode:M6.View},s=n[i]?.mode||M6.View,a=t[i]?e.current.getRowId(t[i]):i;o.mode===M6.Edit&&s===M6.View?I($Q({id:a},o)):o.mode===M6.View&&s===M6.Edit&&D($Q({id:a},o))})},[e,r,I,D])})(e,n);const r=t.useRef({}),{isCellEditable:i}=n,o=t.useCallback(e=>!n6(e.rowNode)&&(!!e.colDef.editable&&(!!e.colDef.renderEditCell&&(!i||i(e)))),[i]);t.useEffect(()=>{const e=r.current;return()=>{Object.entries(e).forEach(t=>{let[n,r]=t;Object.keys(r).forEach(t=>{const[r]=e[n][t];clearTimeout(r),delete e[n][t]})})}},[]);const s=t.useCallback((e,t)=>{if(r.current[e])if(t){if(r.current[e][t]){const[,n]=r.current[e][t];n()}}else Object.keys(r.current[e]).forEach(t=>{const[,n]=r.current[e][t];n()})},[]),a=t.useCallback(t=>{const{id:i,field:o,debounceMs:s}=t;return new Promise(a=>{((e,t,n,i)=>{if(!n)return void i();if(r.current[e]||(r.current[e]={}),r.current[e][t]){const[n]=r.current[e][t];clearTimeout(n)}const o=setTimeout(()=>{i(),delete r.current[e][t]},n);r.current[e][t]=[o,()=>{const[n]=r.current[e][t];clearTimeout(n),i(),delete r.current[e][t]}]})(i,o,s,async()=>{const r=n.editMode===T6.Row?e.current.setRowEditingEditCellValue:e.current.setCellEditingEditCellValue;if(e.current.getCellMode(i,o)===k6.Edit){const e=await r(t);a(e)}})})},[e,n.editMode]),l=t.useCallback((t,r)=>n.editMode===T6.Cell?e.current.getRowWithUpdatedValuesFromCellEditing(t,r):e.current.getRowWithUpdatedValuesFromRowEditing(t),[e,n.editMode]),c=t.useCallback((t,n)=>{const r=nte(e);return r[t]?.[n]??null},[e]),u={runPendingEditCellValueMutation:s};h7(e,{isCellEditable:o,setEditCellValue:a,getRowWithUpdatedValues:l,unstable_getEditCellMeta:c},"public"),h7(e,u,"private")},gte=(e,t,n)=>{const r=!!t.dataSource;return n.current.caches.rows=Z5({rows:r?[]:t.rows,getRowId:t.getRowId,loading:t.loading,rowCount:t.rowCount}),$Q({},e,{rows:t6({apiRef:n,rowCountProp:t.rowCount,loadingProp:!!r||t.loading,previousTree:null,previousTreeDepths:null})})},fte=e=>"full"===e.updates.type?(e=>{const t={[X5]:$Q({},{type:"group",id:X5,depth:-1,groupingField:null,groupingKey:null,isAutoGenerated:!0,children:[],childrenFromPath:{},childrenExpanded:!0,parent:null},{children:e})};for(let n=0;n<e.length;n+=1){const r=e[n];t[r]={id:r,depth:0,parent:X5,type:"leaf",groupingKey:null}}return{groupingName:Y9,tree:t,treeDepths:{0:e.length},dataRowIds:e}})(e.updates.rows):(e=>{let{previousTree:t,actions:n}=e;const r=$Q({},t),i={};for(let a=0;a<n.remove.length;a+=1){const e=n.remove[a];i[e]=!0,delete r[e]}for(let a=0;a<n.insert.length;a+=1){const e=n.insert[a];r[e]={id:e,depth:0,parent:X5,type:"leaf",groupingKey:null}}const o=r[X5];let s=[...o.children,...n.insert];return Object.values(i).length&&(s=s.filter(e=>!i[e])),r[X5]=$Q({},o,{children:s}),{groupingName:Y9,tree:r,treeDepths:{0:s.length},dataRowIds:s}})({previousTree:e.previousTree,actions:e.updates.actions});class mte extends Error{}function vte(e,n){const r=t.useCallback(t=>({field:t,colDef:e.current.getColumn(t)}),[e]),i=t.useCallback(t=>{const n=e.current.getRow(t);if(!n)throw new mte(`No row with id #${t} found`);return{id:t,columns:e.current.getAllColumns(),row:n}},[e]),o=t.useCallback((t,n,r,i)=>{let{cellMode:o,colDef:s,hasFocus:a,rowNode:l,tabIndex:c}=i;const u=r[n],d=s?.valueGetter?s.valueGetter(u,r,s,e):u,h={id:t,field:n,row:r,rowNode:l,colDef:s,cellMode:o,hasFocus:a,tabIndex:c,value:d,formattedValue:d,isEditable:!1,api:e.current};return s&&s.valueFormatter&&(h.formattedValue=s.valueFormatter(d,r,s,e)),h.isEditable=s&&e.current.isCellEditable(h),h},[e]),s=t.useCallback((t,r)=>{const i=e.current.getRow(t),o=j4(e,t);if(!i||!o)throw new mte(`No row with id #${t} found`);const s=y7(e),a=E7(e),l=e.current.getCellMode(t,r);return e.current.getCellParamsForRow(t,r,i,{colDef:n.listView&&n.listViewColumn?.field===r?b7(e):e.current.getColumn(r),rowNode:o,hasFocus:null!==s&&s.field===r&&s.id===t,tabIndex:a&&a.field===r&&a.id===t?0:-1,cellMode:l})},[e,n.listView,n.listViewColumn?.field]),a=t.useCallback((t,n)=>{const r=e.current.getColumn(n),i=e.current.getRow(t);if(!i)throw new mte(`No row with id #${t} found`);return r&&r.valueGetter?r.valueGetter(i[r.field],i,r,e):i[n]},[e]),l=t.useCallback((t,n)=>((e,t,n)=>{const r=t.field;if(!t||!t.valueGetter)return e[r];const i=e[t.field];return t.valueGetter(i,e,t,n)})(t,n,e),[e]),c=t.useCallback((t,n)=>{const r=l(t,n);return n&&n.valueFormatter?n.valueFormatter(r,t,n,e):r},[e,l]),u=t.useCallback(t=>e.current.rootElementRef.current?function(e,t){return e.querySelector(`[role="columnheader"][data-field="${Wee(t)}"]`)}(e.current.rootElementRef.current,t):null,[e]),d=t.useCallback(t=>e.current.rootElementRef.current?function(e,t){return e.querySelector(zee(t))}(e.current.rootElementRef.current,t):null,[e]),h=t.useCallback((t,n)=>e.current.rootElementRef.current?function(e,t){let{id:n,field:r}=t;const i=`${zee(n)} .${I2.cell}[data-field="${Wee(r)}"]`;return e.querySelector(i)}(e.current.rootElementRef.current,{id:t,field:n}):null,[e]),p={getCellParamsForRow:o};h7(e,{getCellValue:a,getCellParams:s,getCellElement:h,getRowValue:l,getRowFormattedValue:c,getRowParams:i,getRowElement:d,getColumnHeaderParams:r,getColumnHeaderElement:u},"public"),h7(e,p,"private")}const wte={type:"include",ids:new Set},bte=(e,t)=>$Q({},e,{rowSelection:t.rowSelection?t.rowSelectionModel??wte:wte}),Cte=(e,n)=>{const r=(e=>{const{classes:n}=e;return t.useMemo(()=>tJ({cellCheckbox:["cellCheckbox"],columnHeaderCheckbox:["columnHeaderCheckbox"]},P2,n),[n])})({classes:n.classes}),i=t.useCallback(t=>{const i=$Q({},aee,{cellClassName:r.cellCheckbox,headerClassName:r.columnHeaderCheckbox,headerName:e.current.getLocaleText("checkboxSelectionHeaderName")}),o=n.checkboxSelection,s=null!=t.lookup[see];return o&&!s?(t.lookup[see]=i,t.orderedFields=[see,...t.orderedFields]):!o&&s?(delete t.lookup[see],t.orderedFields=t.orderedFields.filter(e=>e!==see)):o&&s&&(t.lookup[see]=$Q({},i,t.lookup[see]),n.columns.some(e=>e.field===see)||(t.orderedFields=[see,...t.orderedFields.filter(e=>e!==see)])),t},[e,r,n.columns,n.checkboxSelection]);mee(e,"hydrateColumns",i)},yte=(e,t)=>{const n=t.sortModel??t.initialState?.sorting?.sortModel??[];return $Q({},e,{sorting:{sortModel:J4(n,t.disableMultipleColumnsSorting),sortedRows:[]}})};function Ste(e){const{containerSize:t,scrollPosition:n,elementSize:r,elementOffset:i}=e,o=i+r;return r>t?i:o-t>n?o-t:i<n?i:void 0}const xte={autoHeight:!1,autoPageSize:!1,autosizeOnMount:!1,checkboxSelection:!1,checkboxSelectionVisibleOnly:!1,clipboardCopyCellDelimiter:"\t",columnBufferPx:150,columnHeaderHeight:56,disableAutosize:!1,disableColumnFilter:!1,disableColumnMenu:!1,disableColumnReorder:!1,disableColumnResize:!1,disableColumnSelector:!1,disableColumnSorting:!1,disableDensitySelector:!1,disableEval:!1,disableMultipleColumnsFiltering:!1,disableMultipleColumnsSorting:!1,disableMultipleRowSelection:!1,disableRowSelectionOnClick:!1,disableVirtualization:!1,editMode:T6.Cell,filterDebounceMs:150,filterMode:"client",hideFooter:!1,hideFooterPagination:!1,hideFooterRowCount:!1,hideFooterSelectedRowCount:!1,ignoreDiacritics:!1,ignoreValueFormatterDuringExport:!1,keepColumnPositionIfDraggedOutside:!1,keepNonExistentRowsSelected:!1,loading:!1,logger:console,logLevel:"error",pageSizeOptions:[25,50,100],pagination:!1,paginationMode:"client",resizeThrottleMs:60,rowBufferPx:150,rowHeight:52,rows:[],rowSelection:!0,rowSpacingType:"margin",rowSpanning:!1,showCellVerticalBorder:!1,showColumnVerticalBorder:!1,showToolbar:!1,sortingMode:"client",sortingOrder:["asc","desc",null],throttleRowsMs:0,virtualizeColumnsWithAutoRowHeight:!1},Rte={width:0,height:0},Ete={isReady:!1,root:Rte,viewportOuterSize:Rte,viewportInnerSize:Rte,contentSize:Rte,minimumSize:Rte,hasScrollX:!1,hasScrollY:!1,scrollbarSize:0,headerHeight:0,groupHeaderHeight:0,headerFilterHeight:0,rowWidth:0,rowHeight:0,columnsTotalWidth:0,leftPinnedWidth:0,rightPinnedWidth:0,headersTotalHeight:0,topContainerHeight:0,bottomContainerHeight:0},Tte=(e,t,n)=>$Q({},e,{dimensions:$Q({},Ete,Ite(t,n,T3(n),z3(n)))}),kte=C3(V3,G3,(e,t)=>{const n=e.length;return 0===n?0:I7(t[n-1]+e[n-1].computedWidth,1)});function Mte(e,n){const r=Z9(e,"useResizeContainer"),i=t.useRef(!1),o=t.useRef(Rte),s=$2(e,z3),a=$2(e,T3),l=$2(e,kte),c=t.useRef(!0),{rowHeight:u,headerHeight:d,groupHeaderHeight:h,headerFilterHeight:p,headersTotalHeight:g,leftPinnedWidth:f,rightPinnedWidth:m}=Ite(n,e,a,s),v=t.useCallback(()=>o4(e),[e]),w=t.useCallback(t=>{e.current.setState(e=>$Q({},e,{dimensions:t})),e.current.rootElementRef.current&&Pte(e.current.rootElementRef.current,o4(e))},[e]),b=t.useCallback(()=>{const t=o4(e);if(!t.isReady)return 0;const r=r7(e);if(n.getRowHeight){const t=u7(e),n=t.lastRowIndex-t.firstRowIndex;return Math.min(n-1,r.rows.length)}const i=Math.floor(t.viewportInnerSize.height/u);return Math.min(i,r.rows.length)},[e,n.getRowHeight,u]),C=t.useCallback(()=>{if(c.current)return;const t=function(e,t){if(void 0!==t)return t;if(null===e)return 0;const n=Ate.get(e);if(void 0!==n)return n;const r=Iee(e).createElement("div");r.style.width="99px",r.style.height="99px",r.style.position="absolute",r.style.overflow="scroll",r.className="scrollDiv",e.appendChild(r);const i=r.offsetWidth-r.clientWidth;return e.removeChild(r),Ate.set(e,i),i}(e.current.mainElementRef.current,n.scrollbarSize),r=s7(e),i=g+r.pinnedTopRowsTotalHeight,s=r.pinnedBottomRowsTotalHeight,a={width:l,height:I7(r.currentPageTotalHeight,1)};let v,b,C=!1,y=!1;if(n.autoHeight)y=!1,C=Math.round(l)>Math.round(o.current.width),v={width:o.current.width,height:i+s+a.height},b={width:Math.max(0,v.width-(y?t:0)),height:Math.max(0,v.height-(C?t:0))};else{v={width:o.current.width,height:o.current.height},b={width:Math.max(0,v.width),height:Math.max(0,v.height-i-s)};const e=a,n=b,r=e.width>n.width,l=e.height>n.height;(r||l)&&(y=l,C=e.width+(y?t:0)>n.width,C&&(y=e.height+t>n.height)),y&&(b.width-=t),C&&(b.height-=t)}const S=Math.max(v.width,l+(y?t:0)),x={width:l,height:i+a.height+s},R={isReady:!0,root:o.current,viewportOuterSize:v,viewportInnerSize:b,contentSize:a,minimumSize:x,hasScrollX:C,hasScrollY:y,scrollbarSize:t,headerHeight:d,groupHeaderHeight:h,headerFilterHeight:p,rowWidth:S,rowHeight:u,columnsTotalWidth:l,leftPinnedWidth:f,rightPinnedWidth:m,headersTotalHeight:g,topContainerHeight:i,bottomContainerHeight:s},E=e.current.state.dimensions;var T,k;Aee(E,R)||(w(R),T=R.viewportInnerSize,k=E.viewportInnerSize,(T.width!==k.width||T.height!==k.height)&&e.current.publishEvent("viewportInnerSizeChange",R.viewportInnerSize),e.current.updateRenderContext?.())},[e,w,n.scrollbarSize,n.autoHeight,u,d,h,p,l,g,f,m]),y=w4(C),S=t.useMemo(()=>n.resizeThrottleMs>0?function(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;const i=()=>{t=void 0,e(...n)};function o(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];n=o,void 0===t&&(t=setTimeout(i,r))}return o.clear=()=>{clearTimeout(t),t=void 0},o}(()=>{y(),e.current.publishEvent("debouncedResize",o.current)},n.resizeThrottleMs):void 0,[e,n.resizeThrottleMs,y]);t.useEffect(()=>S?.clear,[S]);const x={getRootDimensions:v},R={updateDimensions:C,getViewportPageSize:b};v4(C,[C]),h7(e,x,"public"),h7(e,R,"private");const E=t.useCallback(t=>{Pte(t,o4(e))},[e]),T=t.useCallback(e=>{if(o.current=e,0!==e.height||i.current||n.autoHeight||A7||(r.error(["The parent DOM element of the Data Grid has an empty height.","Please make sure that this element has an intrinsic height.","The grid displays with a height of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join("\n")),i.current=!0),0!==e.width||i.current||A7||(r.error(["The parent DOM element of the Data Grid has an empty width.","Please make sure that this element has an intrinsic width.","The grid displays with a width of 0px.","","More details: https://mui.com/r/x-data-grid-no-dimensions."].join("\n")),i.current=!0),c.current||!S)return c.current=!1,void C();S()},[C,n.autoHeight,S,r]);T4(e,"rootMount",E),T4(e,"resize",T),T4(e,"debouncedResize",n.onResize)}function Pte(e,t){const n=(t,n)=>e.style.setProperty(t,n);n("--DataGrid-hasScrollX",`${Number(t.hasScrollX)}`),n("--DataGrid-hasScrollY",`${Number(t.hasScrollY)}`),n("--DataGrid-scrollbarSize",`${t.scrollbarSize}px`),n("--DataGrid-rowWidth",`${t.rowWidth}px`),n("--DataGrid-columnsTotalWidth",`${t.columnsTotalWidth}px`),n("--DataGrid-leftPinnedWidth",`${t.leftPinnedWidth}px`),n("--DataGrid-rightPinnedWidth",`${t.rightPinnedWidth}px`),n("--DataGrid-headerHeight",`${t.headerHeight}px`),n("--DataGrid-headersTotalHeight",`${t.headersTotalHeight}px`),n("--DataGrid-topContainerHeight",`${t.topContainerHeight}px`),n("--DataGrid-bottomContainerHeight",`${t.bottomContainerHeight}px`),n("--height",`${t.rowHeight}px`)}function Ite(e,t,n,r){const i=a6(e.rowHeight,xte.rowHeight);return{rowHeight:Math.floor(i*n),headerHeight:Math.floor(e.columnHeaderHeight*n),groupHeaderHeight:Math.floor((e.columnGroupHeaderHeight??e.columnHeaderHeight)*n),headerFilterHeight:Math.floor((e.headerFilterHeight??e.columnHeaderHeight)*n),columnsTotalWidth:kte(t),headersTotalHeight:g8(t,e),leftPinnedWidth:r.left.reduce((e,t)=>e+t.computedWidth,0),rightPinnedWidth:r.right.reduce((e,t)=>e+t.computedWidth,0)}}const Ate=new WeakMap;const Dte="undefined"!==typeof globalThis.ResizeObserver?globalThis.ResizeObserver:class{observe(){}unobserve(){}disconnect(){}},Fte=(e,t,n)=>{n.current.caches.rowsMeta={heights:new Map};const r=a4(n),i=H4(n),o=$8(n),s=Math.min(o.enabled?o.paginationModel.pageSize:i,i);return $Q({},e,{rowsMeta:{currentPageTotalHeight:s*r,positions:Array.from({length:s},(e,t)=>t*r),pinnedTopRowsTotalHeight:0,pinnedBottomRowsTotalHeight:0}})};function Ote(e){const{apiRef:t,lookup:n,columnIndex:r,rowId:i,minFirstColumnIndex:o,maxLastColumnIndex:s,columns:a}=e,l=a.length,c=a[r],u=t.current.getRow(i),d=t.current.getRowValue(u,c),h="function"===typeof c.colSpan?c.colSpan(d,u,c,t):c.colSpan;if(!h||1===h)return Nte(n,i,r,{spannedByColSpan:!1,cellProps:{colSpan:1,width:c.computedWidth}}),{colSpan:1};let p=c.computedWidth;for(let g=1;g<h;g+=1){const e=r+g;if(e>=o&&e<s){p+=a[e].computedWidth,Nte(n,i,r+g,{spannedByColSpan:!0,rightVisibleCellIndex:Math.min(r+h,l-1),leftVisibleCellIndex:r})}Nte(n,i,r,{spannedByColSpan:!1,cellProps:{colSpan:h,width:p}})}return{colSpan:h}}function Nte(e,t,n,r){e[t]||(e[t]={}),e[t][n]=r}function Lte(e){return void 0!==e.field}const _te=(e,t,n)=>{if(Lte(e)){if(void 0!==n[e.field])throw new Error(["MUI X: columnGroupingModel contains duplicated field",`column field ${e.field} occurs two times in the grouping model:`,`- ${n[e.field].join(" > ")}`,`- ${t.join(" > ")}`].join("\n"));return void(n[e.field]=t)}const{groupId:r,children:i}=e;i.forEach(e=>{_te(e,[...t,r],n)})},Hte=e=>{if(!e)return{};const t={};return e.forEach(e=>{_te(e,[],t)}),t},Vte=(e,t,n)=>{const r=e=>t[e]??[],i=[],o=Math.max(...e.map(e=>r(e).length)),s=(e,t,n)=>Aee(r(e).slice(0,n+1),r(t).slice(0,n+1));for(let a=0;a<o;a+=1){const t=e.reduce((e,t)=>{const i=r(t)[a]??null;if(0===e.length)return[{columnFields:[t],groupId:i}];const o=e[e.length-1],l=o.columnFields[o.columnFields.length-1];return o.groupId!==i||!s(l,t,a)||(c=l,u=t,n?.left&&n.left.includes(c)&&!n.left.includes(u)||n?.right&&!n.right.includes(c)&&n.right.includes(u))?[...e,{columnFields:[t],groupId:i}]:[...e.slice(0,e.length-1),{columnFields:[...o.columnFields,t],groupId:i}];var c,u},[]);i.push(t)}return i},Bte=["groupId","children"],Wte=e=>{let t={};return e.forEach(e=>{if(Lte(e))return;const{groupId:n,children:r}=e,i=qQ(e,Bte);if(!n)throw new Error("MUI X: An element of the columnGroupingModel does not have either `field` or `groupId`.");const o=$Q({},i,{groupId:n}),s=Wte(r);if(void 0!==s[n]||void 0!==t[n])throw new Error(`MUI X: The groupId ${n} is used multiple times in the columnGroupingModel.`);t=$Q({},t,s,{[n]:o})}),$Q({},t)},zte=(e,t,n)=>{if(!t.columnGroupingModel)return e;const r=O3(n),i=B3(n),o=Wte(t.columnGroupingModel??[]),s=Hte(t.columnGroupingModel??[]),a=Vte(r,s,n.current.state.pinnedColumns??{}),l=0===i.length?0:Math.max(...i.map(e=>s[e]?.length??0));return $Q({},e,{columnGrouping:{lookup:o,unwrappedGroupingModel:s,headerStructure:a,maxDepth:l}})},jte={includeHeaders:!0,includeOutliers:!1,outliersFactor:1.5,expand:!1,disableColumnVirtualization:!0};function Gte(e,t){if(void 0!==t&&e.changedTouches){for(let n=0;n<e.changedTouches.length;n+=1){const r=e.changedTouches[n];if(r.identifier===t)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function $te(e,t,n,r){let i=e;return i+="Right"===r?t-n.left:n.right-t,i}function Ute(e){e.preventDefault(),e.stopImmediatePropagation()}function Kte(e){const n=t.useRef(void 0),r=()=>l7(e),i=$2(e,r);t.useEffect(()=>{n.current&&!1===i&&(n.current.resolve(),n.current=void 0)});return()=>{if(!n.current){if(!1===r())return Promise.resolve();n.current=function(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});return n.resolve=e,n.reject=t,n}()}return n.current}}function Yte(e,t,n){const r={},i=e.current.rootElementRef.current;return i.classList.add(I2.autosizing),n.forEach(n=>{const i=function(e,t){const n=e.virtualScrollerRef.current;return Array.from(n.querySelectorAll(`:scope > div > div > div > [data-field="${Wee(t)}"][role="gridcell"]`))}(e.current,n.field),o=i.map(e=>e.getBoundingClientRect().width??0),s=t.includeOutliers?o:function(e,t){if(e.length<4)return e;const n=e.slice();n.sort((e,t)=>e-t);const r=n[Math.floor(.25*n.length)],i=n[Math.floor(.75*n.length)-1],o=i-r,s=o<5?5:o*t;return n.filter(e=>e>r-s&&e<i+s)}(o,t.outliersFactor);if(t.includeHeaders){const t=(a=e.current,l=n.field,a.columnHeadersContainerRef.current.querySelector(`:scope > div > [data-field="${Wee(l)}"][role="columnheader"]`));if(t){const e=t.querySelector(`.${I2.columnHeaderTitle}`),n=t.querySelector(`.${I2.columnHeaderTitleContainerContent}`),r=t.querySelector(`.${I2.iconButtonContainer}`),i=t.querySelector(`.${I2.menuIcon}`),o=e??n,a=window.getComputedStyle(t,null),l=parseInt(a.paddingLeft,10)+parseInt(a.paddingRight,10),c=o.scrollWidth+1+l+(r?.clientWidth??0)+(i?.clientWidth??0);s.push(c)}}var a,l;const c=n.minWidth!==-1/0&&void 0!==n.minWidth,u=n.maxWidth!==1/0&&void 0!==n.maxWidth,d=c?n.minWidth:0,h=u?n.maxWidth:1/0,p=0===s.length?0:Math.max(...s);r[n.field]=g5(p,d,h)}),i.classList.remove(I2.autosizing),r}const qte=e=>$Q({},e,{columnResize:{resizingColumnField:""}});function Xte(){return{colDef:void 0,initialColWidth:0,initialTotalWidth:0,previousMouseClickEvent:void 0,columnHeaderElement:void 0,headerFilterElement:void 0,groupHeaderElements:[],cellElements:[],leftPinnedCellsAfter:[],rightPinnedCellsBefore:[],fillerLeft:void 0,fillerRight:void 0,leftPinnedHeadersAfter:[],rightPinnedHeadersBefore:[]}}const Qte=(e,n)=>{const r=z6(),i=Z9(e,"useGridColumnResize"),o=H2(Xte).current,s=t.useRef(null),a=t.useRef(null),l=A4(),c=t.useRef(void 0),u=t=>{i.debug(`Updating width to ${t} for col ${o.colDef.field}`);const n=o.columnHeaderElement.offsetWidth,r=t-n,s=t-o.initialColWidth;if(s>0){const t=o.initialTotalWidth+s;e.current.rootElementRef?.current?.style.setProperty("--DataGrid-rowWidth",`${t}px`)}o.colDef.computedWidth=t,o.colDef.width=t,o.colDef.flex=0,o.columnHeaderElement.style.width=`${t}px`;const a=o.headerFilterElement;a&&(a.style.width=`${t}px`),o.groupHeaderElements.forEach(e=>{const n=e;let i;i="1"===n.getAttribute("aria-colspan")?`${t}px`:`${n.offsetWidth+r}px`,n.style.width=i}),o.cellElements.forEach(e=>{const n=e;let i;i="1"===n.getAttribute("aria-colspan")?`${t}px`:`${n.offsetWidth+r}px`,n.style.setProperty("--width",i)});const l=e.current.unstable_applyPipeProcessors("isColumnPinned",!1,o.colDef.field);l===I3.LEFT&&(Jte(o.fillerLeft,"width",r),o.leftPinnedCellsAfter.forEach(e=>{Jte(e,"left",r)}),o.leftPinnedHeadersAfter.forEach(e=>{Jte(e,"left",r)})),l===I3.RIGHT&&(Jte(o.fillerRight,"width",r),o.rightPinnedCellsBefore.forEach(e=>{Jte(e,"right",r)}),o.rightPinnedHeadersBefore.forEach(e=>{Jte(e,"right",r)}))},d=t=>{if(w(),o.previousMouseClickEvent){const n=o.previousMouseClickEvent,r=n.timeStamp,i=n.clientX,s=n.clientY;if(t.timeStamp-r<300&&t.clientX===i&&t.clientY===s)return o.previousMouseClickEvent=void 0,void e.current.publishEvent("columnResizeStop",null,t)}if(o.colDef){e.current.setColumnWidth(o.colDef.field,o.colDef.width),i.debug(`Updating col ${o.colDef.field} with new width: ${o.colDef.width}`);const t=F3(e);o.groupHeaderElements.forEach(e=>{const n=e,r=`${e.getAttribute("data-fields").slice(2,-2).split("-|-").reduce((e,n)=>!1!==t.columnVisibilityModel[n]?e+t.lookup[n].computedWidth:e,0)}px`;n.style.width=r})}l.start(0,()=>{e.current.publishEvent("columnResizeStop",null,t)})},h=(t,n,i)=>{const l=e.current.rootElementRef.current;var c,u;o.initialColWidth=t.computedWidth,o.initialTotalWidth=e.current.getRootDimensions().rowWidth,o.colDef=t,o.columnHeaderElement=(c=e.current.columnHeadersContainerRef.current,u=t.field,c.querySelector(`[data-field="${Wee(u)}"]`));const d=l.querySelector(`.${I2.headerFilterRow} [data-field="${Wee(t.field)}"]`);d&&(o.headerFilterElement=d),o.groupHeaderElements=function(e,t){return Array.from(e.querySelectorAll(`[data-fields*="|-${Wee(t)}-|"]`)??[])}(e.current.columnHeadersContainerRef?.current,t.field),o.cellElements=function(e,t){if(!Bee(e,I2.root))throw new Error("MUI X: The root element is not found.");const n=e.getAttribute("aria-colindex");if(!n)return[];const r=Number(n)-1,i=[];return t.virtualScrollerRef?.current?(Kee(t).forEach(e=>{const n=e.getAttribute("data-id");if(!n)return;let o=r;const s=t.unstable_getCellColSpanInfo(n,r);s&&s.spannedByColSpan&&(o=s.leftVisibleCellIndex);const a=e.querySelector(`[data-colindex="${o}"]`);a&&i.push(a)}),i):[]}(o.columnHeaderElement,e.current),o.fillerLeft=Gee(e.current,r?"filler--pinnedRight":"filler--pinnedLeft"),o.fillerRight=Gee(e.current,r?"filler--pinnedLeft":"filler--pinnedRight");const h=e.current.unstable_applyPipeProcessors("isColumnPinned",!1,o.colDef.field);o.leftPinnedCellsAfter=h!==I3.LEFT?[]:function(e,t,n){const r=Yee(t);return $ee({api:e,colIndex:r,position:n?"right":"left",filterFn:e=>n?e<r:e>r})}(e.current,o.columnHeaderElement,r),o.rightPinnedCellsBefore=h!==I3.RIGHT?[]:function(e,t,n){const r=Yee(t);return $ee({api:e,colIndex:r,position:n?"left":"right",filterFn:e=>n?e>r:e<r})}(e.current,o.columnHeaderElement,r),o.leftPinnedHeadersAfter=h!==I3.LEFT?[]:function(e,t,n){const r=Yee(t);return Uee({api:e,position:n?"right":"left",colIndex:r,filterFn:e=>n?e<r:e>r})}(e.current,o.columnHeaderElement,r),o.rightPinnedHeadersBefore=h!==I3.RIGHT?[]:function(e,t,n){const r=Yee(t);return Uee({api:e,position:n?"left":"right",colIndex:r,filterFn:(e,t)=>!t.classList.contains(I2["columnHeader--last"])&&(n?e>r:e<r)})}(e.current,o.columnHeaderElement,r),a.current=function(e,t){const n=e.classList.contains(I2["columnSeparator--sideRight"])?"Right":"Left";return t?function(e){return"Right"===e?"Left":"Right"}(n):n}(n,r),s.current=function(e,t,n){return"Left"===n?e-t.left:t.right-e}(i,o.columnHeaderElement.getBoundingClientRect(),a.current)},p=w4(d),g=w4(t=>{if(0===t.buttons)return void p(t);let n=$te(s.current,t.clientX,o.columnHeaderElement.getBoundingClientRect(),a.current);n=g5(n,o.colDef.minWidth,o.colDef.maxWidth),u(n);const r={element:o.columnHeaderElement,colDef:o.colDef,width:n};e.current.publishEvent("columnResize",r,t)}),f=w4(e=>{Gte(e,c.current)&&d(e)}),m=w4(t=>{const n=Gte(t,c.current);if(!n)return;if("mousemove"===t.type&&0===t.buttons)return void f(t);let r=$te(s.current,n.x,o.columnHeaderElement.getBoundingClientRect(),a.current);r=g5(r,o.colDef.minWidth,o.colDef.maxWidth),u(r);const i={element:o.columnHeaderElement,colDef:o.colDef,width:r};e.current.publishEvent("columnResize",i,t)}),v=w4(t=>{const n=Bee(t.target,I2["columnSeparator--resizable"]);if(!n)return;const r=t.changedTouches[0];null!=r&&(c.current=r.identifier);const o=Bee(t.target,I2.columnHeader),s=o.getAttribute("data-field");const a=e.current.getColumn(s);i.debug(`Start Resize on col ${a.field}`),e.current.publishEvent("columnResizeStart",{field:s},t),h(a,n,r.clientX);const l=Iee(t.currentTarget);l.addEventListener("touchmove",m),l.addEventListener("touchend",f)}),w=t.useCallback(()=>{const t=Iee(e.current.rootElementRef.current);t.body.style.removeProperty("cursor"),t.removeEventListener("mousemove",g),t.removeEventListener("mouseup",p),t.removeEventListener("touchmove",m),t.removeEventListener("touchend",f),setTimeout(()=>{t.removeEventListener("click",Ute,!0)},100),o.columnHeaderElement&&(o.columnHeaderElement.style.pointerEvents="unset")},[e,o,g,p,m,f]),b=t.useCallback(t=>{let{field:n}=t;e.current.setState(e=>$Q({},e,{columnResize:$Q({},e.columnResize,{resizingColumnField:n})}))},[e]),C=t.useCallback(()=>{e.current.setState(e=>$Q({},e,{columnResize:$Q({},e.columnResize,{resizingColumnField:""})}))},[e]),y=w4((t,n)=>{let{colDef:r}=t;if(0!==n.button)return;if(!n.currentTarget.classList.contains(I2["columnSeparator--resizable"]))return;n.preventDefault(),i.debug(`Start Resize on col ${r.field}`),e.current.publishEvent("columnResizeStart",{field:r.field},n),h(r,n.currentTarget,n.clientX);const s=Iee(e.current.rootElementRef.current);s.body.style.cursor="col-resize",o.previousMouseClickEvent=n.nativeEvent,s.addEventListener("mousemove",g),s.addEventListener("mouseup",p),s.addEventListener("click",Ute,!0)}),S=w4((t,r)=>{if(n.disableAutosize)return;if(0!==r.button)return;const i=e.current.state.columns.lookup[t.field];!1!==i.resizable&&e.current.autosizeColumns($Q({},n.autosizeOptions,{disableColumnVirtualization:!1,columns:[i.field]}))}),x=Kte(e),R=t.useRef(!1),E=t.useCallback(async t=>{const r=e.current.rootElementRef?.current;if(!r)return;if(R.current)return;R.current=!0;const i=F3(e),o=$Q({},jte,t,{columns:t?.columns??i.orderedFields});o.columns=o.columns.filter(e=>!1!==i.columnVisibilityModel[e]);const s=o.columns.map(t=>e.current.state.columns.lookup[t]);try{!n.disableVirtualization&&o.disableColumnVirtualization&&(e.current.unstable_setColumnVirtualization(!1),await x());const t=Yte(e,o,s),r=s.map(e=>$Q({},e,{width:t[e.field],computedWidth:t[e.field],flex:0}));if(o.expand){const n=i.orderedFields.map(e=>i.lookup[e]).filter(e=>!1!==i.columnVisibilityModel[e.field]).reduce((e,n)=>e+(t[n.field]??n.computedWidth??n.width),0),o=e.current.getRootDimensions(),s=o.viewportInnerSize.width-n;if(s>0){const e=s/(r.length||1);r.forEach(t=>{t.width+=e,t.computedWidth+=e})}}e.current.updateColumns(r),r.forEach((t,n)=>{if(t.width!==s[n].width){const n=t.width;e.current.publishEvent("columnWidthChange",{element:e.current.getColumnHeaderElement(t.field),colDef:t,width:n})}})}finally{n.disableVirtualization||e.current.unstable_setColumnVirtualization(!0),R.current=!1}},[e,x,n.disableVirtualization]);t.useEffect(()=>w,[w]),P4(()=>{n.autosizeOnMount&&Promise.resolve().then(()=>{e.current.autosizeColumns(n.autosizeOptions)})}),eee(e,()=>e.current.columnHeadersContainerRef?.current,"touchstart",v,{passive:!0}),h7(e,{autosizeColumns:E},"public"),R4(e,"columnResizeStop",C),R4(e,"columnResizeStart",b),R4(e,"columnSeparatorMouseDown",y),R4(e,"columnSeparatorDoubleClick",S),T4(e,"columnResize",n.onColumnResize),T4(e,"columnWidthChange",n.onColumnWidthChange)};function Jte(e,t,n){e&&(e.style[t]=`${parseInt(e.style[t],10)+n}px`)}function Zte(e){return 0!==e.firstRowIndex||0!==e.lastRowIndex}const ene=(e,t,n)=>{if(!e)return null;let r=e[t.field];const i=t.rowSpanValueGetter??t.valueGetter;return i&&(r=i(r,e,t,n)),r},tne={spannedCells:{},hiddenCells:{},hiddenCellOriginMap:{}},nne={firstRowIndex:0,lastRowIndex:0},rne=new Set([see,"__reorder__",p6]),ine=(e,t,n,r,i,o,s)=>{const a=o?{}:$Q({},e.current.state.rowSpanning.spannedCells),l=o?{}:$Q({},e.current.state.rowSpanning.hiddenCells),c=o?{}:$Q({},e.current.state.rowSpanning.hiddenCellOriginMap);return o&&(s=nne),t.forEach(t=>{if(!rne.has(t.field)){for(let o=i.firstRowIndex;o<i.lastRowIndex;o+=1){const s=n[o];if(l[s.id]?.[t.field])continue;const u=ene(s.model,t,e);if(null==u)continue;let d=s.id,h=o,p=0;const g=[];if(o===i.firstRowIndex){let i=o-1,s=n[i];for(;i>=r.firstRowIndex&&s&&ene(s.model,t,e)===u;){const e=n[i+1];l[e.id]?l[e.id][t.field]=!0:l[e.id]={[t.field]:!0},g.push(o),p+=1,d=s.id,h=i,i-=1,s=n[i]}}g.forEach(e=>{c[e]?c[e][t.field]=h:c[e]={[t.field]:h}});let f=o+1;for(;f<=r.lastRowIndex&&n[f]&&ene(n[f].model,t,e)===u;){const e=n[f];l[e.id]?l[e.id][t.field]=!0:l[e.id]={[t.field]:!0},c[f]?c[f][t.field]=h:c[f]={[t.field]:h},f+=1,p+=1}p>0&&(a[d]?a[d][t.field]=p+1:a[d]={[t.field]:p+1})}s={firstRowIndex:Math.min(s.firstRowIndex,i.firstRowIndex),lastRowIndex:Math.max(s.lastRowIndex,i.lastRowIndex)}}}),{spannedCells:a,hiddenCells:l,hiddenCellOriginMap:c,processedRange:s}},one=(e,t)=>{const n=Y4(t).length;if(e.pagination){const e=Q8(t);let r=20;return e>0&&(r=e-1),{firstRowIndex:0,lastRowIndex:Math.min(r,n)}}return{firstRowIndex:0,lastRowIndex:Math.min(20,n)}},sne=(e,t,n)=>{if(!t.rowSpanning)return $Q({},e,{rowSpanning:tne});const r=e.rows.dataRowIds||[],i=e.columns.orderedFields||[],o=e.rows.dataRowIdToModelLookup,s=e.columns.lookup,a=Boolean(e.filter.filterModel.items.length)||Boolean(e.filter.filterModel.quickFilterValues?.length);if(!r.length||!i.length||!o||!s||a)return $Q({},e,{rowSpanning:tne});const l=one(t,n),c=r.map(e=>({id:e,model:o[e]})),u=i.map(e=>s[e]),{spannedCells:d,hiddenCells:h,hiddenCellOriginMap:p}=ine(n,u,c,l,l,!0,nne);return $Q({},e,{rowSpanning:{spannedCells:d,hiddenCells:h,hiddenCellOriginMap:p}})};new Set;const ane=(e,t,n)=>$Q({},e,{listViewColumn:t.listViewColumn?$Q({},t.listViewColumn,{computedWidth:lne(n)}):void 0});function lne(e){return o4(e).viewportInnerSize.width}function cne(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];clearTimeout(t),t=setTimeout(()=>{e.apply(this,i)},n)}return r.clear=()=>{clearTimeout(t)},r}const une=C3(k8,R8,K8,(e,t,n)=>({groupKeys:[],paginationModel:n,sortModel:t,filterModel:e,start:n.page*n.pageSize,end:n.page*n.pageSize+n.pageSize-1}));let dne=function(e){return e.Default="set-new-rows",e.LazyLoading="replace-row-range",e}({});class hne{constructor(e){this.chunkSize=void 0,this.getCacheKeys=e=>{if(this.chunkSize<1||"number"!==typeof e.start)return[e];const t=[];for(let n=e.start;n<=e.end;n+=this.chunkSize){const r=Math.min(n+this.chunkSize-1,e.end);t.push($Q({},e,{start:n,end:r}))}return t},this.splitResponse=(e,t)=>{const n=this.getCacheKeys(e),r=new Map;return n.forEach(n=>{const i=n.end===e.end,o=$Q({},t,{pageInfo:$Q({},t.pageInfo,{hasNextPage:void 0!==t.pageInfo?.hasNextPage&&!i||t.pageInfo?.hasNextPage,nextCursor:void 0===t.pageInfo?.nextCursor||i?t.pageInfo?.nextCursor:t.rows[n.end+1].id}),rows:"number"!==typeof n.start||"number"!==typeof e.start?t.rows:t.rows.slice(n.start-e.start,n.end-e.start+1)});r.set(n,o)}),r},this.chunkSize=e}}function pne(e){return JSON.stringify([e.filterModel,e.sortModel,e.start,e.end])}hne.mergeResponses=e=>1===e.length?e[0]:e.reduce((e,t)=>({rows:[...e.rows,...t.rows],rowCount:t.rowCount,pageInfo:t.pageInfo}),{rows:[],rowCount:0,pageInfo:{}});class gne{constructor(e){let{ttl:t=3e5,getKey:n=pne}=e;this.cache=void 0,this.ttl=void 0,this.getKey=void 0,this.cache={},this.ttl=t,this.getKey=n}set(e,t){const n=this.getKey(e),r=Date.now()+this.ttl;this.cache[n]={value:t,expiry:r}}get(e){const t=this.getKey(e),n=this.cache[t];if(n){if(!(Date.now()>n.expiry))return n.value;delete this.cache[t]}}clear(){this.cache={}}}class fne extends Error{constructor(e){super(e.message),this.params=void 0,this.cause=void 0,this.name="GridGetRowsError",this.params=e.params,this.cause=e.cause}}class mne extends Error{constructor(e){super(e.message),this.params=void 0,this.cause=void 0,this.name="GridUpdateRowError",this.params=e.params,this.cause=e.cause}}const vne={clear:()=>{},get:()=>{},set:()=>{}};function wne(e){return null===e?vne:e??new gne(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}const bne=(e,n)=>{const{api:r,strategyProcessor:i,events:o,setStrategyAvailability:s}=function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=t.useCallback(()=>{e.current.setStrategyAvailability(K9.DataSource,dne.Default,n.dataSource?()=>!0:()=>!1)},[e,n.dataSource]),[o,s]=t.useState(!1),a=$2(e,K8),l=t.useRef(0),c=n.onDataSourceError,u=H2(()=>{const e=n.pageSizeOptions.map(e=>"number"===typeof e?e:e.value).sort((e,t)=>e-t),t=Math.min(a.pageSize,e[0]);return new hne(t)}).current,[d,h]=t.useState(()=>wne(n.dataSourceCache,r.cacheOptions)),p=t.useCallback(async(t,i)=>{const s=n.dataSource?.getRows;if(!s)return;if(t&&t!==X5&&"DataGrid"!==n.signature)return void r.fetchRowChildren?.([t]);r.clearDataSourceState?.();const a=$Q({},une(e),e.current.unstable_applyPipeProcessors("getRowsParams",{}),i),h=u.getCacheKeys(a).map(e=>d.get(e));if(h.every(e=>void 0!==e))return void e.current.applyStrategyProcessor("dataSourceRowsUpdate",{response:hne.mergeResponses(h),fetchParams:a});(o||0===e.current.getRowsCount())&&e.current.setLoading(!0);const p=l.current+1;l.current=p;try{const t=await s(a);u.splitResponse(a,t).forEach((e,t)=>d.set(t,e)),l.current===p&&e.current.applyStrategyProcessor("dataSourceRowsUpdate",{response:t,fetchParams:a})}catch(g){l.current===p&&(e.current.applyStrategyProcessor("dataSourceRowsUpdate",{error:g,fetchParams:a}),"function"===typeof c&&c(new fne({message:g?.message,params:a,cause:g})))}finally{o&&l.current===p&&e.current.setLoading(!1)}},[u,d,e,o,n.dataSource?.getRows,c,r,n.signature]),g=t.useCallback(()=>{s(e.current.getActiveStrategy(K9.DataSource)===dne.Default)},[e]),f=t.useCallback(t=>{if("error"in t)return void e.current.setRows([]);const{response:n}=t;void 0!==n.rowCount&&e.current.setRowCount(n.rowCount),e.current.setRows(n.rows),e.current.unstable_applyPipeProcessors("processDataSourceRows",{params:t.fetchParams,response:n},!0)},[e]),m=n.dataSource?.updateRow,v=r.handleEditRow,w=t.useCallback(async t=>{if(m)try{const n=await m(t);return"function"===typeof v?(v(t,n),n):(e.current.updateNestedRows([n],[]),n&&!Aee(n,t.previousRow)&&e.current.dataSource.cache.clear(),n)}catch(n){throw"function"===typeof c&&c(new mne({message:n?.message,params:t,cause:n})),n}},[e,m,c,v]),b={dataSource:{fetchRows:p,cache:d,editRow:w}},C=t.useMemo(()=>cne(p,0),[p]),y=t.useRef(!0);return t.useEffect(()=>{if(y.current)return void(y.current=!1);if(void 0===n.dataSourceCache)return;const e=wne(n.dataSourceCache,r.cacheOptions);h(t=>t!==e?e:t)},[n.dataSourceCache,r.cacheOptions]),t.useEffect(()=>(n.dataSource&&(e.current.dataSource.cache.clear(),e.current.dataSource.fetchRows()),()=>{l.current+=1}),[e,n.dataSource]),{api:{public:b},debouncedFetchRows:C,strategyProcessor:{strategyName:dne.Default,group:"dataSourceRowsUpdate",processor:f},setStrategyAvailability:i,cacheChunkManager:u,cache:d,events:{strategyAvailabilityChange:g,sortModelChange:v5(o,()=>C()),filterModelChange:v5(o,()=>C()),paginationModelChange:v5(o,()=>C())}}}(e,n);h7(e,r.public,"public"),Oee(e,i.strategyName,i.group,i.processor),Object.entries(o).forEach(t=>{let[n,r]=t;R4(e,n,r)}),t.useEffect(()=>{s()},[s])},Cne=(e,n)=>{Q9(e,n),Cte(e,n),(e=>{Oee(e,Y9,"rowTreeCreation",fte)})(e),J9(X9,e,n),J9(bte,e,n),J9(wee,e,n),J9(gte,e,n),J9(Zee,e,n),J9(hte,e,n),J9(Vee,e,n),J9(yte,e,n),J9(tte,e,n),J9(Nee,e,n),J9(sne,e,n),J9(Cee,e,n),J9(qte,e,n),J9(gee,e,n),J9(zte,e,n),J9(g7,e,n),J9(Tte,e,n),J9(Fte,e,n),J9(ane,e,n),Jee(e,n),((e,n)=>{const r=Z9(e,"useGridSelection"),i=t.useCallback(e=>function(){n.rowSelection&&e(...arguments)},[n.rowSelection]),o=n.signature!==W8.DataGrid&&(n.rowSelectionPropagation?.parents||n.rowSelectionPropagation?.descendants),s=t.useMemo(()=>n.rowSelectionModel,[n.rowSelectionModel]),a=t.useRef(null);e.current.registerControlState({stateId:"rowSelection",propModel:s,propOnChange:n.onRowSelectionModelChange,stateSelector:N7,changeEvent:"rowSelectionChange"});const{checkboxSelection:l,disableRowSelectionOnClick:c,isRowSelectable:u}=n,d=L9(n),h=$2(e,z4),p=$2(e,K4)>1,g=t.useCallback(t=>{let n=t;const r=a.current??t,i=e.current.isRowSelected(t);if(i){const t=D8(e),i=t.findIndex(e=>e===r),o=t.findIndex(e=>e===n);if(i===o)return;n=i>o?t[o+1]:t[o-1]}a.current=t,e.current.selectRowRange({startId:r,endId:n},!i)},[e]),f=w4(()=>n.pagination&&n.checkboxSelectionVisibleOnly&&"client"===n.paginationMode?t7(e):D8(e)),m=t.useCallback((t,i)=>{if(n.signature===W8.DataGrid&&!d&&("include"!==t.type||t.ids.size>1))throw new Error(["MUI X: `rowSelectionModel` can only contain 1 item in DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock multiple selection."].join("\n"));N7(e)!==t&&(r.debug("Setting selection model"),e.current.setState(e=>$Q({},e,{rowSelection:n.rowSelection?t:wte}),i))},[e,r,n.rowSelection,n.signature,d]),v=t.useCallback(t=>L7(e).has(t),[e]),w=t.useCallback(t=>{if(!1===n.rowSelection)return!1;if(u&&!u(e.current.getRowParams(t)))return!1;const r=j4(e,t);return"footer"!==r?.type&&"pinnedRow"!==r?.type},[e,n.rowSelection,u]),b=t.useCallback(()=>H7(e),[e]),C=t.useCallback(function(t){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.current.isRowSelectable(t))if(a.current=t,s){r.debug(`Setting selection for row ${t}`);const s={type:"include",ids:new Set},a=e=>{s.ids.add(e)};i&&(a(t),o&&_9(e,h,t,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,a)),e.current.setRowSelectionModel(s,"singleRowSelection")}else{r.debug(`Toggling selection for row ${t}`);const s=N7(e),a={type:s.type,ids:new Set(s.ids)},l=O7(a);l.unselect(t);const c=e=>{l.select(e)},u=e=>{l.unselect(e)};i?(c(t),o&&_9(e,h,t,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,c)):o&&H9(e,h,t,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,u),("include"===a.type&&a.ids.size<2||d)&&e.current.setRowSelectionModel(a,"singleRowSelection")}},[e,r,o,h,n.rowSelectionPropagation?.descendants,n.rowSelectionPropagation?.parents,d]),y=t.useCallback(function(t){let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r.debug("Setting selection for several rows"),!1===n.rowSelection)return;const a=new Set;for(let n=0;n<t.length;n+=1){const r=t[n];e.current.isRowSelectable(r)&&a.add(r)}const l=N7(e);let c;if(s){if(c={type:"include",ids:a},i){const t=O7(c);if(o){const r=e=>{t.select(e)};for(const t of a)_9(e,h,t,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,r)}}else c.ids=new Set;if(l.type===c.type&&c.ids.size===l.ids.size&&Array.from(c.ids).every(e=>l.ids.has(e)))return}else{c={type:l.type,ids:new Set(l.ids)};const t=O7(c),r=e=>{t.select(e)},s=e=>{t.unselect(e)};for(const l of a)i?(t.select(l),o&&_9(e,h,l,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,r)):(s(l),o&&H9(e,h,l,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,s))}("include"===c.type&&c.ids.size<2||d)&&e.current.setRowSelectionModel(c,"multipleRowsSelection")},[r,o,d,e,h,n.rowSelectionPropagation?.descendants,n.rowSelectionPropagation?.parents,n.rowSelection]),S=t.useCallback(t=>{if(!p||!o||0===t.ids.size&&"include"===t.type)return t;const r={type:t.type,ids:new Set(t.ids)},i=O7(r),s=e=>{i.select(e)};for(const o of t.ids)_9(e,h,o,n.rowSelectionPropagation?.descendants??!1,n.rowSelectionPropagation?.parents??!1,s,i);return r},[e,h,n.rowSelectionPropagation?.descendants,n.rowSelectionPropagation?.parents,p,o]),x=t.useCallback(function(t){let{startId:n,endId:i}=t,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e.current.getRow(n)||!e.current.getRow(i))return;r.debug(`Expanding selection from row ${n} to row ${i}`);const a=D8(e),l=a.indexOf(n),c=a.indexOf(i),[u,d]=l>c?[c,l]:[l,c],h=a.slice(u,d+1);e.current.selectRows(h,o,s)},[e,r]),R={selectRows:y,selectRowRange:x,getPropagatedRowSelectionModel:S};h7(e,{selectRow:C,setRowSelectionModel:m,getSelectedRows:b,isRowSelected:v,isRowSelectable:w},"public"),h7(e,R,n.signature===W8.DataGrid?"private":"public");const E=t.useRef(!0),T=t.useCallback(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(E.current)return;const r=N7(e),i=W4(e),o=I8(e),s=e=>"server"===n.filterMode?!i[e]:!i[e]||!1===o[e],a={type:r.type,ids:new Set(r.ids)},l=O7(a);let c=!1;for(const e of r.ids){if(s(e)){if(n.keepNonExistentRowsSelected)continue;l.unselect(e),c=!0;continue}if(!n.rowSelectionPropagation?.parents)continue;const t=h[e];if("group"===t?.type){if(t.isAutoGenerated){l.unselect(e),c=!0;continue}t.children.every(e=>!1===o[e])||(l.unselect(e),c=!0)}}const u=p&&n.rowSelectionPropagation?.parents&&(a.ids.size>0||"exclude"===a.type);if(c||u&&!t)if(u)if("exclude"===a.type){const t=f(),r=[];for(let e=0;e<t.length;e+=1){const i=t[e];!n.keepNonExistentRowsSelected&&s(i)||!l.has(i)||r.push(i)}e.current.selectRows(r,!0,!0)}else e.current.selectRows(Array.from(a.ids),!0,!0);else e.current.setRowSelectionModel(a,"multipleRowsSelection")},[e,p,n.rowSelectionPropagation?.parents,n.keepNonExistentRowsSelected,n.filterMode,h,f]),k=t.useCallback((t,n)=>{const r=n.metaKey||n.ctrlKey,i=!l&&!r&&!(e=>!!e.key)(n),o=!d||i,s=e.current.isRowSelected(t),a=_7(e)>1&&o||!s;e.current.selectRow(t,a,o)},[e,d,l]),M=t.useCallback((t,n)=>{if(c)return;const r=n.target.closest(`.${I2.cell}`)?.getAttribute("data-field");if(r!==aee.field&&r!==p6){if(r){const t=e.current.getColumn(r);if(t?.type===J6)return}"pinnedRow"!==j4(e,t.id).type&&(n.shiftKey&&d?g(t.id):k(t.id,n))}},[c,d,e,g,k]),P=t.useCallback((e,t)=>{d&&t.shiftKey&&window.getSelection()?.removeAllRanges()},[d]),I=t.useCallback((t,n)=>{d&&n.nativeEvent.shiftKey?g(t.id):e.current.selectRow(t.id,t.value,!d)},[e,g,d]),A=t.useCallback(t=>{const r=k8(e),i=M8(e),s=r.items.length>0||i?.some(e=>e.length);n.isRowSelectable||n.checkboxSelectionVisibleOnly||!o||s?e.current.selectRows(f(),t):e.current.setRowSelectionModel({type:t?"exclude":"include",ids:new Set})},[e,o,f,n.checkboxSelectionVisibleOnly,n.isRowSelectable]),D=t.useCallback(e=>{A(e.value)},[A]),F=t.useCallback((t,n)=>{if(e.current.getCellMode(t.id,t.field)!==k6.Edit&&!jee(n)){if(G6(n.key)&&n.shiftKey){const r=y7(e);if(r&&r.id!==t.id){n.preventDefault();const i=e.current.isRowSelected(r.id);if(!d)return void e.current.selectRow(r.id,!i,!0);const o=e.current.getRowIndexRelativeToVisibleRows(r.id),s=e.current.getRowIndexRelativeToVisibleRows(t.id);let a,l;o>s?i?(a=s,l=o-1):(a=s,l=o):i?(a=o+1,l=s):(a=o,l=s);const c=r7(e),u=[];for(let e=a;e<=l;e+=1)u.push(c.rows[e].id);return void e.current.selectRows(u,!i)}}if(" "===n.key&&n.shiftKey)return n.preventDefault(),void k(t.id,n);"A"===String.fromCharCode(n.keyCode)&&(n.ctrlKey||n.metaKey)&&(n.preventDefault(),A(!0))}},[e,d,k,A]),O=w4(()=>{if(!n.rowSelection)return void e.current.setRowSelectionModel(wte);if(void 0===s)return;if(!o||!p||"include"===s.type&&0===s.ids.size)return void e.current.setRowSelectionModel(s);const t=e.current.getPropagatedRowSelectionModel(s);t.type===s.type&&t.ids.size===s.ids.size&&Array.from(s.ids).every(e=>t.ids.has(e))?e.current.setRowSelectionModel(s):e.current.setRowSelectionModel(t)});R4(e,"sortedRowsSet",i(()=>T(!0))),R4(e,"filteredRowsSet",i(()=>T())),R4(e,"rowClick",i(M)),R4(e,"rowSelectionCheckboxChange",i(I)),R4(e,"headerSelectionCheckboxChange",D),R4(e,"cellMouseDown",i(P)),R4(e,"cellKeyDown",i(F)),t.useEffect(()=>{O()},[e,s,n.rowSelection,O]);const N=null!=s;t.useEffect(()=>{if(N||!n.rowSelection||"function"!==typeof w)return;const t=N7(e);if("include"!==t.type)return;const r=new Set;for(const e of t.ids)w(e)&&r.add(e);r.size<t.ids.size&&e.current.setRowSelectionModel({type:t.type,ids:r})},[e,w,N,n.rowSelection]),t.useEffect(()=>{if(!n.rowSelection||N)return;const t=N7(e);!d&&("include"===t.type&&t.ids.size>1||"exclude"===t.type)&&e.current.setRowSelectionModel(wte)},[e,d,l,N,n.rowSelection]),t.useEffect(()=>{i(T)},[T,i]),t.useEffect(()=>{E.current&&(E.current=!1)},[])})(e,n),bee(e,n),((e,n)=>{const r=Z9(e,"useGridRows"),i=t.useRef(Date.now()),o=t.useRef(n.rowCount),s=A4(),a=t.useCallback(t=>{const n=W4(e)[t];if(n)return n;const r=j4(e,t);return r&&n6(r)?{[Q5]:t}:null},[e]),l=t.useCallback(t=>l6(e,t),[e]),c=t.useCallback(t=>{let{cache:r,throttle:o}=t;const a=()=>{i.current=Date.now(),e.current.setState(t=>$Q({},t,{rows:t6({apiRef:e,rowCountProp:n.rowCount,loadingProp:n.loading,previousTree:z4(e),previousTreeDepths:U4(e),previousGroupsToFetch:G4(e)})})),e.current.publishEvent("rowsSet")};if(s.clear(),e.current.caches.rows=r,!o)return void a();const l=n.throttleRowsMs-(Date.now()-i.current);l>0?s.start(l,a):a()},[n.throttleRowsMs,n.rowCount,n.loading,e,s]),u=t.useCallback(t=>{if(r.debug(`Updating all rows, new length ${t.length}`),n9(e))return void e.current.updateNonPivotRows(t,!1);const i=Z5({rows:t,getRowId:n.getRowId,loading:n.loading,rowCount:n.rowCount}),o=e.current.caches.rows;i.rowsBeforePartialUpdates=o.rowsBeforePartialUpdates,c({cache:i,throttle:!0})},[r,n.getRowId,n.loading,n.rowCount,c,e]),d=t.useCallback(t=>{if(n.signature===W8.DataGrid&&t.length>1)throw new Error(["MUI X: You cannot update several rows at once in `apiRef.current.updateRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join("\n"));if(n9(e))return void e.current.updateNonPivotRows(t);const r=s6(e,t,n.getRowId),i=i6({updates:r,getRowId:n.getRowId,previousCache:e.current.caches.rows});c({cache:i,throttle:!0})},[n.signature,n.getRowId,c,e]),h=t.useCallback((t,r)=>{const i=s6(e,t,n.getRowId),o=i6({updates:i,getRowId:n.getRowId,previousCache:e.current.caches.rows,groupKeys:r??[]});c({cache:o,throttle:!1})},[n.getRowId,c,e]),p=t.useCallback(t=>{r.debug(`Setting loading to ${t}`),e.current.setState(e=>$Q({},e,{rows:$Q({},e.rows,{loading:t})})),e.current.caches.rows.loadingPropBeforePartialUpdates=t},[e,r]),g=t.useCallback(()=>{const t=Y4(e),n=W4(e);return new Map(t.map(e=>[e,n[e]??{}]))},[e]),f=t.useCallback(()=>H4(e),[e]),m=t.useCallback(()=>Y4(e),[e]),v=t.useCallback(t=>{const{rowIdToIndexMap:n}=r7(e);return n.get(t)},[e]),w=t.useCallback((t,n)=>{const r=j4(e,t);if(!r)throw new Error(`MUI X: No row with id #${t} found.`);if("group"!==r.type)throw new Error("MUI X: Only group nodes can be expanded or collapsed.");const i=$Q({},r,{childrenExpanded:n});e.current.setState(e=>$Q({},e,{rows:$Q({},e.rows,{tree:$Q({},e.rows.tree,{[t]:i})})})),e.current.publishEvent("rowExpansionChange",i)},[e]),b=t.useCallback(t=>j4(e,t)??null,[e]),C=t.useCallback(t=>{let{skipAutoGeneratedRows:n=!0,groupId:r,applySorting:i,applyFiltering:o}=t;const s=z4(e);let a;if(i){const t=s[r];if(!t)return[];const i=S8(e);a=[];for(let e=i.findIndex(e=>e===r)+1;e<i.length&&s[i[e]].depth>t.depth;e+=1){const t=i[e];n&&n6(s[t])||a.push(t)}}else a=r6(s,r,n);if(o){const t=I8(e);a=C8(t)?a:a.filter(e=>!1!==t[e])}return a},[e]),y=t.useCallback((t,n)=>{const i=j4(e,t);if(!i)throw new Error(`MUI X: No row with id #${t} found.`);if(i.parent!==X5)throw new Error("MUI X: The row reordering do not support reordering of grouped rows yet.");if("leaf"!==i.type)throw new Error("MUI X: The row reordering do not support reordering of footer or grouping rows.");e.current.setState(i=>{const o=z4(e)[X5],s=o.children,a=s.findIndex(e=>e===t);if(-1===a||a===n)return i;r.debug(`Moving row ${t} to index ${n}`);const l=[...s];return l.splice(n,0,l.splice(a,1)[0]),$Q({},i,{rows:$Q({},i.rows,{tree:$Q({},i.rows.tree,{[X5]:$Q({},o,{children:l})})})})}),e.current.publishEvent("rowsSet")},[e,r]),S={getRow:a,setLoading:p,getRowId:l,getRowModels:g,getRowsCount:f,getAllRowIds:m,setRows:u,updateRows:d,getRowNode:b,getRowIndexRelativeToVisibleRows:v,unstable_replaceRows:t.useCallback((t,r)=>{if(n.signature===W8.DataGrid&&r.length>1)throw new Error(["MUI X: You cannot replace rows using `apiRef.current.unstable_replaceRows` on the DataGrid.","You need to upgrade to DataGridPro or DataGridPremium component to unlock this feature."].join("\n"));if(0===r.length)return;if(K4(e)>1)throw new Error("`apiRef.current.unstable_replaceRows` is not compatible with tree data and row grouping");const i=$Q({},z4(e)),o=$Q({},W4(e)),s=i[X5],a=[...s.children],l=new Set;for(let e=0;e<r.length;e+=1){const s=r[e],c=J5(s,n.getRowId,"A row was provided without id when calling replaceRows()."),[u]=a.splice(t+e,1,c);l.has(u)||(delete o[u],delete i[u]);const d={id:c,depth:0,parent:X5,type:"leaf",groupingKey:null};o[c]=s,i[c]=d,l.add(c)}i[X5]=$Q({},s,{children:a});const c=a.filter(e=>"leaf"===i[e]?.type);e.current.caches.rows.dataRowIdToModelLookup=o,e.current.setState(e=>$Q({},e,{rows:$Q({},e.rows,{loading:n.loading,totalRowCount:Math.max(n.rowCount||0,a.length),dataRowIdToModelLookup:o,dataRowIds:c,tree:i})})),e.current.publishEvent("rowsSet")},[e,n.signature,n.getRowId,n.loading,n.rowCount])},x={setRowIndex:y,setRowChildrenExpansion:w,getRowGroupChildren:C},R={updateNestedRows:h},E=t.useCallback(()=>{let t;r.info("Row grouping pre-processing have changed, regenerating the row tree"),t=e.current.caches.rows.rowsBeforePartialUpdates===n.rows?$Q({},e.current.caches.rows,{updates:{type:"full",rows:Y4(e)}}):Z5({rows:n.rows,getRowId:n.getRowId,loading:n.loading,rowCount:n.rowCount}),c({cache:t,throttle:!1})},[r,e,n.rows,n.getRowId,n.loading,n.rowCount,c]),T=H2(()=>n.dataSource),k=t.useCallback(e=>{n.dataSource&&n.dataSource!==T.current?T.current=n.dataSource:"rowTreeCreation"===e&&E()},[E,T,n.dataSource]),M=t.useCallback(()=>{e.current.getActiveStrategy(K9.RowTree)!==$4(e)&&E()},[e,E]);R4(e,"activeStrategyProcessorChange",k),R4(e,"strategyAvailabilityChange",M);const P=t.useCallback(()=>{e.current.setState(t=>{const r=e.current.unstable_applyPipeProcessors("hydrateRows",{tree:z4(e),treeDepths:U4(e),dataRowIds:Y4(e),dataRowIdToModelLookup:W4(e)});return $Q({},t,{rows:$Q({},t.rows,r,{totalTopLevelRowCount:e6({tree:r.tree,rowCountProp:n.rowCount})})})}),e.current.publishEvent("rowsSet")},[e,n.rowCount]);vee(e,"hydrateRows",P),h7(e,S,"public"),h7(e,x,n.signature===W8.DataGrid?"private":"public"),h7(e,R,"private");const I=t.useRef(!0);t.useEffect(()=>{if(I.current)return void(I.current=!1);let t=!1;n.rowCount!==o.current&&(t=!0,o.current=n.rowCount);const i=n.dataSource?q4(e):n.rows,s=e.current.caches.rows.rowsBeforePartialUpdates===i,a=e.current.caches.rows.loadingPropBeforePartialUpdates===n.loading,l=e.current.caches.rows.rowCountPropBeforePartialUpdates===n.rowCount;s&&(a||(e.current.setState(e=>$Q({},e,{rows:$Q({},e.rows,{loading:n.loading})})),e.current.caches.rows.loadingPropBeforePartialUpdates=n.loading),l||(e.current.setState(e=>$Q({},e,{rows:$Q({},e.rows,{totalRowCount:Math.max(n.rowCount||0,e.rows.totalRowCount),totalTopLevelRowCount:Math.max(n.rowCount||0,e.rows.totalTopLevelRowCount)})})),e.current.caches.rows.rowCountPropBeforePartialUpdates=n.rowCount),!t)||(r.debug(`Updating all rows, new length ${i?.length}`),c({cache:Z5({rows:i,getRowId:n.getRowId,loading:n.loading,rowCount:n.rowCount}),throttle:!1}))},[n.rows,n.rowCount,n.getRowId,n.loading,n.dataSource,r,c,e])})(e,n),((e,n)=>{const r=H2(()=>e.current.state.rowSpanning!==tne?one(n,e):nne),i=t.useCallback(function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{range:o,rows:s}=r7(e,(n.pagination,n.paginationMode));if(null===o||!Zte(t))return;i&&(r.current=nne);const a=function(e,t){return e.firstRowIndex>=t.firstRowIndex&&e.lastRowIndex<=t.lastRowIndex?null:e.firstRowIndex>=t.firstRowIndex&&e.lastRowIndex>t.lastRowIndex?{firstRowIndex:t.lastRowIndex,lastRowIndex:e.lastRowIndex}:e.firstRowIndex<t.firstRowIndex&&e.lastRowIndex<=t.lastRowIndex?{firstRowIndex:e.firstRowIndex,lastRowIndex:t.firstRowIndex-1}:e}({firstRowIndex:t.firstRowIndex,lastRowIndex:Math.min(t.lastRowIndex,o.lastRowIndex+1)},r.current);if(null===a)return;const l=V3(e),{spannedCells:c,hiddenCells:u,hiddenCellOriginMap:d,processedRange:h}=ine(e,l,s,o,a,i,r.current);r.current=h;const p=Object.keys(c).length,g=Object.keys(u).length,f=Object.keys(e.current.state.rowSpanning.spannedCells).length,m=Object.keys(e.current.state.rowSpanning.hiddenCells).length;(i||p!==f||g!==m)&&(0!==p||0!==f)&&e.current.setState(e=>$Q({},e,{rowSpanning:{spannedCells:c,hiddenCells:u,hiddenCellOriginMap:d}}))},[e,r,n.pagination,n.paginationMode]),o=t.useCallback(()=>{const t=u7(e);Zte(t)&&i(t,!0)},[e,i]);R4(e,"renderedRowsIntervalChange",v5(n.rowSpanning,i)),R4(e,"sortedRowsSet",v5(n.rowSpanning,o)),R4(e,"paginationModelChange",v5(n.rowSpanning,o)),R4(e,"filteredRowsSet",v5(n.rowSpanning,o)),R4(e,"columnsChange",v5(n.rowSpanning,o)),t.useEffect(()=>{n.rowSpanning?e.current.state.rowSpanning===tne&&o():e.current.state.rowSpanning!==tne&&e.current.setState(e=>$Q({},e,{rowSpanning:tne}))},[e,o,n.rowSpanning])})(e,n),vte(e,n),(e=>{const n=t.useRef({}),r=()=>{n.current={}},i={resetColSpan:r,calculateColSpan:t.useCallback(t=>{let{rowId:r,minFirstColumn:i,maxLastColumn:o,columns:s}=t;for(let a=i;a<o;a+=1){const t=Ote({apiRef:e,lookup:n.current,columnIndex:a,rowId:r,minFirstColumnIndex:i,maxLastColumnIndex:o,columns:s});t.colSpan>1&&(a+=t.colSpan-1)}},[e])};h7(e,{unstable_getCellColSpanInfo:(e,t)=>n.current[e]?.[t]},"public"),h7(e,i,"private"),R4(e,"columnOrderChange",r)})(e),((e,n)=>{const r=t.useCallback(t=>o8(e)[t]??[],[e]),i=t.useCallback(()=>s8(e),[e]);h7(e,{getColumnGroupPath:r,getAllGroupDetails:i},"public");const o=t.useCallback(()=>{const t=Hte(n.columnGroupingModel??[]);e.current.setState(e=>{const n=e.columns?.orderedFields??[],r=e.pinnedColumns??{},i=Vte(n,t,r);return $Q({},e,{columnGrouping:$Q({},e.columnGrouping,{headerStructure:i})})})},[e,n.columnGroupingModel]),s=t.useCallback(t=>{const n=e.current.getPinnedColumns?.()??{},r=O3(e),i=B3(e),o=Wte(t??[]),s=Hte(t??[]),a=Vte(r,s,n),l=0===i.length?0:Math.max(...i.map(e=>s[e]?.length??0));e.current.setState(e=>$Q({},e,{columnGrouping:{lookup:o,unwrappedGroupingModel:s,headerStructure:a,maxDepth:l}}))},[e]);R4(e,"columnIndexChange",o),R4(e,"columnsChange",()=>{s(n.columnGroupingModel)}),R4(e,"columnVisibilityModelChange",()=>{s(n.columnGroupingModel)}),t.useEffect(()=>{s(n.columnGroupingModel)},[s,n.columnGroupingModel])})(e,n),pte(e,n),((e,n)=>{const r=Z9(e,"useGridFocus"),i=t.useRef(null),o=null!==e.current.rootElementRef.current,s=t.useCallback((t,n)=>{t&&e.current.getRow(t.id)&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(t.id,t.field),n)},[e]),a=t.useCallback((t,n)=>{const i=y7(e);i?.id===t&&i?.field===n||(e.current.setState(e=>(r.debug(`Focusing on cell with id=${t} and field=${n}`),$Q({},e,{tabIndex:{cell:{id:t,field:n},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null},focus:{cell:{id:t,field:n},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))),e.current.getRow(t)&&(i&&s(i,{}),e.current.publishEvent("cellFocusIn",e.current.getCellParams(t,n))))},[e,r,s]),l=t.useCallback(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=y7(e);s(i,n),e.current.setState(e=>(r.debug(`Focusing on column header with colIndex=${t}`),$Q({},e,{tabIndex:{columnHeader:{field:t},columnHeaderFilter:null,cell:null,columnGroupHeader:null},focus:{columnHeader:{field:t},columnHeaderFilter:null,cell:null,columnGroupHeader:null}})))},[e,r,s]),c=t.useCallback(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=y7(e);s(i,n),e.current.setState(e=>(r.debug(`Focusing on column header filter with colIndex=${t}`),$Q({},e,{tabIndex:{columnHeader:null,columnHeaderFilter:{field:t},cell:null,columnGroupHeader:null},focus:{columnHeader:null,columnHeaderFilter:{field:t},cell:null,columnGroupHeader:null}})))},[e,r,s]),u=t.useCallback(function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=y7(e);i&&e.current.publishEvent("cellFocusOut",e.current.getCellParams(i.id,i.field),r),e.current.setState(e=>$Q({},e,{tabIndex:{columnGroupHeader:{field:t,depth:n},columnHeader:null,columnHeaderFilter:null,cell:null},focus:{columnGroupHeader:{field:t,depth:n},columnHeader:null,columnHeaderFilter:null,cell:null}}))},[e]),d=t.useCallback(()=>x7(e),[e]),h=t.useCallback((t,r,i)=>{let o=e.current.getColumnIndex(r);const s=V3(e),a=r7(e,(n.pagination,n.paginationMode)),l=X4(e),c=[].concat(l.top||[],a.rows,l.bottom||[]);let u=c.findIndex(e=>e.id===t);"right"===i?o+=1:"left"===i?o-=1:u+=1,o>=s.length?(u+=1,u<c.length&&(o=0)):o<0&&(u-=1,u>=0&&(o=s.length-1)),u=g5(u,0,c.length-1);const d=c[u];if(!d)return;const h=e.current.unstable_getCellColSpanInfo(d.id,o);h&&h.spannedByColSpan&&("left"===i||"below"===i?o=h.leftVisibleCellIndex:"right"===i&&(o=h.rightVisibleCellIndex)),o=g5(o,0,s.length-1);const p=s[o];e.current.setCellFocus(d.id,p.field)},[e,n.pagination,n.paginationMode]),p=t.useCallback(t=>{let{id:n,field:r}=t;e.current.setCellFocus(n,r)},[e]),g=t.useCallback((t,n)=>{"Enter"===n.key||"Tab"===n.key||"Shift"===n.key||G6(n.key)||e.current.setCellFocus(t.id,t.field)},[e]),f=t.useCallback((t,n)=>{let{field:r}=t;n.target===n.currentTarget&&e.current.setColumnHeaderFocus(r,n)},[e]),m=t.useCallback((t,n)=>{let{fields:r,depth:i}=t;if(n.target!==n.currentTarget)return;const o=x7(e);null!==o&&o.depth===i&&r.includes(o.field)||e.current.setColumnGroupHeaderFocus(r[0],i,n)},[e]),v=t.useCallback((t,n)=>{n.relatedTarget?.getAttribute("class")?.includes(I2.columnHeader)||(r.debug("Clearing focus"),e.current.setState(e=>$Q({},e,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})))},[r,e]),w=t.useCallback(e=>{i.current=e},[]),b=t.useCallback(t=>{const n=i.current;i.current=null;const r=y7(e);if(!e.current.unstable_applyPipeProcessors("canUpdateFocus",!0,{event:t,cell:n}))return;if(!r)return void(n&&e.current.setCellFocus(n.id,n.field));if(n?.id===r.id&&n?.field===r.field)return;const o=e.current.getCellElement(r.id,r.field);o?.contains(t.target)||(n?e.current.setCellFocus(n.id,n.field):(e.current.setState(e=>$Q({},e,{focus:{cell:null,columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}})),s(r,t)))},[e,s]),C=t.useCallback(t=>{if("view"===t.cellMode)return;const n=y7(e);n?.id===t.id&&n?.field===t.field||e.current.setCellFocus(t.id,t.field)},[e]),y=t.useCallback(()=>{const t=y7(e);if(t&&!e.current.getRow(t.id)){const r=t.id;let i=null;if("undefined"!==typeof r){const t=e.current.getRowElement(r),o=t?.dataset.rowindex?Number(t?.dataset.rowindex):0,s=r7(e,(n.pagination,n.paginationMode)),a=s.rows[g5(o,0,s.rows.length-1)];i=a?.id??null}e.current.setState(e=>$Q({},e,{focus:{cell:null===i?null:{id:i,field:t.field},columnHeader:null,columnHeaderFilter:null,columnGroupHeader:null}}))}},[e,n.pagination,n.paginationMode]),S=w4(()=>{const t=y7(e);if(!t)return;const r=r7(e,(n.pagination,n.paginationMode)),i=r.rows.find(e=>e.id===t.id);if(i||0===r.rows.length)return;const o=V3(e);e.current.setState(e=>$Q({},e,{tabIndex:{cell:{id:r.rows[0].id,field:o[0].field},columnGroupHeader:null,columnHeader:null,columnHeaderFilter:null}}))}),x={moveFocusToRelativeCell:h,setColumnGroupHeaderFocus:u,getColumnGroupHeaderFocus:d};h7(e,{setCellFocus:a,setColumnHeaderFocus:l,setColumnHeaderFilterFocus:c},"public"),h7(e,x,"private"),t.useEffect(()=>{const t=Iee(e.current.rootElementRef.current);return t.addEventListener("mouseup",b),()=>{t.removeEventListener("mouseup",b)}},[e,o,b]),R4(e,"columnHeaderBlur",v),R4(e,"cellDoubleClick",p),R4(e,"cellMouseDown",w),R4(e,"cellKeyDown",g),R4(e,"cellModeChange",C),R4(e,"columnHeaderFocus",f),R4(e,"columnGroupHeaderFocus",m),R4(e,"rowsSet",y),R4(e,"paginationModelChange",S)})(e,n),((e,n)=>{const r=Z9(e,"useGridPreferencesPanel"),i=t.useCallback(()=>{e.current.setState(t=>{if(!t.preferencePanel.open)return t;r.debug("Hiding Preferences Panel");const n=Y3(e);return e.current.publishEvent("preferencePanelClose",{openedPanelValue:n.openedPanelValue}),$Q({},t,{preferencePanel:{open:!1}})})},[e,r]),o=t.useCallback((t,n,i)=>{r.debug("Opening Preferences Panel"),e.current.setState(e=>$Q({},e,{preferencePanel:$Q({},e.preferencePanel,{open:!0,openedPanelValue:t,panelId:n,labelId:i})})),e.current.publishEvent("preferencePanelOpen",{openedPanelValue:t})},[r,e]);h7(e,{showPreferences:o,hidePreferences:i},"public");const s=t.useCallback((t,r)=>{const i=Y3(e);return!r.exportOnlyDirtyModels||null!=n.initialState?.preferencePanel||i.open?$Q({},t,{preferencePanel:i}):t},[e,n.initialState?.preferencePanel]),a=t.useCallback((t,n)=>{const r=n.stateToRestore.preferencePanel;return null!=r&&e.current.setState(e=>$Q({},e,{preferencePanel:r})),t},[e]);mee(e,"exportState",s),mee(e,"restoreState",a)})(e,n),((e,n)=>{const r=Z9(e,"useGridFilter");e.current.registerControlState({stateId:"filter",propModel:n.filterModel,propOnChange:n.onFilterModelChange,stateSelector:k8,changeEvent:"filterModelChange"});const i=t.useCallback(()=>{e.current.setState(t=>{const n=k8(e),r=e.current.getFilterState(n),i=$Q({},t,{filter:$Q({},t.filter,r)});return $Q({},i,{visibleRowsLookup:_ee(e,i)})}),e.current.publishEvent("filteredRowsSet")},[e]),o=t.useCallback((e,t)=>null==t||!1===t.filterable||n.disableColumnFilter?e:[...e,"columnMenuFilterItem"],[n.disableColumnFilter]),s=t.useCallback(t=>{const n=k8(e),r=[...n.items],i=r.findIndex(e=>e.id===t.id);-1===i?r.push(t):r[i]=t,e.current.setFilterModel($Q({},n,{items:r}),"upsertFilterItem")},[e]),a=t.useCallback(t=>{const n=k8(e),r=[...n.items];t.forEach(e=>{const t=r.findIndex(t=>t.id===e.id);-1===t?r.push(e):r[t]=e}),e.current.setFilterModel($Q({},n,{items:r}),"upsertFilterItems")},[e]),l=t.useCallback(t=>{const n=k8(e),r=n.items.filter(e=>e.id!==t.id);r.length!==n.items.length&&e.current.setFilterModel($Q({},n,{items:r}),"deleteFilterItem")},[e]),c=t.useCallback((t,i,o)=>{if(r.debug("Displaying filter panel"),t){const r=k8(e),i=r.items.filter(t=>{if(void 0!==t.value)return!Array.isArray(t.value)||0!==t.value.length;const n=e.current.getColumn(t.field),r=n.filterOperators?.find(e=>e.value===t.operator);return!("undefined"===typeof r?.requiresFilterValue||r?.requiresFilterValue)});let o;const s=i.find(e=>e.field===t),a=e.current.getColumn(t);o=s?i:n.disableMultipleColumnsFiltering?[R5({field:t,operator:a.filterOperators[0].value},e)]:[...i,R5({field:t,operator:a.filterOperators[0].value},e)],e.current.setFilterModel($Q({},r,{items:o}))}e.current.showPreferences(X3.filters,i,o)},[e,r,n.disableMultipleColumnsFiltering]),u=t.useCallback(()=>{r.debug("Hiding filter panel"),e.current.hidePreferences()},[e,r]),d=t.useCallback(t=>{const n=k8(e);n.logicOperator!==t&&e.current.setFilterModel($Q({},n,{logicOperator:t}),"changeLogicOperator")},[e]),h=t.useCallback(t=>{const n=k8(e);Aee(n.quickFilterValues,t)||e.current.setFilterModel($Q({},n,{quickFilterValues:[...t]}))},[e]),p=t.useCallback((t,i)=>{k8(e)!==t&&(r.debug("Setting filter model"),e.current.updateControlState("filter",T5(t,n.disableMultipleColumnsFiltering,e),i),e.current.unstable_applyFilters())},[e,r,n.disableMultipleColumnsFiltering]),g=t.useCallback(t=>{const r=E5(t,n.disableMultipleColumnsFiltering,e),i="client"===n.filterMode?D5(r,e,n.disableEval):null;return $Q({},e.current.applyStrategyProcessor("filtering",{isRowMatchingFilters:i,filterModel:r??y5()}),{filterModel:r})},[n.disableMultipleColumnsFiltering,n.filterMode,n.disableEval,e]),f={setFilterLogicOperator:d,unstable_applyFilters:i,deleteFilterItem:l,upsertFilterItem:s,upsertFilterItems:a,setFilterModel:p,showFilterPanel:c,hideFilterPanel:u,setQuickFilterValues:h,ignoreDiacritics:n.ignoreDiacritics,getFilterState:g};h7(e,f,"public");const m=t.useCallback((t,r)=>{const i=k8(e);return i.items.forEach(e=>{delete e.fromInput}),r.exportOnlyDirtyModels&&null==n.filterModel&&null==n.initialState?.filter?.filterModel&&Aee(i,y5())?t:$Q({},t,{filter:{filterModel:i}})},[e,n.filterModel,n.initialState?.filter?.filterModel]),v=t.useCallback((t,r)=>{const i=r.stateToRestore.filter?.filterModel;return null==i?t:(e.current.updateControlState("filter",T5(i,n.disableMultipleColumnsFiltering,e),"restoreState"),$Q({},t,{callbacks:[...t.callbacks,e.current.unstable_applyFilters]}))},[e,n.disableMultipleColumnsFiltering]),w=t.useCallback((e,t)=>{if(t===X3.filters){const e=n.slots.filterPanel;return(0,MH.jsx)(e,$Q({},n.slotProps?.filterPanel))}return e},[n.slots.filterPanel,n.slotProps?.filterPanel]),{getRowId:b}=n,C=H2(Hee),y=t.useCallback(t=>{if("client"!==n.filterMode||!t.isRowMatchingFilters||!t.filterModel.items.length&&!t.filterModel.quickFilterValues?.length)return C5;const r=W4(e),i={},{isRowMatchingFilters:o}=t,s={},a={passingFilterItems:null,passingQuickFilterValues:null},l=C.current(e.current.state.rows.dataRowIdToModelLookup);for(let n=0;n<l.length;n+=1){const r=l[n],c=b?b(r):r.id;o(r,void 0,a);const u=O5([a.passingFilterItems],[a.passingQuickFilterValues],t.filterModel,e,s);u||(i[c]=u)}const c="auto-generated-group-footer-root";return r[c]&&(i[c]=!0),{filteredRowsLookup:i,filteredChildrenCountLookup:{},filteredDescendantCountLookup:{}}},[e,n.filterMode,b,C]);mee(e,"columnMenu",o),mee(e,"exportState",m),mee(e,"restoreState",v),mee(e,"preferencePanel",w),Oee(e,Y9,"filtering",y),Oee(e,Y9,"visibleRowsLookupCreation",Lee);const S=t.useCallback(()=>{r.debug("onColUpdated - GridColumns changed, applying filters");const t=k8(e),n=N3(e),i=t.items.filter(e=>e.field&&n[e.field]);i.length<t.items.length&&e.current.setFilterModel($Q({},t,{items:i}))},[e,r]),x=t.useCallback(t=>{"filtering"===t&&e.current.unstable_applyFilters()},[e]),R=t.useCallback(()=>{e.current.setState(t=>$Q({},t,{visibleRowsLookup:_ee(e,t)}))},[e]);R4(e,"rowsSet",i),R4(e,"columnsChange",S),R4(e,"activeStrategyProcessorChange",x),R4(e,"rowExpansionChange",R),R4(e,"columnVisibilityModelChange",()=>{const t=k8(e);t.quickFilterValues&&A5(t)&&e.current.unstable_applyFilters()}),fee(()=>{e.current.unstable_applyFilters()}),v4(()=>{void 0!==n.filterModel&&e.current.setFilterModel(n.filterModel)},[e,r,n.filterModel])})(e,n),((e,n)=>{const r=Z9(e,"useGridSorting");e.current.registerControlState({stateId:"sortModel",propModel:n.sortModel,propOnChange:n.onSortModelChange,stateSelector:R8,changeEvent:"sortModelChange"});const i=t.useCallback((t,n)=>{const r=R8(e),i=r.findIndex(e=>e.field===t);let o=[...r];return i>-1?null==n?.sort?o.splice(i,1):o.splice(i,1,n):o=[...r,n],o},[e]),o=t.useCallback((t,r)=>{const i=R8(e).find(e=>e.field===t.field);if(i){const e=void 0===r?t5(t.sortingOrder??n.sortingOrder,i.sort):r;return void 0===e?void 0:$Q({},i,{sort:e})}return{field:t.field,sort:void 0===r?t5(t.sortingOrder??n.sortingOrder):r}},[e,n.sortingOrder]),s=t.useCallback((e,t)=>null==t||!1===t.sortable||n.disableColumnSorting?e:(t.sortingOrder||n.sortingOrder).some(e=>!!e)?[...e,"columnMenuSortItem"]:e,[n.sortingOrder,n.disableColumnSorting]),a=t.useCallback(()=>{e.current.setState(t=>{if("server"===n.sortingMode)return r.debug("Skipping sorting rows as sortingMode = server"),$Q({},t,{sorting:$Q({},t.sorting,{sortedRows:r6(z4(e),X5,!1)})});const i=R8(e),o=e5(i,e),s=e.current.applyStrategyProcessor("sorting",{sortRowList:o});return $Q({},t,{sorting:$Q({},t.sorting,{sortedRows:s})})}),e.current.publishEvent("sortedRowsSet")},[e,r,n.sortingMode]),l=t.useCallback(t=>{R8(e)!==t&&(r.debug("Setting sort model"),e.current.setState(Z4(t,n.disableMultipleColumnsSorting)),e.current.applySorting())},[e,r,n.disableMultipleColumnsSorting]),c=t.useCallback((t,r,s)=>{const a=e.current.getColumn(t),l=o(a,r);let c;c=!s||n.disableMultipleColumnsSorting?null==l?.sort?[]:[l]:i(a.field,l),e.current.setSortModel(c)},[e,i,o,n.disableMultipleColumnsSorting]),u=t.useCallback(()=>R8(e),[e]),d=t.useCallback(()=>x8(e).map(e=>e.model),[e]),h=t.useCallback(()=>S8(e),[e]),p=t.useCallback(t=>e.current.getSortedRowIds()[t],[e]);h7(e,{getSortModel:u,getSortedRows:d,getSortedRowIds:h,getRowIdFromRowIndex:p,setSortModel:l,sortColumn:c,applySorting:a},"public");const g=t.useCallback((t,r)=>{const i=R8(e);return!r.exportOnlyDirtyModels||null!=n.sortModel||null!=n.initialState?.sorting?.sortModel||i.length>0?$Q({},t,{sorting:{sortModel:i}}):t},[e,n.sortModel,n.initialState?.sorting?.sortModel]),f=t.useCallback((t,r)=>{const i=r.stateToRestore.sorting?.sortModel;return null==i?t:(e.current.setState(Z4(i,n.disableMultipleColumnsSorting)),$Q({},t,{callbacks:[...t.callbacks,e.current.applySorting]}))},[e,n.disableMultipleColumnsSorting]),m=t.useCallback(t=>{const n=z4(e),r=n[X5],i=t.sortRowList?t.sortRowList(r.children.map(e=>n[e])):[...r.children];return null!=r.footerId&&i.push(r.footerId),i},[e]);mee(e,"exportState",g),mee(e,"restoreState",f),Oee(e,Y9,"sorting",m);const v=t.useCallback((e,t)=>{let{field:r,colDef:i}=e;if(!i.sortable||n.disableColumnSorting)return;const o="always"===n.multipleColumnsSortingMode||t.shiftKey||t.metaKey||t.ctrlKey;c(r,void 0,o)},[c,n.disableColumnSorting,n.multipleColumnsSortingMode]),w=t.useCallback((e,t)=>{let{field:r,colDef:i}=e;i.sortable&&!n.disableColumnSorting&&("Enter"!==t.key||t.ctrlKey||t.metaKey||c(r,void 0,"always"===n.multipleColumnsSortingMode||t.shiftKey))},[c,n.disableColumnSorting,n.multipleColumnsSortingMode]),b=t.useCallback(()=>{const t=R8(e),n=N3(e);if(t.length>0){const r=t.filter(e=>n[e.field]);r.length<t.length&&e.current.setSortModel(r)}},[e]),C=t.useCallback(t=>{"sorting"===t&&e.current.applySorting()},[e]);mee(e,"columnMenu",s),R4(e,"columnHeaderClick",v),R4(e,"columnHeaderKeyDown",w),R4(e,"rowsSet",e.current.applySorting),R4(e,"columnsChange",b),R4(e,"activeStrategyProcessorChange",C),fee(()=>{e.current.applySorting()}),v4(()=>{void 0!==n.sortModel&&e.current.setSortModel(n.sortModel)},[e,n.sortModel])})(e,n),((e,n)=>{const r=Z9(e,"useDensity");e.current.registerControlState({stateId:"density",propModel:n.density,propOnChange:n.onDensityChange,stateSelector:E3,changeEvent:"densityChange"});const i=w4(t=>{E3(e)!==t&&(r.debug(`Set grid density to ${t}`),e.current.setState(e=>$Q({},e,{density:t})))});h7(e,{setDensity:i},"public");const o=t.useCallback((t,r)=>{const i=E3(e);return r.exportOnlyDirtyModels&&null==n.density&&null==n.initialState?.density?t:$Q({},t,{density:i})},[e,n.density,n.initialState?.density]),s=t.useCallback((t,n)=>{const r=n.stateToRestore?.density?n.stateToRestore.density:E3(e);return e.current.setState(e=>$Q({},e,{density:r})),t},[e]);mee(e,"exportState",o),mee(e,"restoreState",s),t.useEffect(()=>{n.density&&e.current.setDensity(n.density)},[e,n.density])})(e,n),Qte(e,n),ete(e,n),((e,n)=>{const{getRowHeight:r,getRowSpacing:i,getEstimatedRowHeight:o}=n,s=e.current.caches.rowsMeta.heights,a=t.useRef(-1),l=t.useRef(!1),c=t.useRef(!1),u=$2(e,T3),d=i7(e),h=$2(e,X4),p=$2(e,a4),g=t.useCallback(t=>{const n=o4(e).rowHeight,s=e.current.getRowHeightEntry(t.id);if(r){const e=r($Q({},t,{densityFactor:u}));if("auto"===e){if(s.needsFirstMeasurement){const e=o?o($Q({},t,{densityFactor:u})):n;s.content=e??n}l.current=!0,s.autoHeight=!0}else s.content=a6(e,n),s.needsFirstMeasurement=!1,s.autoHeight=!1}else s.content=n,s.needsFirstMeasurement=!1;if(i){const n=e.current.getRowIndexRelativeToVisibleRows(t.id),r=i($Q({},t,{isFirstVisible:0===n,isLastVisible:n===d.rows.length-1,indexRelativeToCurrentPage:n}));s.spacingTop=r.top??0,s.spacingBottom=r.bottom??0}else s.spacingTop=0,s.spacingBottom=0;return e.current.unstable_applyPipeProcessors("rowHeight",s,t),s},[e,d.rows,r,o,p,i,u]),f=t.useCallback(()=>{l.current=!1;const t=h.top.reduce((e,t)=>{const n=g(t);return e+n.content+n.spacingTop+n.spacingBottom+n.detail},0),n=h.bottom.reduce((e,t)=>{const n=g(t);return e+n.content+n.spacingTop+n.spacingBottom+n.detail},0),r=[],i=d.rows.reduce((e,t)=>{r.push(e);const n=g(t);return e+(n.content+n.spacingTop+n.spacingBottom+n.detail)},0);l.current||(a.current=1/0);const o=t!==e.current.state.rowsMeta.pinnedTopRowsTotalHeight||n!==e.current.state.rowsMeta.pinnedBottomRowsTotalHeight||i!==e.current.state.rowsMeta.currentPageTotalHeight,s={currentPageTotalHeight:i,positions:r,pinnedTopRowsTotalHeight:t,pinnedBottomRowsTotalHeight:n};e.current.setState(e=>$Q({},e,{rowsMeta:s})),o&&e.current.updateDimensions(),c.current=!0},[e,h,d.rows,g]),m=H2(()=>new Dte(t=>{for(let n=0;n<t.length;n+=1){const r=t[n],i=r.borderBoxSize&&r.borderBoxSize.length>0?r.borderBoxSize[0].blockSize:r.contentRect.height,o=r.target.__mui_id,s=P7(e)?.id;if(s===o&&0===i)return;e.current.unstable_storeRowHeightMeasurement(o,i)}c.current||requestAnimationFrame(()=>{e.current.requestPipeProcessorsApplication("rowHeight")})})).current;vee(e,"rowHeight",f),v4(()=>{f()},[f]);const v={unstable_getRowHeight:e=>s.get(e)?.content??p,unstable_setLastMeasuredRowIndex:e=>{l.current&&e>a.current&&(a.current=e)},unstable_storeRowHeightMeasurement:(t,n)=>{const r=e.current.getRowHeightEntry(t),i=r.content!==n;r.needsFirstMeasurement=!1,r.content=n,c.current&&=!i},resetRowHeights:()=>{s.clear(),f()}},w={hydrateRowsMeta:f,observeRowHeight:(e,t)=>(e.__mui_id=t,m.observe(e),()=>m.unobserve(e)),rowHasAutoHeight:e=>s.get(e)?.autoHeight??!1,getRowHeightEntry:e=>{let t=s.get(e);return void 0===t&&(t={content:p,spacingTop:0,spacingBottom:0,detail:0,autoHeight:!1,needsFirstMeasurement:!0},s.set(e,t)),t},getLastMeasuredRowIndex:()=>a.current};h7(e,v,"public"),h7(e,w,"private")})(e,n),((e,n)=>{const r=z6(),i=Z9(e,"useGridScroll"),o=e.current.columnHeadersContainerRef,s=e.current.virtualScrollerRef,a=$2(e,A8),l=t.useCallback(t=>{const r=o4(e),o=H4(e),l=n.listView?[b7(e)]:V3(e);if(null!=t.rowIndex&&0===o||0===l.length)return!1;i.debug(`Scrolling to cell at row ${t.rowIndex}, col: ${t.colIndex} `);let c={};if(void 0!==t.colIndex){const n=G3(e);let i;if("undefined"!==typeof t.rowIndex){const n=a[t.rowIndex]?.id,r=e.current.unstable_getCellColSpanInfo(n,t.colIndex);r&&!r.spannedByColSpan&&(i=r.cellProps.width)}"undefined"===typeof i&&(i=l[t.colIndex].computedWidth),c.left=Ste({containerSize:r.viewportOuterSize.width,scrollPosition:Math.abs(s.current.scrollLeft),elementSize:i,elementOffset:n[t.colIndex]})}if(void 0!==t.rowIndex){const i=s7(e),o=X8(e),a=Q8(e),l=n.pagination?t.rowIndex-o*a:t.rowIndex,u=i.positions[l+1]?i.positions[l+1]-i.positions[l]:i.currentPageTotalHeight-i.positions[l];c.top=Ste({containerSize:r.viewportInnerSize.height,scrollPosition:s.current.scrollTop,elementSize:u,elementOffset:i.positions[l]})}return c=e.current.unstable_applyPipeProcessors("scrollToIndexes",c,t),(void 0!==typeof c.left||void 0!==typeof c.top)&&(e.current.scroll(c),!0)},[i,e,s,n.pagination,a,n.listView]),c=t.useCallback(e=>{if(s.current&&void 0!==e.left&&o.current){const t=r?-1:1;o.current.scrollLeft=e.left,s.current.scrollLeft=t*e.left,i.debug(`Scrolling left: ${e.left}`)}s.current&&void 0!==e.top&&(s.current.scrollTop=e.top,i.debug(`Scrolling top: ${e.top}`)),i.debug("Scrolling, updating container, and viewport")},[s,r,o,i]),u=t.useCallback(()=>s?.current?{top:s.current.scrollTop,left:s.current.scrollLeft}:{top:0,left:0},[s]);h7(e,{scroll:c,scrollToIndexes:l,getScrollPosition:u},"public")})(e,n),(e=>{const n=Z9(e,"useGridColumnMenu"),r=t.useCallback(t=>{const r=o9(e),i=t;(!0!==r.open||i!==r.field)&&(e.current.setState(e=>e.columnMenu.open&&e.columnMenu.field===t?e:(n.debug("Opening Column Menu"),$Q({},e,{columnMenu:{open:!0,field:t}}))),e.current.hidePreferences())},[e,n]),i=t.useCallback(()=>{const t=o9(e);if(t.field){const n=N3(e),r=_3(e),i=O3(e);let o=t.field;if(n[o]||(o=i[0]),!1===r[o]){const e=i.filter(e=>e===o||!1!==r[e]),t=e.indexOf(o);o=e[t+1]||e[t-1]}e.current.setColumnHeaderFocus(o)}const r={open:!1,field:void 0};(r.open!==t.open||r.field!==t.field)&&e.current.setState(e=>(n.debug("Hiding Column Menu"),$Q({},e,{columnMenu:r})))},[e,n]),o=t.useCallback(t=>{n.debug("Toggle Column Menu");const o=o9(e);o.open&&o.field===t?i():r(t)},[e,n,r,i]);h7(e,{showColumnMenu:r,hideColumnMenu:i,toggleColumnMenu:o},"public"),R4(e,"columnResizeStart",i),R4(e,"virtualScrollerWheel",e.current.hideColumnMenu),R4(e,"virtualScrollerTouchMove",e.current.hideColumnMenu)})(e),Pee(e,n),Fee(e,n),pee(e,n),Mte(e,n),function(e,t){T4(e,"columnHeaderClick",t.onColumnHeaderClick),T4(e,"columnHeaderContextMenu",t.onColumnHeaderContextMenu),T4(e,"columnHeaderDoubleClick",t.onColumnHeaderDoubleClick),T4(e,"columnHeaderOver",t.onColumnHeaderOver),T4(e,"columnHeaderOut",t.onColumnHeaderOut),T4(e,"columnHeaderEnter",t.onColumnHeaderEnter),T4(e,"columnHeaderLeave",t.onColumnHeaderLeave),T4(e,"cellClick",t.onCellClick),T4(e,"cellDoubleClick",t.onCellDoubleClick),T4(e,"cellKeyDown",t.onCellKeyDown),T4(e,"preferencePanelClose",t.onPreferencePanelClose),T4(e,"preferencePanelOpen",t.onPreferencePanelOpen),T4(e,"menuOpen",t.onMenuOpen),T4(e,"menuClose",t.onMenuClose),T4(e,"rowDoubleClick",t.onRowDoubleClick),T4(e,"rowClick",t.onRowClick),T4(e,"stateChange",t.onStateChange)}(e,n),(e=>{const n=t.useCallback(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.current.unstable_applyPipeProcessors("exportState",{},t)},[e]),r=t.useCallback(t=>{e.current.unstable_applyPipeProcessors("restoreState",{callbacks:[]},{stateToRestore:t}).callbacks.forEach(e=>{e()})},[e]);h7(e,{exportState:n,restoreState:r},"public")})(e),function(e,n){const r=t=>{e.current.setState(e=>$Q({},e,{virtualization:$Q({},e.virtualization,{enabled:t,enabledForColumns:t,enabledForRows:t&&!n.autoHeight})}))},i={unstable_setVirtualization:r,unstable_setColumnVirtualization:t=>{e.current.setState(e=>$Q({},e,{virtualization:$Q({},e.virtualization,{enabledForColumns:t})}))}};h7(e,i,"public"),t.useEffect(()=>{r(!n.disableVirtualization)},[n.disableVirtualization,n.autoHeight])}(e,n),function(e,n){const r=()=>{e.current.setState(t=>t.listViewColumn?$Q({},t,{listViewColumn:$Q({},t.listViewColumn,{computedWidth:lne(e)})}):t)},i=t.useRef(null);R4(e,"viewportInnerSizeChange",e=>{i.current!==e.width&&(i.current=e.width,r())}),R4(e,"columnVisibilityModelChange",r),v4(()=>{const t=n.listViewColumn;t&&e.current.setState(n=>$Q({},n,{listViewColumn:$Q({},t,{computedWidth:lne(e)})}))},[e,n.listViewColumn]),t.useEffect(()=>{n.listView&&n.listViewColumn},[n.listView,n.listViewColumn])}(e,n),bne(e,n)};const yne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const n=t.useContext(MZ);return n&&(r=n,0!==Object.keys(r).length)?n:e;var r},Sne=Z0();const xne=function(){return yne(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sne)};function Rne(){const e=xne(b2);return e[C2]||e}const Ene={noRowsLabel:"No rows",noResultsOverlayLabel:"No results found.",noColumnsOverlayLabel:"No columns",noColumnsOverlayManageColumns:"Manage columns",emptyPivotOverlayLabel:"Add fields to rows, columns, and values to create a pivot table",toolbarDensity:"Density",toolbarDensityLabel:"Density",toolbarDensityCompact:"Compact",toolbarDensityStandard:"Standard",toolbarDensityComfortable:"Comfortable",toolbarColumns:"Columns",toolbarColumnsLabel:"Select columns",toolbarFilters:"Filters",toolbarFiltersLabel:"Show filters",toolbarFiltersTooltipHide:"Hide filters",toolbarFiltersTooltipShow:"Show filters",toolbarFiltersTooltipActive:e=>1!==e?`${e} active filters`:`${e} active filter`,toolbarQuickFilterPlaceholder:"Search\u2026",toolbarQuickFilterLabel:"Search",toolbarQuickFilterDeleteIconLabel:"Clear",toolbarExport:"Export",toolbarExportLabel:"Export",toolbarExportCSV:"Download as CSV",toolbarExportPrint:"Print",toolbarExportExcel:"Download as Excel",toolbarPivot:"Pivot",toolbarAssistant:"AI Assistant",columnsManagementSearchTitle:"Search",columnsManagementNoColumns:"No columns",columnsManagementShowHideAllText:"Show/Hide All",columnsManagementReset:"Reset",columnsManagementDeleteIconLabel:"Clear",filterPanelAddFilter:"Add filter",filterPanelRemoveAll:"Remove all",filterPanelDeleteIconLabel:"Delete",filterPanelLogicOperator:"Logic operator",filterPanelOperator:"Operator",filterPanelOperatorAnd:"And",filterPanelOperatorOr:"Or",filterPanelColumns:"Columns",filterPanelInputLabel:"Value",filterPanelInputPlaceholder:"Filter value",filterOperatorContains:"contains",filterOperatorDoesNotContain:"does not contain",filterOperatorEquals:"equals",filterOperatorDoesNotEqual:"does not equal",filterOperatorStartsWith:"starts with",filterOperatorEndsWith:"ends with",filterOperatorIs:"is",filterOperatorNot:"is not",filterOperatorAfter:"is after",filterOperatorOnOrAfter:"is on or after",filterOperatorBefore:"is before",filterOperatorOnOrBefore:"is on or before",filterOperatorIsEmpty:"is empty",filterOperatorIsNotEmpty:"is not empty",filterOperatorIsAnyOf:"is any of","filterOperator=":"=","filterOperator!=":"!=","filterOperator>":">","filterOperator>=":">=","filterOperator<":"<","filterOperator<=":"<=",headerFilterOperatorContains:"Contains",headerFilterOperatorDoesNotContain:"Does not contain",headerFilterOperatorEquals:"Equals",headerFilterOperatorDoesNotEqual:"Does not equal",headerFilterOperatorStartsWith:"Starts with",headerFilterOperatorEndsWith:"Ends with",headerFilterOperatorIs:"Is",headerFilterOperatorNot:"Is not",headerFilterOperatorAfter:"Is after",headerFilterOperatorOnOrAfter:"Is on or after",headerFilterOperatorBefore:"Is before",headerFilterOperatorOnOrBefore:"Is on or before",headerFilterOperatorIsEmpty:"Is empty",headerFilterOperatorIsNotEmpty:"Is not empty",headerFilterOperatorIsAnyOf:"Is any of","headerFilterOperator=":"Equals","headerFilterOperator!=":"Not equals","headerFilterOperator>":"Greater than","headerFilterOperator>=":"Greater than or equal to","headerFilterOperator<":"Less than","headerFilterOperator<=":"Less than or equal to",headerFilterClear:"Clear filter",filterValueAny:"any",filterValueTrue:"true",filterValueFalse:"false",columnMenuLabel:"Menu",columnMenuAriaLabel:e=>`${e} column menu`,columnMenuShowColumns:"Show columns",columnMenuManageColumns:"Manage columns",columnMenuFilter:"Filter",columnMenuHideColumn:"Hide column",columnMenuUnsort:"Unsort",columnMenuSortAsc:"Sort by ASC",columnMenuSortDesc:"Sort by DESC",columnMenuManagePivot:"Manage pivot",columnHeaderFiltersTooltipActive:e=>1!==e?`${e} active filters`:`${e} active filter`,columnHeaderFiltersLabel:"Show filters",columnHeaderSortIconLabel:"Sort",footerRowSelected:e=>1!==e?`${e.toLocaleString()} rows selected`:`${e.toLocaleString()} row selected`,footerTotalRows:"Total Rows:",footerTotalVisibleRows:(e,t)=>`${e.toLocaleString()} of ${t.toLocaleString()}`,checkboxSelectionHeaderName:"Checkbox selection",checkboxSelectionSelectAllRows:"Select all rows",checkboxSelectionUnselectAllRows:"Unselect all rows",checkboxSelectionSelectRow:"Select row",checkboxSelectionUnselectRow:"Unselect row",booleanCellTrueLabel:"yes",booleanCellFalseLabel:"no",actionsCellMore:"more",pinToLeft:"Pin to left",pinToRight:"Pin to right",unpin:"Unpin",treeDataGroupingHeaderName:"Group",treeDataExpand:"see children",treeDataCollapse:"hide children",groupingColumnHeaderName:"Group",groupColumn:e=>`Group by ${e}`,unGroupColumn:e=>`Stop grouping by ${e}`,detailPanelToggle:"Detail panel toggle",expandDetailPanel:"Expand",collapseDetailPanel:"Collapse",paginationRowsPerPage:"Rows per page:",paginationDisplayedRows:e=>{let{from:t,to:n,count:r,estimated:i}=e;if(!i)return`${t}\u2013${n} of ${-1!==r?r:`more than ${n}`}`;return`${t}\u2013${n} of ${-1!==r?r:i&&i>n?`around ${i}`:`more than ${n}`}`},paginationItemAriaLabel:e=>"first"===e?"Go to first page":"last"===e?"Go to last page":"next"===e?"Go to next page":"Go to previous page",rowReorderingHeaderName:"Row reordering",aggregationMenuItemHeader:"Aggregation",aggregationFunctionLabelSum:"sum",aggregationFunctionLabelAvg:"avg",aggregationFunctionLabelMin:"min",aggregationFunctionLabelMax:"max",aggregationFunctionLabelSize:"size",pivotToggleLabel:"Pivot",pivotRows:"Rows",pivotColumns:"Columns",pivotValues:"Values",pivotCloseButton:"Close pivot settings",pivotSearchButton:"Search fields",pivotSearchControlPlaceholder:"Search fields",pivotSearchControlLabel:"Search fields",pivotSearchControlClear:"Clear search",pivotNoFields:"No fields",pivotMenuMoveUp:"Move up",pivotMenuMoveDown:"Move down",pivotMenuMoveToTop:"Move to top",pivotMenuMoveToBottom:"Move to bottom",pivotMenuRows:"Rows",pivotMenuColumns:"Columns",pivotMenuValues:"Values",pivotMenuOptions:"Field options",pivotMenuAddToRows:"Add to Rows",pivotMenuAddToColumns:"Add to Columns",pivotMenuAddToValues:"Add to Values",pivotMenuRemove:"Remove",pivotDragToRows:"Drag here to create rows",pivotDragToColumns:"Drag here to create columns",pivotDragToValues:"Drag here to create values",pivotYearColumnHeaderName:"(Year)",pivotQuarterColumnHeaderName:"(Quarter)",aiAssistantPanelTitle:"AI Assistant",aiAssistantPanelClose:"Close AI Assistant",aiAssistantPanelNewConversation:"New conversation",aiAssistantPanelConversationHistory:"Conversation history",aiAssistantPanelEmptyConversation:"No prompt history",aiAssistantSuggestions:"Suggestions",promptFieldLabel:"Prompt",promptFieldPlaceholder:"Type a prompt\u2026",promptFieldPlaceholderWithRecording:"Type or record a prompt\u2026",promptFieldPlaceholderListening:"Listening for prompt\u2026",promptFieldSpeechRecognitionNotSupported:"Speech recognition is not supported in this browser",promptFieldSend:"Send",promptFieldRecord:"Record",promptFieldStopRecording:"Stop recording",promptRerun:"Run again",promptProcessing:"Processing\u2026",promptAppliedChanges:"Applied changes",promptChangeGroupDescription:e=>`Group by ${e}`,promptChangeAggregationLabel:(e,t)=>`${e} (${t})`,promptChangeAggregationDescription:(e,t)=>`Aggregate ${e} (${t})`,promptChangeFilterLabel:(e,t,n)=>"is any of"===t?`${e} is any of: ${n}`:`${e} ${t} ${n}`,promptChangeFilterDescription:(e,t,n)=>"is any of"===t?`Filter where ${e} is any of: ${n}`:`Filter where ${e} ${t} ${n}`,promptChangeSortDescription:(e,t)=>`Sort by ${e} (${t})`,promptChangePivotEnableLabel:"Pivot",promptChangePivotEnableDescription:"Enable pivot",promptChangePivotColumnsLabel:e=>`Columns (${e})`,promptChangePivotColumnsDescription:(e,t)=>`${e}${t?` (${t})`:""}`,promptChangePivotRowsLabel:e=>`Rows (${e})`,promptChangePivotValuesLabel:e=>`Values (${e})`,promptChangePivotValuesDescription:(e,t)=>`${e} (${t})`},Tne=["field","type","align","width","height","empty","style","className"],kne="1.3em",Mne=[40,80],Pne={number:[40,60],string:[40,80],date:[40,60],dateTime:[60,80],singleSelect:[40,80]},Ine=function(e){const t=(n=e,()=>{let e=n+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296});var n;return(e,n)=>e+(n-e)*t()}(12345);const Ane=iJ(function(e){const{field:n,type:r,align:i,width:o,height:s,empty:a=!1,style:l,className:c}=e,u=qQ(e,Tne),d=e3(),h=(e=>{const{align:t,classes:n,empty:r}=e;return tJ({root:["cell","cellSkeleton",`cell--text${t?eJ(t):"Left"}`,r&&"cellEmpty"]},P2,n)})({classes:d.classes,align:i,empty:a}),p=t.useMemo(()=>{if("boolean"===r||"actions"===r)return{variant:"circular",width:kne,height:kne};const[e,t]=r?Pne[r]??Mne:Mne;return{variant:"text",width:`${Math.round(Ine(e,t))}%`,height:"1.2em"}},[r]);return(0,MH.jsx)("div",$Q({"data-field":n,className:QQ(h.root,c),style:$Q({height:s,maxWidth:o,minWidth:o},l)},u,{children:!a&&(0,MH.jsx)(d.slots.baseSkeleton,$Q({},p))}))}),Dne=["className"],Fne=i4("div",{name:"MuiDataGrid",slot:"IconButtonContainer"})(()=>({display:"flex",visibility:"hidden",width:0})),One=YQ(function(e,t){const{className:n}=e,r=qQ(e,Dne),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["iconButtonContainer"]},P2,t)})(i);return(0,MH.jsx)(Fne,$Q({className:QQ(o.root,n),ownerState:i},r,{ref:t}))});function Nne(e){const{counter:n,field:r,onClick:i}=e,o=J3(),s=e3(),a=(e=>{const{classes:t}=e;return tJ({icon:["filterIcon"]},P2,t)})($Q({},e,{classes:s.classes})),l=l5(),c=$2(o,q3,l),u=l5(),d=t.useCallback(e=>{e.preventDefault(),e.stopPropagation();const{open:t,openedPanelValue:n}=Y3(o);t&&n===X3.filters?o.current.hideFilterPanel():o.current.showFilterPanel(void 0,u,l),i&&i(o.current.getColumnHeaderParams(r),e)},[o,r,i,u,l]);if(!n)return null;const h=(0,MH.jsx)(s.slots.baseIconButton,$Q({id:l,onClick:d,"aria-label":o.current.getLocaleText("columnHeaderFiltersLabel"),size:"small",tabIndex:-1,"aria-haspopup":"menu","aria-expanded":c,"aria-controls":c?u:void 0},s.slotProps?.baseIconButton,{children:(0,MH.jsx)(s.slots.columnFilteredIcon,{className:a.icon,fontSize:"small"})}));return(0,MH.jsx)(s.slots.baseTooltip,$Q({title:o.current.getLocaleText("columnHeaderFiltersTooltipActive")(n),enterDelay:1e3},s.slotProps?.baseTooltip,{children:(0,MH.jsxs)(One,{children:[n>1&&(0,MH.jsx)(s.slots.baseBadge,{badgeContent:n,color:"default",children:h}),1===n&&h]})}))}const Lne=["sortingOrder"],_ne=t.memo(function(e){const{sortingOrder:t}=e,n=qQ(e,Lne),r=e3(),[i]=t,o="asc"===i?r.slots.columnSortedAscendingIcon:r.slots.columnSortedDescendingIcon;return o?(0,MH.jsx)(o,$Q({},n)):null});const Hne=["direction","index","sortingOrder","disabled","className"],Vne=i4(F4,{name:"MuiDataGrid",slot:"SortButton"})({transition:O2.transition(["opacity"],{duration:O2.transitions.duration.short,easing:O2.transitions.easing.easeInOut})});function Bne(e){const{direction:n,index:r,sortingOrder:i,disabled:o,className:s}=e,a=qQ(e,Hne),l=J3(),c=e3(),u=$Q({},e,{classes:c.classes}),d=(e=>{const{classes:t}=e;return tJ({root:["sortButton"],icon:["sortIcon"]},P2,t)})(u),h=function(e,t,n,r){let i;const o={};return"asc"===t?i=e.columnSortedAscendingIcon:"desc"===t?i=e.columnSortedDescendingIcon:(i=_ne,o.sortingOrder=r),i?(0,MH.jsx)(i,$Q({fontSize:"small",className:n},o)):null}(c.slots,n,d.icon,i);if(!h)return null;const p=(0,MH.jsx)(Vne,$Q({as:c.slots.baseIconButton,ownerState:u,"aria-label":l.current.getLocaleText("columnHeaderSortIconLabel"),title:l.current.getLocaleText("columnHeaderSortIconLabel"),size:"small",disabled:o,className:QQ(d.root,s)},c.slotProps?.baseIconButton,a,{children:h}));return(0,MH.jsxs)(t.Fragment,{children:[null!=r&&(0,MH.jsx)(c.slots.baseBadge,{badgeContent:r,color:"default",overlap:"circular",children:p}),null==r&&p]})}function Wne(e){return(0,MH.jsx)(One,{children:(0,MH.jsx)(Bne,$Q({},e,{tabIndex:-1}))})}const zne=t.memo(Wne);const jne=["className","selectedRowCount"],Gne=i4("div",{name:"MuiDataGrid",slot:"SelectedRowCount"})({alignItems:"center",display:"flex",margin:O2.spacing(0,2),visibility:"hidden",width:0,height:0,[O2.breakpoints.up("sm")]:{visibility:"visible",width:"auto",height:"auto"}}),$ne=YQ(function(e,t){const{className:n,selectedRowCount:r}=e,i=qQ(e,jne),o=J3(),s=e3(),a=(e=>{const{classes:t}=e;return tJ({root:["selectedRowCount"]},P2,t)})(s),l=o.current.getLocaleText("footerRowSelected")(r);return(0,MH.jsx)(Gne,$Q({className:QQ(a.root,n),ownerState:s},i,{ref:t,children:l}))});const Une=["className"],Kne=i4("div",{name:"MuiDataGrid",slot:"FooterContainer"})({display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:52,borderTop:"1px solid"}),Yne=YQ(function(e,t){const{className:n}=e,r=qQ(e,Une),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["footerContainer","withBorderColor"]},P2,t)})(i);return(0,MH.jsx)(Kne,$Q({className:QQ(o.root,n),ownerState:i},r,{ref:t}))});const qne=YQ(function(e,t){const n=J3(),r=e3(),i=$2(n,B4),o=$2(n,_7),s=$2(n,_8),a=!r.hideFooterSelectedRowCount&&o>0?(0,MH.jsx)($ne,{selectedRowCount:o}):(0,MH.jsx)("div",{}),l=r.hideFooterRowCount||r.pagination?null:(0,MH.jsx)(r.slots.footerRowCount,$Q({},r.slotProps?.footerRowCount,{rowCount:i,visibleRowCount:s})),c=r.pagination&&!r.hideFooterPagination&&r.slots.pagination&&(0,MH.jsx)(r.slots.pagination,{});return(0,MH.jsxs)(Yne,$Q({},e,{ref:t,children:[a,l,c]}))});const Xne=["className","rowCount","visibleRowCount"],Qne=i4("div",{name:"MuiDataGrid",slot:"RowCount"})({alignItems:"center",display:"flex",margin:O2.spacing(0,2)}),Jne=YQ(function(e,t){const{className:n,rowCount:r,visibleRowCount:i}=e,o=qQ(e,Xne),s=J3(),a=e3(),l=(e=>{const{classes:t}=e;return tJ({root:["rowCount"]},P2,t)})(a);if(0===r)return null;const c=i<r?s.current.getLocaleText("footerTotalVisibleRows")(i,r):r.toLocaleString();return(0,MH.jsxs)(Qne,$Q({className:QQ(l.root,n),ownerState:a},o,{ref:t,children:[s.current.getLocaleText("footerTotalRows")," ",c]}))});const Zne=["className"],ere=i4("div",{name:"MuiDataGrid",slot:"Overlay"})({width:"100%",height:"100%",display:"flex",gap:O2.spacing(1),flexDirection:"column",alignSelf:"center",alignItems:"center",justifyContent:"center",textAlign:"center",textWrap:"balance",backgroundColor:O2.colors.background.backdrop}),tre=YQ(function(e,t){const{className:n}=e,r=qQ(e,Zne),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["overlay"]},P2,t)})(i);return(0,MH.jsx)(ere,$Q({className:QQ(o.root,n),ownerState:i},r,{ref:t}))});const nre=(e,t,n,r,i,o)=>{let s;switch(e){case g6.LEFT:s=r[n];break;case g6.RIGHT:s=i-r[n]-t+o;break;default:s=void 0}return s},rre=(e,t,n,r,i)=>{const o=t===n-1;return!(e!==g6.LEFT||!o)||!!r&&(e===g6.LEFT||(e===g6.RIGHT?!o:!o||i))},ire=(e,t)=>e===g6.RIGHT&&0===t,ore={root:I2.scrollbarFiller,header:I2["scrollbarFiller--header"],borderTop:I2["scrollbarFiller--borderTop"],borderBottom:I2["scrollbarFiller--borderBottom"],pinnedRight:I2["scrollbarFiller--pinnedRight"]};function sre(e){let{header:t,borderTop:n=!0,borderBottom:r,pinnedRight:i}=e;return(0,MH.jsx)("div",{role:"presentation",className:QQ(ore.root,t&&ore.header,n&&ore.borderTop,r&&ore.borderBottom,i&&ore.pinnedRight)})}const are=(e,t)=>{if(e)if(t){if(e===g6.LEFT)return"right";if(e===g6.RIGHT)return"left"}else{if(e===g6.LEFT)return"left";if(e===g6.RIGHT)return"right"}};function lre(e,t,n,r){const i=are(n,t);return i&&void 0!==r?(e[i]=r,e):e}const cre=["skeletonRowsCount","visibleColumns","showFirstRowBorder"],ure=i4("div",{name:"MuiDataGrid",slot:"SkeletonLoadingOverlay"})({minWidth:"100%",width:"max-content",height:"100%",overflow:"clip"}),dre=e=>parseInt(e.getAttribute("data-colindex"),10),hre=YQ(function(e,n){const r=e3(),{slots:i}=r,o=z6(),s=(e=>{const{classes:t}=e;return tJ({root:["skeletonLoadingOverlay"]},P2,t)})({classes:r.classes}),a=t.useRef(null),l=JQ(a,n),c=J3(),u=$2(c,o4),d=$2(c,s4),h=$2(c,G3),p=t.useMemo(()=>h.filter(e=>e<=d).length,[d,h]),{skeletonRowsCount:g,visibleColumns:f,showFirstRowBorder:m}=e,v=qQ(e,cre),w=$2(c,V3),b=t.useMemo(()=>w.slice(0,p),[w,p]),C=$2(c,z3),y=t.useCallback(e=>-1!==C.left.findIndex(t=>t.field===e)?g6.LEFT:-1!==C.right.findIndex(t=>t.field===e)?g6.RIGHT:void 0,[C.left,C.right]),S=t.useMemo(()=>{const e=[];for(let t=0;t<g;t+=1){const n=[];for(let e=0;e<b.length;e+=1){const s=b[e],a=y(s.field),l=a===g6.LEFT,c=a===g6.RIGHT,d=are(a,o),p=d?C[d].length:b.length-C.left.length-C.right.length,g=d?C[d].findIndex(e=>e.field===s.field):e-C.left.length,m=u.hasScrollY?u.scrollbarSize:0,v=lre({},o,a,nre(a,s.computedWidth,e,h,u.columnsTotalWidth,m)),w=u.columnsTotalWidth<u.viewportOuterSize.width,S=rre(a,g,p,r.showCellVerticalBorder,w),x=ire(a,g),R=e===b.length-1,E=c&&0===g,T=E&&w,k=R&&!E&&w,M=u.viewportOuterSize.width-u.columnsTotalWidth,P=Math.max(0,M),I=(0,MH.jsx)(i.skeletonCell,{width:P,empty:!0},`skeleton-filler-column-${t}`),A=R&&0!==m;T&&n.push(I),n.push((0,MH.jsx)(i.skeletonCell,{field:s.field,type:s.type,align:s.align,width:"var(--width)",height:u.rowHeight,"data-colindex":e,empty:f&&!f.has(s.field),className:QQ(l&&I2["cell--pinnedLeft"],c&&I2["cell--pinnedRight"],S&&I2["cell--withRightBorder"],x&&I2["cell--withLeftBorder"]),style:$Q({"--width":`${s.computedWidth}px`},v)},`skeleton-column-${t}-${s.field}`)),k&&n.push(I),A&&n.push((0,MH.jsx)(sre,{pinnedRight:C.right.length>0},`skeleton-scrollbar-filler-${t}`))}e.push((0,MH.jsx)("div",{className:QQ(I2.row,I2.rowSkeleton,0===t&&!m&&I2["row--firstVisible"]),children:n},`skeleton-row-${t}`))}return e},[g,b,y,o,C,u.hasScrollY,u.scrollbarSize,u.columnsTotalWidth,u.viewportOuterSize.width,u.rowHeight,h,r.showCellVerticalBorder,i,f,m]);return R4(c,"columnResize",e=>{const{colDef:t,width:n}=e,r=a.current?.querySelectorAll(`[data-field="${Wee(t.field)}"]`);if(!r)throw new Error("MUI X: Expected skeleton cells to be defined with `data-field` attribute.");const i=b.findIndex(e=>e.field===t.field),o=y(t.field),s=o===g6.LEFT,l=o===g6.RIGHT,c=getComputedStyle(r[0]).getPropertyValue("--width"),u=parseInt(c,10)-n;if(r&&r.forEach(e=>{e.style.setProperty("--width",`${n}px`)}),s){const e=a.current?.querySelectorAll(`.${I2["cell--pinnedLeft"]}`);e?.forEach(e=>{dre(e)>i&&(e.style.left=parseInt(getComputedStyle(e).left,10)-u+"px")})}if(l){const e=a.current?.querySelectorAll(`.${I2["cell--pinnedRight"]}`);e?.forEach(e=>{dre(e)<i&&(e.style.right=`${parseInt(getComputedStyle(e).right,10)+u}px`)})}}),(0,MH.jsx)(ure,$Q({className:s.root},v,{ref:l,children:S}))});const pre=YQ(function(e,t){const n=$2(J3(),o4),r=n?.viewportInnerSize.height??0,i=Math.ceil(r/n.rowHeight);return(0,MH.jsx)(hre,$Q({},e,{skeletonRowsCount:i,ref:t}))});const gre=["variant","noRowsVariant","style"],fre={"circular-progress":{component:e=>e.slots.baseCircularProgress,style:{}},"linear-progress":{component:e=>e.slots.baseLinearProgress,style:{display:"block"}},skeleton:{component:()=>pre,style:{display:"block"}}},mre=YQ(function(e,t){const{variant:n="linear-progress",noRowsVariant:r="skeleton",style:i}=e,o=qQ(e,gre),s=J3(),a=e3(),l=$2(s,H4),c=fre[0===l?r:n],u=c.component(a);return(0,MH.jsx)(tre,$Q({style:$Q({},c.style,i)},o,{ref:t,children:(0,MH.jsx)(u,{})}))});const vre=YQ(function(e,t){const n=J3().current.getLocaleText("noRowsLabel");return(0,MH.jsx)(tre,$Q({},e,{ref:t,children:n}))});const wre=YQ(function(e,t){const n=e3(),r=J3(),i=$2(r,O3),o=!n.disableColumnSelector&&i.length>0;return(0,MH.jsxs)(tre,$Q({},e,{ref:t,children:[r.current.getLocaleText("noColumnsOverlayLabel"),o&&(0,MH.jsx)(n.slots.baseButton,$Q({size:"small"},n.slotProps?.baseButton,{onClick:()=>{r.current.showPreferences(X3.columns)},children:r.current.getLocaleText("noColumnsOverlayManageColumns")}))]}))});const bre=x2(F4)({maxHeight:"calc(100% + 1px)",flexGrow:1});const Cre=["className"],yre=i4("div",{name:"MuiDataGrid",slot:"PanelContent"})({display:"flex",flexDirection:"column",overflow:"auto",flex:"1 1",maxHeight:400,padding:O2.spacing(2.5,1.5,2,1),gap:O2.spacing(2.5)});function Sre(e){const{className:t}=e,n=qQ(e,Cre),r=e3(),i=(e=>{const{classes:t}=e;return tJ({root:["panelContent"]},P2,t)})(r);return(0,MH.jsx)(yre,$Q({className:QQ(i.root,t),ownerState:r},n))}const xre=["className"],Rre=x2("div",{name:"MuiDataGrid",slot:"PanelFooter"})({padding:O2.spacing(1),display:"flex",justifyContent:"space-between",borderTop:`1px solid ${O2.colors.border.base}`});function Ere(e){const{className:t}=e,n=qQ(e,xre),r=e3(),i=(e=>{const{classes:t}=e;return tJ({root:["panelFooter"]},P2,t)})(r);return(0,MH.jsx)(Rre,$Q({className:QQ(i.root,t),ownerState:r},n))}const Tre=["className"],kre=x2("div",{name:"MuiDataGrid",slot:"PanelWrapper"})({display:"flex",flexDirection:"column",flex:1,"&:focus":{outline:0}}),Mre=YQ(function(e,t){const{className:n}=e,r=qQ(e,Tre),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["panelWrapper"]},P2,t)})(i);return(0,MH.jsx)(kre,$Q({tabIndex:-1,className:QQ(o.root,n),ownerState:i},r,{ref:t}))});const Pre=["item","hasMultipleFilters","deleteFilter","applyFilterChanges","showMultiFilterOperators","disableMultiFilterOperator","applyMultiFilterOperatorChanges","focusElementRef","logicOperators","columnsSort","filterColumns","deleteIconProps","logicOperatorInputProps","operatorInputProps","columnInputProps","valueInputProps","readOnly","children"],Ire=["InputComponentProps"],Are=x2("div",{name:"MuiDataGrid",slot:"FilterForm"})({display:"flex",gap:O2.spacing(1.5)}),Dre=x2("div",{name:"MuiDataGrid",slot:"FilterFormDeleteIcon"})({flexShrink:0,display:"flex",justifyContent:"center",alignItems:"center"}),Fre=x2("div",{name:"MuiDataGrid",slot:"FilterFormLogicOperatorInput"})({minWidth:75,justifyContent:"end"}),Ore=x2("div",{name:"MuiDataGrid",slot:"FilterFormColumnInput"})({width:150}),Nre=x2("div",{name:"MuiDataGrid",slot:"FilterFormOperatorInput"})({width:150}),Lre=x2("div",{name:"MuiDataGrid",slot:"FilterFormValueInput"})({width:190}),_re=e=>e.headerName||e.field,Hre=new Intl.Collator,Vre=YQ(function(e,n){const{item:r,hasMultipleFilters:i,deleteFilter:o,applyFilterChanges:s,showMultiFilterOperators:a,disableMultiFilterOperator:l,applyMultiFilterOperatorChanges:c,focusElementRef:u,logicOperators:d=[b5.And,b5.Or],columnsSort:h,filterColumns:p,deleteIconProps:g={},logicOperatorInputProps:f={},operatorInputProps:m={},columnInputProps:v={},valueInputProps:w={},readOnly:b}=e,C=qQ(e,Pre),y=J3(),S=$2(y,N3),x=$2(y,$3),R=$2(y,k8),E=l5(),T=l5(),k=l5(),M=l5(),P=e3(),I=(e=>{const{classes:t}=e;return tJ({root:["filterForm"],deleteIcon:["filterFormDeleteIcon"],logicOperatorInput:["filterFormLogicOperatorInput"],columnInput:["filterFormColumnInput"],operatorInput:["filterFormOperatorInput"],valueInput:["filterFormValueInput"]},P2,t)})(P),A=t.useRef(null),D=t.useRef(null),F=R.logicOperator??b5.And,O=i&&d.length>0,N=(P.slotProps?.baseSelect||{}).native??!1,L=P.slotProps?.baseSelectOption||{},{InputComponentProps:_}=w,H=qQ(w,Ire),V=$2(y,n9),B=$2(y,i9),{filteredColumns:W,selectedField:z}=t.useMemo(()=>{let e=r.field;const t=!1===S[r.field].filterable?S[r.field]:null;if(t)return{filteredColumns:[t],selectedField:e};if(V)return{filteredColumns:x.filter(e=>void 0!==B.get(e.field)),selectedField:e};if(void 0===p||"function"!==typeof p)return{filteredColumns:x,selectedField:e};const n=p({field:r.field,columns:x,currentFilters:R?.items||[]});return{filteredColumns:x.filter(t=>{const i=n.includes(t.field);return t.field!==r.field||i||(e=void 0),i}),selectedField:e}},[r.field,S,V,p,x,R?.items,B]),j=t.useMemo(()=>{switch(h){case"asc":return W.sort((e,t)=>Hre.compare(_re(e),_re(t)));case"desc":return W.sort((e,t)=>-Hre.compare(_re(e),_re(t)));default:return W}},[W,h]),G=r.field?y.current.getColumn(r.field):null,$=t.useMemo(()=>r.operator&&G?G.filterOperators?.find(e=>e.value===r.operator):null,[r,G]),U=t.useCallback(e=>{const t=e.target.value,n=y.current.getColumn(t);if(n.field===G.field)return;const i=n.filterOperators.find(e=>e.value===r.operator)||n.filterOperators[0];let o=!i.InputComponent||i.InputComponent!==$?.InputComponent||n.type!==G.type?void 0:r.value;if("singleSelect"===n.type&&void 0!==o){const e=n,t=I6(e);Array.isArray(o)?o=o.filter(n=>void 0!==A6(n,t,e?.getOptionValue)):void 0===A6(r.value,t,e?.getOptionValue)&&(o=void 0)}s($Q({},r,{field:t,operator:i.value,value:o}))},[y,s,r,G,$]),K=t.useCallback(e=>{const t=e.target.value,n=G?.filterOperators.find(e=>e.value===t);s($Q({},r,{operator:t,value:!n?.InputComponent||n?.InputComponent!==$?.InputComponent?void 0:r.value}))},[s,r,G,$]),Y=t.useCallback(e=>{const t=e.target.value===b5.And.toString()?b5.And:b5.Or;c(t)},[c]);return t.useImperativeHandle(u,()=>({focus:()=>{$?.InputComponent?A?.current?.focus():D.current.focus()}}),[$]),(0,MH.jsxs)(Are,$Q({className:I.root,"data-id":r.id,ownerState:P},C,{ref:n,children:[(0,MH.jsx)(Dre,$Q({},g,{className:QQ(I.deleteIcon,g.className),ownerState:P,children:(0,MH.jsx)(P.slots.baseIconButton,$Q({"aria-label":y.current.getLocaleText("filterPanelDeleteIconLabel"),title:y.current.getLocaleText("filterPanelDeleteIconLabel"),onClick:()=>{o(r)},size:"small",disabled:b},P.slotProps?.baseIconButton,{children:(0,MH.jsx)(P.slots.filterPanelDeleteIcon,{fontSize:"small"})}))})),(0,MH.jsx)(Fre,$Q({as:P.slots.baseSelect,sx:[O?{display:"flex"}:{display:"none"},a?{visibility:"visible"}:{visibility:"hidden"},f.sx],className:QQ(I.logicOperatorInput,f.className),ownerState:P},f,{size:"small",slotProps:{htmlInput:{"aria-label":y.current.getLocaleText("filterPanelLogicOperator")}},value:F??"",onChange:Y,disabled:!!l||1===d.length,native:N},P.slotProps?.baseSelect,{children:d.map(e=>(0,t.createElement)(P.slots.baseSelectOption,$Q({},L,{native:N,key:e.toString(),value:e.toString()}),y.current.getLocaleText((e=>{switch(e){case b5.And:return"filterPanelOperatorAnd";case b5.Or:return"filterPanelOperatorOr";default:throw new Error("MUI X: Invalid `logicOperator` property in the `GridFilterPanel`.")}})(e))))})),(0,MH.jsx)(Ore,$Q({as:P.slots.baseSelect},v,{className:QQ(I.columnInput,v.className),ownerState:P,size:"small",labelId:T,id:E,label:y.current.getLocaleText("filterPanelColumns"),value:z??"",onChange:U,native:N,disabled:b},P.slotProps?.baseSelect,{children:j.map(e=>(0,t.createElement)(P.slots.baseSelectOption,$Q({},L,{native:N,key:e.field,value:e.field}),_re(e)))})),(0,MH.jsx)(Nre,$Q({as:P.slots.baseSelect,size:"small"},m,{className:QQ(I.operatorInput,m.className),ownerState:P,labelId:M,label:y.current.getLocaleText("filterPanelOperator"),id:k,value:r.operator,onChange:K,native:N,inputRef:D,disabled:b},P.slotProps?.baseSelect,{children:G?.filterOperators?.map(e=>(0,t.createElement)(P.slots.baseSelectOption,$Q({},L,{native:N,key:e.value,value:e.value}),e.label||y.current.getLocaleText(`filterOperator${eJ(e.value)}`)))})),(0,MH.jsx)(Lre,$Q({},H,{className:QQ(I.valueInput,H.className),ownerState:P,children:$?.InputComponent?(0,MH.jsx)($.InputComponent,$Q({apiRef:y,item:r,applyValue:s,focusElementRef:A,disabled:b,slotProps:{root:{size:"small"}}},$.InputComponentProps,_),r.field):null}))]}))});const Bre=["logicOperators","columnsSort","filterFormProps","getColumnForNewFilter","children","disableAddFilterButton","disableRemoveAllButton"],Wre=e=>({field:e.field,operator:e.filterOperators[0].value,id:Math.round(1e5*Math.random())}),zre=YQ(function(e,n){const r=J3(),i=e3(),o=$2(r,k8),s=$2(r,$3),a=$2(r,U3),l=t.useRef(null),c=t.useRef(null),{logicOperators:u=[b5.And,b5.Or],columnsSort:d,filterFormProps:h,getColumnForNewFilter:p,disableAddFilterButton:g=!1,disableRemoveAllButton:f=!1}=e,m=qQ(e,Bre),v=r.current.upsertFilterItem,w=t.useCallback(e=>{r.current.setFilterLogicOperator(e)},[r]),b=t.useCallback(()=>{let e;if(p&&"function"===typeof p){const t=p({currentFilters:o?.items||[],columns:s});if(null===t)return null;e=s.find(e=>{let{field:n}=e;return n===t})}else e=s.find(e=>e.filterOperators?.length);return e?Wre(e):null},[o?.items,s,p]),C=t.useCallback(()=>{if(void 0===p||"function"!==typeof p)return b();const e=o.items.length?o.items:[b()].filter(Boolean),t=p({currentFilters:e,columns:s});if(null===t)return null;const n=s.find(e=>{let{field:n}=e;return n===t});return n?Wre(n):null},[o.items,s,p,b]),y=t.useMemo(()=>o.items.length?o.items:(c.current||(c.current=b()),c.current?[c.current]:[]),[o.items,b]),S=y.length>1,{readOnlyFilters:x,validFilters:R}=t.useMemo(()=>y.reduce((e,t)=>(a[t.field]?e.validFilters.push(t):e.readOnlyFilters.push(t),e),{readOnlyFilters:[],validFilters:[]}),[y,a]),E=t.useCallback(()=>{const e=C();e&&r.current.upsertFilterItems([...y,e])},[r,C,y]),T=t.useCallback(e=>{const t=1===R.length;r.current.deleteFilterItem(e),t&&r.current.hideFilterPanel()},[r,R.length]),k=t.useCallback(()=>1===R.length&&void 0===R[0].value?(r.current.deleteFilterItem(R[0]),r.current.hideFilterPanel()):r.current.setFilterModel($Q({},o,{items:x}),"removeAllFilterItems"),[r,x,o,R]);return t.useEffect(()=>{u.length>0&&o.logicOperator&&!u.includes(o.logicOperator)&&w(u[0])},[u,w,o.logicOperator]),t.useEffect(()=>{R.length>0&&l.current.focus()},[R.length]),(0,MH.jsxs)(Mre,$Q({},m,{ref:n,children:[(0,MH.jsxs)(Sre,{children:[x.map((e,t)=>(0,MH.jsx)(Vre,$Q({item:e,applyFilterChanges:v,deleteFilter:T,hasMultipleFilters:S,showMultiFilterOperators:t>0,disableMultiFilterOperator:1!==t,applyMultiFilterOperatorChanges:w,focusElementRef:null,readOnly:!0,logicOperators:u,columnsSort:d},h),null==e.id?t:e.id)),R.map((e,t)=>(0,MH.jsx)(Vre,$Q({item:e,applyFilterChanges:v,deleteFilter:T,hasMultipleFilters:S,showMultiFilterOperators:x.length+t>0,disableMultiFilterOperator:x.length+t!==1,applyMultiFilterOperatorChanges:w,focusElementRef:t===R.length-1?l:null,logicOperators:u,columnsSort:d},h),null==e.id?t+x.length:e.id))]}),i.disableMultipleColumnsFiltering||g&&f?null:(0,MH.jsxs)(Ere,{children:[g?(0,MH.jsx)("span",{}):(0,MH.jsx)(i.slots.baseButton,$Q({onClick:E,startIcon:(0,MH.jsx)(i.slots.filterPanelAddIcon,{})},i.slotProps?.baseButton,{children:r.current.getLocaleText("filterPanelAddFilter")})),!f&&R.length>0?(0,MH.jsx)(i.slots.baseButton,$Q({onClick:k,startIcon:(0,MH.jsx)(i.slots.filterPanelRemoveAllIcon,{})},i.slotProps?.baseButton,{children:r.current.getLocaleText("filterPanelRemoveAll")})):null]})]}))});function jre(e){return k2("MuiInputBase",e)}const Gre=M2("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),$re=(e,t)=>(e.headerName||e.field).toLowerCase().indexOf(t)>-1;n(219);var Ure=function(e,n){var r=arguments;if(null==n||!PZ.call(n,"css"))return t.createElement.apply(void 0,r);var i=r.length,o=new Array(i);o[0]=DZ,o[1]=function(e,t){var n={};for(var r in t)PZ.call(t,r)&&(n[r]=t[r]);return n[IZ]=e,n}(e,n);for(var s=2;s<i;s++)o[s]=r[s];return t.createElement.apply(null,o)};!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(Ure||(Ure={}));var Kre=kZ(function(e,n){var r=SZ([e.styles],void 0,t.useContext(MZ)),i=t.useRef();return EZ(function(){var e=n.key+"-global",t=new n.sheet.constructor({key:e,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),o=!1,s=document.querySelector('style[data-emotion="'+e+" "+r.name+'"]');return n.sheet.tags.length&&(t.before=n.sheet.tags[0]),null!==s&&(o=!0,s.setAttribute("data-emotion",e),t.hydrate([s])),i.current=[t,o],function(){t.flush()}},[n]),EZ(function(){var e=i.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==r.next&&uZ(n,r.next,!0),t.tags.length){var o=t.tags[t.tags.length-1].nextElementSibling;t.before=o,t.flush()}n.insert("",r,t,!1)}},[n,r.name]),null});function Yre(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return SZ(t)}function qre(){var e=Yre.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}const Xre=["children"],Qre=qre({from:{opacity:0},to:{opacity:1}}),Jre=qre({"from, to":{"--scrollable":'" "'}}),Zre=i4("div",{name:"MuiDataGrid",slot:"ShadowScrollArea"})`
  flex: 1;
  display: flex;
  flex-direction: column;
  animation: ${Jre};
  animation-timeline: --scroll-timeline;
  animation-fill-mode: none;
  box-sizing: border-box;
  overflow: auto;
  scrollbar-width: thin;
  scroll-timeline: --scroll-timeline block;

  &::before,
  &::after {
    content: '';
    flex-shrink: 0;
    display: block;
    position: sticky;
    left: 0;
    width: 100%;
    height: 4px;
    animation: ${Qre} linear both;
    animation-timeline: --scroll-timeline;

    // Custom property toggle trick:
    // - Detects if the element is scrollable
    // - https://css-tricks.com/the-css-custom-property-toggle-trick/
    --visibility-scrollable: var(--scrollable) visible;
    --visibility-not-scrollable: hidden;
    visibility: var(--visibility-scrollable, var(--visibility-not-scrollable));
  }

  &::before {
    top: 0;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 0, transparent 100%);
    animation-range: 0 4px;
  }

  &::after {
    bottom: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.05) 0, transparent 100%);
    animation-direction: reverse;
    animation-range: calc(100% - 4px) 100%;
  }
`,eie=YQ(function(e,t){const{children:n}=e,r=qQ(e,Xre);return(0,MH.jsx)(Zre,$Q({},r,{ref:t,children:n}))});const tie=new Intl.Collator;const nie=x2("div",{name:"MuiDataGrid",slot:"ColumnsManagement"})({display:"flex",flexDirection:"column",padding:O2.spacing(.5,1.5)}),rie=x2(eie,{name:"MuiDataGrid",slot:"ColumnsManagementScrollArea"})({maxHeight:300}),iie=x2("div",{name:"MuiDataGrid",slot:"ColumnsManagementHeader"})({padding:O2.spacing(1.5,2),borderBottom:`1px solid ${O2.colors.border.base}`}),oie=x2(F4,{name:"MuiDataGrid",slot:"ColumnsManagementSearchInput"})({[`& .${Gre.input}::-webkit-search-decoration,\n      & .${Gre.input}::-webkit-search-cancel-button,\n      & .${Gre.input}::-webkit-search-results-button,\n      & .${Gre.input}::-webkit-search-results-decoration`]:{display:"none"}}),sie=x2("div",{name:"MuiDataGrid",slot:"ColumnsManagementFooter"})({padding:O2.spacing(1,1,1,1.5),display:"flex",justifyContent:"space-between",borderTop:`1px solid ${O2.colors.border.base}`}),aie=x2("div",{name:"MuiDataGrid",slot:"ColumnsManagementEmptyText"})({padding:O2.spacing(1,0),alignSelf:"center",font:O2.typography.font.body}),lie=["children","className","classes","onClose"],cie=M2("MuiDataGrid",["panel","paper"]),uie=x2(F4,{name:"MuiDataGrid",slot:"panel"})({zIndex:O2.zIndex.panel}),die=x2("div",{name:"MuiDataGrid",slot:"panelContent"})({backgroundColor:O2.colors.background.overlay,borderRadius:O2.radius.base,boxShadow:O2.shadows.overlay,display:"flex",maxWidth:`calc(100vw - ${O2.spacing(2)})`,overflow:"auto"}),hie=YQ((e,n)=>{const{children:r,className:i,onClose:o}=e,s=qQ(e,lie),a=J3(),l=e3(),c=cie,[u,d]=t.useState(!1),h=i3(),p=w4(()=>d(!0)),g=w4(()=>d(!1)),f=w4(()=>{o?.()}),m=w4(e=>{"Escape"===e.key&&o?.()}),[v,w]=t.useState(null);return t.useEffect(()=>{const e=a.current.rootElementRef?.current?.querySelector('[data-id="gridPanelAnchor"]');e&&w(e)},[a]),v?(0,MH.jsx)(uie,$Q({as:l.slots.basePopper,ownerState:l,placement:"bottom-end",className:QQ(c.panel,i,h),flip:!0,onDidShow:p,onDidHide:g,onClickAway:f,clickAwayMouseEvent:"onPointerUp",clickAwayTouchEvent:!1,focusTrap:!0},s,l.slotProps?.basePopper,{target:e.target??v,ref:n,children:(0,MH.jsx)(die,{className:c.paper,ownerState:l,onKeyDown:m,children:u&&r})})):null});const pie=["selected","rowId","row","index","style","rowHeight","className","visibleColumns","pinnedColumns","offsetLeft","columnsTotalWidth","firstColumnIndex","lastColumnIndex","focusedColumnIndex","isFirstVisible","isLastVisible","isNotVisible","showBottomBorder","scrollbarWidth","gridHasFiller","onClick","onDoubleClick","onMouseEnter","onMouseLeave","onMouseOut","onMouseOver"],gie=C3(nte,(e,t)=>{if(!t)return!1;return!!C8(e)}),fie=YQ(function(e,n){const{selected:r,rowId:i,row:o,index:s,style:a,rowHeight:l,className:c,visibleColumns:u,pinnedColumns:d,offsetLeft:h,columnsTotalWidth:p,firstColumnIndex:g,lastColumnIndex:f,focusedColumnIndex:m,isFirstVisible:v,isLastVisible:w,isNotVisible:b,showBottomBorder:C,scrollbarWidth:y,gridHasFiller:S,onClick:x,onDoubleClick:R,onMouseEnter:E,onMouseLeave:T,onMouseOut:k,onMouseOver:M}=e,P=qQ(e,pie),I=K2(),A=n3(),D=t.useRef(null),F=e3(),O=i7(I),N=$2(I,R8),L=$2(I,K4),_=$2(I,G3),H=F.rowReordering,V=$2(I,gie,H),B=JQ(D,n),W=j4(I,i),z=$2(I,rte,{rowId:i,editMode:F.editMode}),j=F.editMode===T6.Row,G=void 0!==m,$=G&&m>=d.left.length&&m<g,U=G&&m<u.length-d.right.length&&m>=f,K=function(e,t){return tJ(t,P2,e)}(F.classes,{root:["row",r&&"selected",j&&"row--editable",z&&"row--editing",v&&"row--firstVisible",w&&"row--lastVisible",C&&"row--borderBottom","auto"===l&&"row--dynamicHeight"]}),Y=A.hooks.useGridRowAriaAttributes();t.useLayoutEffect(()=>{if(O.range){const e=I.current.getRowIndexRelativeToVisibleRows(i);void 0!==e&&I.current.unstable_setLastMeasuredRowIndex(e)}if(D.current&&"auto"===l)return I.current.observeRowHeight(D.current,i)},[I,O.range,l,i]);const q=t.useCallback((e,t)=>n=>{jee(n)||I.current.getRow(i)&&(I.current.publishEvent(e,I.current.getRowParams(i),n),t&&t(n))},[I,i]),X=t.useCallback(e=>{const t=Bee(e.target,I2.cell),n=t?.getAttribute("data-field");if(n){if(n===aee.field)return;if(n===p6)return;if("__reorder__"===n)return;if(I.current.getCellMode(i,n)===k6.Edit)return;const e=I.current.getColumn(n);if(e?.type===J6)return}q("rowClick",x)(e)},[I,x,q,i]),{slots:Q,slotProps:J,disableColumnReorder:Z}=F,ee=$2(I,()=>$Q({},I.current.getRowHeightEntry(i)),void 0,B2),te=t.useMemo(()=>{if(b)return{opacity:0,width:0,height:0};const e=$Q({},a,{maxHeight:"auto"===l?"none":l,minHeight:l,"--height":"number"===typeof l?`${l}px`:l});if(ee.spacingTop){e["border"===F.rowSpacingType?"borderTopWidth":"marginTop"]=ee.spacingTop}if(ee.spacingBottom){const t="border"===F.rowSpacingType?"borderBottomWidth":"marginBottom";let n=e[t];"number"!==typeof n&&(n=parseInt(n||"0",10)),n+=ee.spacingBottom,e[t]=n}return e},[b,l,a,ee,F.rowSpacingType]),ne=I.current.unstable_applyPipeProcessors("rowClassName",[],i),re=Y(W,s);if("function"===typeof F.getRowClassName){const e=s-(O.range?.firstRowIndex||0),t=$Q({},I.current.getRowParams(i),{isFirstVisible:0===e,isLastVisible:e===O.rows.length-1,indexRelativeToCurrentPage:e});ne.push(F.getRowClassName(t))}const ie=function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:g6.NONE;const a=I.current.unstable_getCellColSpanInfo(i,n);if(a?.spannedByColSpan)return null;const c=a?.cellProps.width??e.computedWidth,u=a?.cellProps.colSpan??1,d=nre(s,e.computedWidth,n,_,p,y);if("skeletonRow"===W.type)return(0,MH.jsx)(Q.skeletonCell,{type:e.type,width:c,height:l,field:e.field,align:e.align},e.field);const h="__reorder__"===e.field,g=!(Z||e.disableReorder),f=V&&!N.length&&L<=1,m=!(g||h&&f),v=s===g6.VIRTUAL,w=ire(s,t),b=rre(s,t,r,F.showCellVerticalBorder,S);return(0,MH.jsx)(Q.cell,$Q({column:e,width:c,rowId:i,align:e.align||"left",colIndex:n,colSpan:u,disableDragEvents:m,isNotVisible:v,pinnedOffset:d,pinnedPosition:s,showLeftBorder:w,showRightBorder:b,row:o,rowNode:W},J?.cell),e.field)};const oe=d.left.map((e,t)=>ie(e,t,t,d.left.length,g6.LEFT)),se=d.right.map((e,t)=>{const n=u.length-d.right.length+t;return ie(e,t,n,d.right.length,g6.RIGHT)}),ae=u.length-d.left.length-d.right.length,le=[];$&&le.push(ie(u[m],m-d.left.length,m,ae,g6.VIRTUAL));for(let t=g;t<f;t+=1){const e=u[t],n=t-d.left.length;e&&le.push(ie(e,n,t,ae))}U&&le.push(ie(u[m],m-d.left.length,m,ae,g6.VIRTUAL));const ce=o?{onClick:X,onDoubleClick:q("rowDoubleClick",R),onMouseEnter:q("rowMouseEnter",E),onMouseLeave:q("rowMouseLeave",T),onMouseOut:q("rowMouseOut",k),onMouseOver:q("rowMouseOver",M)}:null;return(0,MH.jsxs)("div",$Q({"data-id":i,"data-rowindex":s,role:"row",className:QQ(...ne,K.root,c),style:te},re,ce,P,{ref:B,children:[oe,(0,MH.jsx)("div",{role:"presentation",className:I2.cellOffsetLeft,style:{width:h}}),le,(0,MH.jsx)("div",{role:"presentation",className:QQ(I2.cell,I2.cellEmpty)}),se,0!==y&&(0,MH.jsx)(sre,{pinnedRight:d.right.length>0,borderTop:!v})]}))});const mie=iJ(fie);let vie;const wie=["column","row","rowId","rowNode","align","children","colIndex","width","className","style","colSpan","disableDragEvents","isNotVisible","pinnedOffset","pinnedPosition","showRightBorder","showLeftBorder","onClick","onDoubleClick","onMouseDown","onMouseUp","onMouseOver","onKeyDown","onKeyUp","onDragEnter","onDragOver"],bie=["changeReason","unstable_updateValueOnRender"];g6.LEFT,I3.LEFT,g6.RIGHT,I3.RIGHT,g6.NONE,g6.VIRTUAL;const Cie=YQ(function(e,n){const{column:r,row:i,rowId:o,rowNode:s,align:a,colIndex:l,width:c,className:u,style:d,colSpan:h,disableDragEvents:p,isNotVisible:g,pinnedOffset:f,pinnedPosition:m,showRightBorder:v,showLeftBorder:w,onClick:b,onDoubleClick:C,onMouseDown:y,onMouseUp:S,onMouseOver:x,onKeyDown:R,onKeyUp:E,onDragEnter:T,onDragOver:k}=e,M=qQ(e,wie),P=K2(),I=e3(),A=z6(),D=r.field,F=$2(P,ite,{rowId:o,field:D}),O=n3().hooks.useCellAggregationResult(o,D),N=F?k6.Edit:k6.View,L=P.current.getCellParamsForRow(o,D,i,{colDef:r,cellMode:N,rowNode:s,tabIndex:$2(P,()=>{const e=E7(P);return e&&e.field===D&&e.id===o?0:-1}),hasFocus:$2(P,()=>{const e=y7(P);return e?.id===o&&e.field===D})});L.api=P.current,O&&(L.value=O.value,L.formattedValue=r.valueFormatter?r.valueFormatter(L.value,i,r,P):L.value);const _=$2(P,()=>P.current.unstable_applyPipeProcessors("isCellSelected",!1,{id:o,field:D})),H=$2(P,m7),V=$2(P,v7),{hasFocus:B,isEditable:W=!1,value:z}=L,j="actions"===r.type&&r.getActions?.(P.current.getRowParams(o)).some(e=>!e.props.disabled),G="view"!==N&&W||j?-1:L.tabIndex,{classes:$,getCellClassName:U}=I,K=[$2(P,()=>P.current.unstable_applyPipeProcessors("cellClassName",[],{id:o,field:D}).filter(Boolean).join(" "))];r.cellClassName&&K.push("function"===typeof r.cellClassName?r.cellClassName(L):r.cellClassName),"flex"===r.display&&K.push(I2["cell--flex"]),U&&K.push(U(L));const Y=L.formattedValue??z,q=t.useRef(null),X=JQ(n,q),Q=t.useRef(null),J=I.cellSelection??!1,Z=(e=>{const{align:t,showLeftBorder:n,showRightBorder:r,pinnedPosition:i,isEditable:o,isSelected:s,isSelectionMode:a,classes:l}=e;return tJ({root:["cell",`cell--text${eJ(t)}`,s&&"selected",o&&"cell--editable",n&&"cell--withLeftBorder",r&&"cell--withRightBorder",i===g6.LEFT&&"cell--pinnedLeft",i===g6.RIGHT&&"cell--pinnedRight",a&&!o&&"cell--selectionMode"]},P2,l)})({align:a,showLeftBorder:w,showRightBorder:v,isEditable:W,classes:I.classes,pinnedPosition:m,isSelected:_,isSelectionMode:J}),ee=t.useCallback(e=>t=>{const n=P.current.getCellParams(o,D||"");P.current.publishEvent(e,n,t),S&&S(t)},[P,D,S,o]),te=t.useCallback(e=>t=>{const n=P.current.getCellParams(o,D||"");P.current.publishEvent(e,n,t),y&&y(t)},[P,D,y,o]),ne=t.useCallback((e,t)=>n=>{if(!P.current.getRow(o))return;const r=P.current.getCellParams(o,D||"");P.current.publishEvent(e,r,n),t&&t(n)},[P,D,o]),re=H[o]?.[D]??!1,ie=V[o]?.[D]??1,oe=t.useMemo(()=>{if(g)return{padding:0,opacity:0,width:0,height:0,border:0};const e=lre($Q({"--width":`${c}px`},d),A,m,f),t=m===g6.LEFT,n=m===g6.RIGHT;return ie>1&&(e.height=`calc(var(--height) * ${ie})`,e.zIndex=10,(t||n)&&(e.zIndex=40)),e},[c,g,d,f,m,A,ie]);if(t.useEffect(()=>{if(!B||N===k6.Edit)return;const e=Iee(P.current.rootElementRef.current);if(q.current&&!q.current.contains(e.activeElement)){const e=q.current.querySelector('[tabindex="0"]'),t=Q.current||e||q.current;if(void 0===vie&&document.createElement("div").focus({get preventScroll(){return vie=!0,!1}}),vie)t.focus({preventScroll:!0});else{const e=P.current.getScrollPosition();t.focus(),P.current.scroll(e)}}},[B,N,P]),re)return(0,MH.jsx)("div",{"data-colindex":l,role:"presentation",style:$Q({width:"var(--width)"},oe)});let se,ae,le=M.onFocus;if(null===F&&r.renderCell&&(se=r.renderCell(L)),null!==F&&r.renderEditCell){const e=P.current.getRowWithUpdatedValues(o,r.field),t=qQ(F,bie),n=$Q({},L,{row:e,formattedValue:r.valueFormatter?r.valueFormatter(F.value,e,r,P):L.formattedValue},t);se=r.renderEditCell(n),K.push(I2["cell--editing"]),K.push($?.["cell--editing"])}if(void 0===se){const e=Y?.toString();se=e,ae=e}t.isValidElement(se)&&j&&(se=t.cloneElement(se,{focusElementRef:Q}));const ce=p?null:{onDragEnter:ne("cellDragEnter",T),onDragOver:ne("cellDragOver",k)};return(0,MH.jsx)("div",$Q({className:QQ(Z.root,K,u),role:"gridcell","data-field":D,"data-colindex":l,"aria-colindex":l+1,"aria-colspan":h,"aria-rowspan":ie,style:oe,title:ae,tabIndex:G,onClick:ne("cellClick",b),onDoubleClick:ne("cellDoubleClick",C),onMouseOver:ne("cellMouseOver",x),onMouseDown:te("cellMouseDown"),onMouseUp:ee("cellMouseUp"),onKeyDown:ne("cellKeyDown",R),onKeyUp:ne("cellKeyUp",E)},ce,M,{onFocus:le,ref:X,children:se}))});const yie=iJ(Cie),Sie=t.memo(e=>{const{colDef:n,open:r,columnMenuId:i,columnMenuButtonId:o,iconButtonRef:s}=e,a=J3(),l=e3(),c=(e=>{const{classes:t,open:n}=e;return tJ({root:["menuIcon",n&&"menuOpen"],button:["menuIconButton"]},P2,t)})($Q({},e,{classes:l.classes})),u=t.useCallback(e=>{e.preventDefault(),e.stopPropagation(),a.current.toggleColumnMenu(n.field)},[a,n.field]),d=n.headerName??n.field;return(0,MH.jsx)("div",{className:c.root,children:(0,MH.jsx)(l.slots.baseTooltip,$Q({title:a.current.getLocaleText("columnMenuLabel"),enterDelay:1e3},l.slotProps?.baseTooltip,{children:(0,MH.jsx)(l.slots.baseIconButton,$Q({ref:s,tabIndex:-1,className:c.button,"aria-label":a.current.getLocaleText("columnMenuAriaLabel")(d),size:"small",onClick:u,"aria-haspopup":"menu","aria-expanded":r,"aria-controls":r?i:void 0,id:o},l.slotProps?.baseIconButton,{children:(0,MH.jsx)(l.slots.columnMenuIcon,{fontSize:"inherit"})}))}))})});function xie(e){let{columnMenuId:t,columnMenuButtonId:n,ContentComponent:r,contentComponentProps:i,field:o,open:s,target:a,onExited:l}=e;const c=J3(),u=c.current.getColumn(o),d=w4(e=>{e&&(e.stopPropagation(),a?.contains(e.target))||c.current.hideColumnMenu()});return a&&u?(0,MH.jsx)(q6,{position:"bottom-"+("right"===u.align?"start":"end"),open:s,target:a,onClose:d,onExited:l,children:(0,MH.jsx)(r,$Q({colDef:u,hideMenu:d,open:s,id:t,labelledby:n},i))}):null}const Rie=["className","aria-label"],Eie=i4("div",{name:"MuiDataGrid",slot:"ColumnHeaderTitle"})({textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontWeight:"var(--unstable_DataGrid-headWeight)",lineHeight:"normal"}),Tie=YQ(function(e,t){const{className:n}=e,r=qQ(e,Rie),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["columnHeaderTitle"]},P2,t)})(i);return(0,MH.jsx)(Eie,$Q({className:QQ(o.root,n),ownerState:i},r,{ref:t}))});function kie(e){const{label:n,description:r}=e,i=e3(),o=t.useRef(null),[s,a]=t.useState(""),l=t.useCallback(()=>{if(!r&&o?.current){const t=(e=o.current).scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth;a(t?n:"")}var e},[r,n]);return(0,MH.jsx)(i.slots.baseTooltip,$Q({title:r||s},i.slotProps?.baseTooltip,{children:(0,MH.jsx)(Tie,{onMouseOver:l,ref:o,children:n})}))}const Mie=["resizable","resizing","height","side"];var Pie=function(e){return e.Left="left",e.Right="right",e}(Pie||{});function Iie(e){const{height:n,side:r=Pie.Right}=e,i=qQ(e,Mie),o=e3(),s=(e=>{const{resizable:t,resizing:n,classes:r,side:i}=e;return tJ({root:["columnSeparator",t&&"columnSeparator--resizable",n&&"columnSeparator--resizing",i&&`columnSeparator--side${eJ(i)}`],icon:["iconSeparator"]},P2,r)})($Q({},e,{side:r,classes:o.classes})),a=t.useCallback(e=>{e.preventDefault(),e.stopPropagation()},[]);return(0,MH.jsx)("div",$Q({className:s.root,style:{minHeight:n}},i,{onClick:a,children:(0,MH.jsx)(o.slots.columnResizeIcon,{className:s.icon})}))}const Aie=t.memo(Iie);const Die=["classes","columnMenuOpen","colIndex","height","isResizing","sortDirection","hasFocus","tabIndex","separatorSide","isDraggable","headerComponent","description","elementId","width","columnMenuIconButton","columnMenu","columnTitleIconButtons","headerClassName","label","resizable","draggableContainerProps","columnHeaderSeparatorProps","style"],Fie=YQ(function(e,n){const{classes:r,colIndex:i,height:o,isResizing:s,sortDirection:a,hasFocus:l,tabIndex:c,separatorSide:u,isDraggable:d,headerComponent:h,description:p,width:g,columnMenuIconButton:f=null,columnMenu:m=null,columnTitleIconButtons:v=null,headerClassName:w,label:b,resizable:C,draggableContainerProps:y,columnHeaderSeparatorProps:S,style:x}=e,R=qQ(e,Die),E=K2(),T=e3(),k=t.useRef(null),M=JQ(k,n);let P="none";return null!=a&&(P="asc"===a?"ascending":"descending"),t.useLayoutEffect(()=>{const e=E.current.state.columnMenu;if(l&&!e.open){const e=k.current.querySelector('[tabindex="0"]')||k.current;e?.focus(),E.current.columnHeadersContainerRef?.current&&(E.current.columnHeadersContainerRef.current.scrollLeft=0)}},[E,l]),(0,MH.jsxs)("div",$Q({className:QQ(r.root,w),style:$Q({},x,{width:g}),role:"columnheader",tabIndex:c,"aria-colindex":i+1,"aria-sort":P},R,{ref:M,children:[(0,MH.jsxs)("div",$Q({className:r.draggableContainer,draggable:d,role:"presentation"},y,{children:[(0,MH.jsxs)("div",{className:r.titleContainer,role:"presentation",children:[(0,MH.jsx)("div",{className:r.titleContainerContent,children:void 0!==h?h:(0,MH.jsx)(kie,{label:b,description:p,columnWidth:g})}),v]}),f]})),(0,MH.jsx)(Aie,$Q({resizable:!T.disableColumnResize&&!!C,resizing:s,height:o,side:u},S)),m]}))});const Oie=iJ(function(e){const{colDef:n,columnMenuOpen:r,colIndex:i,headerHeight:o,isResizing:s,isLast:a,sortDirection:l,sortIndex:c,filterItemsCounter:u,hasFocus:d,tabIndex:h,disableReorder:p,separatorSide:g,showLeftBorder:f,showRightBorder:m,pinnedPosition:v,pinnedOffset:w}=e,b=K2(),C=e3(),y=z6(),S=t.useRef(null),x=l5(),R=l5(),E=t.useRef(null),[T,k]=t.useState(r),M=t.useMemo(()=>!C.disableColumnReorder&&!p&&!n.disableReorder,[C.disableColumnReorder,p,n.disableReorder]);let P;n.renderHeader&&(P=n.renderHeader(b.current.getColumnHeaderParams(n.field)));const I=(e=>{const{colDef:t,classes:n,isDragging:r,sortDirection:i,showRightBorder:o,showLeftBorder:s,filterItemsCounter:a,pinnedPosition:l,isLastUnpinned:c,isSiblingFocused:u}=e,d=null!=i,h=null!=a&&a>0,p="number"===t.type;return tJ({root:["columnHeader","left"===t.headerAlign&&"columnHeader--alignLeft","center"===t.headerAlign&&"columnHeader--alignCenter","right"===t.headerAlign&&"columnHeader--alignRight",t.sortable&&"columnHeader--sortable",r&&"columnHeader--moving",d&&"columnHeader--sorted",h&&"columnHeader--filtered",p&&"columnHeader--numeric","withBorderColor",o&&"columnHeader--withRightBorder",s&&"columnHeader--withLeftBorder",l===g6.LEFT&&"columnHeader--pinnedLeft",l===g6.RIGHT&&"columnHeader--pinnedRight",c&&"columnHeader--lastUnpinned",u&&"columnHeader--siblingFocused"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer"],titleContainerContent:["columnHeaderTitleContainerContent"]},P2,n)})($Q({},e,{classes:C.classes,showRightBorder:m,showLeftBorder:f})),A=t.useCallback(e=>t=>{jee(t)||b.current.publishEvent(e,b.current.getColumnHeaderParams(n.field),t)},[b,n.field]),D=t.useMemo(()=>({onClick:A("columnHeaderClick"),onContextMenu:A("columnHeaderContextMenu"),onDoubleClick:A("columnHeaderDoubleClick"),onMouseOver:A("columnHeaderOver"),onMouseOut:A("columnHeaderOut"),onMouseEnter:A("columnHeaderEnter"),onMouseLeave:A("columnHeaderLeave"),onKeyDown:A("columnHeaderKeyDown"),onFocus:A("columnHeaderFocus"),onBlur:A("columnHeaderBlur")}),[A]),F=t.useMemo(()=>M?{onDragStart:A("columnHeaderDragStart"),onDragEnter:A("columnHeaderDragEnter"),onDragOver:A("columnHeaderDragOver"),onDragEndCapture:A("columnHeaderDragEnd")}:{},[M,A]),O=t.useMemo(()=>({onMouseDown:A("columnSeparatorMouseDown"),onDoubleClick:A("columnSeparatorDoubleClick")}),[A]);t.useEffect(()=>{T||k(r)},[T,r]);const N=t.useCallback(()=>{k(!1)},[]),L=!C.disableColumnMenu&&!n.disableColumnMenu&&(0,MH.jsx)(Sie,{colDef:n,columnMenuId:x,columnMenuButtonId:R,open:T,iconButtonRef:E}),_=(0,MH.jsx)(xie,{columnMenuId:x,columnMenuButtonId:R,field:n.field,open:r,target:E.current,ContentComponent:C.slots.columnMenu,contentComponentProps:C.slotProps?.columnMenu,onExited:N}),H=n.sortingOrder??C.sortingOrder,V=(n.sortable||null!=l)&&!n.hideSortIcons&&!C.disableColumnSorting,B=(0,MH.jsxs)(t.Fragment,{children:[!C.disableColumnFilter&&(0,MH.jsx)(C.slots.columnHeaderFilterIconButton,$Q({field:n.field,counter:u},C.slotProps?.columnHeaderFilterIconButton)),V&&(0,MH.jsx)(C.slots.columnHeaderSortIcon,$Q({field:n.field,direction:l,index:c,sortingOrder:H,disabled:!n.sortable},C.slotProps?.columnHeaderSortIcon))]});t.useLayoutEffect(()=>{const e=b.current.state.columnMenu;if(d&&!e.open){const e=S.current.querySelector('[tabindex="0"]')||S.current;e?.focus(),b.current.columnHeadersContainerRef?.current&&(b.current.columnHeadersContainerRef.current.scrollLeft=0)}},[b,d]);const W="function"===typeof n.headerClassName?n.headerClassName({field:n.field,colDef:n}):n.headerClassName,z=n.headerName??n.field,j=t.useMemo(()=>lre($Q({},e.style),y,v,w),[v,w,e.style,y]);return(0,MH.jsx)(Fie,$Q({ref:S,classes:I,columnMenuOpen:r,colIndex:i,height:o,isResizing:s,sortDirection:l,hasFocus:d,tabIndex:h,separatorSide:g,isDraggable:M,headerComponent:P,description:n.description,elementId:n.field,width:n.computedWidth,columnMenuIconButton:L,columnTitleIconButtons:B,headerClassName:QQ(W,a&&I2["columnHeader--last"]),label:z,resizable:!C.disableColumnResize&&!!n.resizable,"data-field":n.field,columnMenu:_,draggableContainerProps:F,columnHeaderSeparatorProps:O,style:j},D))});function Nie(e){const{groupId:n,width:r,depth:i,maxDepth:o,fields:s,height:a,colIndex:l,hasFocus:c,tabIndex:u,isLastColumn:d,pinnedPosition:h,pinnedOffset:p}=e,g=e3(),f=z6(),m=t.useRef(null),v=J3(),w=$2(v,s8),b=n?w[n]:{},{headerName:C=n??"",description:y="",headerAlign:S}=b;let x;const R=n&&w[n]?.renderHeaderGroup,E=t.useMemo(()=>({groupId:n,headerName:C,description:y,depth:i,maxDepth:o,fields:s,colIndex:l,isLastColumn:d}),[n,C,y,i,o,s,l,d]);n&&R&&(x=R(E));const T=$Q({},e,{classes:g.classes,headerAlign:S,depth:i,isDragging:!1}),k=C??n,M=l5(),P=null===n?`empty-group-cell-${M}`:n,I=(e=>{const{classes:t,headerAlign:n,isDragging:r,isLastColumn:i,showLeftBorder:o,showRightBorder:s,groupId:a,pinnedPosition:l}=e;return tJ({root:["columnHeader","left"===n&&"columnHeader--alignLeft","center"===n&&"columnHeader--alignCenter","right"===n&&"columnHeader--alignRight",r&&"columnHeader--moving",s&&"columnHeader--withRightBorder",o&&"columnHeader--withLeftBorder","withBorderColor",null===a?"columnHeader--emptyGroup":"columnHeader--filledGroup",l===g6.LEFT&&"columnHeader--pinnedLeft",l===g6.RIGHT&&"columnHeader--pinnedRight",i&&"columnHeader--last"],draggableContainer:["columnHeaderDraggableContainer"],titleContainer:["columnHeaderTitleContainer","withBorderColor"],titleContainerContent:["columnHeaderTitleContainerContent"]},P2,t)})(T);t.useLayoutEffect(()=>{if(c){const e=m.current.querySelector('[tabindex="0"]')||m.current;e?.focus()}},[v,c]);const A=t.useCallback(e=>t=>{jee(t)||v.current.publishEvent(e,E,t)},[v,E]),D=t.useMemo(()=>({onKeyDown:A("columnGroupHeaderKeyDown"),onFocus:A("columnGroupHeaderFocus"),onBlur:A("columnGroupHeaderBlur")}),[A]),F="function"===typeof b.headerClassName?b.headerClassName(E):b.headerClassName,O=t.useMemo(()=>lre($Q({},e.style),f,h,p),[h,p,e.style,f]);return(0,MH.jsx)(Fie,$Q({ref:m,classes:I,columnMenuOpen:!1,colIndex:l,height:a,isResizing:!1,sortDirection:null,hasFocus:!1,tabIndex:u,isDraggable:!1,headerComponent:x,headerClassName:F,description:y,elementId:P,width:r,columnMenuIconButton:null,columnTitleIconButtons:null,resizable:!1,label:k,"aria-colspan":s.length,"data-fields":`|-${s.join("-|-")}-|`,style:O},D))}const Lie=x2("div",{name:"MuiDataGrid",slot:"ColumnHeaderRow"})({display:"flex"}),_ie=["className"],Hie=i4("div",{name:"MuiDataGrid",slot:"ColumnHeaders"})({display:"flex",flexDirection:"column",borderTopLeftRadius:"var(--unstable_DataGrid-radius)",borderTopRightRadius:"var(--unstable_DataGrid-radius)"}),Vie=YQ(function(e,t){const{className:n}=e,r=qQ(e,_ie),i=e3(),o=(e=>{const{classes:t}=e;return tJ({root:["columnHeaders"]},P2,t)})(i);return(0,MH.jsx)(Hie,$Q({className:QQ(o.root,n),ownerState:i},r,{role:"presentation",ref:t}))});const Bie=["className","visibleColumns","sortColumnLookup","filterColumnLookup","columnHeaderTabIndexState","columnGroupHeaderTabIndexState","columnHeaderFocus","columnGroupHeaderFocus","headerGroupingMaxDepth","columnMenuState","columnVisibility","columnGroupsHeaderStructure","hasOtherElementInTabSequence"],Wie=YQ(function(e,n){const{visibleColumns:r,sortColumnLookup:i,filterColumnLookup:o,columnHeaderTabIndexState:s,columnGroupHeaderTabIndexState:a,columnHeaderFocus:l,columnGroupHeaderFocus:c,headerGroupingMaxDepth:u,columnMenuState:d,columnVisibility:h,columnGroupsHeaderStructure:p,hasOtherElementInTabSequence:g}=e,f=qQ(e,Bie),{getInnerProps:m,getColumnHeadersRow:v,getColumnGroupHeadersRows:w}=(e=>{const{visibleColumns:n,sortColumnLookup:r,filterColumnLookup:i,columnHeaderTabIndexState:o,columnGroupHeaderTabIndexState:s,columnHeaderFocus:a,columnGroupHeaderFocus:l,headerGroupingMaxDepth:c,columnMenuState:u,columnVisibility:d,columnGroupsHeaderStructure:h,hasOtherElementInTabSequence:p}=e,[g,f]=t.useState(""),[m,v]=t.useState(""),w=K2(),b=e3(),C=$2(w,o8),y=$2(w,G3),S=$2(w,d7),x=$2(w,z3),R=$2(w,N3),E=X7(y,S,x.left.length),T=$2(w,s4),k=$2(w,d4),M=$2(w,h4),P=$2(w,p4),I=$2(w,f4),A=t.useCallback(e=>v(e.field),[]),D=t.useCallback(()=>v(""),[]),F=t.useCallback(e=>f(e.field),[]),O=t.useCallback(()=>f(""),[]),N=t.useMemo(()=>x.left.length?{firstColumnIndex:0,lastColumnIndex:x.left.length}:null,[x.left.length]),L=t.useMemo(()=>x.right.length?{firstColumnIndex:n.length-x.right.length,lastColumnIndex:n.length}:null,[x.right.length,n.length]);R4(w,"columnResizeStart",A),R4(w,"columnResizeStop",D),R4(w,"columnHeaderDragStart",F),R4(w,"columnHeaderDragEndNative",O);const _=e=>{const{renderContext:t=S}=e||{},r=t.firstColumnIndex,i=t.lastColumnIndex;return{renderedColumns:n.slice(r,i),firstColumnToRender:r,lastColumnToRender:i}},H=function(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=e?.position===g6.RIGHT,s=void 0===e?.position,a=x.right.length>0&&o||0===x.right.length&&s,l=E-r;return(0,MH.jsxs)(t.Fragment,{children:[s&&(0,MH.jsx)("div",{role:"presentation",style:{width:l}}),n,s&&(0,MH.jsx)("div",{role:"presentation",className:QQ(I2.filler,i&&I2["filler--borderBottom"])}),a&&(0,MH.jsx)(sre,{header:!0,pinnedRight:o,borderBottom:i,borderTop:!1})]})},V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{renderedColumns:n,firstColumnToRender:s}=_(e),l=[];for(let c=0;c<n.length;c+=1){const d=n[c],h=s+c,f=0===h,v=null!==o&&o.field===d.field||f&&!p?0:-1,w=null!==a&&a.field===d.field,C=u.open&&u.field===d.field,S=e?.position,R=nre(S,d.computedWidth,h,y,T,I),E=S===g6.RIGHT?n[c-1]:n[c+1],P=!!E&&null!==a&&a.field===E.field,A=h+1===y.length-x.right.length,D=c,F=n.length,O=ire(S,D),N=rre(S,D,F,b.showColumnVerticalBorder,k);l.push((0,MH.jsx)(Oie,$Q({},r[d.field],{columnMenuOpen:C,filterItemsCounter:i[d.field]&&i[d.field].length,headerHeight:M,isDragging:d.field===g,colDef:d,colIndex:h,isResizing:m===d.field,isLast:h===y.length-1,hasFocus:w,tabIndex:v,pinnedPosition:S,pinnedOffset:R,isLastUnpinned:A,isSiblingFocused:P,showLeftBorder:O,showRightBorder:N},t),d.field))}return H(e,l,0)},B=e=>{let{depth:t,params:r}=e;const i=_(r);if(0===i.renderedColumns.length)return null;const{firstColumnToRender:o,lastColumnToRender:a}=i,u=h[t],p=n[o].field,g=C[p]?.[t]??null,f=u.findIndex(e=>{let{groupId:t,columnFields:n}=e;return t===g&&n.includes(p)}),m=n[a-1].field,v=C[m]?.[t]??null,w=u.findIndex(e=>{let{groupId:t,columnFields:n}=e;return t===v&&n.includes(m)}),S=u.slice(f,w+1).map(e=>$Q({},e,{columnFields:e.columnFields.filter(e=>!1!==d[e])})).filter(e=>e.columnFields.length>0),x=S[0].columnFields.indexOf(p),E=S[0].columnFields.slice(0,x).reduce((e,t)=>e+(R[t].computedWidth??0),0);let M=o;const A=S.map((e,n)=>{let{groupId:i,columnFields:o}=e;const a=null!==l&&l.depth===t&&o.includes(l.field),u=null!==s&&s.depth===t&&o.includes(s.field)?0:-1,d={groupId:i,width:o.reduce((e,t)=>e+R[t].computedWidth,0),fields:o,colIndex:M,hasFocus:a,tabIndex:u},h=r.position,p=nre(h,d.width,M,y,T,I);M+=o.length;let g=n;return h===g6.LEFT&&(g=M-1),(0,MH.jsx)(Nie,{groupId:i,width:d.width,fields:d.fields,colIndex:d.colIndex,depth:t,isLastColumn:n===S.length-1,maxDepth:c,height:P,hasFocus:a,tabIndex:u,pinnedPosition:h,pinnedOffset:p,showLeftBorder:ire(h,g),showRightBorder:rre(h,g,S.length,b.showColumnVerticalBorder,k)},n)});return H(r,A,E)};return{renderContext:S,leftRenderContext:N,rightRenderContext:L,pinnedColumns:x,visibleColumns:n,columnPositions:y,getFillers:H,getColumnHeadersRow:()=>(0,MH.jsxs)(Lie,{role:"row","aria-rowindex":c+1,ownerState:b,className:I2["row--borderBottom"],style:{height:M},children:[N&&V({position:g6.LEFT,renderContext:N},{disableReorder:!0}),V({renderContext:S}),L&&V({position:g6.RIGHT,renderContext:L},{disableReorder:!0,separatorSide:Pie.Left})]}),getColumnsToRender:_,getColumnGroupHeadersRows:()=>{if(0===c)return null;const e=[];for(let t=0;t<c;t+=1)e.push((0,MH.jsxs)(Lie,{role:"row","aria-rowindex":t+1,ownerState:b,style:{height:P},children:[N&&B({depth:t,params:{position:g6.LEFT,renderContext:N,maxLastColumn:N.lastColumnIndex}}),B({depth:t,params:{renderContext:S}}),L&&B({depth:t,params:{position:g6.RIGHT,renderContext:L,maxLastColumn:L.lastColumnIndex}})]},t));return e},getPinnedCellOffset:nre,isDragging:!!g,getInnerProps:()=>({role:"rowgroup"})}})({visibleColumns:r,sortColumnLookup:i,filterColumnLookup:o,columnHeaderTabIndexState:s,columnGroupHeaderTabIndexState:a,columnHeaderFocus:l,columnGroupHeaderFocus:c,headerGroupingMaxDepth:u,columnMenuState:d,columnVisibility:h,columnGroupsHeaderStructure:p,hasOtherElementInTabSequence:g});return(0,MH.jsxs)(Vie,$Q({},f,m(),{ref:n,children:[w(),v()]}))});const zie=iJ(Wie),jie=["displayOrder"],Gie=["hideMenu","colDef","id","labelledby","className","children","open"],$ie=x2(F4)(()=>({minWidth:248}));function Uie(e){e.currentTarget.contains(e.target)&&e.stopPropagation()}const Kie=YQ(function(e,n){const{hideMenu:r,id:i,labelledby:o,className:s,children:a,open:l}=e,c=qQ(e,Gie),u=e3(),d=t.useCallback(e=>{"Tab"===e.key&&e.preventDefault(),$6(e.key)&&r(e)},[r]);return(0,MH.jsx)($ie,$Q({as:u.slots.baseMenuList,id:i,className:QQ(I2.menuList,s),"aria-labelledby":o,onKeyDown:d,onWheel:Uie,onTouchMove:Uie,autoFocus:l},c,{ref:n,children:a}))});function Yie(e){const{colDef:n,onClick:r}=e,i=J3(),o=e3(),s=1===V3(i).filter(e=>!0!==e.disableColumnMenu).length,a=t.useCallback(e=>{s||(i.current.setColumnVisibility(n.field,!1),r(e))},[i,n.field,r,s]);return o.disableColumnSelector||!1===n.hideable?null:(0,MH.jsx)(o.slots.baseMenuItem,{onClick:a,disabled:s,iconStart:(0,MH.jsx)(o.slots.columnMenuHideIcon,{fontSize:"small"}),children:i.current.getLocaleText("columnMenuHideColumn")})}function qie(e){const{onClick:n}=e,r=J3(),i=e3(),o=t.useCallback(e=>{n(e),r.current.showPreferences(X3.columns)},[r,n]);return i.disableColumnSelector?null:(0,MH.jsx)(i.slots.baseMenuItem,{onClick:o,iconStart:(0,MH.jsx)(i.slots.columnMenuManageColumnsIcon,{fontSize:"small"}),children:r.current.getLocaleText("columnMenuManageColumns")})}const Xie=["defaultSlots","defaultSlotProps","slots","slotProps"],Qie={columnMenuSortItem:function(e){const{colDef:n,onClick:r}=e,i=J3(),o=$2(i,R8),s=e3(),a=t.useMemo(()=>{if(!n)return null;const e=o.find(e=>e.field===n.field);return e?.sort},[n,o]),l=n.sortingOrder??s.sortingOrder,c=t.useCallback(e=>{r(e);const t=e.currentTarget.getAttribute("data-value")||null;i.current.sortColumn(n.field,t===a?null:t)},[i,n,r,a]);if(s.disableColumnSorting||!n||!n.sortable||!l.some(e=>!!e))return null;const u=e=>{const t=i.current.getLocaleText(e);return"function"===typeof t?t(n):t};return(0,MH.jsxs)(t.Fragment,{children:[l.includes("asc")&&"asc"!==a?(0,MH.jsx)(s.slots.baseMenuItem,{onClick:c,"data-value":"asc",iconStart:(0,MH.jsx)(s.slots.columnMenuSortAscendingIcon,{fontSize:"small"}),children:u("columnMenuSortAsc")}):null,l.includes("desc")&&"desc"!==a?(0,MH.jsx)(s.slots.baseMenuItem,{onClick:c,"data-value":"desc",iconStart:(0,MH.jsx)(s.slots.columnMenuSortDescendingIcon,{fontSize:"small"}),children:u("columnMenuSortDesc")}):null,l.includes(null)&&null!=a?(0,MH.jsx)(s.slots.baseMenuItem,{onClick:c,iconStart:s.slots.columnMenuUnsortIcon?(0,MH.jsx)(s.slots.columnMenuUnsortIcon,{fontSize:"small"}):(0,MH.jsx)("span",{}),children:i.current.getLocaleText("columnMenuUnsort")}):null]})},columnMenuFilterItem:function(e){const{colDef:n,onClick:r}=e,i=J3(),o=e3(),s=t.useCallback(e=>{r(e),i.current.showFilterPanel(n.field)},[i,n.field,r]);return o.disableColumnFilter||!n.filterable?null:(0,MH.jsx)(o.slots.baseMenuItem,{onClick:s,iconStart:(0,MH.jsx)(o.slots.columnMenuFilterIcon,{fontSize:"small"}),children:i.current.getLocaleText("columnMenuFilter")})},columnMenuColumnsItem:function(e){return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(Yie,$Q({},e)),(0,MH.jsx)(qie,$Q({},e))]})}},Jie={columnMenuSortItem:{displayOrder:10},columnMenuFilterItem:{displayOrder:20},columnMenuColumnsItem:{displayOrder:30}},Zie=YQ(function(e,n){const{defaultSlots:r,defaultSlotProps:i,slots:o,slotProps:s}=e,a=qQ(e,Xie),l=(e=>{const n=K2(),r=e3(),{defaultSlots:i,defaultSlotProps:o,slots:s={},slotProps:a={},hideMenu:l,colDef:c,addDividers:u=!0}=e,d=t.useMemo(()=>$Q({},i,s),[i,s]),h=t.useMemo(()=>{if(!a||0===Object.keys(a).length)return o;const e=$Q({},a);return Object.entries(o).forEach(t=>{let[n,r]=t;e[n]=$Q({},r,a[n]||{})}),e},[o,a]),p=n.current.unstable_applyPipeProcessors("columnMenu",[],e.colDef),g=t.useMemo(()=>{const e=Object.keys(i);return Object.keys(s).filter(t=>!e.includes(t))},[s,i]);return t.useMemo(()=>{const e=Array.from(new Set([...p,...g])).filter(e=>null!=d[e]).sort((e,t)=>{const n=h[e],r=h[t];return(Number.isFinite(n?.displayOrder)?n.displayOrder:100)-(Number.isFinite(r?.displayOrder)?r.displayOrder:100)});return e.reduce((t,n,i)=>{let o={colDef:c,onClick:l};const s=h[n];return s&&(o=$Q({},o,qQ(s,jie))),u&&i!==e.length-1?[...t,[d[n],o],[r.slots.baseDivider,{}]]:[...t,[d[n],o]]},[])},[u,c,p,l,d,h,g,r.slots.baseDivider])})($Q({},a,{defaultSlots:r,defaultSlotProps:i,slots:o,slotProps:s}));return(0,MH.jsx)(Kie,$Q({},a,{ref:n,children:l.map((e,t)=>{let[n,r]=e;return(0,MH.jsx)(n,$Q({},r),t)})}))});const eoe=YQ(function(e,t){return(0,MH.jsx)(Zie,$Q({},e,{ref:t,defaultSlots:Qie,defaultSlotProps:Jie}))});const toe=YQ(function(e,t){const n=J3().current.getLocaleText("noResultsOverlayLabel");return(0,MH.jsx)(tre,$Q({},e,{ref:t,children:n}))});function noe(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function roe(e){const{controlled:n,default:r,name:i,state:o="value"}=e,{current:s}=t.useRef(void 0!==n),[a,l]=t.useState(r);return[s?n:a,t.useCallback(e=>{s||l(e)},[])]}const ioe=e=>{const n=t.useRef({});return t.useEffect(()=>{n.current=e}),n.current};function ooe(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const soe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i="any",stringify:o,trim:s=!1}=e;return(e,a)=>{let{inputValue:l,getOptionLabel:c}=a,u=s?l.trim():l;n&&(u=u.toLowerCase()),t&&(u=ooe(u));const d=u?e.filter(e=>{let r=(o||c)(e);return n&&(r=r.toLowerCase()),t&&(r=ooe(r)),"start"===i?r.startsWith(u):r.includes(u)}):e;return"number"===typeof r?d.slice(0,r):d}}(),aoe=e=>null!==e.current&&e.current.parentElement?.contains(document.activeElement),loe=[];function coe(e,t,n,r){if(t||null==e||r)return"";const i=n(e);return"string"===typeof i?i:""}const uoe=function(e){const{unstable_isActiveElementInListbox:n=aoe,unstable_classNamePrefix:r="Mui",autoComplete:i=!1,autoHighlight:o=!1,autoSelect:s=!1,blurOnSelect:a=!1,clearOnBlur:l=!e.freeSolo,clearOnEscape:c=!1,componentName:u="useAutocomplete",defaultValue:d=(e.multiple?loe:null),disableClearable:h=!1,disableCloseOnSelect:p=!1,disabled:g,disabledItemsFocusable:f=!1,disableListWrap:m=!1,filterOptions:v=soe,filterSelectedOptions:w=!1,freeSolo:b=!1,getOptionDisabled:C,getOptionKey:y,getOptionLabel:S=e=>e.label??e,groupBy:x,handleHomeEndKeys:R=!e.freeSolo,id:E,includeInputInList:T=!1,inputValue:k,isOptionEqualToValue:M=(e,t)=>e===t,multiple:P=!1,onChange:I,onClose:A,onHighlightChange:D,onInputChange:F,onOpen:O,open:N,openOnFocus:L=!1,options:_,readOnly:H=!1,renderValue:V,selectOnFocus:B=!e.freeSolo,value:W}=e,z=l5(E);let j=S;j=e=>{const t=S(e);return"string"!==typeof t?String(t):t};const G=t.useRef(!1),$=t.useRef(!0),U=t.useRef(null),K=t.useRef(null),[Y,q]=t.useState(null),[X,Q]=t.useState(-1),J=o?0:-1,Z=t.useRef(J),ee=t.useRef(coe(d??W,P,j)).current,[te,ne]=roe({controlled:W,default:d,name:u}),[re,ie]=roe({controlled:k,default:ee,name:u,state:"inputValue"}),[oe,se]=t.useState(!1),ae=t.useCallback((e,t,n)=>{if(!(P?te.length<t.length:null!==t)&&!l)return;const r=coe(t,P,j,V);re!==r&&(ie(r),F&&F(e,r,n))},[j,re,P,F,ie,l,te,V]),[le,ce]=roe({controlled:N,default:!1,name:u,state:"open"}),[ue,de]=t.useState(!0),he=!P&&null!=te&&re===j(te),pe=le&&!H,ge=pe?v(_.filter(e=>!w||!(P?te:[te]).some(t=>null!==t&&M(e,t))),{inputValue:he&&ue?"":re,getOptionLabel:j}):[],fe=ioe({filteredOptions:ge,value:te,inputValue:re});t.useEffect(()=>{const e=te!==fe.value;oe&&!e||b&&!e||ae(null,te,"reset")},[te,ae,oe,fe.value,b]);const me=le&&ge.length>0&&!H,ve=w4(e=>{if(-1===e)U.current.focus();else{const t=V?"data-item-index":"data-tag-index";Y.querySelector(`[${t}="${e}"]`).focus()}});t.useEffect(()=>{P&&X>te.length-1&&(Q(-1),ve(-1))},[te,P,X,ve]);const we=w4(e=>{let{event:t,index:n,reason:i}=e;if(Z.current=n,-1===n?U.current.removeAttribute("aria-activedescendant"):U.current.setAttribute("aria-activedescendant",`${z}-option-${n}`),D&&["mouse","keyboard","touch"].includes(i)&&D(t,-1===n?null:ge[n],i),!K.current)return;const o=K.current.querySelector(`[role="option"].${r}-focused`);o&&(o.classList.remove(`${r}-focused`),o.classList.remove(`${r}-focusVisible`));let s=K.current;if("listbox"!==K.current.getAttribute("role")&&(s=K.current.parentElement.querySelector('[role="listbox"]')),!s)return;if(-1===n)return void(s.scrollTop=0);const a=K.current.querySelector(`[data-option-index="${n}"]`);if(a&&(a.classList.add(`${r}-focused`),"keyboard"===i&&a.classList.add(`${r}-focusVisible`),s.scrollHeight>s.clientHeight&&"mouse"!==i&&"touch"!==i)){const e=a,t=s.clientHeight+s.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?s.scrollTop=n-s.clientHeight:e.offsetTop-e.offsetHeight*(x?1.3:0)<s.scrollTop&&(s.scrollTop=e.offsetTop-e.offsetHeight*(x?1.3:0))}}),be=w4(e=>{let{event:t,diff:n,direction:r="next",reason:o}=e;if(!pe)return;const s=function(e,t){if(!K.current||e<0||e>=ge.length)return-1;let n=e;for(;;){const r=K.current.querySelector(`[data-option-index="${n}"]`),i=!f&&(!r||r.disabled||"true"===r.getAttribute("aria-disabled"));if(r&&r.hasAttribute("tabindex")&&!i)return n;if(n="next"===t?(n+1)%ge.length:(n-1+ge.length)%ge.length,n===e)return-1}}((()=>{const e=ge.length-1;if("reset"===n)return J;if("start"===n)return 0;if("end"===n)return e;const t=Z.current+n;return t<0?-1===t&&T?-1:m&&-1!==Z.current||Math.abs(n)>1?0:e:t>e?t===e+1&&T?-1:m||Math.abs(n)>1?e:0:t})(),r);if(we({index:s,reason:o,event:t}),i&&"reset"!==n)if(-1===s)U.current.value=re;else{const e=j(ge[s]);U.current.value=e;0===e.toLowerCase().indexOf(re.toLowerCase())&&re.length>0&&U.current.setSelectionRange(re.length,e.length)}}),Ce=t.useCallback(()=>{if(!pe)return;const e=(()=>{if(-1!==Z.current&&fe.filteredOptions&&fe.filteredOptions.length!==ge.length&&fe.inputValue===re&&(P?te.length===fe.value.length&&fe.value.every((e,t)=>j(te[t])===j(e)):(e=fe.value,t=te,(e?j(e):"")===(t?j(t):"")))){const e=fe.filteredOptions[Z.current];if(e)return ge.findIndex(t=>j(t)===j(e))}var e,t;return-1})();if(-1!==e)return void(Z.current=e);const t=P?te[0]:te;if(0!==ge.length&&null!=t){if(K.current){if(null!=t){const e=ge[Z.current];if(P&&e&&-1!==te.findIndex(t=>M(e,t)))return;const n=ge.findIndex(e=>M(e,t));return void(-1===n?be({diff:"reset"}):we({index:n}))}Z.current>=ge.length-1?we({index:ge.length-1}):we({index:Z.current})}}else be({diff:"reset"})},[ge.length,!P&&te,w,be,we,pe,re,P]),ye=w4(e=>{noe(K,e),e&&Ce()});t.useEffect(()=>{Ce()},[Ce]);const Se=e=>{le||(ce(!0),de(!0),O&&O(e))},xe=(e,t)=>{le&&(ce(!1),A&&A(e,t))},Re=(e,t,n,r)=>{if(P){if(te.length===t.length&&te.every((e,n)=>e===t[n]))return}else if(te===t)return;I&&I(e,t,n,r),ne(t)},Ee=t.useRef(!1),Te=function(e,t){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"options",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"selectOption",i=t;if(P){i=Array.isArray(te)?te.slice():[];const e=i.findIndex(e=>M(t,e));-1===e?i.push(t):"freeSolo"!==n&&(i.splice(e,1),r="removeOption")}ae(e,i,r),Re(e,i,r,{option:t}),p||e&&(e.ctrlKey||e.metaKey)||xe(e,r),(!0===a||"touch"===a&&Ee.current||"mouse"===a&&!Ee.current)&&U.current.blur()},ke=(e,t)=>{if(!P)return;""===re&&xe(e,"toggleInput");let n=X;-1===X?""===re&&"previous"===t&&(n=te.length-1):(n+="next"===t?1:-1,n<0&&(n=0),n===te.length&&(n=-1)),n=function(e,t){if(-1===e)return-1;let n=e;for(;;){if("next"===t&&n===te.length||"previous"===t&&-1===n)return-1;const e=V?"data-item-index":"data-tag-index",r=Y.querySelector(`[${e}="${n}"]`);if(r&&r.hasAttribute("tabindex")&&!r.disabled&&"true"!==r.getAttribute("aria-disabled"))return n;n+="next"===t?1:-1}}(n,t),Q(n),ve(n)},Me=e=>{G.current=!0,ie(""),F&&F(e,"","clear"),Re(e,P?[]:null,"clear")},Pe=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(-1===X||["ArrowLeft","ArrowRight"].includes(t.key)||(Q(-1),ve(-1)),229!==t.which))switch(t.key){case"Home":pe&&R&&(t.preventDefault(),be({diff:"start",direction:"next",reason:"keyboard",event:t}));break;case"End":pe&&R&&(t.preventDefault(),be({diff:"end",direction:"previous",reason:"keyboard",event:t}));break;case"PageUp":t.preventDefault(),be({diff:-5,direction:"previous",reason:"keyboard",event:t}),Se(t);break;case"PageDown":t.preventDefault(),be({diff:5,direction:"next",reason:"keyboard",event:t}),Se(t);break;case"ArrowDown":t.preventDefault(),be({diff:1,direction:"next",reason:"keyboard",event:t}),Se(t);break;case"ArrowUp":t.preventDefault(),be({diff:-1,direction:"previous",reason:"keyboard",event:t}),Se(t);break;case"ArrowLeft":!P&&V?ve(0):ke(t,"previous");break;case"ArrowRight":!P&&V?ve(-1):ke(t,"next");break;case"Enter":if(-1!==Z.current&&pe){const e=ge[Z.current],n=!!C&&C(e);if(t.preventDefault(),n)return;Te(t,e,"selectOption"),i&&U.current.setSelectionRange(U.current.value.length,U.current.value.length)}else b&&""!==re&&!1===he&&(P&&t.preventDefault(),Te(t,re,"createOption","freeSolo"));break;case"Escape":pe?(t.preventDefault(),t.stopPropagation(),xe(t,"escape")):c&&(""!==re||P&&te.length>0||V)&&(t.preventDefault(),t.stopPropagation(),Me(t));break;case"Backspace":if(P&&!H&&""===re&&te.length>0){const e=-1===X?te.length-1:X,n=te.slice();n.splice(e,1),Re(t,n,"removeOption",{option:te[e]})}P||!V||H||(ne(null),ve(-1));break;case"Delete":if(P&&!H&&""===re&&te.length>0&&-1!==X){const e=X,n=te.slice();n.splice(e,1),Re(t,n,"removeOption",{option:te[e]})}P||!V||H||(ne(null),ve(-1))}},Ie=e=>{se(!0),L&&!G.current&&Se(e)},Ae=e=>{n(K)?U.current.focus():(se(!1),$.current=!0,G.current=!1,s&&-1!==Z.current&&pe?Te(e,ge[Z.current],"blur"):s&&b&&""!==re?Te(e,re,"blur","freeSolo"):l&&ae(e,te,"blur"),xe(e,"blur"))},De=e=>{const t=e.target.value;re!==t&&(ie(t),de(!1),F&&F(e,t,"input")),""===t?h||P||Re(e,null,"clear"):Se(e)},Fe=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));Z.current!==t&&we({event:e,index:t,reason:"mouse"})},Oe=e=>{we({event:e,index:Number(e.currentTarget.getAttribute("data-option-index")),reason:"touch"}),Ee.current=!0},Ne=e=>{const t=Number(e.currentTarget.getAttribute("data-option-index"));Te(e,ge[t],"selectOption"),Ee.current=!1},Le=e=>t=>{const n=te.slice();n.splice(e,1),Re(t,n,"removeOption",{option:te[e]})},_e=e=>{Re(e,null,"removeOption",{option:te})},He=e=>{le?xe(e,"toggleInput"):Se(e)},Ve=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute("id")!==z&&e.preventDefault()},Be=e=>{e.currentTarget.contains(e.target)&&(U.current.focus(),B&&$.current&&U.current.selectionEnd-U.current.selectionStart===0&&U.current.select(),$.current=!1)},We=e=>{g||""!==re&&le||He(e)};let ze=b&&re.length>0;ze=ze||(P?te.length>0:null!==te);let je=ge;if(x){new Map;je=ge.reduce((e,t,n)=>{const r=x(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])}return g&&oe&&Ae(),{getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e,onKeyDown:Pe(e),onMouseDown:Ve,onClick:Be}},getInputLabelProps:()=>({id:`${z}-label`,htmlFor:z}),getInputProps:()=>({id:z,value:re,onBlur:Ae,onFocus:Ie,onChange:De,onMouseDown:We,"aria-activedescendant":pe?"":null,"aria-autocomplete":i?"both":"list","aria-controls":me?`${z}-listbox`:void 0,"aria-expanded":me,autoComplete:"off",ref:U,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:g}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Me}),getItemProps:function(){let{index:e=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...P&&{key:e},...V?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!H&&{onDelete:P?Le(e):_e}}},getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:He}),getTagProps:e=>{let{index:t}=e;return{key:t,"data-tag-index":t,tabIndex:-1,...!H&&{onDelete:Le(t)}}},getListboxProps:()=>({role:"listbox",id:`${z}-listbox`,"aria-labelledby":`${z}-label`,ref:ye,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:e=>{let{index:t,option:n}=e;const r=(P?te:[te]).some(e=>null!=e&&M(n,e)),i=!!C&&C(n);return{key:y?.(n)??j(n),tabIndex:-1,role:"option",id:`${z}-option-${t}`,onMouseMove:Fe,onClick:Ne,onTouchStart:Oe,"data-option-index":t,"aria-disabled":i,"aria-selected":r}},id:z,inputValue:re,value:te,dirty:ze,expanded:pe&&Y,popupOpen:pe,focused:oe||-1!==X,anchorEl:Y,setAnchorEl:q,focusedItem:X,focusedTag:X,groupedOptions:je}};function doe(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function hoe(e){return e instanceof doe(e).Element||e instanceof Element}function poe(e){return e instanceof doe(e).HTMLElement||e instanceof HTMLElement}function goe(e){return"undefined"!==typeof ShadowRoot&&(e instanceof doe(e).ShadowRoot||e instanceof ShadowRoot)}var foe=Math.max,moe=Math.min,voe=Math.round;function woe(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function boe(){return!/^((?!chrome|android).)*safari/i.test(woe())}function Coe(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,o=1;t&&poe(e)&&(i=e.offsetWidth>0&&voe(r.width)/e.offsetWidth||1,o=e.offsetHeight>0&&voe(r.height)/e.offsetHeight||1);var s=(hoe(e)?doe(e):window).visualViewport,a=!boe()&&n,l=(r.left+(a&&s?s.offsetLeft:0))/i,c=(r.top+(a&&s?s.offsetTop:0))/o,u=r.width/i,d=r.height/o;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l,x:l,y:c}}function yoe(e){var t=doe(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Soe(e){return e?(e.nodeName||"").toLowerCase():null}function xoe(e){return((hoe(e)?e.ownerDocument:e.document)||window.document).documentElement}function Roe(e){return Coe(xoe(e)).left+yoe(e).scrollLeft}function Eoe(e){return doe(e).getComputedStyle(e)}function Toe(e){var t=Eoe(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function koe(e,t,n){void 0===n&&(n=!1);var r=poe(t),i=poe(t)&&function(e){var t=e.getBoundingClientRect(),n=voe(t.width)/e.offsetWidth||1,r=voe(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),o=xoe(t),s=Coe(e,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==Soe(t)||Toe(o))&&(a=function(e){return e!==doe(e)&&poe(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:yoe(e);var t}(t)),poe(t)?((l=Coe(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=Roe(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function Moe(e){var t=Coe(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Poe(e){return"html"===Soe(e)?e:e.assignedSlot||e.parentNode||(goe(e)?e.host:null)||xoe(e)}function Ioe(e){return["html","body","#document"].indexOf(Soe(e))>=0?e.ownerDocument.body:poe(e)&&Toe(e)?e:Ioe(Poe(e))}function Aoe(e,t){var n;void 0===t&&(t=[]);var r=Ioe(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=doe(r),s=i?[o].concat(o.visualViewport||[],Toe(r)?r:[]):r,a=t.concat(s);return i?a:a.concat(Aoe(Poe(s)))}function Doe(e){return["table","td","th"].indexOf(Soe(e))>=0}function Foe(e){return poe(e)&&"fixed"!==Eoe(e).position?e.offsetParent:null}function Ooe(e){for(var t=doe(e),n=Foe(e);n&&Doe(n)&&"static"===Eoe(n).position;)n=Foe(n);return n&&("html"===Soe(n)||"body"===Soe(n)&&"static"===Eoe(n).position)?t:n||function(e){var t=/firefox/i.test(woe());if(/Trident/i.test(woe())&&poe(e)&&"fixed"===Eoe(e).position)return null;var n=Poe(e);for(goe(n)&&(n=n.host);poe(n)&&["html","body"].indexOf(Soe(n))<0;){var r=Eoe(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var Noe="top",Loe="bottom",_oe="right",Hoe="left",Voe="auto",Boe=[Noe,Loe,_oe,Hoe],Woe="start",zoe="end",joe="viewport",Goe="popper",$oe=Boe.reduce(function(e,t){return e.concat([t+"-"+Woe,t+"-"+zoe])},[]),Uoe=[].concat(Boe,[Voe]).reduce(function(e,t){return e.concat([t,t+"-"+Woe,t+"-"+zoe])},[]),Koe=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Yoe(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}}),r.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||i(e)}),r}function qoe(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var Xoe={placement:"bottom",modifiers:[],strategy:"absolute"};function Qoe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"===typeof e.getBoundingClientRect)})}function Joe(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,o=void 0===i?Xoe:i;return function(e,t,n){void 0===n&&(n=o);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Xoe,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],a=!1,l={state:i,setOptions:function(n){var a="function"===typeof n?n(i.options):n;c(),i.options=Object.assign({},o,i.options,a),i.scrollParents={reference:hoe(e)?Aoe(e):e.contextElement?Aoe(e.contextElement):[],popper:Aoe(t)};var u=function(e){var t=Yoe(e);return Koe.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}(function(e){var t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(r,i.options.modifiers)));return i.orderedModifiers=u.filter(function(e){return e.enabled}),i.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"===typeof o){var a=o({state:i,name:t,instance:l,options:r}),c=function(){};s.push(a||c)}}),l.update()},forceUpdate:function(){if(!a){var e=i.elements,t=e.reference,n=e.popper;if(Qoe(t,n)){i.rects={reference:koe(t,Ooe(n),"fixed"===i.options.strategy),popper:Moe(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(e){return i.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var o=i.orderedModifiers[r],s=o.fn,c=o.options,u=void 0===c?{}:c,d=o.name;"function"===typeof s&&(i=s({state:i,options:u,name:d,instance:l})||i)}else i.reset=!1,r=-1}}},update:qoe(function(){return new Promise(function(e){l.forceUpdate(),e(i)})}),destroy:function(){c(),a=!0}};if(!Qoe(e,t))return l;function c(){s.forEach(function(e){return e()}),s=[]}return l.setOptions(n).then(function(e){!a&&n.onFirstUpdate&&n.onFirstUpdate(e)}),l}}var Zoe={passive:!0};function ese(e){return e.split("-")[0]}function tse(e){return e.split("-")[1]}function nse(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function rse(e){var t,n=e.reference,r=e.element,i=e.placement,o=i?ese(i):null,s=i?tse(i):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(o){case Noe:t={x:a,y:n.y-r.height};break;case Loe:t={x:a,y:n.y+n.height};break;case _oe:t={x:n.x+n.width,y:l};break;case Hoe:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var c=o?nse(o):null;if(null!=c){var u="y"===c?"height":"width";switch(s){case Woe:t[c]=t[c]-(n[u]/2-r[u]/2);break;case zoe:t[c]=t[c]+(n[u]/2-r[u]/2)}}return t}const ise={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=rse({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}};var ose={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sse(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,s=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,d=e.isFixed,h=s.x,p=void 0===h?0:h,g=s.y,f=void 0===g?0:g,m="function"===typeof u?u({x:p,y:f}):{x:p,y:f};p=m.x,f=m.y;var v=s.hasOwnProperty("x"),w=s.hasOwnProperty("y"),b=Hoe,C=Noe,y=window;if(c){var S=Ooe(n),x="clientHeight",R="clientWidth";if(S===doe(n)&&"static"!==Eoe(S=xoe(n)).position&&"absolute"===a&&(x="scrollHeight",R="scrollWidth"),i===Noe||(i===Hoe||i===_oe)&&o===zoe)C=Loe,f-=(d&&S===y&&y.visualViewport?y.visualViewport.height:S[x])-r.height,f*=l?1:-1;if(i===Hoe||(i===Noe||i===Loe)&&o===zoe)b=_oe,p-=(d&&S===y&&y.visualViewport?y.visualViewport.width:S[R])-r.width,p*=l?1:-1}var E,T=Object.assign({position:a},c&&ose),k=!0===u?function(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:voe(n*i)/i||0,y:voe(r*i)/i||0}}({x:p,y:f},doe(n)):{x:p,y:f};return p=k.x,f=k.y,l?Object.assign({},T,((E={})[C]=w?"0":"",E[b]=v?"0":"",E.transform=(y.devicePixelRatio||1)<=1?"translate("+p+"px, "+f+"px)":"translate3d("+p+"px, "+f+"px, 0)",E)):Object.assign({},T,((t={})[C]=w?f+"px":"",t[b]=v?p+"px":"",t.transform="",t))}const ase={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];poe(i)&&Soe(i)&&(Object.assign(i.style,n),Object.keys(r).forEach(function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],i=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]="",e},{});poe(r)&&Soe(r)&&(Object.assign(r.style,o),Object.keys(i).forEach(function(e){r.removeAttribute(e)}))})}},requires:["computeStyles"]};const lse={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,o=void 0===i?[0,0]:i,s=Uoe.reduce(function(e,n){return e[n]=function(e,t,n){var r=ese(e),i=[Hoe,Noe].indexOf(r)>=0?-1:1,o="function"===typeof n?n(Object.assign({},t,{placement:e})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[Hoe,_oe].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(n,t.rects,o),e},{}),a=s[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=s}};var cse={left:"right",right:"left",bottom:"top",top:"bottom"};function use(e){return e.replace(/left|right|bottom|top/g,function(e){return cse[e]})}var dse={start:"end",end:"start"};function hse(e){return e.replace(/start|end/g,function(e){return dse[e]})}function pse(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&goe(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function gse(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function fse(e,t,n){return t===joe?gse(function(e,t){var n=doe(e),r=xoe(e),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=boe();(c||!c&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+Roe(e),y:l}}(e,n)):hoe(t)?function(e,t){var n=Coe(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):gse(function(e){var t,n=xoe(e),r=yoe(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=foe(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=foe(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Roe(e),l=-r.scrollTop;return"rtl"===Eoe(i||n).direction&&(a+=foe(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}(xoe(e)))}function mse(e,t,n,r){var i="clippingParents"===t?function(e){var t=Aoe(Poe(e)),n=["absolute","fixed"].indexOf(Eoe(e).position)>=0&&poe(e)?Ooe(e):e;return hoe(n)?t.filter(function(e){return hoe(e)&&pse(e,n)&&"body"!==Soe(e)}):[]}(e):[].concat(t),o=[].concat(i,[n]),s=o[0],a=o.reduce(function(t,n){var i=fse(e,n,r);return t.top=foe(i.top,t.top),t.right=moe(i.right,t.right),t.bottom=moe(i.bottom,t.bottom),t.left=foe(i.left,t.left),t},fse(e,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function vse(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function wse(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}function bse(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,o=n.strategy,s=void 0===o?e.strategy:o,a=n.boundary,l=void 0===a?"clippingParents":a,c=n.rootBoundary,u=void 0===c?joe:c,d=n.elementContext,h=void 0===d?Goe:d,p=n.altBoundary,g=void 0!==p&&p,f=n.padding,m=void 0===f?0:f,v=vse("number"!==typeof m?m:wse(m,Boe)),w=h===Goe?"reference":Goe,b=e.rects.popper,C=e.elements[g?w:h],y=mse(hoe(C)?C:C.contextElement||xoe(e.elements.popper),l,u,s),S=Coe(e.elements.reference),x=rse({reference:S,element:b,strategy:"absolute",placement:i}),R=gse(Object.assign({},b,x)),E=h===Goe?R:S,T={top:y.top-E.top+v.top,bottom:E.bottom-y.bottom+v.bottom,left:y.left-E.left+v.left,right:E.right-y.right+v.right},k=e.modifiersData.offset;if(h===Goe&&k){var M=k[i];Object.keys(T).forEach(function(e){var t=[_oe,Loe].indexOf(e)>=0?1:-1,n=[Noe,Loe].indexOf(e)>=0?"y":"x";T[e]+=M[n]*t})}return T}const Cse={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0===s||s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,g=void 0===p||p,f=n.allowedAutoPlacements,m=t.options.placement,v=ese(m),w=l||(v===m||!g?[use(m)]:function(e){if(ese(e)===Voe)return[];var t=use(e);return[hse(e),t,hse(t)]}(m)),b=[m].concat(w).reduce(function(e,n){return e.concat(ese(n)===Voe?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?Uoe:l,u=tse(r),d=u?a?$oe:$oe.filter(function(e){return tse(e)===u}):Boe,h=d.filter(function(e){return c.indexOf(e)>=0});0===h.length&&(h=d);var p=h.reduce(function(t,n){return t[n]=bse(e,{placement:n,boundary:i,rootBoundary:o,padding:s})[ese(n)],t},{});return Object.keys(p).sort(function(e,t){return p[e]-p[t]})}(t,{placement:n,boundary:u,rootBoundary:d,padding:c,flipVariations:g,allowedAutoPlacements:f}):n)},[]),C=t.rects.reference,y=t.rects.popper,S=new Map,x=!0,R=b[0],E=0;E<b.length;E++){var T=b[E],k=ese(T),M=tse(T)===Woe,P=[Noe,Loe].indexOf(k)>=0,I=P?"width":"height",A=bse(t,{placement:T,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),D=P?M?_oe:Hoe:M?Loe:Noe;C[I]>y[I]&&(D=use(D));var F=use(D),O=[];if(o&&O.push(A[k]<=0),a&&O.push(A[D]<=0,A[F]<=0),O.every(function(e){return e})){R=T,x=!1;break}S.set(T,O)}if(x)for(var N=function(e){var t=b.find(function(t){var n=S.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return R=t,"break"},L=g?3:1;L>0;L--){if("break"===N(L))break}t.placement!==R&&(t.modifiersData[r]._skip=!0,t.placement=R,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function yse(e,t,n){return foe(e,moe(t,n))}const Sse={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0!==s&&s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,p=void 0===h||h,g=n.tetherOffset,f=void 0===g?0:g,m=bse(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),v=ese(t.placement),w=tse(t.placement),b=!w,C=nse(v),y="x"===C?"y":"x",S=t.modifiersData.popperOffsets,x=t.rects.reference,R=t.rects.popper,E="function"===typeof f?f(Object.assign({},t.rects,{placement:t.placement})):f,T="number"===typeof E?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),k=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,M={x:0,y:0};if(S){if(o){var P,I="y"===C?Noe:Hoe,A="y"===C?Loe:_oe,D="y"===C?"height":"width",F=S[C],O=F+m[I],N=F-m[A],L=p?-R[D]/2:0,_=w===Woe?x[D]:R[D],H=w===Woe?-R[D]:-x[D],V=t.elements.arrow,B=p&&V?Moe(V):{width:0,height:0},W=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},z=W[I],j=W[A],G=yse(0,x[D],B[D]),$=b?x[D]/2-L-G-z-T.mainAxis:_-G-z-T.mainAxis,U=b?-x[D]/2+L+G+j+T.mainAxis:H+G+j+T.mainAxis,K=t.elements.arrow&&Ooe(t.elements.arrow),Y=K?"y"===C?K.clientTop||0:K.clientLeft||0:0,q=null!=(P=null==k?void 0:k[C])?P:0,X=F+U-q,Q=yse(p?moe(O,F+$-q-Y):O,F,p?foe(N,X):N);S[C]=Q,M[C]=Q-F}if(a){var J,Z="x"===C?Noe:Hoe,ee="x"===C?Loe:_oe,te=S[y],ne="y"===y?"height":"width",re=te+m[Z],ie=te-m[ee],oe=-1!==[Noe,Hoe].indexOf(v),se=null!=(J=null==k?void 0:k[y])?J:0,ae=oe?re:te-x[ne]-R[ne]-se+T.altAxis,le=oe?te+x[ne]+R[ne]-se-T.altAxis:ie,ce=p&&oe?function(e,t,n){var r=yse(e,t,n);return r>n?n:r}(ae,te,le):yse(p?ae:re,te,p?le:ie);S[y]=ce,M[y]=ce-te}t.modifiersData[r]=M}},requiresIfExists:["offset"]};const xse={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=ese(n.placement),l=nse(a),c=[Hoe,_oe].indexOf(a)>=0?"height":"width";if(o&&s){var u=function(e,t){return vse("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:wse(e,Boe))}(i.padding,n),d=Moe(o),h="y"===l?Noe:Hoe,p="y"===l?Loe:_oe,g=n.rects.reference[c]+n.rects.reference[l]-s[l]-n.rects.popper[c],f=s[l]-n.rects.reference[l],m=Ooe(o),v=m?"y"===l?m.clientHeight||0:m.clientWidth||0:0,w=g/2-f/2,b=u[h],C=v-d[c]-u[p],y=v/2-d[c]/2+w,S=yse(b,y,C),x=l;n.modifiersData[r]=((t={})[x]=S,t.centerOffset=S-y,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&pse(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Rse(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function Ese(e){return[Noe,_oe,Loe,Hoe].some(function(t){return e[t]>=0})}const Tse={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,s=bse(t,{elementContext:"reference"}),a=bse(t,{altBoundary:!0}),l=Rse(s,r),c=Rse(a,i,o),u=Ese(l),d=Ese(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}};var kse=Joe({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,s=r.resize,a=void 0===s||s,l=doe(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&c.forEach(function(e){e.addEventListener("scroll",n.update,Zoe)}),a&&l.addEventListener("resize",n.update,Zoe),function(){o&&c.forEach(function(e){e.removeEventListener("scroll",n.update,Zoe)}),a&&l.removeEventListener("resize",n.update,Zoe)}},data:{}},ise,{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,s=void 0===o||o,a=n.roundOffsets,l=void 0===a||a,c={placement:ese(t.placement),variation:tse(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,sse(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,sse(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},ase,lse,Cse,Sse,xse,Tse]});const Mse=function(e){return"string"===typeof e};const Pse=function(e,t,n){return void 0===e||Mse(e)?t:{...t,ownerState:{...t.ownerState,...n}}};const Ise=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(void 0===e)return{};const n={};return Object.keys(e).filter(n=>n.match(/^on[A-Z]/)&&"function"===typeof e[n]&&!t.includes(n)).forEach(t=>{n[t]=e[t]}),n};const Ase=function(e){if(void 0===e)return{};const t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"===typeof e[t])).forEach(n=>{t[n]=e[n]}),t};const Dse=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:o}=e;if(!t){const e=QQ(n?.className,o,i?.className,r?.className),t={...n?.style,...i?.style,...r?.style},s={...n,...i,...r};return e.length>0&&(s.className=e),Object.keys(t).length>0&&(s.style=t),{props:s,internalRef:void 0}}const s=Ise({...i,...r}),a=Ase(r),l=Ase(i),c=t(s),u=QQ(c?.className,n?.className,o,i?.className,r?.className),d={...c?.style,...n?.style,...i?.style,...r?.style},h={...c,...n,...l,...a};return u.length>0&&(h.className=u),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:c.ref}};const Fse=function(e,t,n){return"function"===typeof e?e(t,n):e};const Ose=function(e){const{elementType:t,externalSlotProps:n,ownerState:r,skipResolvingSlotProps:i=!1,...o}=e,s=i?{}:Fse(n,r),{props:a,internalRef:l}=Dse({...o,externalSlotProps:s}),c=JQ(l,s?.ref,e.additionalProps?.ref);return Pse(t,{...a,ref:c},r)};function Nse(e){return parseInt(t.version,10)>=19?e?.props?.ref||null:e?.ref||null}const Lse=t.forwardRef(function(e,n){const{children:r,container:i,disablePortal:s=!1}=e,[a,l]=t.useState(null),c=JQ(t.isValidElement(r)?Nse(r):null,n);if(v4(()=>{s||l(function(e){return"function"===typeof e?e():e}(i)||document.body)},[i,s]),v4(()=>{if(a&&!s)return noe(n,a),()=>{noe(n,null)}},[n,a,s]),s){if(t.isValidElement(r)){const e={ref:c};return t.cloneElement(r,e)}return r}return a?o.createPortal(r,a):a});function _se(e){return k2("MuiPopper",e)}M2("MuiPopper",["root"]);function Hse(e){return"function"===typeof e?e():e}function Vse(e){return void 0!==e.nodeType}const Bse={},Wse=t.forwardRef(function(e,n){const{anchorEl:r,children:i,direction:o,disablePortal:s,modifiers:a,open:l,placement:c,popperOptions:u,popperRef:d,slotProps:h={},slots:p={},TransitionProps:g,ownerState:f,...m}=e,v=t.useRef(null),w=JQ(v,n),b=t.useRef(null),C=JQ(b,d),y=t.useRef(C);v4(()=>{y.current=C},[C]),t.useImperativeHandle(d,()=>b.current,[]);const S=function(e,t){if("ltr"===t)return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}(c,o),[x,R]=t.useState(S),[E,T]=t.useState(Hse(r));t.useEffect(()=>{b.current&&b.current.forceUpdate()}),t.useEffect(()=>{r&&T(Hse(r))},[r]),v4(()=>{if(!E||!l)return;let e=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:e=>{let{state:t}=e;R(t.placement)}}];null!=a&&(e=e.concat(a)),u&&null!=u.modifiers&&(e=e.concat(u.modifiers));const t=kse(E,v.current,{placement:S,...u,modifiers:e});return y.current(t),()=>{t.destroy(),y.current(null)}},[E,s,a,l,u,S]);const k={placement:x};null!==g&&(k.TransitionProps=g);const M=(e=>{const{classes:t}=e;return tJ({root:["root"]},_se,t)})(e),P=p.root??"div",I=Ose({elementType:P,externalSlotProps:h.root,externalForwardedProps:m,additionalProps:{role:"tooltip",ref:w},ownerState:e,className:M.root});return(0,MH.jsx)(P,{...I,children:"function"===typeof i?i(k):i})}),zse=t.forwardRef(function(e,n){const{anchorEl:r,children:i,container:o,direction:s="ltr",disablePortal:a=!1,keepMounted:l=!1,modifiers:c,open:u,placement:d="bottom",popperOptions:h=Bse,popperRef:p,style:g,transition:f=!1,slotProps:m={},slots:v={},...w}=e,[b,C]=t.useState(!0);if(!l&&!u&&(!f||b))return null;let y;if(o)y=o;else if(r){const e=Hse(r);y=e&&Vse(e)?Iee(e).body:Iee(null).body}const S=u||!l||f&&!b?void 0:"none",x=f?{in:u,onEnter:()=>{C(!1)},onExited:()=>{C(!0)}}:void 0;return(0,MH.jsx)(Lse,{disablePortal:a,container:y,children:(0,MH.jsx)(Wse,{anchorEl:r,direction:s,disablePortal:a,modifiers:c,ref:n,open:f?!b:u,placement:d,popperOptions:h,popperRef:p,slotProps:m,slots:v,...w,style:{position:"fixed",top:0,left:0,display:S,...g},TransitionProps:x,children:i})})}),jse=zse,Gse=t.createContext(void 0);function $se(e){let{props:n,name:r}=e;return function(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const i=t.components[n];return i.defaultProps?D4(i.defaultProps,r,t.components.mergeClassNameAndStyle):i.styleOverrides||i.variants?r:D4(i,r,t.components.mergeClassNameAndStyle)}({props:n,name:r,theme:{components:t.useContext(Gse)}})}function Use(e){return $se(e)}const Kse=x2(jse,{name:"MuiPopper",slot:"Root"})({}),Yse=t.forwardRef(function(e,t){const n=z6(),r=Use({props:e,name:"MuiPopper"}),{anchorEl:i,component:o,components:s,componentsProps:a,container:l,disablePortal:c,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:g,popperRef:f,transition:m,slots:v,slotProps:w,...b}=r,C=v?.root??s?.Root,y={anchorEl:i,container:l,disablePortal:c,keepMounted:u,modifiers:d,open:h,placement:p,popperOptions:g,popperRef:f,transition:m,...b};return(0,MH.jsx)(Kse,{as:o,direction:n?"rtl":"ltr",slots:{root:C},slotProps:w??a,...y,ref:t})}),qse=Yse,Xse={theme:void 0};const Qse=function(e){let t,n;return function(r){let i=t;return void 0!==i&&r.theme===n||(Xse.theme=r.theme,i=e1(e(Xse)),t=i,n=r.theme),i}},Jse=eJ;function Zse(e){return k2("MuiListSubheader",e)}M2("MuiListSubheader",["root","colorPrimary","colorInherit","gutters","inset","sticky"]);const eae=x2("li",{name:"MuiListSubheader",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"default"!==n.color&&t[`color${Jse(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(Qse(e=>{let{theme:t}=e;return{boxSizing:"border-box",lineHeight:"48px",listStyle:"none",color:(t.vars||t).palette.text.secondary,fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(14),variants:[{props:{color:"primary"},style:{color:(t.vars||t).palette.primary.main}},{props:{color:"inherit"},style:{color:"inherit"}},{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:16,paddingRight:16}},{props:e=>{let{ownerState:t}=e;return t.inset},style:{paddingLeft:72}},{props:e=>{let{ownerState:t}=e;return!t.disableSticky},style:{position:"sticky",top:0,zIndex:1,backgroundColor:(t.vars||t).palette.background.paper}}]}})),tae=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiListSubheader"}),{className:r,color:i="default",component:o="li",disableGutters:s=!1,disableSticky:a=!1,inset:l=!1,...c}=n,u={...n,color:i,component:o,disableGutters:s,disableSticky:a,inset:l},d=(e=>{const{classes:t,color:n,disableGutters:r,inset:i,disableSticky:o}=e;return tJ({root:["root","default"!==n&&`color${Jse(n)}`,!r&&"gutters",i&&"inset",!o&&"sticky"]},Zse,t)})(u);return(0,MH.jsx)(eae,{as:o,className:QQ(d.root,r),ref:t,ownerState:u,...c})});tae&&(tae.muiSkipListHighlight=!0);const nae=tae;function rae(e){return k2("MuiPaper",e)}M2("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const iae=x2("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!n.square&&t.rounded,"elevation"===n.variant&&t[`elevation${n.elevation}`]]}})(Qse(e=>{let{theme:t}=e;return{backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:e=>{let{ownerState:t}=e;return!t.square},style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}})),oae=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiPaper"}),r=Rne(),{className:i,component:o="div",elevation:s=1,square:a=!1,variant:l="elevation",...c}=n,u={...n,component:o,elevation:s,square:a,variant:l},d=(e=>{const{square:t,elevation:n,variant:r,classes:i}=e;return tJ({root:["root",r,!t&&"rounded","elevation"===r&&`elevation${n}`]},rae,i)})(u);return(0,MH.jsx)(iae,{as:o,ownerState:u,className:QQ(d.root,i),ref:t,...c,style:{..."elevation"===l&&{"--Paper-shadow":(r.vars||r).shadows[s],...r.vars&&{"--Paper-overlay":r.vars.overlays?.[s]},...!r.vars&&"dark"===r.palette.mode&&{"--Paper-overlay":`linear-gradient(${v1("#fff",i2(s))}, ${v1("#fff",i2(s))})`}},...c.style}})}),sae=oae,aae=l5;function lae(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t=>{let[,n]=t;return n&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!function(e){return"string"===typeof e.main}(e))return!1;for(const n of t)if(!e.hasOwnProperty(n)||"string"!==typeof e[n])return!1;return!0}(n,e)}}function cae(e){try{return e.matches(":focus-visible")}catch(Wn){0}return!1}const uae=JQ,dae=w4;class hae{static create(){return new hae}static use(){const e=H2(hae.create).current,[n,r]=t.useState(!1);return e.shouldMount=n,e.setShouldMount=r,t.useEffect(e.mountEffect,[n]),e}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=function(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});return n.resolve=e,n.reject=t,n}(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&null!==this.ref.current&&(this.didMount=!0,this.mounted.resolve())};start(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.mount().then(()=>this.ref.current?.start(...t))}stop(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.mount().then(()=>this.ref.current?.stop(...t))}pulsate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.mount().then(()=>this.ref.current?.pulsate(...t))}}function pae(e,t){return pae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pae(e,t)}function gae(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,pae(e,t)}const fae=t.createContext(null);function mae(e,n){var r=Object.create(null);return e&&t.Children.map(e,function(e){return e}).forEach(function(e){r[e.key]=function(e){return n&&(0,t.isValidElement)(e)?n(e):e}(e)}),r}function vae(e,t,n){return null!=n[t]?n[t]:e.props[t]}function wae(e,n,r){var i=mae(e.children),o=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,i=Object.create(null),o=[];for(var s in e)s in t?o.length&&(i[s]=o,o=[]):o.push(s);var a={};for(var l in t){if(i[l])for(r=0;r<i[l].length;r++){var c=i[l][r];a[i[l][r]]=n(c)}a[l]=n(l)}for(r=0;r<o.length;r++)a[o[r]]=n(o[r]);return a}(n,i);return Object.keys(o).forEach(function(s){var a=o[s];if((0,t.isValidElement)(a)){var l=s in n,c=s in i,u=n[s],d=(0,t.isValidElement)(u)&&!u.props.in;!c||l&&!d?c||!l||d?c&&l&&(0,t.isValidElement)(u)&&(o[s]=(0,t.cloneElement)(a,{onExited:r.bind(null,a),in:u.props.in,exit:vae(a,"exit",e),enter:vae(a,"enter",e)})):o[s]=(0,t.cloneElement)(a,{in:!1}):o[s]=(0,t.cloneElement)(a,{onExited:r.bind(null,a),in:!0,exit:vae(a,"exit",e),enter:vae(a,"enter",e)})}}),o}var bae=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},Cae=function(e){function n(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}gae(n,e);var r=n.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(e,n){var r,i,o=n.children,s=n.handleExited;return{children:n.firstRender?(r=e,i=s,mae(r.children,function(e){return(0,t.cloneElement)(e,{onExited:i.bind(null,e),in:!0,appear:vae(e,"appear",r),enter:vae(e,"enter",r),exit:vae(e,"exit",r)})})):wae(e,o,s),firstRender:!1}},r.handleExited=function(e,t){var n=mae(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var n=$Q({},t.children);return delete n[e.key],{children:n}}))},r.render=function(){var e=this.props,n=e.component,r=e.childFactory,i=qQ(e,["component","childFactory"]),o=this.state.contextValue,s=bae(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,null===n?t.createElement(fae.Provider,{value:o},s):t.createElement(fae.Provider,{value:o},t.createElement(n,i,s))},n}(t.Component);Cae.propTypes={},Cae.defaultProps={component:"div",childFactory:function(e){return e}};const yae=Cae;const Sae=function(e){const{className:n,classes:r,pulsate:i=!1,rippleX:o,rippleY:s,rippleSize:a,in:l,onExited:c,timeout:u}=e,[d,h]=t.useState(!1),p=QQ(n,r.ripple,r.rippleVisible,i&&r.ripplePulsate),g={width:a,height:a,top:-a/2+s,left:-a/2+o},f=QQ(r.child,d&&r.childLeaving,i&&r.childPulsate);return l||d||h(!0),t.useEffect(()=>{if(!l&&null!=c){const e=setTimeout(c,u);return()=>{clearTimeout(e)}}},[c,l,u]),(0,MH.jsx)("span",{className:p,style:g,children:(0,MH.jsx)("span",{className:f})})};const xae=M2("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Rae=qre`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Eae=qre`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Tae=qre`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,kae=x2("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Mae=x2(Sae,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${xae.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${Rae};
    animation-duration: ${550}ms;
    animation-timing-function: ${e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}};
  }

  &.${xae.ripplePulsate} {
    animation-duration: ${e=>{let{theme:t}=e;return t.transitions.duration.shorter}}ms;
  }

  & .${xae.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${xae.childLeaving} {
    opacity: 0;
    animation-name: ${Eae};
    animation-duration: ${550}ms;
    animation-timing-function: ${e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}};
  }

  & .${xae.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Tae};
    animation-duration: 2500ms;
    animation-timing-function: ${e=>{let{theme:t}=e;return t.transitions.easing.easeInOut}};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Pae=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:o={},className:s,...a}=r,[l,c]=t.useState([]),u=t.useRef(0),d=t.useRef(null);t.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const h=t.useRef(!1),p=A4(),g=t.useRef(null),f=t.useRef(null),m=t.useCallback(e=>{const{pulsate:t,rippleX:n,rippleY:r,rippleSize:i,cb:s}=e;c(e=>[...e,(0,MH.jsx)(Mae,{classes:{ripple:QQ(o.ripple,xae.ripple),rippleVisible:QQ(o.rippleVisible,xae.rippleVisible),ripplePulsate:QQ(o.ripplePulsate,xae.ripplePulsate),child:QQ(o.child,xae.child),childLeaving:QQ(o.childLeaving,xae.childLeaving),childPulsate:QQ(o.childPulsate,xae.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:i},u.current)]),u.current+=1,d.current=s},[o]),v=t.useCallback(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};const{pulsate:r=!1,center:o=i||t.pulsate,fakeElement:s=!1}=t;if("mousedown"===e?.type&&h.current)return void(h.current=!1);"touchstart"===e?.type&&(h.current=!0);const a=s?null:f.current,l=a?a.getBoundingClientRect():{width:0,height:0,left:0,top:0};let c,u,d;if(o||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)c=Math.round(l.width/2),u=Math.round(l.height/2);else{const{clientX:t,clientY:n}=e.touches&&e.touches.length>0?e.touches[0]:e;c=Math.round(t-l.left),u=Math.round(n-l.top)}if(o)d=Math.sqrt((2*l.width**2+l.height**2)/3),d%2===0&&(d+=1);else{const e=2*Math.max(Math.abs((a?a.clientWidth:0)-c),c)+2,t=2*Math.max(Math.abs((a?a.clientHeight:0)-u),u)+2;d=Math.sqrt(e**2+t**2)}e?.touches?null===g.current&&(g.current=()=>{m({pulsate:r,rippleX:c,rippleY:u,rippleSize:d,cb:n})},p.start(80,()=>{g.current&&(g.current(),g.current=null)})):m({pulsate:r,rippleX:c,rippleY:u,rippleSize:d,cb:n})},[i,m,p]),w=t.useCallback(()=>{v({},{pulsate:!0})},[v]),b=t.useCallback((e,t)=>{if(p.clear(),"touchend"===e?.type&&g.current)return g.current(),g.current=null,void p.start(0,()=>{b(e,t)});g.current=null,c(e=>e.length>0?e.slice(1):e),d.current=t},[p]);return t.useImperativeHandle(n,()=>({pulsate:w,start:v,stop:b}),[w,v,b]),(0,MH.jsx)(kae,{className:QQ(xae.root,o.root,s),ref:f,...a,children:(0,MH.jsx)(yae,{component:null,exit:!0,children:l})})}),Iae=Pae;function Aae(e){return k2("MuiButtonBase",e)}const Dae=M2("MuiButtonBase",["root","disabled","focusVisible"]),Fae=x2("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Dae.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Oae=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:o=!1,children:s,className:a,component:l="button",disabled:c=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:h=!1,focusVisibleClassName:p,LinkComponent:g="a",onBlur:f,onClick:m,onContextMenu:v,onDragLeave:w,onFocus:b,onFocusVisible:C,onKeyDown:y,onKeyUp:S,onMouseDown:x,onMouseLeave:R,onMouseUp:E,onTouchEnd:T,onTouchMove:k,onTouchStart:M,tabIndex:P=0,TouchRippleProps:I,touchRippleRef:A,type:D,...F}=r,O=t.useRef(null),N=hae.use(),L=uae(N.ref,A),[_,H]=t.useState(!1);c&&_&&H(!1),t.useImperativeHandle(i,()=>({focusVisible:()=>{H(!0),O.current.focus()}}),[]);const V=N.shouldMount&&!u&&!c;t.useEffect(()=>{_&&h&&!u&&N.pulsate()},[u,h,_,N]);const B=Nae(N,"start",x,d),W=Nae(N,"stop",v,d),z=Nae(N,"stop",w,d),j=Nae(N,"stop",E,d),G=Nae(N,"stop",e=>{_&&e.preventDefault(),R&&R(e)},d),$=Nae(N,"start",M,d),U=Nae(N,"stop",T,d),K=Nae(N,"stop",k,d),Y=Nae(N,"stop",e=>{cae(e.target)||H(!1),f&&f(e)},!1),q=dae(e=>{O.current||(O.current=e.currentTarget),cae(e.target)&&(H(!0),C&&C(e)),b&&b(e)}),X=()=>{const e=O.current;return l&&"button"!==l&&!("A"===e.tagName&&e.href)},Q=dae(e=>{h&&!e.repeat&&_&&" "===e.key&&N.stop(e,()=>{N.start(e)}),e.target===e.currentTarget&&X()&&" "===e.key&&e.preventDefault(),y&&y(e),e.target===e.currentTarget&&X()&&"Enter"===e.key&&!c&&(e.preventDefault(),m&&m(e))}),J=dae(e=>{h&&" "===e.key&&_&&!e.defaultPrevented&&N.stop(e,()=>{N.pulsate(e)}),S&&S(e),m&&e.target===e.currentTarget&&X()&&" "===e.key&&!e.defaultPrevented&&m(e)});let Z=l;"button"===Z&&(F.href||F.to)&&(Z=g);const ee={};"button"===Z?(ee.type=void 0===D?"button":D,ee.disabled=c):(F.href||F.to||(ee.role="button"),c&&(ee["aria-disabled"]=c));const te=uae(n,O),ne={...r,centerRipple:o,component:l,disabled:c,disableRipple:u,disableTouchRipple:d,focusRipple:h,tabIndex:P,focusVisible:_},re=(e=>{const{disabled:t,focusVisible:n,focusVisibleClassName:r,classes:i}=e,o=tJ({root:["root",t&&"disabled",n&&"focusVisible"]},Aae,i);return n&&r&&(o.root+=` ${r}`),o})(ne);return(0,MH.jsxs)(Fae,{as:Z,className:QQ(re.root,a),ownerState:ne,onBlur:Y,onClick:m,onContextMenu:W,onFocus:q,onKeyDown:Q,onKeyUp:J,onMouseDown:B,onMouseLeave:G,onMouseUp:j,onDragLeave:z,onTouchEnd:U,onTouchMove:K,onTouchStart:$,ref:te,tabIndex:c?-1:P,type:D,...ee,...F,children:[s,V?(0,MH.jsx)(Iae,{ref:L,center:o,...I}):null]})});function Nae(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return dae(i=>(n&&n(i),r||e[t](i),!0))}const Lae=Oae;function _ae(e){return k2("MuiCircularProgress",e)}M2("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Hae=44,Vae=qre`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,Bae=qre`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Wae="string"!==typeof Vae?Yre`
        animation: ${Vae} 1.4s linear infinite;
      `:null,zae="string"!==typeof Bae?Yre`
        animation: ${Bae} 1.4s ease-in-out infinite;
      `:null,jae=x2("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`color${Jse(n.color)}`]]}})(Qse(e=>{let{theme:t}=e;return{display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Wae||{animation:`${Vae} 1.4s linear infinite`}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars||t).palette[n].main}}})]}})),Gae=x2("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),$ae=x2("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.circle,t[`circle${Jse(n.variant)}`],n.disableShrink&&t.circleDisableShrink]}})(Qse(e=>{let{theme:t}=e;return{stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant&&!t.disableShrink},style:zae||{animation:`${Bae} 1.4s ease-in-out infinite`}}]}})),Uae=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiCircularProgress"}),{className:r,color:i="primary",disableShrink:o=!1,size:s=40,style:a,thickness:l=3.6,value:c=0,variant:u="indeterminate",...d}=n,h={...n,color:i,disableShrink:o,size:s,thickness:l,value:c,variant:u},p=(e=>{const{classes:t,variant:n,color:r,disableShrink:i}=e;return tJ({root:["root",n,`color${Jse(r)}`],svg:["svg"],circle:["circle",`circle${Jse(n)}`,i&&"circleDisableShrink"]},_ae,t)})(h),g={},f={},m={};if("determinate"===u){const e=2*Math.PI*((Hae-l)/2);g.strokeDasharray=e.toFixed(3),m["aria-valuenow"]=Math.round(c),g.strokeDashoffset=`${((100-c)/100*e).toFixed(3)}px`,f.transform="rotate(-90deg)"}return(0,MH.jsx)(jae,{className:QQ(p.root,r),style:{width:s,height:s,...f,...a},ownerState:h,ref:t,role:"progressbar",...m,...d,children:(0,MH.jsx)(Gae,{className:p.svg,ownerState:h,viewBox:"22 22 44 44",children:(0,MH.jsx)($ae,{className:p.circle,style:g,ownerState:h,cx:Hae,cy:Hae,r:(Hae-l)/2,fill:"none",strokeWidth:l})})})}),Kae=Uae;function Yae(e){return k2("MuiIconButton",e)}const qae=M2("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),Xae=x2(Lae,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.loading&&t.loading,"default"!==n.color&&t[`color${Jse(n.color)}`],n.edge&&t[`edge${Jse(n.edge)}`],t[`size${Jse(n.size)}`]]}})(Qse(e=>{let{theme:t}=e;return{textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette.action.active,t.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]}}),Qse(e=>{let{theme:t}=e;return{variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars||t).palette[n].main}}}),...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{"--IconButton-hoverBg":t.vars?`rgba(${(t.vars||t).palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1((t.vars||t).palette[n].main,t.palette.action.hoverOpacity)}}}),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${qae.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${qae.loading}`]:{color:"transparent"}}})),Qae=x2("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(e=>{let{theme:t}=e;return{display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]}}),Jae=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiIconButton"}),{edge:r=!1,children:i,className:o,color:s="default",disabled:a=!1,disableFocusRipple:l=!1,size:c="medium",id:u,loading:d=null,loadingIndicator:h,...p}=n,g=aae(u),f=h??(0,MH.jsx)(Kae,{"aria-labelledby":g,color:"inherit",size:16}),m={...n,edge:r,color:s,disabled:a,disableFocusRipple:l,loading:d,loadingIndicator:f,size:c},v=(e=>{const{classes:t,disabled:n,color:r,edge:i,size:o,loading:s}=e;return tJ({root:["root",s&&"loading",n&&"disabled","default"!==r&&`color${Jse(r)}`,i&&`edge${Jse(i)}`,`size${Jse(o)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},Yae,t)})(m);return(0,MH.jsxs)(Xae,{id:d?g:u,className:QQ(v.root,o),centerRipple:!0,focusRipple:!l,disabled:a||d,ref:t,...p,ownerState:m,children:["boolean"===typeof d&&(0,MH.jsx)("span",{className:v.loadingWrapper,style:{display:"contents"},children:(0,MH.jsx)(Qae,{className:v.loadingIndicator,ownerState:m,children:d&&f})}),i]})}),Zae=Jae;function ele(e){return k2("MuiSvgIcon",e)}M2("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const tle=x2("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"inherit"!==n.color&&t[`color${Jse(n.color)}`],t[`fontSize${Jse(n.fontSize)}`]]}})(Qse(e=>{let{theme:t}=e;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(e=>{let[,t]=e;return t&&t.main}).map(e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars??t).palette?.[n]?.main}}}),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),nle=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiSvgIcon"}),{children:i,className:o,color:s="inherit",component:a="svg",fontSize:l="medium",htmlColor:c,inheritViewBox:u=!1,titleAccess:d,viewBox:h="0 0 24 24",...p}=r,g=t.isValidElement(i)&&"svg"===i.type,f={...r,color:s,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:u,viewBox:h,hasSvgAsChild:g},m={};u||(m.viewBox=h);const v=(e=>{const{color:t,fontSize:n,classes:r}=e;return tJ({root:["root","inherit"!==t&&`color${Jse(t)}`,`fontSize${Jse(n)}`]},ele,r)})(f);return(0,MH.jsxs)(tle,{as:a,className:QQ(v.root,o),focusable:"false",color:c,"aria-hidden":!d||void 0,role:d?"img":void 0,ref:n,...m,...p,...g&&i.props,ownerState:f,children:[g?i.props.children:i,d?(0,MH.jsx)("title",{children:d}):null]})});nle.muiName="SvgIcon";const rle=nle;function ile(e,n){function r(t,n){return(0,MH.jsx)(rle,{"data-testid":void 0,ref:n,...t,children:e})}return r.muiName=rle.muiName,t.memo(t.forwardRef(r))}const ole=ile((0,MH.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z"}));function sle(e){return k2("MuiChip",e)}const ale=M2("MuiChip",["root","sizeSmall","sizeMedium","colorDefault","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","disabled","clickable","clickableColorPrimary","clickableColorSecondary","deletable","deletableColorPrimary","deletableColorSecondary","outlined","filled","outlinedPrimary","outlinedSecondary","filledPrimary","filledSecondary","avatar","avatarSmall","avatarMedium","avatarColorPrimary","avatarColorSecondary","icon","iconSmall","iconMedium","iconColorPrimary","iconColorSecondary","label","labelSmall","labelMedium","deleteIcon","deleteIconSmall","deleteIconMedium","deleteIconColorPrimary","deleteIconColorSecondary","deleteIconOutlinedColorPrimary","deleteIconOutlinedColorSecondary","deleteIconFilledColorPrimary","deleteIconFilledColorSecondary","focusVisible"]);function lle(e,t){const{className:n,elementType:r,ownerState:i,externalForwardedProps:o,internalForwardedProps:s,shouldForwardComponentProp:a=!1,...l}=t,{component:c,slots:u={[e]:void 0},slotProps:d={[e]:void 0},...h}=o,p=u[e]||r,g=Fse(d[e],i),{props:{component:f,...m},internalRef:v}=Dse({className:n,...l,externalForwardedProps:"root"===e?h:void 0,externalSlotProps:g}),w=JQ(v,g?.ref,t.ref),b="root"===e?f||c:f;return[p,Pse(p,{..."root"===e&&!c&&!u[e]&&s,..."root"!==e&&!u[e]&&s,...m,...b&&!a&&{as:b},...b&&a&&{component:b},ref:w},i)]}const cle=x2("div",{name:"MuiChip",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{color:r,iconColor:i,clickable:o,onDelete:s,size:a,variant:l}=n;return[{[`& .${ale.avatar}`]:t.avatar},{[`& .${ale.avatar}`]:t[`avatar${Jse(a)}`]},{[`& .${ale.avatar}`]:t[`avatarColor${Jse(r)}`]},{[`& .${ale.icon}`]:t.icon},{[`& .${ale.icon}`]:t[`icon${Jse(a)}`]},{[`& .${ale.icon}`]:t[`iconColor${Jse(i)}`]},{[`& .${ale.deleteIcon}`]:t.deleteIcon},{[`& .${ale.deleteIcon}`]:t[`deleteIcon${Jse(a)}`]},{[`& .${ale.deleteIcon}`]:t[`deleteIconColor${Jse(r)}`]},{[`& .${ale.deleteIcon}`]:t[`deleteIcon${Jse(l)}Color${Jse(r)}`]},t.root,t[`size${Jse(a)}`],t[`color${Jse(r)}`],o&&t.clickable,o&&"default"!==r&&t[`clickableColor${Jse(r)})`],s&&t.deletable,s&&"default"!==r&&t[`deletableColor${Jse(r)}`],t[l],t[`${l}${Jse(r)}`]]}})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode?t.palette.grey[700]:t.palette.grey[300];return{maxWidth:"100%",fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(13),display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,lineHeight:1.5,color:(t.vars||t).palette.text.primary,backgroundColor:(t.vars||t).palette.action.selected,borderRadius:16,whiteSpace:"nowrap",transition:t.transitions.create(["background-color","box-shadow"]),cursor:"unset",outline:0,textDecoration:"none",border:0,padding:0,verticalAlign:"middle",boxSizing:"border-box",[`&.${ale.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`& .${ale.avatar}`]:{marginLeft:5,marginRight:-6,width:24,height:24,color:t.vars?t.vars.palette.Chip.defaultAvatarColor:n,fontSize:t.typography.pxToRem(12)},[`& .${ale.avatarColorPrimary}`]:{color:(t.vars||t).palette.primary.contrastText,backgroundColor:(t.vars||t).palette.primary.dark},[`& .${ale.avatarColorSecondary}`]:{color:(t.vars||t).palette.secondary.contrastText,backgroundColor:(t.vars||t).palette.secondary.dark},[`& .${ale.avatarSmall}`]:{marginLeft:4,marginRight:-4,width:18,height:18,fontSize:t.typography.pxToRem(10)},[`& .${ale.icon}`]:{marginLeft:5,marginRight:-6},[`& .${ale.deleteIcon}`]:{WebkitTapHighlightColor:"transparent",color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.26)`:v1(t.palette.text.primary,.26),fontSize:22,cursor:"pointer",margin:"0 5px 0 -6px","&:hover":{color:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / 0.4)`:v1(t.palette.text.primary,.4)}},variants:[{props:{size:"small"},style:{height:24,[`& .${ale.icon}`]:{fontSize:18,marginLeft:4,marginRight:-4},[`& .${ale.deleteIcon}`]:{fontSize:16,marginRight:4,marginLeft:-4}}},...Object.entries(t.palette).filter(lae(["contrastText"])).map(e=>{let[n]=e;return{props:{color:n},style:{backgroundColor:(t.vars||t).palette[n].main,color:(t.vars||t).palette[n].contrastText,[`& .${ale.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[n].contrastTextChannel} / 0.7)`:v1(t.palette[n].contrastText,.7),"&:hover, &:active":{color:(t.vars||t).palette[n].contrastText}}}}}),{props:e=>e.iconColor===e.color,style:{[`& .${ale.icon}`]:{color:t.vars?t.vars.palette.Chip.defaultIconColor:n}}},{props:e=>e.iconColor===e.color&&"default"!==e.color,style:{[`& .${ale.icon}`]:{color:"inherit"}}},{props:{onDelete:!0},style:{[`&.${ale.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:v1(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}}},...Object.entries(t.palette).filter(lae(["dark"])).map(e=>{let[n]=e;return{props:{color:n,onDelete:!0},style:{[`&.${ale.focusVisible}`]:{background:(t.vars||t).palette[n].dark}}}}),{props:{clickable:!0},style:{userSelect:"none",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:v1(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)},[`&.${ale.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:v1(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},"&:active":{boxShadow:(t.vars||t).shadows[1]}}},...Object.entries(t.palette).filter(lae(["dark"])).map(e=>{let[n]=e;return{props:{color:n,clickable:!0},style:{[`&:hover, &.${ale.focusVisible}`]:{backgroundColor:(t.vars||t).palette[n].dark}}}}),{props:{variant:"outlined"},style:{backgroundColor:"transparent",border:t.vars?`1px solid ${t.vars.palette.Chip.defaultBorder}`:`1px solid ${"light"===t.palette.mode?t.palette.grey[400]:t.palette.grey[700]}`,[`&.${ale.clickable}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${ale.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`& .${ale.avatar}`]:{marginLeft:4},[`& .${ale.avatarSmall}`]:{marginLeft:2},[`& .${ale.icon}`]:{marginLeft:4},[`& .${ale.iconSmall}`]:{marginLeft:2},[`& .${ale.deleteIcon}`]:{marginRight:5},[`& .${ale.deleteIconSmall}`]:{marginRight:3}}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{variant:"outlined",color:n},style:{color:(t.vars||t).palette[n].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.7)`:v1(t.palette[n].main,.7)}`,[`&.${ale.clickable}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette[n].main,t.palette.action.hoverOpacity)},[`&.${ale.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.focusOpacity})`:v1(t.palette[n].main,t.palette.action.focusOpacity)},[`& .${ale.deleteIcon}`]:{color:t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.7)`:v1(t.palette[n].main,.7),"&:hover, &:active":{color:(t.vars||t).palette[n].main}}}}})]}})),ule=x2("span",{name:"MuiChip",slot:"Label",overridesResolver:(e,t)=>{const{ownerState:n}=e,{size:r}=n;return[t.label,t[`label${Jse(r)}`]]}})({overflow:"hidden",textOverflow:"ellipsis",paddingLeft:12,paddingRight:12,whiteSpace:"nowrap",variants:[{props:{variant:"outlined"},style:{paddingLeft:11,paddingRight:11}},{props:{size:"small"},style:{paddingLeft:8,paddingRight:8}},{props:{size:"small",variant:"outlined"},style:{paddingLeft:7,paddingRight:7}}]});function dle(e){return"Backspace"===e.key||"Delete"===e.key}const hle=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiChip"}),{avatar:i,className:o,clickable:s,color:a="default",component:l,deleteIcon:c,disabled:u=!1,icon:d,label:h,onClick:p,onDelete:g,onKeyDown:f,onKeyUp:m,size:v="medium",variant:w="filled",tabIndex:b,skipFocusWhenDisabled:C=!1,slots:y={},slotProps:S={},...x}=r,R=t.useRef(null),E=uae(R,n),T=e=>{e.stopPropagation(),g&&g(e)},k=!(!1===s||!p)||s,M=k||g?Lae:l||"div",P={...r,component:M,disabled:u,size:v,color:a,iconColor:t.isValidElement(d)&&d.props.color||a,onDelete:!!g,clickable:k,variant:w},I=(e=>{const{classes:t,disabled:n,size:r,color:i,iconColor:o,onDelete:s,clickable:a,variant:l}=e;return tJ({root:["root",l,n&&"disabled",`size${Jse(r)}`,`color${Jse(i)}`,a&&"clickable",a&&`clickableColor${Jse(i)}`,s&&"deletable",s&&`deletableColor${Jse(i)}`,`${l}${Jse(i)}`],label:["label",`label${Jse(r)}`],avatar:["avatar",`avatar${Jse(r)}`,`avatarColor${Jse(i)}`],icon:["icon",`icon${Jse(r)}`,`iconColor${Jse(o)}`],deleteIcon:["deleteIcon",`deleteIcon${Jse(r)}`,`deleteIconColor${Jse(i)}`,`deleteIcon${Jse(l)}Color${Jse(i)}`]},sle,t)})(P),A=M===Lae?{component:l||"div",focusVisibleClassName:I.focusVisible,...g&&{disableRipple:!0}}:{};let D=null;g&&(D=c&&t.isValidElement(c)?t.cloneElement(c,{className:QQ(c.props.className,I.deleteIcon),onClick:T}):(0,MH.jsx)(ole,{className:I.deleteIcon,onClick:T}));let F=null;i&&t.isValidElement(i)&&(F=t.cloneElement(i,{className:QQ(I.avatar,i.props.className)}));let O=null;d&&t.isValidElement(d)&&(O=t.cloneElement(d,{className:QQ(I.icon,d.props.className)}));const N={slots:y,slotProps:S},[L,_]=lle("root",{elementType:cle,externalForwardedProps:{...N,...x},ownerState:P,shouldForwardComponentProp:!0,ref:E,className:QQ(I.root,o),additionalProps:{disabled:!(!k||!u)||void 0,tabIndex:C&&u?-1:b,...A},getSlotProps:e=>({...e,onClick:t=>{e.onClick?.(t),p?.(t)},onKeyDown:t=>{e.onKeyDown?.(t),(e=>{e.currentTarget===e.target&&dle(e)&&e.preventDefault(),f&&f(e)})?.(t)},onKeyUp:t=>{e.onKeyUp?.(t),(e=>{e.currentTarget===e.target&&g&&dle(e)&&g(e),m&&m(e)})?.(t)}})}),[H,V]=lle("label",{elementType:ule,externalForwardedProps:N,ownerState:P,className:I.label});return(0,MH.jsxs)(L,{as:M,..._,children:[F||O,(0,MH.jsx)(H,{...V,children:h}),D]})}),ple=hle;function gle(e){return k2("MuiInput",e)}const fle={...Gre,...M2("MuiInput",["root","underline","input"])};function mle(e){return k2("MuiOutlinedInput",e)}const vle={...Gre,...M2("MuiOutlinedInput",["root","notchedOutline","input"])};function wle(e){return k2("MuiFilledInput",e)}const ble={...Gre,...M2("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},Cle=ile((0,MH.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),yle=ile((0,MH.jsx)("path",{d:"M7 10l5 5 5-5z"}));function Sle(e){return k2("MuiAutocomplete",e)}const xle=M2("MuiAutocomplete",["root","expanded","fullWidth","focused","focusVisible","tag","tagSizeSmall","tagSizeMedium","hasPopupIcon","hasClearIcon","inputRoot","input","inputFocused","endAdornment","clearIndicator","popupIndicator","popupIndicatorOpen","popper","popperDisablePortal","paper","listbox","loading","noOptions","option","groupLabel","groupUl"]);var Rle,Ele;const Tle=x2("div",{name:"MuiAutocomplete",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:o,inputFocused:s,size:a}=n;return[{[`& .${xle.tag}`]:t.tag},{[`& .${xle.tag}`]:t[`tagSize${Jse(a)}`]},{[`& .${xle.inputRoot}`]:t.inputRoot},{[`& .${xle.input}`]:t.input},{[`& .${xle.input}`]:s&&t.inputFocused},t.root,r&&t.fullWidth,o&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${xle.focused} .${xle.clearIndicator}`]:{visibility:"visible"},"@media (pointer: fine)":{[`&:hover .${xle.clearIndicator}`]:{visibility:"visible"}},[`& .${xle.tag}`]:{margin:3,maxWidth:"calc(100% - 6px)"},[`& .${xle.inputRoot}`]:{[`.${xle.hasPopupIcon}&, .${xle.hasClearIcon}&`]:{paddingRight:30},[`.${xle.hasPopupIcon}.${xle.hasClearIcon}&`]:{paddingRight:56},[`& .${xle.input}`]:{width:0,minWidth:30}},[`& .${fle.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:"4px 4px 4px 0px"}},[`& .${fle.root}.${Gre.sizeSmall}`]:{[`& .${fle.input}`]:{padding:"2px 4px 3px 0"}},[`& .${vle.root}`]:{padding:9,[`.${xle.hasPopupIcon}&, .${xle.hasClearIcon}&`]:{paddingRight:39},[`.${xle.hasPopupIcon}.${xle.hasClearIcon}&`]:{paddingRight:65},[`& .${xle.input}`]:{padding:"7.5px 4px 7.5px 5px"},[`& .${xle.endAdornment}`]:{right:9}},[`& .${vle.root}.${Gre.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${xle.input}`]:{padding:"2.5px 4px 2.5px 8px"}},[`& .${ble.root}`]:{paddingTop:19,paddingLeft:8,[`.${xle.hasPopupIcon}&, .${xle.hasClearIcon}&`]:{paddingRight:39},[`.${xle.hasPopupIcon}.${xle.hasClearIcon}&`]:{paddingRight:65},[`& .${ble.input}`]:{padding:"7px 4px"},[`& .${xle.endAdornment}`]:{right:9}},[`& .${ble.root}.${Gre.sizeSmall}`]:{paddingBottom:1,[`& .${ble.input}`]:{padding:"2.5px 4px"}},[`& .${Gre.hiddenLabel}`]:{paddingTop:8},[`& .${ble.root}.${Gre.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${xle.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${ble.root}.${Gre.hiddenLabel}.${Gre.sizeSmall}`]:{[`& .${xle.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${xle.input}`]:{flexGrow:1,textOverflow:"ellipsis",opacity:0},variants:[{props:{fullWidth:!0},style:{width:"100%"}},{props:{size:"small"},style:{[`& .${xle.tag}`]:{margin:2,maxWidth:"calc(100% - 4px)"}}},{props:{inputFocused:!0},style:{[`& .${xle.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${xle.inputRoot}`]:{flexWrap:"wrap"}}}]}),kle=x2("div",{name:"MuiAutocomplete",slot:"EndAdornment"})({position:"absolute",right:0,top:"50%",transform:"translate(0, -50%)"}),Mle=x2(Zae,{name:"MuiAutocomplete",slot:"ClearIndicator"})({marginRight:-2,padding:4,visibility:"hidden"}),Ple=x2(Zae,{name:"MuiAutocomplete",slot:"PopupIndicator",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:"rotate(180deg)"}}]}),Ile=x2(qse,{name:"MuiAutocomplete",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${xle.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(Qse(e=>{let{theme:t}=e;return{zIndex:(t.vars||t).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:"absolute"}}]}})),Ale=x2(sae,{name:"MuiAutocomplete",slot:"Paper"})(Qse(e=>{let{theme:t}=e;return{...t.typography.body1,overflow:"auto"}})),Dle=x2("div",{name:"MuiAutocomplete",slot:"Loading"})(Qse(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}})),Fle=x2("div",{name:"MuiAutocomplete",slot:"NoOptions"})(Qse(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,padding:"14px 16px"}})),Ole=x2("ul",{name:"MuiAutocomplete",slot:"Listbox"})(Qse(e=>{let{theme:t}=e;return{listStyle:"none",margin:0,padding:"8px 0",maxHeight:"40vh",overflow:"auto",position:"relative",[`& .${xle.option}`]:{minHeight:48,display:"flex",overflow:"hidden",justifyContent:"flex-start",alignItems:"center",cursor:"pointer",paddingTop:6,boxSizing:"border-box",outline:"0",WebkitTapHighlightColor:"transparent",paddingBottom:6,paddingLeft:16,paddingRight:16,[t.breakpoints.up("sm")]:{minHeight:"auto"},[`&.${xle.focused}`]:{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},'&[aria-disabled="true"]':{opacity:(t.vars||t).palette.action.disabledOpacity,pointerEvents:"none"},[`&.${xle.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:v1(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${xle.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:v1(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${xle.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:v1(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}}}}})),Nle=x2(nae,{name:"MuiAutocomplete",slot:"GroupLabel"})(Qse(e=>{let{theme:t}=e;return{backgroundColor:(t.vars||t).palette.background.paper,top:-8}})),Lle=x2("ul",{name:"MuiAutocomplete",slot:"GroupUl"})({padding:0,[`& .${xle.option}`]:{paddingLeft:24}}),_le=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiAutocomplete"}),{autoComplete:i=!1,autoHighlight:o=!1,autoSelect:s=!1,blurOnSelect:a=!1,ChipProps:l,className:c,clearIcon:u=Rle||(Rle=(0,MH.jsx)(Cle,{fontSize:"small"})),clearOnBlur:d=!r.freeSolo,clearOnEscape:h=!1,clearText:p="Clear",closeText:g="Close",componentsProps:f,defaultValue:m=(r.multiple?[]:null),disableClearable:v=!1,disableCloseOnSelect:w=!1,disabled:b=!1,disabledItemsFocusable:C=!1,disableListWrap:y=!1,disablePortal:S=!1,filterOptions:x,filterSelectedOptions:R=!1,forcePopupIcon:E="auto",freeSolo:T=!1,fullWidth:k=!1,getLimitTagsText:M=e=>`+${e}`,getOptionDisabled:P,getOptionKey:I,getOptionLabel:A,isOptionEqualToValue:D,groupBy:F,handleHomeEndKeys:O=!r.freeSolo,id:N,includeInputInList:L=!1,inputValue:_,limitTags:H=-1,ListboxComponent:V,ListboxProps:B,loading:W=!1,loadingText:z="Loading\u2026",multiple:j=!1,noOptionsText:G="No options",onChange:$,onClose:U,onHighlightChange:K,onInputChange:Y,onOpen:q,open:X,openOnFocus:Q=!1,openText:J="Open",options:Z,PaperComponent:ee,PopperComponent:te,popupIcon:ne=Ele||(Ele=(0,MH.jsx)(yle,{})),readOnly:re=!1,renderGroup:ie,renderInput:oe,renderOption:se,renderTags:ae,renderValue:le,selectOnFocus:ce=!r.freeSolo,size:ue="medium",slots:de={},slotProps:he={},value:pe,...ge}=r,{getRootProps:fe,getInputProps:me,getInputLabelProps:ve,getPopupIndicatorProps:we,getClearProps:be,getItemProps:Ce,getListboxProps:ye,getOptionProps:Se,value:xe,dirty:Re,expanded:Ee,id:Te,popupOpen:ke,focused:Me,focusedItem:Pe,anchorEl:Ie,setAnchorEl:Ae,inputValue:De,groupedOptions:Fe}=uoe({...r,componentName:"Autocomplete"}),Oe=!v&&!b&&Re&&!re,Ne=(!T||!0===E)&&!1!==E,{onMouseDown:Le}=me(),{ref:_e,...He}=ye(),Ve=A||(e=>e.label??e),Be={...r,disablePortal:S,expanded:Ee,focused:Me,fullWidth:k,getOptionLabel:Ve,hasClearIcon:Oe,hasPopupIcon:Ne,inputFocused:-1===Pe,popupOpen:ke,size:ue},We=(e=>{const{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:o,hasClearIcon:s,hasPopupIcon:a,inputFocused:l,popupOpen:c,size:u}=e;return tJ({root:["root",r&&"expanded",i&&"focused",o&&"fullWidth",s&&"hasClearIcon",a&&"hasPopupIcon"],inputRoot:["inputRoot"],input:["input",l&&"inputFocused"],tag:["tag",`tagSize${Jse(u)}`],endAdornment:["endAdornment"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",c&&"popupIndicatorOpen"],popper:["popper",n&&"popperDisablePortal"],paper:["paper"],listbox:["listbox"],loading:["loading"],noOptions:["noOptions"],option:["option"],groupLabel:["groupLabel"],groupUl:["groupUl"]},Sle,t)})(Be),ze={slots:{paper:ee,popper:te,...de},slotProps:{chip:l,listbox:B,...f,...he}},[je,Ge]=lle("listbox",{elementType:Ole,externalForwardedProps:ze,ownerState:Be,className:We.listbox,additionalProps:He,ref:_e}),[$e,Ue]=lle("paper",{elementType:sae,externalForwardedProps:ze,ownerState:Be,className:We.paper}),[Ke,Ye]=lle("popper",{elementType:qse,externalForwardedProps:ze,ownerState:Be,className:We.popper,additionalProps:{disablePortal:S,style:{width:Ie?Ie.clientWidth:null},role:"presentation",anchorEl:Ie,open:ke}});let qe;const Xe=e=>({className:We.tag,disabled:b,...Ce(e)});if(j?xe.length>0&&(qe=ae?ae(xe,Xe,Be):le?le(xe,Xe,Be):xe.map((e,t)=>{const{key:n,...r}=Xe({index:t});return(0,MH.jsx)(ple,{label:Ve(e),size:ue,...r,...ze.slotProps.chip},n)})):le&&null!=xe&&(qe=le(xe,Xe,Be)),H>-1&&Array.isArray(qe)){const e=qe.length-H;!Me&&e>0&&(qe=qe.splice(0,H),qe.push((0,MH.jsx)("span",{className:We.tag,children:M(e)},qe.length)))}const Qe=ie||(e=>(0,MH.jsxs)("li",{children:[(0,MH.jsx)(Nle,{className:We.groupLabel,ownerState:Be,component:"div",children:e.group}),(0,MH.jsx)(Lle,{className:We.groupUl,ownerState:Be,children:e.children})]},e.key)),Je=se||((e,t)=>{const{key:n,...r}=e;return(0,MH.jsx)("li",{...r,children:Ve(t)},n)}),Ze=(e,t)=>{const n=Se({option:e,index:t});return Je({...n,className:We.option},e,{selected:n["aria-selected"],index:t,inputValue:De},Be)},et=ze.slotProps.clearIndicator,tt=ze.slotProps.popupIndicator;return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(Tle,{ref:n,className:QQ(We.root,c),ownerState:Be,...fe(ge),children:oe({id:Te,disabled:b,fullWidth:!0,size:"small"===ue?"small":void 0,InputLabelProps:ve(),InputProps:{ref:Ae,className:We.inputRoot,startAdornment:qe,onMouseDown:e=>{e.target===e.currentTarget&&Le(e)},...(Oe||Ne)&&{endAdornment:(0,MH.jsxs)(kle,{className:We.endAdornment,ownerState:Be,children:[Oe?(0,MH.jsx)(Mle,{...be(),"aria-label":p,title:p,ownerState:Be,...et,className:QQ(We.clearIndicator,et?.className),children:u}):null,Ne?(0,MH.jsx)(Ple,{...we(),disabled:b,"aria-label":ke?g:J,title:ke?g:J,ownerState:Be,...tt,className:QQ(We.popupIndicator,tt?.className),children:ne}):null]})}},inputProps:{className:We.input,disabled:b,readOnly:re,...me()}})}),Ie?(0,MH.jsx)(Ile,{as:Ke,...Ye,children:(0,MH.jsxs)(Ale,{as:$e,...Ue,children:[W&&0===Fe.length?(0,MH.jsx)(Dle,{className:We.loading,ownerState:Be,children:z}):null,0!==Fe.length||T||W?null:(0,MH.jsx)(Fle,{className:We.noOptions,ownerState:Be,role:"presentation",onMouseDown:e=>{e.preventDefault()},children:G}),Fe.length>0?(0,MH.jsx)(je,{as:V,...Ge,children:Fe.map((e,t)=>F?Qe({key:e.key,group:e.group,children:e.options.map((t,n)=>Ze(t,e.index+n))}):Ze(e,t))}):null]})}):null]})}),Hle=_le;const Vle=function(e){const{badgeContent:t,invisible:n=!1,max:r=99,showZero:i=!1}=e,o=ioe({badgeContent:t,max:r});let s=n;!1!==n||0!==t||i||(s=!0);const{badgeContent:a,max:l=r}=s?o:e;return{badgeContent:a,invisible:s,max:l,displayValue:a&&Number(a)>l?`${l}+`:a}};function Ble(e){return k2("MuiBadge",e)}const Wle=M2("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),zle=x2("span",{name:"MuiBadge",slot:"Root"})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),jle=x2("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.badge,t[n.variant],t[`anchorOrigin${Jse(n.anchorOrigin.vertical)}${Jse(n.anchorOrigin.horizontal)}${Jse(n.overlap)}`],"default"!==n.color&&t[`color${Jse(n.color)}`],n.invisible&&t.invisible]}})(Qse(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:t.typography.fontFamily,fontWeight:t.typography.fontWeightMedium,fontSize:t.typography.pxToRem(12),minWidth:20,lineHeight:1,padding:"0 6px",height:20,borderRadius:10,zIndex:1,transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.enteringScreen}),variants:[...Object.entries(t.palette).filter(lae(["contrastText"])).map(e=>{let[n]=e;return{props:{color:n},style:{backgroundColor:(t.vars||t).palette[n].main,color:(t.vars||t).palette[n].contrastText}}}),{props:{variant:"dot"},style:{borderRadius:4,height:8,minWidth:8,padding:0}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"rectangular"===t.overlap},style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"right"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:e=>{let{ownerState:t}=e;return"top"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:e=>{let{ownerState:t}=e;return"bottom"===t.anchorOrigin.vertical&&"left"===t.anchorOrigin.horizontal&&"circular"===t.overlap},style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${Wle.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:t.transitions.create("transform",{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.leavingScreen})}}]}}));function Gle(e){return{vertical:e?.vertical??"top",horizontal:e?.horizontal??"right"}}const $le=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiBadge"}),{anchorOrigin:r,className:i,classes:o,component:s,components:a={},componentsProps:l={},children:c,overlap:u="rectangular",color:d="default",invisible:h=!1,max:p=99,badgeContent:g,slots:f,slotProps:m,showZero:v=!1,variant:w="standard",...b}=n,{badgeContent:C,invisible:y,max:S,displayValue:x}=Vle({max:p,invisible:h,badgeContent:g,showZero:v}),R=ioe({anchorOrigin:Gle(r),color:d,overlap:u,variant:w,badgeContent:g}),E=y||null==C&&"dot"!==w,{color:T=d,overlap:k=u,anchorOrigin:M,variant:P=w}=E?R:n,I=Gle(M),A="dot"!==P?x:void 0,D={...n,badgeContent:C,invisible:E,max:S,displayValue:A,showZero:v,anchorOrigin:I,color:T,overlap:k,variant:P},F=(e=>{const{color:t,anchorOrigin:n,invisible:r,overlap:i,variant:o,classes:s={}}=e;return tJ({root:["root"],badge:["badge",o,r&&"invisible",`anchorOrigin${Jse(n.vertical)}${Jse(n.horizontal)}`,`anchorOrigin${Jse(n.vertical)}${Jse(n.horizontal)}${Jse(i)}`,`overlap${Jse(i)}`,"default"!==t&&`color${Jse(t)}`]},Ble,s)})(D),O={slots:{root:f?.root??a.Root,badge:f?.badge??a.Badge},slotProps:{root:m?.root??l.root,badge:m?.badge??l.badge}},[N,L]=lle("root",{elementType:zle,externalForwardedProps:{...O,...b},ownerState:D,className:QQ(F.root,i),ref:t,additionalProps:{as:s}}),[_,H]=lle("badge",{elementType:jle,externalForwardedProps:O,ownerState:D,className:F.badge});return(0,MH.jsxs)(N,{...L,children:[c,(0,MH.jsx)(_,{...H,children:A})]})}),Ule=$le,Kle=roe;const Yle=t.createContext(void 0);function qle(){return t.useContext(Yle)}function Xle(e){return k2("PrivateSwitchBase",e)}M2("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Qle=x2(Lae,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:e=>{let{edge:t,ownerState:n}=e;return"start"===t&&"small"!==n.size},style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:e=>{let{edge:t,ownerState:n}=e;return"end"===t&&"small"!==n.size},style:{marginRight:-12}}]}),Jle=x2("input",{name:"MuiSwitchBase",shouldForwardProp:S2})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Zle=t.forwardRef(function(e,t){const{autoFocus:n,checked:r,checkedIcon:i,defaultChecked:o,disabled:s,disableFocusRipple:a=!1,edge:l=!1,icon:c,id:u,inputProps:d,inputRef:h,name:p,onBlur:g,onChange:f,onFocus:m,readOnly:v,required:w=!1,tabIndex:b,type:C,value:y,slots:S={},slotProps:x={},...R}=e,[E,T]=Kle({controlled:r,default:Boolean(o),name:"SwitchBase",state:"checked"}),k=qle();let M=s;k&&"undefined"===typeof M&&(M=k.disabled);const P="checkbox"===C||"radio"===C,I={...e,checked:E,disabled:M,disableFocusRipple:a,edge:l},A=(e=>{const{classes:t,checked:n,disabled:r,edge:i}=e;return tJ({root:["root",n&&"checked",r&&"disabled",i&&`edge${Jse(i)}`],input:["input"]},Xle,t)})(I),D={slots:S,slotProps:{input:d,...x}},[F,O]=lle("root",{ref:t,elementType:Qle,className:A.root,shouldForwardComponentProp:!0,externalForwardedProps:{...D,component:"span",...R},getSlotProps:e=>({...e,onFocus:t=>{e.onFocus?.(t),(e=>{m&&m(e),k&&k.onFocus&&k.onFocus(e)})(t)},onBlur:t=>{e.onBlur?.(t),(e=>{g&&g(e),k&&k.onBlur&&k.onBlur(e)})(t)}}),ownerState:I,additionalProps:{centerRipple:!0,focusRipple:!a,disabled:M,role:void 0,tabIndex:null}}),[N,L]=lle("input",{ref:h,elementType:Jle,className:A.input,externalForwardedProps:D,getSlotProps:e=>({...e,onChange:t=>{e.onChange?.(t),(e=>{if(e.nativeEvent.defaultPrevented)return;const t=e.target.checked;T(t),f&&f(e,t)})(t)}}),ownerState:I,additionalProps:{autoFocus:n,checked:r,defaultChecked:o,disabled:M,id:P?u:void 0,name:p,readOnly:v,required:w,tabIndex:b,type:C,..."checkbox"===C&&void 0===y?{}:{value:y}}});return(0,MH.jsxs)(F,{...O,children:[(0,MH.jsx)(N,{...L}),E?i:c]})}),ece=Zle,tce=ile((0,MH.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"})),nce=ile((0,MH.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})),rce=ile((0,MH.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}));function ice(e){return k2("MuiCheckbox",e)}const oce=M2("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]);function sce(e,t){if(!e)return t;function n(e,t){const n={};return Object.keys(t).forEach(r=>{(function(e,t){const n=e.charCodeAt(2);return"o"===e[0]&&"n"===e[1]&&n>=65&&n<=90&&"function"===typeof t})(r,t[r])&&"function"===typeof e[r]&&(n[r]=function(){e[r](...arguments),t[r](...arguments)})}),n}if("function"===typeof e||"function"===typeof t)return r=>{const i="function"===typeof t?t(r):t,o="function"===typeof e?e({...r,...i}):e,s=QQ(r?.className,i?.className,o?.className),a=n(o,i);return{...i,...o,...a,...!!s&&{className:s},...i?.style&&o?.style&&{style:{...i.style,...o.style}},...i?.sx&&o?.sx&&{sx:[...Array.isArray(i.sx)?i.sx:[i.sx],...Array.isArray(o.sx)?o.sx:[o.sx]]}}};const r=t,i=n(e,r),o=QQ(r?.className,e?.className);return{...t,...e,...i,...!!o&&{className:o},...r?.style&&e?.style&&{style:{...r.style,...e.style}},...r?.sx&&e?.sx&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(e.sx)?e.sx:[e.sx]]}}}const ace=x2(ece,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${Jse(n.size)}`],"default"!==n.color&&t[`color${Jse(n.color)}`]]}})(Qse(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,variants:[{props:{color:"default",disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette.action.active,t.palette.action.hoverOpacity)}}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n,disableRipple:!1},style:{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette[n].main,t.palette.action.hoverOpacity)}}}}),...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{[`&.${oce.checked}, &.${oce.indeterminate}`]:{color:(t.vars||t).palette[n].main},[`&.${oce.disabled}`]:{color:(t.vars||t).palette.action.disabled}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}})),lce=(0,MH.jsx)(nce,{}),cce=(0,MH.jsx)(tce,{}),uce=(0,MH.jsx)(rce,{}),dce=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiCheckbox"}),{checkedIcon:i=lce,color:o="primary",icon:s=cce,indeterminate:a=!1,indeterminateIcon:l=uce,inputProps:c,size:u="medium",disableRipple:d=!1,className:h,slots:p={},slotProps:g={},...f}=r,m=a?l:s,v=a?l:i,w={...r,disableRipple:d,color:o,indeterminate:a,size:u},b=(e=>{const{classes:t,indeterminate:n,color:r,size:i}=e,o=tJ({root:["root",n&&"indeterminate",`color${Jse(r)}`,`size${Jse(i)}`]},ice,t);return{...t,...o}})(w),C=g.input??c,[y,S]=lle("root",{ref:n,elementType:ace,className:QQ(b.root,h),shouldForwardComponentProp:!0,externalForwardedProps:{slots:p,slotProps:g,...f},ownerState:w,additionalProps:{type:"checkbox",icon:t.cloneElement(m,{fontSize:m.props.fontSize??u}),checkedIcon:t.cloneElement(v,{fontSize:v.props.fontSize??u}),disableRipple:d,slots:p,slotProps:{input:sce("function"===typeof C?C(w):C,{"data-indeterminate":a})}}});return(0,MH.jsx)(y,{...S,classes:b})}),hce=dce;function pce(e){return k2("MuiDivider",e)}const gce=M2("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),fce=x2("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.absolute&&t.absolute,t[n.variant],n.light&&t.light,"vertical"===n.orientation&&t.vertical,n.flexItem&&t.flexItem,n.children&&t.withChildren,n.children&&"vertical"===n.orientation&&t.withChildrenVertical,"right"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignRight,"left"===n.textAlign&&"vertical"!==n.orientation&&t.textAlignLeft]}})(Qse(e=>{let{theme:t}=e;return{margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(t.vars||t).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:t.vars?`rgba(${t.vars.palette.dividerChannel} / 0.08)`:v1(t.palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:t.spacing(2),marginRight:t.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:t.spacing(1),marginBottom:t.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:e=>{let{ownerState:t}=e;return!!t.children},style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:e=>{let{ownerState:t}=e;return t.children&&"vertical"!==t.orientation},style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(t.vars||t).palette.divider}`,borderTopStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"vertical"===t.orientation&&t.children},style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(t.vars||t).palette.divider}`,borderLeftStyle:"inherit"}}},{props:e=>{let{ownerState:t}=e;return"right"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:e=>{let{ownerState:t}=e;return"left"===t.textAlign&&"vertical"!==t.orientation},style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}})),mce=x2("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.wrapper,"vertical"===n.orientation&&t.wrapperVertical]}})(Qse(e=>{let{theme:t}=e;return{display:"inline-block",paddingLeft:`calc(${t.spacing(1)} * 1.2)`,paddingRight:`calc(${t.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${t.spacing(1)} * 1.2)`,paddingBottom:`calc(${t.spacing(1)} * 1.2)`}}]}})),vce=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiDivider"}),{absolute:r=!1,children:i,className:o,orientation:s="horizontal",component:a=(i||"vertical"===s?"div":"hr"),flexItem:l=!1,light:c=!1,role:u=("hr"!==a?"separator":void 0),textAlign:d="center",variant:h="fullWidth",...p}=n,g={...n,absolute:r,component:a,flexItem:l,light:c,orientation:s,role:u,textAlign:d,variant:h},f=(e=>{const{absolute:t,children:n,classes:r,flexItem:i,light:o,orientation:s,textAlign:a,variant:l}=e;return tJ({root:["root",t&&"absolute",l,o&&"light","vertical"===s&&"vertical",i&&"flexItem",n&&"withChildren",n&&"vertical"===s&&"withChildrenVertical","right"===a&&"vertical"!==s&&"textAlignRight","left"===a&&"vertical"!==s&&"textAlignLeft"],wrapper:["wrapper","vertical"===s&&"wrapperVertical"]},pce,r)})(g);return(0,MH.jsx)(fce,{as:a,className:QQ(f.root,o),role:u,ref:t,ownerState:g,"aria-orientation":"separator"!==u||"hr"===a&&"vertical"!==s?void 0:s,...p,children:i?(0,MH.jsx)(mce,{className:f.wrapper,ownerState:g,children:i}):null})});vce&&(vce.muiSkipListHighlight=!0);const wce=vce;function bce(e){return Iee(e).defaultView||window}function Cce(e){return parseInt(e,10)||0}const yce={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function Sce(e){return function(e){for(const t in e)return!1;return!0}(e)||0===e.outerHeightStyle&&!e.overflowing}const xce=t.forwardRef(function(e,n){const{onChange:r,maxRows:i,minRows:o=1,style:s,value:a,...l}=e,{current:c}=t.useRef(null!=a),u=t.useRef(null),d=JQ(n,u),h=t.useRef(null),p=t.useRef(null),g=t.useCallback(()=>{const t=u.current,n=p.current;if(!t||!n)return;const r=bce(t).getComputedStyle(t);if("0px"===r.width)return{outerHeightStyle:0,overflowing:!1};n.style.width=r.width,n.value=t.value||e.placeholder||"x","\n"===n.value.slice(-1)&&(n.value+=" ");const s=r.boxSizing,a=Cce(r.paddingBottom)+Cce(r.paddingTop),l=Cce(r.borderBottomWidth)+Cce(r.borderTopWidth),c=n.scrollHeight;n.value="x";const d=n.scrollHeight;let h=c;o&&(h=Math.max(Number(o)*d,h)),i&&(h=Math.min(Number(i)*d,h)),h=Math.max(h,d);return{outerHeightStyle:h+("border-box"===s?a+l:0),overflowing:Math.abs(h-c)<=1}},[i,o,e.placeholder]),f=w4(()=>{const e=u.current,t=g();if(!e||!t||Sce(t))return!1;const n=t.outerHeightStyle;return null!=h.current&&h.current!==n}),m=t.useCallback(()=>{const e=u.current,t=g();if(!e||!t||Sce(t))return;const n=t.outerHeightStyle;h.current!==n&&(h.current=n,e.style.height=`${n}px`),e.style.overflow=t.overflowing?"hidden":""},[g]),v=t.useRef(-1);v4(()=>{const e=cne(m),t=u?.current;if(!t)return;const n=bce(t);let r;return n.addEventListener("resize",e),"undefined"!==typeof ResizeObserver&&(r=new ResizeObserver(()=>{f()&&(r.unobserve(t),cancelAnimationFrame(v.current),m(),v.current=requestAnimationFrame(()=>{r.observe(t)}))}),r.observe(t)),()=>{e.clear(),cancelAnimationFrame(v.current),n.removeEventListener("resize",e),r&&r.disconnect()}},[g,m,f]),v4(()=>{m()});return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)("textarea",{value:a,onChange:e=>{c||m();const t=e.target,n=t.value.length,i=t.value.endsWith("\n"),o=t.selectionStart===n;i&&o&&t.setSelectionRange(n,n),r&&r(e)},ref:d,rows:o,style:s,...l}),(0,MH.jsx)("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:p,tabIndex:-1,style:{...yce,...s,paddingTop:0,paddingBottom:0}})]})}),Rce=xce;const Ece=function(e){return"string"===typeof e};function Tce(e){let{props:t,states:n,muiFormControl:r}=e;return n.reduce((e,n)=>(e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e),{})}function kce(e){const{sx:t,...n}=e,{systemProps:r,otherProps:i}=(e=>{const t={systemProps:{},otherProps:{}},n=e?.theme?.unstable_sxConfig??q0;return Object.keys(e).forEach(r=>{n[r]?t.systemProps[r]=e[r]:t.otherProps[r]=e[r]}),t})(n);let o;return o=Array.isArray(t)?[r,...t]:"function"===typeof t?function(){const e=t(...arguments);return GZ(e)?{...r,...e}:r}:{...r,...t},{...i,sx:o}}function Mce(e){const{styles:t,defaultTheme:n={}}=e,r="function"===typeof t?e=>{return t(void 0===(r=e)||null===r||0===Object.keys(r).length?n:e);var r}:t;return(0,MH.jsx)(Kre,{styles:r})}function Pce(e){const t=zZ(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles=`@layer global{${t.styles}}`),t):e}const Ice=function(e){let{styles:t,themeId:n,defaultTheme:r={}}=e;const i=xne(r),o=n&&i[n]||i;let s="function"===typeof t?t(o):t;return o.modularCssLayers&&(s=Array.isArray(s)?s.map(e=>Pce("function"===typeof e?e(o):e)):Pce(s)),(0,MH.jsx)(Mce,{styles:s})};const Ace=function(e){return(0,MH.jsx)(Ice,{...e,defaultTheme:b2,themeId:C2})};const Dce=v4;function Fce(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function Oce(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(Fce(e.value)&&""!==e.value||t&&Fce(e.defaultValue)&&""!==e.defaultValue)}var Nce;const Lce=(e,t)=>{const{ownerState:n}=e;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t[`color${Jse(n.color)}`],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},_ce=(e,t)=>{const{ownerState:n}=e;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},Hce=x2("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Lce})(Qse(e=>{let{theme:t}=e;return{...t.typography.body1,color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${Gre.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"},variants:[{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"4px 0 5px"}},{props:e=>{let{ownerState:t,size:n}=e;return t.multiline&&"small"===n},style:{paddingTop:1}},{props:e=>{let{ownerState:t}=e;return t.fullWidth},style:{width:"100%"}}]}})),Vce=x2("input",{name:"MuiInputBase",slot:"Input",overridesResolver:_ce})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode,r={color:"currentColor",...t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})},i={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&::-ms-input-placeholder":r,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${Gre.formControl} &`]:{"&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&::-ms-input-placeholder":i,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${Gre.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableInjectingGlobalStyles},style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),Bce=function(e){return function(t){return(0,MH.jsx)(Ace,{styles:"function"===typeof e?n=>e({theme:n,...t}):e})}}({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),Wce=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiInputBase"}),{"aria-describedby":i,autoComplete:o,autoFocus:s,className:a,color:l,components:c={},componentsProps:u={},defaultValue:d,disabled:h,disableInjectingGlobalStyles:p,endAdornment:g,error:f,fullWidth:m=!1,id:v,inputComponent:w="input",inputProps:b={},inputRef:C,margin:y,maxRows:S,minRows:x,multiline:R=!1,name:E,onBlur:T,onChange:k,onClick:M,onFocus:P,onKeyDown:I,onKeyUp:A,placeholder:D,readOnly:F,renderSuffix:O,rows:N,size:L,slotProps:_={},slots:H={},startAdornment:V,type:B="text",value:W,...z}=r,j=null!=b.value?b.value:W,{current:G}=t.useRef(null!=j),$=t.useRef(),U=t.useCallback(e=>{0},[]),K=uae($,C,b.ref,U),[Y,q]=t.useState(!1),X=qle();const Q=Tce({props:r,muiFormControl:X,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Q.focused=X?X.focused:Y,t.useEffect(()=>{!X&&h&&Y&&(q(!1),T&&T())},[X,h,Y,T]);const J=X&&X.onFilled,Z=X&&X.onEmpty,ee=t.useCallback(e=>{Oce(e)?J&&J():Z&&Z()},[J,Z]);Dce(()=>{G&&ee({value:j})},[j,ee,G]);t.useEffect(()=>{ee($.current)},[]);let te=w,ne=b;R&&"input"===te&&(ne=N?{type:void 0,minRows:N,maxRows:N,...ne}:{type:void 0,maxRows:S,minRows:x,...ne},te=Rce);t.useEffect(()=>{X&&X.setAdornedStart(Boolean(V))},[X,V]);const re={...r,color:Q.color||"primary",disabled:Q.disabled,endAdornment:g,error:Q.error,focused:Q.focused,formControl:X,fullWidth:m,hiddenLabel:Q.hiddenLabel,multiline:R,size:Q.size,startAdornment:V,type:B},ie=(e=>{const{classes:t,color:n,disabled:r,error:i,endAdornment:o,focused:s,formControl:a,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:d,size:h,startAdornment:p,type:g}=e;return tJ({root:["root",`color${Jse(n)}`,r&&"disabled",i&&"error",l&&"fullWidth",s&&"focused",a&&"formControl",h&&"medium"!==h&&`size${Jse(h)}`,u&&"multiline",p&&"adornedStart",o&&"adornedEnd",c&&"hiddenLabel",d&&"readOnly"],input:["input",r&&"disabled","search"===g&&"inputTypeSearch",u&&"inputMultiline","small"===h&&"inputSizeSmall",c&&"inputHiddenLabel",p&&"inputAdornedStart",o&&"inputAdornedEnd",d&&"readOnly"]},jre,t)})(re),oe=H.root||c.Root||Hce,se=_.root||u.root||{},ae=H.input||c.Input||Vce;return ne={...ne,..._.input??u.input},(0,MH.jsxs)(t.Fragment,{children:[!p&&"function"===typeof Bce&&(Nce||(Nce=(0,MH.jsx)(Bce,{}))),(0,MH.jsxs)(oe,{...se,ref:n,onClick:e=>{$.current&&e.currentTarget===e.target&&$.current.focus(),M&&M(e)},...z,...!Ece(oe)&&{ownerState:{...re,...se.ownerState}},className:QQ(ie.root,se.className,a,F&&"MuiInputBase-readOnly"),children:[V,(0,MH.jsx)(Yle.Provider,{value:null,children:(0,MH.jsx)(ae,{"aria-invalid":Q.error,"aria-describedby":i,autoComplete:o,autoFocus:s,defaultValue:d,disabled:Q.disabled,id:v,onAnimationStart:e=>{ee("mui-auto-fill-cancel"===e.animationName?$.current:{value:"x"})},name:E,placeholder:D,readOnly:F,required:Q.required,rows:N,value:j,onKeyDown:I,onKeyUp:A,type:B,...ne,...!Ece(ae)&&{as:te,ownerState:{...re,...ne.ownerState}},ref:K,className:QQ(ie.input,ne.className,F&&"MuiInputBase-readOnly"),onBlur:e=>{T&&T(e),b.onBlur&&b.onBlur(e),X&&X.onBlur?X.onBlur(e):q(!1)},onChange:function(e){if(!G){const t=e.target||$.current;if(null==t)throw new Error(ZQ(1));ee({value:t.value})}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];b.onChange&&b.onChange(e,...n),k&&k(e,...n)},onFocus:e=>{P&&P(e),b.onFocus&&b.onFocus(e),X&&X.onFocus?X.onFocus(e):q(!0)}})}),g,O?O({...Q,startAdornment:V}):null]})]})}),zce=Wce,jce=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Gce(e){const t=[],n=[];return Array.from(e.querySelectorAll(jce)).forEach((e,r)=>{const i=function(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?"true"===e.contentEditable||("AUDIO"===e.nodeName||"VIDEO"===e.nodeName||"DETAILS"===e.nodeName)&&null===e.getAttribute("tabindex")?0:e.tabIndex:t}(e);-1!==i&&function(e){return!(e.disabled||"INPUT"===e.tagName&&"hidden"===e.type||function(e){if("INPUT"!==e.tagName||"radio"!==e.type)return!1;if(!e.name)return!1;const t=t=>e.ownerDocument.querySelector(`input[type="radio"]${t}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}(e))}(e)&&(0===i?t.push(e):n.push({documentOrder:r,tabIndex:i,node:e}))}),n.sort((e,t)=>e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex).map(e=>e.node).concat(t)}function $ce(){return!0}const Uce=function(e){const{children:n,disableAutoFocus:r=!1,disableEnforceFocus:i=!1,disableRestoreFocus:o=!1,getTabbable:s=Gce,isEnabled:a=$ce,open:l}=e,c=t.useRef(!1),u=t.useRef(null),d=t.useRef(null),h=t.useRef(null),p=t.useRef(null),g=t.useRef(!1),f=t.useRef(null),m=JQ(Nse(n),f),v=t.useRef(null);t.useEffect(()=>{l&&f.current&&(g.current=!r)},[r,l]),t.useEffect(()=>{if(!l||!f.current)return;const e=Iee(f.current);return f.current.contains(e.activeElement)||(f.current.hasAttribute("tabIndex")||f.current.setAttribute("tabIndex","-1"),g.current&&f.current.focus()),()=>{o||(h.current&&h.current.focus&&(c.current=!0,h.current.focus()),h.current=null)}},[l]),t.useEffect(()=>{if(!l||!f.current)return;const e=Iee(f.current),t=t=>{v.current=t,!i&&a()&&"Tab"===t.key&&e.activeElement===f.current&&t.shiftKey&&(c.current=!0,d.current&&d.current.focus())},n=()=>{const t=f.current;if(null===t)return;if(!e.hasFocus()||!a()||c.current)return void(c.current=!1);if(t.contains(e.activeElement))return;if(i&&e.activeElement!==u.current&&e.activeElement!==d.current)return;if(e.activeElement!==p.current)p.current=null;else if(null!==p.current)return;if(!g.current)return;let n=[];if(e.activeElement!==u.current&&e.activeElement!==d.current||(n=s(f.current)),n.length>0){const e=Boolean(v.current?.shiftKey&&"Tab"===v.current?.key),t=n[0],r=n[n.length-1];"string"!==typeof t&&"string"!==typeof r&&(e?r.focus():t.focus())}else t.focus()};e.addEventListener("focusin",n),e.addEventListener("keydown",t,!0);const r=setInterval(()=>{e.activeElement&&"BODY"===e.activeElement.tagName&&n()},50);return()=>{clearInterval(r),e.removeEventListener("focusin",n),e.removeEventListener("keydown",t,!0)}},[r,i,o,a,l,s]);const w=e=>{null===h.current&&(h.current=e.relatedTarget),g.current=!0};return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)("div",{tabIndex:l?0:-1,onFocus:w,ref:u,"data-testid":"sentinelStart"}),t.cloneElement(n,{ref:m,onFocus:e=>{null===h.current&&(h.current=e.relatedTarget),g.current=!0,p.current=e.target;const t=n.props.onFocus;t&&t(e)}}),(0,MH.jsx)("div",{tabIndex:l?0:-1,onFocus:w,ref:d,"data-testid":"sentinelEnd"})]})};function Kce(e){return k2("MuiLinearProgress",e)}M2("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const Yce=qre`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,qce="string"!==typeof Yce?Yre`
        animation: ${Yce} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,Xce=qre`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,Qce="string"!==typeof Xce?Yre`
        animation: ${Xce} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,Jce=qre`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,Zce="string"!==typeof Jce?Yre`
        animation: ${Jce} 3s infinite linear;
      `:null,eue=(e,t)=>e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:"light"===e.palette.mode?y1(e.palette[t].main,.62):b1(e.palette[t].main,.5),tue=x2("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${Jse(n.color)}`],t[n.variant]]}})(Qse(e=>{let{theme:t}=e;return{position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{backgroundColor:eue(t,n)}}}),{props:e=>{let{ownerState:t}=e;return"inherit"===t.color&&"buffer"!==t.variant},style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}})),nue=x2("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.dashed,t[`dashedColor${Jse(n.color)}`]]}})(Qse(e=>{let{theme:t}=e;return{position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;const r=eue(t,n);return{props:{color:n},style:{backgroundImage:`radial-gradient(${r} 0%, ${r} 16%, transparent 42%)`}}})]}}),Zce||{animation:`${Jce} 3s infinite linear`}),rue=x2("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t.bar1,t[`barColor${Jse(n.color)}`],("indeterminate"===n.variant||"query"===n.variant)&&t.bar1Indeterminate,"determinate"===n.variant&&t.bar1Determinate,"buffer"===n.variant&&t.bar1Buffer]}})(Qse(e=>{let{theme:t}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{backgroundColor:(t.vars||t).palette[n].main}}}),{props:{variant:"determinate"},style:{transition:"transform .4s linear"}},{props:{variant:"buffer"},style:{zIndex:1,transition:"transform .4s linear"}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:{width:"auto"}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:qce||{animation:`${Yce} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}})),iue=x2("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t.bar2,t[`barColor${Jse(n.color)}`],("indeterminate"===n.variant||"query"===n.variant)&&t.bar2Indeterminate,"buffer"===n.variant&&t.bar2Buffer]}})(Qse(e=>{let{theme:t}=e;return{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{"--LinearProgressBar2-barColor":(t.vars||t).palette[n].main}}}),{props:e=>{let{ownerState:t}=e;return"buffer"!==t.variant&&"inherit"!==t.color},style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:e=>{let{ownerState:t}=e;return"buffer"!==t.variant&&"inherit"===t.color},style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n,variant:"buffer"},style:{backgroundColor:eue(t,n),transition:"transform .4s linear"}}}),{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:{width:"auto"}},{props:e=>{let{ownerState:t}=e;return"indeterminate"===t.variant||"query"===t.variant},style:Qce||{animation:`${Xce} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}})),oue=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiLinearProgress"}),{className:r,color:i="primary",value:o,valueBuffer:s,variant:a="indeterminate",...l}=n,c={...n,color:i,variant:a},u=(e=>{const{classes:t,variant:n,color:r}=e;return tJ({root:["root",`color${Jse(r)}`,n],dashed:["dashed",`dashedColor${Jse(r)}`],bar1:["bar","bar1",`barColor${Jse(r)}`,("indeterminate"===n||"query"===n)&&"bar1Indeterminate","determinate"===n&&"bar1Determinate","buffer"===n&&"bar1Buffer"],bar2:["bar","bar2","buffer"!==n&&`barColor${Jse(r)}`,"buffer"===n&&`color${Jse(r)}`,("indeterminate"===n||"query"===n)&&"bar2Indeterminate","buffer"===n&&"bar2Buffer"]},Kce,t)})(c),d=z6(),h={},p={bar1:{},bar2:{}};if("determinate"===a||"buffer"===a)if(void 0!==o){h["aria-valuenow"]=Math.round(o),h["aria-valuemin"]=0,h["aria-valuemax"]=100;let e=o-100;d&&(e=-e),p.bar1.transform=`translateX(${e}%)`}else 0;if("buffer"===a)if(void 0!==s){let e=(s||0)-100;d&&(e=-e),p.bar2.transform=`translateX(${e}%)`}else 0;return(0,MH.jsxs)(tue,{className:QQ(u.root,r),ownerState:c,role:"progressbar",...h,ref:t,...l,children:["buffer"===a?(0,MH.jsx)(nue,{className:u.dashed,ownerState:c}):null,(0,MH.jsx)(rue,{className:u.bar1,ownerState:c,style:p.bar1}),"determinate"===a?null:(0,MH.jsx)(iue,{className:u.bar2,ownerState:c,style:p.bar2})]})}),sue=oue;function aue(e){return k2("MuiListItemIcon",e)}const lue=M2("MuiListItemIcon",["root","alignItemsFlexStart"]);const cue=t.createContext({}),uue=x2("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"flex-start"===n.alignItems&&t.alignItemsFlexStart]}})(Qse(e=>{let{theme:t}=e;return{minWidth:56,color:(t.vars||t).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}})),due=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiListItemIcon"}),{className:i,...o}=r,s=t.useContext(cue),a={...r,alignItems:s.alignItems},l=(e=>{const{alignItems:t,classes:n}=e;return tJ({root:["root","flex-start"===t&&"alignItemsFlexStart"]},aue,n)})(a);return(0,MH.jsx)(uue,{className:QQ(l.root,i),ownerState:a,ref:n,...o})}),hue=due;function pue(e){return k2("MuiTypography",e)}const gue=M2("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),fue={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},mue=kce,vue=x2("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],"inherit"!==n.align&&t[`align${Jse(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(Qse(e=>{let{theme:t}=e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(e=>{let[t,n]=e;return"inherit"!==t&&n&&"object"===typeof n}).map(e=>{let[t,n]=e;return{props:{variant:t},style:n}}),...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{color:(t.vars||t).palette[n].main}}}),...Object.entries(t.palette?.text||{}).filter(e=>{let[,t]=e;return"string"===typeof t}).map(e=>{let[n]=e;return{props:{color:`text${Jse(n)}`},style:{color:(t.vars||t).palette.text[n]}}}),{props:e=>{let{ownerState:t}=e;return"inherit"!==t.align},style:{textAlign:"var(--Typography-textAlign)"}},{props:e=>{let{ownerState:t}=e;return t.noWrap},style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:e=>{let{ownerState:t}=e;return t.gutterBottom},style:{marginBottom:"0.35em"}},{props:e=>{let{ownerState:t}=e;return t.paragraph},style:{marginBottom:16}}]}})),wue={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},bue=t.forwardRef(function(e,t){const{color:n,...r}=Use({props:e,name:"MuiTypography"}),i=mue({...r,...!fue[n]&&{color:n}}),{align:o="inherit",className:s,component:a,gutterBottom:l=!1,noWrap:c=!1,paragraph:u=!1,variant:d="body1",variantMapping:h=wue,...p}=i,g={...i,align:o,color:n,className:s,component:a,gutterBottom:l,noWrap:c,paragraph:u,variant:d,variantMapping:h},f=a||(u?"p":h[d]||wue[d])||"span",m=(e=>{const{align:t,gutterBottom:n,noWrap:r,paragraph:i,variant:o,classes:s}=e;return tJ({root:["root",o,"inherit"!==e.align&&`align${Jse(t)}`,n&&"gutterBottom",r&&"noWrap",i&&"paragraph"]},pue,s)})(g);return(0,MH.jsx)(vue,{as:f,ref:t,className:QQ(m.root,s),...p,ownerState:g,style:{..."inherit"!==o&&{"--Typography-textAlign":o},...p.style}})}),Cue=bue;function yue(e){return k2("MuiListItemText",e)}const Sue=M2("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),xue=x2("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${Sue.primary}`]:t.primary},{[`& .${Sue.secondary}`]:t.secondary},t.root,n.inset&&t.inset,n.primary&&n.secondary&&t.multiline,n.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${gue.root}:where(& .${Sue.primary})`]:{display:"block"},[`.${gue.root}:where(& .${Sue.secondary})`]:{display:"block"},variants:[{props:e=>{let{ownerState:t}=e;return t.primary&&t.secondary},style:{marginTop:6,marginBottom:6}},{props:e=>{let{ownerState:t}=e;return t.inset},style:{paddingLeft:56}}]}),Rue=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiListItemText"}),{children:i,className:o,disableTypography:s=!1,inset:a=!1,primary:l,primaryTypographyProps:c,secondary:u,secondaryTypographyProps:d,slots:h={},slotProps:p={},...g}=r,{dense:f}=t.useContext(cue);let m=null!=l?l:i,v=u;const w={...r,disableTypography:s,inset:a,primary:!!m,secondary:!!v,dense:f},b=(e=>{const{classes:t,inset:n,primary:r,secondary:i,dense:o}=e;return tJ({root:["root",n&&"inset",o&&"dense",r&&i&&"multiline"],primary:["primary"],secondary:["secondary"]},yue,t)})(w),C={slots:h,slotProps:{primary:c,secondary:d,...p}},[y,S]=lle("root",{className:QQ(b.root,o),elementType:xue,externalForwardedProps:{...C,...g},ownerState:w,ref:n}),[x,R]=lle("primary",{className:b.primary,elementType:Cue,externalForwardedProps:C,ownerState:w}),[E,T]=lle("secondary",{className:b.secondary,elementType:Cue,externalForwardedProps:C,ownerState:w});return null==m||m.type===Cue||s||(m=(0,MH.jsx)(x,{variant:f?"body2":"body1",component:R?.variant?void 0:"span",...R,children:m})),null==v||v.type===Cue||s||(v=(0,MH.jsx)(E,{variant:"body2",color:"textSecondary",...T,children:v})),(0,MH.jsxs)(y,{...S,children:[m,v]})}),Eue=Rue,Tue=Iee;function kue(e){return k2("MuiList",e)}M2("MuiList",["root","padding","dense","subheader"]);const Mue=x2("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disablePadding&&t.padding,n.dense&&t.dense,n.subheader&&t.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:e=>{let{ownerState:t}=e;return!t.disablePadding},style:{paddingTop:8,paddingBottom:8}},{props:e=>{let{ownerState:t}=e;return t.subheader},style:{paddingTop:0}}]}),Pue=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiList"}),{children:i,className:o,component:s="ul",dense:a=!1,disablePadding:l=!1,subheader:c,...u}=r,d=t.useMemo(()=>({dense:a}),[a]),h={...r,component:s,dense:a,disablePadding:l},p=(e=>{const{classes:t,disablePadding:n,dense:r,subheader:i}=e;return tJ({root:["root",!n&&"padding",r&&"dense",i&&"subheader"]},kue,t)})(h);return(0,MH.jsx)(cue.Provider,{value:d,children:(0,MH.jsxs)(Mue,{as:s,className:QQ(p.root,o),ref:n,ownerState:h,...u,children:[c,i]})})}),Iue=Pue;function Aue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;const t=e.document.documentElement.clientWidth;return e.innerWidth-t}const Due=Aue,Fue=bce;function Oue(e,t,n){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:n?null:e.firstChild}function Nue(e,t,n){return e===t?n?e.firstChild:e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:n?null:e.lastChild}function Lue(e,t){if(void 0===t)return!0;let n=e.innerText;return void 0===n&&(n=e.textContent),n=n.trim().toLowerCase(),0!==n.length&&(t.repeating?n[0]===t.keys[0]:n.startsWith(t.keys.join("")))}function _ue(e,t,n,r,i,o){let s=!1,a=i(e,t,!!t&&n);for(;a;){if(a===e.firstChild){if(s)return!1;s=!0}const t=!r&&(a.disabled||"true"===a.getAttribute("aria-disabled"));if(a.hasAttribute("tabindex")&&Lue(a,o)&&!t)return a.focus(),!0;a=i(e,a,n)}return!1}const Hue=t.forwardRef(function(e,n){const{actions:r,autoFocus:i=!1,autoFocusItem:o=!1,children:s,className:a,disabledItemsFocusable:l=!1,disableListWrap:c=!1,onKeyDown:u,variant:d="selectedMenu",...h}=e,p=t.useRef(null),g=t.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Dce(()=>{i&&p.current.focus()},[i]),t.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(e,t)=>{let{direction:n}=t;const r=!p.current.style.width;if(e.clientHeight<p.current.clientHeight&&r){const t=`${Due(Fue(e))}px`;p.current.style["rtl"===n?"paddingLeft":"paddingRight"]=t,p.current.style.width=`calc(100% + ${t})`}return p.current}}),[]);const f=uae(p,n);let m=-1;t.Children.forEach(s,(e,n)=>{t.isValidElement(e)?(e.props.disabled||("selectedMenu"===d&&e.props.selected||-1===m)&&(m=n),m===n&&(e.props.disabled||e.props.muiSkipListHighlight||e.type.muiSkipListHighlight)&&(m+=1,m>=s.length&&(m=-1))):m===n&&(m+=1,m>=s.length&&(m=-1))});const v=t.Children.map(s,(e,n)=>{if(n===m){const n={};return o&&(n.autoFocus=!0),void 0===e.props.tabIndex&&"selectedMenu"===d&&(n.tabIndex=0),t.cloneElement(e,n)}return e});return(0,MH.jsx)(Iue,{role:"menu",ref:f,className:a,onKeyDown:e=>{const t=p.current,n=e.key;if(e.ctrlKey||e.metaKey||e.altKey)return void(u&&u(e));const r=Tue(t).activeElement;if("ArrowDown"===n)e.preventDefault(),_ue(t,r,c,l,Oue);else if("ArrowUp"===n)e.preventDefault(),_ue(t,r,c,l,Nue);else if("Home"===n)e.preventDefault(),_ue(t,null,c,l,Oue);else if("End"===n)e.preventDefault(),_ue(t,null,c,l,Nue);else if(1===n.length){const i=g.current,o=n.toLowerCase(),s=performance.now();i.keys.length>0&&(s-i.lastTime>500?(i.keys=[],i.repeating=!0,i.previousKeyMatched=!0):i.repeating&&o!==i.keys[0]&&(i.repeating=!1)),i.lastTime=s,i.keys.push(o);const a=r&&!i.repeating&&Lue(r,i);i.previousKeyMatched&&(a||_ue(t,r,!1,l,Oue,i))?e.preventDefault():i.previousKeyMatched=!1}u&&u(e)},tabIndex:i?0:-1,...h,children:v})}),Vue=Hue;function Bue(e){return k2("MuiMenuItem",e)}const Wue=M2("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),zue=x2(Lae,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiMenuItem",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.divider&&t.divider,!n.disableGutters&&t.gutters]}})(Qse(e=>{let{theme:t}=e;return{...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Wue.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:v1(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${Wue.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:v1(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${Wue.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:v1(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:v1(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${Wue.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Wue.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${gce.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${gce.inset}`]:{marginLeft:52},[`& .${Sue.root}`]:{marginTop:0,marginBottom:0},[`& .${Sue.inset}`]:{paddingLeft:36},[`& .${lue.root}`]:{minWidth:36},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:16,paddingRight:16}},{props:e=>{let{ownerState:t}=e;return t.divider},style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:e=>{let{ownerState:t}=e;return!t.dense},style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:e=>{let{ownerState:t}=e;return t.dense},style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${lue.root} svg`]:{fontSize:"1.25rem"}}}]}})),jue=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiMenuItem"}),{autoFocus:i=!1,component:o="li",dense:s=!1,divider:a=!1,disableGutters:l=!1,focusVisibleClassName:c,role:u="menuitem",tabIndex:d,className:h,...p}=r,g=t.useContext(cue),f=t.useMemo(()=>({dense:s||g.dense||!1,disableGutters:l}),[g.dense,s,l]),m=t.useRef(null);Dce(()=>{i&&m.current&&m.current.focus()},[i]);const v={...r,dense:f.dense,divider:a,disableGutters:l},w=(e=>{const{disabled:t,dense:n,divider:r,disableGutters:i,selected:o,classes:s}=e,a=tJ({root:["root",n&&"dense",t&&"disabled",!i&&"gutters",r&&"divider",o&&"selected"]},Bue,s);return{...s,...a}})(r),b=uae(m,n);let C;return r.disabled||(C=void 0!==d?d:-1),(0,MH.jsx)(cue.Provider,{value:f,children:(0,MH.jsx)(zue,{ref:b,role:u,tabIndex:C,component:o,focusVisibleClassName:QQ(w.focusVisible,c),className:QQ(w.root,h),...p,ownerState:v,classes:w})})}),Gue=jue,$ue=x2(Hce,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...Lce(e,t),!n.disableUnderline&&t.underline]}})(Qse(e=>{let{theme:t}=e;let n="light"===t.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(n=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),{position:"relative",variants:[{props:e=>{let{ownerState:t}=e;return t.formControl},style:{"label + &":{marginTop:16}}},{props:e=>{let{ownerState:t}=e;return!t.disableUnderline},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${fle.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${fle.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${n}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${fle.disabled}, .${fle.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${n}`}},[`&.${fle.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n].main}`}}}})]}})),Uue=x2(Vce,{name:"MuiInput",slot:"Input",overridesResolver:_ce})({}),Kue=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiInput"}),{disableUnderline:r=!1,components:i={},componentsProps:o,fullWidth:s=!1,inputComponent:a="input",multiline:l=!1,slotProps:c,slots:u={},type:d="text",...h}=n,p=(e=>{const{classes:t,disableUnderline:n}=e,r=tJ({root:["root",!n&&"underline"],input:["input"]},gle,t);return{...t,...r}})(n),g={root:{ownerState:{disableUnderline:r}}},f=c??o?UZ(c??o,g):g,m=u.root??i.Root??$ue,v=u.input??i.Input??Uue;return(0,MH.jsx)(zce,{slots:{root:m,input:v},slotProps:f,fullWidth:s,inputComponent:a,multiline:l,ref:t,type:d,...h,classes:p})});Kue.muiName="Input";const Yue=Kue,que=x2(Hce,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiFilledInput",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[...Lce(e,t),!n.disableUnderline&&t.underline]}})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode,r=n?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=n?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",o=n?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",s=n?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:o,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i}},[`&.${ble.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:i},[`&.${ble.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:s},variants:[{props:e=>{let{ownerState:t}=e;return!t.disableUnderline},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${ble.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${ble.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${ble.disabled}, .${ble.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${ble.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{disableUnderline:!1,color:n},style:{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[n]?.main}`}}}}),{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:12}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:12}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"25px 12px 8px"}},{props:e=>{let{ownerState:t,size:n}=e;return t.multiline&&"small"===n},style:{paddingTop:21,paddingBottom:4}},{props:e=>{let{ownerState:t}=e;return t.multiline&&t.hiddenLabel},style:{paddingTop:16,paddingBottom:17}},{props:e=>{let{ownerState:t}=e;return t.multiline&&t.hiddenLabel&&"small"===t.size},style:{paddingTop:8,paddingBottom:9}}]}})),Xue=x2(Vce,{name:"MuiFilledInput",slot:"Input",overridesResolver:_ce})(Qse(e=>{let{theme:t}=e;return{paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:e=>{let{ownerState:t}=e;return t.hiddenLabel},style:{paddingTop:16,paddingBottom:17}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:0}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:0}},{props:e=>{let{ownerState:t}=e;return t.hiddenLabel&&"small"===t.size},style:{paddingTop:8,paddingBottom:9}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}})),Que=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiFilledInput"}),{disableUnderline:r=!1,components:i={},componentsProps:o,fullWidth:s=!1,hiddenLabel:a,inputComponent:l="input",multiline:c=!1,slotProps:u,slots:d={},type:h="text",...p}=n,g={...n,disableUnderline:r,fullWidth:s,inputComponent:l,multiline:c,type:h},f=(e=>{const{classes:t,disableUnderline:n,startAdornment:r,endAdornment:i,size:o,hiddenLabel:s,multiline:a}=e,l=tJ({root:["root",!n&&"underline",r&&"adornedStart",i&&"adornedEnd","small"===o&&`size${Jse(o)}`,s&&"hiddenLabel",a&&"multiline"],input:["input"]},wle,t);return{...t,...l}})(n),m={root:{ownerState:g},input:{ownerState:g}},v=u??o?UZ(m,u??o):m,w=d.root??i.Root??que,b=d.input??i.Input??Xue;return(0,MH.jsx)(zce,{slots:{root:w,input:b},slotProps:v,fullWidth:s,inputComponent:l,multiline:c,ref:t,type:h,...p,classes:f})});Que.muiName="Input";const Jue=Que;var Zue;const ede=x2("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:S2})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),tde=x2("legend",{name:"MuiNotchedOutlined",shouldForwardProp:S2})(Qse(e=>{let{theme:t}=e;return{float:"unset",width:"auto",overflow:"hidden",variants:[{props:e=>{let{ownerState:t}=e;return!t.withLabel},style:{padding:0,lineHeight:"11px",transition:t.transitions.create("width",{duration:150,easing:t.transitions.easing.easeOut})}},{props:e=>{let{ownerState:t}=e;return t.withLabel},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:t.transitions.create("max-width",{duration:50,easing:t.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:e=>{let{ownerState:t}=e;return t.withLabel&&t.notched},style:{maxWidth:"100%",transition:t.transitions.create("max-width",{duration:100,easing:t.transitions.easing.easeOut,delay:50})}}]}}));const nde=x2(Hce,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiOutlinedInput",slot:"Root",overridesResolver:Lce})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${vle.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${vle.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${vle.focused} .${vle.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{[`&.${vle.focused} .${vle.notchedOutline}`]:{borderColor:(t.vars||t).palette[n].main}}}}),{props:{},style:{[`&.${vle.error} .${vle.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${vle.disabled} .${vle.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:14}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:14}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:"16.5px 14px"}},{props:e=>{let{ownerState:t,size:n}=e;return t.multiline&&"small"===n},style:{padding:"8.5px 14px"}}]}})),rde=x2(function(e){const{children:t,classes:n,className:r,label:i,notched:o,...s}=e,a=null!=i&&""!==i,l={...e,notched:o,withLabel:a};return(0,MH.jsx)(ede,{"aria-hidden":!0,className:r,ownerState:l,...s,children:(0,MH.jsx)(tde,{ownerState:l,children:a?(0,MH.jsx)("span",{children:i}):Zue||(Zue=(0,MH.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"}))})})},{name:"MuiOutlinedInput",slot:"NotchedOutline"})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}})),ide=x2(Vce,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:_ce})(Qse(e=>{let{theme:t}=e;return{padding:"16.5px 14px",...!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:"light"===t.palette.mode?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===t.palette.mode?null:"#fff",caretColor:"light"===t.palette.mode?null:"#fff",borderRadius:"inherit"}},...t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:e=>{let{ownerState:t}=e;return t.multiline},style:{padding:0}},{props:e=>{let{ownerState:t}=e;return t.startAdornment},style:{paddingLeft:0}},{props:e=>{let{ownerState:t}=e;return t.endAdornment},style:{paddingRight:0}}]}})),ode=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiOutlinedInput"}),{components:i={},fullWidth:o=!1,inputComponent:s="input",label:a,multiline:l=!1,notched:c,slots:u={},slotProps:d={},type:h="text",...p}=r,g=(e=>{const{classes:t}=e,n=tJ({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},mle,t);return{...t,...n}})(r),f=qle(),m=Tce({props:r,muiFormControl:f,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),v={...r,color:m.color||"primary",disabled:m.disabled,error:m.error,focused:m.focused,formControl:f,fullWidth:o,hiddenLabel:m.hiddenLabel,multiline:l,size:m.size,type:h},w=u.root??i.Root??nde,b=u.input??i.Input??ide,[C,y]=lle("notchedOutline",{elementType:rde,className:g.notchedOutline,shouldForwardComponentProp:!0,ownerState:v,externalForwardedProps:{slots:u,slotProps:d},additionalProps:{label:null!=a&&""!==a&&m.required?(0,MH.jsxs)(t.Fragment,{children:[a,"\u2009","*"]}):a}});return(0,MH.jsx)(zce,{slots:{root:w,input:b},slotProps:d,renderSuffix:e=>(0,MH.jsx)(C,{...y,notched:"undefined"!==typeof c?c:Boolean(e.startAdornment||e.filled||e.focused)}),fullWidth:o,inputComponent:s,multiline:l,ref:n,type:h,...p,classes:{...g,notchedOutline:null}})});ode.muiName="Input";const sde=ode;function ade(e){return k2("MuiFormLabel",e)}const lde=M2("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),cde=x2("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,"secondary"===n.color&&t.colorSecondary,n.filled&&t.filled]}})(Qse(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,...t.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{[`&.${lde.focused}`]:{color:(t.vars||t).palette[n].main}}}}),{props:{},style:{[`&.${lde.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${lde.error}`]:{color:(t.vars||t).palette.error.main}}}]}})),ude=x2("span",{name:"MuiFormLabel",slot:"Asterisk"})(Qse(e=>{let{theme:t}=e;return{[`&.${lde.error}`]:{color:(t.vars||t).palette.error.main}}})),dde=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiFormLabel"}),{children:r,className:i,color:o,component:s="label",disabled:a,error:l,filled:c,focused:u,required:d,...h}=n,p=Tce({props:n,muiFormControl:qle(),states:["color","required","focused","disabled","error","filled"]}),g={...n,color:p.color||"primary",component:s,disabled:p.disabled,error:p.error,filled:p.filled,focused:p.focused,required:p.required},f=(e=>{const{classes:t,color:n,focused:r,disabled:i,error:o,filled:s,required:a}=e;return tJ({root:["root",`color${Jse(n)}`,i&&"disabled",o&&"error",s&&"filled",r&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]},ade,t)})(g);return(0,MH.jsxs)(cde,{as:s,ownerState:g,className:QQ(f.root,i),ref:t,...h,children:[r,p.required&&(0,MH.jsxs)(ude,{ownerState:g,"aria-hidden":!0,className:f.asterisk,children:["\u2009","*"]})]})}),hde=dde;function pde(e){return k2("MuiInputLabel",e)}M2("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const gde=x2(hde,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiInputLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${lde.asterisk}`]:t.asterisk},t.root,n.formControl&&t.formControl,"small"===n.size&&t.sizeSmall,n.shrink&&t.shrink,!n.disableAnimation&&t.animated,n.focused&&t.focused,t[n.variant]]}})(Qse(e=>{let{theme:t}=e;return{display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:e=>{let{ownerState:t}=e;return t.formControl},style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:e=>{let{ownerState:t}=e;return t.shrink},style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:e=>{let{ownerState:t}=e;return!t.disableAnimation},style:{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:e=>{let{variant:t,ownerState:n}=e;return"filled"===t&&n.shrink},style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:e=>{let{variant:t,ownerState:n,size:r}=e;return"filled"===t&&n.shrink&&"small"===r},style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:e=>{let{variant:t,ownerState:n}=e;return"outlined"===t&&n.shrink},style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}})),fde=t.forwardRef(function(e,t){const n=Use({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,margin:i,shrink:o,variant:s,className:a,...l}=n,c=qle();let u=o;"undefined"===typeof u&&c&&(u=c.filled||c.focused||c.adornedStart);const d=Tce({props:n,muiFormControl:c,states:["size","variant","required","focused"]}),h={...n,disableAnimation:r,formControl:c,shrink:u,size:d.size,variant:d.variant,required:d.required,focused:d.focused},p=(e=>{const{classes:t,formControl:n,size:r,shrink:i,disableAnimation:o,variant:s,required:a}=e,l=tJ({root:["root",n&&"formControl",!o&&"animated",i&&"shrink",r&&"medium"!==r&&`size${Jse(r)}`,s],asterisk:[a&&"asterisk"]},pde,t);return{...t,...l}})(h);return(0,MH.jsx)(gde,{"data-shrink":u,ref:t,className:QQ(p.root,a),...l,ownerState:h,classes:p})}),mde=fde;const vde=function(e,n){return t.isValidElement(e)&&-1!==n.indexOf(e.type.muiName??e.type?._payload?.value?.muiName)};function wde(e){return k2("MuiFormControl",e)}M2("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const bde=x2("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`margin${Jse(n.margin)}`],n.fullWidth&&t.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),Cde=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiFormControl"}),{children:i,className:o,color:s="primary",component:a="div",disabled:l=!1,error:c=!1,focused:u,fullWidth:d=!1,hiddenLabel:h=!1,margin:p="none",required:g=!1,size:f="medium",variant:m="outlined",...v}=r,w={...r,color:s,component:a,disabled:l,error:c,fullWidth:d,hiddenLabel:h,margin:p,required:g,size:f,variant:m},b=(e=>{const{classes:t,margin:n,fullWidth:r}=e;return tJ({root:["root","none"!==n&&`margin${Jse(n)}`,r&&"fullWidth"]},wde,t)})(w),[C,y]=t.useState(()=>{let e=!1;return i&&t.Children.forEach(i,t=>{if(!vde(t,["Input","Select"]))return;const n=vde(t,["Select"])?t.props.input:t;n&&n.props.startAdornment&&(e=!0)}),e}),[S,x]=t.useState(()=>{let e=!1;return i&&t.Children.forEach(i,t=>{vde(t,["Input","Select"])&&(Oce(t.props,!0)||Oce(t.props.inputProps,!0))&&(e=!0)}),e}),[R,E]=t.useState(!1);l&&R&&E(!1);const T=void 0===u||l?R:u;let k;t.useRef(!1);const M=t.useCallback(()=>{x(!0)},[]),P=t.useCallback(()=>{x(!1)},[]),I=t.useMemo(()=>({adornedStart:C,setAdornedStart:y,color:s,disabled:l,error:c,filled:S,focused:T,fullWidth:d,hiddenLabel:h,size:f,onBlur:()=>{E(!1)},onFocus:()=>{E(!0)},onEmpty:P,onFilled:M,registerEffect:k,required:g,variant:m}),[C,s,l,c,S,T,d,h,k,P,M,g,f,m]);return(0,MH.jsx)(Yle.Provider,{value:I,children:(0,MH.jsx)(bde,{as:a,ownerState:w,className:QQ(b.root,o),ref:n,...v,children:i})})}),yde=Cde;function Sde(e){return k2("MuiFormHelperText",e)}const xde=M2("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var Rde;const Ede=x2("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.size&&t[`size${Jse(n.size)}`],n.contained&&t.contained,n.filled&&t.filled]}})(Qse(e=>{let{theme:t}=e;return{color:(t.vars||t).palette.text.secondary,...t.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${xde.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${xde.error}`]:{color:(t.vars||t).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:e=>{let{ownerState:t}=e;return t.contained},style:{marginLeft:14,marginRight:14}}]}})),Tde=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiFormHelperText"}),{children:r,className:i,component:o="p",disabled:s,error:a,filled:l,focused:c,margin:u,required:d,variant:h,...p}=n,g=Tce({props:n,muiFormControl:qle(),states:["variant","size","disabled","error","filled","focused","required"]}),f={...n,component:o,contained:"filled"===g.variant||"outlined"===g.variant,variant:g.variant,size:g.size,disabled:g.disabled,error:g.error,filled:g.filled,focused:g.focused,required:g.required};delete f.ownerState;const m=(e=>{const{classes:t,contained:n,size:r,disabled:i,error:o,filled:s,focused:a,required:l}=e;return tJ({root:["root",i&&"disabled",o&&"error",r&&`size${Jse(r)}`,n&&"contained",a&&"focused",s&&"filled",l&&"required"]},Sde,t)})(f);return(0,MH.jsx)(Ede,{as:o,className:QQ(m.root,i),ref:t,...p,ownerState:f,children:" "===r?Rde||(Rde=(0,MH.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):r})}),kde=Tde,Mde=cne,Pde=!1;var Ide="unmounted",Ade="exited",Dde="entering",Fde="entered",Ode="exiting",Nde=function(e){function n(t,n){var r;r=e.call(this,t,n)||this;var i,o=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?o?(i=Ade,r.appearStatus=Dde):i=Fde:i=t.unmountOnExit||t.mountOnEnter?Ide:Ade,r.state={status:i},r.nextCallback=null,r}gae(n,e),n.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Ide?{status:Ade}:null};var r=n.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==Dde&&n!==Fde&&(t=Dde):n!==Dde&&n!==Fde||(t=Ode)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!==typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Dde){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:o.findDOMNode(this);n&&function(e){e.scrollTop}(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ade&&this.setState({status:Ide})},r.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[o.findDOMNode(this),r],s=i[0],a=i[1],l=this.getTimeouts(),c=r?l.appear:l.enter;!e&&!n||Pde?this.safeSetState({status:Fde},function(){t.props.onEntered(s)}):(this.props.onEnter(s,a),this.safeSetState({status:Dde},function(){t.props.onEntering(s,a),t.onTransitionEnd(c,function(){t.safeSetState({status:Fde},function(){t.props.onEntered(s,a)})})}))},r.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:o.findDOMNode(this);t&&!Pde?(this.props.onExit(r),this.safeSetState({status:Ode},function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,function(){e.safeSetState({status:Ade},function(){e.props.onExited(r)})})})):this.safeSetState({status:Ade},function(){e.props.onExited(r)})},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:o.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],s=i[0],a=i[1];this.props.addEndListener(s,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===Ide)return null;var n=this.props,r=n.children,i=(n.in,n.mountOnEnter,n.unmountOnExit,n.appear,n.enter,n.exit,n.timeout,n.addEndListener,n.onEnter,n.onEntering,n.onEntered,n.onExit,n.onExiting,n.onExited,n.nodeRef,qQ(n,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(fae.Provider,{value:null},"function"===typeof r?r(e,i):t.cloneElement(t.Children.only(r),i))},n}(t.Component);function Lde(){}Nde.contextType=fae,Nde.propTypes={},Nde.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Lde,onEntering:Lde,onEntered:Lde,onExit:Lde,onExiting:Lde,onExited:Lde},Nde.UNMOUNTED=Ide,Nde.EXITED=Ade,Nde.ENTERING=Dde,Nde.ENTERED=Fde,Nde.EXITING=Ode;const _de=Nde,Hde=e=>e.scrollTop;function Vde(e,t){const{timeout:n,easing:r,style:i={}}=e;return{duration:i.transitionDuration??("number"===typeof n?n:n[t.mode]||0),easing:i.transitionTimingFunction??("object"===typeof r?r[t.mode]:r),delay:i.transitionDelay}}function Bde(e){return`scale(${e}, ${e**2})`}const Wde={entering:{opacity:1,transform:Bde(1)},entered:{opacity:1,transform:"none"}},zde="undefined"!==typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),jde=t.forwardRef(function(e,n){const{addEndListener:r,appear:i=!0,children:o,easing:s,in:a,onEnter:l,onEntered:c,onEntering:u,onExit:d,onExited:h,onExiting:p,style:g,timeout:f="auto",TransitionComponent:m=_de,...v}=e,w=A4(),b=t.useRef(),C=Rne(),y=t.useRef(null),S=uae(y,Nse(o),n),x=e=>t=>{if(e){const n=y.current;void 0===t?e(n):e(n,t)}},R=x(u),E=x((e,t)=>{Hde(e);const{duration:n,delay:r,easing:i}=Vde({style:g,timeout:f,easing:s},{mode:"enter"});let o;"auto"===f?(o=C.transitions.getAutoHeightDuration(e.clientHeight),b.current=o):o=n,e.style.transition=[C.transitions.create("opacity",{duration:o,delay:r}),C.transitions.create("transform",{duration:zde?o:.666*o,delay:r,easing:i})].join(","),l&&l(e,t)}),T=x(c),k=x(p),M=x(e=>{const{duration:t,delay:n,easing:r}=Vde({style:g,timeout:f,easing:s},{mode:"exit"});let i;"auto"===f?(i=C.transitions.getAutoHeightDuration(e.clientHeight),b.current=i):i=t,e.style.transition=[C.transitions.create("opacity",{duration:i,delay:n}),C.transitions.create("transform",{duration:zde?i:.666*i,delay:zde?n:n||.333*i,easing:r})].join(","),e.style.opacity=0,e.style.transform=Bde(.75),d&&d(e)}),P=x(h);return(0,MH.jsx)(m,{appear:i,in:a,nodeRef:y,onEnter:E,onEntered:T,onEntering:R,onExit:M,onExited:P,onExiting:k,addEndListener:e=>{"auto"===f&&w.start(b.current||0,e),r&&r(y.current,e)},timeout:"auto"===f?null:f,...v,children:(e,n)=>{let{ownerState:r,...i}=n;return t.cloneElement(o,{style:{opacity:0,transform:Bde(.75),visibility:"exited"!==e||a?void 0:"hidden",...Wde[e],...g,...o.props.style},ref:S,...i})}})});jde&&(jde.muiSupportAuto=!0);const Gde=jde,$de={entering:{opacity:1},entered:{opacity:1}},Ude=t.forwardRef(function(e,n){const r=Rne(),i={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:o,appear:s=!0,children:a,easing:l,in:c,onEnter:u,onEntered:d,onEntering:h,onExit:p,onExited:g,onExiting:f,style:m,timeout:v=i,TransitionComponent:w=_de,...b}=e,C=t.useRef(null),y=uae(C,Nse(a),n),S=e=>t=>{if(e){const n=C.current;void 0===t?e(n):e(n,t)}},x=S(h),R=S((e,t)=>{Hde(e);const n=Vde({style:m,timeout:v,easing:l},{mode:"enter"});e.style.webkitTransition=r.transitions.create("opacity",n),e.style.transition=r.transitions.create("opacity",n),u&&u(e,t)}),E=S(d),T=S(f),k=S(e=>{const t=Vde({style:m,timeout:v,easing:l},{mode:"exit"});e.style.webkitTransition=r.transitions.create("opacity",t),e.style.transition=r.transitions.create("opacity",t),p&&p(e)}),M=S(g);return(0,MH.jsx)(w,{appear:s,in:c,nodeRef:C,onEnter:R,onEntered:E,onEntering:x,onExit:k,onExited:M,onExiting:T,addEndListener:e=>{o&&o(C.current,e)},timeout:v,...b,children:(e,n)=>{let{ownerState:r,...i}=n;return t.cloneElement(a,{style:{opacity:0,visibility:"exited"!==e||c?void 0:"hidden",...$de[e],...m,...a.props.style},ref:y,...i})}})}),Kde=Ude;function Yde(e){return k2("MuiBackdrop",e)}M2("MuiBackdrop",["root","invisible"]);const qde=x2("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.invisible&&t.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),Xde=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiBackdrop"}),{children:r,className:i,component:o="div",invisible:s=!1,open:a,components:l={},componentsProps:c={},slotProps:u={},slots:d={},TransitionComponent:h,transitionDuration:p,...g}=n,f={...n,component:o,invisible:s},m=(e=>{const{classes:t,invisible:n}=e;return tJ({root:["root",n&&"invisible"]},Yde,t)})(f),v={component:o,slots:{transition:h,root:l.Root,...d},slotProps:{...c,...u}},[w,b]=lle("root",{elementType:qde,externalForwardedProps:v,className:QQ(m.root,i),ownerState:f}),[C,y]=lle("transition",{elementType:Kde,externalForwardedProps:v,ownerState:f});return(0,MH.jsx)(C,{in:a,timeout:p,...g,...y,children:(0,MH.jsx)(w,{"aria-hidden":!0,...b,classes:m,ref:t,children:r})})}),Qde=Xde;function Jde(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((e,t)=>null==t?e:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r),t.apply(this,r)},()=>{})}function Zde(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function ehe(e){return parseInt(bce(e).getComputedStyle(e).paddingRight,10)||0}function the(e,t,n,r,i){const o=[t,n,...r];[].forEach.call(e.children,e=>{const t=!o.includes(e),n=!function(e){const t=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),n="INPUT"===e.tagName&&"hidden"===e.getAttribute("type");return t||n}(e);t&&n&&Zde(e,i)})}function nhe(e,t){let n=-1;return e.some((e,r)=>!!t(e)&&(n=r,!0)),n}function rhe(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(function(e){const t=Iee(e);return t.body===e?bce(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}(r)){const e=Aue(bce(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${ehe(r)+e}px`;const t=Iee(r).querySelectorAll(".mui-fixed");[].forEach.call(t,t=>{n.push({value:t.style.paddingRight,property:"padding-right",el:t}),t.style.paddingRight=`${ehe(t)+e}px`})}let e;if(r.parentNode instanceof DocumentFragment)e=Iee(r).body;else{const t=r.parentElement,n=bce(r);e="HTML"===t?.nodeName&&"scroll"===n.getComputedStyle(t).overflowY?t:r}n.push({value:e.style.overflow,property:"overflow",el:e},{value:e.style.overflowX,property:"overflow-x",el:e},{value:e.style.overflowY,property:"overflow-y",el:e}),e.style.overflow="hidden"}return()=>{n.forEach(e=>{let{value:t,el:n,property:r}=e;t?n.style.setProperty(r,t):n.style.removeProperty(r)})}}const ihe=()=>{},ohe=new class{constructor(){this.modals=[],this.containers=[]}add(e,t){let n=this.modals.indexOf(e);if(-1!==n)return n;n=this.modals.length,this.modals.push(e),e.modalRef&&Zde(e.modalRef,!1);const r=function(e){const t=[];return[].forEach.call(e.children,e=>{"true"===e.getAttribute("aria-hidden")&&t.push(e)}),t}(t);the(t,e.mount,e.modalRef,r,!0);const i=nhe(this.containers,e=>e.container===t);return-1!==i?(this.containers[i].modals.push(e),n):(this.containers.push({modals:[e],container:t,restore:null,hiddenSiblings:r}),n)}mount(e,t){const n=nhe(this.containers,t=>t.modals.includes(e)),r=this.containers[n];r.restore||(r.restore=rhe(r,t))}remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this.modals.indexOf(e);if(-1===n)return n;const r=nhe(this.containers,t=>t.modals.includes(e)),i=this.containers[r];if(i.modals.splice(i.modals.indexOf(e),1),this.modals.splice(n,1),0===i.modals.length)i.restore&&i.restore(),e.modalRef&&Zde(e.modalRef,t),the(i.container,e.mount,e.modalRef,i.hiddenSiblings,!1),this.containers.splice(r,1);else{const e=i.modals[i.modals.length-1];e.modalRef&&Zde(e.modalRef,!1)}return n}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}};const she=function(e){const{container:n,disableEscapeKeyDown:r=!1,disableScrollLock:i=!1,closeAfterTransition:o=!1,onTransitionEnter:s,onTransitionExited:a,children:l,onClose:c,open:u,rootRef:d}=e,h=t.useRef({}),p=t.useRef(null),g=t.useRef(null),f=JQ(g,d),[m,v]=t.useState(!u),w=function(e){return!!e&&e.props.hasOwnProperty("in")}(l);let b=!0;"false"!==e["aria-hidden"]&&!1!==e["aria-hidden"]||(b=!1);const C=()=>(h.current.modalRef=g.current,h.current.mount=p.current,h.current),y=()=>{ohe.mount(C(),{disableScrollLock:i}),g.current&&(g.current.scrollTop=0)},S=w4(()=>{const e=function(e){return"function"===typeof e?e():e}(n)||Iee(p.current).body;ohe.add(C(),e),g.current&&y()}),x=()=>ohe.isTopModal(C()),R=w4(e=>{p.current=e,e&&(u&&x()?y():g.current&&Zde(g.current,b))}),E=t.useCallback(()=>{ohe.remove(C(),b)},[b]);t.useEffect(()=>()=>{E()},[E]),t.useEffect(()=>{u?S():w&&o||E()},[u,E,w,o,S]);const T=e=>t=>{e.onKeyDown?.(t),"Escape"===t.key&&229!==t.which&&x()&&(r||(t.stopPropagation(),c&&c(t,"escapeKeyDown")))},k=e=>t=>{e.onClick?.(t),t.target===t.currentTarget&&c&&c(t,"backdropClick")};return{getRootProps:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Ise(e);delete n.onTransitionEnter,delete n.onTransitionExited;const r={...n,...t};return{role:"presentation",...r,onKeyDown:T(r),ref:f}},getBackdropProps:function(){const e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{"aria-hidden":!0,...e,onClick:k(e),open:u}},getTransitionProps:()=>({onEnter:Jde(()=>{v(!1),s&&s()},l?.props.onEnter??ihe),onExited:Jde(()=>{v(!0),a&&a(),o&&E()},l?.props.onExited??ihe)}),rootRef:f,portalRef:R,isTopModal:x,exited:m,hasTransition:w}};function ahe(e){return k2("MuiModal",e)}M2("MuiModal",["root","hidden","backdrop"]);const lhe=x2("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.open&&n.exited&&t.hidden]}})(Qse(e=>{let{theme:t}=e;return{position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:e=>{let{ownerState:t}=e;return!t.open&&t.exited},style:{visibility:"hidden"}}]}})),che=x2(Qde,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),uhe=t.forwardRef(function(e,n){const r=Use({name:"MuiModal",props:e}),{BackdropComponent:i=che,BackdropProps:o,classes:s,className:a,closeAfterTransition:l=!1,children:c,container:u,component:d,components:h={},componentsProps:p={},disableAutoFocus:g=!1,disableEnforceFocus:f=!1,disableEscapeKeyDown:m=!1,disablePortal:v=!1,disableRestoreFocus:w=!1,disableScrollLock:b=!1,hideBackdrop:C=!1,keepMounted:y=!1,onClose:S,onTransitionEnter:x,onTransitionExited:R,open:E,slotProps:T={},slots:k={},theme:M,...P}=r,I={...r,closeAfterTransition:l,disableAutoFocus:g,disableEnforceFocus:f,disableEscapeKeyDown:m,disablePortal:v,disableRestoreFocus:w,disableScrollLock:b,hideBackdrop:C,keepMounted:y},{getRootProps:A,getBackdropProps:D,getTransitionProps:F,portalRef:O,isTopModal:N,exited:L,hasTransition:_}=she({...I,rootRef:n}),H={...I,exited:L},V=(e=>{const{open:t,exited:n,classes:r}=e;return tJ({root:["root",!t&&n&&"hidden"],backdrop:["backdrop"]},ahe,r)})(H),B={};if(void 0===c.props.tabIndex&&(B.tabIndex="-1"),_){const{onEnter:e,onExited:t}=F();B.onEnter=e,B.onExited=t}const W={slots:{root:h.Root,backdrop:h.Backdrop,...k},slotProps:{...p,...T}},[z,j]=lle("root",{ref:n,elementType:lhe,externalForwardedProps:{...W,...P,component:d},getSlotProps:A,ownerState:H,className:QQ(a,V?.root,!H.open&&H.exited&&V?.hidden)}),[G,$]=lle("backdrop",{ref:o?.ref,elementType:i,externalForwardedProps:W,shouldForwardComponentProp:!0,additionalProps:o,getSlotProps:e=>D({...e,onClick:t=>{e?.onClick&&e.onClick(t)}}),className:QQ(o?.className,V?.backdrop),ownerState:H});return y||E||_&&!L?(0,MH.jsx)(Lse,{ref:O,container:u,disablePortal:v,children:(0,MH.jsxs)(z,{...j,children:[!C&&i?(0,MH.jsx)(G,{...$}):null,(0,MH.jsx)(Uce,{disableEnforceFocus:f,disableAutoFocus:g,disableRestoreFocus:w,isEnabled:N,open:E,children:t.cloneElement(c,B)})]})}):null}),dhe=uhe;function hhe(e){return k2("MuiPopover",e)}M2("MuiPopover",["root","paper"]);function phe(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.height/2:"bottom"===t&&(n=e.height),n}function ghe(e,t){let n=0;return"number"===typeof t?n=t:"center"===t?n=e.width/2:"right"===t&&(n=e.width),n}function fhe(e){return[e.horizontal,e.vertical].map(e=>"number"===typeof e?`${e}px`:e).join(" ")}function mhe(e){return"function"===typeof e?e():e}const vhe=x2(dhe,{name:"MuiPopover",slot:"Root"})({}),whe=x2(sae,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),bhe=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiPopover"}),{action:i,anchorEl:o,anchorOrigin:s={vertical:"top",horizontal:"left"},anchorPosition:a,anchorReference:l="anchorEl",children:c,className:u,container:d,elevation:h=8,marginThreshold:p=16,open:g,PaperProps:f={},slots:m={},slotProps:v={},transformOrigin:w={vertical:"top",horizontal:"left"},TransitionComponent:b,transitionDuration:C="auto",TransitionProps:y={},disableScrollLock:S=!1,...x}=r,R=t.useRef(),E={...r,anchorOrigin:s,anchorReference:l,elevation:h,marginThreshold:p,transformOrigin:w,TransitionComponent:b,transitionDuration:C,TransitionProps:y},T=(e=>{const{classes:t}=e;return tJ({root:["root"],paper:["paper"]},hhe,t)})(E),k=t.useCallback(()=>{if("anchorPosition"===l)return a;const e=mhe(o),t=(e&&1===e.nodeType?e:Tue(R.current).body).getBoundingClientRect();return{top:t.top+phe(t,s.vertical),left:t.left+ghe(t,s.horizontal)}},[o,s.horizontal,s.vertical,a,l]),M=t.useCallback(e=>({vertical:phe(e,w.vertical),horizontal:ghe(e,w.horizontal)}),[w.horizontal,w.vertical]),P=t.useCallback(e=>{const t={width:e.offsetWidth,height:e.offsetHeight},n=M(t);if("none"===l)return{top:null,left:null,transformOrigin:fhe(n)};const r=k();let i=r.top-n.vertical,s=r.left-n.horizontal;const a=i+t.height,c=s+t.width,u=Fue(mhe(o)),d=u.innerHeight-p,h=u.innerWidth-p;if(null!==p&&i<p){const e=i-p;i-=e,n.vertical+=e}else if(null!==p&&a>d){const e=a-d;i-=e,n.vertical+=e}if(null!==p&&s<p){const e=s-p;s-=e,n.horizontal+=e}else if(c>h){const e=c-h;s-=e,n.horizontal+=e}return{top:`${Math.round(i)}px`,left:`${Math.round(s)}px`,transformOrigin:fhe(n)}},[o,l,k,M,p]),[I,A]=t.useState(g),D=t.useCallback(()=>{const e=R.current;if(!e)return;const t=P(e);null!==t.top&&e.style.setProperty("top",t.top),null!==t.left&&(e.style.left=t.left),e.style.transformOrigin=t.transformOrigin,A(!0)},[P]);t.useEffect(()=>(S&&window.addEventListener("scroll",D),()=>window.removeEventListener("scroll",D)),[o,S,D]);t.useEffect(()=>{g&&D()}),t.useImperativeHandle(i,()=>g?{updatePosition:()=>{D()}}:null,[g,D]),t.useEffect(()=>{if(!g)return;const e=Mde(()=>{D()}),t=Fue(mhe(o));return t.addEventListener("resize",e),()=>{e.clear(),t.removeEventListener("resize",e)}},[o,g,D]);let F=C;const O={slots:{transition:b,...m},slotProps:{transition:y,paper:f,...v}},[N,L]=lle("transition",{elementType:Gde,externalForwardedProps:O,ownerState:E,getSlotProps:e=>({...e,onEntering:(t,n)=>{e.onEntering?.(t,n),D()},onExited:t=>{e.onExited?.(t),A(!1)}}),additionalProps:{appear:!0,in:g}});"auto"!==C||N.muiSupportAuto||(F=void 0);const _=d||(o?Tue(mhe(o)).body:void 0),[H,{slots:V,slotProps:B,...W}]=lle("root",{ref:n,elementType:vhe,externalForwardedProps:{...O,...x},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:m.backdrop},slotProps:{backdrop:sce("function"===typeof v.backdrop?v.backdrop(E):v.backdrop,{invisible:!0})},container:_,open:g},ownerState:E,className:QQ(T.root,u)}),[z,j]=lle("paper",{ref:R,className:T.paper,elementType:whe,externalForwardedProps:O,shouldForwardComponentProp:!0,additionalProps:{elevation:h,style:I?void 0:{opacity:0}},ownerState:E});return(0,MH.jsx)(H,{...W,...!Ece(H)&&{slots:V,slotProps:B,disableScrollLock:S},children:(0,MH.jsx)(N,{...L,timeout:F,children:(0,MH.jsx)(z,{...j,children:c})})})}),Che=bhe;function yhe(e){return k2("MuiMenu",e)}M2("MuiMenu",["root","paper","list"]);const She={vertical:"top",horizontal:"right"},xhe={vertical:"top",horizontal:"left"},Rhe=x2(Che,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiMenu",slot:"Root"})({}),Ehe=x2(whe,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),The=x2(Vue,{name:"MuiMenu",slot:"List"})({outline:0}),khe=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:o,className:s,disableAutoFocusItem:a=!1,MenuListProps:l={},onClose:c,open:u,PaperProps:d={},PopoverClasses:h,transitionDuration:p="auto",TransitionProps:{onEntering:g,...f}={},variant:m="selectedMenu",slots:v={},slotProps:w={},...b}=r,C=z6(),y={...r,autoFocus:i,disableAutoFocusItem:a,MenuListProps:l,onEntering:g,PaperProps:d,transitionDuration:p,TransitionProps:f,variant:m},S=(e=>{const{classes:t}=e;return tJ({root:["root"],paper:["paper"],list:["list"]},yhe,t)})(y),x=i&&!a&&u,R=t.useRef(null);let E=-1;t.Children.map(o,(e,n)=>{t.isValidElement(e)&&(e.props.disabled||("selectedMenu"===m&&e.props.selected||-1===E)&&(E=n))});const T={slots:v,slotProps:{list:l,transition:f,paper:d,...w}},k=Ose({elementType:v.root,externalSlotProps:w.root,ownerState:y,className:[S.root,s]}),[M,P]=lle("paper",{className:S.paper,elementType:Ehe,externalForwardedProps:T,shouldForwardComponentProp:!0,ownerState:y}),[I,A]=lle("list",{className:QQ(S.list,l.className),elementType:The,shouldForwardComponentProp:!0,externalForwardedProps:T,getSlotProps:e=>({...e,onKeyDown:t=>{(e=>{"Tab"===e.key&&(e.preventDefault(),c&&c(e,"tabKeyDown"))})(t),e.onKeyDown?.(t)}}),ownerState:y}),D="function"===typeof T.slotProps.transition?T.slotProps.transition(y):T.slotProps.transition;return(0,MH.jsx)(Rhe,{onClose:c,anchorOrigin:{vertical:"bottom",horizontal:C?"right":"left"},transformOrigin:C?She:xhe,slots:{root:v.root,paper:M,backdrop:v.backdrop,...v.transition&&{transition:v.transition}},slotProps:{root:k,paper:P,backdrop:"function"===typeof w.backdrop?w.backdrop(y):w.backdrop,transition:{...D,onEntering:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];((e,t)=>{R.current&&R.current.adjustStyleForScrollbar(e,{direction:C?"rtl":"ltr"}),g&&g(e,t)})(...t),D?.onEntering?.(...t)}}},open:u,ref:n,transitionDuration:p,ownerState:y,...b,classes:h,children:(0,MH.jsx)(I,{actions:R,autoFocus:i&&(-1===E||a),autoFocusItem:x,variant:m,...A,children:o})})}),Mhe=khe;function Phe(e){return k2("MuiNativeSelect",e)}const Ihe=M2("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Ahe=x2("select",{name:"MuiNativeSelect"})(e=>{let{theme:t}=e;return{MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${Ihe.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(t.vars||t).palette.background.paper},variants:[{props:e=>{let{ownerState:t}=e;return"filled"!==t.variant&&"outlined"!==t.variant},style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(t.vars||t).shape.borderRadius,"&:focus":{borderRadius:(t.vars||t).shape.borderRadius},"&&&":{paddingRight:32}}}]}}),Dhe=x2(Ahe,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:S2,overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.select,t[n.variant],n.error&&t.error,{[`&.${Ihe.multiple}`]:t.multiple}]}})({}),Fhe=x2("svg",{name:"MuiNativeSelect"})(e=>{let{theme:t}=e;return{position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(t.vars||t).palette.action.active,[`&.${Ihe.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:e=>{let{ownerState:t}=e;return t.open},style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]}}),Ohe=x2(Fhe,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Jse(n.variant)}`],n.open&&t.iconOpen]}})({}),Nhe=t.forwardRef(function(e,n){const{className:r,disabled:i,error:o,IconComponent:s,inputRef:a,variant:l="standard",...c}=e,u={...e,disabled:i,variant:l,error:o},d=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:o,error:s}=e;return tJ({select:["select",n,r&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${Jse(n)}`,o&&"iconOpen",r&&"disabled"]},Phe,t)})(u);return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(Dhe,{ownerState:u,className:QQ(d.select,r),disabled:i,ref:a||n,...c}),e.multiple?null:(0,MH.jsx)(Ohe,{as:s,ownerState:u,className:d.icon})]})}),Lhe=Nhe;function _he(e){return k2("MuiSelect",e)}const Hhe=M2("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var Vhe;const Bhe=x2(Ahe,{name:"MuiSelect",slot:"Select",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`&.${Hhe.select}`]:t.select},{[`&.${Hhe.select}`]:t[n.variant]},{[`&.${Hhe.error}`]:t.error},{[`&.${Hhe.multiple}`]:t.multiple}]}})({[`&.${Hhe.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),Whe=x2(Fhe,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.icon,n.variant&&t[`icon${Jse(n.variant)}`],n.open&&t.iconOpen]}})({}),zhe=x2("input",{shouldForwardProp:e=>y2(e)&&"classes"!==e,name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function jhe(e,t){return"object"===typeof t&&null!==t?e===t:String(e)===String(t)}function Ghe(e){return null==e||"string"===typeof e&&!e.trim()}const $he=t.forwardRef(function(e,n){const{"aria-describedby":r,"aria-label":i,autoFocus:o,autoWidth:s,children:a,className:l,defaultOpen:c,defaultValue:u,disabled:d,displayEmpty:h,error:p=!1,IconComponent:g,inputRef:f,labelId:m,MenuProps:v={},multiple:w,name:b,onBlur:C,onChange:y,onClose:S,onFocus:x,onOpen:R,open:E,readOnly:T,renderValue:k,required:M,SelectDisplayProps:P={},tabIndex:I,type:A,value:D,variant:F="standard",...O}=e,[N,L]=Kle({controlled:D,default:u,name:"Select"}),[_,H]=Kle({controlled:E,default:c,name:"Select"}),V=t.useRef(null),B=t.useRef(null),[W,z]=t.useState(null),{current:j}=t.useRef(null!=E),[G,$]=t.useState(),U=uae(n,f),K=t.useCallback(e=>{B.current=e,e&&z(e)},[]),Y=W?.parentNode;t.useImperativeHandle(U,()=>({focus:()=>{B.current.focus()},node:V.current,value:N}),[N]),t.useEffect(()=>{c&&_&&W&&!j&&($(s?null:Y.clientWidth),B.current.focus())},[W,s]),t.useEffect(()=>{o&&B.current.focus()},[o]),t.useEffect(()=>{if(!m)return;const e=Tue(B.current).getElementById(m);if(e){const t=()=>{getSelection().isCollapsed&&B.current.focus()};return e.addEventListener("click",t),()=>{e.removeEventListener("click",t)}}},[m]);const q=(e,t)=>{e?R&&R(t):S&&S(t),j||($(s?null:Y.clientWidth),H(e))},X=t.Children.toArray(a),Q=e=>t=>{let n;if(t.currentTarget.hasAttribute("tabindex")){if(w){n=Array.isArray(N)?N.slice():[];const t=N.indexOf(e.props.value);-1===t?n.push(e.props.value):n.splice(t,1)}else n=e.props.value;if(e.props.onClick&&e.props.onClick(t),N!==n&&(L(n),y)){const r=t.nativeEvent||t,i=new r.constructor(r.type,r);Object.defineProperty(i,"target",{writable:!0,value:{value:n,name:b}}),y(i,e)}w||q(!1,t)}},J=null!==W&&_;let Z,ee;delete O["aria-invalid"];const te=[];let ne=!1,re=!1;(Oce({value:N})||h)&&(k?Z=k(N):ne=!0);const ie=X.map(e=>{if(!t.isValidElement(e))return null;let n;if(w){if(!Array.isArray(N))throw new Error(ZQ(2));n=N.some(t=>jhe(t,e.props.value)),n&&ne&&te.push(e.props.children)}else n=jhe(N,e.props.value),n&&ne&&(ee=e.props.children);return n&&(re=!0),t.cloneElement(e,{"aria-selected":n?"true":"false",onClick:Q(e),onKeyUp:t=>{" "===t.key&&t.preventDefault(),e.props.onKeyUp&&e.props.onKeyUp(t)},role:"option",selected:n,value:void 0,"data-value":e.props.value})});ne&&(Z=w?0===te.length?null:te.reduce((e,t,n)=>(e.push(t),n<te.length-1&&e.push(", "),e),[]):ee);let oe,se=G;!s&&j&&W&&(se=Y.clientWidth),oe="undefined"!==typeof I?I:d?null:0;const ae=P.id||(b?`mui-component-select-${b}`:void 0),le={...e,variant:F,value:N,open:J,error:p},ce=(e=>{const{classes:t,variant:n,disabled:r,multiple:i,open:o,error:s}=e;return tJ({select:["select",n,r&&"disabled",i&&"multiple",s&&"error"],icon:["icon",`icon${Jse(n)}`,o&&"iconOpen",r&&"disabled"],nativeInput:["nativeInput"]},_he,t)})(le),ue={...v.PaperProps,...v.slotProps?.paper},de={...v.MenuListProps,...v.slotProps?.list},he=l5();return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(Bhe,{as:"div",ref:K,tabIndex:oe,role:"combobox","aria-controls":J?he:void 0,"aria-disabled":d?"true":void 0,"aria-expanded":J?"true":"false","aria-haspopup":"listbox","aria-label":i,"aria-labelledby":[m,ae].filter(Boolean).join(" ")||void 0,"aria-describedby":r,"aria-required":M?"true":void 0,"aria-invalid":p?"true":void 0,onKeyDown:e=>{if(!T){[" ","ArrowUp","ArrowDown","Enter"].includes(e.key)&&(e.preventDefault(),q(!0,e))}},onMouseDown:d||T?null:e=>{0===e.button&&(e.preventDefault(),B.current.focus(),q(!0,e))},onBlur:e=>{!J&&C&&(Object.defineProperty(e,"target",{writable:!0,value:{value:N,name:b}}),C(e))},onFocus:x,...P,ownerState:le,className:QQ(P.className,ce.select,l),id:ae,children:Ghe(Z)?Vhe||(Vhe=(0,MH.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):Z}),(0,MH.jsx)(zhe,{"aria-invalid":p,value:Array.isArray(N)?N.join(","):N,name:b,ref:V,"aria-hidden":!0,onChange:e=>{const t=X.find(t=>t.props.value===e.target.value);void 0!==t&&(L(t.props.value),y&&y(e,t))},tabIndex:-1,disabled:d,className:ce.nativeInput,autoFocus:o,required:M,...O,ownerState:le}),(0,MH.jsx)(Whe,{as:g,className:ce.icon,ownerState:le}),(0,MH.jsx)(Mhe,{id:`menu-${b||""}`,anchorEl:Y,open:J,onClose:e=>{q(!1,e)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...v,slotProps:{...v.slotProps,list:{"aria-labelledby":m,role:"listbox","aria-multiselectable":w?"true":void 0,disableListWrap:!0,id:he,...de},paper:{...ue,style:{minWidth:se,...null!=ue?ue.style:null}}},children:ie})]})}),Uhe=$he,Khe={name:"MuiSelect",slot:"Root",shouldForwardProp:e=>S2(e)&&"variant"!==e},Yhe=x2(Yue,Khe)(""),qhe=x2(sde,Khe)(""),Xhe=x2(Jue,Khe)(""),Qhe=t.forwardRef(function(e,n){const r=Use({name:"MuiSelect",props:e}),{autoWidth:i=!1,children:o,classes:s={},className:a,defaultOpen:l=!1,displayEmpty:c=!1,IconComponent:u=yle,id:d,input:h,inputProps:p,label:g,labelId:f,MenuProps:m,multiple:v=!1,native:w=!1,onClose:b,onOpen:C,open:y,renderValue:S,SelectDisplayProps:x,variant:R="outlined",...E}=r,T=w?Lhe:Uhe,k=Tce({props:r,muiFormControl:qle(),states:["variant","error"]}),M=k.variant||R,P={...r,variant:M,classes:s},I=(e=>{const{classes:t}=e,n=tJ({root:["root"]},_he,t);return{...t,...n}})(P),{root:A,...D}=I,F=h||{standard:(0,MH.jsx)(Yhe,{ownerState:P}),outlined:(0,MH.jsx)(qhe,{label:g,ownerState:P}),filled:(0,MH.jsx)(Xhe,{ownerState:P})}[M],O=uae(n,Nse(F));return(0,MH.jsx)(t.Fragment,{children:t.cloneElement(F,{inputComponent:T,inputProps:{children:o,error:k.error,IconComponent:u,variant:M,type:void 0,multiple:v,...w?{id:d}:{autoWidth:i,defaultOpen:l,displayEmpty:c,labelId:f,MenuProps:m,onClose:b,onOpen:C,open:y,renderValue:S,SelectDisplayProps:{id:d,...x}},...p,classes:p?UZ(D,p.classes):D,...h?h.props.inputProps:{}},...(v&&w||c)&&"outlined"===M?{notched:!0}:{},ref:O,className:QQ(F.props.className,a,I.root),...!h&&{variant:M},...E})})});Qhe.muiName="Select";const Jhe=Qhe;function Zhe(e){return k2("MuiTextField",e)}M2("MuiTextField",["root"]);const epe={standard:Yue,filled:Jue,outlined:sde},tpe=x2(yde,{name:"MuiTextField",slot:"Root"})({}),npe=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:i=!1,children:o,className:s,color:a="primary",defaultValue:l,disabled:c=!1,error:u=!1,FormHelperTextProps:d,fullWidth:h=!1,helperText:p,id:g,InputLabelProps:f,inputProps:m,InputProps:v,inputRef:w,label:b,maxRows:C,minRows:y,multiline:S=!1,name:x,onBlur:R,onChange:E,onFocus:T,placeholder:k,required:M=!1,rows:P,select:I=!1,SelectProps:A,slots:D={},slotProps:F={},type:O,value:N,variant:L="outlined",..._}=n,H={...n,autoFocus:i,color:a,disabled:c,error:u,fullWidth:h,multiline:S,required:M,select:I,variant:L},V=(e=>{const{classes:t}=e;return tJ({root:["root"]},Zhe,t)})(H);const B=l5(g),W=p&&B?`${B}-helper-text`:void 0,z=b&&B?`${B}-label`:void 0,j=epe[L],G={slots:D,slotProps:{input:v,inputLabel:f,htmlInput:m,formHelperText:d,select:A,...F}},$={},U=G.slotProps.inputLabel;"outlined"===L&&(U&&"undefined"!==typeof U.shrink&&($.notched=U.shrink),$.label=b),I&&(A&&A.native||($.id=void 0),$["aria-describedby"]=void 0);const[K,Y]=lle("root",{elementType:tpe,shouldForwardComponentProp:!0,externalForwardedProps:{...G,..._},ownerState:H,className:QQ(V.root,s),ref:t,additionalProps:{disabled:c,error:u,fullWidth:h,required:M,color:a,variant:L}}),[q,X]=lle("input",{elementType:j,externalForwardedProps:G,additionalProps:$,ownerState:H}),[Q,J]=lle("inputLabel",{elementType:mde,externalForwardedProps:G,ownerState:H}),[Z,ee]=lle("htmlInput",{elementType:"input",externalForwardedProps:G,ownerState:H}),[te,ne]=lle("formHelperText",{elementType:kde,externalForwardedProps:G,ownerState:H}),[re,ie]=lle("select",{elementType:Jhe,externalForwardedProps:G,ownerState:H}),oe=(0,MH.jsx)(q,{"aria-describedby":W,autoComplete:r,autoFocus:i,defaultValue:l,fullWidth:h,multiline:S,name:x,rows:P,maxRows:C,minRows:y,type:O,value:N,id:B,inputRef:w,onBlur:R,onChange:E,onFocus:T,placeholder:k,inputProps:ee,slots:{input:D.htmlInput?Z:void 0},...X});return(0,MH.jsxs)(K,{...Y,children:[null!=b&&""!==b&&(0,MH.jsx)(Q,{htmlFor:B,id:z,...J,children:b}),I?(0,MH.jsx)(re,{"aria-describedby":W,id:B,labelId:z,value:N,input:oe,...ie,children:o}):oe,p&&(0,MH.jsx)(te,{id:W,...ne,children:p})]})}),rpe=npe;function ipe(e){return k2("MuiFormControlLabel",e)}const ope=M2("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),spe=x2("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${ope.label}`]:t.label},t.root,t[`labelPlacement${Jse(n.labelPlacement)}`]]}})(Qse(e=>{let{theme:t}=e;return{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${ope.disabled}`]:{cursor:"default"},[`& .${ope.label}`]:{[`&.${ope.disabled}`]:{color:(t.vars||t).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:e=>{let{labelPlacement:t}=e;return"start"===t||"top"===t||"bottom"===t},style:{marginLeft:16}}]}})),ape=x2("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(Qse(e=>{let{theme:t}=e;return{[`&.${ope.error}`]:{color:(t.vars||t).palette.error.main}}})),lpe=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiFormControlLabel"}),{checked:i,className:o,componentsProps:s={},control:a,disabled:l,disableTypography:c,inputRef:u,label:d,labelPlacement:h="end",name:p,onChange:g,required:f,slots:m={},slotProps:v={},value:w,...b}=r,C=qle(),y=l??a.props.disabled??C?.disabled,S=f??a.props.required,x={disabled:y,required:S};["checked","name","onChange","value","inputRef"].forEach(e=>{"undefined"===typeof a.props[e]&&"undefined"!==typeof r[e]&&(x[e]=r[e])});const R=Tce({props:r,muiFormControl:C,states:["error"]}),E={...r,disabled:y,labelPlacement:h,required:S,error:R.error},T=(e=>{const{classes:t,disabled:n,labelPlacement:r,error:i,required:o}=e;return tJ({root:["root",n&&"disabled",`labelPlacement${Jse(r)}`,i&&"error",o&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",i&&"error"]},ipe,t)})(E),k={slots:m,slotProps:{...s,...v}},[M,P]=lle("typography",{elementType:Cue,externalForwardedProps:k,ownerState:E});let I=d;return null==I||I.type===Cue||c||(I=(0,MH.jsx)(M,{component:"span",...P,className:QQ(T.label,P?.className),children:I})),(0,MH.jsxs)(spe,{className:QQ(T.root,o),ownerState:E,ref:n,...b,children:[t.cloneElement(a,x),S?(0,MH.jsxs)("div",{children:[I,(0,MH.jsxs)(ape,{ownerState:E,"aria-hidden":!0,className:T.asterisk,children:["\u2009","*"]})]}):I]})}),cpe=lpe;function upe(e){return k2("MuiSwitch",e)}const dpe=M2("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),hpe=x2("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.edge&&t[`edge${Jse(n.edge)}`],t[`size${Jse(n.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${dpe.thumb}`]:{width:16,height:16},[`& .${dpe.switchBase}`]:{padding:4,[`&.${dpe.checked}`]:{transform:"translateX(16px)"}}}}]}),ppe=x2(ece,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.switchBase,{[`& .${dpe.input}`]:t.input},"default"!==n.color&&t[`color${Jse(n.color)}`]]}})(Qse(e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${"light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${dpe.checked}`]:{transform:"translateX(20px)"},[`&.${dpe.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${dpe.checked} + .${dpe.track}`]:{opacity:.5},[`&.${dpe.disabled} + .${dpe.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:""+("light"===t.palette.mode?.12:.2)},[`& .${dpe.input}`]:{left:"-100%",width:"300%"}}}),Qse(e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(lae(["light"])).map(e=>{let[n]=e;return{props:{color:n},style:{[`&.${dpe.checked}`]:{color:(t.vars||t).palette[n].main,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette[n].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${dpe.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${n}DisabledColor`]:`${"light"===t.palette.mode?y1(t.palette[n].main,.62):b1(t.palette[n].main,.55)}`}},[`&.${dpe.checked} + .${dpe.track}`]:{backgroundColor:(t.vars||t).palette[n].main}}}})]}})),gpe=x2("span",{name:"MuiSwitch",slot:"Track"})(Qse(e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${"light"===t.palette.mode?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:""+("light"===t.palette.mode?.38:.3)}})),fpe=x2("span",{name:"MuiSwitch",slot:"Thumb"})(Qse(e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}})),mpe=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiSwitch"}),{className:r,color:i="primary",edge:o=!1,size:s="medium",sx:a,slots:l={},slotProps:c={},...u}=n,d={...n,color:i,edge:o,size:s},h=(e=>{const{classes:t,edge:n,size:r,color:i,checked:o,disabled:s}=e,a=tJ({root:["root",n&&`edge${Jse(n)}`,`size${Jse(r)}`],switchBase:["switchBase",`color${Jse(i)}`,o&&"checked",s&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},upe,t);return{...t,...a}})(d),p={slots:l,slotProps:c},[g,f]=lle("root",{className:QQ(h.root,r),elementType:hpe,externalForwardedProps:p,ownerState:d,additionalProps:{sx:a}}),[m,v]=lle("thumb",{className:h.thumb,elementType:fpe,externalForwardedProps:p,ownerState:d}),w=(0,MH.jsx)(m,{...v}),[b,C]=lle("track",{className:h.track,elementType:gpe,externalForwardedProps:p,ownerState:d});return(0,MH.jsxs)(g,{...f,children:[(0,MH.jsx)(ppe,{type:"checkbox",icon:w,checkedIcon:w,ref:t,ownerState:d,...u,classes:{...h,root:h.switchBase},slots:{...l.switchBase&&{root:l.switchBase},...l.input&&{input:l.input}},slotProps:{...c.switchBase&&{root:"function"===typeof c.switchBase?c.switchBase(d):c.switchBase},...c.input&&{input:"function"===typeof c.input?c.input(d):c.input}}}),(0,MH.jsx)(b,{...C})]})}),vpe=mpe;function wpe(e){return k2("MuiButton",e)}const bpe=M2("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]);const Cpe=t.createContext({});const ype=t.createContext(void 0),Spe=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],xpe=x2(Lae,{shouldForwardProp:e=>S2(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${Jse(n.color)}`],t[`size${Jse(n.size)}`],t[`${n.variant}Size${Jse(n.size)}`],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth,n.loading&&t.loading]}})(Qse(e=>{let{theme:t}=e;const n="light"===t.palette.mode?t.palette.grey[300]:t.palette.grey[800],r="light"===t.palette.mode?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${bpe.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${bpe.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${bpe.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${bpe.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(lae()).map(e=>{let[n]=e;return{props:{color:n},style:{"--variant-textColor":(t.vars||t).palette[n].main,"--variant-outlinedColor":(t.vars||t).palette[n].main,"--variant-outlinedBorder":t.vars?`rgba(${t.vars.palette[n].mainChannel} / 0.5)`:v1(t.palette[n].main,.5),"--variant-containedColor":(t.vars||t).palette[n].contrastText,"--variant-containedBg":(t.vars||t).palette[n].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[n].dark,"--variant-textBg":t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette[n].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[n].main,"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette[n].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette[n].main,t.palette.action.hoverOpacity)}}}}}),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:n,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:r,"--variant-textBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:v1(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${bpe.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${bpe.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${bpe.loading}`]:{color:"transparent"}}}]}})),Rpe=x2("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,n.loading&&t.startIconLoadingStart,t[`iconSize${Jse(n.size)}`]]}})(e=>{let{theme:t}=e;return{display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...Spe]}}),Epe=x2("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,n.loading&&t.endIconLoadingEnd,t[`iconSize${Jse(n.size)}`]]}})(e=>{let{theme:t}=e;return{display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...Spe]}}),Tpe=x2("span",{name:"MuiButton",slot:"LoadingIndicator"})(e=>{let{theme:t}=e;return{display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]}}),kpe=x2("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Mpe=t.forwardRef(function(e,n){const r=t.useContext(Cpe),i=t.useContext(ype),o=Use({props:D4(r,e),name:"MuiButton"}),{children:s,color:a="primary",component:l="button",className:c,disabled:u=!1,disableElevation:d=!1,disableFocusRipple:h=!1,endIcon:p,focusVisibleClassName:g,fullWidth:f=!1,id:m,loading:v=null,loadingIndicator:w,loadingPosition:b="center",size:C="medium",startIcon:y,type:S,variant:x="text",...R}=o,E=aae(m),T=w??(0,MH.jsx)(Kae,{"aria-labelledby":E,color:"inherit",size:16}),k={...o,color:a,component:l,disabled:u,disableElevation:d,disableFocusRipple:h,fullWidth:f,loading:v,loadingIndicator:T,loadingPosition:b,size:C,type:S,variant:x},M=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:i,variant:o,loading:s,loadingPosition:a,classes:l}=e,c=tJ({root:["root",s&&"loading",o,`${o}${Jse(t)}`,`size${Jse(i)}`,`${o}Size${Jse(i)}`,`color${Jse(t)}`,n&&"disableElevation",r&&"fullWidth",s&&`loadingPosition${Jse(a)}`],startIcon:["icon","startIcon",`iconSize${Jse(i)}`],endIcon:["icon","endIcon",`iconSize${Jse(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},wpe,l);return{...l,...c}})(k),P=(y||v&&"start"===b)&&(0,MH.jsx)(Rpe,{className:M.startIcon,ownerState:k,children:y||(0,MH.jsx)(kpe,{className:M.loadingIconPlaceholder,ownerState:k})}),I=(p||v&&"end"===b)&&(0,MH.jsx)(Epe,{className:M.endIcon,ownerState:k,children:p||(0,MH.jsx)(kpe,{className:M.loadingIconPlaceholder,ownerState:k})}),A=i||"",D="boolean"===typeof v?(0,MH.jsx)("span",{className:M.loadingWrapper,style:{display:"contents"},children:v&&(0,MH.jsx)(Tpe,{className:M.loadingIndicator,ownerState:k,children:T})}):null;return(0,MH.jsxs)(xpe,{ownerState:k,className:QQ(r.className,M.root,c,A),component:l,disabled:u||v,focusRipple:!h,focusVisibleClassName:QQ(M.focusVisible,g),ref:n,type:S,id:v?E:m,...R,classes:M,children:[P,"end"!==b&&D,s,"end"===b&&D,I]})}),Ppe=Mpe;function Ipe(e){return k2("MuiInputAdornment",e)}const Ape=M2("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var Dpe;const Fpe=x2("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`position${Jse(n.position)}`],!0===n.disablePointerEvents&&t.disablePointerEvents,t[n.variant]]}})(Qse(e=>{let{theme:t}=e;return{display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(t.vars||t).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${Ape.positionStart}&:not(.${Ape.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}})),Ope=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiInputAdornment"}),{children:i,className:o,component:s="div",disablePointerEvents:a=!1,disableTypography:l=!1,position:c,variant:u,...d}=r,h=qle()||{};let p=u;u&&h.variant,h&&!p&&(p=h.variant);const g={...r,hiddenLabel:h.hiddenLabel,size:h.size,disablePointerEvents:a,position:c,variant:p},f=(e=>{const{classes:t,disablePointerEvents:n,hiddenLabel:r,position:i,size:o,variant:s}=e;return tJ({root:["root",n&&"disablePointerEvents",i&&`position${Jse(i)}`,s,r&&"hiddenLabel",o&&`size${Jse(o)}`]},Ipe,t)})(g);return(0,MH.jsx)(Yle.Provider,{value:null,children:(0,MH.jsx)(Fpe,{as:s,ownerState:g,className:QQ(f.root,o),ref:n,...d,children:"string"!==typeof i||l?(0,MH.jsxs)(t.Fragment,{children:["start"===c?Dpe||(Dpe=(0,MH.jsx)("span",{className:"notranslate","aria-hidden":!0,children:"\u200b"})):null,i]}):(0,MH.jsx)(Cue,{color:"textSecondary",children:i})})})}),Npe=Ope;function Lpe(e){return k2("MuiTooltip",e)}const _pe=M2("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);const Hpe=x2(qse,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})(Qse(e=>{let{theme:t}=e;return{zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:e=>{let{ownerState:t}=e;return!t.disableInteractive},style:{pointerEvents:"auto"}},{props:e=>{let{open:t}=e;return!t},style:{pointerEvents:"none"}},{props:e=>{let{ownerState:t}=e;return t.arrow},style:{[`&[data-popper-placement*="bottom"] .${_pe.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${_pe.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${_pe.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${_pe.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:e=>{let{ownerState:t}=e;return t.arrow&&!t.isRtl},style:{[`&[data-popper-placement*="right"] .${_pe.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:e=>{let{ownerState:t}=e;return t.arrow&&!!t.isRtl},style:{[`&[data-popper-placement*="right"] .${_pe.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:e=>{let{ownerState:t}=e;return t.arrow&&!t.isRtl},style:{[`&[data-popper-placement*="left"] .${_pe.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:e=>{let{ownerState:t}=e;return t.arrow&&!!t.isRtl},style:{[`&[data-popper-placement*="left"] .${_pe.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}})),Vpe=x2("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${Jse(n.placement.split("-")[0])}`]]}})(Qse(e=>{let{theme:t}=e;return{backgroundColor:t.vars?t.vars.palette.Tooltip.bg:v1(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${_pe.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${_pe.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${_pe.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${_pe.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:e=>{let{ownerState:t}=e;return t.arrow},style:{position:"relative",margin:0}},{props:e=>{let{ownerState:t}=e;return t.touch},style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:(n=16/14,Math.round(1e5*n)/1e5)+"em",fontWeight:t.typography.fontWeightRegular}},{props:e=>{let{ownerState:t}=e;return!t.isRtl},style:{[`.${_pe.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${_pe.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:e=>{let{ownerState:t}=e;return!t.isRtl&&t.touch},style:{[`.${_pe.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${_pe.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:e=>{let{ownerState:t}=e;return!!t.isRtl},style:{[`.${_pe.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${_pe.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:e=>{let{ownerState:t}=e;return!!t.isRtl&&t.touch},style:{[`.${_pe.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${_pe.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:e=>{let{ownerState:t}=e;return t.touch},style:{[`.${_pe.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:e=>{let{ownerState:t}=e;return t.touch},style:{[`.${_pe.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]};var n})),Bpe=x2("span",{name:"MuiTooltip",slot:"Arrow"})(Qse(e=>{let{theme:t}=e;return{overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:v1(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}}));let Wpe=!1;const zpe=new I4;let jpe={x:0,y:0};function Gpe(e,t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];t&&t(n,...i),e(n,...i)}}const $pe=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiTooltip"}),{arrow:i=!1,children:o,classes:s,components:a={},componentsProps:l={},describeChild:c=!1,disableFocusListener:u=!1,disableHoverListener:d=!1,disableInteractive:h=!1,disableTouchListener:p=!1,enterDelay:g=100,enterNextDelay:f=0,enterTouchDelay:m=700,followCursor:v=!1,id:w,leaveDelay:b=0,leaveTouchDelay:C=1500,onClose:y,onOpen:S,open:x,placement:R="bottom",PopperComponent:E,PopperProps:T={},slotProps:k={},slots:M={},title:P,TransitionComponent:I,TransitionProps:A,...D}=r,F=t.isValidElement(o)?o:(0,MH.jsx)("span",{children:o}),O=Rne(),N=z6(),[L,_]=t.useState(),[H,V]=t.useState(null),B=t.useRef(!1),W=h||v,z=A4(),j=A4(),G=A4(),$=A4(),[U,K]=Kle({controlled:x,default:!1,name:"Tooltip",state:"open"});let Y=U;const q=aae(w),X=t.useRef(),Q=dae(()=>{void 0!==X.current&&(document.body.style.WebkitUserSelect=X.current,X.current=void 0),$.clear()});t.useEffect(()=>Q,[Q]);const J=e=>{zpe.clear(),Wpe=!0,K(!0),S&&!Y&&S(e)},Z=dae(e=>{zpe.start(800+b,()=>{Wpe=!1}),K(!1),y&&Y&&y(e),z.start(O.transitions.duration.shortest,()=>{B.current=!1})}),ee=e=>{B.current&&"touchstart"!==e.type||(L&&L.removeAttribute("title"),j.clear(),G.clear(),g||Wpe&&f?j.start(Wpe?f:g,()=>{J(e)}):J(e))},te=e=>{j.clear(),G.start(b,()=>{Z(e)})},[,ne]=t.useState(!1),re=e=>{cae(e.target)||(ne(!1),te(e))},ie=e=>{L||_(e.currentTarget),cae(e.target)&&(ne(!0),ee(e))},oe=e=>{B.current=!0;const t=F.props;t.onTouchStart&&t.onTouchStart(e)},se=e=>{oe(e),G.clear(),z.clear(),Q(),X.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",$.start(m,()=>{document.body.style.WebkitUserSelect=X.current,ee(e)})},ae=e=>{F.props.onTouchEnd&&F.props.onTouchEnd(e),Q(),G.start(C,()=>{Z(e)})};t.useEffect(()=>{if(Y)return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)};function e(e){"Escape"===e.key&&Z(e)}},[Z,Y]);const le=uae(Nse(F),_,n);P||0===P||(Y=!1);const ce=t.useRef(),ue={},de="string"===typeof P;c?(ue.title=Y||!de||d?null:P,ue["aria-describedby"]=Y?q:null):(ue["aria-label"]=de?P:null,ue["aria-labelledby"]=Y&&!de?q:null);const he={...ue,...D,...F.props,className:QQ(D.className,F.props.className),onTouchStart:oe,ref:le,...v?{onMouseMove:e=>{const t=F.props;t.onMouseMove&&t.onMouseMove(e),jpe={x:e.clientX,y:e.clientY},ce.current&&ce.current.update()}}:{}};const pe={};p||(he.onTouchStart=se,he.onTouchEnd=ae),d||(he.onMouseOver=Gpe(ee,he.onMouseOver),he.onMouseLeave=Gpe(te,he.onMouseLeave),W||(pe.onMouseOver=ee,pe.onMouseLeave=te)),u||(he.onFocus=Gpe(ie,he.onFocus),he.onBlur=Gpe(re,he.onBlur),W||(pe.onFocus=ie,pe.onBlur=re));const ge={...r,isRtl:N,arrow:i,disableInteractive:W,placement:R,PopperComponentProp:E,touch:B.current},fe="function"===typeof k.popper?k.popper(ge):k.popper,me=t.useMemo(()=>{let e=[{name:"arrow",enabled:Boolean(H),options:{element:H,padding:4}}];return T.popperOptions?.modifiers&&(e=e.concat(T.popperOptions.modifiers)),fe?.popperOptions?.modifiers&&(e=e.concat(fe.popperOptions.modifiers)),{...T.popperOptions,...fe?.popperOptions,modifiers:e}},[H,T.popperOptions,fe?.popperOptions]),ve=(e=>{const{classes:t,disableInteractive:n,arrow:r,touch:i,placement:o}=e;return tJ({popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",i&&"touch",`tooltipPlacement${Jse(o.split("-")[0])}`],arrow:["arrow"]},Lpe,t)})(ge),we="function"===typeof k.transition?k.transition(ge):k.transition,be={slots:{popper:a.Popper,transition:a.Transition??I,tooltip:a.Tooltip,arrow:a.Arrow,...M},slotProps:{arrow:k.arrow??l.arrow,popper:{...T,...fe??l.popper},tooltip:k.tooltip??l.tooltip,transition:{...A,...we??l.transition}}},[Ce,ye]=lle("popper",{elementType:Hpe,externalForwardedProps:be,ownerState:ge,className:QQ(ve.popper,T?.className)}),[Se,xe]=lle("transition",{elementType:Gde,externalForwardedProps:be,ownerState:ge}),[Re,Ee]=lle("tooltip",{elementType:Vpe,className:ve.tooltip,externalForwardedProps:be,ownerState:ge}),[Te,ke]=lle("arrow",{elementType:Bpe,className:ve.arrow,externalForwardedProps:be,ownerState:ge,ref:V});return(0,MH.jsxs)(t.Fragment,{children:[t.cloneElement(F,he),(0,MH.jsx)(Ce,{as:E??qse,placement:R,anchorEl:v?{getBoundingClientRect:()=>({top:jpe.y,left:jpe.x,right:jpe.x,bottom:jpe.y,width:0,height:0})}:L,popperRef:ce,open:!!L&&Y,id:q,transition:!0,...pe,...ye,popperOptions:me,children:e=>{let{TransitionProps:t}=e;return(0,MH.jsx)(Se,{timeout:O.transitions.duration.shorter,...t,...xe,children:(0,MH.jsxs)(Re,{...Ee,children:[P,i?(0,MH.jsx)(Te,{...ke}):null]})})}})]})}),Upe=$pe;const Kpe=t.createContext();const Ype=t.createContext();function qpe(e){return k2("MuiTableCell",e)}const Xpe=M2("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Qpe=x2("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`size${Jse(n.size)}`],"normal"!==n.padding&&t[`padding${Jse(n.padding)}`],"inherit"!==n.align&&t[`align${Jse(n.align)}`],n.stickyHeader&&t.stickyHeader]}})(Qse(e=>{let{theme:t}=e;return{...t.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?`1px solid ${t.vars.palette.TableCell.border}`:`1px solid\n    ${"light"===t.palette.mode?y1(v1(t.palette.divider,1),.88):b1(v1(t.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(t.vars||t).palette.text.primary}},{props:{variant:"footer"},style:{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Xpe.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:e=>{let{ownerState:t}=e;return t.stickyHeader},style:{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default}}]}})),Jpe=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiTableCell"}),{align:i="inherit",className:o,component:s,padding:a,scope:l,size:c,sortDirection:u,variant:d,...h}=r,p=t.useContext(Kpe),g=t.useContext(Ype),f=g&&"head"===g.variant;let m;m=s||(f?"th":"td");let v=l;"td"===m?v=void 0:!v&&f&&(v="col");const w=d||g&&g.variant,b={...r,align:i,component:m,padding:a||(p&&p.padding?p.padding:"normal"),size:c||(p&&p.size?p.size:"medium"),sortDirection:u,stickyHeader:"head"===w&&p&&p.stickyHeader,variant:w},C=(e=>{const{classes:t,variant:n,align:r,padding:i,size:o,stickyHeader:s}=e;return tJ({root:["root",n,s&&"stickyHeader","inherit"!==r&&`align${Jse(r)}`,"normal"!==i&&`padding${Jse(i)}`,`size${Jse(o)}`]},qpe,t)})(b);let y=null;return u&&(y="asc"===u?"ascending":"descending"),(0,MH.jsx)(Qpe,{as:m,ref:n,className:QQ(C.root,o),"aria-sort":y,scope:v,ownerState:b,...h})}),Zpe=Jpe;function ege(e){return k2("MuiToolbar",e)}M2("MuiToolbar",["root","gutters","regular","dense"]);const tge=x2("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})(Qse(e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",variants:[{props:e=>{let{ownerState:t}=e;return!t.disableGutters},style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}})),nge=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiToolbar"}),{className:r,component:i="div",disableGutters:o=!1,variant:s="regular",...a}=n,l={...n,component:i,disableGutters:o,variant:s},c=(e=>{const{classes:t,disableGutters:n,variant:r}=e;return tJ({root:["root",!n&&"gutters",r]},ege,t)})(l);return(0,MH.jsx)(tge,{as:i,className:QQ(c.root,r),ref:t,ownerState:l,...a})}),rge=nge,ige=ile((0,MH.jsx)("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),oge=ile((0,MH.jsx)("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"})),sge=ile((0,MH.jsx)("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"})),age=ile((0,MH.jsx)("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}));function lge(e){return k2("MuiTablePaginationActions",e)}M2("MuiTablePaginationActions",["root"]);const cge=x2("div",{name:"MuiTablePaginationActions",slot:"Root"})({}),uge=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiTablePaginationActions"}),{backIconButtonProps:r,className:i,count:o,disabled:s=!1,getItemAriaLabel:a,nextIconButtonProps:l,onPageChange:c,page:u,rowsPerPage:d,showFirstButton:h,showLastButton:p,slots:g={},slotProps:f={},...m}=n,v=z6(),w=(e=>{const{classes:t}=e;return tJ({root:["root"]},lge,t)})(n),b=g.firstButton??Zae,C=g.lastButton??Zae,y=g.nextButton??Zae,S=g.previousButton??Zae,x=g.firstButtonIcon??age,R=g.lastButtonIcon??sge,E=g.nextButtonIcon??oge,T=g.previousButtonIcon??ige,k=v?C:b,M=v?y:S,P=v?S:y,I=v?b:C,A=v?f.lastButton:f.firstButton,D=v?f.nextButton:f.previousButton,F=v?f.previousButton:f.nextButton,O=v?f.firstButton:f.lastButton;return(0,MH.jsxs)(cge,{ref:t,className:QQ(w.root,i),...m,children:[h&&(0,MH.jsx)(k,{onClick:e=>{c(e,0)},disabled:s||0===u,"aria-label":a("first",u),title:a("first",u),...A,children:v?(0,MH.jsx)(R,{...f.lastButtonIcon}):(0,MH.jsx)(x,{...f.firstButtonIcon})}),(0,MH.jsx)(M,{onClick:e=>{c(e,u-1)},disabled:s||0===u,color:"inherit","aria-label":a("previous",u),title:a("previous",u),...D??r,children:v?(0,MH.jsx)(E,{...f.nextButtonIcon}):(0,MH.jsx)(T,{...f.previousButtonIcon})}),(0,MH.jsx)(P,{onClick:e=>{c(e,u+1)},disabled:s||-1!==o&&u>=Math.ceil(o/d)-1,color:"inherit","aria-label":a("next",u),title:a("next",u),...F??l,children:v?(0,MH.jsx)(T,{...f.previousButtonIcon}):(0,MH.jsx)(E,{...f.nextButtonIcon})}),p&&(0,MH.jsx)(I,{onClick:e=>{c(e,Math.max(0,Math.ceil(o/d)-1))},disabled:s||u>=Math.ceil(o/d)-1,"aria-label":a("last",u),title:a("last",u),...O,children:v?(0,MH.jsx)(x,{...f.firstButtonIcon}):(0,MH.jsx)(R,{...f.lastButtonIcon})})]})}),dge=uge;function hge(e){return k2("MuiTablePagination",e)}const pge=M2("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var gge;const fge=x2(Zpe,{name:"MuiTablePagination",slot:"Root"})(Qse(e=>{let{theme:t}=e;return{overflow:"auto",color:(t.vars||t).palette.text.primary,fontSize:t.typography.pxToRem(14),"&:last-child":{padding:0}}})),mge=x2(rge,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(e,t)=>({[`& .${pge.actions}`]:t.actions,...t.toolbar})})(Qse(e=>{let{theme:t}=e;return{minHeight:52,paddingRight:2,[`${t.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[t.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${pge.actions}`]:{flexShrink:0,marginLeft:20}}})),vge=x2("div",{name:"MuiTablePagination",slot:"Spacer"})({flex:"1 1 100%"}),wge=x2("p",{name:"MuiTablePagination",slot:"SelectLabel"})(Qse(e=>{let{theme:t}=e;return{...t.typography.body2,flexShrink:0}})),bge=x2(Jhe,{name:"MuiTablePagination",slot:"Select",overridesResolver:(e,t)=>({[`& .${pge.selectIcon}`]:t.selectIcon,[`& .${pge.select}`]:t.select,...t.input,...t.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${pge.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),Cge=x2(Gue,{name:"MuiTablePagination",slot:"MenuItem"})({}),yge=x2("p",{name:"MuiTablePagination",slot:"DisplayedRows"})(Qse(e=>{let{theme:t}=e;return{...t.typography.body2,flexShrink:0}}));function Sge(e){let{from:t,to:n,count:r}=e;return`${t}\u2013${n} of ${-1!==r?r:`more than ${n}`}`}function xge(e){return`Go to ${e} page`}const Rge=t.forwardRef(function(e,n){const r=Use({props:e,name:"MuiTablePagination"}),{ActionsComponent:i=dge,backIconButtonProps:o,colSpan:s,component:a=Zpe,count:l,disabled:c=!1,getItemAriaLabel:u=xge,labelDisplayedRows:d=Sge,labelRowsPerPage:h="Rows per page:",nextIconButtonProps:p,onPageChange:g,onRowsPerPageChange:f,page:m,rowsPerPage:v,rowsPerPageOptions:w=[10,25,50,100],SelectProps:b={},showFirstButton:C=!1,showLastButton:y=!1,slotProps:S={},slots:x={},...R}=r,E=r,T=(e=>{const{classes:t}=e;return tJ({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},hge,t)})(E),k=S?.select??b,M=k.native?"option":Cge;let P;a!==Zpe&&"td"!==a||(P=s||1e3);const I=aae(k.id),A=aae(k.labelId),D={slots:x,slotProps:S},[F,O]=lle("root",{ref:n,className:T.root,elementType:fge,externalForwardedProps:{...D,component:a,...R},ownerState:E,additionalProps:{colSpan:P}}),[N,L]=lle("toolbar",{className:T.toolbar,elementType:mge,externalForwardedProps:D,ownerState:E}),[_,H]=lle("spacer",{className:T.spacer,elementType:vge,externalForwardedProps:D,ownerState:E}),[V,B]=lle("selectLabel",{className:T.selectLabel,elementType:wge,externalForwardedProps:D,ownerState:E,additionalProps:{id:A}}),[W,z]=lle("select",{className:T.select,elementType:bge,externalForwardedProps:D,ownerState:E}),[j,G]=lle("menuItem",{className:T.menuItem,elementType:M,externalForwardedProps:D,ownerState:E}),[$,U]=lle("displayedRows",{className:T.displayedRows,elementType:yge,externalForwardedProps:D,ownerState:E});return(0,MH.jsx)(F,{...O,children:(0,MH.jsxs)(N,{...L,children:[(0,MH.jsx)(_,{...H}),w.length>1&&(0,MH.jsx)(V,{...B,children:h}),w.length>1&&(0,MH.jsx)(W,{variant:"standard",...!k.variant&&{input:gge||(gge=(0,MH.jsx)(zce,{}))},value:v,onChange:f,id:I,labelId:A,...k,classes:{...k.classes,root:QQ(T.input,T.selectRoot,(k.classes||{}).root),select:QQ(T.select,(k.classes||{}).select),icon:QQ(T.selectIcon,(k.classes||{}).icon)},disabled:c,...z,children:w.map(e=>(0,t.createElement)(j,{...G,key:e.label?e.label:e,value:e.value?e.value:e},e.label?e.label:e))}),(0,MH.jsx)($,{...U,children:d({from:0===l?0:m*v+1,to:-1===l?(m+1)*v:-1===v?l:Math.min(l,(m+1)*v),count:-1===l?-1:l,page:m})}),(0,MH.jsx)(i,{className:T.actions,backIconButtonProps:o,count:l,nextIconButtonProps:p,onPageChange:g,page:m,rowsPerPage:v,showFirstButton:C,showLastButton:y,slotProps:S.actions,slots:x.actions,getItemAriaLabel:u,disabled:c})]})})}),Ege=Rge;function Tge(e){return e.substring(2).toLowerCase()}function kge(e){const{children:n,disableReactTree:r=!1,mouseEvent:i="onClick",onClickAway:o,touchEvent:s="onTouchEnd"}=e,a=t.useRef(!1),l=t.useRef(null),c=t.useRef(!1),u=t.useRef(!1);t.useEffect(()=>(setTimeout(()=>{c.current=!0},0),()=>{c.current=!1}),[]);const d=JQ(Nse(n),l),h=w4(e=>{const t=u.current;u.current=!1;const n=Iee(l.current);if(!c.current||!l.current||"clientX"in e&&function(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}(e,n))return;if(a.current)return void(a.current=!1);let i;i=e.composedPath?e.composedPath().includes(l.current):!n.documentElement.contains(e.target)||l.current.contains(e.target),i||!r&&t||o(e)}),p=e=>t=>{u.current=!0;const r=n.props[e];r&&r(t)},g={ref:d};return!1!==s&&(g[s]=p(s)),t.useEffect(()=>{if(!1!==s){const e=Tge(s),t=Iee(l.current),n=()=>{a.current=!0};return t.addEventListener(e,h),t.addEventListener("touchmove",n),()=>{t.removeEventListener(e,h),t.removeEventListener("touchmove",n)}}},[h,s]),!1!==i&&(g[i]=p(i)),t.useEffect(()=>{if(!1!==i){const e=Tge(i),t=Iee(l.current);return t.addEventListener(e,h),()=>{t.removeEventListener(e,h)}}},[h,i]),t.cloneElement(n,g)}function Mge(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Pge(e){return parseFloat(e)}function Ige(e){return k2("MuiSkeleton",e)}M2("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Age=qre`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,Dge=qre`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Fge="string"!==typeof Age?Yre`
        animation: ${Age} 2s ease-in-out 0.5s infinite;
      `:null,Oge="string"!==typeof Dge?Yre`
        &::after {
          animation: ${Dge} 2s linear 0.5s infinite;
        }
      `:null,Nge=x2("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],!1!==n.animation&&t[n.animation],n.hasChildren&&t.withChildren,n.hasChildren&&!n.width&&t.fitContent,n.hasChildren&&!n.height&&t.heightAuto]}})(Qse(e=>{let{theme:t}=e;const n=Mge(t.shape.borderRadius)||"px",r=Pge(t.shape.borderRadius);return{display:"block",backgroundColor:t.vars?t.vars.palette.Skeleton.bg:v1(t.palette.text.primary,"light"===t.palette.mode?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${r}${n}/${Math.round(r/.6*10)/10}${n}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:e=>{let{ownerState:t}=e;return t.hasChildren},style:{"& > *":{visibility:"hidden"}}},{props:e=>{let{ownerState:t}=e;return t.hasChildren&&!t.width},style:{maxWidth:"fit-content"}},{props:e=>{let{ownerState:t}=e;return t.hasChildren&&!t.height},style:{height:"auto"}},{props:{animation:"pulse"},style:Fge||{animation:`${Age} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(\n                90deg,\n                transparent,\n                ${(t.vars||t).palette.action.hover},\n                transparent\n              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:Oge||{"&::after":{animation:`${Dge} 2s linear 0.5s infinite`}}}]}})),Lge=t.forwardRef(function(e,t){const n=Use({props:e,name:"MuiSkeleton"}),{animation:r="pulse",className:i,component:o="span",height:s,style:a,variant:l="text",width:c,...u}=n,d={...n,animation:r,component:o,variant:l,hasChildren:Boolean(u.children)},h=(e=>{const{classes:t,variant:n,animation:r,hasChildren:i,width:o,height:s}=e;return tJ({root:["root",n,r,i&&"withChildren",i&&!o&&"fitContent",i&&!s&&"heightAuto"]},Ige,t)})(d);return(0,MH.jsx)(Nge,{as:o,ref:t,className:QQ(h.root,i),ownerState:d,...u,style:{width:c,height:s,...a}})}),_ge=Lge,Hge=ile,Vge=Hge((0,MH.jsx)("path",{d:"M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"}),"ArrowUpward"),Bge=Hge((0,MH.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),Wge=Hge((0,MH.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"KeyboardArrowRight"),zge=Hge((0,MH.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore"),jge=Hge((0,MH.jsx)("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList"),Gge=Hge((0,MH.jsx)("path",{d:"M4.25 5.61C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAlt"),$ge=Hge((0,MH.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search"),Uge=(Hge((0,MH.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}),"Menu"),Hge((0,MH.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle"),Hge((0,MH.jsx)("path",{d:"M14.67 5v14H9.33V5zm1 14H21V5h-5.33zm-7.34 0V5H3v14z"}),"ColumnIcon")),Kge=Hge((0,MH.jsx)("rect",{width:"1",height:"24",x:"11.5",rx:"0.5"}),"Separator"),Yge=Hge((0,MH.jsx)("path",{d:"M4 15h16v-2H4v2zm0 4h16v-2H4v2zm0-8h16V9H4v2zm0-6v2h16V5H4z"}),"ViewHeadline"),qge=Hge((0,MH.jsx)("path",{d:"M21,8H3V4h18V8z M21,10H3v4h18V10z M21,16H3v4h18V16z"}),"TableRows"),Xge=Hge((0,MH.jsx)("path",{d:"M4 18h17v-6H4v6zM4 5v6h17V5H4z"}),"ViewStream"),Qge=Hge((0,MH.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"TripleDotsVertical"),Jge=Hge((0,MH.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Zge=Hge((0,MH.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add"),efe=Hge((0,MH.jsx)("path",{d:"M19 13H5v-2h14v2z"}),"Remove"),tfe=Hge((0,MH.jsx)("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"Load"),nfe=Hge((0,MH.jsx)("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"Drag"),rfe=Hge((0,MH.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),ife=Hge((0,MH.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert"),ofe=Hge((0,MH.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff"),sfe=Hge((0,MH.jsx)("g",{children:(0,MH.jsx)("path",{d:"M14.67,5v14H9.33V5H14.67z M15.67,19H21V5h-5.33V19z M8.33,19V5H3v14H8.33z"})}),"ViewColumn"),afe=Hge((0,MH.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Clear"),lfe=(Hge((0,MH.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete"),Hge((0,MH.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")),cfe=Hge((0,MH.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download"),ufe=["id","label","labelId","material","disabled","slotProps","onChange","onKeyDown","onOpen","onClose","size","style","fullWidth"],dfe=["onRowsPerPageChange","material","disabled"],hfe=["material"],pfe=["autoFocus","label","fullWidth","slotProps","className","material"],gfe=["material"],ffe=["material"],mfe=["material"],vfe=["material"],wfe=["material"],bfe=["material"],Cfe=["material"],yfe=["material"],Sfe=["material","label","className"],xfe=["material"],Rfe=["inert","iconStart","iconEnd","children","material"],Efe=["slotProps","material"],Tfe=["id","multiple","freeSolo","options","getOptionLabel","isOptionEqualToValue","value","onChange","label","placeholder","slotProps","material"],kfe=["key"],Mfe=["inputProps","InputProps","InputLabelProps"],Pfe=["slotProps","material"],Ife=["ref","open","children","className","clickAwayTouchEvent","clickAwayMouseEvent","flip","focusTrap","onExited","onClickAway","onDidShow","onDidHide","id","target","transition","placement","material"],Afe=["native"],Dfe=x2(Npe)(e=>{let{theme:t}=e;return{[`&.${Ape.positionEnd} .${qae.sizeSmall}`]:{marginRight:t.spacing(-.75)}}}),Ffe=x2(cpe,{shouldForwardProp:e=>"fullWidth"!==e})(e=>{let{theme:t}=e;return{gap:t.spacing(.5),margin:0,overflow:"hidden",[`& .${ope.label}`]:{fontSize:t.typography.pxToRem(14),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},variants:[{props:{fullWidth:!0},style:{width:"100%"}}]}}),Ofe=x2(hce,{shouldForwardProp:e=>"density"!==e})(e=>{let{theme:t}=e;return{variants:[{props:{density:"compact"},style:{padding:t.spacing(.5)}}]}}),Nfe=x2(Eue)({[`& .${Sue.primary}`]:{overflowX:"clip",textOverflow:"ellipsis",maxWidth:"300px"}}),Lfe=YQ(function(e,t){const{id:n,label:r,labelId:i,material:o,disabled:s,slotProps:a,onChange:l,onKeyDown:c,onOpen:u,onClose:d,size:h,style:p,fullWidth:g}=e,f=qQ(e,ufe),m={PaperProps:{onKeyDown:c}};return d&&(m.onClose=d),(0,MH.jsxs)(yde,{size:h,fullWidth:g,style:p,disabled:s,ref:t,children:[(0,MH.jsx)(mde,{id:i,htmlFor:n,shrink:!0,variant:"outlined",children:r}),(0,MH.jsx)(Jhe,$Q({id:n,labelId:i,label:r,displayEmpty:!0,onChange:l},f,{variant:"outlined",notched:!0,inputProps:a?.htmlInput,onOpen:u,MenuProps:m,size:h},o))]})});const _fe=x2(Ege)(e=>{let{theme:t}=e;return{[`& .${pge.selectLabel}`]:{display:"none",[t.breakpoints.up("sm")]:{display:"block"}},[`& .${pge.input}`]:{display:"none",[t.breakpoints.up("sm")]:{display:"inline-flex"}}}}),Hfe=YQ(function(e,n){const{onRowsPerPageChange:r,material:i,disabled:o}=e,s=qQ(e,dfe),a=t.useMemo(()=>{if(o)return{backIconButtonProps:{disabled:!0},nextIconButtonProps:{disabled:!0}}},[o]),l=J3(),c=e3(),{estimatedRowCount:u}=c;return(0,MH.jsx)(_fe,$Q({component:"div",onRowsPerPageChange:w4(e=>{r?.(Number(e.target.value))}),labelRowsPerPage:l.current.getLocaleText("paginationRowsPerPage"),labelDisplayedRows:e=>l.current.getLocaleText("paginationDisplayedRows")($Q({},e,{estimated:u})),getItemAriaLabel:l.current.getLocaleText("paginationItemAriaLabel")},a,s,i,{ref:n}))});const Vfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,hfe);return(0,MH.jsx)(Ule,$Q({},r,n,{ref:t}))});const Bfe=YQ(function(e,n){const{autoFocus:r,label:i,fullWidth:o,slotProps:s,className:a,material:l}=e,c=qQ(e,pfe),u=t.useRef(null),d=JQ(u,n),h=t.useRef(null);return t.useEffect(()=>{if(r){const e=u.current?.querySelector("input");e?.focus({preventScroll:!0})}else!1===r&&h.current&&h.current.stop({})},[r]),i?(0,MH.jsx)(Ffe,{className:a,control:(0,MH.jsx)(Ofe,$Q({},c,l,{inputProps:s?.htmlInput,ref:d,touchRippleRef:h})),label:i,fullWidth:o}):(0,MH.jsx)(Ofe,$Q({},c,l,{className:QQ(a,l?.className),inputProps:s?.htmlInput,ref:d,touchRippleRef:h}))});const Wfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,gfe);return(0,MH.jsx)(Kae,$Q({},r,n,{ref:t}))});const zfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,ffe);return(0,MH.jsx)(wce,$Q({},r,n,{ref:t}))});const jfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,mfe);return(0,MH.jsx)(sue,$Q({},r,n,{ref:t}))});const Gfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,vfe);return(0,MH.jsx)(Ppe,$Q({},r,n,{ref:t}))});const $fe=YQ(function(e,t){const{material:n}=e,r=qQ(e,wfe);return(0,MH.jsx)(ple,$Q({},r,n,{ref:t}))});const Ufe=YQ(function(e,t){const{material:n}=e,r=qQ(e,bfe);return(0,MH.jsx)(Zae,$Q({},r,n,{ref:t}))});const Kfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,Cfe);return(0,MH.jsx)(Upe,$Q({},r,n,{ref:t}))});const Yfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,yfe);return(0,MH.jsx)(_ge,$Q({},r,n,{ref:t}))});const qfe=YQ(function(e,t){const{material:n,label:r,className:i}=e,o=qQ(e,Sfe);return r?(0,MH.jsx)(Ffe,{className:i,control:(0,MH.jsx)(vpe,$Q({},o,n,{ref:t})),label:r}):(0,MH.jsx)(vpe,$Q({},o,n,{className:i,ref:t}))});const Xfe=YQ(function(e,t){const{material:n}=e,r=qQ(e,xfe);return(0,MH.jsx)(Vue,$Q({},r,n,{ref:t}))});function Qfe(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return;const{slotProps:n,material:r}=e,i=qQ(e,Pfe);t&&(i.startAdornment&&(i.startAdornment=(0,MH.jsx)(Dfe,{position:"start",children:i.startAdornment})),i.endAdornment&&(i.endAdornment=(0,MH.jsx)(Dfe,{position:"end",children:i.endAdornment})));for(const o in r)Object.hasOwn(r,o)&&(i[o]=r[o]);return n?.htmlInput&&(i.inputProps?i.inputProps=$Q({},i.inputProps,n?.htmlInput):i.inputProps=n?.htmlInput),i}const Jfe={"bottom-start":"top left","bottom-end":"top right"};function Zfe(e,t){return function(e,t){if(void 0===e.focusTrap)return t;return(0,MH.jsx)(Uce,{open:!0,disableEnforceFocus:!0,disableAutoFocus:!0,children:(0,MH.jsx)("div",{tabIndex:-1,children:t})})}(e,function(e,t){if(void 0===e.onClickAway)return t;return(0,MH.jsx)(kge,{onClickAway:e.onClickAway,touchEvent:e.clickAwayTouchEvent,mouseEvent:e.clickAwayMouseEvent,children:t})}(e,t))}const eme={baseAutocomplete:function(e){const t=e3(),{id:n,multiple:r,freeSolo:i,options:o,getOptionLabel:s,isOptionEqualToValue:a,value:l,onChange:c,label:u,placeholder:d,slotProps:h,material:p}=e,g=qQ(e,Tfe);return(0,MH.jsx)(Hle,$Q({id:n,multiple:r,freeSolo:i,options:o,getOptionLabel:s,isOptionEqualToValue:a,value:l,onChange:c,renderTags:(e,t)=>e.map((e,n)=>{const r=t({index:n}),{key:i}=r,o=qQ(r,kfe);return(0,MH.jsx)(ple,$Q({variant:"outlined",size:"small",label:"string"===typeof e?e:s?.(e)},o),i)}),renderInput:e=>{const{inputProps:n,InputProps:r,InputLabelProps:i}=e,o=qQ(e,Mfe);return(0,MH.jsx)(rpe,$Q({},o,{label:u,placeholder:d,inputProps:n,InputProps:Qfe(r,!1),InputLabelProps:$Q({shrink:!0},i)},h?.textField,t.slotProps?.baseTextField))}},g,p))},baseBadge:Vfe,baseCheckbox:Bfe,baseChip:$fe,baseCircularProgress:Wfe,baseDivider:zfe,baseInput:function(e){return(0,MH.jsx)(zce,$Q({},Qfe(e)))},baseLinearProgress:jfe,baseMenuList:Xfe,baseMenuItem:function(e){const{inert:n,iconStart:r,iconEnd:i,children:o,material:s}=e,a=qQ(e,Rfe);return n&&(a.disableRipple=!0),t.createElement(Gue,$Q({},a,s),[r&&(0,MH.jsx)(hue,{children:r},"1"),(0,MH.jsx)(Nfe,{children:o},"2"),i&&(0,MH.jsx)(hue,{children:i},"3")])},baseTextField:function(e){const{slotProps:t,material:n}=e,r=qQ(e,Efe);return(0,MH.jsx)(rpe,$Q({variant:"outlined"},r,n,{inputProps:t?.htmlInput,InputProps:Qfe(t?.input),InputLabelProps:$Q({shrink:!0},t?.inputLabel)}))},baseButton:Gfe,baseIconButton:Ufe,baseTooltip:Kfe,basePagination:Hfe,basePopper:function(e){const{open:n,children:r,className:i,flip:o,onExited:s,onDidShow:a,onDidHide:l,id:c,target:u,transition:d,placement:h,material:p}=e,g=qQ(e,Ife),f=t.useMemo(()=>{const e=[{name:"preventOverflow",options:{padding:8}}];return o&&e.push({name:"flip",enabled:!0,options:{rootBoundary:"document"}}),(a||l)&&e.push({name:"isPlaced",enabled:!0,phase:"main",fn:()=>{a?.()},effect:()=>()=>{l?.()}}),e},[o,a,l]);let m;if(d){const t=e=>t=>{e&&e(),s&&s(t)};m=n=>Zfe(e,(0,MH.jsx)(Gde,$Q({},n.TransitionProps,{style:{transformOrigin:Jfe[n.placement]},onExited:t(n.TransitionProps?.onExited),children:(0,MH.jsx)(sae,{children:r})})))}else m=Zfe(e,r);return(0,MH.jsx)(qse,$Q({id:c,className:i,open:n,anchorEl:u,transition:d,placement:h,modifiers:f},g,p,{children:m}))},baseSelect:Lfe,baseSelectOption:function(e){let{native:t}=e,n=qQ(e,Afe);return t?(0,MH.jsx)("option",$Q({},n)):(0,MH.jsx)(Gue,$Q({},n))},baseSkeleton:Yfe,baseSwitch:qfe},tme=$Q({},eme,{booleanCellTrueIcon:rfe,booleanCellFalseIcon:Jge,columnMenuIcon:Qge,openFilterButtonIcon:jge,filterPanelDeleteIcon:Jge,columnFilteredIcon:Gge,columnSelectorIcon:Uge,columnSortedAscendingIcon:Vge,columnSortedDescendingIcon:Bge,columnResizeIcon:Kge,densityCompactIcon:Yge,densityStandardIcon:qge,densityComfortableIcon:Xge,exportIcon:cfe,moreActionsIcon:ife,treeDataCollapseIcon:zge,treeDataExpandIcon:Wge,groupingCriteriaCollapseIcon:zge,groupingCriteriaExpandIcon:Wge,detailPanelExpandIcon:Zge,detailPanelCollapseIcon:efe,rowReorderIcon:nfe,quickFilterIcon:$ge,quickFilterClearIcon:afe,columnMenuHideIcon:ofe,columnMenuSortAscendingIcon:Vge,columnMenuSortDescendingIcon:Bge,columnMenuUnsortIcon:null,columnMenuFilterIcon:Gge,columnMenuManageColumnsIcon:sfe,columnMenuClearIcon:afe,loadIcon:tfe,filterPanelAddIcon:Zge,filterPanelRemoveAllIcon:lfe,columnReorderIcon:nfe,menuItemCheckIcon:rfe}),nme=i4("div")({position:"sticky",zIndex:40,bottom:"calc(var(--DataGrid-hasScrollX) * var(--DataGrid-scrollbarSize))"});function rme(e,n,r){return"function"===typeof n?n(r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}):n?(n.props.className&&(r.className=function(e,t){if(!e||!t)return e||t;return`${e} ${t}`}(n.props.className,r.className)),(n.props.style||r.style)&&(r.style=$Q({},r.style,n.props.style)),t.cloneElement(n,r)):t.createElement(e,r)}const ime=t.createContext(void 0);function ome(e,t){if(!e.ref.current||!t.ref.current)return 0;const n=e.ref.current.compareDocumentPosition(t.ref.current);return n?n&Node.DOCUMENT_POSITION_FOLLOWING||n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_PRECEDING||n&Node.DOCUMENT_POSITION_CONTAINS?1:0:0}const sme=["render","className"],ame=i4("div",{name:"MuiDataGrid",slot:"Toolbar"})({flex:0,display:"flex",alignItems:"center",justifyContent:"end",gap:O2.spacing(.25),padding:O2.spacing(.75),minHeight:52,boxSizing:"border-box",borderBottom:`1px solid ${O2.colors.border.base}`}),lme=YQ(function(e,n){const{render:r,className:i}=e,o=qQ(e,sme),s=e3(),a=(e=>{const{classes:t}=e;return tJ({root:["toolbar"]},P2,t)})(s),[l,c]=t.useState(null),[u,d]=t.useState([]),h=t.useCallback(()=>u.sort(ome),[u]),p=t.useCallback(function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e;const i=h(),o=i.length;for(let s=0;s<o;s+=1){if(r+=t,r>=o){if(!n)return-1;r=0}else if(r<0){if(!n)return-1;r=o-1}if(!i[r].ref.current?.disabled&&"true"!==i[r].ref.current?.ariaDisabled)return r}return-1},[h]),g=t.useCallback((e,t)=>{d(n=>[...n,{id:e,ref:t}])},[]),f=t.useCallback(e=>{d(t=>t.filter(t=>t.id!==e))},[]),m=t.useCallback(e=>{if(!l)return;const t=h(),n=t.findIndex(e=>e.id===l);let r=-1;if("ArrowRight"===e.key?(e.preventDefault(),r=p(n,1)):"ArrowLeft"===e.key?(e.preventDefault(),r=p(n,-1)):"Home"===e.key?(e.preventDefault(),r=p(-1,1,!1)):"End"===e.key&&(e.preventDefault(),r=p(t.length,-1,!1)),r>=0&&r<t.length){const e=t[r];c(e.id),e.ref.current?.focus()}},[h,l,p]),v=t.useCallback(e=>{l!==e&&c(e)},[l,c]),w=t.useCallback(e=>{const t=h(),n=t.findIndex(t=>t.id===e),r=p(n,1);if(r>=0&&r<t.length){const e=t[r];c(e.id),e.ref.current?.focus()}},[h,p]);t.useEffect(()=>{const e=h();if(e.length>0){if(!l)return void c(e[0].id);const t=e.findIndex(e=>e.id===l);if(e[t]){if(-1===t){const n=e[t];n&&(c(n.id),n.ref.current?.focus())}}else{const t=e[e.length-1];t&&(c(t.id),t.ref.current?.focus())}}},[h,p]);const b=t.useMemo(()=>({focusableItemId:l,registerItem:g,unregisterItem:f,onItemKeyDown:m,onItemFocus:v,onItemDisabled:w}),[l,g,f,m,v,w]),C=rme(ame,r,$Q({role:"toolbar","aria-orientation":"horizontal","aria-label":s.label||void 0,className:QQ(a.root,i)},o,{ref:n}));return(0,MH.jsx)(ime.Provider,{value:b,children:C})});const cme=["render","onKeyDown","onFocus","disabled","aria-disabled"],ume=YQ(function(e,n){const{render:r,onKeyDown:i,onFocus:o,disabled:s,"aria-disabled":a}=e,l=qQ(e,cme),c=l5(),u=e3(),d=t.useRef(null),h=JQ(d,n),{focusableItemId:p,registerItem:g,unregisterItem:f,onItemKeyDown:m,onItemFocus:v,onItemDisabled:w}=function(){const e=t.useContext(ime);if(void 0===e)throw new Error("MUI X: Missing context. Toolbar subcomponents must be placed within a <Toolbar /> component.");return e}();t.useEffect(()=>(g(c,d),()=>f(c)),[]);const b=t.useRef(s);t.useEffect(()=>{b.current!==s&&!0===s&&w(c,s),b.current=s},[s,c,w]);const C=t.useRef(a);t.useEffect(()=>{C.current!==a&&!0===a&&w(c,!0),C.current=a},[a,c,w]);const y=rme(u.slots.baseIconButton,r,$Q({},u.slotProps?.baseIconButton,{tabIndex:p===c?0:-1},l,{disabled:s,"aria-disabled":a,onKeyDown:e=>{m(e),i?.(e)},onFocus:e=>{v(c),o?.(e)},ref:h}));return(0,MH.jsx)(t.Fragment,{children:y})});const dme=["render","className","onClick","onPointerUp"],hme=YQ(function(e,n){const{render:r,className:i,onClick:o,onPointerUp:s}=e,a=qQ(e,dme),l=e3(),c=l5(),u=l5(),d=J3(),h=$2(d,Y3),p=h.open&&h.openedPanelValue===X3.filters,g=$2(d,V8).length,f={open:p,filterCount:g},m="function"===typeof i?i(f):i,{filterPanelTriggerRef:v}=e4(),w=JQ(n,v),b=rme(l.slots.baseButton,r,$Q({},l.slotProps?.baseButton,{id:c,"aria-haspopup":"true","aria-expanded":p?"true":void 0,"aria-controls":p?u:void 0,onClick:e=>{p?d.current.hidePreferences():d.current.showPreferences(X3.filters,u,c),o?.(e)},onPointerUp:e=>{p&&e.stopPropagation(),s?.(e)},className:m},a,{ref:w}),f);return(0,MH.jsx)(t.Fragment,{children:b})});const pme=["render","className","onClick","onPointerUp"],gme=YQ(function(e,n){const{render:r,className:i,onClick:o,onPointerUp:s}=e,a=qQ(e,pme),l=e3(),c=l5(),u=l5(),d=J3(),h=$2(d,Y3),p=h.open&&h.openedPanelValue===X3.columns,g={open:p},f="function"===typeof i?i(g):i,{columnsPanelTriggerRef:m}=e4(),v=JQ(n,m),w=rme(l.slots.baseButton,r,$Q({},l.slotProps?.baseButton,{id:c,"aria-haspopup":"true","aria-expanded":p?"true":void 0,"aria-controls":p?u:void 0,className:f},a,{onPointerUp:e=>{p&&e.stopPropagation(),s?.(e)},onClick:e=>{p?d.current.hidePreferences():d.current.showPreferences(X3.columns,u,c),o?.(e)},ref:v}),g);return(0,MH.jsx)(t.Fragment,{children:w})});const fme=["render","options","onClick"],mme=YQ(function(e,n){const{render:r,options:i,onClick:o}=e,s=qQ(e,fme),a=e3(),l=J3(),c=rme(a.slots.baseButton,r,$Q({},a.slotProps?.baseButton,{onClick:e=>{l.current.exportDataAsPrint(i),o?.(e)}},s,{ref:n}));return(0,MH.jsx)(t.Fragment,{children:c})});const vme=["render","options","onClick"],wme=YQ(function(e,n){const{render:r,options:i,onClick:o}=e,s=qQ(e,vme),a=e3(),l=J3(),c=rme(a.slots.baseButton,r,$Q({},a.slotProps?.baseButton,{onClick:e=>{l.current.exportDataAsCsv(i),o?.(e)}},s,{ref:n}));return(0,MH.jsx)(t.Fragment,{children:c})});const bme=t.createContext(void 0);function Cme(){const e=t.useContext(bme);if(void 0===e)throw new Error("MUI X: Missing context. Quick Filter subcomponents must be placed within a <QuickFilter /> component.");return e}const yme=["render","className","parser","formatter","debounceMs","defaultExpanded","expanded","onExpandedChange"],Sme=e=>e.split(" ").filter(e=>""!==e),xme=e=>e.join(" ");function Rme(e){const n=e3(),{render:r,className:i,parser:o=Sme,formatter:s=xme,debounceMs:a=n.filterDebounceMs,defaultExpanded:l,expanded:c,onExpandedChange:u}=e,d=qQ(e,yme),h=J3(),p=t.useRef(null),g=t.useRef(null),f=$2(h,M8),[m,v]=t.useState(s(f??[])),[w,b]=t.useState(l??m.length>0),C=c??w,y=t.useMemo(()=>({value:m,expanded:C}),[m,C]),S="function"===typeof i?i(y):i,x=t.useRef(null),R=l5(),E=t.useCallback(e=>{u&&u(e),void 0===c&&b(e)},[u,c]),T=t.useRef(f);t.useEffect(()=>{Aee(T.current,f)||(T.current=f,v(e=>Aee(o(e),f)?e:s(f??[])))},[f,s,o]);const k=t.useRef(!0),M=t.useRef(C);t.useEffect(()=>{k.current?k.current=!1:M.current!==C&&(C?requestAnimationFrame(()=>{p.current?.focus({preventScroll:!0})}):g.current?.focus({preventScroll:!0}),M.current=C)},[C]);const P=t.useMemo(()=>cne(e=>{const t=o(e);T.current=t,h.current.setQuickFilterValues(t)},a),[h,a,o]);t.useEffect(()=>P.clear,[P]);const I=t.useCallback(e=>{const t=e.target.value;v(t),P(t)},[P]),A=t.useCallback(()=>{v(""),h.current.setQuickFilterValues([]),p.current?.focus()},[h,p]),D=t.useMemo(()=>({controlRef:p,triggerRef:g,state:y,controlId:R,clearValue:A,onValueChange:I,onExpandedChange:E}),[R,y,I,A,E]);v4(()=>{x.current&&g.current&&x.current.style.setProperty("--trigger-width",`${g.current?.offsetWidth}px`)},[]);const F=rme("div",r,$Q({className:S},d,{ref:x}),y);return(0,MH.jsx)(bme.Provider,{value:D,children:F})}const Eme=["render","className","onClick"],Tme=YQ(function(e,n){const{render:r,className:i,onClick:o}=e,s=qQ(e,Eme),a=e3(),{state:l,controlId:c,onExpandedChange:u,triggerRef:d}=Cme(),h="function"===typeof i?i(l):i,p=JQ(d,n),g=rme(a.slots.baseButton,r,$Q({},a.slotProps?.baseButton,{className:h,"aria-controls":c,"aria-expanded":l.expanded},s,{onClick:e=>{u(!l.expanded),o?.(e)},ref:p}),l);return(0,MH.jsx)(t.Fragment,{children:g})});const kme=["render","className","slotProps","onKeyDown","onChange"],Mme=YQ(function(e,n){const{render:r,className:i,slotProps:o,onKeyDown:s,onChange:a}=e,l=qQ(e,kme),c=e3(),{state:u,controlId:d,controlRef:h,onValueChange:p,onExpandedChange:g,clearValue:f}=Cme(),m="function"===typeof i?i(u):i,v=JQ(h,n),w=rme(c.slots.baseTextField,r,$Q({},c.slotProps?.baseTextField,{slotProps:$Q({htmlInput:$Q({role:"searchbox",id:d,tabIndex:u.expanded?void 0:-1},o?.htmlInput,{onBlur:e=>{""===u.value&&g(!1),o?.htmlInput?.onBlur?.(e)}})},o),value:u.value,className:m},l,{onChange:e=>{u.expanded||g(!0),p(e),a?.(e)},onKeyDown:e=>{"Escape"===e.key&&(""===u.value?g(!1):f()),s?.(e)},ref:v}),u);return(0,MH.jsx)(t.Fragment,{children:w})});const Pme=["render","className","onClick"],Ime=YQ(function(e,n){const{render:r,className:i,onClick:o}=e,s=qQ(e,Pme),a=e3(),{state:l,clearValue:c}=Cme(),u="function"===typeof i?i(l):i,d=rme(a.slots.baseIconButton,r,$Q({},a.slotProps?.baseIconButton,{className:u,tabIndex:-1},s,{onClick:e=>{c(),o?.(e)},ref:n}),l);return(0,MH.jsx)(t.Fragment,{children:d})});const Ame=["quickFilterParser","quickFilterFormatter","debounceMs","className","slotProps"],Dme=["ref","slotProps"],Fme=i4("div",{name:"MuiDataGrid",slot:"ToolbarQuickFilter"})({display:"grid",alignItems:"center"}),Ome=i4(ume,{name:"MuiDataGrid",slot:"ToolbarQuickFilterTrigger"})(e=>{let{ownerState:t}=e;return{gridArea:"1 / 1",width:"min-content",height:"min-content",zIndex:1,opacity:t.expanded?0:1,pointerEvents:t.expanded?"none":"auto",transition:O2.transition(["opacity"])}}),Nme=i4(e=>{throw new Error("Failed assertion: should not be rendered")},{name:"MuiDataGrid",slot:"ToolbarQuickFilterControl"})(e=>{let{ownerState:t}=e;return{gridArea:"1 / 1",overflowX:"clip",width:t.expanded?260:"var(--trigger-width)",opacity:t.expanded?1:0,transition:O2.transition(["width","opacity"])}});function Lme(e){const t=J3(),n=e3(),r={classes:n.classes,expanded:!1},i=(e=>{const{classes:t}=e;return tJ({root:["toolbarQuickFilter"],trigger:["toolbarQuickFilterTrigger"],control:["toolbarQuickFilterControl"]},P2,t)})(r),{quickFilterParser:o,quickFilterFormatter:s,debounceMs:a,className:l,slotProps:c}=e,u=qQ(e,Ame);return(0,MH.jsx)(Rme,{parser:o,formatter:s,debounceMs:a,render:(e,o)=>{const s=$Q({},r,{expanded:o.expanded});return(0,MH.jsxs)(Fme,$Q({},e,{className:QQ(i.root,l),children:[(0,MH.jsx)(Tme,{render:e=>(0,MH.jsx)(n.slots.baseTooltip,{title:t.current.getLocaleText("toolbarQuickFilterLabel"),enterDelay:0,children:(0,MH.jsx)(Ome,$Q({className:i.trigger},e,{ownerState:s,color:"default","aria-disabled":o.expanded,children:(0,MH.jsx)(n.slots.quickFilterIcon,{fontSize:"small"})}))})}),(0,MH.jsx)(Mme,{render:e=>{let{ref:r,slotProps:o}=e,a=qQ(e,Dme);return(0,MH.jsx)(Nme,$Q({as:n.slots.baseTextField,className:i.control,ownerState:s,inputRef:r,"aria-label":t.current.getLocaleText("toolbarQuickFilterLabel"),placeholder:t.current.getLocaleText("toolbarQuickFilterPlaceholder"),size:"small",slotProps:$Q({input:$Q({startAdornment:(0,MH.jsx)(n.slots.quickFilterIcon,{fontSize:"small"}),endAdornment:a.value?(0,MH.jsx)(Ime,{render:(0,MH.jsx)(n.slots.baseIconButton,{size:"small",edge:"end","aria-label":t.current.getLocaleText("toolbarQuickFilterDeleteIconLabel"),children:(0,MH.jsx)(n.slots.quickFilterClearIcon,{fontSize:"small"})})}):null},o?.input)},o)},n.slotProps?.baseTextField,a,c?.root,u))}})]}))}})}const _me=["className"],Hme=["className"],Vme=e=>{const{classes:t}=e;return tJ({divider:["toolbarDivider"],label:["toolbarLabel"]},P2,t)},Bme=i4(F4,{name:"MuiDataGrid",slot:"ToolbarDivider"})({height:"50%",margin:O2.spacing(0,.5)}),Wme=i4("span",{name:"MuiDataGrid",slot:"ToolbarLabel"})({flex:1,font:O2.typography.font.large,fontWeight:O2.typography.fontWeight.medium,margin:O2.spacing(0,.5),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"});function zme(e){const t=qQ(e,_me),n=e3(),r=Vme(n);return(0,MH.jsx)(Bme,$Q({as:n.slots.baseDivider,orientation:"vertical",className:r.divider},t))}function jme(e){const t=qQ(e,Hme),n=e3(),r=Vme(n);return(0,MH.jsx)(Wme,$Q({className:r.label},t))}const Gme=$Q({},tme,{cell:yie,skeletonCell:Ane,columnHeaderFilterIconButton:function(e){return e.counter?(0,MH.jsx)(Nne,$Q({},e)):null},columnHeaderSortIcon:zne,columnMenu:eoe,columnHeaders:zie,detailPanels:function(e){return null},bottomContainer:function(e){const t=tJ({root:["bottomContainer"]},P2,{});return(0,MH.jsx)(nme,$Q({},e,{className:QQ(t.root,I2["container--bottom"]),role:"presentation"}))},footer:qne,footerRowCount:Jne,toolbar:function(e){const{showQuickFilter:n=!0,quickFilterProps:r,csvOptions:i,printOptions:o,additionalItems:s,additionalExportMenuItems:a}=e,l=J3(),c=e3(),[u,d]=t.useState(!1),h=t.useRef(null),p=l5(),g=l5(),f=!i?.disableToolbarButton||!o?.disableToolbarButton||a,m=()=>d(!1);return(0,MH.jsxs)(lme,{children:[c.label&&(0,MH.jsx)(jme,{children:c.label}),!c.disableColumnSelector&&(0,MH.jsx)(c.slots.baseTooltip,{title:l.current.getLocaleText("toolbarColumns"),children:(0,MH.jsx)(gme,{render:(0,MH.jsx)(ume,{}),children:(0,MH.jsx)(c.slots.columnSelectorIcon,{fontSize:"small"})})}),!c.disableColumnFilter&&(0,MH.jsx)(c.slots.baseTooltip,{title:l.current.getLocaleText("toolbarFilters"),children:(0,MH.jsx)(hme,{render:(e,t)=>(0,MH.jsx)(ume,$Q({},e,{color:t.filterCount>0?"primary":"default",children:(0,MH.jsx)(c.slots.baseBadge,{badgeContent:t.filterCount,color:"primary",variant:"dot",children:(0,MH.jsx)(c.slots.openFilterButtonIcon,{fontSize:"small"})})}))})}),s,f&&(!c.disableColumnFilter||!c.disableColumnSelector)&&(0,MH.jsx)(zme,{}),f&&(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(c.slots.baseTooltip,{title:l.current.getLocaleText("toolbarExport"),disableInteractive:u,children:(0,MH.jsx)(ume,{ref:h,id:g,"aria-controls":p,"aria-haspopup":"true","aria-expanded":u?"true":void 0,onClick:()=>d(!u),children:(0,MH.jsx)(c.slots.exportIcon,{fontSize:"small"})})}),(0,MH.jsx)(q6,{target:h.current,open:u,onClose:m,position:"bottom-end",children:(0,MH.jsxs)(c.slots.baseMenuList,$Q({id:p,"aria-labelledby":g,autoFocusItem:!0},c.slotProps?.baseMenuList,{children:[!o?.disableToolbarButton&&(0,MH.jsx)(mme,{render:(0,MH.jsx)(c.slots.baseMenuItem,$Q({},c.slotProps?.baseMenuItem)),options:o,onClick:m,children:l.current.getLocaleText("toolbarExportPrint")}),!i?.disableToolbarButton&&(0,MH.jsx)(wme,{render:(0,MH.jsx)(c.slots.baseMenuItem,$Q({},c.slotProps?.baseMenuItem)),options:i,onClick:m,children:l.current.getLocaleText("toolbarExportCSV")}),a?.(m)]}))})]}),n&&(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(zme,{}),(0,MH.jsx)(Lme,$Q({},r))]})]})},pinnedRows:function(e){return null},loadingOverlay:mre,noResultsOverlay:toe,noRowsOverlay:vre,noColumnsOverlay:wre,pagination:function(){const e=J3(),n=e3(),r=$2(e,K8),i=$2(e,Y8),o=$2(e,J8),{paginationMode:s,loading:a}=n,l=-1===i&&"server"===s&&a,c=t.useMemo(()=>Math.max(0,o-1),[o]),u=t.useMemo(()=>-1===i||r.page<=c?r.page:c,[c,r.page,i]),d=t.useCallback(t=>{e.current.setPageSize(t)},[e]),h=t.useCallback((t,n)=>{e.current.setPage(n)},[e]),p=(e=>{for(let t=0;t<n.pageSizeOptions.length;t+=1){const r=n.pageSizeOptions[t];if("number"===typeof r){if(r===e)return!0}else if(r.value===e)return!0}return!1})(r.pageSize)?n.pageSizeOptions:[];return(0,MH.jsx)(bre,{as:n.slots.basePagination,count:i,page:u,rowsPerPageOptions:p,rowsPerPage:r.pageSize,onPageChange:h,onRowsPerPageChange:d,disabled:l})},filterPanel:zre,columnsPanel:function(e){const t=e3();return(0,MH.jsx)(Mre,$Q({},e,{children:(0,MH.jsx)(t.slots.columnsManagement,$Q({},t.slotProps?.columnsManagement))}))},columnsManagement:function(e){const n=J3(),r=t.useRef(null),i=$2(n,H3),o=$2(n,_3),s=e3(),[a,l]=t.useState(""),c=(e=>{const{classes:t}=e;return tJ({root:["columnsManagement"],header:["columnsManagementHeader"],searchInput:["columnsManagementSearchInput"],footer:["columnsManagementFooter"],row:["columnsManagementRow"]},P2,t)})(s),u=$2(n,L3),d=$2(n,n9),h=$2(n,i9),p=t.useMemo(()=>d?Array.from(h.values()):u,[d,h,u]),{sort:g,searchPredicate:f=$re,autoFocusSearchField:m=!0,disableShowHideToggle:v=!1,disableResetButton:w=!1,toggleAllMode:b="all",getTogglableColumns:C,searchInputProps:y}=e,S=t.useMemo(()=>((e,t)=>{const n=new Set(Object.keys(e).filter(t=>!1===e[t])),r=new Set(Object.keys(t).filter(e=>!1===t[e]));if(n.size!==r.size)return!1;let i=!0;return n.forEach(e=>{r.has(e)||(i=!1)}),i})(o,i),[o,i]),x=t.useMemo(()=>{switch(g){case"asc":return[...p].sort((e,t)=>tie.compare(e.headerName||e.field,t.headerName||t.field));case"desc":return[...p].sort((e,t)=>-tie.compare(e.headerName||e.field,t.headerName||t.field));default:return p}},[p,g]),R=e=>{const{name:t}=e.target;n.current.setColumnVisibility(t,!1===o[t])},E=t.useMemo(()=>{const e=C?C(x):null,t=e?x.filter(t=>{let{field:n}=t;return e.includes(n)}):x;return a?t.filter(e=>f(e,a.toLowerCase())):t},[x,a,f,C]),T=t.useCallback(e=>{const t=$Q({},_3(n)),r=C?C(p):null;return("filteredOnly"===b?E:p).forEach(n=>{n.hideable&&(null==r||r.includes(n.field))&&(e?delete t[n.field]:t[n.field]=!1)}),n.current.setColumnVisibilityModel(t)},[n,p,C,b,E]),k=t.useCallback(e=>{l(e.target.value)},[]),M=t.useMemo(()=>E.filter(e=>e.hideable),[E]),P=t.useMemo(()=>M.every(e=>null==o[e.field]||!1!==o[e.field]),[o,M]),I=t.useMemo(()=>M.every(e=>!1===o[e.field]),[o,M]),A=t.useRef(null);t.useEffect(()=>{m?r.current?.focus():A.current&&"function"===typeof A.current.focus&&A.current.focus()},[m]);let D=!1;const F=e=>!1===D&&!1!==e.hideable&&(D=!0,!0),O=t.useCallback(()=>{l(""),r.current?.focus()},[]);return(0,MH.jsxs)(t.Fragment,{children:[(0,MH.jsx)(iie,{className:c.header,ownerState:s,children:(0,MH.jsx)(oie,$Q({as:s.slots.baseTextField,ownerState:s,placeholder:n.current.getLocaleText("columnsManagementSearchTitle"),inputRef:r,className:c.searchInput,value:a,onChange:k,size:"small",type:"search",slotProps:{input:{startAdornment:(0,MH.jsx)(s.slots.quickFilterIcon,{fontSize:"small"}),endAdornment:(0,MH.jsx)(s.slots.baseIconButton,$Q({size:"small","aria-label":n.current.getLocaleText("columnsManagementDeleteIconLabel"),style:a?{visibility:"visible"}:{visibility:"hidden"},tabIndex:-1,onClick:O,edge:"end"},s.slotProps?.baseIconButton,{children:(0,MH.jsx)(s.slots.quickFilterClearIcon,{fontSize:"small"})}))},htmlInput:{"aria-label":n.current.getLocaleText("columnsManagementSearchTitle")}},autoComplete:"off",fullWidth:!0},s.slotProps?.baseTextField,y))}),(0,MH.jsx)(rie,{ownerState:s,children:(0,MH.jsxs)(nie,{className:c.root,ownerState:s,children:[E.map(e=>(0,MH.jsx)(s.slots.baseCheckbox,$Q({className:c.row,disabled:!1===e.hideable||d,checked:!1!==o[e.field],onChange:R,name:e.field,inputRef:F(e)?A:void 0,label:e.headerName||e.field,density:"compact",fullWidth:!0},s.slotProps?.baseCheckbox),e.field)),0===E.length&&(0,MH.jsx)(aie,{ownerState:s,children:n.current.getLocaleText("columnsManagementNoColumns")})]})}),v&&w?null:(0,MH.jsxs)(sie,{ownerState:s,className:c.footer,children:[v?(0,MH.jsx)("span",{}):(0,MH.jsx)(s.slots.baseCheckbox,$Q({disabled:0===M.length||d,checked:P,indeterminate:!P&&!I,onChange:()=>T(!P),name:n.current.getLocaleText("columnsManagementShowHideAllText"),label:n.current.getLocaleText("columnsManagementShowHideAllText"),density:"compact"},s.slotProps?.baseCheckbox)),w?null:(0,MH.jsx)(s.slots.baseButton,$Q({onClick:()=>n.current.setColumnVisibilityModel(i),disabled:S||d},s.slotProps?.baseButton,{children:n.current.getLocaleText("columnsManagementReset")}))]})]})},panel:hie,row:mie});const $me={disableMultipleColumnsFiltering:!0,disableMultipleColumnsSorting:!0,throttleRowsMs:void 0,hideFooterRowCount:!1,pagination:!0,checkboxSelectionVisibleOnly:!1,disableColumnReorder:!0,keepColumnPositionIfDraggedOutside:!1,signature:"DataGrid",listView:!1},Ume=Gme,Kme=e=>{const n=Rne(),r=t.useMemo(()=>function(e){const{theme:t,name:n,props:r}=e;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?D4(t.components[n].defaultProps,r):r}({props:e,theme:n,name:"MuiDataGrid"}),[n,e]),i=t.useMemo(()=>$Q({},Ene,r.localeText),[r.localeText]),o=t.useMemo(()=>function(e){let{defaultSlots:t,slots:n}=e;const r=n;if(!r||0===Object.keys(r).length)return t;const i=$Q({},t);return Object.keys(r).forEach(e=>{const t=e;void 0!==r[t]&&(i[t]=r[t])}),i}({defaultSlots:Ume,slots:r.slots}),[r.slots]),s=t.useMemo(()=>Object.keys(xte).reduce((e,t)=>(e[t]=r[t]??xte[t],e),{}),[r]);return t.useMemo(()=>$Q({},r,s,{localeText:i,slots:o},(e=>$Q({},$me,e.dataSource?{filterMode:"server",sortingMode:"server",paginationMode:"server"}:{}))(r)),[r,i,o,s])},Yme=new TextEncoder;let qme=2048,Xme=new ArrayBuffer(qme),Qme=new Uint8Array(Xme),Jme=new Int32Array(Xme);const Zme=function(e){const t=2*e.length;t>qme&&(qme=t+(4-t%4),Xme=new ArrayBuffer(qme),Qme=new Uint8Array(Xme),Jme=new Int32Array(Xme));const n=Yme.encodeInto(e,Qme).written,r=0|n;let i=0,o=374761393+(0+r|0)|0;if(r<16)for(;(i+3|0)<r;i=i+4|0)o=Math.imul(0|eve(o+Math.imul(0|Jme[i],3266489917)|0,17),668265263);else{let e=606290984,t=-2048144777,n=0,s=1640531535;for(;(i+15|0)<r;i=i+16|0)e=Math.imul(0|eve(e+Math.imul(0|Jme[i+0|0],2246822519)|0,13),2654435761),t=Math.imul(0|eve(t+Math.imul(0|Jme[i+4|0],2246822519)|0,13),2654435761),n=Math.imul(0|eve(n+Math.imul(0|Jme[i+8|0],2246822519)|0,13),2654435761),s=Math.imul(0|eve(s+Math.imul(0|Jme[i+12|0],2246822519)|0,13),2654435761);for(o=(((eve(e,1)|0+eve(t,7)|0)+eve(n,12)|0)+eve(s,18)|0)+r|0;(i+3|0)<r;i=i+4|0)o=Math.imul(0|eve(o+Math.imul(0|Jme[i],3266489917)|0,17),668265263)}for(;i<r;i=i+1|0)o=Math.imul(0|eve(o+Math.imul(0|Qme[i],374761393)|0,11),2654435761);return o=Math.imul(o^o>>>15,2246822519),o=Math.imul(o^o>>>13,3266489917),((o^o>>>16)>>>0).toString()};function eve(e,t){return e<<t|e>>>32-t}function tve(e){return function(e,t){return`rgba(from ${e} r g b / ${t})`}(e,1)}function nve(e){if(e)return`${e.fontWeight} ${e.fontSize} / ${e.lineHeight} ${e.fontFamily}`}class rve{constructor(){this.maxListeners=20,this.warnOnce=!1,this.events={}}on(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.events[e];r||(r={highPriority:new Map,regular:new Map},this.events[e]=r),n.isFirst?r.highPriority.set(t,!0):r.regular.set(t,!0)}removeListener(e,t){this.events[e]&&(this.events[e].regular.delete(t),this.events[e].highPriority.delete(t))}removeAllListeners(){this.events={}}emit(e){const t=this.events[e];if(!t)return;const n=Array.from(t.highPriority.keys()),r=Array.from(t.regular.keys());for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];for(let a=n.length-1;a>=0;a-=1){const e=n[a];t.highPriority.has(e)&&e.apply(this,o)}for(let a=0;a<r.length;a+=1){const e=r[a];t.regular.has(e)&&e.apply(this,o)}}once(e,t){const n=this;this.on(e,function r(){n.removeListener(e,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];t.apply(n,o)})}}class ive{static create(e){return new ive(e)}constructor(e){this.state=void 0,this.listeners=void 0,this.subscribe=e=>(this.listeners.add(e),()=>{this.listeners.delete(e)}),this.getSnapshot=()=>this.state,this.update=e=>{this.state!==e&&(this.state=e,this.listeners.forEach(t=>t(e)))},this.state=e,this.listeners=new Set}apply(e){for(const t in e)if(!Object.is(this.state[t],e[t]))return void this.update($Q({},this.state,e))}set(e,t){Object.is(this.state[e],t)||this.update($Q({},this.state,{[e]:t}))}}const ove=Symbol("mui.api_private");let sve=0;function ave(e,n){const r=t.useRef(null),i=t.useRef(null);i.current||(i.current=function(e){const t=e.current?.[ove];if(t)return t;const n={},r={state:n,store:ive.create(n),instanceId:{id:sve}};return sve+=1,r.getPublicApi=()=>e.current,r.register=(t,n)=>{Object.keys(n).forEach(i=>{const o=n[i],s=r[i];if(!0===s?.spying?s.target=o:r[i]=o,"public"===t){const t=e.current,n=t[i];!0===n?.spying?n.target=o:t[i]=o}})},r.register("private",{caches:{},eventManager:new rve}),r}(r)),r.current||(r.current=function(e){return{get state(){return e.current.state},get store(){return e.current.store},get instanceId(){return e.current.instanceId},[ove]:e.current}}(i));const o=t.useCallback(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[o,s,a={}]=t;if(a.defaultMuiPrevented=!1,(e=>void 0!==e.isPropagationStopped)(a)&&a.isPropagationStopped())return;const l=n.signature===W8.DataGridPro||n.signature===W8.DataGridPremium?{api:i.current.getPublicApi()}:{};i.current.eventManager.emit(o,s,a,l)},[i,n.signature]),s=t.useCallback((e,t,n)=>{i.current.eventManager.on(e,t,n);const r=i.current;return()=>{r.eventManager.removeListener(e,t)}},[i]);return h7(i,{subscribeEvent:s,publishEvent:o},"public"),e&&!e.current?.state&&(e.current=r.current),t.useImperativeHandle(e,()=>r.current,[r]),t.useEffect(()=>{const e=i.current;return()=>{e.publishEvent("unmount")}},[i]),i}const lve={hooks:{useCSSVariables:function(){const e=Rne();return t.useMemo(()=>{const t=Zme(function(e){const t=new WeakSet;return JSON.stringify(e,(e,n)=>{if("undefined"!==typeof window&&n===window||"undefined"!==typeof document&&n===document)return n.toString();if(null!==n&&"object"===typeof n){if(t.has(n))return null;t.add(n)}return n})}(e)),n=function(e){const t=function(e){if(e.vars)return e.vars.palette.TableCell.border;if("light"===e.palette.mode)return y1(v1(e.palette.divider,1),.88);return b1(v1(e.palette.divider,1),.68)}(e),n=(e.vars||e).palette.DataGrid,r=n?.bg??(e.vars||e).palette.background.default,i=n?.headerBg??r,o=n?.pinnedBg??r,s=e.vars?`rgba(${e.vars.palette.background.defaultChannel} / ${e.vars.palette.action.disabledOpacity})`:v1(e.palette.background.default,e.palette.action.disabledOpacity),a="dark"===e.palette.mode?`color-mix(in srgb, ${(e.vars||e).palette.background.paper} 95%, #fff)`:(e.vars||e).palette.background.paper,l=e.vars?`rgb(${e.vars.palette.primary.mainChannel})`:e.palette.primary.main,c=function(e){if(e.vars)return e.vars.shape.borderRadius;return"number"===typeof e.shape.borderRadius?`${e.shape.borderRadius}px`:e.shape.borderRadius}(e),u=e.vars?.font?.body2??nve(e.typography.body2),d=e.vars?.font?.caption??nve(e.typography.caption),h=e.vars?.font?.body1??nve(e.typography.body1),p=O2.keys;return{[p.spacingUnit]:e.vars?e.vars.spacing??e.spacing(1):e.spacing(1),[p.colors.border.base]:t,[p.colors.background.base]:r,[p.colors.background.overlay]:a,[p.colors.background.backdrop]:s,[p.colors.foreground.base]:(e.vars||e).palette.text.primary,[p.colors.foreground.muted]:(e.vars||e).palette.text.secondary,[p.colors.foreground.accent]:(e.vars||e).palette.primary.dark,[p.colors.foreground.disabled]:(e.vars||e).palette.text.disabled,[p.colors.foreground.error]:(e.vars||e).palette.error.dark,[p.colors.interactive.hover]:(e.vars||e).palette.action.hover,[p.colors.interactive.hoverOpacity]:(e.vars||e).palette.action.hoverOpacity,[p.colors.interactive.focus]:tve((e.vars||e).palette.primary.main),[p.colors.interactive.focusOpacity]:(e.vars||e).palette.action.focusOpacity,[p.colors.interactive.disabled]:tve((e.vars||e).palette.action.disabled),[p.colors.interactive.disabledOpacity]:(e.vars||e).palette.action.disabledOpacity,[p.colors.interactive.selected]:l,[p.colors.interactive.selectedOpacity]:(e.vars||e).palette.action.selectedOpacity,[p.header.background.base]:i,[p.cell.background.pinned]:o,[p.radius.base]:c,[p.typography.fontFamily.base]:e.typography.fontFamily,[p.typography.fontWeight.light]:e.typography.fontWeightLight,[p.typography.fontWeight.regular]:e.typography.fontWeightRegular,[p.typography.fontWeight.medium]:e.typography.fontWeightMedium,[p.typography.fontWeight.bold]:e.typography.fontWeightBold,[p.typography.font.body]:u,[p.typography.font.small]:d,[p.typography.font.large]:h,[p.transitions.easing.easeIn]:e.transitions.easing.easeIn,[p.transitions.easing.easeOut]:e.transitions.easing.easeOut,[p.transitions.easing.easeInOut]:e.transitions.easing.easeInOut,[p.transitions.duration.short]:`${e.transitions.duration.shorter}ms`,[p.transitions.duration.base]:`${e.transitions.duration.short}ms`,[p.transitions.duration.long]:`${e.transitions.duration.standard}ms`,[p.shadows.base]:(e.vars||e).shadows[2],[p.shadows.overlay]:(e.vars||e).shadows[8],[p.zIndex.panel]:(e.vars||e).zIndex.modal,[p.zIndex.menu]:(e.vars||e).zIndex.modal}}(e);return{id:t,variables:n}},[e])},useGridAriaAttributes:()=>{const e=K2(),t=e3(),n=$2(e,V3),r=$2(e,L8),i=$2(e,l8),o=$2(e,Q4),s=t["aria-label"],a=t["aria-labelledby"];return{role:"grid","aria-label":!s&&!a&&t.label?t.label:s,"aria-labelledby":a,"aria-colcount":n.length,"aria-rowcount":i+1+o+r,"aria-multiselectable":L9(t)}},useGridRowAriaAttributes:()=>{const e=K2(),n=$2(e,l8);return t.useCallback((t,r)=>{const i={},o=r+n+2;return i["aria-rowindex"]=o,e.current.isRowSelectable(t.id)&&(i["aria-selected"]=e.current.isRowSelected(t.id)),i},[e,n])},useCellAggregationResult:()=>null}},cve=function(e,t){const n=Kme(e),r=ave(n.apiRef,n);return Cne(r,n),(0,MH.jsx)(V9,{privateApiRef:r,configuration:lve,props:n,children:(0,MH.jsx)(F9,$Q({className:n.className,style:n.style,sx:n.sx},n.slotProps?.root,{ref:t}))})};const uve=t.memo(YQ(cve));cve.propTypes={apiRef:UQ.shape({current:UQ.object}),"aria-label":UQ.string,"aria-labelledby":UQ.string,autoHeight:UQ.bool,autoPageSize:UQ.bool,autosizeOnMount:UQ.bool,autosizeOptions:UQ.shape({columns:UQ.arrayOf(UQ.string),disableColumnVirtualization:UQ.bool,expand:UQ.bool,includeHeaders:UQ.bool,includeOutliers:UQ.bool,outliersFactor:UQ.number}),cellModesModel:UQ.object,checkboxSelection:UQ.bool,classes:UQ.object,className:UQ.string,clipboardCopyCellDelimiter:UQ.string,columnBufferPx:UQ.number,columnGroupHeaderHeight:UQ.number,columnGroupingModel:UQ.arrayOf(UQ.object),columnHeaderHeight:UQ.number,columns:UQ.arrayOf(UQ.object).isRequired,columnVisibilityModel:UQ.object,dataSource:UQ.shape({getRows:UQ.func.isRequired,updateRow:UQ.func}),dataSourceCache:UQ.shape({clear:UQ.func.isRequired,get:UQ.func.isRequired,set:UQ.func.isRequired}),density:UQ.oneOf(["comfortable","compact","standard"]),disableAutosize:UQ.bool,disableColumnFilter:UQ.bool,disableColumnMenu:UQ.bool,disableColumnResize:UQ.bool,disableColumnSelector:UQ.bool,disableColumnSorting:UQ.bool,disableDensitySelector:UQ.bool,disableEval:UQ.bool,disableMultipleRowSelection:UQ.bool,disableRowSelectionOnClick:UQ.bool,disableVirtualization:UQ.bool,editMode:UQ.oneOf(["cell","row"]),estimatedRowCount:UQ.number,experimentalFeatures:UQ.shape({warnIfFocusStateIsNotSynced:UQ.bool}),filterDebounceMs:UQ.number,filterMode:UQ.oneOf(["client","server"]),filterModel:UQ.shape({items:UQ.arrayOf(UQ.shape({field:UQ.string.isRequired,id:UQ.oneOfType([UQ.number,UQ.string]),operator:UQ.string.isRequired,value:UQ.any})).isRequired,logicOperator:UQ.oneOf(["and","or"]),quickFilterExcludeHiddenColumns:UQ.bool,quickFilterLogicOperator:UQ.oneOf(["and","or"]),quickFilterValues:UQ.array}),getCellClassName:UQ.func,getDetailPanelContent:UQ.func,getEstimatedRowHeight:UQ.func,getRowClassName:UQ.func,getRowHeight:UQ.func,getRowId:UQ.func,getRowSpacing:UQ.func,hideFooter:UQ.bool,hideFooterPagination:UQ.bool,hideFooterSelectedRowCount:UQ.bool,ignoreDiacritics:UQ.bool,ignoreValueFormatterDuringExport:UQ.oneOfType([UQ.shape({clipboardExport:UQ.bool,csvExport:UQ.bool}),UQ.bool]),initialState:UQ.object,isCellEditable:UQ.func,isRowSelectable:UQ.func,keepNonExistentRowsSelected:UQ.bool,label:UQ.string,loading:UQ.bool,localeText:UQ.object,logger:UQ.shape({debug:UQ.func.isRequired,error:UQ.func.isRequired,info:UQ.func.isRequired,warn:UQ.func.isRequired}),logLevel:UQ.oneOf(["debug","error","info","warn",!1]),nonce:UQ.string,onCellClick:UQ.func,onCellDoubleClick:UQ.func,onCellEditStart:UQ.func,onCellEditStop:UQ.func,onCellKeyDown:UQ.func,onCellModesModelChange:UQ.func,onClipboardCopy:UQ.func,onColumnHeaderClick:UQ.func,onColumnHeaderContextMenu:UQ.func,onColumnHeaderDoubleClick:UQ.func,onColumnHeaderEnter:UQ.func,onColumnHeaderLeave:UQ.func,onColumnHeaderOut:UQ.func,onColumnHeaderOver:UQ.func,onColumnOrderChange:UQ.func,onColumnResize:UQ.func,onColumnVisibilityModelChange:UQ.func,onColumnWidthChange:UQ.func,onDataSourceError:UQ.func,onDensityChange:UQ.func,onFilterModelChange:UQ.func,onMenuClose:UQ.func,onMenuOpen:UQ.func,onPaginationMetaChange:UQ.func,onPaginationModelChange:UQ.func,onPreferencePanelClose:UQ.func,onPreferencePanelOpen:UQ.func,onProcessRowUpdateError:UQ.func,onResize:UQ.func,onRowClick:UQ.func,onRowCountChange:UQ.func,onRowDoubleClick:UQ.func,onRowEditStart:UQ.func,onRowEditStop:UQ.func,onRowModesModelChange:UQ.func,onRowSelectionModelChange:UQ.func,onSortModelChange:UQ.func,onStateChange:UQ.func,pageSizeOptions:UQ.arrayOf(UQ.oneOfType([UQ.number,UQ.shape({label:UQ.string.isRequired,value:UQ.number.isRequired})]).isRequired),pagination:UQ.oneOf([!0]),paginationMeta:UQ.shape({hasNextPage:UQ.bool}),paginationMode:UQ.oneOf(["client","server"]),paginationModel:UQ.shape({page:UQ.number.isRequired,pageSize:UQ.number.isRequired}),processRowUpdate:UQ.func,resizeThrottleMs:UQ.number,rowBufferPx:UQ.number,rowCount:UQ.number,rowHeight:UQ.number,rowModesModel:UQ.object,rows:UQ.arrayOf(UQ.object),rowSelection:UQ.bool,rowSelectionModel:UQ.shape({ids:UQ.instanceOf(Set).isRequired,type:UQ.oneOf(["exclude","include"]).isRequired}),rowSpacingType:UQ.oneOf(["border","margin"]),rowSpanning:UQ.bool,scrollbarSize:UQ.number,showCellVerticalBorder:UQ.bool,showColumnVerticalBorder:UQ.bool,showToolbar:UQ.bool,slotProps:UQ.object,slots:UQ.object,sortingMode:UQ.oneOf(["client","server"]),sortingOrder:UQ.arrayOf(UQ.oneOf(["asc","desc"])),sortModel:UQ.arrayOf(UQ.shape({field:UQ.string.isRequired,sort:UQ.oneOf(["asc","desc"])})),style:UQ.object,sx:UQ.oneOfType([UQ.arrayOf(UQ.oneOfType([UQ.func,UQ.object,UQ.bool])),UQ.func,UQ.object]),virtualizeColumnsWithAutoRowHeight:UQ.bool};const dve=M2("MuiBox",["root"]),hve=w2(),pve=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{themeId:n,defaultTheme:r,defaultClassName:i="MuiBox-root",generateClassName:o}=e,s=BZ("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(Q0);return t.forwardRef(function(e,t){const a=xne(r),{className:l,component:c="div",...u}=kce(e);return(0,MH.jsx)(s,{as:c,ref:t,className:QQ(l,o?o(i):i),theme:n&&a[n]||a,...u})})}({themeId:C2,defaultTheme:hve,defaultClassName:dve.root,generateClassName:E2.generate}),gve=pve,fve=ile((0,MH.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"})),mve=ile((0,MH.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),vve=e=>{let{data:n,onDataChange:r}=e;const[i,o]=(0,t.useState)([]),s=(0,t.useMemo)(()=>{if(!n||0===n.length){const e=5,t=5,n=[];for(let r=0;r<e;r++){const e={};for(let n=0;n<t;n++)e[n.toString()]="";n.push({id:r,...e})}return n}return n.map((e,t)=>({id:t,...e}))},[n]),a=(0,t.useMemo)(()=>{if(!s||0===s.length)return[];const e=new Set;return s.forEach(t=>{Object.keys(t).forEach(t=>{"id"!==t&&e.add(t)})}),Array.from(e).sort((e,t)=>parseInt(e)-parseInt(t)).map(e=>({field:e,headerName:`Column ${e}`,width:150,editable:!0,sortable:!0,filterable:!0,resizable:!0,flex:1,minWidth:120}))},[s]),l=(0,t.useCallback)(e=>{const t=s.map(t=>t.id===e.id?e:t),n=t.map(e=>{let{id:t,...n}=e;return n});return r(n),e},[s,r]),c=(0,t.useCallback)(()=>{const e=Math.max(...s.map(e=>e.id),-1)+1,t={};a.forEach(e=>{e.field&&(t[e.field]="")});const n={id:e,...t},i=[...s,n].map(e=>{let{id:t,...n}=e;return n});r(i)},[s,a,r]),u=(0,t.useCallback)(()=>{const e=Math.max(...n.flatMap(e=>Object.keys(e).map(e=>parseInt(e))),-1)+1,t=n.map(t=>({...t,[e]:""}));r(t)},[n,r]),d=(0,t.useCallback)(async()=>{try{var e;const t=(e=>e.trim().split("\n").map(e=>e.split("\t")))(await navigator.clipboard.readText());if(0===t.length)return;let i=0,o=(null===(e=a[0])||void 0===e?void 0:e.field)||"0";const s=a.map(e=>e.field),l=s.indexOf(o),c=l>=0?l:0,u=[...n];t.forEach((e,t)=>{if(i+t>=u.length){const e={};s.forEach(t=>{e[t]=""}),u.push(e)}e.forEach((e,n)=>{const r=s[c+n];r&&u[i+t]&&(u[i+t][r]=e)})}),r(u)}catch(Wn){console.error("Error al pegar datos:",Wn)}},[a,n,r]);return t.useEffect(()=>{const e=e=>{(e.ctrlKey||e.metaKey)&&"v"===e.key&&(e.preventDefault(),d())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[d]),(0,MH.jsx)("div",{className:"mui-datagrid-spreadsheet-container",children:(0,MH.jsxs)(sae,{elevation:3,className:"mui-datagrid-paper",children:[(0,MH.jsxs)(gve,{className:"mui-datagrid-header",children:[(0,MH.jsx)(Cue,{variant:"h5",component:"h3",className:"mui-datagrid-title",children:"\ud83d\udcca MUI DataGrid Spreadsheet"}),(0,MH.jsxs)(gve,{className:"mui-datagrid-features",children:[(0,MH.jsx)(ple,{label:"\ud83d\udd04 Real-time Editing",size:"small",color:"primary",variant:"outlined"}),(0,MH.jsx)(ple,{label:"\ud83d\udd0d Advanced Filtering",size:"small",color:"secondary",variant:"outlined"}),(0,MH.jsx)(ple,{label:"\ud83d\udcc8 Material Design",size:"small",color:"success",variant:"outlined"}),(0,MH.jsx)(ple,{label:"\ud83c\udfa8 Beautiful UI",size:"small",color:"info",variant:"outlined"})]})]}),(0,MH.jsxs)(gve,{className:"mui-datagrid-controls",children:[(0,MH.jsx)(Ppe,{variant:"contained",color:"success",startIcon:(0,MH.jsx)(fve,{}),onClick:c,className:"control-button",children:"Add Row"}),(0,MH.jsx)(Ppe,{variant:"contained",color:"warning",startIcon:(0,MH.jsx)(mve,{}),onClick:u,className:"control-button",children:"Add Column"})]}),(0,MH.jsx)(gve,{className:"mui-datagrid-wrapper",children:(0,MH.jsx)(uve,{rows:s,columns:a,processRowUpdate:l,onProcessRowUpdateError:e=>{console.error("Row update error:",e)},initialState:{pagination:{paginationModel:{page:0,pageSize:10}}},pageSizeOptions:[5,10,25,50],checkboxSelection:!0,disableRowSelectionOnClick:!0,autoHeight:!0,density:"comfortable",sx:{"& .MuiDataGrid-cell:focus":{outline:"none"},"& .MuiDataGrid-cell:focus-within":{outline:"2px solid #1976d2",outlineOffset:"-2px"},"& .MuiDataGrid-row:hover":{backgroundColor:"rgba(25, 118, 210, 0.04)"},"& .MuiDataGrid-columnHeaders":{backgroundColor:"#f5f5f5",fontWeight:"bold"},"& .MuiDataGrid-virtualScroller":{backgroundColor:"#ffffff"}}})}),(0,MH.jsxs)(gve,{className:"mui-datagrid-info",children:[(0,MH.jsx)(Cue,{variant:"h6",component:"h4",className:"info-title",children:"\ud83c\udfaf MUI DataGrid Features"}),(0,MH.jsxs)(gve,{component:"ul",className:"info-list",children:[(0,MH.jsxs)(Cue,{component:"li",children:[(0,MH.jsx)("strong",{children:"Material Design:"})," Beautiful, consistent interface following Material Design principles"]}),(0,MH.jsxs)(Cue,{component:"li",children:[(0,MH.jsx)("strong",{children:"Built-in Editing:"})," Inline cell editing with validation and error handling"]}),(0,MH.jsxs)(Cue,{component:"li",children:[(0,MH.jsx)("strong",{children:"Advanced Filtering:"})," Multiple filter types with custom filter components"]}),(0,MH.jsxs)(Cue,{component:"li",children:[(0,MH.jsx)("strong",{children:"Accessibility:"})," Full keyboard navigation and screen reader support"]}),(0,MH.jsxs)(Cue,{component:"li",children:[(0,MH.jsx)("strong",{children:"Responsive:"})," Adapts perfectly to different screen sizes"]})]})]}),(0,MH.jsxs)(gve,{className:"debug-info",children:[(0,MH.jsx)(Cue,{variant:"body2",component:"p",children:(0,MH.jsx)("strong",{children:"Debug Info:"})}),(0,MH.jsxs)(Cue,{variant:"body2",component:"p",children:["Row Count: ",s.length]}),(0,MH.jsxs)(Cue,{variant:"body2",component:"p",children:["Column Count: ",a.length]}),(0,MH.jsx)(Cue,{variant:"body2",component:"p",children:"Data Format: MUI DataGrid Compatible"})]})]})})};function wve(e){return e+.5|0}const bve=(e,t,n)=>Math.max(Math.min(e,n),t);function Cve(e){return bve(wve(2.55*e),0,255)}function yve(e){return bve(wve(255*e),0,255)}function Sve(e){return bve(wve(e/2.55)/100,0,1)}function xve(e){return bve(wve(100*e),0,100)}const Rve={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Eve=[..."0123456789ABCDEF"],Tve=e=>Eve[15&e],kve=e=>Eve[(240&e)>>4]+Eve[15&e],Mve=e=>(240&e)>>4===(15&e);function Pve(e){var t=(e=>Mve(e.r)&&Mve(e.g)&&Mve(e.b)&&Mve(e.a))(e)?Tve:kve;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Ive=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Ave(e,t,n){const r=t*Math.min(n,1-n),i=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(i-3,9-i,1),-1)};return[i(0),i(8),i(4)]}function Dve(e,t,n){const r=function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(i,4-i,1),0)};return[r(5),r(3),r(1)]}function Fve(e,t,n){const r=Ave(e,1,.5);let i;for(t+n>1&&(i=1/(t+n),t*=i,n*=i),i=0;i<3;i++)r[i]*=1-t-n,r[i]+=t;return r}function Ove(e){const t=e.r/255,n=e.g/255,r=e.b/255,i=Math.max(t,n,r),o=Math.min(t,n,r),s=(i+o)/2;let a,l,c;return i!==o&&(c=i-o,l=s>.5?c/(2-i-o):c/(i+o),a=function(e,t,n,r,i){return e===i?(t-n)/r+(t<n?6:0):t===i?(n-e)/r+2:(e-t)/r+4}(t,n,r,c,i),a=60*a+.5),[0|a,l||0,s]}function Nve(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(yve)}function Lve(e,t,n){return Nve(Ave,e,t,n)}function _ve(e){return(e%360+360)%360}function Hve(e){const t=Ive.exec(e);let n,r=255;if(!t)return;t[5]!==n&&(r=t[6]?Cve(+t[5]):yve(+t[5]));const i=_ve(+t[2]),o=+t[3]/100,s=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Nve(Fve,e,t,n)}(i,o,s):"hsv"===t[1]?function(e,t,n){return Nve(Dve,e,t,n)}(i,o,s):Lve(i,o,s),{r:n[0],g:n[1],b:n[2],a:r}}const Vve={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Bve={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Wve;function zve(e){Wve||(Wve=function(){const e={},t=Object.keys(Bve),n=Object.keys(Vve);let r,i,o,s,a;for(r=0;r<t.length;r++){for(s=a=t[r],i=0;i<n.length;i++)o=n[i],a=a.replace(o,Vve[o]);o=parseInt(Bve[s],16),e[a]=[o>>16&255,o>>8&255,255&o]}return e}(),Wve.transparent=[0,0,0,0]);const t=Wve[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const jve=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Gve=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,$ve=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Uve(e,t,n){if(e){let r=Ove(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=Lve(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function Kve(e,t){return e?Object.assign(t||{},e):e}function Yve(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=yve(e[3]))):(t=Kve(e,{r:0,g:0,b:0,a:1})).a=yve(t.a),t}function qve(e){return"r"===e.charAt(0)?function(e){const t=jve.exec(e);let n,r,i,o=255;if(t){if(t[7]!==n){const e=+t[7];o=t[8]?Cve(e):bve(255*e,0,255)}return n=+t[1],r=+t[3],i=+t[5],n=255&(t[2]?Cve(n):bve(n,0,255)),r=255&(t[4]?Cve(r):bve(r,0,255)),i=255&(t[6]?Cve(i):bve(i,0,255)),{r:n,g:r,b:i,a:o}}}(e):Hve(e)}class Xve{constructor(e){if(e instanceof Xve)return e;const t=typeof e;let n;"object"===t?n=Yve(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*Rve[e[1]],g:255&17*Rve[e[2]],b:255&17*Rve[e[3]],a:5===n?17*Rve[e[4]]:255}:7!==n&&9!==n||(t={r:Rve[e[1]]<<4|Rve[e[2]],g:Rve[e[3]]<<4|Rve[e[4]],b:Rve[e[5]]<<4|Rve[e[6]],a:9===n?Rve[e[7]]<<4|Rve[e[8]]:255})),t}(e)||zve(e)||qve(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=Kve(this._rgb);return e&&(e.a=Sve(e.a)),e}set rgb(e){this._rgb=Yve(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Sve(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?Pve(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Ove(e),n=t[0],r=xve(t[1]),i=xve(t[2]);return e.a<255?`hsla(${n}, ${r}%, ${i}%, ${Sve(e.a)})`:`hsl(${n}, ${r}%, ${i}%)`}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,r=e.rgb;let i;const o=t===i?.5:t,s=2*o-1,a=n.a-r.a,l=((s*a===-1?s:(s+a)/(1+s*a))+1)/2;i=1-l,n.r=255&l*n.r+i*r.r+.5,n.g=255&l*n.g+i*r.g+.5,n.b=255&l*n.b+i*r.b+.5,n.a=o*n.a+(1-o)*r.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const r=$ve(Sve(e.r)),i=$ve(Sve(e.g)),o=$ve(Sve(e.b));return{r:yve(Gve(r+n*($ve(Sve(t.r))-r))),g:yve(Gve(i+n*($ve(Sve(t.g))-i))),b:yve(Gve(o+n*($ve(Sve(t.b))-o))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new Xve(this.rgb)}alpha(e){return this._rgb.a=yve(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=wve(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Uve(this._rgb,2,e),this}darken(e){return Uve(this._rgb,2,-e),this}saturate(e){return Uve(this._rgb,1,e),this}desaturate(e){return Uve(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=Ove(e);n[0]=_ve(n[0]+t),n=Lve(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function Qve(){}const Jve=(()=>{let e=0;return()=>e++})();function Zve(e){return null===e||void 0===e}function ewe(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function twe(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function nwe(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function rwe(e,t){return nwe(e)?e:t}function iwe(e,t){return"undefined"===typeof e?t:e}const owe=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function swe(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function awe(e,t,n,r){let i,o,s;if(ewe(e))if(o=e.length,r)for(i=o-1;i>=0;i--)t.call(n,e[i],i);else for(i=0;i<o;i++)t.call(n,e[i],i);else if(twe(e))for(s=Object.keys(e),o=s.length,i=0;i<o;i++)t.call(n,e[s[i]],s[i])}function lwe(e,t){let n,r,i,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(i=e[n],o=t[n],i.datasetIndex!==o.datasetIndex||i.index!==o.index)return!1;return!0}function cwe(e){if(ewe(e))return e.map(cwe);if(twe(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let i=0;for(;i<r;++i)t[n[i]]=cwe(e[n[i]]);return t}return e}function uwe(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function dwe(e,t,n,r){if(!uwe(e))return;const i=t[e],o=n[e];twe(i)&&twe(o)?hwe(i,o,r):t[e]=cwe(o)}function hwe(e,t,n){const r=ewe(t)?t:[t],i=r.length;if(!twe(e))return e;const o=(n=n||{}).merger||dwe;let s;for(let a=0;a<i;++a){if(s=r[a],!twe(s))continue;const t=Object.keys(s);for(let r=0,i=t.length;r<i;++r)o(t[r],e,s,n)}return e}function pwe(e,t){return hwe(e,t,{merger:gwe})}function gwe(e,t,n){if(!uwe(e))return;const r=t[e],i=n[e];twe(r)&&twe(i)?pwe(r,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=cwe(i))}const fwe={"":e=>e,x:e=>e.x,y:e=>e.y};function mwe(e,t){const n=fwe[t]||(fwe[t]=function(e){const t=function(e){const t=e.split("."),n=[];let r="";for(const i of t)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function vwe(e){return e.charAt(0).toUpperCase()+e.slice(1)}const wwe=e=>"undefined"!==typeof e,bwe=e=>"function"===typeof e,Cwe=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const ywe=Math.PI,Swe=2*ywe,xwe=Swe+ywe,Rwe=Number.POSITIVE_INFINITY,Ewe=ywe/180,Twe=ywe/2,kwe=ywe/4,Mwe=2*ywe/3,Pwe=Math.log10,Iwe=Math.sign;function Awe(e,t,n){return Math.abs(e-t)<n}function Dwe(e){const t=Math.round(e);e=Awe(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Pwe(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function Fwe(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Owe(e,t,n){let r,i,o;for(r=0,i=e.length;r<i;r++)o=e[r][n],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function Nwe(e){return e*(ywe/180)}function Lwe(e){return e*(180/ywe)}function _we(e){if(!nwe(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Hwe(e,t){const n=t.x-e.x,r=t.y-e.y,i=Math.sqrt(n*n+r*r);let o=Math.atan2(r,n);return o<-.5*ywe&&(o+=Swe),{angle:o,distance:i}}function Vwe(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Bwe(e,t){return(e-t+xwe)%Swe-ywe}function Wwe(e){return(e%Swe+Swe)%Swe}function zwe(e,t,n,r){const i=Wwe(e),o=Wwe(t),s=Wwe(n),a=Wwe(o-i),l=Wwe(s-i),c=Wwe(i-o),u=Wwe(i-s);return i===o||i===s||r&&o===s||a>l&&c<u}function jwe(e,t,n){return Math.max(t,Math.min(n,e))}function Gwe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function $we(e,t,n){n=n||(n=>e[n]<t);let r,i=e.length-1,o=0;for(;i-o>1;)r=o+i>>1,n(r)?o=r:i=r;return{lo:o,hi:i}}const Uwe=(e,t,n,r)=>$we(e,n,r?r=>{const i=e[r][t];return i<n||i===n&&e[r+1][t]===n}:r=>e[r][t]<n),Kwe=(e,t,n)=>$we(e,n,r=>e[r][t]>=n);const Ywe=["push","pop","shift","splice","unshift"];function qwe(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,i=r.indexOf(t);-1!==i&&r.splice(i,1),r.length>0||(Ywe.forEach(t=>{delete e[t]}),delete e._chartjs)}function Xwe(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Qwe="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function Jwe(e,t){let n=[],r=!1;return function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];n=o,r||(r=!0,Qwe.call(window,()=>{r=!1,e.apply(t,n)}))}}const Zwe=e=>"start"===e?"left":"end"===e?"right":"center",ebe=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function tbe(e,t,n){const r=t.length;let i=0,o=r;if(e._sorted){const{iScale:s,vScale:a,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,u=s.axis,{min:d,max:h,minDefined:p,maxDefined:g}=s.getUserBounds();if(p){if(i=Math.min(Uwe(l,u,d).lo,n?r:Uwe(t,u,s.getPixelForValue(d)).lo),c){const e=l.slice(0,i+1).reverse().findIndex(e=>!Zve(e[a.axis]));i-=Math.max(0,e)}i=jwe(i,0,r-1)}if(g){let e=Math.max(Uwe(l,s.axis,h,!0).hi+1,n?0:Uwe(t,u,s.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex(e=>!Zve(e[a.axis]));e+=Math.max(0,t)}o=jwe(e,i,r)-i}else o=r-i}return{start:i,count:o}}function nbe(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,i={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=i,!0;const o=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,i),o}const rbe=e=>0===e||1===e,ibe=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Swe/n),obe=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Swe/n)+1,sbe={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Twe),easeOutSine:e=>Math.sin(e*Twe),easeInOutSine:e=>-.5*(Math.cos(ywe*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>rbe(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>rbe(e)?e:ibe(e,.075,.3),easeOutElastic:e=>rbe(e)?e:obe(e,.075,.3),easeInOutElastic(e){const t=.1125;return rbe(e)?e:e<.5?.5*ibe(2*e,t,.45):.5+.5*obe(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-sbe.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*sbe.easeInBounce(2*e):.5*sbe.easeOutBounce(2*e-1)+.5};function abe(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function lbe(e){return abe(e)?e:new Xve(e)}function cbe(e){return abe(e)?e:new Xve(e).saturate(.5).darken(.1).hexString()}const ube=["x","y","borderWidth","radius","tension"],dbe=["color","borderColor","backgroundColor"];const hbe=new Map;function pbe(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let r=hbe.get(n);return r||(r=new Intl.NumberFormat(e,t),hbe.set(n,r)),r}(t,n).format(e)}const gbe={values:e=>ewe(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const r=this.chart.options.locale;let i,o=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(i="scientific"),o=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const s=Pwe(Math.abs(o)),a=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),pbe(e,r,l)},logarithmic(e,t,n){if(0===e)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(Pwe(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?gbe.numeric.call(this,e,t,n):""}};var fbe={formatters:gbe};const mbe=Object.create(null),vbe=Object.create(null);function wbe(e,t){if(!t)return e;const n=t.split(".");for(let r=0,i=n.length;r<i;++r){const t=n[r];e=e[t]||(e[t]=Object.create(null))}return e}function bbe(e,t,n){return"string"===typeof t?hwe(wbe(e,t),n):hwe(wbe(e,""),t)}class Cbe{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>cbe(t.backgroundColor),this.hoverBorderColor=(e,t)=>cbe(t.borderColor),this.hoverColor=(e,t)=>cbe(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return bbe(this,e,t)}get(e){return wbe(this,e)}describe(e,t){return bbe(vbe,e,t)}override(e,t){return bbe(mbe,e,t)}route(e,t,n,r){const i=wbe(this,e),o=wbe(this,n),s="_"+t;Object.defineProperties(i,{[s]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[s],t=o[r];return twe(e)?Object.assign({},t,e):iwe(e,t)},set(e){this[s]=e}}})}apply(e){e.forEach(e=>e(this))}}var ybe=new Cbe({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:dbe},numbers:{type:"number",properties:ube}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:fbe.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Sbe(e,t,n,r,i){let o=t[i];return o||(o=t[i]=e.measureText(i).width,n.push(i)),o>r&&(r=o),r}function xbe(e,t,n){const r=e.currentDevicePixelRatio,i=0!==n?Math.max(n/2,.5):0;return Math.round((t-i)*r)/r+i}function Rbe(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Ebe(e,t,n,r){Tbe(e,t,n,r,null)}function Tbe(e,t,n,r,i){let o,s,a,l,c,u,d,h;const p=t.pointStyle,g=t.rotation,f=t.radius;let m=(g||0)*Ewe;if(p&&"object"===typeof p&&(o=p.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return e.save(),e.translate(n,r),e.rotate(m),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(f)||f<=0)){switch(e.beginPath(),p){default:i?e.ellipse(n,r,i/2,f,0,0,Swe):e.arc(n,r,f,0,Swe),e.closePath();break;case"triangle":u=i?i/2:f,e.moveTo(n+Math.sin(m)*u,r-Math.cos(m)*f),m+=Mwe,e.lineTo(n+Math.sin(m)*u,r-Math.cos(m)*f),m+=Mwe,e.lineTo(n+Math.sin(m)*u,r-Math.cos(m)*f),e.closePath();break;case"rectRounded":c=.516*f,l=f-c,s=Math.cos(m+kwe)*l,d=Math.cos(m+kwe)*(i?i/2-c:l),a=Math.sin(m+kwe)*l,h=Math.sin(m+kwe)*(i?i/2-c:l),e.arc(n-d,r-a,c,m-ywe,m-Twe),e.arc(n+h,r-s,c,m-Twe,m),e.arc(n+d,r+a,c,m,m+Twe),e.arc(n-h,r+s,c,m+Twe,m+ywe),e.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*f,u=i?i/2:l,e.rect(n-u,r-l,2*u,2*l);break}m+=kwe;case"rectRot":d=Math.cos(m)*(i?i/2:f),s=Math.cos(m)*f,a=Math.sin(m)*f,h=Math.sin(m)*(i?i/2:f),e.moveTo(n-d,r-a),e.lineTo(n+h,r-s),e.lineTo(n+d,r+a),e.lineTo(n-h,r+s),e.closePath();break;case"crossRot":m+=kwe;case"cross":d=Math.cos(m)*(i?i/2:f),s=Math.cos(m)*f,a=Math.sin(m)*f,h=Math.sin(m)*(i?i/2:f),e.moveTo(n-d,r-a),e.lineTo(n+d,r+a),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s);break;case"star":d=Math.cos(m)*(i?i/2:f),s=Math.cos(m)*f,a=Math.sin(m)*f,h=Math.sin(m)*(i?i/2:f),e.moveTo(n-d,r-a),e.lineTo(n+d,r+a),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s),m+=kwe,d=Math.cos(m)*(i?i/2:f),s=Math.cos(m)*f,a=Math.sin(m)*f,h=Math.sin(m)*(i?i/2:f),e.moveTo(n-d,r-a),e.lineTo(n+d,r+a),e.moveTo(n+h,r-s),e.lineTo(n-h,r+s);break;case"line":s=i?i/2:Math.cos(m)*f,a=Math.sin(m)*f,e.moveTo(n-s,r-a),e.lineTo(n+s,r+a);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(m)*(i?i/2:f),r+Math.sin(m)*f);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function kbe(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Mbe(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Pbe(e){e.restore()}function Ibe(e,t,n,r,i){if(!t)return e.lineTo(n.x,n.y);if("middle"===i){const r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else"after"===i!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Abe(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function Dbe(e,t,n,r,i){if(i.strikethrough||i.underline){const o=e.measureText(r),s=t-o.actualBoundingBoxLeft,a=t+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,c=n+o.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(s,u),e.lineTo(a,u),e.stroke()}}function Fbe(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Obe(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=ewe(t)?t:[t],a=o.strokeWidth>0&&""!==o.strokeColor;let l,c;for(e.save(),e.font=i.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Zve(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,o),l=0;l<s.length;++l)c=s[l],o.backdrop&&Fbe(e,o.backdrop),a&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),Zve(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(c,n,r,o.maxWidth)),e.fillText(c,n,r,o.maxWidth),Dbe(e,n,r,c,o),r+=Number(i.lineHeight);e.restore()}function Nbe(e,t){const{x:n,y:r,w:i,h:o,radius:s}=t;e.arc(n+s.topLeft,r+s.topLeft,s.topLeft,1.5*ywe,ywe,!0),e.lineTo(n,r+o-s.bottomLeft),e.arc(n+s.bottomLeft,r+o-s.bottomLeft,s.bottomLeft,ywe,Twe,!0),e.lineTo(n+i-s.bottomRight,r+o),e.arc(n+i-s.bottomRight,r+o-s.bottomRight,s.bottomRight,Twe,0,!0),e.lineTo(n+i,r+s.topRight),e.arc(n+i-s.topRight,r+s.topRight,s.topRight,0,-Twe,!0),e.lineTo(n+s.topLeft,r)}const Lbe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,_be=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Hbe(e,t){const n=(""+e).match(Lbe);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}const Vbe=e=>+e||0;function Bbe(e,t){const n={},r=twe(t),i=r?Object.keys(t):t,o=twe(e)?r?n=>iwe(e[n],e[t[n]]):t=>e[t]:()=>e;for(const s of i)n[s]=Vbe(o(s));return n}function Wbe(e){return Bbe(e,{top:"y",right:"x",bottom:"y",left:"x"})}function zbe(e){return Bbe(e,["topLeft","topRight","bottomLeft","bottomRight"])}function jbe(e){const t=Wbe(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Gbe(e,t){e=e||{},t=t||ybe.font;let n=iwe(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let r=iwe(e.style,t.style);r&&!(""+r).match(_be)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:iwe(e.family,t.family),lineHeight:Hbe(iwe(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:iwe(e.weight,t.weight),string:""};return i.string=function(e){return!e||Zve(e.size)||Zve(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(i),i}function $be(e,t,n,r){let i,o,s,a=!0;for(i=0,o=e.length;i<o;++i)if(s=e[i],void 0!==s&&(void 0!==t&&"function"===typeof s&&(s=s(t),a=!1),void 0!==n&&ewe(s)&&(s=s[n%s.length],a=!1),void 0!==s))return r&&!a&&(r.cacheable=!1),s}function Ube(e,t){return Object.assign(Object.create(e),t)}function Kbe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const i=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=iCe("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:n,_getTarget:r,override:r=>Kbe([r,...e],t,i,n)};return new Proxy(o,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,r)=>Jbe(n,r,()=>function(e,t,n,r){let i;for(const o of t)if(i=iCe(Xbe(o,e),n),"undefined"!==typeof i)return Qbe(e,i)?nCe(n,r,e,i):i}(r,t,e,n)),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>oCe(e).includes(t),ownKeys:e=>oCe(e),set(e,t,n){const i=e._storage||(e._storage=r());return e[t]=i[t]=n,delete e._keys,!0}})}function Ybe(e,t,n,r){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:qbe(e,r),setContext:t=>Ybe(e,t,n,r),override:i=>Ybe(e.override(i),t,n,r)};return new Proxy(i,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>Jbe(e,t,()=>function(e,t,n){const{_proxy:r,_context:i,_subProxy:o,_descriptors:s}=e;let a=r[t];bwe(a)&&s.isScriptable(t)&&(a=function(e,t,n,r){const{_proxy:i,_context:o,_subProxy:s,_stack:a}=n;if(a.has(e))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+e);a.add(e);let l=t(o,s||r);a.delete(e),Qbe(e,l)&&(l=nCe(i._scopes,i,e,l));return l}(t,a,e,n));ewe(a)&&a.length&&(a=function(e,t,n,r){const{_proxy:i,_context:o,_subProxy:s,_descriptors:a}=n;if("undefined"!==typeof o.index&&r(e))return t[o.index%t.length];if(twe(t[0])){const n=t,r=i._scopes.filter(e=>e!==n);t=[];for(const l of n){const n=nCe(r,i,e,l);t.push(Ybe(n,o,s&&s[e],a))}}return t}(t,a,e,s.isIndexable));Qbe(t,a)&&(a=Ybe(a,i,o&&o[t],s));return a}(e,t,n)),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,r)=>(e[n]=r,delete t[n],!0)})}function qbe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:n,indexable:r,isScriptable:bwe(n)?n:()=>n,isIndexable:bwe(r)?r:()=>r}}const Xbe=(e,t)=>e?e+vwe(t):t,Qbe=(e,t)=>twe(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function Jbe(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const r=n();return e[t]=r,r}function Zbe(e,t,n){return bwe(e)?e(t,n):e}const eCe=(e,t)=>!0===e?t:"string"===typeof e?mwe(t,e):void 0;function tCe(e,t,n,r,i){for(const o of t){const t=eCe(n,o);if(t){e.add(t);const o=Zbe(t._fallback,n,i);if("undefined"!==typeof o&&o!==n&&o!==r)return o}else if(!1===t&&"undefined"!==typeof r&&n!==r)return null}return!1}function nCe(e,t,n,r){const i=t._rootScopes,o=Zbe(t._fallback,n,r),s=[...e,...i],a=new Set;a.add(r);let l=rCe(a,s,n,o||n,r);return null!==l&&(("undefined"===typeof o||o===n||(l=rCe(a,s,o,l,r),null!==l))&&Kbe(Array.from(a),[""],i,o,()=>function(e,t,n){const r=e._getTarget();t in r||(r[t]={});const i=r[t];if(ewe(i)&&twe(n))return n;return i||{}}(t,n,r)))}function rCe(e,t,n,r,i){for(;n;)n=tCe(e,t,n,r,i);return n}function iCe(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function oCe(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter(e=>!e.startsWith("_")))t.add(e);return Array.from(t)}(e._scopes)),t}const sCe=Number.EPSILON||1e-14,aCe=(e,t)=>t<e.length&&!e[t].skip&&e[t],lCe=e=>"x"===e?"y":"x";function cCe(e,t,n,r){const i=e.skip?t:e,o=t,s=n.skip?t:n,a=Vwe(o,i),l=Vwe(s,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=r*c,h=r*u;return{previous:{x:o.x-d*(s.x-i.x),y:o.y-d*(s.y-i.y)},next:{x:o.x+h*(s.x-i.x),y:o.y+h*(s.y-i.y)}}}function uCe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=lCe(t),r=e.length,i=Array(r).fill(0),o=Array(r);let s,a,l,c=aCe(e,0);for(s=0;s<r;++s)if(a=l,l=c,c=aCe(e,s+1),l){if(c){const e=c[t]-l[t];i[s]=0!==e?(c[n]-l[n])/e:0}o[s]=a?c?Iwe(i[s-1])!==Iwe(i[s])?0:(i[s-1]+i[s])/2:i[s-1]:i[s]}!function(e,t,n){const r=e.length;let i,o,s,a,l,c=aCe(e,0);for(let u=0;u<r-1;++u)l=c,c=aCe(e,u+1),l&&c&&(Awe(t[u],0,sCe)?n[u]=n[u+1]=0:(i=n[u]/t[u],o=n[u+1]/t[u],a=Math.pow(i,2)+Math.pow(o,2),a<=9||(s=3/Math.sqrt(a),n[u]=i*s*t[u],n[u+1]=o*s*t[u])))}(e,i,o),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const r=lCe(n),i=e.length;let o,s,a,l=aCe(e,0);for(let c=0;c<i;++c){if(s=a,a=l,l=aCe(e,c+1),!a)continue;const i=a[n],u=a[r];s&&(o=(i-s[n])/3,a[`cp1${n}`]=i-o,a[`cp1${r}`]=u-o*t[c]),l&&(o=(l[n]-i)/3,a[`cp2${n}`]=i+o,a[`cp2${r}`]=u+o*t[c])}}(e,o,t)}function dCe(e,t,n){return Math.max(Math.min(e,n),t)}function hCe(e,t,n,r,i){let o,s,a,l;if(t.spanGaps&&(e=e.filter(e=>!e.skip)),"monotone"===t.cubicInterpolationMode)uCe(e,i);else{let n=r?e[e.length-1]:e[0];for(o=0,s=e.length;o<s;++o)a=e[o],l=cCe(n,a,e[Math.min(o+1,s-(r?0:1))%s],t.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,n=a}t.capBezierPoints&&function(e,t){let n,r,i,o,s,a=kbe(e[0],t);for(n=0,r=e.length;n<r;++n)s=o,o=a,a=n<r-1&&kbe(e[n+1],t),o&&(i=e[n],s&&(i.cp1x=dCe(i.cp1x,t.left,t.right),i.cp1y=dCe(i.cp1y,t.top,t.bottom)),a&&(i.cp2x=dCe(i.cp2x,t.left,t.right),i.cp2y=dCe(i.cp2y,t.top,t.bottom)))}(e,n)}function pCe(){return"undefined"!==typeof window&&"undefined"!==typeof document}function gCe(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function fCe(e,t,n){let r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}const mCe=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const vCe=["top","right","bottom","left"];function wCe(e,t,n){const r={};n=n?"-"+n:"";for(let i=0;i<4;i++){const o=vCe[i];r[o]=parseFloat(e[t+"-"+o+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function bCe(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,i=mCe(n),o="border-box"===i.boxSizing,s=wCe(i,"padding"),a=wCe(i,"border","width"),{x:l,y:c,box:u}=function(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:i,offsetY:o}=r;let s,a,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(i,o,e.target))s=i,a=o;else{const e=t.getBoundingClientRect();s=r.clientX-e.left,a=r.clientY-e.top,l=!0}return{x:s,y:a,box:l}}(e,n),d=s.left+(u&&a.left),h=s.top+(u&&a.top);let{width:p,height:g}=t;return o&&(p-=s.width+a.width,g-=s.height+a.height),{x:Math.round((l-d)/p*n.width/r),y:Math.round((c-h)/g*n.height/r)}}const CCe=e=>Math.round(10*e)/10;function yCe(e,t,n,r){const i=mCe(e),o=wCe(i,"margin"),s=fCe(i.maxWidth,e,"clientWidth")||Rwe,a=fCe(i.maxHeight,e,"clientHeight")||Rwe,l=function(e,t,n){let r,i;if(void 0===t||void 0===n){const o=e&&gCe(e);if(o){const e=o.getBoundingClientRect(),s=mCe(o),a=wCe(s,"border","width"),l=wCe(s,"padding");t=e.width-l.width-a.width,n=e.height-l.height-a.height,r=fCe(s.maxWidth,o,"clientWidth"),i=fCe(s.maxHeight,o,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||Rwe,maxHeight:i||Rwe}}(e,t,n);let{width:c,height:u}=l;if("content-box"===i.boxSizing){const e=wCe(i,"border","width"),t=wCe(i,"padding");c-=t.width+e.width,u-=t.height+e.height}c=Math.max(0,c-o.width),u=Math.max(0,r?c/r:u-o.height),c=CCe(Math.min(c,s,l.maxWidth)),u=CCe(Math.min(u,a,l.maxHeight)),c&&!u&&(u=CCe(c/2));return(void 0!==t||void 0!==n)&&r&&l.height&&u>l.height&&(u=l.height,c=CCe(Math.floor(u*r))),{width:c,height:u}}function SCe(e,t,n){const r=t||1,i=Math.floor(e.height*r),o=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const s=e.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${e.height}px`,s.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==r||s.height!==i||s.width!==o)&&(e.currentDevicePixelRatio=r,s.height=i,s.width=o,e.ctx.setTransform(r,0,0,r,0,0),!0)}const xCe=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};pCe()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(t){}return e}();function RCe(e,t){const n=function(e,t){return mCe(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function ECe(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function TCe(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function kCe(e,t,n,r){const i={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},s=ECe(e,i,n),a=ECe(i,o,n),l=ECe(o,t,n),c=ECe(s,a,n),u=ECe(a,l,n);return ECe(c,u,n)}function MCe(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function PCe(e,t){let n,r;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function ICe(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function ACe(e){return"angle"===e?{between:zwe,compare:Bwe,normalize:Wwe}:{between:Gwe,compare:(e,t)=>e-t,normalize:e=>e}}function DCe(e){let{start:t,end:n,count:r,loop:i,style:o}=e;return{start:t%r,end:n%r,loop:i&&(n-t+1)%r===0,style:o}}function FCe(e,t,n){if(!n)return[e];const{property:r,start:i,end:o}=n,s=t.length,{compare:a,between:l,normalize:c}=ACe(r),{start:u,end:d,loop:h,style:p}=function(e,t,n){const{property:r,start:i,end:o}=n,{between:s,normalize:a}=ACe(r),l=t.length;let c,u,{start:d,end:h,loop:p}=e;if(p){for(d+=l,h+=l,c=0,u=l;c<u&&s(a(t[d%l][r]),i,o);++c)d--,h--;d%=l,h%=l}return h<d&&(h+=l),{start:d,end:h,loop:p,style:e.style}}(e,t,n),g=[];let f,m,v,w=!1,b=null;const C=()=>w||l(i,v,f)&&0!==a(i,v),y=()=>!w||0===a(o,f)||l(o,v,f);for(let S=u,x=u;S<=d;++S)m=t[S%s],m.skip||(f=c(m[r]),f!==v&&(w=l(f,i,o),null===b&&C()&&(b=0===a(f,i)?S:x),null!==b&&y()&&(g.push(DCe({start:b,end:S,loop:h,count:s,style:p})),b=null),x=S,v=f));return null!==b&&g.push(DCe({start:b,end:d,loop:h,count:s,style:p})),g}function OCe(e,t){const n=[],r=e.segments;for(let i=0;i<r.length;i++){const o=FCe(r[i],e.points,t);o.length&&n.push(...o)}return n}function NCe(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){const i=e._chart.getContext(),o=LCe(e.options),{_datasetIndex:s,options:{spanGaps:a}}=e,l=n.length,c=[];let u=o,d=t[0].start,h=d;function p(e,t,r,i){const o=a?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=o;for(;n[t%l].skip;)t+=o;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:r,style:i}),u=i,d=t%l)}}for(const g of t){d=a?d:g.start;let e,t=n[d%l];for(h=d+1;h<=g.end;h++){const o=n[h%l];e=LCe(r.setContext(Ube(i,{type:"segment",p0:t,p1:o,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:s}))),_Ce(e,u)&&p(d,h-1,g.loop,u),t=o,u=e}d<h-1&&p(d,h-1,g.loop,u)}return c}(e,t,n,r):t}function LCe(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function _Ce(e,t){if(!t)return!1;const n=[],r=function(e,t){return abe(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}function HCe(e,t,n){return e.options.clip?e[n]:t[n]}function VCe(e,t){const n=t._clip;if(n.disabled)return!1;const r=function(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:HCe(n,t,"left"),right:HCe(n,t,"right"),top:HCe(r,t,"top"),bottom:HCe(r,t,"bottom")}:t}(t,e.chartArea);return{left:!1===n.left?0:r.left-(!0===n.left?0:n.left),right:!1===n.right?e.width:r.right+(!0===n.right?0:n.right),top:!1===n.top?0:r.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?e.height:r.bottom+(!0===n.bottom?0:n.bottom)}}class BCe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,r){const i=t.listeners[r],o=t.duration;i.forEach(r=>r({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Qwe.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;const i=n.items;let o,s=i.length-1,a=!1;for(;s>=0;--s)o=i[s],o._active?(o._total>n.duration&&(n.duration=o._total),o.tick(e),a=!0):(i[s]=i[i.length-1],i.pop());a&&(r.draw(),this._notify(r,n,e,"progress")),i.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),t+=i.length}),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((e,t)=>Math.max(e,t._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var WCe=new BCe;const zCe="transparent",jCe={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const r=lbe(e||zCe),i=r.valid&&lbe(t||zCe);return i&&i.valid?i.mix(r,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class GCe{constructor(e,t,n,r){const i=t[n];r=$be([e.to,r,i,e.from]);const o=$be([e.from,i,r]);this._active=!0,this._fn=e.fn||jCe[e.type||typeof o],this._easing=sbe[e.easing]||sbe.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const r=this._target[this._prop],i=n-this._start,o=this._duration-i;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=$be([e.to,t,r,e.from]),this._from=$be([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,r=this._prop,i=this._from,o=this._loop,s=this._to;let a;if(this._active=i!==s&&(o||t<n),!this._active)return this._target[r]=s,void this._notify(!0);t<0?this._target[r]=i:(a=t/n%2,a=o&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[r]=this._fn(i,s,a))}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][t]()}}class $Ce{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!twe(e))return;const t=Object.keys(ybe.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!twe(i))return;const o={};for(const e of t)o[e]=i[e];(ewe(i.properties)&&i.properties||[r]).forEach(e=>{e!==r&&n.has(e)||n.set(e,o)})})}_animateOptions(e,t){const n=t.options,r=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];const i=this._createAnimations(r,n);return n.$shared&&function(e,t){const n=[],r=Object.keys(t);for(let i=0;i<r.length;i++){const t=e[r[i]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then(()=>{e.options=n},()=>{}),i}_createAnimations(e,t){const n=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),s=Date.now();let a;for(a=o.length-1;a>=0;--a){const l=o[a];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(e,t));continue}const c=t[l];let u=i[l];const d=n.get(l);if(u){if(d&&u.active()){u.update(d,c,s);continue}u.cancel()}d&&d.duration?(i[l]=u=new GCe(d,e,l,c),r.push(u)):e[l]=c}return r}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(WCe.add(this._chart,n),!0):void 0}}function UCe(e,t){const n=e&&e.options||{},r=n.reverse,i=void 0===n.min?t:0,o=void 0===n.max?t:0;return{start:r?o:i,end:r?i:o}}function KCe(e,t){const n=[],r=e._getSortedDatasetMetas(t);let i,o;for(i=0,o=r.length;i<o;++i)n.push(r[i].index);return n}function YCe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.keys,o="single"===r.mode;let s,a,l,c;if(null===t)return;let u=!1;for(s=0,a=i.length;s<a;++s){if(l=+i[s],l===n){if(u=!0,r.all)continue;break}c=e.values[l],nwe(c)&&(o||0===t||Iwe(t)===Iwe(c))&&(t+=c)}return u||r.all?t:0}function qCe(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function XCe(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function QCe(e,t,n,r){for(const i of t.getMatchingVisibleMetas(r).reverse()){const t=e[i.index];if(n&&t>0||!n&&t<0)return i.index}return null}function JCe(e,t){const{chart:n,_cachedMeta:r}=e,i=n._stacks||(n._stacks={}),{iScale:o,vScale:s,index:a}=r,l=o.axis,c=s.axis,u=function(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}(o,s,r),d=t.length;let h;for(let p=0;p<d;++p){const e=t[p],{[l]:n,[c]:o}=e;h=(e._stacks||(e._stacks={}))[c]=XCe(i,u,n),h[a]=o,h._top=QCe(h,s,!0,r.type),h._bottom=QCe(h,s,!1,r.type);(h._visualValues||(h._visualValues={}))[a]=o}}function ZCe(e,t){const n=e.scales;return Object.keys(n).filter(e=>n[e].axis===t).shift()}function eye(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[r]||void 0===t[r][n])return;delete t[r][n],void 0!==t[r]._visualValues&&void 0!==t[r]._visualValues[n]&&delete t[r]._visualValues[n]}}}const tye=e=>"reset"===e||"none"===e,nye=(e,t)=>t?e:Object.assign({},e);class rye{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=qCe(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&eye(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=(e,t,n,r)=>"x"===e?t:"r"===e?r:n,i=t.xAxisID=iwe(n.xAxisID,ZCe(e,"x")),o=t.yAxisID=iwe(n.yAxisID,ZCe(e,"y")),s=t.rAxisID=iwe(n.rAxisID,ZCe(e,"r")),a=t.indexAxis,l=t.iAxisID=r(a,i,o,s),c=t.vAxisID=r(a,o,i,s);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(s),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&qwe(this._data,this),e._stacked&&eye(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(twe(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:r}=t,i="x"===n.axis?"x":"y",o="x"===r.axis?"x":"y",s=Object.keys(e),a=new Array(s.length);let l,c,u;for(l=0,c=s.length;l<c;++l)u=s[l],a[l]={[i]:u,[o]:e[u]};return a}(t,e)}else if(n!==t){if(n){qwe(n,this);const e=this._cachedMeta;eye(e),e._parsed=[]}t&&Object.isExtensible(t)&&(i=this,(r=t)._chartjs?r._chartjs.listeners.push(i):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[i]}}),Ywe.forEach(e=>{const t="_onData"+vwe(e),n=r[e];Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];const s=n.apply(this,i);return r._chartjs.listeners.forEach(e=>{"function"===typeof e[t]&&e[t](...i)}),s}})}))),this._syncList=[],this._data=t}var r,i}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const i=t._stacked;t._stacked=qCe(t.vScale,t),t.stack!==n.stack&&(r=!0,eye(t),t.stack=n.stack),this._resyncElements(e),(r||i!==t._stacked)&&(JCe(this,t._parsed),t._stacked=qCe(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:r}=this,{iScale:i,_stacked:o}=n,s=i.axis;let a,l,c,u=0===e&&t===r.length||n._sorted,d=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=r,n._sorted=!0,c=r;else{c=ewe(r[e])?this.parseArrayData(n,r,e,t):twe(r[e])?this.parseObjectData(n,r,e,t):this.parsePrimitiveData(n,r,e,t);const i=()=>null===l[s]||d&&l[s]<d[s];for(a=0;a<t;++a)n._parsed[a+e]=l=c[a],u&&(i()&&(u=!1),d=l);n._sorted=u}o&&JCe(this,c)}parsePrimitiveData(e,t,n,r){const{iScale:i,vScale:o}=e,s=i.axis,a=o.axis,l=i.getLabels(),c=i===o,u=new Array(r);let d,h,p;for(d=0,h=r;d<h;++d)p=d+n,u[d]={[s]:c||i.parse(l[p],p),[a]:o.parse(t[p],p)};return u}parseArrayData(e,t,n,r){const{xScale:i,yScale:o}=e,s=new Array(r);let a,l,c,u;for(a=0,l=r;a<l;++a)c=a+n,u=t[c],s[a]={x:i.parse(u[0],c),y:o.parse(u[1],c)};return s}parseObjectData(e,t,n,r){const{xScale:i,yScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l=new Array(r);let c,u,d,h;for(c=0,u=r;c<u;++c)d=c+n,h=t[d],l[c]={x:i.parse(mwe(h,s),d),y:o.parse(mwe(h,a),d)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const r=this.chart,i=this._cachedMeta,o=t[e.axis];return YCe({keys:KCe(r,!0),values:t._stacks[e.axis]._visualValues},o,i.index,{mode:n})}updateRangeFromParsed(e,t,n,r){const i=n[t.axis];let o=null===i?NaN:i;const s=r&&n._stacks[t.axis];r&&s&&(r.values=s,o=YCe(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,r=n._parsed,i=n._sorted&&e===n.iScale,o=r.length,s=this._getOtherScale(e),a=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:KCe(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:u}=function(e){const{min:t,max:n,minDefined:r,maxDefined:i}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:i?n:Number.POSITIVE_INFINITY}}(s);let d,h;function p(){h=r[d];const t=h[s.axis];return!nwe(h[e.axis])||c>t||u<t}for(d=0;d<o&&(p()||(this.updateRangeFromParsed(l,e,h,a),!i));++d);if(i)for(d=o-1;d>=0;--d)if(!p()){this.updateRangeFromParsed(l,e,h,a);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let r,i,o;for(r=0,i=t.length;r<i;++r)o=t[r][e.axis],nwe(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,r=t.vScale,i=this.getParsed(e);return{label:n?""+n.getLabelForValue(i[n.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,r,i;return twe(e)?(t=e.top,n=e.right,r=e.bottom,i=e.left):t=n=r=i=e,{top:t,right:n,bottom:r,left:i,disabled:!1===e}}(iwe(this.options.clip,function(e,t,n){if(!1===n)return!1;const r=UCe(e,n),i=UCe(t,n);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,r=n.data||[],i=t.chartArea,o=[],s=this._drawStart||0,a=this._drawCount||r.length-s,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,i,s,a),c=s;c<s+a;++c){const t=r[c];t.hidden||(t.active&&l?o.push(t):t.draw(e,i))}for(c=0;c<o.length;++c)o[c].draw(e,i)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];i=t.$context||(t.$context=function(e,t,n){return Ube(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=function(e,t){return Ube(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=n,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const r="active"===t,i=this._cachedDataOpts,o=e+"-"+t,s=i[o],a=this.enableOptionSharing&&wwe(n);if(s)return nye(s,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),u=r?[`${e}Hover`,"hover",e,""]:[e,""],d=l.getOptionScopes(this.getDataset(),c),h=Object.keys(ybe.elements[e]),p=l.resolveNamedOptions(d,h,()=>this.getContext(n,r,t),u);return p.$shared&&(p.$shared=a,i[o]=Object.freeze(nye(p,a))),p}_resolveAnimations(e,t,n){const r=this.chart,i=this._cachedDataOpts,o=`animation-${t}`,s=i[o];if(s)return s;let a;if(!1!==r.options.animation){const r=this.chart.config,i=r.datasetAnimationScopeKeys(this._type,t),o=r.getOptionScopes(this.getDataset(),i);a=r.createResolver(o,this.getContext(e,n,t))}const l=new $Ce(r,a&&a.animations);return a&&a._cacheable&&(i[o]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||tye(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,i=this.getSharedOptions(n),o=this.includeOptions(t,i)||i!==r;return this.updateSharedOptions(i,t,n),{sharedOptions:i,includeOptions:o}}updateElement(e,t,n,r){tye(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}updateSharedOptions(e,t,n){e&&!tye(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,r){e.active=r;const i=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[s,a,l]of this._syncList)this[s](a,l);this._syncList=[];const r=n.length,i=t.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._cachedMeta,i=r.data,o=e+t;let s;const a=e=>{for(e.length+=t,s=e.length-1;s>=o;s--)e[s]=e[s-t]};for(a(i),s=e;s<o;++s)i[s]=new this.dataElementType;this._parsing&&a(r._parsed),this.parse(e,t),n&&this.updateElements(i,e,t,"reset")}updateElements(e,t,n,r){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,t);n._stacked&&eye(n,r)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,r]=e;this[t](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function iye(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let r=[];for(let t=0,i=n.length;t<i;t++)r=r.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=Xwe(r.sort((e,t)=>e-t))}return e._cache.$bar}(t,e.type);let r,i,o,s,a=t._length;const l=()=>{32767!==o&&-32768!==o&&(wwe(s)&&(a=Math.min(a,Math.abs(o-s)||a)),s=o)};for(r=0,i=n.length;r<i;++r)o=t.getPixelForValue(n[r]),l();for(s=void 0,r=0,i=t.ticks.length;r<i;++r)o=t.getPixelForTick(r),l();return a}function oye(e,t,n,r){return ewe(e)?function(e,t,n,r){const i=n.parse(e[0],r),o=n.parse(e[1],r),s=Math.min(i,o),a=Math.max(i,o);let l=s,c=a;Math.abs(s)>Math.abs(a)&&(l=a,c=s),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:o,min:s,max:a}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function sye(e,t,n,r){const i=e.iScale,o=e.vScale,s=i.getLabels(),a=i===o,l=[];let c,u,d,h;for(c=n,u=n+r;c<u;++c)h=t[c],d={},d[i.axis]=a||i.parse(s[c],c),l.push(oye(h,d,o,c));return l}function aye(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function lye(e,t,n,r){let i=t.borderSkipped;const o={};if(!i)return void(e.borderSkipped=o);if(!0===i)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:a,reverse:l,top:c,bottom:u}=function(e){let t,n,r,i,o;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(i="end",o="start"):(i="start",o="end"),{start:n,end:r,reverse:t,top:i,bottom:o}}(e);"middle"===i&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?i=c:(n._bottom||0)===r?i=u:(o[cye(u,s,a,l)]=!0,i=c)),o[cye(i,s,a,l)]=!0,e.borderSkipped=o}function cye(e,t,n,r){var i,o,s;return r?(s=n,e=uye(e=(i=e)===(o=t)?s:i===s?o:i,n,t)):e=uye(e,t,n),e}function uye(e,t,n){return"start"===e?t:"end"===e?n:e}function dye(e,t,n){let{inflateAmount:r}=t;e.inflateAmount="auto"===r?1===n?.33:0:r}class hye extends rye{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,n,r){return sye(e,t,n,r)}parseArrayData(e,t,n,r){return sye(e,t,n,r)}parseObjectData(e,t,n,r){const{iScale:i,vScale:o}=e,{xAxisKey:s="x",yAxisKey:a="y"}=this._parsing,l="x"===i.axis?s:a,c="x"===o.axis?s:a,u=[];let d,h,p,g;for(d=n,h=n+r;d<h;++d)g=t[d],p={},p[i.axis]=i.parse(mwe(g,l),d),u.push(oye(mwe(g,c),p,o,d));return u}updateRangeFromParsed(e,t,n,r){super.updateRangeFromParsed(e,t,n,r);const i=n._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:r}=t,i=this.getParsed(e),o=i._custom,s=aye(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+n.getLabelForValue(i[n.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,r){const i="reset"===r,{index:o,_cachedMeta:{vScale:s}}=this,a=s.getBasePixel(),l=s.isHorizontal(),c=this._getRuler(),{sharedOptions:u,includeOptions:d}=this._getSharedOptions(t,r);for(let h=t;h<t+n;h++){const t=this.getParsed(h),n=i||Zve(t[s.axis])?{base:a,head:a}:this._calculateBarValuePixels(h),p=this._calculateBarIndexPixels(h,c),g=(t._stacks||{})[s.axis],f={horizontal:l,base:n.base,enableBorderRadius:!g||aye(t._custom)||o===g._top||o===g._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};d&&(f.options=u||this.resolveDataElementOptions(h,e[h].active?"active":r));const m=f.options||e[h].options;lye(f,m,g,o),dye(f,m,c.ratio),this.updateElement(e[h],h,f,r)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter(e=>e.controller.options.grouped),i=n.options.stacked,o=[],s=this._cachedMeta.controller.getParsed(t),a=s&&s[n.axis],l=e=>{const t=e._parsed.find(e=>e[n.axis]===a),r=t&&t[e.vScale.axis];if(Zve(r)||isNaN(r))return!0};for(const c of r)if((void 0===t||!l(c))&&((!1===i||-1===o.indexOf(c.stack)||void 0===i&&void 0===c.stack)&&o.push(c.stack),c.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[iwe("x"===this.chart.options.indexAxis?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const r=this._getStacks(e,n),i=void 0!==t?r.indexOf(t):-1;return-1===i?r.length-1:i}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,r=[];let i,o;for(i=0,o=t.data.length;i<o;++i)r.push(n.getPixelForValue(this.getParsed(i)[n.axis],i));const s=e.barThickness;return{min:s||iye(t),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:r},options:{base:i,minBarLength:o}}=this,s=i||0,a=this.getParsed(e),l=a._custom,c=aye(l);let u,d,h=a[t.axis],p=0,g=n?this.applyStack(t,a,n):h;g!==h&&(p=g-h,g=h),c&&(h=l.barStart,g=l.barEnd-l.barStart,0!==h&&Iwe(h)!==Iwe(l.barEnd)&&(p=0),p+=h);const f=Zve(i)||c?p:i;let m=t.getPixelForValue(f);if(u=this.chart.getDataVisibility(e)?t.getPixelForValue(p+g):m,d=u-m,Math.abs(d)<o){d=function(e,t,n){return 0!==e?Iwe(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(d,t,s)*o,h===s&&(m-=d/2);const e=t.getPixelForDecimal(0),i=t.getPixelForDecimal(1),l=Math.min(e,i),p=Math.max(e,i);m=Math.max(Math.min(m,p),l),u=m+d,n&&!c&&(a._stacks[t.axis]._visualValues[r]=t.getValueForPixel(u)-t.getValueForPixel(m))}if(m===t.getPixelForValue(s)){const e=Iwe(d)*t.getLineWidthForValue(s)/2;m+=e,d-=e}return{size:d,base:m,head:u,center:u+d/2}}_calculateBarIndexPixels(e,t){const n=t.scale,r=this.options,i=r.skipNull,o=iwe(r.maxBarThickness,1/0);let s,a;const l=this._getAxisCount();if(t.grouped){const n=i?this._getStackCount(e):t.stackCount,c="flex"===r.barThickness?function(e,t,n,r){const i=t.pixels,o=i[e];let s=e>0?i[e-1]:null,a=e<i.length-1?i[e+1]:null;const l=n.categoryPercentage;null===s&&(s=o-(null===a?t.end-t.start:a-o)),null===a&&(a=o+o-s);const c=o-(o-Math.min(s,a))/2*l;return{chunk:Math.abs(a-s)/2*l/r,ratio:n.barPercentage,start:c}}(e,t,r,n*l):function(e,t,n,r){const i=n.barThickness;let o,s;return Zve(i)?(o=t.min*n.categoryPercentage,s=n.barPercentage):(o=i*r,s=1),{chunk:o/r,ratio:s,start:t.pixels[e]-o/2}}(e,t,r,n*l),u="x"===this.chart.options.indexAxis?this.getDataset().xAxisID:this.getDataset().yAxisID,d=this._getAxis().indexOf(iwe(u,this.getFirstScaleIdForIndexAxis())),h=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+d;s=c.start+c.chunk*h+c.chunk/2,a=Math.min(o,c.chunk*c.ratio)}else s=n.getPixelForValue(this.getParsed(e)[n.axis],e),a=Math.min(o,t.min*t.ratio);return{base:s-a/2,head:s+a/2,center:s,size:a}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length;let i=0;for(;i<r;++i)null===this.getParsed(i)[t.axis]||n[i].hidden||n[i].draw(this._ctx)}}class pye extends rye{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map((t,i)=>{const o=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:o.backgroundColor,strokeStyle:o.borderColor,fontColor:r,lineWidth:o.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(i),index:i}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{let i,o,s=e=>+n[e];if(twe(n[e])){const{key:e="value"}=this._parsing;s=t=>+mwe(n[t],e)}for(i=e,o=e+t;i<o;++i)r._parsed[i]=s(i)}}_getRotation(){return Nwe(this.options.rotation-90)}_getCircumference(){return Nwe(this.options.circumference)}_getRotationExtents(){let e=Swe,t=-Swe;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),t=Math.max(t,i+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,s=Math.max((Math.min(n.width,n.height)-o)/2,0),a=Math.min((l=this.options.cutout,c=s,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const u=this._getRingWeight(this.index),{circumference:d,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:g,offsetX:f,offsetY:m}=function(e,t,n){let r=1,i=1,o=0,s=0;if(t<Swe){const a=e,l=a+t,c=Math.cos(a),u=Math.sin(a),d=Math.cos(l),h=Math.sin(l),p=(e,t,r)=>zwe(e,a,l,!0)?1:Math.max(t,t*n,r,r*n),g=(e,t,r)=>zwe(e,a,l,!0)?-1:Math.min(t,t*n,r,r*n),f=p(0,c,d),m=p(Twe,u,h),v=g(ywe,c,d),w=g(ywe+Twe,u,h);r=(f-v)/2,i=(m-w)/2,o=-(f+v)/2,s=-(m+w)/2}return{ratioX:r,ratioY:i,offsetX:o,offsetY:s}}(h,d,a),v=(n.width-o)/p,w=(n.height-o)/g,b=Math.max(Math.min(v,w)/2,0),C=owe(this.options.radius,b),y=(C-Math.max(C*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=f*C,this.offsetY=m*C,r.total=this.calculateTotal(),this.outerRadius=C-y*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-y*u,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const n=this.options,r=this._cachedMeta,i=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/Swe)}updateElements(e,t,n,r){const i="reset"===r,o=this.chart,s=o.chartArea,a=o.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,u=i&&a.animateScale,d=u?0:this.innerRadius,h=u?0:this.outerRadius,{sharedOptions:p,includeOptions:g}=this._getSharedOptions(t,r);let f,m=this._getRotation();for(f=0;f<t;++f)m+=this._circumference(f,i);for(f=t;f<t+n;++f){const t=this._circumference(f,i),n=e[f],o={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:h,innerRadius:d};g&&(o.options=p||this.resolveDataElementOptions(f,n.active?"active":r)),m+=t,this.updateElement(n,f,o,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,r=0;for(n=0;n<t.length;n++){const i=e._parsed[n];null===i||isNaN(i)||!this.chart.getDataVisibility(n)||t[n].hidden||(r+=Math.abs(i))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Swe*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],i=pbe(t._parsed[e],n.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const n=this.chart;let r,i,o,s,a;if(!e)for(r=0,i=n.data.datasets.length;r<i;++r)if(n.isDatasetVisible(r)){o=n.getDatasetMeta(r),e=o.data,s=o.controller;break}if(!e)return 0;for(r=0,i=e.length;r<i;++r)a=s.resolveDataElementOptions(r),"inner"!==a.borderAlign&&(t=Math.max(t,a.borderWidth||0,a.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,r=e.length;n<r;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(iwe(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class gye extends rye{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:r=[],_dataset:i}=t,o=this.chart._animationsDisabled;let{start:s,count:a}=tbe(t,r,o);this._drawStart=s,this._drawCount=a,nbe(t)&&(s=0,a=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!i._decimated,n.points=r;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:l},e),this.updateElements(r,s,a,e)}updateElements(e,t,n,r){const i="reset"===r,{iScale:o,vScale:s,_stacked:a,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(t,r),d=o.axis,h=s.axis,{spanGaps:p,segment:g}=this.options,f=Fwe(p)?p:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||i||"none"===r,v=t+n,w=e.length;let b=t>0&&this.getParsed(t-1);for(let C=0;C<w;++C){const n=e[C],p=m?n:{};if(C<t||C>=v){p.skip=!0;continue}const w=this.getParsed(C),y=Zve(w[h]),S=p[d]=o.getPixelForValue(w[d],C),x=p[h]=i||y?s.getBasePixel():s.getPixelForValue(a?this.applyStack(s,w,a):w[h],C);p.skip=isNaN(S)||isNaN(x)||y,p.stop=C>0&&Math.abs(w[d]-b[d])>f,g&&(p.parsed=w,p.raw=l.data[C]),u&&(p.options=c||this.resolveDataElementOptions(C,n.active?"active":r)),m||this.updateElement(n,C,p,r),b=w}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class fye extends pye{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class mye extends rye{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:i}=t,o=this.getParsed(e),s=r.getLabelForValue(o.x),a=i.getLabelForValue(o.y);return{label:n[e]||"",value:"("+s+", "+a+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,r=this.chart._animationsDisabled;let{start:i,count:o}=tbe(t,n,r);if(this._drawStart=i,this._drawCount=o,nbe(t)&&(i=0,o=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:i,_dataset:o}=t;i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=n;const s=this.resolveDatasetElementOptions(e);s.segment=this.options.segment,this.updateElement(i,void 0,{animated:!r,options:s},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,i,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,r){const i="reset"===r,{iScale:o,vScale:s,_stacked:a,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,r),u=this.getSharedOptions(c),d=this.includeOptions(r,u),h=o.axis,p=s.axis,{spanGaps:g,segment:f}=this.options,m=Fwe(g)?g:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||i||"none"===r;let w=t>0&&this.getParsed(t-1);for(let b=t;b<t+n;++b){const t=e[b],n=this.getParsed(b),c=v?t:{},g=Zve(n[p]),C=c[h]=o.getPixelForValue(n[h],b),y=c[p]=i||g?s.getBasePixel():s.getPixelForValue(a?this.applyStack(s,n,a):n[p],b);c.skip=isNaN(C)||isNaN(y)||g,c.stop=b>0&&Math.abs(n[h]-w[h])>m,f&&(c.parsed=n,c.raw=l.data[b]),d&&(c.options=u||this.resolveDataElementOptions(b,t.active?"active":r)),v||this.updateElement(t,b,c,r),w=n}this.updateSharedOptions(u,r,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}const n=e.dataset,r=n.options&&n.options.borderWidth||0;if(!t.length)return r;const i=t[0].size(this.resolveDataElementOptions(0)),o=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,i,o)/2}}function vye(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class wye{static override(e){Object.assign(wye.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return vye()}parse(){return vye()}format(){return vye()}add(){return vye()}diff(){return vye()}startOf(){return vye()}endOf(){return vye()}}var bye=wye;function Cye(e,t,n,r){const{controller:i,data:o,_sorted:s}=e,a=i._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(a&&t===a.axis&&"r"!==t&&s&&o.length){const s=a._reversePixels?Kwe:Uwe;if(!r){const r=s(o,t,n);if(l){const{vScale:t}=i._cachedMeta,{_parsed:n}=e,o=n.slice(0,r.lo+1).reverse().findIndex(e=>!Zve(e[t.axis]));r.lo-=Math.max(0,o);const s=n.slice(r.hi).findIndex(e=>!Zve(e[t.axis]));r.hi+=Math.max(0,s)}return r}if(i._sharedOptions){const e=o[0],r="function"===typeof e.getRange&&e.getRange(t);if(r){const e=s(o,t,n-r),i=s(o,t,n+r);return{lo:e.lo,hi:i.hi}}}}return{lo:0,hi:o.length-1}}function yye(e,t,n,r,i){const o=e.getSortedVisibleDatasetMetas(),s=n[t];for(let a=0,l=o.length;a<l;++a){const{index:e,data:n}=o[a],{lo:l,hi:c}=Cye(o[a],t,s,i);for(let t=l;t<=c;++t){const i=n[t];i.skip||r(i,e,t)}}}function Sye(e,t,n,r,i){const o=[];if(!i&&!e.isPointInArea(t))return o;return yye(e,n,t,function(n,s,a){(i||kbe(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&o.push({element:n,datasetIndex:s,index:a})},!0),o}function xye(e,t,n,r,i,o){let s=[];const a=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){const i=t?Math.abs(e.x-r.x):0,o=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}(n);let l=Number.POSITIVE_INFINITY;return yye(e,n,t,function(n,c,u){const d=n.inRange(t.x,t.y,i);if(r&&!d)return;const h=n.getCenterPoint(i);if(!(!!o||e.isPointInArea(h))&&!d)return;const p=a(t,h);p<l?(s=[{element:n,datasetIndex:c,index:u}],l=p):p===l&&s.push({element:n,datasetIndex:c,index:u})}),s}function Rye(e,t,n,r,i,o){return o||e.isPointInArea(t)?"r"!==n||r?xye(e,t,n,r,i,o):function(e,t,n,r){let i=[];return yye(e,n,t,function(e,n,o){const{startAngle:s,endAngle:a}=e.getProps(["startAngle","endAngle"],r),{angle:l}=Hwe(e,{x:t.x,y:t.y});zwe(l,s,a)&&i.push({element:e,datasetIndex:n,index:o})}),i}(e,t,n,i):[]}function Eye(e,t,n,r,i){const o=[],s="x"===n?"inXRange":"inYRange";let a=!1;return yye(e,n,t,(e,r,l)=>{e[s]&&e[s](t[n],i)&&(o.push({element:e,datasetIndex:r,index:l}),a=a||e.inRange(t.x,t.y,i))}),r&&!a?[]:o}var Tye={evaluateInteractionItems:yye,modes:{index(e,t,n,r){const i=bCe(t,e),o=n.axis||"x",s=n.includeInvisible||!1,a=n.intersect?Sye(e,i,o,r,s):Rye(e,i,o,!1,r,s),l=[];return a.length?(e.getSortedVisibleDatasetMetas().forEach(e=>{const t=a[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})}),l):[]},dataset(e,t,n,r){const i=bCe(t,e),o=n.axis||"xy",s=n.includeInvisible||!1;let a=n.intersect?Sye(e,i,o,r,s):Rye(e,i,o,!1,r,s);if(a.length>0){const t=a[0].datasetIndex,n=e.getDatasetMeta(t).data;a=[];for(let e=0;e<n.length;++e)a.push({element:n[e],datasetIndex:t,index:e})}return a},point:(e,t,n,r)=>Sye(e,bCe(t,e),n.axis||"xy",r,n.includeInvisible||!1),nearest(e,t,n,r){const i=bCe(t,e),o=n.axis||"xy",s=n.includeInvisible||!1;return Rye(e,i,o,n.intersect,r,s)},x:(e,t,n,r)=>Eye(e,bCe(t,e),"x",n.intersect,r),y:(e,t,n,r)=>Eye(e,bCe(t,e),"y",n.intersect,r)}};const kye=["left","top","right","bottom"];function Mye(e,t){return e.filter(e=>e.pos===t)}function Pye(e,t){return e.filter(e=>-1===kye.indexOf(e.pos)&&e.box.axis===t)}function Iye(e,t){return e.sort((e,n)=>{const r=t?n:e,i=t?e:n;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function Aye(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:r,stackWeight:i}=n;if(!e||!kye.includes(r))continue;const o=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return t}(e),{vBoxMaxWidth:r,hBoxMaxHeight:i}=t;let o,s,a;for(o=0,s=e.length;o<s;++o){a=e[o];const{fullSize:s}=a.box,l=n[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*r:s&&t.availableWidth,a.height=i):(a.width=r,a.height=c?c*i:s&&t.availableHeight)}return n}function Dye(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function Fye(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Oye(e,t,n,r){const{pos:i,box:o}=n,s=e.maxPadding;if(!twe(i)){n.size&&(e[i]-=n.size);const t=r[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?o.height:o.width),n.size=t.size/t.count,e[i]+=n.size}o.getPadding&&Fye(s,o.getPadding());const a=Math.max(0,t.outerWidth-Dye(s,e,"left","right")),l=Math.max(0,t.outerHeight-Dye(s,e,"top","bottom")),c=a!==e.w,u=l!==e.h;return e.w=a,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function Nye(e,t){const n=t.maxPadding;function r(e){const r={left:0,top:0,right:0,bottom:0};return e.forEach(e=>{r[e]=Math.max(t[e],n[e])}),r}return r(e?["left","right"]:["top","bottom"])}function Lye(e,t,n,r){const i=[];let o,s,a,l,c,u;for(o=0,s=e.length,c=0;o<s;++o){a=e[o],l=a.box,l.update(a.width||t.w,a.height||t.h,Nye(a.horizontal,t));const{same:s,other:d}=Oye(t,n,a,r);c|=s&&i.length,u=u||d,l.fullSize||i.push(a)}return c&&Lye(i,t,n,r)||u}function _ye(e,t,n,r,i){e.top=n,e.left=t,e.right=t+r,e.bottom=n+i,e.width=r,e.height=i}function Hye(e,t,n,r){const i=n.padding;let{x:o,y:s}=t;for(const a of e){const e=a.box,l=r[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const r=t.w*c,o=l.size||e.height;wwe(l.start)&&(s=l.start),e.fullSize?_ye(e,i.left,s,n.outerWidth-i.right-i.left,o):_ye(e,t.left+l.placed,s,r,o),l.start=s,l.placed+=r,s=e.bottom}else{const r=t.h*c,s=l.size||e.width;wwe(l.start)&&(o=l.start),e.fullSize?_ye(e,o,i.top,s,n.outerHeight-i.bottom-i.top):_ye(e,o,t.top+l.placed,s,r),l.start=o,l.placed+=r,o=e.right}}t.x=o,t.y=s}var Vye={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const i=jbe(e.options.layout.padding),o=Math.max(t-i.width,0),s=Math.max(n-i.height,0),a=function(e){const t=function(e){const t=[];let n,r,i,o,s,a;for(n=0,r=(e||[]).length;n<r;++n)i=e[n],({position:o,options:{stack:s,stackWeight:a=1}}=i),t.push({index:n,box:i,pos:o,horizontal:i.isHorizontal(),weight:i.weight,stack:s&&o+s,stackWeight:a});return t}(e),n=Iye(t.filter(e=>e.box.fullSize),!0),r=Iye(Mye(t,"left"),!0),i=Iye(Mye(t,"right")),o=Iye(Mye(t,"top"),!0),s=Iye(Mye(t,"bottom")),a=Pye(t,"x"),l=Pye(t,"y");return{fullSize:n,leftAndTop:r.concat(o),rightAndBottom:i.concat(l).concat(s).concat(a),chartArea:Mye(t,"chartArea"),vertical:r.concat(i).concat(l),horizontal:o.concat(s).concat(a)}}(e.boxes),l=a.vertical,c=a.horizontal;awe(e.boxes,e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()});const u=l.reduce((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:n,padding:i,availableWidth:o,availableHeight:s,vBoxMaxWidth:o/2/u,hBoxMaxHeight:s/2}),h=Object.assign({},i);Fye(h,jbe(r));const p=Object.assign({maxPadding:h,w:o,h:s,x:i.left,y:i.top},i),g=Aye(l.concat(c),d);Lye(a.fullSize,p,d,g),Lye(l,p,d,g),Lye(c,p,d,g)&&Lye(l,p,d,g),function(e){const t=e.maxPadding;function n(n){const r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(p),Hye(a.leftAndTop,p,d,g),p.x+=p.w,p.y+=p.h,Hye(a.rightAndBottom,p,d,g),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},awe(a.chartArea,t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class Bye{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}isAttached(e){return!0}updateConfig(e){}}class Wye extends Bye{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const zye="$chartjs",jye={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Gye=e=>null===e||""===e;const $ye=!!xCe&&{passive:!0};function Uye(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,$ye)}function Kye(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function Yye(e,t,n){const r=e.canvas,i=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||Kye(n.addedNodes,r),t=t&&!Kye(n.removedNodes,r);t&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}function qye(e,t,n){const r=e.canvas,i=new MutationObserver(e=>{let t=!1;for(const n of e)t=t||Kye(n.removedNodes,r),t=t&&!Kye(n.addedNodes,r);t&&n()});return i.observe(document,{childList:!0,subtree:!0}),i}const Xye=new Map;let Qye=0;function Jye(){const e=window.devicePixelRatio;e!==Qye&&(Qye=e,Xye.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function Zye(e,t,n){const r=e.canvas,i=r&&gCe(r);if(!i)return;const o=Jwe((e,t)=>{const r=i.clientWidth;n(e,t),r<i.clientWidth&&n()},window),s=new ResizeObserver(e=>{const t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||o(n,r)});return s.observe(i),function(e,t){Xye.size||window.addEventListener("resize",Jye),Xye.set(e,t)}(e,o),s}function eSe(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){Xye.delete(e),Xye.size||window.removeEventListener("resize",Jye)}(e)}function tSe(e,t,n){const r=e.canvas,i=Jwe(t=>{null!==e.ctx&&n(function(e,t){const n=jye[e.type]||e.type,{x:r,y:i}=bCe(e,t);return{type:n,chart:t,native:e,x:void 0!==r?r:null,y:void 0!==i?i:null}}(t,e))},e);return function(e,t,n){e&&e.addEventListener(t,n,$ye)}(r,t,i),i}class nSe extends Bye{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,r=e.getAttribute("height"),i=e.getAttribute("width");if(e[zye]={initial:{height:r,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Gye(i)){const t=RCe(e,"width");void 0!==t&&(e.width=t)}if(Gye(r))if(""===e.style.height)e.height=e.width/(t||2);else{const t=RCe(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[zye])return!1;const n=t[zye].initial;["height","width"].forEach(e=>{const r=n[e];Zve(r)?t.removeAttribute(e):t.setAttribute(e,r)});const r=n.style||{};return Object.keys(r).forEach(e=>{t.style[e]=r[e]}),t.width=t.width,delete t[zye],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),i={attach:Yye,detach:qye,resize:Zye}[t]||tSe;r[t]=i(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),r=n[t];if(!r)return;({attach:eSe,detach:eSe,resize:eSe}[t]||Uye)(e,t,r),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,r){return yCe(e,t,n,r)}isAttached(e){const t=e&&gCe(e);return!(!t||!t.isConnected)}}class rSe{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return Fwe(this.x)&&Fwe(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const r={};return e.forEach(e=>{r[e]=n[e]&&n[e].active()?n[e]._to:this[e]}),r}}function iSe(e,t){const n=e.options.ticks,r=function(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),i=e._maxLength/n;return Math.floor(Math.min(r,i))}(e),i=Math.min(n.maxTicksLimit||r,r),o=n.major.enabled?function(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}(t):[],s=o.length,a=o[0],l=o[s-1],c=[];if(s>i)return function(e,t,n,r){let i,o=0,s=n[0];for(r=Math.ceil(r),i=0;i<e.length;i++)i===s&&(t.push(e[i]),o++,s=n[o*r])}(t,c,o,s/i),c;const u=function(e,t,n){const r=function(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}(e),i=t.length/n;if(!r)return Math.max(i,1);const o=function(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(0|n)&&t.push(n),t.sort((e,t)=>e-t).pop(),t}(r);for(let s=0,a=o.length-1;s<a;s++){const e=o[s];if(e>i)return e}return Math.max(i,1)}(o,t,i);if(s>0){let e,n;const r=s>1?Math.round((l-a)/(s-1)):null;for(oSe(t,c,u,Zve(r)?0:a-r,a),e=0,n=s-1;e<n;e++)oSe(t,c,u,o[e],o[e+1]);return oSe(t,c,u,l,Zve(r)?t.length:l+r),c}return oSe(t,c,u),c}function oSe(e,t,n,r,i){const o=iwe(r,0),s=Math.min(iwe(i,e.length),e.length);let a,l,c,u=0;for(n=Math.ceil(n),i&&(a=i-r,n=a/Math.floor(a/n)),c=o;c<0;)u++,c=Math.round(o+u*n);for(l=Math.max(o,0);l<s;l++)l===c&&(t.push(e[l]),u++,c=Math.round(o+u*n))}const sSe=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,aSe=(e,t)=>Math.min(t||e,e);function lSe(e,t){const n=[],r=e.length/t,i=e.length;let o=0;for(;o<i;o+=r)n.push(e[Math.floor(o)]);return n}function cSe(e,t,n){const r=e.ticks.length,i=Math.min(t,r-1),o=e._startPixel,s=e._endPixel,a=1e-6;let l,c=e.getPixelForTick(i);if(!(n&&(l=1===r?Math.max(c-o,s-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(i-1))/2,c+=i<t?l:-l,c<o-a||c>s+a)))return c}function uSe(e){return e.drawTicks?e.tickLength:0}function dSe(e,t){if(!e.display)return 0;const n=Gbe(e.font,t),r=jbe(e.padding);return(ewe(e.text)?e.text.length:1)*n.lineHeight+r.height}function hSe(e,t,n){let r=Zwe(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class pSe extends rSe{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:r}=this;return e=rwe(e,Number.POSITIVE_INFINITY),t=rwe(t,Number.NEGATIVE_INFINITY),n=rwe(n,Number.POSITIVE_INFINITY),r=rwe(r,Number.NEGATIVE_INFINITY),{min:rwe(e,n),max:rwe(t,r),minDefined:nwe(e),maxDefined:nwe(t)}}getMinMax(e){let t,{min:n,max:r,minDefined:i,maxDefined:o}=this.getUserBounds();if(i&&o)return{min:n,max:r};const s=this.getMatchingVisibleMetas();for(let a=0,l=s.length;a<l;++a)t=s[a].controller.getMinMax(this,e),i||(n=Math.min(n,t.min)),o||(r=Math.max(r,t.max));return n=o&&n>r?r:n,r=i&&n>r?n:r,{min:rwe(n,rwe(r,n)),max:rwe(r,rwe(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){swe(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:r,grace:i,ticks:o}=this.options,s=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:r,max:i}=e,o=owe(t,(i-r)/2),s=(e,t)=>n&&0===e?0:e+t;return{min:s(r,-Math.abs(o)),max:s(i,o)}}(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=s<this.ticks.length;this._convertTicksToLabels(a?lSe(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=iSe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){swe(this.options.afterUpdate,[this])}beforeSetDimensions(){swe(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){swe(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),swe(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){swe(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,r,i;for(n=0,r=e.length;n<r;n++)i=e[n],i.label=swe(t.callback,[i.value,n,e],this)}afterTickToLabelConversion(){swe(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){swe(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=aSe(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,i=t.maxRotation;let o,s,a,l=r;if(!this._isVisible()||!t.display||r>=i||n<=1||!this.isHorizontal())return void(this.labelRotation=r);const c=this._getLabelSizes(),u=c.widest.width,d=c.highest.height,h=jwe(this.chart.width-u,0,this.maxWidth);o=e.offset?this.maxWidth/n:h/(n-1),u+6>o&&(o=h/(n-(e.offset?.5:1)),s=this.maxHeight-uSe(e.grid)-t.padding-dSe(e.title,this.chart.options.font),a=Math.sqrt(u*u+d*d),l=Lwe(Math.min(Math.asin(jwe((c.highest.height+6)/o,-1,1)),Math.asin(jwe(s/a,-1,1))-Math.asin(jwe(d/a,-1,1)))),l=Math.max(r,Math.min(i,l))),this.labelRotation=l}afterCalculateLabelRotation(){swe(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){swe(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:r,grid:i}}=this,o=this._isVisible(),s=this.isHorizontal();if(o){const o=dSe(r,t.options.font);if(s?(e.width=this.maxWidth,e.height=uSe(i)+o):(e.height=this.maxHeight,e.width=uSe(i)+o),n.display&&this.ticks.length){const{first:t,last:r,widest:i,highest:o}=this._getLabelSizes(),a=2*n.padding,l=Nwe(this.labelRotation),c=Math.cos(l),u=Math.sin(l);if(s){const t=n.mirror?0:u*i.width+c*o.height;e.height=Math.min(this.maxHeight,e.height+t+a)}else{const t=n.mirror?0:c*i.width+u*o.height;e.width=Math.min(this.maxWidth,e.width+t+a)}this._calculatePadding(t,r,u,c)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,r){const{ticks:{align:i,padding:o},position:s}=this.options,a=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){const s=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let u=0,d=0;a?l?(u=r*e.width,d=n*t.height):(u=n*e.height,d=r*t.width):"start"===i?d=t.width:"end"===i?u=e.width:"inner"!==i&&(u=e.width/2,d=t.width/2),this.paddingLeft=Math.max((u-s+o)*this.width/(this.width-s),0),this.paddingRight=Math.max((d-c+o)*this.width/(this.width-c),0)}else{let n=t.height/2,r=e.height/2;"start"===i?(n=0,r=e.height):"end"===i&&(n=t.height,r=0),this.paddingTop=n+o,this.paddingBottom=r+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){swe(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)Zve(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=lSe(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:r,_longestTextCache:i}=this,o=[],s=[],a=Math.floor(t/aSe(t,n));let l,c,u,d,h,p,g,f,m,v,w,b=0,C=0;for(l=0;l<t;l+=a){if(d=e[l].label,h=this._resolveTickFontOptions(l),r.font=p=h.string,g=i[p]=i[p]||{data:{},gc:[]},f=h.lineHeight,m=v=0,Zve(d)||ewe(d)){if(ewe(d))for(c=0,u=d.length;c<u;++c)w=d[c],Zve(w)||ewe(w)||(m=Sbe(r,g.data,g.gc,m,w),v+=f)}else m=Sbe(r,g.data,g.gc,m,d),v=f;o.push(m),s.push(v),b=Math.max(m,b),C=Math.max(v,C)}!function(e,t){awe(e,e=>{const n=e.gc,r=n.length/2;let i;if(r>t){for(i=0;i<r;++i)delete e.data[n[i]];n.splice(0,r)}})}(i,t);const y=o.indexOf(b),S=s.indexOf(C),x=e=>({width:o[e]||0,height:s[e]||0});return{first:x(0),last:x(t-1),widest:x(y),highest:x(S),widths:o,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return jwe(this._alignToPixels?xbe(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return Ube(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=Ube(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=Nwe(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,s=i?i.widest.width+o:0,a=i?i.highest.height+o:0;return this.isHorizontal()?a*n>s*r?s/n:a/r:a*r<s*n?a/n:s/r}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,r=this.options,{grid:i,position:o,border:s}=r,a=i.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),u=uSe(i),d=[],h=s.setContext(this.getContext()),p=h.display?h.width:0,g=p/2,f=function(e){return xbe(n,e,p)};let m,v,w,b,C,y,S,x,R,E,T,k;if("top"===o)m=f(this.bottom),y=this.bottom-u,x=m-g,E=f(e.top)+g,k=e.bottom;else if("bottom"===o)m=f(this.top),E=e.top,k=f(e.bottom)-g,y=m+g,x=this.top+u;else if("left"===o)m=f(this.right),C=this.right-u,S=m-g,R=f(e.left)+g,T=e.right;else if("right"===o)m=f(this.left),R=e.left,T=f(e.right)-g,C=m+g,S=this.left+u;else if("x"===t){if("center"===o)m=f((e.top+e.bottom)/2+.5);else if(twe(o)){const e=Object.keys(o)[0],t=o[e];m=f(this.chart.scales[e].getPixelForValue(t))}E=e.top,k=e.bottom,y=m+g,x=y+u}else if("y"===t){if("center"===o)m=f((e.left+e.right)/2);else if(twe(o)){const e=Object.keys(o)[0],t=o[e];m=f(this.chart.scales[e].getPixelForValue(t))}C=m-g,S=C-u,R=e.left,T=e.right}const M=iwe(r.ticks.maxTicksLimit,c),P=Math.max(1,Math.ceil(c/M));for(v=0;v<c;v+=P){const e=this.getContext(v),t=i.setContext(e),r=s.setContext(e),o=t.lineWidth,c=t.color,u=r.dash||[],h=r.dashOffset,p=t.tickWidth,g=t.tickColor,f=t.tickBorderDash||[],m=t.tickBorderDashOffset;w=cSe(this,v,a),void 0!==w&&(b=xbe(n,w,o),l?C=S=R=T=b:y=x=E=k=b,d.push({tx1:C,ty1:y,tx2:S,ty2:x,x1:R,y1:E,x2:T,y2:k,width:o,color:c,borderDash:u,borderDashOffset:h,tickWidth:p,tickColor:g,tickBorderDash:f,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=m,d}_computeLabelItems(e){const t=this.axis,n=this.options,{position:r,ticks:i}=n,o=this.isHorizontal(),s=this.ticks,{align:a,crossAlign:l,padding:c,mirror:u}=i,d=uSe(n.grid),h=d+c,p=u?-c:h,g=-Nwe(this.labelRotation),f=[];let m,v,w,b,C,y,S,x,R,E,T,k,M="middle";if("top"===r)y=this.bottom-p,S=this._getXAxisLabelAlignment();else if("bottom"===r)y=this.top+p,S=this._getXAxisLabelAlignment();else if("left"===r){const e=this._getYAxisLabelAlignment(d);S=e.textAlign,C=e.x}else if("right"===r){const e=this._getYAxisLabelAlignment(d);S=e.textAlign,C=e.x}else if("x"===t){if("center"===r)y=(e.top+e.bottom)/2+h;else if(twe(r)){const e=Object.keys(r)[0],t=r[e];y=this.chart.scales[e].getPixelForValue(t)+h}S=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===r)C=(e.left+e.right)/2-h;else if(twe(r)){const e=Object.keys(r)[0],t=r[e];C=this.chart.scales[e].getPixelForValue(t)}S=this._getYAxisLabelAlignment(d).textAlign}"y"===t&&("start"===a?M="top":"end"===a&&(M="bottom"));const P=this._getLabelSizes();for(m=0,v=s.length;m<v;++m){w=s[m],b=w.label;const e=i.setContext(this.getContext(m));x=this.getPixelForTick(m)+i.labelOffset,R=this._resolveTickFontOptions(m),E=R.lineHeight,T=ewe(b)?b.length:1;const t=T/2,n=e.color,a=e.textStrokeColor,c=e.textStrokeWidth;let d,h=S;if(o?(C=x,"inner"===S&&(h=m===v-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),k="top"===r?"near"===l||0!==g?-T*E+E/2:"center"===l?-P.highest.height/2-t*E+E:-P.highest.height+E/2:"near"===l||0!==g?E/2:"center"===l?P.highest.height/2-t*E:P.highest.height-T*E,u&&(k*=-1),0===g||e.showLabelBackdrop||(C+=E/2*Math.sin(g))):(y=x,k=(1-T)*E/2),e.showLabelBackdrop){const t=jbe(e.backdropPadding),n=P.heights[m],r=P.widths[m];let i=k-t.top,o=0-t.left;switch(M){case"middle":i-=n/2;break;case"bottom":i-=n}switch(S){case"center":o-=r/2;break;case"right":o-=r;break;case"inner":m===v-1?o-=r:m>0&&(o-=r/2)}d={left:o,top:i,width:r+t.width,height:n+t.height,color:e.backdropColor}}f.push({label:b,font:R,textOffset:k,options:{rotation:g,color:n,strokeColor:a,strokeWidth:c,textAlign:h,textBaseline:M,translation:[C,y],backdrop:d}})}return f}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Nwe(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:r,padding:i}}=this.options,o=e+i,s=this._getLabelSizes().widest.width;let a,l;return"left"===t?r?(l=this.right+i,"near"===n?a="left":"center"===n?(a="center",l+=s/2):(a="right",l+=s)):(l=this.right-o,"near"===n?a="right":"center"===n?(a="center",l-=s/2):(a="left",l=this.left)):"right"===t?r?(l=this.left+i,"near"===n?a="right":"center"===n?(a="center",l-=s/2):(a="left",l-=s)):(l=this.left+o,"near"===n?a="left":"center"===n?(a="center",l+=s/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:r,width:i,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,i,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex(t=>t.value===e);if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const s=(e,t,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(i=0,o=r.length;i<o;++i){const e=r[i];t.drawOnChartArea&&s({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&s({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:r}}=this,i=n.setContext(this.getContext()),o=n.display?i.width:0;if(!o)return;const s=r.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,u,d;this.isHorizontal()?(l=xbe(e,this.left,o)-o/2,c=xbe(e,this.right,s)+s/2,u=d=a):(u=xbe(e,this.top,o)-o/2,d=xbe(e,this.bottom,s)+s/2,l=c=a),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(l,u),t.lineTo(c,d),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&Mbe(t,n);const r=this.getLabelItems(e);for(const i of r){const e=i.options,n=i.font;Obe(t,i.label,0,i.textOffset,n,e)}n&&Pbe(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:r}}=this;if(!n.display)return;const i=Gbe(n.font),o=jbe(n.padding),s=n.align;let a=i.lineHeight/2;"bottom"===t||"center"===t||twe(t)?(a+=o.bottom,ewe(n.text)&&(a+=i.lineHeight*(n.text.length-1))):a+=o.top;const{titleX:l,titleY:c,maxWidth:u,rotation:d}=function(e,t,n,r){const{top:i,left:o,bottom:s,right:a,chart:l}=e,{chartArea:c,scales:u}=l;let d,h,p,g=0;const f=s-i,m=a-o;if(e.isHorizontal()){if(h=ebe(r,o,a),twe(n)){const e=Object.keys(n)[0],r=n[e];p=u[e].getPixelForValue(r)+f-t}else p="center"===n?(c.bottom+c.top)/2+f-t:sSe(e,n,t);d=a-o}else{if(twe(n)){const e=Object.keys(n)[0],r=n[e];h=u[e].getPixelForValue(r)-m+t}else h="center"===n?(c.left+c.right)/2-m+t:sSe(e,n,t);p=ebe(r,s,i),g="left"===n?-Twe:Twe}return{titleX:h,titleY:p,maxWidth:d,rotation:g}}(this,a,t,s);Obe(e,n.text,0,0,i,{color:n.color,maxWidth:u,rotation:d,textAlign:hSe(s,t,r),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=iwe(e.grid&&e.grid.z,-1),r=iwe(e.border&&e.border.z,0);return this._isVisible()&&this.draw===pSe.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let i,o;for(i=0,o=t.length;i<o;++i){const o=t[i];o[n]!==this.id||e&&o.type!==e||r.push(o)}return r}_resolveTickFontOptions(e){return Gbe(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class gSe{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,function(e,t,n){const r=hwe(Object.create(null),[n?ybe.get(n):{},ybe.get(t),e.defaults]);ybe.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach(n=>{const r=n.split("."),i=r.pop(),o=[e].concat(r).join("."),s=t[n].split("."),a=s.pop(),l=s.join(".");ybe.route(o,i,l,a)})}(t,e.defaultRoutes);e.descriptors&&ybe.describe(t,e.descriptors)}(e,o,n),this.override&&ybe.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in ybe[r]&&(delete ybe[r][n],this.override&&delete mbe[n])}}class fSe{constructor(){this.controllers=new gSe(rye,"datasets",!0),this.elements=new gSe(rSe,"elements"),this.plugins=new gSe(Object,"plugins"),this.scales=new gSe(pSe,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach(t=>{const r=n||this._getRegistryForType(t);n||r.isForType(t)||r===this.plugins&&t.id?this._exec(e,r,t):awe(t,t=>{const r=n||this._getRegistryForType(t);this._exec(e,r,t)})})}_exec(e,t,n){const r=vwe(e);swe(n["before"+r],[],n),t[e](n),swe(n["after"+r],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var mSe=new fSe;class vSe{constructor(){this._init=[]}notify(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,t,n);return"afterDestroy"===t&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,n,r){r=r||{};for(const i of e){const e=i.plugin;if(!1===swe(e[n],[t,r,i.options],e)&&r.cancelable)return!1}return!0}invalidate(){Zve(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,r=iwe(n.options&&n.options.plugins,{}),i=function(e){const t={},n=[],r=Object.keys(mSe.plugins.items);for(let o=0;o<r.length;o++)n.push(mSe.getPlugin(r[o]));const i=e.plugins||[];for(let o=0;o<i.length;o++){const e=i[o];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){let{plugins:i,localIds:o}=t;const s=[],a=e.getContext();for(const l of i){const t=l.id,i=wSe(n[t],r);null!==i&&s.push({plugin:l,options:bSe(e.config,{plugin:l,local:o[t]},i,a)})}return s}(e,i,r,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,r=(e,t)=>e.filter(e=>!t.some(t=>e.plugin.id===t.plugin.id));this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}function wSe(e,t){return t||!1!==e?!0===e?{}:e:null}function bSe(e,t,n,r){let{plugin:i,local:o}=t;const s=e.pluginScopeKeys(i),a=e.getOptionScopes(n,s);return o&&i.defaults&&a.push(i.defaults),e.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function CSe(e,t){const n=ybe.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function ySe(e){if("x"===e||"y"===e||"r"===e)return e}function SSe(e){return"top"===e||"bottom"===e?"x":"left"===e||"right"===e?"y":void 0}function xSe(e){if(ySe(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n){const t=i.axis||SSe(i.position)||e.length>1&&ySe(e[0].toLowerCase());if(t)return t}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function RSe(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function ESe(e,t){const n=mbe[e.type]||{scales:{}},r=t.scales||{},i=CSe(e.type,t),o=Object.create(null);return Object.keys(r).forEach(t=>{const s=r[t];if(!twe(s))return console.error(`Invalid scale configuration for scale: ${t}`);if(s._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const a=xSe(t,s,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter(t=>t.xAxisID===e||t.yAxisID===e);if(n.length)return RSe(e,"x",n[0])||RSe(e,"y",n[0])}return{}}(t,e),ybe.scales[s.type]),l=function(e,t){return e===t?"_index_":"_value_"}(a,i),c=n.scales||{};o[t]=pwe(Object.create(null),[{axis:a},s,c[a],c[l]])}),e.data.datasets.forEach(n=>{const i=n.type||e.type,s=n.indexAxis||CSe(i,t),a=(mbe[i]||{}).scales||{};Object.keys(a).forEach(e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,s),i=n[t+"AxisID"]||t;o[i]=o[i]||Object.create(null),pwe(o[i],[{axis:t},r[i],a[e]])})}),Object.keys(o).forEach(e=>{const t=o[e];pwe(t,[ybe.scales[t.type],ybe.scale])}),o}function TSe(e){const t=e.options||(e.options={});t.plugins=iwe(t.plugins,{}),t.scales=ESe(e,t)}function kSe(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const MSe=new Map,PSe=new Set;function ISe(e,t){let n=MSe.get(e);return n||(n=t(),MSe.set(e,n),PSe.add(n)),n}const ASe=(e,t,n)=>{const r=mwe(t,n);void 0!==r&&e.add(r)};class DSe{constructor(e){this._config=function(e){return(e=e||{}).data=kSe(e.data),TSe(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=kSe(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),TSe(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ISe(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return ISe(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return ISe(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id;return ISe(`${this.type}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}getOptionScopes(e,t,n){const{options:r,type:i}=this,o=this._cachedScopes(e,n),s=o.get(t);if(s)return s;const a=new Set;t.forEach(t=>{e&&(a.add(e),t.forEach(t=>ASe(a,e,t))),t.forEach(e=>ASe(a,r,e)),t.forEach(e=>ASe(a,mbe[i]||{},e)),t.forEach(e=>ASe(a,ybe,e)),t.forEach(e=>ASe(a,vbe,e))});const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),PSe.has(t)&&o.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,mbe[t]||{},ybe.datasets[t]||{},{type:t},ybe,vbe]}resolveNamedOptions(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const i={$shared:!0},{resolver:o,subPrefixes:s}=FSe(this._resolverCache,e,r);let a=o;if(function(e,t){const{isScriptable:n,isIndexable:r}=qbe(e);for(const i of t){const t=n(i),o=r(i),s=(o||t)&&e[i];if(t&&(bwe(s)||OSe(s))||o&&ewe(s))return!0}return!1}(o,t)){i.$shared=!1;a=Ybe(o,n=bwe(n)?n():n,this.createResolver(e,n,s))}for(const l of t)i[l]=a[l];return i}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0;const{resolver:i}=FSe(this._resolverCache,e,n);return twe(t)?Ybe(i,t,void 0,r):i}}function FSe(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const i=n.join();let o=r.get(i);if(!o){o={resolver:Kbe(t,n),subPrefixes:n.filter(e=>!e.toLowerCase().includes("hover"))},r.set(i,o)}return o}const OSe=e=>twe(e)&&Object.getOwnPropertyNames(e).some(t=>bwe(e[t]));const NSe=["top","bottom","left","right","chartArea"];function LSe(e,t){return"top"===e||"bottom"===e||-1===NSe.indexOf(e)&&"x"===t}function _Se(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function HSe(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),swe(n&&n.onComplete,[e],t)}function VSe(e){const t=e.chart,n=t.options.animation;swe(n&&n.onProgress,[e],t)}function BSe(e){return pCe()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const WSe={},zSe=e=>{const t=BSe(e);return Object.values(WSe).filter(e=>e.canvas===t).pop()};function jSe(e,t,n){const r=Object.keys(e);for(const i of r){const r=+i;if(r>=t){const o=e[i];delete e[i],(n>0||r>t)&&(e[r+n]=o)}}}class GSe{static defaults=(()=>ybe)();static instances=(()=>WSe)();static overrides=(()=>mbe)();static registry=(()=>mSe)();static version="4.5.0";static getChart=(()=>zSe)();static register(){mSe.add(...arguments),$Se()}static unregister(){mSe.remove(...arguments),$Se()}constructor(e,t){const n=this.config=new DSe(t),r=BSe(e),i=zSe(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!pCe()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Wye:nSe}(r)),this.platform.updateConfig(n);const s=this.platform.acquireContext(r,o.aspectRatio),a=s&&s.canvas,l=a&&a.height,c=a&&a.width;this.id=Jve(),this.ctx=s,this.canvas=a,this.width=c,this.height=l,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new vSe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}(e=>this.update(e),o.resizeDelay||0),this._dataChanges=[],WSe[this.id]=this,s&&a?(WCe.listen(this,"complete",HSe),WCe.listen(this,"progress",VSe),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:r,_aspectRatio:i}=this;return Zve(e)?t&&i?i:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return mSe}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():SCe(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Rbe(this.canvas,this.ctx),this}stop(){return WCe.stop(this),this}resize(e,t){WCe.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,r=this.canvas,i=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,i),s=n.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,SCe(this,s,!0)&&(this.notifyPlugins("resize",{size:o}),swe(n.onResize,[this,o],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){awe(this.options.scales||{},(e,t)=>{e.id=t})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,r=Object.keys(n).reduce((e,t)=>(e[t]=!1,e),{});let i=[];t&&(i=i.concat(Object.keys(t).map(e=>{const n=t[e],r=xSe(e,n),i="r"===r,o="x"===r;return{options:n,dposition:i?"chartArea":o?"bottom":"left",dtype:i?"radialLinear":o?"category":"linear"}}))),awe(i,t=>{const i=t.options,o=i.id,s=xSe(o,i),a=iwe(i.type,t.dtype);void 0!==i.position&&LSe(i.position,s)===LSe(t.dposition)||(i.position=t.dposition),r[o]=!0;let l=null;if(o in n&&n[o].type===a)l=n[o];else{l=new(mSe.getScale(a))({id:o,type:a,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(i,e)}),awe(r,(e,t)=>{e||delete n[t]}),awe(n,e=>{Vye.configure(this,e,e.options),Vye.addBox(this,e)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((e,t)=>e.index-t.index),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(_Se("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((e,n)=>{0===t.filter(t=>t===e._dataset).length&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=t.length;n<r;n++){const r=t[n];let i=this.getDatasetMeta(n);const o=r.type||this.config.type;if(i.type&&i.type!==o&&(this._destroyDatasetMeta(n),i=this.getDatasetMeta(n)),i.type=o,i.indexAxis=r.indexAxis||CSe(o,this.options),i.order=r.order||0,i.index=n,i.label=""+r.label,i.visible=this.isDatasetVisible(n),i.controller)i.controller.updateIndex(n),i.controller.linkScales();else{const t=mSe.getController(o),{datasetElementType:r,dataElementType:s}=ybe.datasets[o];Object.assign(t,{dataElementType:mSe.getElement(s),datasetElementType:r&&mSe.getElement(r)}),i.controller=new t(this,n),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){awe(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!r&&-1===i.indexOf(e);e.buildOrUpdateElements(t),o=Math.max(+e.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||awe(i,e=>{e.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(_Se("z","_idx"));const{_active:s,_lastEvent:a}=this;a?this._eventHandler(a,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){awe(this.scales,e=>{Vye.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Cwe(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:i}of t){jSe(e,r,"_removeElements"===n?-i:i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter(e=>e[0]===t).map((e,t)=>t+","+e.splice(1).join(","))),r=n(0);for(let i=1;i<t;i++)if(!Cwe(r,n(i)))return;return Array.from(r).map(e=>e.split(",")).map(e=>({method:e[1],start:+e[2],count:+e[3]}))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Vye.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],awe(this.boxes,e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))},this),this._layers.forEach((e,t)=>{e._idx=t}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,bwe(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(WCe.has(this)?this.attached&&!WCe.running(this)&&WCe.start(this):(this.draw(),HSe({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let r,i;for(r=0,i=t.length;r<i;++r){const i=t[r];e&&!i.visible||n.push(i)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},r=VCe(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(r&&Mbe(t,r),e.controller.draw(),r&&Pbe(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return kbe(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,r){const i=Tye.modes[t];return"function"===typeof i?i(this,e,n,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let r=n.filter(e=>e&&e._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=Ube(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const r=n?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);wwe(t)?(i.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(i,{visible:n}),this.update(t=>t.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),WCe.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Rbe(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete WSe[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};awe(this.options.events,e=>n(e,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(n,r)=>{e[n]&&(t.removeEventListener(this,n,r),delete e[n])},i=(e,t)=>{this.canvas&&this.resize(e,t)};let o;const s=()=>{r("attach",s),this.attached=!0,this.resize(),n("resize",i),n("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),n("attach",s)},t.isAttached(this.canvas)?s():o()}unbindEvents(){awe(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},awe(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const r=n?"set":"remove";let i,o,s,a;for("dataset"===t&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),s=0,a=e.length;s<a;++s){o=e[s];const t=o&&this.getDatasetMeta(o.datasetIndex).controller;t&&t[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(e=>{let{datasetIndex:t,index:n}=e;const r=this.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[n],index:n}});!lwe(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter(t=>t.plugin.id===e).length}_updateHoverStyles(e,t,n){const r=this.options.hover,i=(e,t)=>e.filter(e=>!t.some(t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)),o=i(t,e),s=n?e:i(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),s.length&&r.mode&&this.updateHoverStyle(s,r.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,r))return;const i=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(i||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:r=[],options:i}=this,o=t,s=this._getActiveElements(e,r,n,o),a=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,a);n&&(this._lastEvent=null,swe(i.onHover,[e,s,this],this),a&&swe(i.onClick,[e,s,this],this));const c=!lwe(s,r);return(c||t)&&(this._active=s,this._updateHoverStyles(s,r,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}function $Se(){return awe(GSe.instances,e=>e._plugins.invalidate())}function USe(e,t,n,r){const i=Bbe(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(n-t)/2,s=Math.min(o,r*t/2),a=e=>{const t=(n-Math.min(o,e))*r/2;return jwe(e,0,Math.min(o,t))};return{outerStart:a(i.outerStart),outerEnd:a(i.outerEnd),innerStart:jwe(i.innerStart,0,s),innerEnd:jwe(i.innerEnd,0,s)}}function KSe(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function YSe(e,t,n,r,i,o){const{x:s,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=t,d=Math.max(t.outerRadius+r+n-c,0),h=u>0?u+r+n+c:0;let p=0;const g=i-l;if(r){const e=((u>0?u-r:0)+(d>0?d-r:0))/2;p=(g-(0!==e?g*e/(e+r):g))/2}const f=(g-Math.max(.001,g*d-n/ywe)/d)/2,m=l+f+p,v=i-f-p,{outerStart:w,outerEnd:b,innerStart:C,innerEnd:y}=USe(t,h,d,v-m),S=d-w,x=d-b,R=m+w/S,E=v-b/x,T=h+C,k=h+y,M=m+C/T,P=v-y/k;if(e.beginPath(),o){const t=(R+E)/2;if(e.arc(s,a,d,R,t),e.arc(s,a,d,t,E),b>0){const t=KSe(x,E,s,a);e.arc(t.x,t.y,b,E,v+Twe)}const n=KSe(k,v,s,a);if(e.lineTo(n.x,n.y),y>0){const t=KSe(k,P,s,a);e.arc(t.x,t.y,y,v+Twe,P+Math.PI)}const r=(v-y/h+(m+C/h))/2;if(e.arc(s,a,h,v-y/h,r,!0),e.arc(s,a,h,r,m+C/h,!0),C>0){const t=KSe(T,M,s,a);e.arc(t.x,t.y,C,M+Math.PI,m-Twe)}const i=KSe(S,m,s,a);if(e.lineTo(i.x,i.y),w>0){const t=KSe(S,R,s,a);e.arc(t.x,t.y,w,m-Twe,R)}}else{e.moveTo(s,a);const t=Math.cos(R)*d+s,n=Math.sin(R)*d+a;e.lineTo(t,n);const r=Math.cos(E)*d+s,i=Math.sin(E)*d+a;e.lineTo(r,i)}e.closePath()}function qSe(e,t,n,r,i){const{fullCircles:o,startAngle:s,circumference:a,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:d,borderDashOffset:h,borderRadius:p}=l,g="inner"===l.borderAlign;if(!c)return;e.setLineDash(d||[]),e.lineDashOffset=h,g?(e.lineWidth=2*c,e.lineJoin=u||"round"):(e.lineWidth=c,e.lineJoin=u||"bevel");let f=t.endAngle;if(o){YSe(e,t,n,r,f,i);for(let t=0;t<o;++t)e.stroke();isNaN(a)||(f=s+(a%Swe||Swe))}g&&function(e,t,n){const{startAngle:r,pixelMargin:i,x:o,y:s,outerRadius:a,innerRadius:l}=t;let c=i/a;e.beginPath(),e.arc(o,s,a,r-c,n+c),l>i?(c=i/l,e.arc(o,s,l,n+c,r-c,!0)):e.arc(o,s,i,n+Twe,r-Twe),e.closePath(),e.clip()}(e,t,f),l.selfJoin&&f-s>=ywe&&0===p&&"miter"!==u&&function(e,t,n){const{startAngle:r,x:i,y:o,outerRadius:s,innerRadius:a,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,d=Math.min(c/s,Wwe(r-n));if(e.beginPath(),e.arc(i,o,s-c/2,r+d/2,n-d/2),a>0){const t=Math.min(c/a,Wwe(r-n));e.arc(i,o,a+c/2,n-t/2,r+t/2,!0)}else{const t=Math.min(c/2,s*Wwe(r-n));if("round"===u)e.arc(i,o,t,n-ywe/2,r+ywe/2,!0);else if("bevel"===u){const s=2*t*t,a=-s*Math.cos(n+ywe/2)+i,l=-s*Math.sin(n+ywe/2)+o,c=s*Math.cos(r+ywe/2)+i,u=s*Math.sin(r+ywe/2)+o;e.lineTo(a,l),e.lineTo(c,u)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}(e,t,f),o||(YSe(e,t,n,r,f,i),e.stroke())}class XSe extends rSe{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.getProps(["x","y"],n),{angle:i,distance:o}=Hwe(r,{x:e,y:t}),{startAngle:s,endAngle:a,innerRadius:l,outerRadius:c,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),d=(this.options.spacing+this.options.borderWidth)/2,h=iwe(u,a-s),p=zwe(i,s,a)&&s!==a,g=h>=Swe||p,f=Gwe(o,l+d,c+d);return g&&f}getCenterPoint(e){const{x:t,y:n,startAngle:r,endAngle:i,innerRadius:o,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:a,spacing:l}=this.options,c=(r+i)/2,u=(o+s+l+a)/2;return{x:t+Math.cos(c)*u,y:n+Math.sin(c)*u}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,r=(t.offset||0)/4,i=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>Swe?Math.floor(n/Swe):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const s=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(s)*r,Math.sin(s)*r);const a=r*(1-Math.sin(Math.min(ywe,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,i){const{fullCircles:o,startAngle:s,circumference:a}=t;let l=t.endAngle;if(o){YSe(e,t,n,r,l,i);for(let t=0;t<o;++t)e.fill();isNaN(a)||(l=s+(a%Swe||Swe))}YSe(e,t,n,r,l,i),e.fill()}(e,this,a,i,o),qSe(e,this,a,i,o),e.restore()}}function QSe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=iwe(n.borderCapStyle,t.borderCapStyle),e.setLineDash(iwe(n.borderDash,t.borderDash)),e.lineDashOffset=iwe(n.borderDashOffset,t.borderDashOffset),e.lineJoin=iwe(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=iwe(n.borderWidth,t.borderWidth),e.strokeStyle=iwe(n.borderColor,t.borderColor)}function JSe(e,t,n){e.lineTo(n.x,n.y)}function ZSe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.length,{start:i=0,end:o=r-1}=n,{start:s,end:a}=t,l=Math.max(i,s),c=Math.min(o,a),u=i<s&&o<s||i>a&&o>a;return{count:r,start:l,loop:t.loop,ilen:c<l&&!u?r+c-l:c-l}}function exe(e,t,n,r){const{points:i,options:o}=t,{count:s,start:a,loop:l,ilen:c}=ZSe(i,n,r),u=function(e){return e.stepped?Ibe:e.tension||"monotone"===e.cubicInterpolationMode?Abe:JSe}(o);let d,h,p,{move:g=!0,reverse:f}=r||{};for(d=0;d<=c;++d)h=i[(a+(f?c-d:d))%s],h.skip||(g?(e.moveTo(h.x,h.y),g=!1):u(e,p,h,f,o.stepped),p=h);return l&&(h=i[(a+(f?c:0))%s],u(e,p,h,f,o.stepped)),!!l}function txe(e,t,n,r){const i=t.points,{count:o,start:s,ilen:a}=ZSe(i,n,r),{move:l=!0,reverse:c}=r||{};let u,d,h,p,g,f,m=0,v=0;const w=e=>(s+(c?a-e:e))%o,b=()=>{p!==g&&(e.lineTo(m,g),e.lineTo(m,p),e.lineTo(m,f))};for(l&&(d=i[w(0)],e.moveTo(d.x,d.y)),u=0;u<=a;++u){if(d=i[w(u)],d.skip)continue;const t=d.x,n=d.y,r=0|t;r===h?(n<p?p=n:n>g&&(g=n),m=(v*m+t)/++v):(b(),e.lineTo(t,n),h=r,v=0,p=g=n),f=n}b()}function nxe(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?txe:exe}const rxe="function"===typeof Path2D;function ixe(e,t,n,r){rxe&&!t.options.segment?function(e,t,n,r){let i=t._path;i||(i=t._path=new Path2D,t.path(i,n,r)&&i.closePath()),QSe(e,t.options),e.stroke(i)}(e,t,n,r):function(e,t,n,r){const{segments:i,options:o}=t,s=nxe(t);for(const a of i)QSe(e,o,a.style),e.beginPath(),s(e,t,a,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}(e,t,n,r)}class oxe extends rSe{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;hCe(this._points,n,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,r=e.options.spanGaps,i=n.length;if(!i)return[];const o=!!e._loop,{start:s,end:a}=function(e,t,n,r){let i=0,o=t-1;if(n&&!r)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,n&&(o+=i);o>i&&e[o%t].skip;)o--;return o%=t,{start:i,end:o}}(n,i,o,r);return NCe(e,!0===r?[{start:s,end:a,loop:o}]:function(e,t,n,r){const i=e.length,o=[];let s,a=t,l=e[t];for(s=t+1;s<=n;++s){const n=e[s%i];n.skip||n.stop?l.skip||(r=!1,o.push({start:t%i,end:(s-1)%i,loop:r}),t=a=n.stop?s:null):(a=s,l.skip&&(t=s)),l=n}return null!==a&&o.push({start:t%i,end:a%i,loop:r}),o}(n,s,a<s?a+i:a,!!e._fullLoop&&0===s&&a===i-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,r=e[t],i=this.points,o=OCe(this,{property:t,start:r,end:r});if(!o.length)return;const s=[],a=function(e){return e.stepped?TCe:e.tension||"monotone"===e.cubicInterpolationMode?kCe:ECe}(n);let l,c;for(l=0,c=o.length;l<c;++l){const{start:c,end:u}=o[l],d=i[c],h=i[u];if(d===h){s.push(d);continue}const p=a(d,h,Math.abs((r-d[t])/(h[t]-d[t])),n.stepped);p[t]=e[t],s.push(p)}return 1===s.length?s[0]:s}pathSegment(e,t,n){return nxe(this)(e,this,t,n)}path(e,t,n){const r=this.segments,i=nxe(this);let o=this._loop;t=t||0,n=n||this.points.length-t;for(const s of r)o&=i(e,this,s,{start:t,end:t+n-1});return!!o}draw(e,t,n,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),ixe(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function sxe(e,t,n,r){const i=e.options,{[n]:o}=e.getProps([n],r);return Math.abs(t-o)<i.radius+i.hitRadius}class axe extends rSe{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.options,{x:i,y:o}=this.getProps(["x","y"],n);return Math.pow(e-i,2)+Math.pow(t-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return sxe(this,e,"x",t)}inYRange(e,t){return sxe(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!kbe(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Ebe(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function lxe(e,t){const{x:n,y:r,base:i,width:o,height:s}=e.getProps(["x","y","base","width","height"],t);let a,l,c,u,d;return e.horizontal?(d=s/2,a=Math.min(n,i),l=Math.max(n,i),c=r-d,u=r+d):(d=o/2,a=n-d,l=n+d,c=Math.min(r,i),u=Math.max(r,i)),{left:a,top:c,right:l,bottom:u}}function cxe(e,t,n,r){return e?0:jwe(t,n,r)}function uxe(e){const t=lxe(e),n=t.right-t.left,r=t.bottom-t.top,i=function(e,t,n){const r=e.options.borderWidth,i=e.borderSkipped,o=Wbe(r);return{t:cxe(i.top,o.top,0,n),r:cxe(i.right,o.right,0,t),b:cxe(i.bottom,o.bottom,0,n),l:cxe(i.left,o.left,0,t)}}(e,n/2,r/2),o=function(e,t,n){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,o=zbe(i),s=Math.min(t,n),a=e.borderSkipped,l=r||twe(i);return{topLeft:cxe(!l||a.top||a.left,o.topLeft,0,s),topRight:cxe(!l||a.top||a.right,o.topRight,0,s),bottomLeft:cxe(!l||a.bottom||a.left,o.bottomLeft,0,s),bottomRight:cxe(!l||a.bottom||a.right,o.bottomRight,0,s)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:o},inner:{x:t.left+i.l,y:t.top+i.t,w:n-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,o.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(i.b,i.r))}}}}function dxe(e,t,n,r){const i=null===t,o=null===n,s=e&&!(i&&o)&&lxe(e,r);return s&&(i||Gwe(t,s.left,s.right))&&(o||Gwe(n,s.top,s.bottom))}function hxe(e,t){e.rect(t.x,t.y,t.w,t.h)}function pxe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.x!==n.x?-t:0,i=e.y!==n.y?-t:0,o=(e.x+e.w!==n.x+n.w?t:0)-r,s=(e.y+e.h!==n.y+n.h?t:0)-i;return{x:e.x+r,y:e.y+i,w:e.w+o,h:e.h+s,radius:e.radius}}class gxe extends rSe{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:r}}=this,{inner:i,outer:o}=uxe(this),s=(a=o.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?Nbe:hxe;var a;e.save(),o.w===i.w&&o.h===i.h||(e.beginPath(),s(e,pxe(o,t,i)),e.clip(),s(e,pxe(i,-t,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),s(e,pxe(i,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return dxe(this,e,t,n)}inXRange(e,t){return dxe(this,e,null,t)}inYRange(e,t){return dxe(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(t+r)/2:t,y:i?n:(n+r)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}function fxe(e,t,n,r){if(r)return;let i=t[e],o=n[e];return"angle"===e&&(i=Wwe(i),o=Wwe(o)),{property:e,start:i,end:o}}function mxe(e,t,n){for(;t>e;t--){const e=n[t];if(!isNaN(e.x)&&!isNaN(e.y))break}return t}function vxe(e,t,n,r){return e&&t?r(e[n],t[n]):e?e[n]:t?t[n]:0}function wxe(e,t){let n=[],r=!1;return ewe(e)?(r=!0,n=e):n=function(e,t){const{x:n=null,y:r=null}=e||{},i=t.points,o=[];return t.segments.forEach(e=>{let{start:t,end:s}=e;s=mxe(t,s,i);const a=i[t],l=i[s];null!==r?(o.push({x:a.x,y:r}),o.push({x:l.x,y:r})):null!==n&&(o.push({x:n,y:a.y}),o.push({x:n,y:l.y}))}),o}(e,t),n.length?new oxe({points:n,options:{tension:0},_loop:r,_fullLoop:r}):null}function bxe(e){return e&&!1!==e.fill}function Cxe(e,t,n){let r=e[t].fill;const i=[t];let o;if(!n)return r;for(;!1!==r&&-1===i.indexOf(r);){if(!nwe(r))return r;if(o=e[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function yxe(e,t,n){const r=function(e){const t=e.options,n=t.fill;let r=iwe(n&&n.target,n);void 0===r&&(r=!!t.backgroundColor);if(!1===r||null===r)return!1;if(!0===r)return"origin";return r}(e);if(twe(r))return!isNaN(r.value)&&r;let i=parseFloat(r);return nwe(i)&&Math.floor(i)===i?function(e,t,n,r){"-"!==e&&"+"!==e||(n=t+n);if(n===t||n<0||n>=r)return!1;return n}(r[0],t,i,n):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Sxe(e,t,n){const r=[];for(let i=0;i<n.length;i++){const o=n[i],{first:s,last:a,point:l}=xxe(o,t,"x");if(!(!l||s&&a))if(s)r.unshift(l);else if(e.push(l),!a)break}e.push(...r)}function xxe(e,t,n){const r=e.interpolate(t,n);if(!r)return{};const i=r[n],o=e.segments,s=e.points;let a=!1,l=!1;for(let c=0;c<o.length;c++){const e=o[c],t=s[e.start][n],r=s[e.end][n];if(Gwe(i,t,r)){a=i===t,l=i===r;break}}return{first:a,last:l,point:r}}class Rxe{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,n){const{x:r,y:i,radius:o}=this;return t=t||{start:0,end:Swe},e.arc(r,i,o,t.end,t.start,!0),!n.bounds}interpolate(e){const{x:t,y:n,radius:r}=this,i=e.angle;return{x:t+Math.cos(i)*r,y:n+Math.sin(i)*r,angle:i}}}function Exe(e){const{chart:t,fill:n,line:r}=e;if(nwe(n))return function(e,t){const n=e.getDatasetMeta(t),r=n&&e.isDatasetVisible(t);return r?n.dataset:null}(t,n);if("stack"===n)return function(e){const{scale:t,index:n,line:r}=e,i=[],o=r.segments,s=r.points,a=function(e,t){const n=[],r=e.getMatchingVisibleMetas("line");for(let i=0;i<r.length;i++){const e=r[i];if(e.index===t)break;e.hidden||n.unshift(e.dataset)}return n}(t,n);a.push(wxe({x:null,y:t.bottom},r));for(let l=0;l<o.length;l++){const e=o[l];for(let t=e.start;t<=e.end;t++)Sxe(i,s[t],a)}return new oxe({points:i,options:{}})}(e);if("shape"===n)return!0;const i=function(e){const t=e.scale||{};if(t.getPointPositionForValue)return function(e){const{scale:t,fill:n}=e,r=t.options,i=t.getLabels().length,o=r.reverse?t.max:t.min,s=function(e,t,n){let r;return r="start"===e?n:"end"===e?t.options.reverse?t.min:t.max:twe(e)?e.value:t.getBaseValue(),r}(n,t,o),a=[];if(r.grid.circular){const e=t.getPointPositionForValue(0,o);return new Rxe({x:e.x,y:e.y,radius:t.getDistanceFromCenterForValue(s)})}for(let l=0;l<i;++l)a.push(t.getPointPositionForValue(l,s));return a}(e);return function(e){const{scale:t={},fill:n}=e,r=function(e,t){let n=null;return"start"===e?n=t.bottom:"end"===e?n=t.top:twe(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}(n,t);if(nwe(r)){const e=t.isHorizontal();return{x:e?r:null,y:e?null:r}}return null}(e)}(e);return i instanceof Rxe?i:wxe(i,r)}function Txe(e,t,n){const r=Exe(t),{chart:i,index:o,line:s,scale:a,axis:l}=t,c=s.options,u=c.fill,d=c.backgroundColor,{above:h=d,below:p=d}=u||{},g=i.getDatasetMeta(o),f=VCe(i,g);r&&s.points.length&&(Mbe(e,n),function(e,t){const{line:n,target:r,above:i,below:o,area:s,scale:a,clip:l}=t,c=n._loop?"angle":t.axis;e.save();let u=o;o!==i&&("x"===c?(kxe(e,r,s.top),Pxe(e,{line:n,target:r,color:i,scale:a,property:c,clip:l}),e.restore(),e.save(),kxe(e,r,s.bottom)):"y"===c&&(Mxe(e,r,s.left),Pxe(e,{line:n,target:r,color:o,scale:a,property:c,clip:l}),e.restore(),e.save(),Mxe(e,r,s.right),u=i));Pxe(e,{line:n,target:r,color:u,scale:a,property:c,clip:l}),e.restore()}(e,{line:s,target:r,above:h,below:p,area:n,scale:a,axis:l,clip:f}),Pbe(e))}function kxe(e,t,n){const{segments:r,points:i}=t;let o=!0,s=!1;e.beginPath();for(const a of r){const{start:r,end:l}=a,c=i[r],u=i[mxe(r,l,i)];o?(e.moveTo(c.x,c.y),o=!1):(e.lineTo(c.x,n),e.lineTo(c.x,c.y)),s=!!t.pathSegment(e,a,{move:s}),s?e.closePath():e.lineTo(u.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Mxe(e,t,n){const{segments:r,points:i}=t;let o=!0,s=!1;e.beginPath();for(const a of r){const{start:r,end:l}=a,c=i[r],u=i[mxe(r,l,i)];o?(e.moveTo(c.x,c.y),o=!1):(e.lineTo(n,c.y),e.lineTo(c.x,c.y)),s=!!t.pathSegment(e,a,{move:s}),s?e.closePath():e.lineTo(n,u.y)}e.lineTo(n,t.first().y),e.closePath(),e.clip()}function Pxe(e,t){const{line:n,target:r,property:i,color:o,scale:s,clip:a}=t,l=function(e,t,n){const r=e.segments,i=e.points,o=t.points,s=[];for(const a of r){let{start:e,end:r}=a;r=mxe(e,r,i);const l=fxe(n,i[e],i[r],a.loop);if(!t.segments){s.push({source:a,target:l,start:i[e],end:i[r]});continue}const c=OCe(t,l);for(const t of c){const e=fxe(n,o[t.start],o[t.end],t.loop),r=FCe(a,i,e);for(const i of r)s.push({source:i,target:t,start:{[n]:vxe(l,e,"start",Math.max)},end:{[n]:vxe(l,e,"end",Math.min)}})}}return s}(n,r,i);for(const{source:c,target:u,start:d,end:h}of l){const{style:{backgroundColor:t=o}={}}=c,l=!0!==r;e.save(),e.fillStyle=t,Ixe(e,s,a,l&&fxe(i,d,h)),e.beginPath();const p=!!n.pathSegment(e,c);let g;if(l){p?e.closePath():Axe(e,r,h,i);const t=!!r.pathSegment(e,u,{move:p,reverse:!0});g=p&&t,g||Axe(e,r,d,i)}e.closePath(),e.fill(g?"evenodd":"nonzero"),e.restore()}}function Ixe(e,t,n,r){const i=t.chart.chartArea,{property:o,start:s,end:a}=r||{};if("x"===o||"y"===o){let t,r,l,c;"x"===o?(t=s,r=i.top,l=a,c=i.bottom):(t=i.left,r=s,l=i.right,c=a),e.beginPath(),n&&(t=Math.max(t,n.left),l=Math.min(l,n.right),r=Math.max(r,n.top),c=Math.min(c,n.bottom)),e.rect(t,r,l-t,c-r),e.clip()}}function Axe(e,t,n,r){const i=t.interpolate(n,r);i&&e.lineTo(i.x,i.y)}var Dxe={id:"filler",afterDatasetsUpdate(e,t,n){const r=(e.data.datasets||[]).length,i=[];let o,s,a,l;for(s=0;s<r;++s)o=e.getDatasetMeta(s),a=o.dataset,l=null,a&&a.options&&a instanceof oxe&&(l={visible:e.isDatasetVisible(s),index:s,fill:yxe(a,s,r),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:a}),o.$filler=l,i.push(l);for(s=0;s<r;++s)l=i[s],l&&!1!==l.fill&&(l.fill=Cxe(i,s,n.propagate))},beforeDraw(e,t,n){const r="beforeDraw"===n.drawTime,i=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let s=i.length-1;s>=0;--s){const t=i[s].$filler;t&&(t.line.updateControlPoints(o,t.axis),r&&t.fill&&Txe(e.ctx,t,o))}},beforeDatasetsDraw(e,t,n){if("beforeDatasetsDraw"!==n.drawTime)return;const r=e.getSortedVisibleDatasetMetas();for(let i=r.length-1;i>=0;--i){const t=r[i].$filler;bxe(t)&&Txe(e.ctx,t,e.chartArea)}},beforeDatasetDraw(e,t,n){const r=t.meta.$filler;bxe(r)&&"beforeDatasetDraw"===n.drawTime&&Txe(e.ctx,r,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Fxe=(e,t)=>{let{boxHeight:n=t,boxWidth:r=t}=e;return e.usePointStyle&&(n=Math.min(n,t),r=e.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(t,n)}};class Oxe extends rSe{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=swe(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(t=>e.filter(t,this.chart.data))),e.sort&&(t=t.sort((t,n)=>e.sort(t,n,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,r=Gbe(n.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:s,itemHeight:a}=Fxe(n,i);let l,c;t.font=r.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(o,i,s,a)+10):(c=this.maxHeight,l=this._fitCols(o,r,s,a)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,r){const{ctx:i,maxWidth:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=r+s;let u=e;i.textAlign="left",i.textBaseline="middle";let d=-1,h=-c;return this.legendItems.forEach((e,p)=>{const g=n+t/2+i.measureText(e.text).width;(0===p||l[l.length-1]+g+2*s>o)&&(u+=c,l[l.length-(p>0?0:1)]=0,h+=c,d++),a[p]={left:0,top:h,row:d,width:g,height:r},l[l.length-1]+=g+s}),u}_fitCols(e,t,n,r){const{ctx:i,maxHeight:o,options:{labels:{padding:s}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=o-e;let u=s,d=0,h=0,p=0,g=0;return this.legendItems.forEach((e,o)=>{const{itemWidth:f,itemHeight:m}=function(e,t,n,r,i){const o=function(e,t,n,r){let i=e.text;i&&"string"!==typeof i&&(i=i.reduce((e,t)=>e.length>t.length?e:t));return t+n.size/2+r.measureText(i).width}(r,e,t,n),s=function(e,t,n){let r=e;"string"!==typeof t.text&&(r=Nxe(t,n));return r}(i,r,t.lineHeight);return{itemWidth:o,itemHeight:s}}(n,t,i,e,r);o>0&&h+m+2*s>c&&(u+=d+s,l.push({width:d,height:h}),p+=d+s,g++,d=h=0),a[o]={left:p,top:h,col:g,width:f,height:m},d=Math.max(d,f),h+=m+s}),u+=d,l.push({width:d,height:h}),u}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:r},rtl:i}}=this,o=MCe(i,this.left,this.width);if(this.isHorizontal()){let i=0,s=ebe(n,this.left+r,this.right-this.lineWidths[i]);for(const a of t)i!==a.row&&(i=a.row,s=ebe(n,this.left+r,this.right-this.lineWidths[i])),a.top+=this.top+e+r,a.left=o.leftForLtr(o.x(s),a.width),s+=a.width+r}else{let i=0,s=ebe(n,this.top+e+r,this.bottom-this.columnSizes[i].height);for(const a of t)a.col!==i&&(i=a.col,s=ebe(n,this.top+e+r,this.bottom-this.columnSizes[i].height)),a.top=s,a.left+=this.left+r,a.left=o.leftForLtr(o.x(a.left),a.width),s+=a.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Mbe(e,this),this._draw(),Pbe(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:r}=this,{align:i,labels:o}=e,s=ybe.color,a=MCe(e.rtl,this.left,this.width),l=Gbe(o.font),{padding:c}=o,u=l.size,d=u/2;let h;this.drawTitle(),r.textAlign=a.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:p,boxHeight:g,itemHeight:f}=Fxe(o,u),m=this.isHorizontal(),v=this._computeTitleHeight();h=m?{x:ebe(i,this.left+c,this.right-n[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:ebe(i,this.top+v+c,this.bottom-t[0].height),line:0},PCe(this.ctx,e.textDirection);const w=f+c;this.legendItems.forEach((b,C)=>{r.strokeStyle=b.fontColor,r.fillStyle=b.fontColor;const y=r.measureText(b.text).width,S=a.textAlign(b.textAlign||(b.textAlign=o.textAlign)),x=p+d+y;let R=h.x,E=h.y;a.setWidth(this.width),m?C>0&&R+x+c>this.right&&(E=h.y+=w,h.line++,R=h.x=ebe(i,this.left+c,this.right-n[h.line])):C>0&&E+w>this.bottom&&(R=h.x=R+t[h.line].width+c,h.line++,E=h.y=ebe(i,this.top+v+c,this.bottom-t[h.line].height));if(function(e,t,n){if(isNaN(p)||p<=0||isNaN(g)||g<0)return;r.save();const i=iwe(n.lineWidth,1);if(r.fillStyle=iwe(n.fillStyle,s),r.lineCap=iwe(n.lineCap,"butt"),r.lineDashOffset=iwe(n.lineDashOffset,0),r.lineJoin=iwe(n.lineJoin,"miter"),r.lineWidth=i,r.strokeStyle=iwe(n.strokeStyle,s),r.setLineDash(iwe(n.lineDash,[])),o.usePointStyle){const s={radius:g*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:i},l=a.xPlus(e,p/2);Tbe(r,s,l,t+d,o.pointStyleWidth&&p)}else{const o=t+Math.max((u-g)/2,0),s=a.leftForLtr(e,p),l=zbe(n.borderRadius);r.beginPath(),Object.values(l).some(e=>0!==e)?Nbe(r,{x:s,y:o,w:p,h:g,radius:l}):r.rect(s,o,p,g),r.fill(),0!==i&&r.stroke()}r.restore()}(a.x(R),E,b),R=((e,t,n,r)=>e===(r?"left":"right")?n:"center"===e?(t+n)/2:t)(S,R+p+d,m?R+x:this.right,e.rtl),function(e,t,n){Obe(r,n.text,e,t+f/2,l,{strikethrough:n.hidden,textAlign:a.textAlign(n.textAlign)})}(a.x(R),E,b),m)h.x+=x+c;else if("string"!==typeof b.text){const e=l.lineHeight;h.y+=Nxe(b,e)+c}else h.y+=w}),ICe(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Gbe(t.font),r=jbe(t.padding);if(!t.display)return;const i=MCe(e.rtl,this.left,this.width),o=this.ctx,s=t.position,a=n.size/2,l=r.top+a;let c,u=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),c=this.top+l,u=ebe(e.align,u,this.right-d);else{const t=this.columnSizes.reduce((e,t)=>Math.max(e,t.height),0);c=l+ebe(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=ebe(s,u,u+d);o.textAlign=i.textAlign(Zwe(s)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,Obe(o,t.text,h,c,n)}_computeTitleHeight(){const e=this.options.title,t=Gbe(e.font),n=jbe(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,r,i;if(Gwe(e,this.left,this.right)&&Gwe(t,this.top,this.bottom))for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(r=i[n],Gwe(e,r.left,r.left+r.width)&&Gwe(t,r.top,r.top+r.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const o=this._hoveredItem,s=(i=n,null!==(r=o)&&null!==i&&r.datasetIndex===i.datasetIndex&&r.index===i.index);o&&!s&&swe(t.onLeave,[e,o,this],this),this._hoveredItem=n,n&&!s&&swe(t.onHover,[e,n,this],this)}else n&&swe(t.onClick,[e,n,this],this);var r,i}}function Nxe(e,t){return t*(e.text?e.text.length:0)}var Lxe={id:"legend",_element:Oxe,start(e,t,n){const r=e.legend=new Oxe({ctx:e.ctx,options:n,chart:e});Vye.configure(e,r,n),Vye.addBox(e,r)},stop(e){Vye.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const r=e.legend;Vye.configure(e,r,n),r.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const r=t.datasetIndex,i=n.chart;i.isDatasetVisible(r)?(i.hide(r),t.hidden=!0):(i.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:i,color:o,useBorderRadius:s,borderRadius:a}}=e.legend.options;return e._getSortedDatasetMetas().map(e=>{const l=e.controller.getStyle(n?0:void 0),c=jbe(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:o,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:i||l.textAlign,borderRadius:s&&(a||l.borderRadius),datasetIndex:e.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class _xe extends rSe{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const r=ewe(n.text)?n.text.length:1;this._padding=jbe(n.padding);const i=r*Gbe(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:n,bottom:r,right:i,options:o}=this,s=o.align;let a,l,c,u=0;return this.isHorizontal()?(l=ebe(s,n,i),c=t+e,a=i-n):("left"===o.position?(l=n+e,c=ebe(s,r,t),u=-.5*ywe):(l=i-e,c=ebe(s,t,r),u=.5*ywe),a=r-t),{titleX:l,titleY:c,maxWidth:a,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=Gbe(t.font),r=n.lineHeight/2+this._padding.top,{titleX:i,titleY:o,maxWidth:s,rotation:a}=this._drawArgs(r);Obe(e,t.text,0,0,n,{color:t.color,maxWidth:s,rotation:a,textAlign:Zwe(t.align),textBaseline:"middle",translation:[i,o]})}}var Hxe={id:"title",_element:_xe,start(e,t,n){!function(e,t){const n=new _xe({ctx:e.ctx,options:t,chart:e});Vye.configure(e,n,t),Vye.addBox(e,n),e.titleBlock=n}(e,n)},stop(e){const t=e.titleBlock;Vye.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const r=e.titleBlock;Vye.configure(e,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const Vxe={average(e){if(!e.length)return!1;let t,n,r=new Set,i=0,o=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();r.add(e.x),i+=e.y,++o}}if(0===o||0===r.size)return!1;return{x:[...r].reduce((e,t)=>e+t)/r.size,y:i/o}},nearest(e,t){if(!e.length)return!1;let n,r,i,o=t.x,s=t.y,a=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){const r=e[n].element;if(r&&r.hasValue()){const e=Vwe(t,r.getCenterPoint());e<a&&(a=e,i=r)}}if(i){const e=i.tooltipPosition();o=e.x,s=e.y}return{x:o,y:s}}};function Bxe(e,t){return t&&(ewe(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Wxe(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function zxe(e,t){const{element:n,datasetIndex:r,index:i}=t,o=e.getDatasetMeta(r).controller,{label:s,value:a}=o.getLabelAndValue(i);return{chart:e,label:s,parsed:o.getParsed(i),raw:e.data.datasets[r].data[i],formattedValue:a,dataset:o.getDataset(),dataIndex:i,datasetIndex:r,element:n}}function jxe(e,t){const n=e.chart.ctx,{body:r,footer:i,title:o}=e,{boxWidth:s,boxHeight:a}=t,l=Gbe(t.bodyFont),c=Gbe(t.titleFont),u=Gbe(t.footerFont),d=o.length,h=i.length,p=r.length,g=jbe(t.padding);let f=g.height,m=0,v=r.reduce((e,t)=>e+t.before.length+t.lines.length+t.after.length,0);if(v+=e.beforeBody.length+e.afterBody.length,d&&(f+=d*c.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),v){f+=p*(t.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}h&&(f+=t.footerMarginTop+h*u.lineHeight+(h-1)*t.footerSpacing);let w=0;const b=function(e){m=Math.max(m,n.measureText(e).width+w)};return n.save(),n.font=c.string,awe(e.title,b),n.font=l.string,awe(e.beforeBody.concat(e.afterBody),b),w=t.displayColors?s+2+t.boxPadding:0,awe(r,e=>{awe(e.before,b),awe(e.lines,b),awe(e.after,b)}),w=0,n.font=u.string,awe(e.footer,b),n.restore(),m+=g.width,{width:m,height:f}}function Gxe(e,t,n,r){const{x:i,width:o}=n,{width:s,chartArea:{left:a,right:l}}=e;let c="center";return"center"===r?c=i<=(a+l)/2?"left":"right":i<=o/2?c="left":i>=s-o/2&&(c="right"),function(e,t,n,r){const{x:i,width:o}=r,s=n.caretSize+n.caretPadding;return"left"===e&&i+o+s>t.width||"right"===e&&i-o-s<0||void 0}(c,e,t,n)&&(c="center"),c}function $xe(e,t,n){const r=n.yAlign||t.yAlign||function(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||Gxe(e,t,n,r),yAlign:r}}function Uxe(e,t,n,r){const{caretSize:i,caretPadding:o,cornerRadius:s}=e,{xAlign:a,yAlign:l}=n,c=i+o,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=zbe(s);let g=function(e,t){let{x:n,width:r}=e;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,a);const f=function(e,t,n){let{y:r,height:i}=e;return"top"===t?r+=n:r-="bottom"===t?i+n:i/2,r}(t,l,c);return"center"===l?"left"===a?g+=c:"right"===a&&(g-=c):"left"===a?g-=Math.max(u,h)+i:"right"===a&&(g+=Math.max(d,p)+i),{x:jwe(g,0,r.width-t.width),y:jwe(f,0,r.height-t.height)}}function Kxe(e,t,n){const r=jbe(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function Yxe(e){return Bxe([],Wxe(e))}function qxe(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Xxe={beforeTitle:Qve,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:Qve,beforeBody:Qve,beforeLabel:Qve,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Zve(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Qve,afterBody:Qve,beforeFooter:Qve,footer:Qve,afterFooter:Qve};function Qxe(e,t,n,r){const i=e[t].call(n,r);return"undefined"===typeof i?Xxe[t].call(n,r):i}class Jxe extends rSe{static positioners=(()=>Vxe)();constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,i=new $Ce(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,Ube(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,r=Qxe(n,"beforeTitle",this,e),i=Qxe(n,"title",this,e),o=Qxe(n,"afterTitle",this,e);let s=[];return s=Bxe(s,Wxe(r)),s=Bxe(s,Wxe(i)),s=Bxe(s,Wxe(o)),s}getBeforeBody(e,t){return Yxe(Qxe(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return awe(e,e=>{const t={before:[],lines:[],after:[]},i=qxe(n,e);Bxe(t.before,Wxe(Qxe(i,"beforeLabel",this,e))),Bxe(t.lines,Qxe(i,"label",this,e)),Bxe(t.after,Wxe(Qxe(i,"afterLabel",this,e))),r.push(t)}),r}getAfterBody(e,t){return Yxe(Qxe(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,r=Qxe(n,"beforeFooter",this,e),i=Qxe(n,"footer",this,e),o=Qxe(n,"afterFooter",this,e);let s=[];return s=Bxe(s,Wxe(r)),s=Bxe(s,Wxe(i)),s=Bxe(s,Wxe(o)),s}_createItems(e){const t=this._active,n=this.chart.data,r=[],i=[],o=[];let s,a,l=[];for(s=0,a=t.length;s<a;++s)l.push(zxe(this.chart,t[s]));return e.filter&&(l=l.filter((t,r,i)=>e.filter(t,r,i,n))),e.itemSort&&(l=l.sort((t,r)=>e.itemSort(t,r,n))),awe(l,t=>{const n=qxe(e.callbacks,t);r.push(Qxe(n,"labelColor",this,t)),i.push(Qxe(n,"labelPointStyle",this,t)),o.push(Qxe(n,"labelTextColor",this,t))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(r.length){const e=Vxe[n.position].call(this,r,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const t=this._size=jxe(this,n),s=Object.assign({},e,t),a=$xe(this.chart,n,s),l=Uxe(n,s,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,i={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(i={opacity:0});this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,r){const i=this.getCaretPosition(e,n,r);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,n){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:s}=n,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:u}=zbe(s),{x:d,y:h}=e,{width:p,height:g}=t;let f,m,v,w,b,C;return"center"===i?(b=h+g/2,"left"===r?(f=d,m=f-o,w=b+o,C=b-o):(f=d+p,m=f+o,w=b-o,C=b+o),v=f):(m="left"===r?d+Math.max(a,c)+o:"right"===r?d+p-Math.max(l,u)-o:this.caretX,"top"===i?(w=h,b=w-o,f=m-o,v=m+o):(w=h+g,b=w+o,f=m+o,v=m-o),C=w),{x1:f,x2:m,x3:v,y1:w,y2:b,y3:C}}drawTitle(e,t,n){const r=this.title,i=r.length;let o,s,a;if(i){const l=MCe(n.rtl,this.x,this.width);for(e.x=Kxe(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",o=Gbe(n.titleFont),s=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,a=0;a<i;++a)t.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s,a+1===i&&(e.y+=n.titleMarginBottom-s)}}_drawColorBox(e,t,n,r,i){const o=this.labelColors[n],s=this.labelPointStyles[n],{boxHeight:a,boxWidth:l}=i,c=Gbe(i.bodyFont),u=Kxe(this,"left",i),d=r.x(u),h=a<c.lineHeight?(c.lineHeight-a)/2:0,p=t.y+h;if(i.usePointStyle){const t={radius:Math.min(l,a)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},n=r.leftForLtr(d,l)+l/2,c=p+a/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Ebe(e,t,n,c),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Ebe(e,t,n,c)}else{e.lineWidth=twe(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const t=r.leftForLtr(d,l),n=r.leftForLtr(r.xPlus(d,1),l-2),s=zbe(o.borderRadius);Object.values(s).some(e=>0!==e)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Nbe(e,{x:t,y:p,w:l,h:a,radius:s}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Nbe(e,{x:n,y:p+1,w:l-2,h:a-2,radius:s}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(t,p,l,a),e.strokeRect(t,p,l,a),e.fillStyle=o.backgroundColor,e.fillRect(n,p+1,l-2,a-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:s,boxHeight:a,boxWidth:l,boxPadding:c}=n,u=Gbe(n.bodyFont);let d=u.lineHeight,h=0;const p=MCe(n.rtl,this.x,this.width),g=function(n){t.fillText(n,p.x(e.x+h),e.y+d/2),e.y+=d+i},f=p.textAlign(o);let m,v,w,b,C,y,S;for(t.textAlign=o,t.textBaseline="middle",t.font=u.string,e.x=Kxe(this,f,n),t.fillStyle=n.bodyColor,awe(this.beforeBody,g),h=s&&"right"!==f?"center"===o?l/2+c:l+2+c:0,b=0,y=r.length;b<y;++b){for(m=r[b],v=this.labelTextColors[b],t.fillStyle=v,awe(m.before,g),w=m.lines,s&&w.length&&(this._drawColorBox(t,e,b,p,n),d=Math.max(u.lineHeight,a)),C=0,S=w.length;C<S;++C)g(w[C]),d=u.lineHeight;awe(m.after,g)}h=0,d=u.lineHeight,awe(this.afterBody,g),e.y-=i}drawFooter(e,t,n){const r=this.footer,i=r.length;let o,s;if(i){const a=MCe(n.rtl,this.x,this.width);for(e.x=Kxe(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=a.textAlign(n.footerAlign),t.textBaseline="middle",o=Gbe(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,s=0;s<i;++s)t.fillText(r[s],a.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,r){const{xAlign:i,yAlign:o}=this,{x:s,y:a}=e,{width:l,height:c}=n,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:p}=zbe(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(s+u,a),"top"===o&&this.drawCaret(e,t,n,r),t.lineTo(s+l-d,a),t.quadraticCurveTo(s+l,a,s+l,a+d),"center"===o&&"right"===i&&this.drawCaret(e,t,n,r),t.lineTo(s+l,a+c-p),t.quadraticCurveTo(s+l,a+c,s+l-p,a+c),"bottom"===o&&this.drawCaret(e,t,n,r),t.lineTo(s+h,a+c),t.quadraticCurveTo(s,a+c,s,a+c-h),"center"===o&&"left"===i&&this.drawCaret(e,t,n,r),t.lineTo(s,a+u),t.quadraticCurveTo(s,a,s+u,a),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,r=n&&n.x,i=n&&n.y;if(r||i){const n=Vxe[e.position].call(this,this._active,this._eventPosition);if(!n)return;const o=this._size=jxe(this,e),s=Object.assign({},n,this._size),a=$xe(t,e,s),l=Uxe(e,s,a,t);r._to===l.x&&i._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=o.width,this.height=o.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=jbe(t.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&s&&(e.save(),e.globalAlpha=n,this.drawBackground(i,e,r,t),PCe(e,t.textDirection),i.y+=o.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),ICe(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,r=e.map(e=>{let{datasetIndex:t,index:n}=e;const r=this.chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[n],index:n}}),i=!lwe(n,r),o=this._positionChanged(r,t);(i||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,t,n),s=this._positionChanged(o,e),a=t||!lwe(o,i)||s;return a&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),a}_getActiveElements(e,t,n,r){const i=this.options;if("mouseout"===e.type)return[];if(!r)return t.filter(e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index));const o=this.chart.getElementsAtEventForMode(e,i.mode,i,n);return i.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:r,options:i}=this,o=Vxe[i.position].call(this,e,t);return!1!==o&&(n!==o.x||r!==o.y)}}var Zxe={id:"tooltip",_element:Jxe,positioners:Vxe,afterInit(e,t,n){n&&(e.tooltip=new Jxe({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Xxe},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function eRe(e,t,n,r){const i=e.indexOf(t);if(-1===i)return((e,t,n,r)=>("string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,r);return i!==e.lastIndexOf(t)?n:i}function tRe(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class nRe extends pSe{static id="category";static defaults=(()=>({ticks:{callback:tRe}}))();constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:r}of t)e[n]===r&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Zve(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:jwe(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:eRe(n,e,iwe(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,r=[];let i=this.getLabels();i=0===e&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return tRe.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function rRe(e,t){const n=[],{bounds:r,step:i,min:o,max:s,precision:a,count:l,maxTicks:c,maxDigits:u,includeBounds:d}=e,h=i||1,p=c-1,{min:g,max:f}=t,m=!Zve(o),v=!Zve(s),w=!Zve(l),b=(f-g)/(u+1);let C,y,S,x,R=Dwe((f-g)/p/h)*h;if(R<1e-14&&!m&&!v)return[{value:g},{value:f}];x=Math.ceil(f/R)-Math.floor(g/R),x>p&&(R=Dwe(x*R/p/h)*h),Zve(a)||(C=Math.pow(10,a),R=Math.ceil(R*C)/C),"ticks"===r?(y=Math.floor(g/R)*R,S=Math.ceil(f/R)*R):(y=g,S=f),m&&v&&i&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((s-o)/i,R/1e3)?(x=Math.round(Math.min((s-o)/R,c)),R=(s-o)/x,y=o,S=s):w?(y=m?o:y,S=v?s:S,x=l-1,R=(S-y)/x):(x=(S-y)/R,x=Awe(x,Math.round(x),R/1e3)?Math.round(x):Math.ceil(x));const E=Math.max(_we(R),_we(y));C=Math.pow(10,Zve(a)?E:a),y=Math.round(y*C)/C,S=Math.round(S*C)/C;let T=0;for(m&&(d&&y!==o?(n.push({value:o}),y<o&&T++,Awe(Math.round((y+T*R)*C)/C,o,iRe(o,b,e))&&T++):y<o&&T++);T<x;++T){const e=Math.round((y+T*R)*C)/C;if(v&&e>s)break;n.push({value:e})}return v&&d&&S!==s?n.length&&Awe(n[n.length-1].value,s,iRe(s,b,e))?n[n.length-1].value=s:n.push({value:s}):v&&S!==s||n.push({value:S}),n}function iRe(e,t,n){let{horizontal:r,minRotation:i}=n;const o=Nwe(i),s=(r?Math.sin(o):Math.cos(o))||.001,a=.75*t*(""+e).length;return Math.min(t/s,a)}class oRe extends pSe{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Zve(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:i}=this;const o=e=>r=t?r:e,s=e=>i=n?i:e;if(e){const e=Iwe(r),t=Iwe(i);e<0&&t<0?s(0):e>0&&t>0&&o(0)}if(r===i){let t=0===i?1:Math.abs(.05*i);s(i+t),e||o(r-t)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:r}=e;return r?(t=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r=rRe({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Owe(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-t)/Math.max(e.length-1,1)/2;t-=r,n+=r}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return pbe(e,this.chart.options.locale,this.options.ticks.format)}}class sRe extends oRe{static id="linear";static defaults=(()=>({ticks:{callback:fbe.formatters.numeric}}))();determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=nwe(e)?e:0,this.max=nwe(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Nwe(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}fbe.formatters.logarithmic;fbe.formatters.numeric;const aRe={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},lRe=Object.keys(aRe);function cRe(e,t){return e-t}function uRe(e,t){if(Zve(t))return null;const n=e._adapter,{parser:r,round:i,isoWeekday:o}=e._parseOpts;let s=t;return"function"===typeof r&&r(s),nwe(s)||("string"===typeof r?n.parse(s,r):n.parse(s)),null===s?null:(i&&("week"!==i||!Fwe(o)&&!0!==o?n.startOf(s,i):n.startOf(s,"isoWeek",o)),+s)}function dRe(e,t,n,r){const i=lRe.length;for(let o=lRe.indexOf(e);o<i-1;++o){const e=aRe[lRe[o]],i=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(i*e.size))<=r)return lRe[o]}return lRe[i-1]}function hRe(e,t,n){if(n){if(n.length){const{lo:r,hi:i}=$we(n,t);e[n[r]>=t?n[r]:n[i]]=!0}}else e[t]=!0}function pRe(e,t,n){const r=[],i={},o=t.length;let s,a;for(0;s<o;++s)t[s],i[a]=s,r.push({value:a,major:!1});return 0!==o&&n?function(e,t,n,r){const i=e._adapter,o=+i.startOf(t[0].value,r),s=t[t.length-1].value;let a,l;for(o;a<=s;+i.add(a,1,r))n[a],l>=0&&(t[l].major=!0);return t}(e,r,i,n):r}class gRe extends pSe{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),r=this._adapter=new bye(e.adapters.date);r.init(t),pwe(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:uRe(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:s}=this.getUserBounds();function a(e){o||isNaN(e.min)||Math.min(r,e.min),s||isNaN(e.max)||Math.max(i,e.max)}o&&s||(a(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||a(this.getMinMax(!1))),nwe(r)&&!isNaN(r)?r:+t.startOf(Date.now(),n),nwe(i)&&!isNaN(i)?i:+t.endOf(Date.now(),n)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(e[0],e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=function(e,t,n){let r=0,i=e.length;for(;r<i&&e[r]<t;)0;for(;i>r&&e[i-1]>n;)0;return r>0||i<e.length?e.slice(r,i):e}(r,i,this.max);return this._unit=t.unit||(n.autoSkip?dRe(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):function(e,t,n,r,i){for(let o=lRe.length-1;o>=lRe.indexOf(n);o--){const n=lRe[o];if(aRe[n].common&&e._adapter.diff(i,r,n)>=t-1)return n}return lRe[n?lRe.indexOf(n):0]}(this,o.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=lRe.indexOf(e)+1,n=lRe.length;t<n;++t)if(aRe[lRe[t]].common)return lRe[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&o.reverse(),pRe(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,i=0;this.options.offset&&n.length&&(this.getDecimalForValue(n[0]),1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,this.getDecimalForValue(n[n.length-1]),1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const o=n.length<3?.5:.25;jwe(r,0,o),jwe(i,0,o),this._offsets={start:r,end:i,factor:1/(r+1+i)}}_generate(){const e=this._adapter,t=this.min,n=this.max,r=this.options,i=r.time,o=i.unit||dRe(i.minUnit,t,n,this._getLabelCapacity(t)),s=iwe(r.ticks.stepSize,1),a="week"===o&&i.isoWeekday,l=Fwe(a)||!0===a,c={};let u,d,h=t;if(l&&+e.startOf(h,"isoWeek",a),+e.startOf(h,l?"day":o),e.diff(n,t,o)>1e5*s)throw new Error(t+" and "+n+" are too far apart with stepSize of "+s+" "+o);const p="data"===r.ticks.source&&this.getDataTimestamps();for(0;u<n;+e.add(u,s,o),d++)hRe(c,u,p);return u!==n&&"ticks"!==r.bounds&&1!==d||hRe(c,u,p),Object.keys(c).sort(cRe).map(e=>+e)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,r=this._unit,i=t||n[r];return this._adapter.format(e,i)}_tickFormatFunction(e,t,n,r){const i=this.options,o=i.ticks.callback;if(o)return swe(o,[e,t,n],this);const s=i.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&s[a],u=l&&s[l],d=n[t],h=l&&u&&d&&d.major;return this._adapter.format(e,r||(h?u:c))}generateTickLabels(e){let t,n,r;for(e.length;t<n;++t)e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,r=Nwe(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(r),o=Math.sin(r),s=this._resolveTickFontOptions(0).size;return{w:n*i+s*o,h:n*o+s*i}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,i=this._tickFormatFunction(e,0,pRe(this,[e],this._majorUnit),r),o=this._getLabelSize(i),s=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return s>0?s:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(r.length;e<t;++e)n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const r=this.getLabels();for(r.length;t<n;++t)e.push(uRe(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Xwe(e.sort(cRe))}}const fRe="label";function mRe(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function vRe(e,t){e.labels=t}function wRe(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fRe;const r=[];e.datasets=t.map(t=>{const i=e.datasets.find(e=>e[n]===t[n]);return i&&t.data&&!r.includes(i)?(r.push(i),Object.assign(i,t),i):{...t}})}function bRe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fRe;const n={labels:[],datasets:[]};return vRe(n,e.labels),wRe(n,e.datasets,t),n}function CRe(e,n){const{height:r=150,width:i=300,redraw:o=!1,datasetIdKey:s,type:a,data:l,options:c,plugins:u=[],fallbackContent:d,updateMode:h,...p}=e,g=(0,t.useRef)(null),f=(0,t.useRef)(null),m=()=>{g.current&&(f.current=new GSe(g.current,{type:a,data:bRe(l,s),options:c&&{...c},plugins:u}),mRe(n,f.current))},v=()=>{mRe(n,null),f.current&&(f.current.destroy(),f.current=null)};return(0,t.useEffect)(()=>{!o&&f.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(f.current,c)},[o,c]),(0,t.useEffect)(()=>{!o&&f.current&&vRe(f.current.config.data,l.labels)},[o,l.labels]),(0,t.useEffect)(()=>{!o&&f.current&&l.datasets&&wRe(f.current.config.data,l.datasets,s)},[o,l.datasets]),(0,t.useEffect)(()=>{f.current&&(o?(v(),setTimeout(m)):f.current.update(h))},[o,c,l.labels,l.datasets,h]),(0,t.useEffect)(()=>{f.current&&(v(),setTimeout(m))},[a]),(0,t.useEffect)(()=>(m(),()=>v()),[]),t.createElement("canvas",{ref:g,role:"img",height:r,width:i,...p},d)}const yRe=(0,t.forwardRef)(CRe);function SRe(e,n){return GSe.register(n),(0,t.forwardRef)((n,r)=>t.createElement(yRe,{...n,ref:r,type:e}))}const xRe=SRe("line",gye),RRe=SRe("bar",hye),ERe=SRe("doughnut",pye),TRe=SRe("pie",fye),kRe=SRe("scatter",mye);GSe.register(nRe,sRe,axe,oxe,gxe,XSe,Hxe,Zxe,Lxe,Dxe);const MRe=e=>{let{data:t,chartType:n,selectedColumns:r,chartColors:i,onChartTypeChange:o,onColumnChange:s}=e;const a=(()=>{if(!t||0===t.length)return[];const e=new Set;return t.forEach(t=>{Object.keys(t).forEach(t=>e.add(t))}),Array.from(e).sort((e,t)=>parseInt(e)-parseInt(t))})(),l=(()=>{if(!t||0===t.length)return{labels:[],datasets:[{label:"No data",data:[],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]};if(!r.x||!r.y)return{labels:[],datasets:[{label:"Select X and Y columns",data:[],backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]};const e=t.some(e=>e.hasOwnProperty(r.x)&&e.hasOwnProperty(r.y));if(!e)return{labels:[],datasets:[{label:"Columns not found in data",data:[],backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]};const o=[],s=[];t.forEach((e,t)=>{if(0===t)return;const n=e[r.x],i=e[r.y];if(void 0!==n&&null!==n&&void 0!==i&&null!==i){const e=String(n).trim(),t=String(i).trim();if(""!==e&&""!==t){o.push(e);const n="number"===typeof i?i:parseFloat(t);s.push(isNaN(n)?0:n)}}});const a=i[r.y]||{backgroundColor:"rgba(75, 192, 192, 0.8)",borderColor:"rgba(75, 192, 192, 1)"};return{labels:o,datasets:[{label:r.y,data:s,backgroundColor:"line"===n?a.backgroundColor.replace("1)","0.2)"):a.backgroundColor,borderColor:a.borderColor,borderWidth:2,..."line"===n&&{fill:!0,tension:.1}}]}})();return(0,MH.jsxs)("div",{className:"chart-container",children:[(0,MH.jsxs)("div",{className:"chart-header",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcc8 Data Visualization"}),(0,MH.jsxs)("div",{className:"chart-controls-header",children:[(0,MH.jsxs)("div",{className:"control-group-inline",children:[(0,MH.jsx)("label",{htmlFor:"chartType",children:"Type:"}),(0,MH.jsx)("select",{id:"chartType",value:n,onChange:e=>o(e.target.value),children:[{value:"line",label:"Line"},{value:"bar",label:"Bar"},{value:"pie",label:"Pie"},{value:"doughnut",label:"Doughnut"},{value:"scatter",label:"Scatter"}].map(e=>(0,MH.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,MH.jsxs)("div",{className:"control-group-inline",children:[(0,MH.jsx)("label",{htmlFor:"xColumn",children:"X:"}),(0,MH.jsxs)("select",{id:"xColumn",value:r.x,onChange:e=>s("x",e.target.value),children:[(0,MH.jsx)("option",{value:"",children:"Select"}),a.map(e=>(0,MH.jsx)("option",{value:e,children:e},e))]})]}),(0,MH.jsxs)("div",{className:"control-group-inline",children:[(0,MH.jsx)("label",{htmlFor:"yColumn",children:"Y:"}),(0,MH.jsxs)("select",{id:"yColumn",value:r.y,onChange:e=>s("y",e.target.value),children:[(0,MH.jsx)("option",{value:"",children:"Select"}),a.map(e=>(0,MH.jsx)("option",{value:e,children:e},e))]})]})]})]}),(0,MH.jsx)("div",{className:"chart-wrapper",children:(()=>{const e={data:l,options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:`${n.toUpperCase()} Chart - ${r.x} vs ${r.y}`}},scales:"pie"!==n&&"doughnut"!==n?{y:{beginAtZero:!0}}:void 0}};switch(n){case"line":default:return(0,MH.jsx)(xRe,{...e});case"bar":return(0,MH.jsx)(RRe,{...e});case"pie":return(0,MH.jsx)(TRe,{...e});case"doughnut":return(0,MH.jsx)(ERe,{...e});case"scatter":return(0,MH.jsx)(kRe,{...e})}})()})]})};var PRe={version:"0.18.5"},IRe=1200,ARe=1252,DRe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],FRe={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ORe=function(e){-1!=DRe.indexOf(e)&&(ARe=FRe[0]=e)};var NRe=function(e){IRe=e,ORe(e)};function LRe(){NRe(1200),ORe(1252)}function _Re(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function HRe(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var VRe,BRe=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return 255==t&&254==n?function(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==n?HRe(e.slice(2)):65279==t?e.slice(1):e},WRe=function(e){return String.fromCharCode(e)},zRe=function(e){return String.fromCharCode(e)};var jRe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function GRe(e){for(var t="",n=0,r=0,i=0,o=0,s=0,a=0,l=0,c=0;c<e.length;)o=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,a=(15&r)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=jRe.charAt(o)+jRe.charAt(s)+jRe.charAt(a)+jRe.charAt(l);return t}function $Re(e){var t="",n=0,r=0,i=0,o=0,s=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=jRe.indexOf(e.charAt(l++))<<2|(o=jRe.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&o)<<4|(s=jRe.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),i=(3&s)<<6|(a=jRe.indexOf(e.charAt(l++))),64!==a&&(t+=String.fromCharCode(i));return t}var URe=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),KRe=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function YRe(e){return URe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function qRe(e){return URe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var XRe=function(e){return URe?KRe(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function QRe(e){if("undefined"===typeof ArrayBuffer)return XRe(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}function JRe(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function ZRe(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ZRe(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var eEe=URe?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:KRe(e)}))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var tEe=/\u0000/g,nEe=/[\u0001-\u0006]/g;function rEe(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function iEe(e,t){var n=""+e;return n.length>=t?n:wTe("0",t-n.length)+n}function oEe(e,t){var n=""+e;return n.length>=t?n:wTe(" ",t-n.length)+n}function sEe(e,t){var n=""+e;return n.length>=t?n:n+wTe(" ",t-n.length)}var aEe=Math.pow(2,32);function lEe(e,t){return e>aEe||e<-aEe?function(e,t){var n=""+Math.round(e);return n.length>=t?n:wTe("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:wTe("0",t-n.length)+n}(Math.round(e),t)}function cEe(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var uEe=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dEe=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var hEe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},pEe={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gEe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fEe(e,t,n){for(var r=e<0?-1:1,i=e*r,o=0,s=1,a=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(a=(d=Math.floor(i))*s+o,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),o=s,s=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=o):(u=c,a=s)),!n)return[0,r*a,u];var h=Math.floor(r*a/u);return[h,r*a-h*u,u]}function mEe(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),o=0,s=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,86400==++i&&(a.T=i=0,++r,++a.D)),60===r)s=n?[1317,10,29]:[1900,2,29],o=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),n&&(o=function(e,t){t[0]-=581;var n=e.getDay();e<60&&(n=(n+6)%7);return n}(l,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=o,a}var vEe=new Date(1899,11,31,0,0,0),wEe=vEe.getTime(),bEe=new Date(1900,2,1,0,0,0);function CEe(e,t){var n=e.getTime();return t?n-=1262304e5:e>=bEe&&(n+=864e5),(n-(wEe+6e4*(e.getTimezoneOffset()-vEe.getTimezoneOffset())))/864e5}function yEe(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SEe(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=yEe(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=yEe(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),yEe(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function xEe(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):SEe(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return GEe(14,CEe(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function REe(e,t,n,r){var i,o="",s=0,a=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,c=t.length;break;case 3:return dEe[n.m-1][1];case 5:return dEe[n.m-1][0];default:return dEe[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,c=t.length;break;case 3:return uEe[n.q][0];default:return uEe[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(a=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(a*(n.S+n.u)))>=60*a&&(s=0),"s"===t?0===s?"0":""+s/a:(o=iEe(s,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):iEe(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?iEe(i,c):""}function EEe(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var TEe=/%/g;function kEe(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+kEe(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var MEe=/# (\?+)( ?)\/( ?)(\d+)/;var PEe=/^#*0*\.([0#]+)/,IEe=/\).*[0#]/,AEe=/\(###\) ###\\?-####/;function DEe(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function FEe(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function OEe(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function NEe(e,t,n){if(40===e.charCodeAt(0)&&!t.match(IEe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?NEe("n",r,n):"("+NEe("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return HEe(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(TEe,""),i=t.length-r.length;return HEe(e,r,n*Math.pow(10,2*i))+wTe("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return kEe(t,n);if(36===t.charCodeAt(0))return"$"+NEe(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+lEe(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=lEe(n,0))&&(i=""),i.length>t.length?i:DEe(t.substr(0,t.length-i.length))+i;if(o=t.match(MEe))return function(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),o=Math.floor(i/r),s=i-o*r,a=r;return n+(0===o?"":""+o)+" "+(0===s?wTe(" ",e[1].length+1+e[4].length):oEe(s,e[1].length)+e[2]+"/"+e[3]+iEe(a,e[4].length))}(o,l,c);if(t.match(/^#+0+$/))return c+lEe(l,t.length-t.indexOf("0"));if(o=t.match(PEe))return i=FEe(n,o[1].length).replace(/^([^\.]+)$/,"$1."+DEe(o[1])).replace(/\.$/,"."+DEe(o[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+wTe("0",DEe(o[1]).length-t.length)}),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+FEe(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+EEe(lEe(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+NEe(e,t,-n):EEe(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,o[1].length)))+"."+iEe(OEe(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return NEe(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rEe(NEe(e,t.replace(/[\\-]/g,""),n)),s=0,rEe(rEe(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""}));if(t.match(AEe))return"("+(i=NEe(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=fEe(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=HEe("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=sEe(a[2],s)).length<o[4].length&&(u=DEe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=fEe(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?oEe(a[1],s)+o[2]+"/"+o[3]+sEe(a[2],s):wTe(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=lEe(n,0),t.length<=i.length?i:DEe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=t.indexOf(".")-s,h=t.length-i.length-d;return DEe(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return s=OEe(n,o[1].length),n<0?"-"+NEe(e,t,-n):EEe(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?iEe(0,3-e.length):"")+e})+"."+iEe(s,o[1].length);switch(t){case"###,##0.00":return NEe(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var p=EEe(lEe(l,0));return"0"!==p?c+p:"";case"###,###.00":return NEe(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return NEe(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function LEe(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+LEe(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),!(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function _Ee(e,t,n){if(40===e.charCodeAt(0)&&!t.match(IEe)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?_Ee("n",r,n):"("+_Ee("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return HEe(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(TEe,""),i=t.length-r.length;return HEe(e,r,n*Math.pow(10,2*i))+wTe("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return LEe(t,n);if(36===t.charCodeAt(0))return"$"+_Ee(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+iEe(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,0===n&&(i=""),i.length>t.length?i:DEe(t.substr(0,t.length-i.length))+i;if(o=t.match(MEe))return function(e,t,n){return n+(0===t?"":""+t)+wTe(" ",e[1].length+2+e[4].length)}(o,l,c);if(t.match(/^#+0+$/))return c+iEe(l,t.length-t.indexOf("0"));if(o=t.match(PEe))return i=(i=(""+n).replace(/^([^\.]+)$/,"$1."+DEe(o[1])).replace(/\.$/,"."+DEe(o[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+wTe("0",DEe(o[1]).length-t.length)}),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+EEe(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+_Ee(e,t,-n):EEe(""+n)+"."+wTe("0",o[1].length);if(o=t.match(/^#,#*,#0/))return _Ee(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rEe(_Ee(e,t.replace(/[\\-]/g,""),n)),s=0,rEe(rEe(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""}));if(t.match(AEe))return"("+(i=_Ee(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=fEe(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=HEe("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=sEe(a[2],s)).length<o[4].length&&(u=DEe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=fEe(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?oEe(a[1],s)+o[2]+"/"+o[3]+sEe(a[2],s):wTe(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:DEe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=t.indexOf(".")-s,h=t.length-i.length-d;return DEe(t.substr(0,d)+i+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+_Ee(e,t,-n):EEe(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?iEe(0,3-e.length):"")+e})+"."+iEe(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=EEe(""+l);return"0"!==p?c+p:"";default:if(t.match(/\.[0#?]*$/))return _Ee(e,t.slice(0,t.lastIndexOf(".")),n)+DEe(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function HEe(e,t,n){return(0|n)===n?_Ee(e,t,n):NEe(e,t,n)}var VEe=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function BEe(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":cEe(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(VEe))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var WEe=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function zEe(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function jEe(e,t){var n=function(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!==typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var o=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,o];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(WEe),a=n[1].match(WEe);return zEe(t,s)?[r,n[0]]:zEe(t,a)?[r,n[1]]:[r,n[null!=s&&null!=a?2:1]]}return[r,o]}function GEe(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:hEe)[e])&&(r=n.table&&n.table[pEe[e]]||hEe[pEe[e]]),null==r&&(r=gEe[e]||"General")}if(cEe(r,0))return xEe(t,n);t instanceof Date&&(t=CEe(t,n.date1904));var i=jEe(r,t);if(cEe(i[1]))return xEe(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var i,o,s,a=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!cEe(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);a[a.length]={t:"t",v:l},++c;break;case"\\":var p=e.charAt(++c),g="("===p||")"===p?p:"t";a[a.length]={t:g,v:p},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=mEe(t,n,"2"===e.charAt(c+1))))return"";a[a.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=mEe(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),a[a.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var f={t:u,v:u};if(null==i&&(i=mEe(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(f.v=i.H>=12?"P":"A"),f.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(f.v=i.H>=12?"PM":"AM"),f.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=i&&(f.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),f.t="T",c+=5,h="h"):(f.t="t",++c),null==i&&"T"===f.t)return"";a[a.length]=f,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(VEe)){if(null==i&&null==(i=mEe(t,n)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",BEe(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":a[a.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c}var m,v=0,w=0;for(c=a.length-1,d="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=h,d="h",v<1&&(v=1);break;case"s":(m=a[c].v.match(/\.0+$/))&&(w=Math.max(w,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=a[c].t;break;case"m":"s"===d&&(a[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[c].v.match(/[Hh]/)&&(v=1),v<2&&a[c].v.match(/[Mm]/)&&(v=2),v<3&&a[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var b,C="";for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=REe(a[c].t.charCodeAt(0),a[c].v,i,w),a[c].t="t";break;case"n":case"?":for(b=c+1;null!=a[b]&&("?"===(u=a[b].t)||"D"===u||(" "===u||"t"===u)&&null!=a[b+1]&&("?"===a[b+1].t||"t"===a[b+1].t&&"/"===a[b+1].v)||"("===a[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===a[b].v||" "===a[b].v&&null!=a[b+1]&&"?"==a[b+1].t));)a[c].v+=a[b].v,a[b]={v:"",t:";"},++b;C+=a[c].v,c=b-1;break;case"G":a[c].t="t",a[c].v=xEe(t,n)}var y,S,x="";if(C.length>0){40==C.charCodeAt(0)?(y=t<0&&45===C.charCodeAt(0)?-t:t,S=HEe("n",C,y)):(S=HEe("n",C,y=t<0&&r>1?-t:t),y<0&&a[0]&&"t"==a[0].t&&(S=S.substr(1),a[0].v="-"+a[0].v)),b=S.length-1;var R=a.length;for(c=0;c<a.length;++c)if(null!=a[c]&&"t"!=a[c].t&&a[c].v.indexOf(".")>-1){R=c;break}var E=a.length;if(R===a.length&&-1===S.indexOf("E")){for(c=a.length-1;c>=0;--c)null!=a[c]&&-1!=="n?".indexOf(a[c].t)&&(b>=a[c].v.length-1?(b-=a[c].v.length,a[c].v=S.substr(b+1,a[c].v.length)):b<0?a[c].v="":(a[c].v=S.substr(0,b+1),b=-1),a[c].t="t",E=c);b>=0&&E<a.length&&(a[E].v=S.substr(0,b+1)+a[E].v)}else if(R!==a.length&&-1===S.indexOf("E")){for(b=S.indexOf(".")-1,c=R;c>=0;--c)if(null!=a[c]&&-1!=="n?".indexOf(a[c].t)){for(o=a[c].v.indexOf(".")>-1&&c===R?a[c].v.indexOf(".")-1:a[c].v.length-1,x=a[c].v.substr(o+1);o>=0;--o)b>=0&&("0"===a[c].v.charAt(o)||"#"===a[c].v.charAt(o))&&(x=S.charAt(b--)+x);a[c].v=x,a[c].t="t",E=c}for(b>=0&&E<a.length&&(a[E].v=S.substr(0,b+1)+a[E].v),b=S.indexOf(".")+1,c=R;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===R)){for(o=a[c].v.indexOf(".")>-1&&c===R?a[c].v.indexOf(".")+1:0,x=a[c].v.substr(0,o);o<a[c].v.length;++o)b<S.length&&(x+=S.charAt(b++));a[c].v=x,a[c].t="t",E=c}}}for(c=0;c<a.length;++c)null!=a[c]&&"n?".indexOf(a[c].t)>-1&&(y=r>1&&t<0&&c>0&&"-"===a[c-1].v?-t:t,a[c].v=HEe(a[c].t,a[c].v,y),a[c].t="t");var T="";for(c=0;c!==a.length;++c)null!=a[c]&&(T+=a[c].v);return T}(i[1],t,n,i[0])}function $Ee(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(void 0!=hEe[n]){if(hEe[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return hEe[t]=e,t}function UEe(e){for(var t=0;392!=t;++t)void 0!==e[t]&&$Ee(e[t],t)}function KEe(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',hEe=e}var YEe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},qEe=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var XEe=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var n=function(e){var t=0,n=0,r=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!==typeof Int32Array?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return o}(t),r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],d=n[8],h=n[9],p=n[10],g=n[11],f=n[12],m=n[13],v=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,i=0,o=e.length;i<o;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var w=-1^n,b=e.length-15,C=0;C<b;)w=v[e[C++]^255&w]^m[e[C++]^w>>8&255]^f[e[C++]^w>>16&255]^g[e[C++]^w>>>24]^p[e[C++]]^h[e[C++]]^d[e[C++]]^u[e[C++]]^c[e[C++]]^l[e[C++]]^a[e[C++]]^s[e[C++]]^o[e[C++]]^i[e[C++]]^r[e[C++]]^t[e[C++]];for(b+=15;C<b;)w=w>>>8^t[255&(w^e[C++])];return~w},e.str=function(e,n){for(var r=-1^n,i=0,o=e.length,s=0,a=0;i<o;)(s=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),a=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|a>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&a))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),QEe=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function o(e){CMe(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),i=e.read_shift(2),o=e.l+i,s={};if(21589===r)1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),i>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=o,t[r]=s}return t}function s(){return e||(e={})}function a(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=S(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(URe&&Buffer.isBuffer(e)?e.toString("binary"):S(e)).split("\r\n"),i=0,o="";for(i=0;i<r.length;++i)if(o=r[i],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),n||(n=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),o.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var a="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,p=0;for(i=0;i<r.length;++i){var g=r[i];g!==a&&g!==a+"--"||(p++&&ce(u,r.slice(d,i),n),d=i)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,o,s,a,p=512,g=[],f=e.slice(0,512);CMe(f,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(w,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(f);switch(n=m[0]){case 3:p=512;break;case 4:p=4096;break;case 0:if(0==m[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==p&&CMe(f=e.slice(0,p),28);var b=e.slice(0,p);!function(e,t){var n=9;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(f,n);var C=f.read_shift(4,"i");if(3===n&&0!==C)throw new Error("# Directory Sectors: Expected 0 saw "+C);f.l+=4,o=f.read_shift(4,"i"),f.l+=4,f.chk("00100000","Mini Stream Cutoff Size: "),s=f.read_shift(4,"i"),r=f.read_shift(4,"i"),a=f.read_shift(4,"i"),i=f.read_shift(4,"i");for(var y=-1,x=0;x<109&&!((y=f.read_shift(4,"i"))<0);++x)g[x]=y;var R=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,p);c(a,i,R,p,g);var E=function(e,t,n,r){var i=e.length,o=[],s=[],a=[],l=[],c=r-1,u=0,d=0,h=0,p=0;for(u=0;u<i;++u)if(a=[],(h=u+t)>=i&&(h-=i),!s[h]){l=[];var g=[];for(d=h;d>=0;){g[d]=!0,s[d]=!0,a[a.length]=d,l.push(e[d]);var f=n[Math.floor(4*d/r)];if(r<4+(p=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[f])break;if(g[d=hMe(e[f],p)])break}o[h]={nodes:a,data:Wke([l])}}return o}(R,o,g,p);E[o].name="!Directory",r>0&&s!==v&&(E[s].name="!MiniFAT"),E[g[0]].name="!FAT",E.fat_addrs=g,E.ssz=p;var T=[],k=[],M=[];!function(e,t,n,r,i,o,s,a){for(var c,h=0,p=r.length?2:0,g=t[e].data,f=0,m=0;f<g.length;f+=128){var w=g.slice(f,f+128);CMe(w,64),m=w.read_shift(2),c=jke(w,0,m-p),r.push(c);var b={name:c,type:w.read_shift(1),color:w.read_shift(1),L:w.read_shift(4,"i"),R:w.read_shift(4,"i"),C:w.read_shift(4,"i"),clsid:w.read_shift(16),state:w.read_shift(4,"i"),start:0,size:0};0!==w.read_shift(2)+w.read_shift(2)+w.read_shift(2)+w.read_shift(2)&&(b.ct=d(w,w.l-8)),0!==w.read_shift(2)+w.read_shift(2)+w.read_shift(2)+w.read_shift(2)&&(b.mt=d(w,w.l-8)),b.start=w.read_shift(4,"i"),b.size=w.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(h=b.start,i>0&&h!==v&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(n,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==v&&b.start!==v&&t[h]&&(b.content=l(b,t[h].data,(t[a]||{}).data))),b.content&&CMe(b.content,0),o[c]=b,s.push(b)}}(o,E,R,T,r,{},k,s),function(e,t,n){for(var r=0,i=0,o=0,s=0,a=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;a<u.length;++a)i=e[r=u[a]].L,o=e[r].R,s=e[r].C,c[r]===r&&(-1!==i&&c[i]!==i&&(c[r]=c[i]),-1!==o&&c[o]!==o&&(c[r]=c[o])),-1!==s&&(c[s]=r),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<a&&u.push(i)),-1!==o&&r!=c[r]&&(c[o]=c[r],u.lastIndexOf(o)<a&&u.push(o));for(r=1;r<l;++r)c[r]===r&&(-1!==o&&c[o]!==o?c[r]=c[o]:-1!==i&&c[i]!==i&&(c[r]=c[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((a=r)!=c[a])do{a=c[a],t[r]=t[a]+"/"+t[r]}while(0!==a&&-1!==c[a]&&a!=c[a]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(k,M,T),T.shift();var P={FileIndex:k,FullPaths:M};return t&&t.raw&&(P.raw={header:b,sectors:R}),P}function l(e,t,n){for(var r=e.start,i=e.size,o=[],s=r;n&&i>0&&s>=0;)o.push(t.slice(s*m,s*m+m)),i-=m,s=hMe(n,4*s);return 0===o.length?SMe(0):eEe(o).slice(0,e.size)}function c(e,t,n,r,i){var o=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],a=(r>>>2)-1;if(!s)return;for(var l=0;l<a&&(o=hMe(s,4*l))!==v;++l)i.push(o);c(hMe(s,r-4),t-1,n,r,i)}}function u(e,t,n,r,i){var o=[],s=[];i||(i=[]);var a=r-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,o[o.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=hMe(e[u],c)}return{nodes:o,data:Wke([s])}}function d(e,t){return new Date(1e3*(dMe(e,t+4)/1e7*Math.pow(2,32)+dMe(e,t)/1e7-11644473600))}function h(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="\x01Sh33tJ5";if(QEe.find(e,"/"+t))return;var n=SMe(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),p(e)}(e)}function p(e,t){h(e);for(var i=!1,o=!1,s=e.FullPaths.length-1;s>=0;--s){var a=e.FileIndex[s];switch(a.type){case 0:o?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(a.R*a.L*a.C)&&(i=!0),a.R>-1&&a.L>-1&&a.R==a.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var p=n(d[s][0]);(o=u[p])||(d.push([p,{name:r(p).replace("/",""),type:1,clsid:C,ct:l,mt:l,content:null}]),u[p]=!0)}for(d.sort(function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,o=0,s=Math.min(n.length,r.length);i<s;++i){if(o=n[i].length-r[i].length)return o;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var g=e.FileIndex[s],f=e.FullPaths[s];if(g.name=r(f).replace("/",""),g.L=g.R=g.C=-(g.color=1),g.size=g.content?g.content.length:0,g.start=0,g.clsid=g.clsid||C,0===s)g.C=d.length>1?1:-1,g.size=0,g.type=5;else if("/"==f.slice(-1)){for(c=s+1;c<d.length&&n(e.FullPaths[c])!=f;++c);for(g.C=c>=d.length?-1:c,c=s+1;c<d.length&&n(e.FullPaths[c])!=n(f);++c);g.R=c>=d.length?-1:c,g.type=1}else n(e.FullPaths[s+1]||"")==n(f)&&(g.R=s+1),g.type=2}}}function g(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],o=e.FullPaths[0],s=o,a=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(o.length),(a=e.FileIndex[l]).size&&a.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=a.content,u=URe&&Buffer.isBuffer(c)?c.toString("binary"):S(c),d=0,h=Math.min(1024,u.length),p=0,g=0;g<=h;++g)(p=u.charCodeAt(g))>=32&&p<128&&++d;var f=d>=4*h/5;i.push(r),i.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),i.push("Content-Transfer-Encoding: "+(f?"quoted-printable":"base64")),i.push("Content-Type: "+se(a,s)),i.push(""),i.push(f?le(u):ae(u))}return i.push(r+"--\r\n"),i.join("\r\n")}(e,n);if(p(e),"zip"===n.fileType)return function(e,t){var n=t||{},r=[],o=[],s=SMe(1),a=n.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,p=e.FullPaths[0],g=p,f=e.FileIndex[0],m=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(g=e.FullPaths[c].slice(p.length),(f=e.FileIndex[c]).size&&f.content&&"\x01Sh33tJ5"!=g){var w=d,b=SMe(g.length);for(u=0;u<g.length;++u)b.write_shift(1,127&g.charCodeAt(u));b=b.slice(0,b.l),m[h]=XEe.buf(f.content,0);var C=f.content;8==a&&(C=x(C)),(s=SMe(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,a),f.mt?i(s,f.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:m[h]),s.write_shift(4,8&l?0:C.length),s.write_shift(4,8&l?0:f.content.length),s.write_shift(2,b.length),s.write_shift(2,0),d+=s.length,r.push(s),d+=b.length,r.push(b),d+=C.length,r.push(C),8&l&&((s=SMe(12)).write_shift(-4,m[h]),s.write_shift(4,C.length),s.write_shift(4,f.content.length),d+=s.l,r.push(s)),(s=SMe(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(-4,m[h]),s.write_shift(4,C.length),s.write_shift(4,f.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,w),v+=s.l,o.push(s),v+=b.length,o.push(b),++h}return s=SMe(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,d),s.write_shift(2,0),eEe([eEe(r),eEe(o),s])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var o=i.content.length;o>0&&(o<4096?t+=o+63>>6:n+=o+511>>9)}}for(var s=e.FullPaths.length+3>>2,a=t+127>>7,l=(t+7>>3)+n+s+a,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,a,s,n,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),o=SMe(r[7]<<9),s=0,a=0;for(s=0;s<8;++s)o.write_shift(1,b[s]);for(s=0;s<8;++s)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),s=0;s<3;++s)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,r[2]),o.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),o.write_shift(4,r[3]),o.write_shift(-4,r[1]?r[0]-1:v),o.write_shift(4,r[1]),s=0;s<109;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(a=0;a<r[1];++a){for(;s<236+127*a;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);o.write_shift(-4,a===r[1]-1?v:a+1)}var l=function(e){for(a+=e;s<a-1;++s)o.write_shift(-4,s+1);e&&(++s,o.write_shift(-4,v))};for(a=s=0,a+=r[1];s<a;++s)o.write_shift(-4,y.DIFSECT);for(a+=r[2];s<a;++s)o.write_shift(-4,y.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=a,l(u+511>>9)));for(l(r[6]+7>>3);511&o.l;)o.write_shift(-4,y.ENDOFCHAIN);for(a=s=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=a,l(u+63>>6)));for(;511&o.l;)o.write_shift(-4,y.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:v);var g=0===s&&n.root||d.name;if(u=2*(g.length+1),o.write_shift(64,g,"utf16le"),o.write_shift(2,u),o.write_shift(1,d.type),o.write_shift(1,d.color),o.write_shift(-4,d.L),o.write_shift(-4,d.R),o.write_shift(-4,d.C),d.clsid)o.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)o.write_shift(4,0);o.write_shift(4,d.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,d.start),o.write_shift(4,d.size),o.write_shift(4,0)}else{for(c=0;c<17;++c)o.write_shift(4,0);for(c=0;c<3;++c)o.write_shift(4,-1);for(c=0;c<12;++c)o.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(o.l=d.start+1<<9,URe&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;511&c;++c)o.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(URe&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;63&c;++c)o.write_shift(1,0)}if(URe)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.1";var f,m=64,v=-2,w="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],C="00000000000000000000000000000000",y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:w,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:C,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function S(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function x(e){return f?f.deflateRawSync(e):Y(e)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function k(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var M="undefined"!==typeof Uint8Array,P=M?new Uint8Array(256):[],I=0;I<256;++I)P[I]=k(I);function A(e,t){var n=P[255&e];return t<=8?n>>>8-t:(n=n<<8|P[e>>8&255],t<=16?n>>>16-t:(n=n<<8|P[e>>16&255])>>>24-t)}function D(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function F(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function O(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function N(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function L(e,t,n){var r=7&t,i=t>>>3,o=(1<<n)-1,s=e[i]>>>r;return n<8-r?s&o:(s|=e[i+1]<<8-r,n<16-r?s&o:(s|=e[i+2]<<16-r,n<24-r?s&o:(s|=e[i+3]<<24-r)&o))}function _(e,t,n){var r=7&t,i=t>>>3;return r<=5?e[i]|=(7&n)<<r:(e[i]|=n<<r&255,e[i+1]=(7&n)>>8-r),t+3}function H(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function V(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function B(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function W(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(URe){var o=qRe(r);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(M){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;i<n;++i)s[i]=e[i];return s}return e.length=r,e}function z(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function j(e,t,n){var r=1,i=0,o=0,s=0,a=0,l=e.length,c=M?new Uint16Array(32):z(32);for(o=0;o<32;++o)c[o]=0;for(o=l;o<n;++o)e[o]=0;l=e.length;var u=M?new Uint16Array(l):z(l);for(o=0;o<l;++o)c[i=e[o]]++,r<i&&(r=i),u[o]=0;for(c[0]=0,o=1;o<=r;++o)c[o+16]=a=a+c[o-1]<<1;for(o=0;o<l;++o)0!=(a=e[o])&&(u[o]=c[a+16]++);var d=0;for(o=0;o<l;++o)if(0!=(d=e[o]))for(a=A(u[o],r)>>r-d,s=(1<<r+4-d)-1;s>=0;--s)t[a|s<<d]=15&d|o<<4;return r}var G=M?new Uint16Array(512):z(512),$=M?new Uint16Array(32):z(32);if(!M){for(var U=0;U<512;++U)G[U]=0;for(U=0;U<32;++U)$[U]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);j(e,$,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);j(n,G,288)}();var K=function(){for(var e=M?new Uint8Array(32768):[],t=0,n=0;t<T.length-1;++t)for(;n<T[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=M?new Uint8Array(259):[];for(t=0,n=0;t<E.length-1;++t)for(;n<E[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t.write_shift(1,+i),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var i=0,o=0,s=M?new Uint16Array(32768):[];o<t.length;){var a=Math.min(65535,t.length-o);if(a<10){for(7&(i=_(n,i,+!(o+a!=t.length)))&&(i+=8-(7&i)),n.l=i/8|0,n.write_shift(2,a),n.write_shift(2,65535&~a);a-- >0;)n[n.l++]=t[o++];i=8*n.l}else{i=_(n,i,+!(o+a!=t.length)+2);for(var l=0;a-- >0;){var c=t[o],u=-1,d=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&o)>o&&(u-=32768),u<o))for(;t[u+d]==t[o+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?i=V(n,i,P[c+1]>>1)-1:(V(n,i,3),V(n,i+=5,P[c-23]>>5),i+=3);var h=c<8?0:c-4>>2;h>0&&(B(n,i,d-E[c]),i+=h),c=e[o-u],i=V(n,i,P[c]>>3),i-=3;var p=c<4?0:c-2>>1;p>0&&(B(n,i,o-u-T[c]),i+=p);for(var g=0;g<d;++g)s[l]=32767&o,l=32767&(l<<5^t[o]),++o;a-=d-1}else c<=143?c+=48:i=H(n,i,1),i=V(n,i,P[c]),s[l]=32767&o,++o}i=V(n,i,0)-1}}return n.l=(i+7)/8|0,n.l}(t,n)}}();function Y(e){var t=SMe(50+Math.floor(1.1*e.length)),n=K(e,t);return t.slice(0,n)}var q=M?new Uint16Array(32768):z(32768),X=M?new Uint16Array(32768):z(32768),Q=M?new Uint16Array(128):z(128),J=1,Z=1;function ee(e,t){var n=O(e,t)+257,r=O(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var o=0,s=M?new Uint8Array(19):z(19),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=M?new Uint8Array(8):z(8),u=M?new Uint8Array(8):z(8),d=s.length,h=0;h<i;++h)s[R[h]]=o=F(e,t),l<o&&(l=o),c[o]++,t+=3;var p=0;for(c[0]=0,h=1;h<=l;++h)u[h]=p=p+c[h-1]<<1;for(h=0;h<d;++h)0!=(p=s[h])&&(a[h]=u[p]++);var g=0;for(h=0;h<d;++h)if(0!=(g=s[h])){p=P[a[h]]>>8-g;for(var f=(1<<7-g)-1;f>=0;--f)Q[p|f<<g]=7&g|h<<3}var m=[];for(l=1;m.length<n+r;)switch(t+=7&(p=Q[N(e,t)]),p>>>=3){case 16:for(o=3+D(e,t),t+=2,p=m[m.length-1];o-- >0;)m.push(p);break;case 17:for(o=3+F(e,t),t+=3;o-- >0;)m.push(0);break;case 18:for(o=11+N(e,t),t+=7;o-- >0;)m.push(0);break;default:m.push(p),l<p&&(l=p)}var v=m.slice(0,n),w=m.slice(n);for(h=n;h<286;++h)v[h]=0;for(h=r;h<30;++h)w[h]=0;return J=j(v,q,286),Z=j(w,X,30),t}function te(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[YRe(t),2];for(var n=0,r=0,i=qRe(t||1<<18),o=0,s=i.length>>>0,a=0,l=0;0==(1&r);)if(r=F(e,n),n+=3,r>>>1!=0)for(r>>1==1?(a=9,l=5):(n=ee(e,n),a=J,l=Z);;){!t&&s<o+32767&&(s=(i=W(i,o+32767)).length);var c=L(e,n,a),u=r>>>1==1?G[c]:q[c];if(n+=15&u,0===((u>>>=4)>>>8&255))i[o++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=o+E[u];d>0&&(h+=L(e,n,d),n+=d),c=L(e,n,l),n+=15&(u=r>>>1==1?$[c]:X[c]);var p=(u>>>=4)<4?0:u-2>>1,g=T[u];for(p>0&&(g+=L(e,n,p),n+=p),!t&&s<h&&(s=(i=W(i,h+100)).length);o<h;)i[o]=i[o-g],++o}}else{7&n&&(n+=8-(7&n));var f=e[n>>>3]|e[(n>>>3)+1]<<8;if(n+=32,f>0)for(!t&&s<o+f&&(s=(i=W(i,o+f)).length);f-- >0;)i[o++]=e[n>>>3],n+=8}return t?[i,n+7>>>3]:[i.slice(0,o),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function ne(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var n=e;CMe(n,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var a=n.read_shift(4);for(n.l=a,i=0;i<s;++i){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),d=n.read_shift(2),p=n.read_shift(2);n.l+=8;var g=n.read_shift(4),f=o(n.slice(n.l+u,n.l+u+d));n.l+=u+d+p;var m=n.l;n.l=g+4,ie(n,l,c,r,f),n.l=m}return r}function ie(e,t,n,r,i){e.l+=2;var s=e.read_shift(2),a=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,i=31&n,o=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(o-1),r.setDate(i);var s=31&t,a=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(a),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),p="",g=0;g<d;++g)p+=String.fromCharCode(e[e.l++]);if(h){var m=o(e.slice(e.l,e.l+h));(m[21589]||{}).mt&&(l=m[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(a){case 8:v=function(e,t){if(!f)return te(e,t);var n=new(0,f.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+a)}var w=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),w=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ne(w,"Bad compressed size: "+t+" != "+c),u!=n&&ne(w,"Bad uncompressed size: "+n+" != "+u),ue(r,p,v,{unsafe:!0,mt:l})}var oe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&oe[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&oe[r[1]]?oe[r[1]]:"application/octet-stream"}function ae(e){for(var t=GRe(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<r.length;++i){var o=r[i];if(0!=o.length)for(var s=0;s<o.length;){var a=76,l=o.slice(s,s+a);"="==l.charAt(a-1)?a--:"="==l.charAt(a-2)?a-=2:"="==l.charAt(a-3)&&(a-=3),l=o.slice(s,s+a),(s+=a)<o.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ce(e,t,n){for(var r,i="",o="",s="",a=0;a<10;++a){var l=t[a];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++a,o.toLowerCase()){case"base64":r=XRe($Re(t.slice(a).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return XRe(t.join("\r\n"))}(t.slice(a));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var u=ue(e,i.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,n,i){var o=i&&i.unsafe;o||h(e);var s=!o&&QEe.find(e,t);if(!s){var a=e.FullPaths[0];t.slice(0,a.length)==a?a=t:("/"!=a.slice(-1)&&(a+="/"),a=(a+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(a),o||QEe.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map(function(e){return e.toUpperCase()}),r=n.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var o=t.toUpperCase(),s=!0===i?n.indexOf(o):r.indexOf(o);if(-1!==s)return e.FileIndex[s];var a=!o.match(nEe);for(o=o.replace(tEe,""),a&&(o=o.replace(nEe,"!")),s=0;s<n.length;++s){if((a?n[s].replace(nEe,"!"):n[s]).replace(tEe,"")==o)return e.FileIndex[s];if((a?r[s].replace(nEe,"!"):r[s]).replace(tEe,"")==o)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||URe&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),a(e.readFileSync(t),n)}(t,n);case"base64":return a(XRe($Re(t)),n);case"binary":return a(XRe(t),n)}return a(t,n)},t.parse=a,t.write=function(t,n){var r=g(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:S(r);case"base64":return GRe("string"==typeof r?r:S(r));case"buffer":if(URe)return Buffer.isBuffer(r)?r:KRe(r);case"array":return"string"==typeof r?XRe(r):r}return r},t.writeFile=function(t,n,r){s();var i=g(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var n=QEe.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){h(e);var i=QEe.find(e,t);if(i)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==i)return e.FileIndex[o].name=r(n),e.FullPaths[o]=n,!0;return!1},cfb_gc:function(e){p(e,!0)},ReadShift:gMe,CheckField:bMe,prep_blob:CMe,bconcat:eEe,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");f=e}catch(n){console.error("cannot use native zlib: "+(n.message||n))}},_deflateRaw:Y,_inflateRaw:te,consts:y},t}();let JEe;function ZEe(e){return"string"===typeof e?QRe(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function eTe(e,t,n){if("undefined"!==typeof JEe&&JEe.writeFileSync)return n?JEe.writeFileSync(e,t,n):JEe.writeFileSync(e,t);if("undefined"!==typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=QRe(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?oke(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var i=new Blob([ZEe(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!==typeof saveAs)return saveAs(i,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=JRe(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function tTe(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function nTe(e,t){for(var n=[],r=tTe(e),i=0;i!==r.length;++i)null==n[e[r[i]][t]]&&(n[e[r[i]][t]]=r[i]);return n}function rTe(e){for(var t=[],n=tTe(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function iTe(e){for(var t=[],n=tTe(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}var oTe=new Date(1899,11,30,0,0,0);function sTe(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(oTe.getTime()+6e4*(e.getTimezoneOffset()-oTe.getTimezoneOffset())))/864e5}var aTe=new Date,lTe=oTe.getTime()+6e4*(aTe.getTimezoneOffset()-oTe.getTimezoneOffset()),cTe=aTe.getTimezoneOffset();function uTe(e){var t=new Date;return t.setTime(24*e*60*60*1e3+lTe),t.getTimezoneOffset()!==cTe&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-cTe)),t}function dTe(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(n=1,o>3&&(r=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");n*=60}t+=n*parseInt(i[o],10)}return t}var hTe=new Date("2017-02-19T19:06:09.000Z"),pTe=isNaN(hTe.getFullYear())?new Date("2/19/17"):hTe,gTe=2017==pTe.getFullYear();function fTe(e,t){var n=new Date(e);if(gTe)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==pTe.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function mTe(e,t){if(URe&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return oke(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return oke(HRe(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return oke(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return oke(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(e){return n[e]||e})}catch(o){}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function vTe(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=vTe(e[n]));return t}function wTe(e,t){for(var n="";n.length<t;)n+=e;return n}function bTe(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,t){return n=-n,t}),isNaN(t=Number(r))?t:t/n):t/n}var CTe=["january","february","march","april","may","june","july","august","september","october","november","december"];function yTe(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==CTe.indexOf(s))return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||o>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?n:t}var STe=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,r){if(e||"string"==typeof n)return t.split(n);for(var i=t.split(n),o=[i[0]],s=1;s<i.length;++s)o.push(r),o.push(i[s]);return o}}();function xTe(e){return e?e.content&&e.type?mTe(e.content,!0):e.data?BRe(e.data):e.asNodeBuffer&&URe?BRe(e.asNodeBuffer().toString("binary")):e.asBinary?BRe(e.asBinary()):e._data&&e._data.getContent?BRe(mTe(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function RTe(e){if(!e)return null;if(e.data)return _Re(e.data);if(e.asNodeBuffer&&URe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?_Re(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ETe(e,t){for(var n=e.FullPaths||tTe(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),o=0;o<n.length;++o){var s=n[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||i==s)return e.files?e.files[n[o]]:e.FileIndex[o]}return null}function TTe(e,t){var n=ETe(e,t);if(null==n)throw new Error("Cannot find file "+t+" in zip");return n}function kTe(e,t,n){if(!n)return(r=TTe(e,t))&&".bin"===r.name.slice(-4)?RTe(r):xTe(r);var r;if(!t)return null;try{return kTe(e,t)}catch(i){return null}}function MTe(e,t,n){if(!n)return xTe(TTe(e,t));if(!t)return null;try{return MTe(e,t)}catch(r){return null}}function PTe(e,t,n){if(!n)return RTe(TTe(e,t));if(!t)return null;try{return PTe(e,t)}catch(r){return null}}function ITe(e){for(var t=e.FullPaths||tTe(e.files),n=[],r=0;r<t.length;++r)"/"!=t[r].slice(-1)&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function ATe(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=URe?KRe(n):function(e){for(var t=[],n=0,r=e.length+250,i=YRe(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)i[n++]=s;else if(s<2048)i[n++]=192|s>>6&31,i[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var a=1023&e.charCodeAt(++o);i[n++]=240|s>>8&7,i[n++]=128|s>>2&63,i[n++]=128|a>>6&15|(3&s)<<4,i[n++]=128|63&a}else i[n++]=224|s>>12&15,i[n++]=128|s>>6&63,i[n++]=128|63&s;n>r&&(t.push(i.slice(0,n)),n=0,i=YRe(65535),r=65530)}return t.push(i.slice(0,n)),eEe(t)}(n),QEe.utils.cfb_add(e,t,r);QEe.utils.cfb_add(e,t,n)}else e.file(t,n)}function DTe(){return QEe.utils.cfb_new()}function FTe(e,t){switch(t.type){case"base64":return QEe.read(e,{type:"base64"});case"binary":return QEe.read(e,{type:"binary"});case"buffer":case"array":return QEe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function OTe(e,t){if("/"==e.charAt(0))return e.slice(1);var n=t.split("/");"/"!=t.slice(-1)&&n.pop();for(var r=e.split("/");0!==r.length;){var i=r.shift();".."===i?n.pop():"."!==i&&n.push(i)}return n.join("/")}var NTe='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',LTe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,_Te=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,HTe=NTe.match(_Te)?_Te:/<[^>]*>/g,VTe=/<\w*:/,BTe=/<(\/?)\w+:/;function WTe(e,t,n){for(var r={},i=0,o=0;i!==e.length&&(32!==(o=e.charCodeAt(i))&&10!==o&&13!==o);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var s=e.match(LTe),a=0,l="",c=0,u="",d="",h=1;if(s)for(c=0;c!=s.length;++c){for(d=s[c],o=0;o!=d.length&&61!==d.charCodeAt(o);++o);for(u=d.slice(0,o).trim();32==d.charCodeAt(o+1);)++o;for(h=34==(i=d.charCodeAt(o+1))||39==i?1:0,l=d.slice(o+1+h,d.length-h),a=0;a!=u.length&&58!==u.charCodeAt(a);++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var p=(5===a&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(a+1);if(r[p]&&"ext"==u.slice(a-3,a))continue;r[p]=l,n||(r[p.toLowerCase()]=l)}}return r}function zTe(e){return e.replace(BTe,"<$1")}var jTe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},GTe=rTe(jTe),$Te=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function n(r){var i=r+"",o=i.indexOf("<![CDATA[");if(-1==o)return i.replace(e,function(e,t){return jTe[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var s=i.indexOf("]]>");return n(i.slice(0,o))+i.slice(o+9,s)+n(i.slice(s+3))}}(),UTe=/[&<>'"]/g,KTe=/[\u0000-\u0008\u000b-\u001f]/g;function YTe(e){return(e+"").replace(UTe,function(e){return GTe[e]}).replace(KTe,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qTe(e){return YTe(e).replace(/ /g,"_x0020_")}var XTe=/[\u0000-\u001f]/g;function QTe(e){return(e+"").replace(UTe,function(e){return GTe[e]}).replace(/\n/g,"<br/>").replace(XTe,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var JTe=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(n){return n.replace(e,t)}}();function ZTe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function eke(e){for(var t="",n=0,r=0,i=0,o=0,s=0,a=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&i,t+=String.fromCharCode(s)):(o=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o):(a=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t}function tke(e){var t,n,r,i=YRe(2*e.length),o=1,s=0,a=0;for(n=0;n<e.length;n+=o)o=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),o=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),o=3):(o=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),a=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==a&&(i[s++]=255&a,i[s++]=a>>>8,a=0),i[s++]=t%256,i[s++]=t>>>8;return i.slice(0,s).toString("ucs2")}function nke(e){return KRe(e,"binary").toString("utf8")}var rke="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",ike=URe&&(nke(rke)==eke(rke)&&nke||tke(rke)==eke(rke)&&tke)||eke,oke=URe?function(e){return KRe(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},ske=function(){var e={};return function(t,n){var r=t+"|"+(n||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),ake=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),lke=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),cke=/<\/?(?:vt:)?variant>/g,uke=/<(?:vt:)([^>]*)>([\s\S]*)</;function dke(e,t){var n=WTe(e),r=e.match(lke(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(e){var t=e.replace(cke,"").match(uke);t&&i.push({v:ike(t[2]),t:t[1]})}),i}var hke=/(^\s|\s$|\n)/;function pke(e,t){return"<"+e+(t.match(hke)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function gke(e){return tTe(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function fke(e,t,n){return"<"+e+(null!=n?gke(n):"")+(null!=t?(t.match(hke)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mke(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function vke(e){if(URe&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return ike(JRe(ZRe(e)));throw new Error("Bad input format: expected Buffer or string")}var wke=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,bke="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Cke="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",yke="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Ske="http://schemas.openxmlformats.org/package/2006/content-types",xke="http://schemas.openxmlformats.org/package/2006/relationships",Rke="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Eke="http://purl.org/dc/elements/1.1/",Tke="http://purl.org/dc/terms/",kke="http://purl.org/dc/dcmitype/",Mke="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Pke="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Ike="http://www.w3.org/2001/XMLSchema-instance",Ake="http://www.w3.org/2001/XMLSchema",Dke=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fke="urn:schemas-microsoft-com:office:office",Oke="urn:schemas-microsoft-com:office:excel",Nke="urn:schemas-microsoft-com:office:spreadsheet",Lke="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",_ke="http://macVmlSchemaUri",Hke="urn:schemas-microsoft-com:vml",Vke="http://www.w3.org/TR/REC-html40";var Bke=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},Wke=URe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:KRe(e)})):Bke(e)}:Bke,zke=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(cMe(e,i)));return r.join("").replace(tEe,"")},jke=URe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(tEe,""):zke(e,t,n)}:zke,Gke=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},$ke=URe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):Gke(e,t,n)}:Gke,Uke=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(lMe(e,i)));return r.join("")},Kke=URe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):Uke(e,t,n)}:Uke,Yke=function(e,t){var n=dMe(e,t);return n>0?Kke(e,t+4,t+4+n-1):""},qke=Yke,Xke=function(e,t){var n=dMe(e,t);return n>0?Kke(e,t+4,t+4+n-1):""},Qke=Xke,Jke=function(e,t){var n=2*dMe(e,t);return n>0?Kke(e,t+4,t+4+n-1):""},Zke=Jke,eMe=function(e,t){var n=dMe(e,t);return n>0?jke(e,t+4,t+4+n):""},tMe=eMe,nMe=function(e,t){var n=dMe(e,t);return n>0?Kke(e,t+4,t+4+n):""},rMe=nMe,iMe=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],o=5;o>=0;--o)i=256*i+e[t+o];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)},oMe=iMe,sMe=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function aMe(){jke=function(e,t,n){return VRe.utils.decode(1200,e.slice(t,n)).replace(tEe,"")},Kke=function(e,t,n){return VRe.utils.decode(65001,e.slice(t,n))},qke=function(e,t){var n=dMe(e,t);return n>0?VRe.utils.decode(ARe,e.slice(t+4,t+4+n-1)):""},Qke=function(e,t){var n=dMe(e,t);return n>0?VRe.utils.decode(IRe,e.slice(t+4,t+4+n-1)):""},Zke=function(e,t){var n=2*dMe(e,t);return n>0?VRe.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},tMe=function(e,t){var n=dMe(e,t);return n>0?VRe.utils.decode(1200,e.slice(t+4,t+4+n)):""},rMe=function(e,t){var n=dMe(e,t);return n>0?VRe.utils.decode(65001,e.slice(t+4,t+4+n)):""}}URe&&(qke=function(e,t){if(!Buffer.isBuffer(e))return Yke(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Qke=function(e,t){if(!Buffer.isBuffer(e))return Xke(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Zke=function(e,t){if(!Buffer.isBuffer(e))return Jke(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},tMe=function(e,t){if(!Buffer.isBuffer(e))return eMe(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},rMe=function(e,t){if(!Buffer.isBuffer(e))return nMe(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},oMe=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):iMe(e,t)},sMe=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof VRe&&aMe();var lMe=function(e,t){return e[t]},cMe=function(e,t){return 256*e[t+1]+e[t]},uMe=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},dMe=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},hMe=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},pMe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function gMe(e,t){var n,r,i,o,s,a,l="",c=[];switch(t){case"dbcs":if(a=this.l,URe&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(cMe(this,a)),a+=2;e*=2;break;case"utf8":l=Kke(this,this.l,this.l+e);break;case"utf16le":e*=2,l=jke(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof VRe)return gMe.call(this,e,"dbcs");l=VRe.utils.decode(IRe,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=qke(this,this.l),e=4+dMe(this,this.l);break;case"lpstr-cp":l=Qke(this,this.l),e=4+dMe(this,this.l);break;case"lpwstr":l=Zke(this,this.l),e=4+2*dMe(this,this.l);break;case"lpp4":e=4+dMe(this,this.l),l=tMe(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+dMe(this,this.l),l=rMe(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=lMe(this,this.l+e++));)c.push(WRe(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=cMe(this,this.l+e));)c.push(WRe(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",a=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=lMe(this,a),this.l=a+1,o=gMe.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(WRe(cMe(this,a))),a+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof VRe){l=VRe.utils.decode(IRe,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=lMe(this,a),this.l=a+1,o=gMe.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(WRe(lMe(this,a))),a+=1}l=c.join("");break;default:switch(e){case 1:return n=lMe(this,this.l),this.l++,n;case 2:return n=("i"===t?uMe:cMe)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(n=(e>0?hMe:pMe)(this,this.l),this.l+=4,n):(r=dMe(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?oMe(this,this.l):oMe([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=$ke(this,this.l,e)}}return this.l+=e,l}var fMe=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},mMe=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},vMe=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function wMe(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)vMe(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n){if("undefined"!==typeof VRe&&874==ARe)for(i=0;i!=t.length;++i){var o=VRe.utils.encode(ARe,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,fMe(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,s=r?-t:t;isFinite(s)?0==s?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var a=0;a<=5;++a,o/=256)e[n+a]=255&o;e[n+6]=(15&i)<<4|15&o,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,mMe(this,t,this.l)}}return this.l+=r,this}function bMe(e,t){var n=$ke(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function CMe(e,t){e.l=t,e.read_shift=gMe,e.chk=bMe,e.write_shift=wMe}function yMe(e,t){e.l+=t}function SMe(e){var t=YRe(e);return CMe(t,0),t}function xMe(e,t,n){if(e){var r,i,o;CMe(e,e.l||0);for(var s=e.length,a=0,l=0;e.l<s;){128&(a=e.read_shift(1))&&(a=(127&a)+((127&e.read_shift(1))<<7));var c=ANe[a]||ANe[65535];for(o=127&(r=e.read_shift(1)),i=1;i<4&&128&r;++i)o+=(127&(r=e.read_shift(1)))<<7*i;l=e.l+o;var u=c.f&&c.f(e,o,n);if(e.l=l,t(u,c,a))return}}}function RMe(){var e=[],t=URe?256:2048,n=function(e){var t=SMe(e);return CMe(t,0),t},r=n(t),i=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},o=function(e){return r&&e<r.length-r.l?r:(i(),r=n(Math.max(e+1,t)))};return{next:o,push:function(e){i(),null==(r=e).l&&(r.l=r.length),o(t)},end:function(){return i(),eEe(e)},_bufs:e}}function EMe(e,t,n,r){var i,o=+t;if(!isNaN(o)){r||(r=ANe[o].p||(n||[]).length||0),i=1+(o>=128?1:0)+1,r>=128&&++i,r>=16384&&++i,r>=2097152&&++i;var s=e.next(i);o<=127?s.write_shift(1,o):(s.write_shift(1,128+(127&o)),s.write_shift(1,o>>7));for(var a=0;4!=a;++a){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&sMe(n)&&e.push(n)}}function TMe(e,t,n){var r=vTe(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function kMe(e,t,n){var r=vTe(e);return r.s=TMe(r.s,t.s,n),r.e=TMe(r.e,t.s,n),r}function MMe(e,t){if(e.cRel&&e.c<0)for(e=vTe(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=vTe(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=NMe(e);return e.cRel||null==e.cRel||(n=n.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(n=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(n)),n}function PMe(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?MMe(e.s,t.biff)+":"+MMe(e.e,t.biff):(e.s.rRel?"":"$")+AMe(e.s.r)+":"+(e.e.rRel?"":"$")+AMe(e.e.r):(e.s.cRel?"":"$")+FMe(e.s.c)+":"+(e.e.cRel?"":"$")+FMe(e.e.c)}function IMe(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function AMe(e){return""+(e+1)}function DMe(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function FMe(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function OMe(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function NMe(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function LMe(e){var t=e.indexOf(":");return-1==t?{s:OMe(e),e:OMe(e)}:{s:OMe(e.slice(0,t)),e:OMe(e.slice(t+1))}}function _Me(e,t){return"undefined"===typeof t||"number"===typeof t?_Me(e.s,e.e):("string"!==typeof e&&(e=NMe(e)),"string"!==typeof t&&(t=NMe(t)),e==t?e:e+":"+t)}function HMe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length;for(n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===o||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function VMe(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=GEe(e.z,n?sTe(t):t)}catch(r){}try{return e.w=GEe((e.XF||{}).numFmtId||(n?14:0),n?sTe(t):t)}catch(r){return""+t}}function BMe(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?EPe[e.v]||e.v:VMe(e,void 0==t?e.v:t))}function WMe(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function zMe(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense;var o=e||(i?[]:{}),s=0,a=0;if(o&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?OMe(r.origin):r.origin;s=l.r,a=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=HMe(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var p={v:t[d][h]},g=s+d,f=a+h;if(c.s.r>g&&(c.s.r=g),c.s.c>f&&(c.s.c=f),c.e.r<g&&(c.e.r=g),c.e.c<f&&(c.e.c=f),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),null===p.v)if(p.f)p.t="n";else if(r.nullError)p.t="e",p.v=0;else{if(!r.sheetStubs)continue;p.t="z"}else"number"===typeof p.v?p.t="n":"boolean"===typeof p.v?p.t="b":p.v instanceof Date?(p.z=r.dateNF||hEe[14],r.cellDates?(p.t="d",p.w=GEe(p.z,sTe(p.v))):(p.t="n",p.v=sTe(p.v),p.w=GEe(p.z,p.v))):p.t="s";else p=t[d][h];if(i)o[g]||(o[g]=[]),o[g][f]&&o[g][f].z&&(p.z=o[g][f].z),o[g][f]=p;else{var m=NMe({c:f,r:g});o[m]&&o[m].z&&(p.z=o[m].z),o[m]=p}}}return c.s.c<1e7&&(o["!ref"]=_Me(c)),o}function jMe(e,t){return zMe(null,e,t)}function GMe(e,t){return t||(t=SMe(4)),t.write_shift(4,e),t}function $Me(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function UMe(e,t){var n=!1;return null==t&&(n=!0,t=SMe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function KMe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YMe(e,t){var n=e.l,r=e.read_shift(1),i=$Me(e),o=[],s={t:i,h:i};if(0!==(1&r)){for(var a=e.read_shift(4),l=0;l!=a;++l)o.push(KMe(e));s.r=o}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}var qMe=YMe;function XMe(e,t){var n=!1;return null==t&&(n=!0,t=SMe(23+4*e.t.length)),t.write_shift(1,1),UMe(e.t,t),t.write_shift(4,1),function(e,t){t||(t=SMe(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function QMe(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function JMe(e,t){return null==t&&(t=SMe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ZMe(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ePe(e,t){return null==t&&(t=SMe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var tPe=$Me,nPe=UMe;function rPe(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function iPe(e,t){var n=!1;return null==t&&(n=!0,t=SMe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var oPe=$Me,sPe=rPe,aPe=iPe;function lPe(e){var t=e.slice(e.l,e.l+4),n=1&t[0],r=2&t[0];e.l+=4;var i=0===r?oMe([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):hMe(t,0)>>2;return n?i/100:i}function cPe(e,t){null==t&&(t=SMe(4));var n=0,r=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((n?i:e)<<2)+(n+2))}function uPe(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var dPe=uPe,hPe=function(e,t){return t||(t=SMe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function pPe(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gPe(e,t){return(t||SMe(8)).write_shift(8,e,"f")}function fPe(e,t){if(t||(t=SMe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function mPe(e,t){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var vPe=80,wPe=[vPe,81],bPe={1:{n:"CodePage",t:2},2:{n:"Category",t:vPe},3:{n:"PresentationFormat",t:vPe},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:vPe},15:{n:"Company",t:vPe},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:vPe},27:{n:"ContentStatus",t:vPe},28:{n:"Language",t:vPe},29:{n:"Version",t:vPe},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},CPe={1:{n:"CodePage",t:2},2:{n:"Title",t:vPe},3:{n:"Subject",t:vPe},4:{n:"Author",t:vPe},5:{n:"Keywords",t:vPe},6:{n:"Comments",t:vPe},7:{n:"Template",t:vPe},8:{n:"LastAuthor",t:vPe},9:{n:"RevNumber",t:vPe},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:vPe},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},yPe={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},SPe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xPe(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var RPe=vTe(xPe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),EPe={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},TPe={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},kPe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},MPe={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function PPe(e,t){var n,r=function(e){for(var t=[],n=tTe(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(kPe),i=[];i[i.length]=NTe,i[i.length]=fke("Types",null,{xmlns:Ske,"xmlns:xsd":Ake,"xmlns:xsi":Ike}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(e){return fke("Default",null,{Extension:e[0],ContentType:e[1]})}));var o=function(r){e[r]&&e[r].length>0&&(n=e[r][0],i[i.length]=fke("Override",null,{PartName:("/"==n[0]?"":"/")+n,ContentType:MPe[r][t.bookType]||MPe[r].xlsx}))},s=function(n){(e[n]||[]).forEach(function(e){i[i.length]=fke("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:MPe[n][t.bookType]||MPe[n].xlsx})})},a=function(t){(e[t]||[]).forEach(function(e){i[i.length]=fke("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})})};return o("workbooks"),s("sheets"),s("charts"),a("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),s("metadata"),a("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var IPe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function APe(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function DPe(e,t){var n={"!id":{}};if(!e)return n;"/"!==t.charAt(0)&&(t="/"+t);var r={};return(e.match(HTe)||[]).forEach(function(e){var i=WTe(e);if("<Relationship"===i[0]){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var s="External"===i.TargetMode?i.Target:OTe(i.Target,t);n[s]=o,r[i.Id]=o}}),n["!id"]=r,n}function FPe(e){var t=[NTe,fke("Relationships",null,{xmlns:xke})];return tTe(e["!id"]).forEach(function(n){t[t.length]=fke("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function OPe(e,t,n,r,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,o?i.TargetMode=o:[IPe.HLINK,IPe.XPATH,IPe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function NPe(e,t,n){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function LPe(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function _Pe(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+PRe.version+"</meta:generator></office:meta></office:document-meta>"}var HPe=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],VPe=function(){for(var e=new Array(HPe.length),t=0;t<HPe.length;++t){var n=HPe[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function BPe(e){var t={};e=ike(e);for(var n=0;n<HPe.length;++n){var r=HPe[n],i=e.match(VPe[n]);null!=i&&i.length>0&&(t[r[1]]=$Te(i[1])),"date"===r[2]&&t[r[1]]&&(t[r[1]]=fTe(t[r[1]]))}return t}function WPe(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=YTe(t),r[r.length]=n?fke(e,t,n):pke(e,t))}function zPe(e,t){var n=t||{},r=[NTe,fke("cp:coreProperties",null,{"xmlns:cp":bke,"xmlns:dc":Eke,"xmlns:dcterms":Tke,"xmlns:dcmitype":kke,"xmlns:xsi":Ike})],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&WPe("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:mke(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&WPe("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:mke(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=HPe.length;++o){var s=HPe[o],a=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&WPe(s[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var jPe=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],GPe=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $Pe(e,t,n,r){var i=[];if("string"==typeof e)i=dke(e,r);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(e){return{v:e}}));var s="string"==typeof t?dke(t,r).map(function(e){return e.v}):t,a=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=s.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":n.NamedRanges=l,n.DefinedNames=s.slice(a,a+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=s.slice(a,a+l)}a+=l}}function UPe(e){var t=[],n=fke;return e||(e={}),e.Application="SheetJS",t[t.length]=NTe,t[t.length]=fke("Properties",null,{xmlns:yke,"xmlns:vt":Pke}),jPe.forEach(function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=YTe(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(e){return"<vt:lpstr>"+YTe(e)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var KPe=/<[^>]+>[^<]*/g;function YPe(e){var t=[NTe,fke("Properties",null,{xmlns:Cke,"xmlns:vt":Pke})];if(!e)return t.join("");var n=1;return tTe(e).forEach(function(r){++n,t[t.length]=fke("property",function(e,t){switch(typeof e){case"string":var n=fke("vt:lpwstr",YTe(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return fke((0|e)==e?"vt:i4":"vt:r8",YTe(String(e)));case"boolean":return fke("vt:bool",e?"true":"false")}if(e instanceof Date)return fke("vt:filetime",mke(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:YTe(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var qPe,XPe={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function QPe(e,t,n){qPe||(qPe=rTe(XPe)),e[t=qPe[t]||t]=n}function JPe(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date(1e3*(n/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function ZPe(e,t,n){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function eIe(e,t,n){var r=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(r.length+1&3)&3),r}function tIe(e,t,n){return 31===t?eIe(e):ZPe(e,0,n)}function nIe(e,t,n){return tIe(e,t,!1===n?0:4)}function rIe(e){var t=e.l,n=sIe(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[n,sIe(e,3)]}function iIe(e,t){for(var n=e.read_shift(4),r={},i=0;i!=n;++i){var o=e.read_shift(4),s=e.read_shift(4);r[o]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(tEe,"").replace(nEe,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function oIe(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),n}function sIe(e,t,n){var r,i=e.read_shift(2),o=n||{};if(e.l+=2,12!==t&&i!==t&&-1===wPe.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&i)))throw new Error("Expected type "+t+" saw "+i);switch(12===t?i:t){case 2:return r=e.read_shift(2,"i"),o.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return ZPe(e,0,4).replace(tEe,"");case 31:return eIe(e);case 64:return JPe(e);case 65:return oIe(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return nIe(e,i,!o.raw).replace(tEe,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return tIe(e,t,0)}(e,i).replace(tEe,"");case 4108:return function(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(rIe(e));return n}(e);case 4126:case 4127:return 4127==i?function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var i=e.l;n[r]=e.read_shift(0,"lpwstr").replace(tEe,""),e.l-i&2&&(e.l+=2)}return n}(e):function(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(tEe,"");return n}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function aIe(e,t){var n=SMe(4),r=SMe(4);switch(n.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=SMe(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),r=(t-n)/Math.pow(2,32);r*=1e7;var i=(n*=1e7)/Math.pow(2,32)|0;i>0&&(n%=Math.pow(2,32),r+=i);var o=SMe(8);return o.write_shift(4,n),o.write_shift(4,r),o}(t);break;case 31:case 80:for((r=SMe(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return eEe([n,r])}function lIe(e,t){var n=e.l,r=e.read_shift(4),i=e.read_shift(4),o=[],s=0,a=0,l=-1,c={};for(s=0;s!=i;++s){var u=e.read_shift(4),d=e.read_shift(4);o[s]=[u,d+n]}o.sort(function(e,t){return e[1]-t[1]});var h={};for(s=0;s!=i;++s){if(e.l!==o[s][1]){var p=!0;if(s>0&&t)switch(t[o[s-1][0]].t){case 2:e.l+2===o[s][1]&&(e.l+=2,p=!1);break;case 80:case 4108:e.l<=o[s][1]&&(e.l=o[s][1],p=!1)}if((!t||0==s)&&e.l<=o[s][1]&&(p=!1,e.l=o[s][1]),p)throw new Error("Read Error: Expected address "+o[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[o[s][0]];if(h[g.n]=sIe(e,g.t,{raw:!0}),"version"===g.p&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(65535&h[g.n])).slice(-4)),"CodePage"==g.n)switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:NRe(a=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(1===o[s][0]){if(a=h.CodePage=sIe(e,2),NRe(a),-1!==l){var f=e.l;e.l=o[l][1],c=iIe(e,a),e.l=f}}else if(0===o[s][0]){if(0===a){l=s,e.l=o[s+1][1];continue}c=iIe(e,a)}else{var m,v=c[o[s][0]];switch(e[e.l]){case 65:e.l+=4,m=oIe(e);break;case 30:case 31:e.l+=4,m=nIe(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=fIe(e,4);break;case 64:e.l+=4,m=fTe(JPe(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=m}}return e.l=n+r,h}var cIe=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uIe(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function dIe(e,t,n){var r=SMe(8),i=[],o=[],s=8,a=0,l=SMe(8),c=SMe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),s+=8+l.length,!t){(c=SMe(8)).write_shift(4,0),i.unshift(c);var u=[SMe(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var d=e[a][0];for((l=SMe(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,a+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=eEe(u),o.unshift(l),s+=8+l.length}for(a=0;a<e.length;++a)if((!t||t[e[a][0]])&&!(cIe.indexOf(e[a][0])>-1||GPe.indexOf(e[a][0])>-1)&&null!=e[a][1]){var h=e[a][1],p=0;if(t){var g=n[p=+t[e[a][0]]];if("version"==g.p&&"string"==typeof h){var f=h.split(".");h=(+f[0]<<16)+(+f[1]||0)}l=aIe(g.t,h)}else{var m=uIe(h);-1==m&&(m=31,h=String(h)),l=aIe(m,h)}o.push(l),(c=SMe(8)).write_shift(4,t?p:2+a),i.push(c),s+=8+l.length}var v=8*(o.length+1);for(a=0;a<o.length;++a)i[a].write_shift(4,v),v+=o[a].length;return r.write_shift(4,s),r.write_shift(4,o.length),eEe([r].concat(i).concat(o))}function hIe(e,t,n){var r=e.content;if(!r)return{};CMe(r,0);var i,o,s,a,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==QEe.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(1!==(i=r.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(o=r.read_shift(16),a=r.read_shift(4),1===i&&a!==r.l)throw new Error("Length mismatch: "+a+" !== "+r.l);2===i&&(s=r.read_shift(16),l=r.read_shift(4));var d,h=lIe(r,t),p={SystemIdentifier:c};for(var g in h)p[g]=h[g];if(p.FMTID=o,1===i)return p;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{d=lIe(r,null)}catch(f){}for(g in d)p[g]=d[g];return p.FMTID=[o,s],p}function pIe(e,t,n,r,i,o){var s=SMe(i?68:48),a=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,QEe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=dIe(e,n,r);if(a.push(l),i){var c=dIe(i,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+l.length),a.push(c)}return eEe(a)}function gIe(e,t){return e.read_shift(t),null}function fIe(e,t){return 1===e.read_shift(t)}function mIe(e,t){return t||(t=SMe(2)),t.write_shift(2,+!!e),t}function vIe(e){return e.read_shift(2,"u")}function wIe(e,t){return t||(t=SMe(2)),t.write_shift(2,e),t}function bIe(e,t){return function(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}(e,t,vIe)}function CIe(e,t,n){return n||(n=SMe(2)),n.write_shift(1,"e"==t?+e:+!!e),n.write_shift(1,"e"==t?1:0),n}function yIe(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont",o=IRe;(n&&n.biff>=8&&(IRe=1200),n&&8!=n.biff)?12==n.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");n.biff>=2&&n.biff<=5&&(i="cpstr");var s=r?e.read_shift(r,i):"";return IRe=o,s}function SIe(e){var t=IRe;IRe=1200;var n,r=e.read_shift(2),i=e.read_shift(1),o=4&i,s=8&i,a=1+(1&i),l=0,c={};s&&(l=e.read_shift(2)),o&&(n=e.read_shift(4));var u=2==a?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,u);return s&&(e.l+=4*l),o&&(e.l+=n),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),IRe=t,c}function xIe(e){var t=e.t||"",n=SMe(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=SMe(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),eEe([n,r])}function RIe(e,t,n){if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function EIe(e,t,n){var r=e.read_shift(n&&2==n.biff?1:2);return 0===r?(e.l++,""):RIe(e,r,n)}function TIe(e,t,n){if(n.biff>5)return EIe(e,0,n);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function kIe(e,t,n){return n||(n=SMe(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function MIe(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=n);var i=e.read_shift((r?t-24:t)>>1,"utf16le").replace(tEe,"");return r&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return n+r.replace(/\\/g,"/");var i=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return n+e.read_shift(i>>1,"utf16le").replace(tEe,"")}(e);default:throw new Error("Unsupported Moniker "+n)}}function PIe(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(tEe,""):""}function IIe(e,t){t||(t=SMe(6+2*e.length)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function AIe(e){var t=SMe(512),n=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3}t.write_shift(4,2),t.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(28==o)IIe(r=r.slice(1),t);else if(2&o){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var a=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));t.write_shift(2,0),8&o&&IIe(i>-1?r.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,255&r.charCodeAt(n+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function DIe(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function FIe(e,t){var n=DIe(e);return n[3]=0,n}function OIe(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function NIe(e,t,n,r){return r||(r=SMe(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function LIe(e,t,n){var r=n.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function _Ie(e){return[e.read_shift(2),lPe(e)]}function HIe(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:n}}}function VIe(e,t){return t||(t=SMe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function BIe(e){var t=e.read_shift(2),n=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:n}}}var WIe=BIe;function zIe(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function jIe(e){e.l+=2,e.l+=e.read_shift(2)}var GIe={0:jIe,4:jIe,5:jIe,6:jIe,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:jIe,9:jIe,10:jIe,11:jIe,12:jIe,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:jIe,15:jIe,16:jIe,17:jIe,18:jIe,19:jIe,20:jIe,21:zIe};function $Ie(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),(t-=2)>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function UIe(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":case"xla":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;default:throw new Error("unsupported BIFF version")}var o=SMe(i);return o.write_shift(2,r),o.write_shift(2,t),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function KIe(e,t){var n=!t||t.biff>=8?2:1,r=SMe(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function YIe(e,t,n){var r=0;n&&2==n.biff||(r=e.read_shift(2));var i=e.read_shift(2);return n&&2==n.biff&&(r=1-(i>>15),i&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},i]}function qIe(e,t,n,r){var i=n&&5==n.biff;r||(r=SMe(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return null==o.l&&(o.l=o.length),o}var XIe=TIe;function QIe(e,t,n){var r=e.l+t,i=8!=n.biff&&n.biff?2:4,o=e.read_shift(i),s=e.read_shift(i),a=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:o,c:a},e:{r:s,c:l}}}function JIe(e,t,n,r){var i=n&&5==n.biff;r||(r=SMe(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function ZIe(e,t,n){var r=OIe(e);2!=n.biff&&9!=t||++e.l;var i=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return r.val=i,r.t=!0===i||!1===i?"b":"e",r}var eAe=function(e,t,n){return 0===t?"":TIe(e,0,n)};function tAe(e,t,n){var r,i=e.read_shift(2),o={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===n.sbcch&&(r=function(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=yIe(e,0,n),o=e.read_shift(2);if(o!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,i}(e,t-2,n)),o.body=r||e.read_shift(t-2),"string"===typeof r&&(o.Name=r),o}var nAe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rAe(e,t,n){var r=e.l+t,i=e.read_shift(2),o=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(n&&2==n.biff?1:2),l=0;(!n||n.biff>=5)&&(5!=n.biff&&(e.l+=2),l=e.read_shift(2),5==n.biff&&(e.l+=2),e.l+=4);var c=RIe(e,s,n);32&i&&(c=nAe[c.charCodeAt(0)]);var u=r-e.l;n&&2==n.biff&&--u;var d=r!=e.l&&0!==a&&u>0?function(e,t,n,r){var i,o=e.l+t,s=wFe(e,r,n);o!==e.l&&(i=vFe(e,o-e.l,s,n));return[s,i]}(e,u,n,a):[];return{chKey:o,Name:c,itab:l,rgce:d}}function iAe(e,t,n){if(n.biff<8)return function(e,t,n){3==e[e.l+1]&&e[e.l]++;var r=yIe(e,0,n);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,n);for(var r=[],i=e.l+t,o=e.read_shift(n.biff>8?4:2);0!==o--;)r.push(LIe(e,n.biff,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function oAe(e,t,n){var r=WIe(e,6);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,RFe(e,t,n)]}var sAe={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:r}}};function aAe(e){var t=SMe(24),n=OMe(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return eEe([t,AIe(e[1])])}function lAe(e){var t=e[1].Tooltip,n=SMe(10+2*(t.length+1));n.write_shift(2,2048);var r=OMe(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function cAe(e,t,n){if(!n.cellStyles)return yMe(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:i,e:o,w:s,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}var uAe=OIe,dAe=bIe,hAe=EIe;var pAe=[2,3,48,49,131,139,140,245],gAe=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rTe({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(t,n){var r=n||{};r.dateNF||(r.dateNF="yyyymmdd");var i=jMe(function(t,n){var r=[],i=YRe(1);switch(n.type){case"base64":i=XRe($Re(t));break;case"binary":i=XRe(t);break;case"buffer":case"array":i=t}CMe(i,0);var o=i.read_shift(1),s=!!(136&o),a=!1,l=!1;switch(o){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:a=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+o.toString(16))}var c=0,u=521;2==o&&(c=i.read_shift(2)),i.l+=3,2!=o&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=o&&(u=i.read_shift(2));var d=i.read_shift(2),h=n.codepage||1252;2!=o&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(h=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var p=[],g={},f=Math.min(i.length,2==o?521:u-10-(a?264:0)),m=l?32:11;i.l<f&&13!=i[i.l];)switch((g={}).name=VRe.utils.decode(h,i.slice(i.l,i.l+m)).replace(/[\u0000\r\n].*$/g,""),i.l+=m,g.type=String.fromCharCode(i.read_shift(1)),2==o||l||(g.offset=i.read_shift(4)),g.len=i.read_shift(1),2==o&&(g.offset=i.read_shift(2)),g.dec=i.read_shift(1),g.name.length&&p.push(g),2!=o&&(i.l+=l?13:14),g.type){case"B":a&&8==g.len||!n.WTF||console.log("Skipping "+g.name+":"+g.type);break;case"G":case"P":n.WTF&&console.log("Skipping "+g.name+":"+g.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+g.type)}if(13!==i[i.l]&&(i.l=u-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u;var v=0,w=0;for(r[0]=[],w=0;w!=p.length;++w)r[0][w]=p[w].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,r[++v]=[],w=0,w=0;w!=p.length;++w){var b=i.slice(i.l,i.l+p[w].len);i.l+=p[w].len,CMe(b,0);var C=VRe.utils.decode(h,b);switch(p[w].type){case"C":C.trim().length&&(r[v][w]=C.replace(/\s+$/,""));break;case"D":8===C.length?r[v][w]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):r[v][w]=C;break;case"F":r[v][w]=parseFloat(C.trim());break;case"+":case"I":r[v][w]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":r[v][w]=!0;break;case"N":case"F":r[v][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+o.toString(16));r[v][w]="##MEMO##"+(l?parseInt(C.trim(),10):b.read_shift(4));break;case"N":(C=C.replace(/\u0000/g,"").trim())&&"."!=C&&(r[v][w]=+C||0);break;case"@":r[v][w]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":r[v][w]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":r[v][w]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][w]=-b.read_shift(-8,"f");break;case"B":if(a&&8==p[w].len){r[v][w]=b.read_shift(8,"f");break}case"G":case"P":b.l+=p[w].len;break;case"0":if("_NullFlags"===p[w].name)break;default:throw new Error("DBF Unsupported data type "+p[w].type)}}else i.l+=d;if(2!=o&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return n&&n.sheetRows&&(r=r.slice(0,n.sheetRows)),n.DBF=p,r}(t,r),r);return i["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,i}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return WMe(n(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function(e,n){var i=n||{};if(+i.codepage>=0&&NRe(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var o=RMe(),s=ZLe(e,{header:1,raw:!0,cellDates:!0}),a=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,p=1;for(u=0;u<a.length;++u)if(((c[u]||{}).DBF||{}).name)a[u]=c[u].DBF.name,++h;else if(null!=a[u]){if(++h,"number"===typeof a[u]&&(a[u]=a[u].toString(10)),"string"!==typeof a[u])throw new Error("DBF Invalid column name "+a[u]+" |"+typeof a[u]+"|");if(a.indexOf(a[u])!==u)for(d=0;d<1024;++d)if(-1==a.indexOf(a[u]+"_"+d)){a[u]+="_"+d;break}}var g=HMe(e["!ref"]),f=[],m=[],v=[];for(u=0;u<=g.e.c-g.s.c;++u){var w="",b="",C=0,y=[];for(d=0;d<l.length;++d)null!=l[d][u]&&y.push(l[d][u]);if(0!=y.length&&null!=a[u]){for(d=0;d<y.length;++d){switch(typeof y[d]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=y[d]instanceof Date?"D":"C"}C=Math.max(C,String(y[d]).length),w=w&&w!=b?"C":b}C>250&&(C=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>C&&(C=c[u].DBF.len),"B"==w&&"N"==b&&(w="N",v[u]=c[u].DBF.dec,C=c[u].DBF.len),m[u]="C"==w||"N"==b?C:r[w]||0,p+=m[u],f[u]=w}else f[u]="?"}var S=o.next(32);for(S.write_shift(4,318902576),S.write_shift(4,l.length),S.write_shift(2,296+32*h),S.write_shift(2,p),u=0;u<4;++u)S.write_shift(4,0);for(S.write_shift(4,(+t[ARe]||3)<<8),u=0,d=0;u<a.length;++u)if(null!=a[u]){var x=o.next(32),R=(a[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);x.write_shift(1,R,"sbcs"),x.write_shift(1,"?"==f[u]?"C":f[u],"sbcs"),x.write_shift(4,d),x.write_shift(1,m[u]||r[f[u]]||0),x.write_shift(1,v[u]||0),x.write_shift(1,2),x.write_shift(4,0),x.write_shift(1,0),x.write_shift(4,0),x.write_shift(4,0),d+=m[u]||r[f[u]]||0}var E=o.next(264);for(E.write_shift(4,13),u=0;u<65;++u)E.write_shift(4,0);for(u=0;u<l.length;++u){var T=o.next(p);for(T.write_shift(1,0),d=0;d<a.length;++d)if(null!=a[d])switch(f[d]){case"L":T.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":T.write_shift(8,l[u][d]||0,"f");break;case"N":var k="0";for("number"==typeof l[u][d]&&(k=l[u][d].toFixed(v[d]||0)),h=0;h<m[d]-k.length;++h)T.write_shift(1,32);T.write_shift(1,k,"sbcs");break;case"D":l[u][d]?(T.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var M=String(null!=l[u][d]?l[u][d]:"").slice(0,m[d]);for(T.write_shift(1,M,"sbcs"),h=0;h<m[d]-M.length;++h)T.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),fAe=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+tTe(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(t,n){var r=e[n];return"number"==typeof r?zRe(r):r},r=function(e,t,n){var r=t.charCodeAt(0)-32<<4|n.charCodeAt(0)-48;return 59==r?e:zRe(r)};function i(e,i){var o,s=e.split(/[\n\r]+/),a=-1,l=-1,c=0,u=0,d=[],h=[],p=null,g={},f=[],m=[],v=[],w=0;for(+i.codepage>=0&&NRe(+i.codepage);c!==s.length;++c){w=0;var b,C=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),y=C.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),S=y[0];if(C.length>0)switch(S){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==y[1].charAt(0)&&h.push(C.slice(3).replace(/;;/g,";"));break;case"C":var x=!1,R=!1,E=!1,T=!1,k=-1,M=-1;for(u=1;u<y.length;++u)switch(y[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(y[u].slice(1))-1,R=!0;break;case"Y":for(a=parseInt(y[u].slice(1))-1,R||(l=0),o=d.length;o<=a;++o)d[o]=[];break;case"K":'"'===(b=y[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(bTe(b))?isNaN(yTe(b).getDate())||(b=fTe(b)):(b=bTe(b),null!==p&&BEe(p)&&(b=uTe(b))),"undefined"!==typeof VRe&&"string"==typeof b&&"string"!=(i||{}).type&&(i||{}).codepage&&(b=VRe.utils.decode(i.codepage,b)),x=!0;break;case"E":T=!0;var P=UDe(y[u].slice(1),{r:a,c:l});d[a][l]=[d[a][l],P];break;case"S":E=!0,d[a][l]=[d[a][l],"S5S"];break;case"R":k=parseInt(y[u].slice(1))-1;break;case"C":M=parseInt(y[u].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+C)}if(x&&(d[a][l]&&2==d[a][l].length?d[a][l][0]=b:d[a][l]=b,p=null),E){if(T)throw new Error("SYLK shared formula cannot have own formula");var I=k>-1&&d[k][M];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");d[a][l][1]=qDe(I[1],{r:a-k,c:l-M})}break;case"F":var A=0;for(u=1;u<y.length;++u)switch(y[u].charAt(0)){case"X":l=parseInt(y[u].slice(1))-1,++A;break;case"Y":for(a=parseInt(y[u].slice(1))-1,o=d.length;o<=a;++o)d[o]=[];break;case"M":w=parseInt(y[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":p=h[parseInt(y[u].slice(1))];break;case"W":for(v=y[u].slice(1).split(" "),o=parseInt(v[0],10);o<=parseInt(v[1],10);++o)w=parseInt(v[2],10),m[o-1]=0===w?{hidden:!0}:{wch:w},tDe(m[o-1]);break;case"C":m[l=parseInt(y[u].slice(1))-1]||(m[l]={});break;case"R":f[a=parseInt(y[u].slice(1))-1]||(f[a]={}),w>0?(f[a].hpt=w,f[a].hpx=iDe(w)):0===w&&(f[a].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+C)}A<1&&(p=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+C)}}return f.length>0&&(g["!rows"]=f),m.length>0&&(g["!cols"]=m),i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),[d,g]}function o(e,t){var n=function(e,t){switch(t.type){case"base64":return i($Re(e),t);case"binary":return i(e,t);case"buffer":return i(URe&&Buffer.isBuffer(e)?e.toString("binary"):JRe(e),t);case"array":return i(mTe(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=n[0],o=n[1],s=jMe(r,t);return tTe(o).forEach(function(e){s[e]=o[e]}),s}function s(e,t,n,r){var i="C;Y"+(n+1)+";X"+(r+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+YDe(e.f,{r:n,c:r}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return WMe(o(e,t),t)},to_sheet:o,from_sheet:function(e,t){var n,r,i=["ID;PWXL;N;E"],o=[],a=HMe(e["!ref"]),l=Array.isArray(e),c="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=i,e["!cols"].forEach(function(e,t){var n="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?n+="0":("number"!=typeof e.width||e.wpx||(e.wpx=XAe(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=QAe(e.wpx)),"number"==typeof e.wch&&(n+=Math.round(e.wch)))," "!=n.charAt(n.length-1)&&r.push(n)})),e["!rows"]&&function(e,t){t.forEach(function(t,n){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*rDe(t.hpx)+";"),r.length>2&&e.push(r+"R"+(n+1))})}(i,e["!rows"]),i.push("B;Y"+(a.e.r-a.s.r+1)+";X"+(a.e.c-a.s.c+1)+";D"+[a.s.c,a.s.r,a.e.c,a.e.r].join(" "));for(var u=a.s.r;u<=a.e.r;++u)for(var d=a.s.c;d<=a.e.c;++d){var h=NMe({r:u,c:d});(n=l?(e[u]||[])[d]:e[h])&&(null!=n.v||n.f&&!n.F)&&o.push(s(n,0,u,d))}return i.join(c)+c+o.join(c)+c+"E"+c}}}(),mAe=function(){function e(e,t){for(var n=e.split("\n"),r=-1,i=-1,o=0,s=[];o!==n.length;++o)if("BOT"!==n[o].trim()){if(!(r<0)){for(var a=n[o].trim().split(","),l=a[0],c=a[1],u=n[++o]||"";1&(u.match(/["]/g)||[]).length&&o<n.length-1;)u+="\n"+n[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][i]=!0:"FALSE"===u?s[r][i]=!1:isNaN(bTe(c))?isNaN(yTe(c).getDate())?s[r][i]=c:s[r][i]=fTe(c):s[r][i]=bTe(c),++i;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][i++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],i=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,n){return jMe(function(t,n){switch(n.type){case"base64":return e($Re(t),n);case"binary":return e(t,n);case"buffer":return e(URe&&Buffer.isBuffer(t)?t.toString("binary"):JRe(t),n);case"array":return e(mTe(t),n)}throw new Error("Unrecognized type "+n.type)}(t,n),n)}var n=function(){var e=function(e,t,n,r,i){e.push(t),e.push(n+","+r),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,n,r){e.push(t+","+n),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(n){var r,i=[],o=HMe(n["!ref"]),s=Array.isArray(n);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,o.e.r-o.s.r+1,""),e(i,"TUPLES",0,o.e.c-o.s.c+1,""),e(i,"DATA",0,0,"");for(var a=o.s.r;a<=o.e.r;++a){t(i,-1,0,"BOT");for(var l=o.s.c;l<=o.e.c;++l){var c=NMe({r:a,c:l});if(r=s?(n[a]||[])[l]:n[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(i,1,0,"="+r.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=GEe(r.z||hEe[14],sTe(fTe(r.v)))),t(i,0,r.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}();return{to_workbook:function(e,n){return WMe(t(e,n),n)},to_sheet:t,from_sheet:n}}(),vAe=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(t,n){return jMe(function(t,n){for(var r=t.split("\n"),i=-1,o=-1,s=0,a=[];s!==r.length;++s){var l=r[s].trim().split(":");if("cell"===l[0]){var c=OMe(l[1]);if(a.length<=c.r)for(i=a.length;i<=c.r;++i)a[i]||(a[i]=[]);switch(i=c.r,o=c.c,l[2]){case"t":a[i][o]=e(l[3]);break;case"v":a[i][o]=+l[3];break;case"vtf":var u=l[l.length-1];case"vtc":"nl"===l[3]?a[i][o]=!!+l[4]:a[i][o]=+l[4],"vtf"==l[2]&&(a[i][o]=[a[i][o],u])}}}return n&&n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,n),n)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),s="--SocialCalcSpreadsheetControlSave--";function a(e){if(!e||!e["!ref"])return"";for(var n,r=[],i=[],o="",s=LMe(e["!ref"]),a=Array.isArray(e),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(o=NMe({r:l,c:c}),(n=a?(e[l]||[])[c]:e[o])&&null!=n.v&&"z"!==n.t){switch(i=["cell",o,"t"],n.t){case"s":case"str":i.push(t(n.v));break;case"n":n.f?(i[2]="vtf",i[3]="n",i[4]=n.v,i[5]=t(n.f)):(i[2]="v",i[3]=n.v);break;case"b":i[2]="vt"+(n.f?"f":"c"),i[3]="nl",i[4]=n.v?"1":"0",i[5]=t(n.f||(n.v?"TRUE":"FALSE"));break;case"d":var u=sTe(fTe(n.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=n.w||GEe(n.z||hEe[14],u);break;case"e":continue}r.push(i.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,t){return WMe(n(e,t),t)},to_sheet:n,from_sheet:function(e){return[r,i,o,i,a(e),s].join("\n")}}}(),wAe=function(){function e(e,t,n,r,i){i.raw?t[n][r]=e:""===e||("TRUE"===e?t[n][r]=!0:"FALSE"===e?t[n][r]=!1:isNaN(bTe(e))?isNaN(yTe(e).getDate())?t[n][r]=e:t[n][r]=fTe(e):t[n][r]=bTe(e))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(e){for(var r={},i=!1,o=0,s=0;o<e.length;++o)34==(s=e.charCodeAt(o))?i=!i:!i&&s in t&&(r[s]=(r[s]||0)+1);for(o in s=[],r)Object.prototype.hasOwnProperty.call(r,o)&&s.push([r[o],o]);if(!s.length)for(o in r=n)Object.prototype.hasOwnProperty.call(r,o)&&s.push([r[o],o]);return s.sort(function(e,t){return e[0]-t[0]||n[e[1]]-n[t[1]]}),t[s.pop()[1]]||44}function i(e,t){var n=t||{},i="";var o=n.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=r(e.slice(0,1024)):i=n&&n.FS?n.FS:r(e.slice(0,1024));var a=0,l=0,c=0,u=0,d=0,h=i.charCodeAt(0),p=!1,g=0,f=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=n.dateNF?function(e){var t="number"==typeof e?hEe[e]:e;return t=t.replace(qEe,"(\\d+)"),new RegExp("^"+t+"$")}(n.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(n.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=bTe(t)))if(!isNaN(yTe(t).getDate())||m&&t.match(m)){r.z=n.dateNF||hEe[14];var i=0;m&&t.match(m)&&(t=function(e,t,n){var r=-1,i=-1,o=-1,s=-1,a=-1,l=-1;(t.match(qEe)||[]).forEach(function(e,t){var c=parseInt(n[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":o=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?a=c:i=c}}),l>=0&&-1==a&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==a&&-1==l?c:-1==r&&-1==i&&-1==o?u:c+"T"+u}(0,n.dateNF,t.match(m)||[]),i=1),n.cellDates?(r.t="d",r.v=fTe(t,i)):(r.t="n",r.v=sTe(fTe(t,i))),!1!==n.cellText&&(r.w=GEe(r.z,r.v instanceof Date?sTe(r.v):r.v)),n.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==n.cellText&&(r.w=t),r.v=c;if("z"==r.t||(n.dense?(o[a]||(o[a]=[]),o[a][l]=r):o[NMe({c:l,r:a})]=r),u=d+1,f=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<a&&(s.e.r=a),g==h)++l;else if(l=0,++a,n.sheetRows&&n.sheetRows<=a)return!0}e:for(;d<e.length;++d)switch(g=e.charCodeAt(d)){case 34:34===f&&(p=!p);break;case h:case 10:case 13:if(!p&&v())break e}return d-u>0&&v(),o["!ref"]=_Me(s),o}function o(t,n){return n&&n.PRN?n.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,n):jMe(function(t,n){var r=n||{},i=[];if(!t||0===t.length)return i;for(var o=t.split(/[\r\n]/),s=o.length-1;s>=0&&0===o[s].length;)--s;for(var a=10,l=0,c=0;c<=s;++c)-1==(l=o[c].indexOf(" "))?l=o[c].length:l++,a=Math.max(a,l);for(c=0;c<=s;++c){i[c]=[];var u=0;for(e(o[c].slice(0,a).trim(),i,c,u,r),u=1;u<=(o[c].length-a)/10+1;++u)e(o[c].slice(a+10*(u-1),a+10*u).trim(),i,c,u,r)}return r.sheetRows&&(i=i.slice(0,r.sheetRows)),i}(t,n),n):i(t,n)}function s(e,t){var n="",r="string"==t.type?[0,0,0,0]:zLe(e,t);switch(t.type){case"base64":n=$Re(e);break;case"binary":case"string":n=e;break;case"buffer":n=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof VRe?VRe.utils.decode(t.codepage,e):URe&&Buffer.isBuffer(e)?e.toString("binary"):JRe(e);break;case"array":n=mTe(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?n=ike(n.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?n=ike(n):"binary"==t.type&&"undefined"!==typeof VRe&&t.codepage&&(n=VRe.utils.decode(t.codepage,VRe.utils.encode(28591,n))),"socialcalc:version:"==n.slice(0,19)?vAe.to_sheet("string"==t.type?n:ike(n),t):o(n,t)}return{to_workbook:function(e,t){return WMe(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,n=[],r=HMe(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var s=[],a=r.s.c;a<=r.e.c;++a){var l=NMe({r:o,c:a});if((t=i?(e[o]||[])[a]:e[l])&&null!=t.v){for(var c=(t.w||(BMe(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===a?" ":""))}else s.push("          ")}n.push(s.join(""))}return n.join("\n")}}}();var bAe=function(){function e(e,t,n){if(e){CMe(e,e.l||0);for(var r=n.Enum||v;e.l<e.length;){var i=e.read_shift(2),o=r[i]||r[65535],s=e.read_shift(2),a=e.l+s,l=o.f&&o.f(e,s,n);if(e.l=a,t(l,o,i))return}}}function t(t,n){if(!t)return t;var r=n||{};var i=r.dense?[]:{},o="Sheet1",s="",a=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,function(e,t,n){switch(n){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==n&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||hEe[14],r.cellDates&&(e[1].t="d",e[1].v=uTe(e[1].v))),r.qpro&&e[3]>a&&(i["!ref"]=_Me(d),l[o]=i,c.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],o=s||"Sheet"+(a+1),s="");var u=r.dense?(i[e[0].r]||[])[e[0].c]:i[NMe(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[NMe(e[0])]=e[1]}},r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=w,14==t[2]&&(r.qpro=!0,t.l=0),e(t,function(e,t,n){switch(n){case 204:o=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>a&&(i["!ref"]=_Me(d),l[o]=i,c.push(o),i=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],o="Sheet"+(a+1)),h>0&&e[0].r>=h)break;r.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[NMe(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==a&&(o=e[1])}},r)}if(i["!ref"]=_Me(d),l[s||o]=i,c.push(s||o),!u.length)return{SheetNames:c,Sheets:l};for(var p={},g=[],f=0;f<u.length;++f)l[c[f]]?(g.push(u[f]||c[f]),p[u[f]]=l[u[f]]||l[c[f]]):(g.push(u[f]),p[u[f]]={"!ref":"A1"});return{SheetNames:g,Sheets:p}}function n(e,t,n){var r=[{c:0,r:0},{t:"n",v:0},0,0];return n.qpro&&20768!=n.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return o[1].v=e.read_shift(s,"utf8"),o}return r.qpro&&e.l++,o[1].v=e.read_shift(i-e.l,"cstr"),o}function i(e,t,n){var r=SMe(7+n.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var i=0;i<r.length;++i){var o=n.charCodeAt(i);r.write_shift(1,o>=128?95:o)}return r.write_shift(1,0),r}function o(e,t,n){var r=SMe(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n,"i"),r}function s(e,t,n){var r=SMe(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,n,"f"),r}function a(e,t,n){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(n?FMe(t):AMe(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,n,r){var i=SMe(6+r.length);i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),i.write_shift(1,39);for(var o=0;o<r.length;++o){var s=r.charCodeAt(o);i.write_shift(1,s>=128?95:s)}return i.write_shift(1,0),i}function h(e,t){var n=u(e),r=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(2);if(65535==o)return 0===r&&3221225472===i?(n[1].t="e",n[1].v=15):0===r&&3489660928===i?(n[1].t="e",n[1].v=42):n[1].v=0,n;var s=32768&o;return o=(32767&o)-16446,n[1].v=(1-2*s)*(i*Math.pow(2,o+32)+r*Math.pow(2,o)),n}function p(e,t,n,r){var i=SMe(14);if(i.write_shift(2,e),i.write_shift(1,n),i.write_shift(1,t),0==r)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var o,s=0,a=0,l=0;return r<0&&(s=1,r=-r),a=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,a-31))>>>0))&&(++a,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,o=(r*=Math.pow(2,32))>>>0,i.write_shift(4,o),i.write_shift(4,l),a+=16383+(s?32768:0),i.write_shift(2,a),i}function g(e,t){var n=u(e),r=e.read_shift(8,"f");return n[1].v=r,n}function f(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var n=SMe(5+e.length);n.write_shift(2,14e3),n.write_shift(2,t);for(var r=0;r<e.length;++r){var i=e.charCodeAt(r);n[n.l++]=i>127?95:i}return n[n.l++]=0,n}var v={0:{n:"BOF",f:vIe},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,n){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&n.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&n.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,r){var i=n(e,0,r);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var i=e.l+t,o=n(e,0,r);if(o[1].v=e.read_shift(8,"f"),r.qpro)e.l=i;else{var s=e.read_shift(2);!function(e,t){CMe(e,0);var n=[],r=0,i="",o="",s="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:n.push(e.read_shift(8,"f"));break;case 1:o=a(t[0].c,e.read_shift(2),!0),i=a(t[0].r,e.read_shift(2),!1),n.push(o+i);break;case 2:var h=a(t[0].c,e.read_shift(2),!0),p=a(t[0].r,e.read_shift(2),!1);o=a(t[0].c,e.read_shift(2),!0),i=a(t[0].r,e.read_shift(2),!1),n.push(h+p+":"+o+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:n.push("("+n.pop()+")");break;case 5:n.push(e.read_shift(2));break;case 6:for(var g="";d=e[e.l++];)g+=String.fromCharCode(d);n.push('"'+g.replace(/"/g,'""')+'"');break;case 8:n.push("-"+n.pop());break;case 23:n.push("+"+n.pop());break;case 22:n.push("NOT("+n.pop()+")");break;case 20:case 21:u=n.pop(),s=n.pop(),n.push(["AND","OR"][d-20]+"("+s+","+u+")");break;default:if(d<32&&c[d])u=n.pop(),s=n.pop(),n.push(s+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>n.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+n.join("|")+"|");var f=n.slice(-r);n.length-=r,n.push(l[d][0]+"("+f.join(",")+")")}}}1==n.length?t[1].f=""+n[0]:console.error("WK1 bad formula parse |"+n.join("|")+"|")}(e.slice(e.l,e.l+s),o),e.l+=s}return o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:f},222:{n:"SHEETNAMELP",f:function(e,t){var n=e[e.l++];n>t-1&&(n=t-1);for(var r="";r.length<n;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},w={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var n=u(e);return n[1].t="s",n[1].v=e.read_shift(t-4,"cstr"),n}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var n=u(e);n[1].v=e.read_shift(2);var r=n[1].v>>1;if(1&n[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return n[1].v=r,n}},25:{n:"FORMULA19",f:function(e,t){var n=h(e);return e.l+=t-14,n}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var n={},r=e.l+t;e.l<r;){var i=e.read_shift(2);if(14e3==i){for(n[i]=[0,""],n[i][0]=e.read_shift(2);e[e.l];)n[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return n}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var n=u(e),r=e.read_shift(4);return n[1].v=r>>6,n}},38:{n:"??"},39:{n:"NUMBER27",f:g},40:{n:"FORMULA28",f:function(e,t){var n=g(e);return e.l+=t-10,n}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:f},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,n){if(n.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var n=t||{};if(+n.codepage>=0&&NRe(+n.codepage),"string"==n.type)throw new Error("Cannot write WK1 to JS string");var r=RMe(),a=HMe(e["!ref"]),l=Array.isArray(e),c=[];FNe(r,0,function(e){var t=SMe(2);return t.write_shift(2,e),t}(1030)),FNe(r,6,function(e){var t=SMe(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(a));for(var u=Math.min(a.e.r,8191),d=a.s.r;d<=u;++d)for(var h=AMe(d),p=a.s.c;p<=a.e.c;++p){d===a.s.r&&(c[p]=FMe(p));var g=c[p]+h,f=l?(e[d]||[])[p]:e[g];if(f&&"z"!=f.t)if("n"==f.t)(0|f.v)==f.v&&f.v>=-32768&&f.v<=32767?FNe(r,13,o(d,p,f.v)):FNe(r,14,s(d,p,f.v));else FNe(r,15,i(d,p,BMe(f).slice(0,239)))}return FNe(r,1),r.end()},book_to_wk3:function(e,t){var n=t||{};if(+n.codepage>=0&&NRe(+n.codepage),"string"==n.type)throw new Error("Cannot write WK3 to JS string");var r=RMe();FNe(r,0,function(e){var t=SMe(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var n=0,r=0,i=0,o=0;o<e.SheetNames.length;++o){var s=e.SheetNames[o],a=e.Sheets[s];if(a&&a["!ref"]){++i;var l=LMe(a["!ref"]);n<l.e.r&&(n=l.e.r),r<l.e.c&&(r=l.e.c)}}n>8191&&(n=8191);return t.write_shift(2,n),t.write_shift(1,i),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,o=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&FNe(r,27,m(e.SheetNames[i],o++));var s=0;for(i=0;i<e.SheetNames.length;++i){var a=e.Sheets[e.SheetNames[i]];if(a&&a["!ref"]){for(var l=HMe(a["!ref"]),c=Array.isArray(a),u=[],h=Math.min(l.e.r,8191),g=l.s.r;g<=h;++g)for(var f=AMe(g),v=l.s.c;v<=l.e.c;++v){g===l.s.r&&(u[v]=FMe(v));var w=u[v]+f,b=c?(a[g]||[])[v]:a[w];if(b&&"z"!=b.t)if("n"==b.t)FNe(r,23,p(g,v,s,b.v));else FNe(r,22,d(g,v,s,BMe(b).slice(0,239)))}++s}}return FNe(r,1),r.end()},to_workbook:function(e,n){switch(n.type){case"base64":return t(XRe($Re(e)),n);case"binary":return t(XRe(e),n);case"buffer":case"array":return t(e,n)}throw"Unsupported type "+n.type}}}();var CAe=function(){var e=ske("t"),t=ske("rPr");function n(n){var r=n.match(e);if(!r)return{t:"s",v:""};var i={t:"s",v:$Te(r[1])},o=n.match(t);return o&&(i.s=function(e){var t={},n=e.match(HTe),r=0,i=!1;if(n)for(;r!=n.length;++r){var o=WTe(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==o.val)break;t.cp=FRe[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return t}(o[1])),i}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(i).map(n).filter(function(e){return e.v})}}(),yAe=function(){var e=/(\r\n|\n)/g;function t(t){var n=[[],t.v,[]];return t.v?(t.s&&function(e,t,n){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),t.push('<span style="'+r.join("")+'">'),e.b&&(t.push("<b>"),n.push("</b>")),e.i&&(t.push("<i>"),n.push("</i>")),e.strike&&(t.push("<s>"),n.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),n.push("</"+i+">")),n.push("</span>")}(t.s,n[0],n[2]),n[0].join("")+n[1].replace(e,"<br/>")+n[2].join("")):""}return function(e){return e.map(t).join("")}}(),SAe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xAe=/<(?:\w+:)?r>/,RAe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function EAe(e,t){var n=!t||t.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=$Te(ike(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=ike(e),n&&(r.h=QTe(r.t))):e.match(xAe)&&(r.r=ike(e),r.t=$Te(ike((e.replace(RAe,"").match(SAe)||[]).join("").replace(HTe,""))),n&&(r.h=yAe(CAe(r.r)))),r):{t:""}}var TAe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kAe=/<(?:\w+:)?(?:si|sstItem)>/g,MAe=/<\/(?:\w+:)?(?:si|sstItem)>/;var PAe=/^\s|\s$|[\t\n\r]/;function IAe(e,t){if(!t.bookSST)return"";var n=[NTe];n[n.length]=fke("sst",null,{xmlns:Dke[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(PAe)&&(o+=' xml:space="preserve"'),o+=">"+YTe(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}var AAe=function(e,t){var n=!1;return null==t&&(n=!0,t=SMe(15+4*e.t.length)),t.write_shift(1,0),UMe(e.t,t),n?t.slice(0,t.l):t};function DAe(e){var t=RMe();EMe(t,159,function(e,t){return t||(t=SMe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var n=0;n<e.length;++n)EMe(t,19,AAe(e[n]));return EMe(t,160),t.end()}function FAe(e){if("undefined"!==typeof VRe)return VRe.utils.encode(ARe,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function OAe(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function NAe(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function LAe(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=OAe(e,4),t.U=OAe(e,4),t.W=OAe(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function _Ae(e,t){var n=e.l+t,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=36==r.Flags;break;case 26625:i=4==r.Flags;break;case 0:i=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function HAe(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function VAe(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:_Ae(e,t),v:HAe(e,e.length-e.l)}}function BAe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function WAe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(HTe,function(e){var n=WTe(e);switch(zTe(n[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){r[e]=n[e]});break;case"<dataIntegrity":r.encryptedHmacKey=n.encryptedHmacKey,r.encryptedHmacValue=n.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=n.uri;break;case"<encryptedKey":r.encs.push(n);break;default:throw n[0]}}),r}function zAe(e){var t,n,r=0,i=FAe(e),o=i.length+1;for((t=YRe(o))[0]=i.length,n=1;n!=o;++n)t[n]=i[n-1];for(n=o-1;n>=0;--n)r=((0===(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var jAe=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,t){return 255&((n=e^t)/2|128*n);var n};return function(i){for(var o,s,a,l=FAe(i),c=function(e){for(var r=t[e.length-1],i=104,o=e.length-1;o>=0;--o)for(var s=e[o],a=0;7!=a;++a)64&s&&(r^=n[i]),s*=2,--i;return r}(l),u=l.length,d=YRe(16),h=0;16!=h;++h)d[h]=0;for(1===(1&u)&&(o=c>>8,d[u]=r(e[0],o),--u,o=255&c,s=l[l.length-1],d[u]=r(s,o));u>0;)o=c>>8,d[--u]=r(l[u],o),o=255&c,d[--u]=r(l[u],o);for(u=15,a=15-l.length;a>0;)o=c>>8,d[u]=r(e[a],o),--a,o=255&c,d[--u]=r(l[u],o),--u,--a;return d}}(),GAe=function(e){var t=0,n=jAe(e);return function(e){var r=function(e,t,n,r,i){var o,s;for(i||(i=t),r||(r=jAe(e)),o=0;o!=t.length;++o)s=t[o],s=255&((s^=r[n])>>5|s<<3),i[o]=s,++n;return[i,n,r]}("",e,t,n);return t=r[1],r[0]}};function $Ae(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var t={},n=t.EncryptionVersionInfo=OAe(e,4);if(1!=n.Major||1!=n.Minor)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):r.Data=function(e,t){var n={},r=n.EncryptionVersionInfo=OAe(e,4);if(t-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=_Ae(e,i),t-=i,n.EncryptionVerifier=HAe(e,t),n}(e,t),r}var UAe=function(){function e(e,n){switch(n.type){case"base64":return t($Re(e),n);case"binary":return t(e,n);case"buffer":return t(URe&&Buffer.isBuffer(e)?e.toString("binary"):JRe(e),n);case"array":return t(mTe(e),n)}throw new Error("Unrecognized type "+n.type)}function t(e,t){var n=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,t){Array.isArray(n)&&(n[t]=[]);for(var r,o=/\\\w+\b/g,s=0,a=-1;r=o.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,o.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++a,l.length){var c={v:l,t:"s"};Array.isArray(n)?n[t][a]=c:n[NMe({r:t,c:a})]=c}}s=o.lastIndex}a>i.e.c&&(i.e.c=a)}),n["!ref"]=_Me(i),n}return{to_workbook:function(t,n){return WMe(e(t,n),n)},to_sheet:e,from_sheet:function(e){for(var t,n=["{\\rtf1\\ansi"],r=HMe(e["!ref"]),i=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){n.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)n.push("\\cellx"+(s+1));for(n.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var a=NMe({r:o,c:s});(t=i?(e[o]||[])[s]:e[a])&&(null!=t.v||t.f&&!t.F)&&(n.push(" "+(t.w||(BMe(t),t.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}}}();function KAe(e){for(var t=0,n=1;3!=t;++t)n=256*n+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function YAe(e,t){if(0===t)return e;var n=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),o=Math.min(t,n,r),s=i-o;if(0===s)return[0,0,t];var a,l=0,c=i+o;switch(a=s/(c>1?2-c:c),i){case t:l=((n-r)/s+6)%6;break;case n:l=(r-t)/s+2;break;case r:l=(t-n)/s+4}return[l/6,a,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return n[2]=t<0?n[2]*(1+t):1-(1-n[2])*(1-t),KAe(function(e){var t,n=e[0],r=e[1],i=e[2],o=2*r*(i<.5?i:1-i),s=i-o/2,a=[s,s,s],l=6*n;if(0!==r)switch(0|l){case 0:case 6:t=o*l,a[0]+=o,a[1]+=t;break;case 1:t=o*(2-l),a[0]+=t,a[1]+=o;break;case 2:t=o*(l-2),a[1]+=o,a[2]+=t;break;case 3:t=o*(4-l),a[1]+=t,a[2]+=o;break;case 4:t=o*(l-4),a[2]+=o,a[0]+=t;break;case 5:t=o*(6-l),a[2]+=t,a[0]+=o}for(var c=0;3!=c;++c)a[c]=Math.round(255*a[c]);return a}(n))}var qAe=6;function XAe(e){return Math.floor((e+Math.round(128/qAe)/256)*qAe)}function QAe(e){return Math.floor((e-5)/qAe*100+.5)/100}function JAe(e){return Math.round((e*qAe+5)/qAe*256)/256}function ZAe(e){return JAe(QAe(XAe(e)))}function eDe(e){var t=Math.abs(e-ZAe(e)),n=qAe;if(t>.005)for(qAe=1;qAe<15;++qAe)Math.abs(e-ZAe(e))<=t&&(t=Math.abs(e-ZAe(e)),n=qAe);qAe=n}function tDe(e){e.width?(e.wpx=XAe(e.width),e.wch=QAe(e.wpx),e.MDW=qAe):e.wpx?(e.wch=QAe(e.wpx),e.width=JAe(e.wch),e.MDW=qAe):"number"==typeof e.wch&&(e.width=JAe(e.wch),e.wpx=XAe(e.width),e.MDW=qAe),e.customWidth&&delete e.customWidth}var nDe=96;function rDe(e){return 96*e/nDe}function iDe(e){return e*nDe/96}var oDe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var sDe=["numFmtId","fillId","fontId","borderId","xfId"],aDe=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var lDe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,s,a){var l,c={};return o?((l=(o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,n){t.NumberFmt=[];for(var r=tTe(hEe),i=0;i<r.length;++i)t.NumberFmt[r[i]]=hEe[r[i]];var o=e[0].match(HTe);if(o)for(i=0;i<o.length;++i){var s=WTe(o[i]);switch(zTe(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var a=$Te(ike(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=a}$Ee(a,l)}break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(l,c,a),(l=o.match(r))&&function(e,t,n,r){t.Fonts=[];var i={},o=!1;(e[0].match(HTe)||[]).forEach(function(e){var s=WTe(e);switch(zTe(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":s.val&&(i.name=ike(s.val));break;case"<b":i.bold=s.val?ZTe(s.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=s.val?ZTe(s.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(s.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=s.val?ZTe(s.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=s.val?ZTe(s.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=s.val?ZTe(s.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=s.val?ZTe(s.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=s.val?ZTe(s.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":s.val&&(i.sz=+s.val);break;case"<vertAlign":s.val&&(i.vertAlign=s.val);break;case"<family":s.val&&(i.family=parseInt(s.val,10));break;case"<scheme":s.val&&(i.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=FRe[parseInt(s.val,10)];break;case"<color":if(i.color||(i.color={}),s.auto&&(i.color.auto=ZTe(s.auto)),s.rgb)i.color.rgb=s.rgb.slice(-6);else if(s.indexed){i.color.index=parseInt(s.indexed,10);var a=RPe[i.color.index];81==i.color.index&&(a=RPe[1]),a||(a=RPe[1]),i.color.rgb=a[0].toString(16)+a[1].toString(16)+a[2].toString(16)}else s.theme&&(i.color.theme=parseInt(s.theme,10),s.tint&&(i.color.tint=parseFloat(s.tint)),s.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=YAe(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+s[0]+" in fonts")}})}(l,c,s,a),(l=o.match(n))&&function(e,t,n,r){t.Fills=[];var i={},o=!1;(e[0].match(HTe)||[]).forEach(function(e){var n=WTe(e);switch(zTe(n[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":n.patternType&&(i.patternType=n.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),n.indexed&&(i.bgColor.indexed=parseInt(n.indexed,10)),n.theme&&(i.bgColor.theme=parseInt(n.theme,10)),n.tint&&(i.bgColor.tint=parseFloat(n.tint)),n.rgb&&(i.bgColor.rgb=n.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),n.theme&&(i.fgColor.theme=parseInt(n.theme,10)),n.tint&&(i.fgColor.tint=parseFloat(n.tint)),null!=n.rgb&&(i.fgColor.rgb=n.rgb.slice(-6));break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+n[0]+" in fills")}})}(l,c,0,a),(l=o.match(i))&&function(e,t,n,r){t.Borders=[];var i={},o=!1;(e[0].match(HTe)||[]).forEach(function(e){var n=WTe(e);switch(zTe(n[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},n.diagonalUp&&(i.diagonalUp=ZTe(n.diagonalUp)),n.diagonalDown&&(i.diagonalDown=ZTe(n.diagonalDown)),t.Borders.push(i);break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+n[0]+" in borders")}})}(l,c,0,a),(l=o.match(t))&&function(e,t,n){var r;t.CellXf=[];var i=!1;(e[0].match(HTe)||[]).forEach(function(e){var o=WTe(e),s=0;switch(zTe(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=o)[0],s=0;s<sDe.length;++s)r[sDe[s]]&&(r[sDe[s]]=parseInt(r[sDe[s]],10));for(s=0;s<aDe.length;++s)r[aDe[s]]&&(r[aDe[s]]=ZTe(r[aDe[s]]));if(t.NumberFmt&&r.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[s]){r.numFmtId=s;break}t.CellXf.push(r);break;case"<alignment":case"<alignment/>":var a={};o.vertical&&(a.vertical=o.vertical),o.horizontal&&(a.horizontal=o.horizontal),null!=o.textRotation&&(a.textRotation=o.textRotation),o.indent&&(a.indent=o.indent),o.wrapText&&(a.wrapText=ZTe(o.wrapText)),r.alignment=a;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}(l,c,a),c):c}}();function cDe(e,t){var n,r=[NTe,fke("styleSheet",null,{xmlns:Dke[0],"xmlns:vt":Pke})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=fke("numFmt",null,{numFmtId:r,formatCode:YTe(e[r])}))}),1===t.length?"":(t[t.length]="</numFmts>",t[0]=fke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=fke("cellXfs",null),e.forEach(function(e){t[t.length]=fke("xf",null,e)}),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=fke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uDe(e,t,n){n||(n=SMe(6+4*t.length)),n.write_shift(2,e),UMe(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return null==n.l&&(n.l=n.length),r}function dDe(e,t){t||(t=SMe(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=SMe(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,n),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var n=0;"superscript"==e.vertAlign?n=1:"subscript"==e.vertAlign&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),fPe(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),UMe(e.name,t),t.length>t.l?t.slice(0,t.l):t}var hDe,pDe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],gDe=yMe;function fDe(e,t){t||(t=SMe(84)),hDe||(hDe=rTe(pDe));var n=hDe[e.patternType];null==n&&(n=40),t.write_shift(4,n);var r=0;if(40!=n)for(fPe({auto:1},t),fPe({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function mDe(e,t,n){n||(n=SMe(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);return n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function vDe(e,t){return t||(t=SMe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var wDe=yMe;function bDe(e){var t;EMe(e,613,GMe(1)),EMe(e,46,(t||(t=SMe(51)),t.write_shift(1,0),vDe(0,t),vDe(0,t),vDe(0,t),vDe(0,t),vDe(0,t),t.length>t.l?t.slice(0,t.l):t)),EMe(e,614)}function CDe(e){EMe(e,619,GMe(1)),EMe(e,48,function(e,t){return t||(t=SMe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),iPe(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),EMe(e,620)}function yDe(e){EMe(e,508,function(e,t,n){var r=SMe(2052);return r.write_shift(4,e),iPe(t,r),iPe(n,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),EMe(e,509)}function SDe(e,t){var n=RMe();return EMe(n,278),function(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++n}),0!=n&&(EMe(e,615,GMe(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)null!=t[r]&&EMe(e,44,uDe(r,t[r]))}),EMe(e,616))}}(n,e.SSF),function(e){EMe(e,611,GMe(1)),EMe(e,43,dDe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),EMe(e,612)}(n),function(e){EMe(e,603,GMe(2)),EMe(e,45,fDe({patternType:"none"})),EMe(e,45,fDe({patternType:"gray125"})),EMe(e,604)}(n),bDe(n),function(e){EMe(e,626,GMe(1)),EMe(e,47,mDe({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),EMe(e,627)}(n),function(e,t){EMe(e,617,GMe(t.length)),t.forEach(function(t){EMe(e,47,mDe(t,0))}),EMe(e,618)}(n,t.cellXfs),CDe(n),function(e){EMe(e,505,GMe(0)),EMe(e,506)}(n),yDe(n),EMe(n,279),n.end()}var xDe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RDe(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(HTe)||[]).forEach(function(e){var i=WTe(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[xDe.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function EDe(){}function TDe(){}var kDe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MDe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,PDe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var IDe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ADe(e,t){var n;e&&0!==e.length||(e=DDe());var r={};if(!(n=e.match(IDe)))throw new Error("themeElements not found in theme");return function(e,t,n){var r;t.themeElements={},[["clrScheme",kDe,RDe],["fontScheme",MDe,EDe],["fmtScheme",PDe,TDe]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)})}(n[0],r,t),r.raw=e,r}function DDe(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[NTe];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',n[n.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',n[n.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',n[n.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function FDe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return yMe(e,t)}(e,4);break;case 2:t.xclrValue=DIe(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function ODe(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=FDe(e);break;case 6:r[1]=function(e,t){return yMe(e,t)}(e,n);break;case 14:case 15:r[1]=e.read_shift(1===n?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function NDe(e,t){t.forEach(function(e){e[0]})}function LDe(){var e=RMe();return EMe(e,332),EMe(e,334,GMe(1)),EMe(e,335,function(e){var t=SMe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),UMe(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),EMe(e,336),EMe(e,339,function(e,t){var n=SMe(8+2*t.length);return n.write_shift(4,e),UMe(t,n),n.slice(0,n.l)}(1,"XLDAPR")),EMe(e,52),EMe(e,35,GMe(514)),EMe(e,4096,GMe(0)),EMe(e,4097,wIe(1)),EMe(e,36),EMe(e,53),EMe(e,340),EMe(e,337,function(e,t){var n=SMe(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}(1,!0)),EMe(e,51,function(e){var t=SMe(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}([[1,0]])),EMe(e,338),EMe(e,333),e.end()}function _De(){var e=[NTe];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var HDe=1024;function VDe(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[fke("xml",null,{"xmlns:v":Hke,"xmlns:o":Fke,"xmlns:x":Oke,"xmlns:mv":_ke}).replace(/\/>/,">"),fke("o:shapelayout",fke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),fke("v:shapetype",[fke("v:stroke",null,{joinstyle:"miter"}),fke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];HDe<1e3*e;)HDe+=1e3;return t.forEach(function(e){var t=OMe(e[0]),n={color2:"#BEFF82",type:"gradient"};"gradient"==n.type&&(n.angle="-180");var r="gradient"==n.type?fke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=fke("v:fill",r,n);++HDe,i=i.concat(["<v:shape"+gke({id:"_x0000_s"+HDe,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,fke("v:shadow",null,{on:"t",obscured:"t"}),fke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",pke("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),pke("x:AutoFill","False"),pke("x:Row",String(t.r)),pke("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function BDe(e,t,n,r){var i,o=Array.isArray(e);t.forEach(function(t){var s=OMe(t.ref);if(o?(e[s.r]||(e[s.r]=[]),i=e[s.r][s.c]):i=e[t.ref],!i){i={t:"z"},o?e[s.r][s.c]=i:e[t.ref]=i;var a=HMe(e["!ref"]||"BDWGO1000001:A1");a.s.r>s.r&&(a.s.r=s.r),a.e.r<s.r&&(a.e.r=s.r),a.s.c>s.c&&(a.s.c=s.c),a.e.c<s.c&&(a.e.c=s.c);var l=_Me(a);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var c={a:t.author,t:t.t,r:t.r,T:n};t.h&&(c.h=t.h);for(var u=i.c.length-1;u>=0;--u){if(!n&&i.c[u].T)return;n&&!i.c[u].T&&i.c.splice(u,1)}if(n&&r)for(u=0;u<r.length;++u)if(c.a==r[u].id){c.a=r[u].name||c.a;break}i.c.push(c)})}function WDe(e){var t=[NTe,fke("comments",null,{xmlns:Dke[0]})],n=[];return t.push("<authors>"),e.forEach(function(e){e[1].forEach(function(e){var r=YTe(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))})}),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(e){var r=0,i=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=n.indexOf("tc="+e[1][0].ID):e[1].forEach(function(e){e.a&&(r=n.indexOf(YTe(e.a))),i.push(e.t||"")}),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),i.length<=1)t.push(pke("t",YTe(i[0]||"")));else{for(var o="Comment:\n    "+i[0]+"\n",s=1;s<i.length;++s)o+="Reply:\n    "+i[s]+"\n";t.push(pke("t",YTe(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function zDe(e,t,n){var r=[NTe,fke("ThreadedComments",null,{xmlns:Rke}).replace(/[\/]>/,">")];return e.forEach(function(e){var i="";(e[1]||[]).forEach(function(o,s){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var a={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?i=a.id:a.parentId=i,o.ID=a.id,o.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(fke("threadedComment",pke("text",o.t||""),a))}else delete o.ID})}),r.push("</ThreadedComments>"),r.join("")}var jDe=$Me;function GDe(e){var t=RMe(),n=[];return EMe(t,628),EMe(t,630),e.forEach(function(e){e[1].forEach(function(e){n.indexOf(e.a)>-1||(n.push(e.a.slice(0,54)),EMe(t,632,function(e){return UMe(e.slice(0,54))}(e.a)))})}),EMe(t,631),EMe(t,633),e.forEach(function(e){e[1].forEach(function(r){r.iauthor=n.indexOf(r.a);var i={s:OMe(e[0]),e:OMe(e[0])};EMe(t,635,function(e,t){return null==t&&(t=SMe(36)),t.write_shift(4,e[1].iauthor),hPe(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,r])),r.t&&r.t.length>0&&EMe(t,637,XMe(r)),EMe(t,636),delete r.iauthor})}),EMe(t,634),EMe(t,629),t.end()}var $De=["xlsb","xlsm","xlam","biff8","xla"];var UDe=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(e,n,r,i){var o=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==i.length?o=!0:"["==i.charAt(0)&&(o=!0,i=i.slice(1,-1));var a=r.length>0?0|parseInt(r,10):0,l=i.length>0?0|parseInt(i,10):0;return o?l+=t.c:--l,s?a+=t.r:--a,n+(o?"":"$")+FMe(l)+(s?"":"$")+AMe(a)}return function(r,i){return t=i,r.replace(e,n)}}(),KDe=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,YDe=function(){return function(e,t){return e.replace(KDe,function(e,n,r,i,o,s){var a=DMe(i)-(r?0:t.c),l=IMe(s)-(o?0:t.r);return n+"R"+(0==l?"":o?l+1:"["+l+"]")+"C"+(0==a?"":r?a+1:"["+a+"]")})}}();function qDe(e,t){return e.replace(KDe,function(e,n,r,i,o,s){return n+("$"==r?r+i:FMe(DMe(i)+t.c))+("$"==o?o+s:AMe(IMe(s)+t.r))})}function XDe(e,t,n){var r=LMe(t).s,i=OMe(n);return qDe(e,{r:i.r-r.r,c:i.c-r.c})}function QDe(e){return e.replace(/_xlfn\./g,"")}function JDe(e){e.l+=1}function ZDe(e,t){var n=e.read_shift(1==t?1:2);return[16383&n,n>>14&1,n>>15&1]}function eFe(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return tFe(e);12==n.biff&&(r=4)}var i=e.read_shift(r),o=e.read_shift(r),s=ZDe(e,2),a=ZDe(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function tFe(e){var t=ZDe(e,2),n=ZDe(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function nFe(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return function(e){var t=ZDe(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(n&&12==n.biff?4:2),i=ZDe(e,2);return{r:r,c:i[0],cRel:i[1],rRel:i[2]}}function rFe(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:255&n,fQuoted:!!(16384&n),cRel:n>>15,rRel:n>>15}}function iFe(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function oFe(e){return[e.read_shift(1),e.read_shift(1)]}function sFe(e,t){var n=[e.read_shift(1)];if(12==t)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2}switch(n[0]){case 4:n[1]=fIe(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:n[1]=EPe[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:n[1]=pPe(e);break;case 2:n[1]=TIe(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function aFe(e,t,n){for(var r=e.read_shift(12==n.biff?4:2),i=[],o=0;o!=r;++o)i.push((12==n.biff?dPe:HIe)(e,8));return i}function lFe(e,t,n){var r=0,i=0;12==n.biff?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,0==--i&&(i=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=sFe(e,n.biff);return s}function cFe(e,t,n){return e.l+=2,[rFe(e)]}function uFe(e){return e.l+=6,[]}function dFe(e){return e.l+=2,[vIe(e),1&e.read_shift(2)]}var hFe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var pFe={1:{n:"PtgExp",f:function(e,t,n){return e.l++,n&&12==n.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(n&&2==n.biff?1:2)]}},2:{n:"PtgTbl",f:yMe},3:{n:"PtgAdd",f:JDe},4:{n:"PtgSub",f:JDe},5:{n:"PtgMul",f:JDe},6:{n:"PtgDiv",f:JDe},7:{n:"PtgPower",f:JDe},8:{n:"PtgConcat",f:JDe},9:{n:"PtgLt",f:JDe},10:{n:"PtgLe",f:JDe},11:{n:"PtgEq",f:JDe},12:{n:"PtgGe",f:JDe},13:{n:"PtgGt",f:JDe},14:{n:"PtgNe",f:JDe},15:{n:"PtgIsect",f:JDe},16:{n:"PtgUnion",f:JDe},17:{n:"PtgRange",f:JDe},18:{n:"PtgUplus",f:JDe},19:{n:"PtgUminus",f:JDe},20:{n:"PtgPercent",f:JDe},21:{n:"PtgParen",f:JDe},22:{n:"PtgMissArg",f:JDe},23:{n:"PtgStr",f:function(e,t,n){return e.l++,yIe(e,0,n)}},26:{n:"PtgSheet",f:function(e,t,n){return e.l+=5,e.l+=2,e.l+=2==n.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,n){return e.l+=2==n.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,EPe[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,pPe(e)}},32:{n:"PtgArray",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=2==n.biff?6:12==n.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[NFe[i],OFe[i],r]}},34:{n:"PtgFuncVar",f:function(e,t,n){var r=e[e.l++],i=e.read_shift(1),o=n&&n.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===o[0]?OFe:FFe)[o[1]]]}},35:{n:"PtgName",f:function(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,o=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,o]}},36:{n:"PtgRef",f:function(e,t,n){var r=(96&e[e.l])>>5;return e.l+=1,[r,nFe(e,0,n)]}},37:{n:"PtgArea",f:function(e,t,n){return[(96&e[e.l++])>>5,eFe(e,n.biff>=2&&n.biff,n)]}},38:{n:"PtgMemArea",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=n&&2==n.biff?3:4,[r,e.read_shift(n&&2==n.biff?1:2)]}},39:{n:"PtgMemErr",f:yMe},40:{n:"PtgMemNoMem",f:yMe},41:{n:"PtgMemFunc",f:function(e,t,n){return[e.read_shift(1)>>>5&3,e.read_shift(n&&2==n.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,12==n.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,n){var r=(96&e[e.l++])>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),n=e.read_shift(1),r=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==i&&n>=128&&(n-=256),{r:t,c:n,cRel:i,rRel:r}}(e);var i=e.read_shift(r>=12?4:2),o=e.read_shift(2),s=(16384&o)>>14,a=(32768&o)>>15;if(o&=16383,1==a)for(;i>524287;)i-=1048576;if(1==s)for(;o>8191;)o-=16384;return{r:i,c:o,cRel:s,rRel:a}}(e,0,n);return[r,i]}},45:{n:"PtgAreaN",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=function(e,t,n){if(n.biff<8)return tFe(e);var r=e.read_shift(12==n.biff?4:2),i=e.read_shift(12==n.biff?4:2),o=ZDe(e,2),s=ZDe(e,2);return{s:{r:r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,n);return[r,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,n){return 5==n.biff?function(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,n){var r=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return n&&5==n.biff&&(e.l+=12),[r,i,nFe(e,0,n)]}},59:{n:"PtgArea3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(n)switch(n.biff){case 5:e.l+=12;break;case 12:0}return[r,i,eFe(e,0,n)]}},60:{n:"PtgRefErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[r,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,n){var r=(96&e[e.l++])>>5,i=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[r,i]}},255:{}},gFe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fFe={1:{n:"PtgElfLel",f:dFe},2:{n:"PtgElfRw",f:cFe},3:{n:"PtgElfCol",f:cFe},6:{n:"PtgElfRwV",f:cFe},7:{n:"PtgElfColV",f:cFe},10:{n:"PtgElfRadical",f:cFe},11:{n:"PtgElfRadicalS",f:uFe},13:{n:"PtgElfColS",f:uFe},15:{n:"PtgElfColSV",f:uFe},16:{n:"PtgElfRadicalLel",f:dFe},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2);return{ixti:t,coltype:3&n,rt:hFe[n>>2&31],idx:r,c:i,C:o}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},mFe={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=n&&2==n.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,n){e.l+=2;for(var r=e.read_shift(n&&2==n.biff?1:2),i=[],o=0;o<=r;++o)i.push(e.read_shift(n&&2==n.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,n){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(n&&2==n.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,n){e.l+=n&&2==n.biff?3:4}},32:{n:"PtgAttrBaxcel",f:iFe},33:{n:"PtgAttrBaxcel",f:iFe},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),oFe(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),oFe(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function vFe(e,t,n,r){if(r.biff<8)return yMe(e,t);for(var i=e.l+t,o=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=lFe(e,0,r),o.push(n[s][1]);break;case"PtgMemArea":n[s][2]=aFe(e,n[s][1],r),o.push(n[s][2]);break;case"PtgExp":r&&12==r.biff&&(n[s][1][1]=e.read_shift(4),o.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return 0!==(t=i-e.l)&&o.push(yMe(e,t)),o}function wFe(e,t,n){for(var r,i,o=e.l+t,s=[];o!=e.l;)t=o-e.l,i=e[e.l],r=pFe[i]||pFe[gFe[i]],24!==i&&25!==i||(r=(24===i?fFe:mFe)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,n)]):yMe(e,t);return s}function bFe(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],o=0;o<r.length;++o){var s=r[o];if(s)if(2===s[0])i.push('"'+s[1].replace(/"/g,'""')+'"');else i.push(s[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var CFe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yFe(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return null!=n.SID?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(i=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function SFe(e,t,n){var r=yFe(e,t,n);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,n)}function xFe(e,t,n,r,i){var o,s,a,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,p=0,g="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,w=e[0].length;v<w;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=d.pop(),s=d.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=wTe(" ",e[0][f][1][1]);break;case 1:m=wTe("\r",e[0][f][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}s+=m,f=-1}d.push(s+CFe[b[0]]+o);break;case"PtgIsect":o=d.pop(),s=d.pop(),d.push(s+" "+o);break;case"PtgUnion":o=d.pop(),s=d.pop(),d.push(s+","+o);break;case"PtgRange":o=d.pop(),s=d.pop(),d.push(s+":"+o);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":a=TMe(b[1][1],u,i),d.push(MMe(a,c));break;case"PtgRefN":a=n?TMe(b[1][1],n,i):b[1][1],d.push(MMe(a,c));break;case"PtgRef3d":h=b[1][1],a=TMe(b[1][2],u,i);g=SFe(r,h,i);d.push(g+"!"+MMe(a,c));break;case"PtgFunc":case"PtgFuncVar":var C=b[1][0],y=b[1][1];C||(C=0);var S=0==(C&=127)?[]:d.slice(-C);d.length-=C,"User"===y&&(y=S.shift()),d.push(y+"("+S.join(",")+")");break;case"PtgBool":d.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(b[1]);break;case"PtgNum":d.push(String(b[1]));break;case"PtgStr":d.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=kMe(b[1][1],n?{s:n}:u,i),d.push(PMe(l,i));break;case"PtgArea":l=kMe(b[1][1],u,i),d.push(PMe(l,i));break;case"PtgArea3d":h=b[1][1],l=b[1][2],g=SFe(r,h,i),d.push(g+"!"+PMe(l,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":p=b[1][2];var x=(r.names||[])[p-1]||(r[0]||[])[p],R=x?x.Name:"SH33TJSNAME"+String(p);R&&"_xlfn."==R.slice(0,6)&&!i.xlfn&&(R=R.slice(6)),d.push(R);break;case"PtgNameX":var E,T=b[1][1];if(p=b[1][2],!(i.biff<=5)){var k="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][p]&&r[T][p].itab>0&&(k=r.SheetNames[r[T][p].itab-1]+"!"):k=r.SheetNames[p-1]+"!"),r[T]&&r[T][p])k+=r[T][p].Name;else if(r[0]&&r[0][p])k+=r[0][p].Name;else{var M=(yFe(r,T,i)||"").split(";;");M[p-1]?k=M[p-1]:k+="SH33TJSERRX"}d.push(k);break}T<0&&(T=-T),r[T]&&(E=r[T][p]),E||(E={Name:"SH33TJSERRY"}),d.push(E.Name);break;case"PtgParen":var P="(",I=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:P=wTe(" ",e[0][f][1][1])+P;break;case 3:P=wTe("\r",e[0][f][1][1])+P;break;case 4:I=wTe(" ",e[0][f][1][1])+I;break;case 5:I=wTe("\r",e[0][f][1][1])+I;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}d.push(P+d.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":a={c:b[1][1],r:b[1][0]};var A={c:n.c,r:n.r};if(r.sharedf[NMe(a)]){var D=r.sharedf[NMe(a)];d.push(xFe(D,u,A,r,i))}else{var F=!1;for(o=0;o!=r.arrayf.length;++o)if(s=r.arrayf[o],!(a.c<s[0].s.c||a.c>s[0].e.c)&&!(a.r<s[0].s.r||a.r>s[0].e.r)){d.push(xFe(s[1],u,A,r,i)),F=!0;break}F||d.push(b[1])}break;case"PtgArray":d.push("{"+bFe(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=i.biff&&f>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var O=!0;switch((b=e[0][f])[1][0]){case 4:O=!1;case 0:m=wTe(" ",b[1][1]);break;case 5:O=!1;case 1:m=wTe("\r",b[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}d.push((O?m:"")+d.pop()+(O?"":m)),f=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function RFe(e,t,n){var r,i=e.l+t,o=2==n.biff?1:2,s=e.read_shift(o);if(65535==s)return[[],yMe(e,t-2)];var a=wFe(e,s,n);return t!==s+o&&(r=vFe(e,t-s-o,a,n)),e.l=i,[a,r]}function EFe(e,t,n){var r,i=e.l+t,o=e.read_shift(2),s=wFe(e,o,n);return 65535==o?[[],yMe(e,t-2)]:(t!==o+2&&(r=vFe(e,i-o-2,s,n)),[s,r])}function TFe(e,t,n){var r=e.l+t,i=OIe(e);2==n.biff&&++e.l;var o=function(e){var t;if(65535!==cMe(e,e.l+6))return[pPe(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=n.biff&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var a=function(e,t,n){var r,i=e.l+t,o=2==n.biff?1:2,s=e.read_shift(o);if(65535==s)return[[],yMe(e,t-2)];var a=wFe(e,s,n);return t!==s+o&&(r=vFe(e,t-s-o,a,n)),e.l=i,[a,r]}(e,r-e.l,n);return{cell:i,val:o[0],formula:a,shared:s>>3&1,tt:o[1]}}function kFe(e,t,n,r,i){var o=NIe(t,n,i),s=function(e){if(null==e){var t=SMe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return gPe("number"==typeof e?e:0)}(e.v),a=SMe(6);a.write_shift(2,33),a.write_shift(4,0);for(var l=SMe(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return eEe([o,s,a,l])}function MFe(e,t,n){var r=e.read_shift(4),i=wFe(e,r,n),o=e.read_shift(4);return[i,o>0?vFe(e,o,i,n):null]}var PFe=MFe,IFe=MFe,AFe=MFe,DFe=MFe,FFe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},OFe={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NFe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function LFe(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function _Fe(e){return("of:="+e.replace(KDe,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function HFe(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function VFe(e){return e.replace(/\./,"!")}var BFe={},WFe={},zFe="undefined"!==typeof Map;function jFe(e,t,n){var r=0,i=e.length;if(n){if(zFe?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var o=zFe?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t:t},e.Count++,e.Unique++,n&&(zFe?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function GFe(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(qAe=t.MDW),null!=t.width?n.customWidth=1:null!=t.wpx?r=QAe(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(n.width=JAe(r),n.customWidth=1):null!=t.width&&(n.width=t.width),t.hidden&&(n.hidden=!0),null!=t.level&&(n.outlineLevel=n.level=t.level),n}function $Fe(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}function UFe(e,t,n){var r=n.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==r&&n.ssf)for(;i<392;++i)if(null==n.ssf[i]){$Ee(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===r)return i;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function KFe(e,t,n,r,i,o){try{r.cellNF&&(e.z=hEe[t])}catch(a){if(r.WTF)throw a}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=fTe(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==hEe[t]&&$Ee(YEe[t]||"General",t),"e"===e.t)e.w=e.w||EPe[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SEe(e.v);else if("d"===e.t){var s=sTe(e.v);e.w=(0|s)===s?s.toString(10):SEe(s)}else{if(void 0===e.v)return"";e.w=xEe(e.v,WFe)}else"d"===e.t?e.w=GEe(t,sTe(e.v),WFe):e.w=GEe(t,e.v,WFe)}catch(a){if(r.WTF)throw a}if(r.cellStyles&&null!=n)try{e.s=o.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=YAe(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=YAe(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(r.WTF&&o.Fills)throw a}}}function YFe(e,t,n){if(e&&e["!ref"]){var r=HMe(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var qFe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,XFe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,QFe=/<(?:\w:)?hyperlink [^>]*>/gm,JFe=/"(\w*:\w*)"/,ZFe=/<(?:\w:)?col\b[^>]*[\/]?>/g,eOe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,tOe=/<(?:\w:)?pageMargins[^>]*\/>/g,nOe=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rOe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,iOe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function oOe(e,t,n,r,i,o,s){if(!e)return e;r||(r={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=e.match(XFe);d?(c=e.slice(0,d.index),u=e.slice(d.index+d[0].length)):c=u=e;var h=c.match(nOe);h?sOe(h[0],a,i,n):(h=c.match(rOe))&&function(e,t,n,r,i){sOe(e.slice(0,e.indexOf(">")),n,r,i)}(h[0],h[1],a,i,n);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(JFe);g&&function(e,t){var n=HMe(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=_Me(n))}(a,g[1])}var f=c.match(iOe);f&&f[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(cOe)||[]).forEach(function(e,n){var r=WTe(e);t.Views[n]||(t.Views[n]={}),+r.zoomScale&&(t.Views[n].zoom=+r.zoomScale),ZTe(r.rightToLeft)&&(t.Views[n].RTL=!0)})}(f[1],i);var m=[];if(t.cellStyles){var v=c.match(ZFe);v&&function(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=WTe(t[r],!0);i.hidden&&(i.hidden=ZTe(i.hidden));var o=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,eDe(i.width)),tDe(i);o<=s;)e[o++]=vTe(i)}}(m,v)}d&&dOe(d[1],a,t,l,o,s);var w=u.match(eOe);w&&(a["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(w[0]));var b=[],C=u.match(qFe);if(C)for(p=0;p!=C.length;++p)b[p]=HMe(C[p].slice(C[p].indexOf('"')+1));var y=u.match(QFe);y&&function(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var o=WTe(ike(t[i]),!0);if(!o.ref)return;var s=((n||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+$Te(o.location))):(o.Target="#"+$Te(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var a=HMe(o.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=NMe({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=o):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=o)}}}(a,y,r);var S=u.match(tOe);if(S&&(a["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}(WTe(S[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=_Me(l)),t.sheetRows>0&&a["!ref"]){var x=HMe(a["!ref"]);t.sheetRows<=+x.e.r&&(x.e.r=t.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),a["!fullref"]=a["!ref"],a["!ref"]=_Me(x))}return m.length>0&&(a["!cols"]=m),b.length>0&&(a["!merges"]=b),a}function sOe(e,t,n,r){var i=WTe(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=$Te(ike(i.codeName)))}var aOe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],lOe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var cOe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function uOe(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var i="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=EPe[e.v];break;case"d":r&&r.cellDates?i=fTe(e.v,-1).toISOString():((e=vTe(e)).t="n",i=""+(e.v=sTe(fTe(e.v)))),"undefined"===typeof e.z&&(e.z=hEe[14]);break;default:i=e.v}var a=pke("v",YTe(i)),l={r:t},c=UFe(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=pke("v",""+jFe(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=fke("f",YTe(e.f),u)+(null!=e.v?a:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),fke("c",a,l)}var dOe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=ske("v"),s=ske("f");return function(a,l,c,u,d,h){for(var p,g,f,m,v,w=0,b="",C=[],y=[],S=0,x=0,R=0,E="",T=0,k=0,M=0,P=0,I=Array.isArray(h.CellXf),A=[],D=[],F=Array.isArray(l),O=[],N={},L=!1,_=!!c.sheetStubs,H=a.split(t),V=0,B=H.length;V!=B;++V){var W=(b=H[V].trim()).length;if(0!==W){var z=0;e:for(w=0;w<W;++w)switch(b[w]){case">":if("/"!=b[w-1]){++w;break e}if(c&&c.cellStyles){if(T=null!=(g=WTe(b.slice(z,w),!0)).r?parseInt(g.r,10):T+1,k=-1,c.sheetRows&&c.sheetRows<T)continue;N={},L=!1,g.ht&&(L=!0,N.hpt=parseFloat(g.ht),N.hpx=iDe(N.hpt)),"1"==g.hidden&&(L=!0,N.hidden=!0),null!=g.outlineLevel&&(L=!0,N.level=+g.outlineLevel),L&&(O[T-1]=N)}break;case"<":z=w}if(z>=w)break;if(T=null!=(g=WTe(b.slice(z,w),!0)).r?parseInt(g.r,10):T+1,k=-1,!(c.sheetRows&&c.sheetRows<T)){u.s.r>T-1&&(u.s.r=T-1),u.e.r<T-1&&(u.e.r=T-1),c&&c.cellStyles&&(N={},L=!1,g.ht&&(L=!0,N.hpt=parseFloat(g.ht),N.hpx=iDe(N.hpt)),"1"==g.hidden&&(L=!0,N.hidden=!0),null!=g.outlineLevel&&(L=!0,N.level=+g.outlineLevel),L&&(O[T-1]=N)),C=b.slice(w).split(e);for(var j=0;j!=C.length&&"<"==C[j].trim().charAt(0);++j);for(C=C.slice(j),w=0;w!=C.length;++w)if(0!==(b=C[w].trim()).length){if(y=b.match(n),S=w,x=0,R=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=y&&2===y.length){for(S=0,E=y[1],x=0;x!=E.length&&!((R=E.charCodeAt(x)-64)<1||R>26);++x)S=26*S+R;k=--S}else++k;for(x=0;x!=b.length&&62!==b.charCodeAt(x);++x);if(++x,(g=WTe(b.slice(0,x),!0)).r||(g.r=NMe({r:T-1,c:k})),p={t:""},null!=(y=(E=b.slice(x)).match(o))&&""!==y[1]&&(p.v=$Te(y[1])),c.cellFormula){if(null!=(y=E.match(s))&&""!==y[1]){if(p.f=$Te(ike(y[1])).replace(/\r\n/g,"\n"),c.xlfn||(p.f=QDe(p.f)),y[0].indexOf('t="array"')>-1)p.F=(E.match(i)||[])[1],p.F.indexOf(":")>-1&&A.push([HMe(p.F),p.F]);else if(y[0].indexOf('t="shared"')>-1){m=WTe(y[0]);var G=$Te(ike(y[1]));c.xlfn||(G=QDe(G)),D[parseInt(m.si,10)]=[m,G,g.r]}}else(y=E.match(/<f[^>]*\/>/))&&D[(m=WTe(y[0])).si]&&(p.f=XDe(D[m.si][1],D[m.si][2],g.r));var $=OMe(g.r);for(x=0;x<A.length;++x)$.r>=A[x][0].s.r&&$.r<=A[x][0].e.r&&$.c>=A[x][0].s.c&&$.c<=A[x][0].e.c&&(p.F=A[x][1])}if(null==g.t&&void 0===p.v)if(p.f||p.F)p.v=0,p.t="n";else{if(!_)continue;p.t="z"}else p.t=g.t||"n";switch(u.s.c>k&&(u.s.c=k),u.e.c<k&&(u.e.c=k),p.t){case"n":if(""==p.v||null==p.v){if(!_)continue;p.t="z"}else p.v=parseFloat(p.v);break;case"s":if("undefined"==typeof p.v){if(!_)continue;p.t="z"}else f=BFe[parseInt(p.v,10)],p.v=f.t,p.r=f.r,c.cellHTML&&(p.h=f.h);break;case"str":p.t="s",p.v=null!=p.v?ike(p.v):"",c.cellHTML&&(p.h=QTe(p.v));break;case"inlineStr":y=E.match(r),p.t="s",null!=y&&(f=EAe(y[1]))?(p.v=f.t,c.cellHTML&&(p.h=f.h)):p.v="";break;case"b":p.v=ZTe(p.v);break;case"d":c.cellDates?p.v=fTe(p.v,1):(p.v=sTe(fTe(p.v,1)),p.t="n");break;case"e":c&&!1===c.cellText||(p.w=p.v),p.v=TPe[p.v]}if(M=P=0,v=null,I&&void 0!==g.s&&null!=(v=h.CellXf[g.s])&&(null!=v.numFmtId&&(M=v.numFmtId),c.cellStyles&&null!=v.fillId&&(P=v.fillId)),KFe(p,M,P,c,d,h),c.cellDates&&I&&"n"==p.t&&BEe(hEe[M])&&(p.t="d",p.v=uTe(p.v)),g.cm&&c.xlmeta){var U=(c.xlmeta.Cell||[])[+g.cm-1];U&&"XLDAPR"==U.type&&(p.D=!0)}if(F){var K=OMe(g.r);l[K.r]||(l[K.r]=[]),l[K.r][K.c]=p}else l[g.r]=p}}}}O.length>0&&(l["!rows"]=O)}}();function hOe(e,t,n,r){var i,o=[NTe,fke("worksheet",null,{xmlns:Dke[0],"xmlns:r":Mke})],s=n.SheetNames[e],a="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=HMe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=_Me(u)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,n,r,i){var o=!1,s={},a=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(u){}o=!0,s.codeName=oke(YTe(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+fke("outlinePr",null,c)}(o||a)&&(i[i.length]=fke("sheetPr",a,s))}(l,n,e,t,o),o[o.length]=fke("dimension",null,{ref:c}),o[o.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),fke("sheetViews",fke("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(o[o.length]=fke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=fke("col",null,GFe(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),o[i=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(a=function(e,t){var n,r,i=[],o=[],s=HMe(e["!ref"]),a="",l="",c=[],u=0,d=0,h=e["!rows"],p=Array.isArray(e),g={r:l},f=-1;for(d=s.s.c;d<=s.e.c;++d)c[d]=FMe(d);for(u=s.s.r;u<=s.e.r;++u){for(o=[],l=AMe(u),d=s.s.c;d<=s.e.c;++d){n=c[d]+l;var m=p?(e[u]||[])[d]:e[n];void 0!==m&&null!=(a=uOe(m,n,e,t))&&o.push(a)}(o.length>0||h&&h[u])&&(g={r:l},h&&h[u]&&((r=h[u]).hidden&&(g.hidden=1),f=-1,r.hpx?f=rDe(r.hpx):r.hpt&&(f=r.hpt),f>-1&&(g.ht=f,g.customHeight=1),r.level&&(g.outlineLevel=r.level)),i[i.length]=fke("row",o.join(""),g))}if(h)for(;u<h.length;++u)h&&h[u]&&(g={r:u+1},(r=h[u]).hidden&&(g.hidden=1),f=-1,r.hpx?f=rDe(r.hpx):r.hpt&&(f=r.hpt),f>-1&&(g.ht=f,g.customHeight=1),r.level&&(g.outlineLevel=r.level),i[i.length]=fke("row","",g));return i.join("")}(l,t,0,0),a.length>0&&(o[o.length]=a)),o.length>i+1&&(o[o.length]="</sheetData>",o[i]=o[i].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return aOe.forEach(function(n){null!=e[n]&&e[n]&&(t[n]="1")}),lOe.forEach(function(n){null==e[n]||e[n]||(t[n]="0")}),e.password&&(t.password=zAe(e.password).toString(16).toUpperCase()),fke("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:_Me(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,s=LMe(i);s.s.r==s.e.r&&(s.e.r=LMe(t["!ref"]).e.r,i=_Me(s));for(var a=0;a<o.length;++a){var l=o[a];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),fke("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+_Me(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,p=-1,g=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach(function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=OPe(r,-1,YTe(e[1].Target).replace(/#.*$/,""),IPe.HLINK),h["r:id"]="rId"+g),(p=e[1].Target.indexOf("#"))>-1&&(h.location=YTe(e[1].Target.slice(p+1))),e[1].Tooltip&&(h.tooltip=YTe(e[1].Tooltip)),o[o.length]=fke("hyperlink",null,h))}),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=function(e){return $Fe(e),fke("pageMargins",null,e)}(l["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(o[o.length]=pke("ignoredErrors",fke("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(g=OPe(r,-1,"../drawings/drawing"+(e+1)+".xml",IPe.DRAW),o[o.length]=fke("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=OPe(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",IPe.VML),o[o.length]=fke("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function pOe(e,t,n,r){var i=function(e,t,n){var r=SMe(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;i.hpx?o=20*rDe(i.hpx):i.hpt&&(o=20*i.hpt),r.write_shift(2,o),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,p=u<<10;p<u+1<<10;++p)c.c=p,(Array.isArray(n)?(n[c.r]||[])[c.c]:n[NMe(c)])&&(d<0&&(d=p),h=p);d<0||(++a,r.write_shift(4,d),r.write_shift(4,h))}var g=r.l;return r.l=l,r.write_shift(4,a),r.l=g,r.length>r.l?r.slice(0,r.l):r}(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&EMe(e,0,i)}var gOe=dPe,fOe=hPe;function mOe(e){return[ZMe(e),pPe(e),"n"]}var vOe=dPe,wOe=hPe;var bOe=["left","right","top","bottom","header","footer"];function COe(e,t,n,r,i,o,s){if(void 0===t.v)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":(t=vTe(t)).z=t.z||hEe[14],t.v=sTe(fTe(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v}var l={r:n,c:r};switch(l.s=UFe(i.cellXfs,t,i),t.l&&o["!links"].push([NMe(l),t.l]),t.c&&o["!comments"].push([NMe(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=jFe(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,s?EMe(e,18,function(e,t,n){return null==n&&(n=SMe(8)),ePe(t,n),n.write_shift(4,t.v),n}(0,l)):EMe(e,7,function(e,t,n){return null==n&&(n=SMe(12)),JMe(t,n),n.write_shift(4,t.v),n}(0,l))):(l.t="str",s?EMe(e,17,function(e,t,n){return null==n&&(n=SMe(8+4*e.v.length)),ePe(t,n),UMe(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l)):EMe(e,6,function(e,t,n){return null==n&&(n=SMe(12+4*e.v.length)),JMe(t,n),UMe(e.v,n),n.length>n.l?n.slice(0,n.l):n}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?EMe(e,13,function(e,t,n){return null==n&&(n=SMe(8)),ePe(t,n),cPe(e.v,n),n}(t,l)):EMe(e,2,function(e,t,n){return null==n&&(n=SMe(12)),JMe(t,n),cPe(e.v,n),n}(t,l)):s?EMe(e,16,function(e,t,n){return null==n&&(n=SMe(12)),ePe(t,n),gPe(e.v,n),n}(t,l)):EMe(e,5,function(e,t,n){return null==n&&(n=SMe(16)),JMe(t,n),gPe(e.v,n),n}(t,l)),!0;case"b":return l.t="b",s?EMe(e,15,function(e,t,n){return null==n&&(n=SMe(5)),ePe(t,n),n.write_shift(1,e.v?1:0),n}(t,l)):EMe(e,4,function(e,t,n){return null==n&&(n=SMe(9)),JMe(t,n),n.write_shift(1,e.v?1:0),n}(t,l)),!0;case"e":return l.t="e",s?EMe(e,14,function(e,t,n){return null==n&&(n=SMe(8)),ePe(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}(t,l)):EMe(e,3,function(e,t,n){return null==n&&(n=SMe(9)),JMe(t,n),n.write_shift(1,e.v),n}(t,l)),!0}return s?EMe(e,12,function(e,t,n){return null==n&&(n=SMe(4)),ePe(t,n)}(0,l)):EMe(e,1,function(e,t,n){return null==n&&(n=SMe(8)),JMe(t,n)}(0,l)),!0}function yOe(e,t){var n,r;t&&t["!merges"]&&(EMe(e,177,(n=t["!merges"].length,null==r&&(r=SMe(4)),r.write_shift(4,n),r)),t["!merges"].forEach(function(t){EMe(e,176,wOe(t))}),EMe(e,178))}function SOe(e,t){t&&t["!cols"]&&(EMe(e,390),t["!cols"].forEach(function(t,n){t&&EMe(e,60,function(e,t,n){null==n&&(n=SMe(18));var r=GFe(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,256*(r.width||10)),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof r.width&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}(n,t))}),EMe(e,391))}function xOe(e,t){t&&t["!ref"]&&(EMe(e,648),EMe(e,649,function(e){var t=SMe(24);return t.write_shift(4,4),t.write_shift(4,1),hPe(e,t),t}(HMe(t["!ref"]))),EMe(e,650))}function ROe(e,t,n){t["!links"].forEach(function(t){if(t[1].Target){var r=OPe(n,-1,t[1].Target.replace(/#.*$/,""),IPe.HLINK);EMe(e,494,function(e,t){var n=SMe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));hPe({s:OMe(e[0]),e:OMe(e[0])},n),aPe("rId"+t,n);var r=e[1].Target.indexOf("#");return UMe((-1==r?"":e[1].Target.slice(r+1))||"",n),UMe(e[1].Tooltip||"",n),UMe("",n),n.slice(0,n.l)}(t,r))}}),delete t["!links"]}function EOe(e,t,n){EMe(e,133),EMe(e,137,function(e,t,n){null==n&&(n=SMe(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}(0,n)),EMe(e,138),EMe(e,134)}function TOe(e,t){var n,r;t["!protect"]&&EMe(e,535,(n=t["!protect"],null==r&&(r=SMe(66)),r.write_shift(2,n.password?zAe(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,null==n[e[0]]||n[e[0]]?0:1):r.write_shift(4,null!=n[e[0]]&&n[e[0]]?0:1)}),r))}function kOe(e,t,n,r){var i=RMe(),o=n.SheetNames[e],s=n.Sheets[o]||{},a=o;try{n&&n.Workbook&&(a=n.Workbook.Sheets[e].CodeName||a)}catch(d){}var l,c,u=HMe(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],EMe(i,129),(n.vbaraw||s["!outline"])&&EMe(i,147,function(e,t,n){null==n&&(n=SMe(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return fPe({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),nPe(e,n),n.slice(0,n.l)}(a,s["!outline"])),EMe(i,148,fOe(u)),EOe(i,0,n.Workbook),SOe(i,s),function(e,t,n,r){var i,o=HMe(t["!ref"]||"A1"),s="",a=[];EMe(e,145);var l=Array.isArray(t),c=o.e.r;t["!rows"]&&(c=Math.max(o.e.r,t["!rows"].length-1));for(var u=o.s.r;u<=c;++u){s=AMe(u),pOe(e,t,o,u);var d=!1;if(u<=o.e.r)for(var h=o.s.c;h<=o.e.c;++h){u===o.s.r&&(a[h]=FMe(h)),i=a[h]+s;var p=l?(t[u]||[])[h]:t[i];d=!!p&&COe(e,p,u,h,r,t,d)}}EMe(e,146)}(i,s,0,t),TOe(i,s),function(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],o="string"===typeof i.ref?i.ref:_Me(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,a=LMe(o);a.s.r==a.e.r&&(a.e.r=LMe(t["!ref"]).e.r,o=_Me(a));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+o;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),EMe(e,161,hPe(HMe(o))),EMe(e,162)}}(i,s,n,e),yOe(i,s),ROe(i,s,r),s["!margins"]&&EMe(i,476,(l=s["!margins"],null==c&&(c=SMe(48)),$Fe(l),bOe.forEach(function(e){gPe(l[e],c)}),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||xOe(i,s),function(e,t,n,r){if(t["!comments"].length>0){var i=OPe(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",IPe.VML);EMe(e,551,aPe("rId"+i)),t["!legacy"]=i}}(i,s,e,r),EMe(i,130),i.end()}function MOe(e,t,n,r,i,o){var s=o||{"!type":"chart"};if(!e)return o;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,n=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(n[+t[1]]=r?+t[2]:t[2])});var i=$Te((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[n,i,t]}(e);u.s.r=u.s.c=0,u.e.c=a,c=FMe(a),t[0].forEach(function(e,n){s[c+AMe(n)]={t:"n",v:e,z:t[1]},l=n}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(s["!ref"]=_Me(u)),s}var POe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],IOe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AOe=[],DOe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function FOe(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var o=t[i];if(null==r[o[0]])r[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof r[o[0]]&&(r[o[0]]=ZTe(r[o[0]]));break;case"int":"string"==typeof r[o[0]]&&(r[o[0]]=parseInt(r[o[0]],10))}}}function OOe(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=ZTe(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function NOe(e){OOe(e.WBProps,POe),OOe(e.CalcPr,DOe),FOe(e.WBView,IOe),FOe(e.Sheets,AOe),WFe.date1904=ZTe(e.WBProps.date1904)}var LOe="][*?/\\".split("");function _Oe(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return LOe.forEach(function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function HOe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,i=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=i,r=!!e.vbaraw,t.forEach(function(e,i){_Oe(e);for(var o=0;o<i;++o)if(e==t[o])throw new Error("Duplicate Sheet Name: "+e);if(r){var s=n&&n[i]&&n[i].CodeName||e;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}});for(var o=0;o<e.SheetNames.length;++o)YFe(e.Sheets[e.SheetNames[o]],e.SheetNames[o],o)}var VOe=/<\w+:workbook/;function BOe(e){var t=[NTe];t[t.length]=fke("workbook",null,{xmlns:Dke[0],"xmlns:r":Mke});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(POe.forEach(function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=fke("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var s={name:YTe(e.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=fke("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=fke("definedName",YTe(e.Ref),n))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function WOe(e,t){return t||(t=SMe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),aPe(e.strRelID,t),UMe(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function zOe(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function jOe(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var n,r,i=t.Workbook.Sheets,o=0,s=-1,a=-1;o<i.length;++o)!i[o]||!i[o].Hidden&&-1==s?s=o:1==i[o].Hidden&&-1==a&&(a=o);if(!(a>s))EMe(e,135),EMe(e,158,(n=s,r||(r=SMe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),EMe(e,136)}}function GOe(e,t){var n=RMe();return EMe(n,131),EMe(n,128,function(e,t){t||(t=SMe(127));for(var n=0;4!=n;++n)t.write_shift(4,0);return UMe("SheetJS",t),UMe(PRe.version,t),UMe(PRe.version,t),UMe("7262",t),t.length>t.l?t.slice(0,t.l):t}()),EMe(n,153,function(e,t){t||(t=SMe(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),nPe(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),jOe(n,e),function(e,t){EMe(e,143);for(var n=0;n!=t.SheetNames.length;++n)EMe(e,156,WOe({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]}));EMe(e,144)}(n,e),EMe(n,132),n.end()}function $Oe(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],ANe[16]={n:"BrtFRTArchID$",f:zOe},xMe(e,function(e,a,l){switch(l){case 156:s.SheetNames.push(e.name),n.Sheets.push(e);break;case 153:n.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=xFe(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,o.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,e]):s[0]=[l,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:r.push(l),i=!0;break;case 36:case 38:r.pop(),i=!1;break;default:if(a.T);else if(!i||t.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),NOe(n),n.Names=o,n.supbooks=s,n}(e,n):function(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",o={},s=0;if(e.replace(HTe,function(a,l){var c=WTe(a);switch(zTe(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":a.match(VOe)&&(i="xmlns"+a.match(/<(\w+):/)[1]),n.xmlns=c[i];break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":POe.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":n.WBProps[e[0]]=ZTe(c[e[0]]);break;case"int":n.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:n.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(n.WBProps.CodeName=ike(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=$Te(ike(c.name)),delete c[0],n.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(o={}).Name=ike(c.name),c.comment&&(o.Comment=c.comment),c.localSheetId&&(o.Sheet=+c.localSheetId),ZTe(c.hidden||"0")&&(o.Hidden=!0),s=l+a.length;break;case"</definedName>":o.Ref=$Te(ike(e.slice(s,l))),n.Names.push(o);break;case"<calcPr":case"<calcPr/>":delete c[0],n.CalcPr=c;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return a}),-1===Dke.indexOf(n.xmlns))throw new Error("Unknown Namespace: "+n.xmlns);return NOe(n),n}(e,n)}function UOe(e,t,n,r,i,o,s,a){return".bin"===t.slice(-4)?function(e,t,n,r,i,o,s){if(!e)return e;var a=t||{};r||(r={"!id":{}});var l,c,u,d,h,p,g,f,m,v,w=a.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=[],y=!1,S=!1,x=[];a.biff=12,a["!row"]=0;var R=0,E=!1,T=[],k={},M=a.supbooks||i.supbooks||[[]];if(M.sharedf=k,M.arrayf=T,M.SheetNames=i.SheetNames||i.Sheets.map(function(e){return e.name}),!a.supbooks&&(a.supbooks=M,i.Names))for(var P=0;P<i.Names.length;++P)M[0][P+1]=i.Names[P];var I,A,D=[],F=[],O=!1;if(ANe[16]={n:"BrtShortReal",f:mOe},xMe(e,function(e,t,P){if(!S)switch(P){case 148:l=e;break;case 0:c=e,a.sheetRows&&a.sheetRows<=c.r&&(S=!0),m=AMe(h=c.r),a["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=iDe(e.hpt)),F[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":f=BFe[e[1]],u.v=f.t,u.r=f.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==a.cellText&&(u.w=EPe[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((d=s.CellXf[e[0].iStyleRef])&&KFe(u,d.numFmtId,null,a,o,s),p=-1==e[0].c?p+1:e[0].c,a.dense?(w[h]||(w[h]=[]),w[h][p]=u):w[FMe(p)+m]=u,a.cellFormula){for(E=!1,R=0;R<T.length;++R){var N=T[R];c.r>=N[0].s.r&&c.r<=N[0].e.r&&p>=N[0].s.c&&p<=N[0].e.c&&(u.F=_Me(N[0]),E=!0)}!E&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>p&&(b.s.c=p),b.e.r<c.r&&(b.e.r=c.r),b.e.c<p&&(b.e.c=p),a.cellDates&&d&&"n"==u.t&&BEe(hEe[d.numFmtId])){var L=mEe(u.v);L&&(u.t="d",u.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}I&&("XLDAPR"==I.type&&(u.D=!0),I=void 0),A&&(A=void 0);break;case 1:case 12:if(!a.sheetStubs||y)break;u={t:"z",v:void 0},p=-1==e[0].c?p+1:e[0].c,a.dense?(w[h]||(w[h]=[]),w[h][p]=u):w[FMe(p)+m]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>p&&(b.s.c=p),b.e.r<c.r&&(b.e.r=c.r),b.e.c<p&&(b.e.c=p),I&&("XLDAPR"==I.type&&(u.D=!0),I=void 0),A&&(A=void 0);break;case 176:x.push(e);break;case 49:I=((a.xlmeta||{}).Cell||[])[e-1];break;case 494:var _=r["!id"][e.relId];for(_?(e.Target=_.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=_):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(p=e.rfx.s.c;p<=e.rfx.e.c;++p)a.dense?(w[h]||(w[h]=[]),w[h][p]||(w[h][p]={t:"z",v:void 0}),w[h][p].l=e):(g=NMe({c:p,r:h}),w[g]||(w[g]={t:"z",v:void 0}),w[g].l=e);break;case 426:if(!a.cellFormula)break;T.push(e),(v=a.dense?w[h][p]:w[FMe(p)+m]).f=xFe(e[1],0,{r:c.r,c:p},M,a),v.F=_Me(e[0]);break;case 427:if(!a.cellFormula)break;k[NMe(e[0].s)]=e[1],(v=a.dense?w[h][p]:w[FMe(p)+m]).f=xFe(e[1],0,{r:c.r,c:p},M,a);break;case 60:if(!a.cellStyles)break;for(;e.e>=e.s;)D[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},O||(O=!0,eDe(e.w/256)),tDe(D[e.e+1]);break;case 161:w["!autofilter"]={ref:_Me(e)};break;case 476:w["!margins"]=e;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name),(e.above||e.left)&&(w["!outline"]={above:e.above,left:e.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:C.push(P),y=!0;break;case 38:C.pop(),y=!1;break;default:if(t.T);else if(!y||a.WTF)throw new Error("Unexpected record 0x"+P.toString(16))}},a),delete a.supbooks,delete a["!row"],!w["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(w["!ref"]=_Me(l||b)),a.sheetRows&&w["!ref"]){var N=HMe(w["!ref"]);a.sheetRows<=+N.e.r&&(N.e.r=a.sheetRows-1,N.e.r>b.e.r&&(N.e.r=b.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>b.e.c&&(N.e.c=b.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),w["!fullref"]=w["!ref"],w["!ref"]=_Me(N))}return x.length>0&&(w["!merges"]=x),D.length>0&&(w["!cols"]=D),F.length>0&&(w["!rows"]=F),w}(e,r,n,i,o,s,a):oOe(e,r,n,i,o,s,a)}function KOe(e,t,n,r,i,o,s,a){return".bin"===t.slice(-4)?function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=[],a=!1;return xMe(e,function(e,r,l){switch(l){case 550:o["!rel"]=e;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),e.name&&(i.Sheets[n].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(l);break;case 38:s.pop();break;default:if(r.T>0)s.push(l);else if(r.T<0)s.pop();else if(!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},t),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}(e,r,n,i,o):function(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var o,s={"!type":"chart","!drawel":null,"!rel":""},a=e.match(nOe);return a&&sOe(a[0],0,i,n),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}(e,0,n,i,o)}function YOe(e,t,n,r){return".bin"===t.slice(-4)?function(e,t,n){var r={NumberFmt:[]};for(var i in hEe)r.NumberFmt[i]=hEe[i];r.CellXf=[],r.Fonts=[];var o=[],s=!1;return xMe(e,function(e,i,a){switch(a){case 44:r.NumberFmt[e[0]]=e[1],$Ee(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=YAe(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==o[o.length-1]&&r.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(a),s=!0;break;case 38:o.pop(),s=!1;break;default:if(i.T>0)o.push(a);else if(i.T<0)o.pop();else if(!s||n.WTF&&37!=o[o.length-1])throw new Error("Unexpected record 0x"+a.toString(16))}}),r}(e,n,r):lDe(e,n,r)}function qOe(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=!1;return xMe(e,function(e,i,o){switch(o){case 159:n.Count=e[0],n.Unique=e[1];break;case 19:n.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(i.T,!r||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,n):function(e,t){var n=[],r="";if(!e)return n;var i=e.match(TAe);if(i){r=i[2].replace(kAe,"").split(MAe);for(var o=0;o!=r.length;++o){var s=EAe(r[o].trim(),t);null!=s&&(n[n.length]=s)}i=WTe(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}(e,n)}function XOe(e,t,n){return".bin"===t.slice(-4)?function(e,t){var n=[],r=[],i={},o=!1;return xMe(e,function(e,s,a){switch(a){case 632:r.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(s.T);else if(!o||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}(e,n):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&n.push(t[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var o=WTe(i[0]),s={author:o.authorId&&n[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},a=OMe(o.ref);if(!(t.sheetRows&&t.sheetRows<=a.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&EAe(l[1])||{r:"",t:"",h:""};s.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),s.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=c.h),r.push(s)}}}}),r}(e,n)}function QOe(e,t,n){return".bin"===t.slice(-4)?function(e){var t=[];return xMe(e,function(e,n,r){if(63===r)t.push(e);else if(!n.T)throw new Error("Unexpected record 0x"+r.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var n=1;return(e.match(HTe)||[]).forEach(function(e){var r=WTe(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?n=r.i:r.i=n,t.push(r)}}),t}(e)}function JOe(e,t,n,r){if(".bin"===n.slice(-4))return function(e,t,n,r){if(!e)return e;var i=r||{},o=!1;xMe(e,function(e,t,n){switch(n){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(t.T);else if(!o||i.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}},i)}(e,0,0,r)}function ZOe(e,t,n){return".bin"===t.slice(-4)?function(e,t,n){var r={Types:[],Cell:[],Value:[]},i=n||{},o=[],s=!1,a=2;return xMe(e,function(e,t,n){switch(n){case 335:r.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==a?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==a&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})});break;case 337:a=e?1:0;break;case 338:a=2;break;case 35:o.push(n),s=!0;break;case 36:o.pop(),s=!1;break;default:if(t.T);else if(!s||i.WTF&&35!=o[o.length-1])throw new Error("Unexpected record 0x"+n.toString(16))}}),r}(e,0,n):function(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i,o=!1,s=2;return e.replace(HTe,function(e){var t=WTe(e);switch(zTe(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:t.name});break;case"<futureMetadata":for(var a=0;a<r.Types.length;++a)r.Types[a].name==t.name&&(i=r.Types[a]);break;case"<rc":1==s?r.Cell.push({type:r.Types[t.t-1].name,index:+t.v}):0==s&&r.Value.push({type:r.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+t.i);break;default:if(!o&&n.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),r}(e,0,n)}function eNe(e,t,n,r,i){return(".bin"===t.slice(-4)?kOe:hOe)(e,n,r,i)}function tNe(e,t,n){return(".bin"===t.slice(-4)?GDe:WDe)(e,n)}var nNe,rNe=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,iNe=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function oNe(e,t){var n=e.split(/\s+/),r=[];if(t||(r[0]=n[0]),1===n.length)return r;var i,o,s,a=e.match(rNe);if(a)for(s=0;s!=a.length;++s)-1===(o=(i=a[s].match(iNe))[1].indexOf(":"))?r[i[1]]=i[2].slice(1,i[2].length-1):r["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1);return r}function sNe(e){var t={};if(1===e.split(/\s+/).length)return t;var n,r,i,o=e.match(rNe);if(o)for(i=0;i!=o.length;++i)-1===(r=(n=o[i].match(iNe))[1].indexOf(":"))?t[n[1]]=n[2].slice(1,n[2].length-1):t["xmlns:"===n[1].slice(0,6)?"xmlns"+n[1].slice(6):n[1].slice(r+1)]=n[2].slice(1,n[2].length-1);return t}function aNe(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ZTe(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=fTe(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[$Te(t)]=i}function lNe(e,t,n){if("z"!==e.t){if(!n||!1!==n.cellText)try{"e"===e.t?e.w=e.w||EPe[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SEe(e.v):e.w=xEe(e.v):e.w=function(e,t){var n=nNe[e]||$Te(e);return"General"===n?xEe(t):GEe(n,t)}(t||"General",e.v)}catch(o){if(n.WTF)throw o}try{var r=nNe[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&"n"==e.t&&BEe(r)){var i=mEe(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(n.WTF)throw o}}}function cNe(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=oDe[r.Pattern]||r.Pattern)}e[t.ID]=t}function uNe(e,t,n,r,i,o,s,a,l,c){var u="General",d=r.StyleID,h={};c=c||{};var p=[],g=0;for(void 0===d&&a&&(d=a.StyleID),void 0===d&&s&&(d=s.StyleID);void 0!==o[d]&&(o[d].nf&&(u=o[d].nf),o[d].Interior&&p.push(o[d].Interior),o[d].Parent);)d=o[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=ZTe(e);break;case"String":r.t="s",r.r=JTe($Te(e)),r.v=e.indexOf("<")>-1?$Te(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(fTe(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!==r.v?r.v=$Te(e):r.v<60&&(r.v=r.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=TPe[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==t?r.t="z":(r.t="s",r.v=JTe(t||e))}if(lNe(r,u,c),!1!==c.cellFormula)if(r.Formula){var f=$Te(r.Formula);61==f.charCodeAt(0)&&(f=f.slice(1)),r.f=UDe(f,i),delete r.Formula,"RC"==r.ArrayRange?r.F=UDe("RC:RC",i):r.ArrayRange&&(r.F=UDe(r.ArrayRange,i),l.push([HMe(r.F),r.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(r.F=l[g][1]);c.cellStyles&&(p.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),r.s=h),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function dNe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function hNe(e,t){var n=t||{};KEe();var r=BRe(vke(e));"binary"!=n.type&&"array"!=n.type&&"base64"!=n.type||(r="undefined"!==typeof VRe?VRe.utils.decode(65001,_Re(r)):ike(r));var i,o=r.slice(0,1024).toLowerCase(),s=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";"))){var a=vTe(n);return a.type="string",wAe.to_workbook(r,a)}if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){o.indexOf("<"+e)>=0&&(s=!0)}),s)return function(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||0==n.length)throw new Error("Invalid HTML: could not find <table>");if(1==n.length)return WMe(jNe(n[0],t),t);var r={SheetNames:[],Sheets:{}};return n.forEach(function(e,n){a_e(r,jNe(e,t),"Sheet"+(n+1))}),r}(r,n);nNe={"General Number":"General","General Date":hEe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":hEe[15],"Short Date":hEe[14],"Long Time":hEe[19],"Medium Time":hEe[18],"Short Time":hEe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:hEe[2],Standard:hEe[4],Percent:hEe[10],Scientific:hEe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,d={},h=[],p=n.dense?[]:{},g="",f={},m={},v=oNe('<Data ss:Type="String">'),w=0,b=0,C=0,y={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},x={},R="",E=0,T=[],k={},M={},P=0,I=[],A=[],D={},F=[],O=!1,N=[],L=[],_={},H=0,V=0,B={Sheets:[],WBProps:{date1904:!1}},W={};wke.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var z="";i=wke.exec(r);)switch(i[3]=(z=i[3]).toLowerCase()){case"data":if("data"==z){if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break}if(c[c.length-1][1])break;"/"===i[1]?uNe(r.slice(w,i.index),R,v,"comment"==c[c.length-1][0]?D:f,{c:b,r:C},S,F[b],m,N,n):(R="",v=oNe(i[0]),w=i.index+i[0].length);break;case"cell":if("/"===i[1])if(A.length>0&&(f.c=A),(!n.sheetRows||n.sheetRows>C)&&void 0!==f.v&&(n.dense?(p[C]||(p[C]=[]),p[C][b]=f):p[FMe(b)+AMe(C)]=f),f.HRef&&(f.l={Target:$Te(f.HRef)},f.HRefScreenTip&&(f.l.Tooltip=f.HRefScreenTip),delete f.HRef,delete f.HRefScreenTip),(f.MergeAcross||f.MergeDown)&&(H=b+(0|parseInt(f.MergeAcross,10)),V=C+(0|parseInt(f.MergeDown,10)),T.push({s:{c:b,r:C},e:{c:H,r:V}})),n.sheetStubs)if(f.MergeAcross||f.MergeDown){for(var j=b;j<=H;++j)for(var G=C;G<=V;++G)(j>b||G>C)&&(n.dense?(p[G]||(p[G]=[]),p[G][j]={t:"z"}):p[FMe(j)+AMe(G)]={t:"z"});b=H+1}else++b;else f.MergeAcross?b=H+1:++b;else(f=sNe(i[0])).Index&&(b=+f.Index-1),b<y.s.c&&(y.s.c=b),b>y.e.c&&(y.e.c=b),"/>"===i[0].slice(-2)&&++b,A=[];break;case"row":"/"===i[1]||"/>"===i[0].slice(-2)?(C<y.s.r&&(y.s.r=C),C>y.e.r&&(y.e.r=C),"/>"===i[0].slice(-2)&&(m=oNe(i[0])).Index&&(C=+m.Index-1),b=0,++C):((m=oNe(i[0])).Index&&(C=+m.Index-1),_={},("0"==m.AutoFitHeight||m.Height)&&(_.hpx=parseInt(m.Height,10),_.hpt=rDe(_.hpx),L[C]=_),"1"==m.Hidden&&(_.hidden=!0,L[C]=_));break;case"worksheet":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));h.push(g),y.s.r<=y.e.r&&y.s.c<=y.e.c&&(p["!ref"]=_Me(y),n.sheetRows&&n.sheetRows<=y.e.r&&(p["!fullref"]=p["!ref"],y.e.r=n.sheetRows-1,p["!ref"]=_Me(y))),T.length&&(p["!merges"]=T),F.length>0&&(p["!cols"]=F),L.length>0&&(p["!rows"]=L),d[g]=p}else y={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=b=0,c.push([i[3],!1]),l=oNe(i[0]),g=$Te(l.Name),p=n.dense?[]:{},T=[],N=[],L=[],W={name:g,Hidden:0},B.Sheets.push(W);break;case"table":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==i[0].slice(-2))break;c.push([i[3],!1]),F=[],O=!1}break;case"style":"/"===i[1]?cNe(S,x,n):x=oNe(i[0]);break;case"numberformat":x.nf=$Te(oNe(i[0]).Format||"General"),nNe[x.nf]&&(x.nf=nNe[x.nf]);for(var $=0;392!=$&&hEe[$]!=x.nf;++$);if(392==$)for($=57;392!=$;++$)if(null==hEe[$]){$Ee(x.nf,$);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=oNe(i[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!O&&u.wpx>10){O=!0,qAe=6;for(var U=0;U<F.length;++U)F[U]&&tDe(F[U])}O&&tDe(u),F[u.Index-1||F.length]=u;for(var K=0;K<+u.Span;++K)F[F.length]=vTe(u);break;case"namedrange":if("/"===i[1])break;B.Names||(B.Names=[]);var Y=WTe(i[0]),q={Name:Y.Name,Ref:UDe(Y.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(q.Sheet=B.Sheets.length-1),B.Names.push(q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===i[0].slice(-2))break;"/"===i[1]?R+=r.slice(E,i.index):E=i.index+i[0].length;break;case"interior":if(!n.cellStyles)break;x.Interior=oNe(i[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===i[0].slice(-2))break;"/"===i[1]?QPe(k,z,r.slice(P,i.index)):P=i.index+i[0].length;break;case"styles":case"workbook":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else c.push([i[3],!1]);break;case"comment":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));dNe(D),A.push(D)}else c.push([i[3],!1]),D={a:(l=oNe(i[0])).Author};break;case"autofilter":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var X=oNe(i[0]);p["!autofilter"]={ref:UDe(X.Range).replace(/\$/g,"")},c.push([i[3],!0])}break;case"datavalidation":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;default:if(0==c.length&&"document"==i[3])return nLe(r,n);if(0==c.length&&"uof"==i[3])return nLe(r,n);var Q=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(i[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(i[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(r.slice(P,i.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2}else P=i.index+i[0].length;break;case"header":p["!margins"]||$Fe(p["!margins"]={},"xlml"),isNaN(+WTe(i[0]).Margin)||(p["!margins"].header=+WTe(i[0]).Margin);break;case"footer":p["!margins"]||$Fe(p["!margins"]={},"xlml"),isNaN(+WTe(i[0]).Margin)||(p["!margins"].footer=+WTe(i[0]).Margin);break;case"pagemargins":var J=WTe(i[0]);p["!margins"]||$Fe(p["!margins"]={},"xlml"),isNaN(+J.Top)||(p["!margins"].top=+J.Top),isNaN(+J.Left)||(p["!margins"].left=+J.Left),isNaN(+J.Right)||(p["!margins"].right=+J.Right),isNaN(+J.Bottom)||(p["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(i[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(i[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?aNe(M,z,I,r.slice(P,i.index)):(I=i,P=i.index+i[0].length);break}if(n.WTF)throw"Unrecognized tag: "+i[3]+"|"+c.join("|")}var Z={};return n.bookSheets||n.bookProps||(Z.Sheets=d),Z.SheetNames=h,Z.Workbook=B,Z.SSF=vTe(hEe),Z.Props=k,Z.Custprops=M,Z}function pNe(e,t){switch(OLe(t=t||{}),t.type||"base64"){case"base64":return hNe($Re(e),t);case"binary":case"buffer":case"file":return hNe(e,t);case"array":return hNe(JRe(e),t)}}function gNe(e,t){var n=[];return e.Props&&n.push(function(e,t){var n=[];return tTe(XPe).map(function(e){for(var t=0;t<HPe.length;++t)if(HPe[t][1]==e)return HPe[t];for(t=0;t<jPe.length;++t)if(jPe[t][1]==e)return jPe[t];throw e}).forEach(function(r){if(null!=e[r[1]]){var i=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(pke(XPe[r[1]]||r[1],i))}}),fke("DocumentProperties",n.join(""),{xmlns:Fke})}(e.Props,t)),e.Custprops&&n.push(function(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&tTe(e).forEach(function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<HPe.length;++r)if(t==HPe[r][1])return;for(r=0;r<jPe.length;++r)if(t==jPe[r][1])return;for(r=0;r<n.length;++r)if(t==n[r])return;var o=e[t],s="string";"number"==typeof o?(s="float",o=String(o)):!0===o||!1===o?(s="boolean",o=o?"1":"0"):o=String(o),i.push(fke(qTe(t),o,{"dt:dt":s}))}}),t&&tTe(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)&&(!e||!Object.prototype.hasOwnProperty.call(e,n))){var r=t[n],o="string";"number"==typeof r?(o="float",r=String(r)):!0===r||!1===r?(o="boolean",r=r?"1":"0"):r instanceof Date?(o="dateTime.tz",r=r.toISOString()):r=String(r),i.push(fke(qTe(n),r,{"dt:dt":o}))}}),"<"+r+' xmlns="'+Fke+'">'+i.join("")+"</"+r+">"}(e.Props,e.Custprops)),n.join("")}function fNe(e){return fke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+YDe(e.Ref,{r:0,c:0})})}function mNe(e,t,n,r,i,o,s){if(!e||void 0==e.v&&void 0==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+YTe(YDe(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=OMe(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=YTe(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=YTe(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=EPe[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||hEe[14]);break;case"s":d="String",h=((e.v||"")+"").replace(UTe,function(e){return GTe[e]}).replace(XTe,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}var p=UFe(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+p),a["ss:Index"]=s.c+1;var g=null!=e.v?h:"",f="z"==e.t?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(f+=e.c.map(function(e){var t=fke("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return fke("Comment",t,{"ss:Author":e.a})}).join("")),fke("Cell",f,a)}function vNe(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=iDe(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function wNe(e,t,n){var r=[],i=n.SheetNames[e],o=n.Sheets[i],s=o?function(e,t,n,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],s=0;s<i.length;++s){var a=i[s];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||o.push(fNe(a)))}return o.join("")}(o,0,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=o?function(e,t){if(!e["!ref"])return"";var n=HMe(e["!ref"]),r=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(e,t){tDe(e);var n=!!e.width,r=GFe(t,e),i={"ss:Index":t+1};n&&(i["ss:Width"]=XAe(r.width)),e.hidden&&(i["ss:Hidden"]="1"),o.push(fke("Column",null,i))});for(var s=Array.isArray(e),a=n.s.r;a<=n.e.r;++a){for(var l=[vNe(a,(e["!rows"]||[])[a])],c=n.s.c;c<=n.e.c;++c){var u=!1;for(i=0;i!=r.length;++i)if(!(r[i].s.c>c)&&!(r[i].s.r>a)&&!(r[i].e.c<c)&&!(r[i].e.r<a)){r[i].s.c==c&&r[i].s.r==a||(u=!0);break}if(!u){var d={r:a,c:c},h=NMe(d),p=s?(e[a]||[])[c]:e[h];l.push(mNe(p,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}(o,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(fke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(fke("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(fke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(fke("Visible",1==r.Workbook.Sheets[n].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&(!r.Workbook.Sheets[o]||r.Workbook.Sheets[o].Hidden);++o);o==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(pke("ProtectContents","True")),e["!protect"].objects&&i.push(pke("ProtectObjects","True")),e["!protect"].scenarios&&i.push(pke("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(pke("EnableSelection","UnlockedCells")):i.push(pke("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")})),0==i.length?"":fke("WorksheetOptions",i.join(""),{xmlns:Oke})}(o,0,e,n)),r.join("")}function bNe(e,t){t||(t={}),e.SSF||(e.SSF=vTe(hEe)),e.SSF&&(KEe(),UEe(e.SSF),t.revssf=iTe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],UFe(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(gNe(e,t)),n.push(""),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(fke("Worksheet",wNe(r,t,e),{"ss:Name":YTe(e.SheetNames[r])}));return n[2]=function(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(e,t){var r=[];r.push(fke("NumberFormat",null,{"ss:Format":YTe(hEe[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};n.push(fke("Style",r.join(""),i))}),fke("Styles",n.join(""))}(0,t),n[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||n.push(fNe(i)))}return fke("Names",n.join(""))}(e),NTe+fke("Workbook",n.join(""),{xmlns:Nke,"xmlns:o":Fke,"xmlns:x":Oke,"xmlns:ss":Nke,"xmlns:dt":Lke,"xmlns:html":Vke})}function CNe(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return mPe(e,1)}(n),n.length-n.l<=4)return t;var r=n.read_shift(4);return 0==r||r>40?t:(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4||1907505652!==(r=n.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return mPe(e,2)}(n),0==(r=n.read_shift(4))||r>40?t:(n.l-=4,void(t.Reserved2=n.read_shift(0,"lpwstr")))))}var yNe=[60,1084,2066,2165,2175];function SNe(e,t,n,r,i){var o=r,s=[],a=n.slice(n.l,n.l+o);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(a)}s.push(a),n.l+=o;for(var l=cMe(n,n.l),c=DNe[l],u=0;null!=c&&yNe.indexOf(l)>-1;)o=cMe(n,n.l+2),u=n.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),a=n.slice(u,n.l+4+o),s.push(a),n.l+=4+o,c=DNe[l=cMe(n,n.l)];var d=eEe(s);CMe(d,0);var h=0;d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(h),h+=s[p].length;if(d.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+r;return t.f(d,d.length,i)}function xNe(e,t,n){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=hEe[r])}catch(o){if(t.WTF)throw o}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||EPe[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=SEe(e.v):e.w=xEe(e.v):e.w=GEe(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&r&&"n"==e.t&&BEe(hEe[r]||String(r))){var i=mEe(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function RNe(e,t,n){return{v:e,ixfe:t,t:n}}function ENe(e,t){var n={opts:{}},r={};var i,o,s,a,l,c,u,d,h=t.dense?[]:{},p={},g={},f=null,m=[],v="",w={},b="",C={},y=[],S=[],x=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(e){return e<8?RPe[e]:e<64&&x[e-8]||RPe[e]},k=function(e,t,n){if(!(_>1)&&!(n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,n){var r,i=t.XF.data;i&&i.patternType&&n&&n.cellStyles&&(t.s={},t.s.patternType=i.patternType,(r=KAe(T(i.icvFore)))&&(t.s.fgColor={rgb:r}),(r=KAe(T(i.icvBack)))&&(t.s.bgColor={rgb:r}))}(0,t,n),delete t.ixfe,delete t.XF,i=e,b=NMe(e),g&&g.s&&g.e||(g={s:{r:0,c:0},e:{r:0,c:0}}),e.r<g.s.r&&(g.s.r=e.r),e.c<g.s.c&&(g.s.c=e.c),e.r+1>g.e.r&&(g.e.r=e.r+1),e.c+1>g.e.c&&(g.e.c=e.c+1),n.cellFormula&&t.f)for(var r=0;r<y.length;++r)if(!(y[r][0].s.c>e.c||y[r][0].s.r>e.r)&&!(y[r][0].e.c<e.c||y[r][0].e.r<e.r)){t.F=_Me(y[r][0]),y[r][0].s.c==e.c&&y[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+xFe(y[r][1],0,e,O,M));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[b]=t}},M={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(M.password=t.password);var P=[],I=[],A=[],D=[],F=!1,O=[];O.SheetNames=M.snames,O.sharedf=M.sharedf,O.arrayf=M.arrayf,O.names=[],O.XTI=[];var N,L=0,_=0,H=0,V=[],B=[];M.codepage=1200,NRe(1200);for(var W=!1;e.l<e.length-1;){var z=e.l,j=e.read_shift(2);if(0===j&&10===L)break;var G=e.l===e.length?0:e.read_shift(2),$=DNe[j];if($&&$.f){if(t.bookSheets&&133===L&&133!==j)break;if(L=j,2===$.r||12==$.r){var U=e.read_shift(2);if(G-=2,!M.enc&&U!==j&&((255&U)<<8|U>>8)!==j)throw new Error("rt mismatch: "+U+"!="+j);12==$.r&&(e.l+=10,G-=10)}var K={};if(K=10===j?$.f(e,G,M):SNe(j,$,e,G,M),0==_&&-1===[9,521,1033,2057].indexOf(L))continue;switch(j){case 34:n.opts.Date1904=R.WBProps.date1904=K;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(M.enc||(e.l=0),M.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=K;break;case 66:var Y=Number(K);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}NRe(M.codepage=Y),W=!0;break;case 317:M.rrtabid=K;break;case 25:M.winlocked=K;break;case 439:n.opts.RefreshAll=K;break;case 12:n.opts.CalcCount=K;break;case 16:n.opts.CalcDelta=K;break;case 17:n.opts.CalcIter=K;break;case 13:n.opts.CalcMode=K;break;case 14:n.opts.CalcPrecision=K;break;case 95:n.opts.CalcSaveRecalc=K;break;case 15:M.CalcRefMode=K;break;case 2211:n.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:S.push(K);break;case 430:O.push([K]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(K);break;case 24:case 536:N={Name:K.Name,Ref:xFe(K.rgce,0,null,O,M)},K.itab>0&&(N.Sheet=K.itab-1),O.names.push(N),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(B[K.itab-1]={ref:_Me(K.rgce[0][0][1][2])});break;case 22:M.ExternCount=K;break;case 23:0==O.length&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(K),O.XTI=O.XTI.concat(K);break;case 2196:if(M.biff<8)break;null!=N&&(N.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&M.WTF&&console.error("Password verifier: "+K);break;case 133:p[K.pos]=K,M.snames.push(K.name);break;case 10:if(--_)break;if(g.e){if(g.e.r>0&&g.e.c>0){if(g.e.r--,g.e.c--,h["!ref"]=_Me(g),t.sheetRows&&t.sheetRows<=g.e.r){var q=g.e.r;g.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=_Me(g),g.e.r=q}g.e.r++,g.e.c++}P.length>0&&(h["!merges"]=P),I.length>0&&(h["!objects"]=I),A.length>0&&(h["!cols"]=A),D.length>0&&(h["!rows"]=D),R.Sheets.push(E)}""===v?w=h:r[v]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===M.biff&&(M.biff={9:2,521:3,1033:4}[j]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),M.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(M.biff=5,W=!0,NRe(M.codepage=28591)),8==M.biff&&0==K.BIFFVer&&16==K.dt&&(M.biff=2),_++)break;if(h=t.dense?[]:{},M.biff<8&&!W&&(W=!0,NRe(M.codepage=t.codepage||1252)),M.biff<5||0==K.BIFFVer&&4096==K.dt){""===v&&(v="Sheet1"),g={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-G,name:v};p[X.pos]=X,M.snames.push(v)}else v=(p[z]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),P=[],I=[],M.arrayf=y=[],A=[],D=[],F=!1,E={Hidden:(p[z]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[NMe({c:K.c,r:K.r})])&&++K.c,c={ixfe:K.ixfe,XF:S[K.ixfe]||{},v:K.val,t:"n"},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 5:case 517:c={ixfe:K.ixfe,XF:S[K.ixfe],v:K.val,t:K.t},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 638:c={ixfe:K.ixfe,XF:S[K.ixfe],v:K.rknum,t:"n"},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 189:for(var Q=K.c;Q<=K.C;++Q){var J=K.rkrec[Q-K.c][0];c={ixfe:J,XF:S[J],v:K.rkrec[Q-K.c][1],t:"n"},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:Q,r:K.r},c,t)}break;case 6:case 518:case 1030:if("String"==K.val){f=K;break}if((c=RNe(K.val,K.cell.ixfe,K.tt)).XF=S[c.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],ne=NMe({r:ee,c:te});C[ne]?c.f=""+xFe(K.formula,0,K.cell,O,M):c.F=((t.dense?(h[ee]||[])[te]:h[ne])||{}).F}else c.f=""+xFe(K.formula,0,K.cell,O,M)}H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k(K.cell,c,t),f=K;break;case 7:case 519:if(!f)throw new Error("String record expects Formula");f.val=K,(c=RNe(K,f.cell.ixfe,"s")).XF=S[c.ixfe],t.cellFormula&&(c.f=""+xFe(f.formula,0,f.cell,O,M)),H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k(f.cell,c,t),f=null;break;case 33:case 545:y.push(K);var re=NMe(K[0].s);if(o=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[re],t.cellFormula&&o){if(!f)break;if(!re||!o)break;o.f=""+xFe(K[1],0,K[0],O,M),o.F=_Me(K[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!f)break;C[NMe(f.cell)]=K[0],((o=t.dense?(h[f.cell.r]||[])[f.cell.c]:h[NMe(f.cell)])||{}).f=""+xFe(K[0],0,i,O,M)}break;case 253:c=RNe(m[K.isst].t,K.ixfe,"s"),m[K.isst].h&&(c.h=m[K.isst].h),c.XF=S[c.ixfe],H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:K.ixfe,XF:S[K.ixfe],t:"z"},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t));break;case 190:if(t.sheetStubs)for(var ie=K.c;ie<=K.C;++ie){var oe=K.ixfe[ie-K.c];c={ixfe:oe,XF:S[oe],t:"z"},H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:ie,r:K.r},c,t)}break;case 214:case 516:case 4:(c=RNe(K.val,K.ixfe,"s")).XF=S[c.ixfe],H>0&&(c.z=V[c.ixfe>>8&63]),xNe(c,t,n.opts.Date1904),k({c:K.c,r:K.r},c,t);break;case 0:case 512:1===_&&(g=K);break;case 252:m=K;break;case 1054:if(4==M.biff){V[H++]=K[1];for(var se=0;se<H+163&&hEe[se]!=K[1];++se);se>=163&&$Ee(K[1],H+163)}else $Ee(K[1],K[0]);break;case 30:V[H++]=K;for(var ae=0;ae<H+163&&hEe[ae]!=K;++ae);ae>=163&&$Ee(K,H+163);break;case 229:P=P.concat(K);break;case 93:I[K.cmo[0]]=M.lastobj=K;break;case 438:M.lastobj.TxO=K;break;case 127:M.lastobj.ImData=K;break;case 440:for(l=K[0].s.r;l<=K[0].e.r;++l)for(a=K[0].s.c;a<=K[0].e.c;++a)(o=t.dense?(h[l]||[])[a]:h[NMe({c:a,r:l})])&&(o.l=K[1]);break;case 2048:for(l=K[0].s.r;l<=K[0].e.r;++l)for(a=K[0].s.c;a<=K[0].e.c;++a)(o=t.dense?(h[l]||[])[a]:h[NMe({c:a,r:l})])&&o.l&&(o.l.Tooltip=K[1]);break;case 28:if(M.biff<=5&&M.biff>=2)break;o=t.dense?(h[K[0].r]||[])[K[0].c]:h[NMe(K[0])];var le=I[K[2]];o||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),o=h[K[0].r][K[0].c]={t:"z"}):o=h[NMe(K[0])]={t:"z"},g.e.r=Math.max(g.e.r,K[0].r),g.s.r=Math.min(g.s.r,K[0].r),g.e.c=Math.max(g.e.c,K[0].c),g.s.c=Math.min(g.s.c,K[0].c)),o.c||(o.c=[]),s={a:K[1],t:le.TxO.t},o.c.push(s);break;case 2173:NDe(S[K.ixfe],K.ext);break;case 125:if(!M.cellStyles)break;for(;K.e>=K.s;)A[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},F||(F=!0,eDe(K.w/256)),tDe(A[K.e+1]);break;case 520:var ce={};null!=K.level&&(D[K.r]=ce,ce.level=K.level),K.hidden&&(D[K.r]=ce,ce.hidden=!0),K.hpt&&(D[K.r]=ce,ce.hpt=K.hpt,ce.hpx=iDe(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||$Fe(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[j]]=K;break;case 161:h["!margins"]||$Fe(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(R.Views[0].RTL=!0);break;case 146:x=K;break;case 2198:d=K;break;case 140:u=K;break;case 442:v?E.CodeName=K||E.name:R.WBProps.CodeName=K||"ThisWorkbook"}}else $||console.error("Missing Info for XLS Record 0x"+j.toString(16)),e.l+=G}return n.SheetNames=tTe(p).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return p[e].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&w["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=w)):n.Preamble=w,n.Sheets&&B.forEach(function(e,t){n.Sheets[n.SheetNames[t]]["!autofilter"]=e}),n.Strings=m,n.SSF=vTe(hEe),M.enc&&(n.Encryption=M.enc),d&&(n.Themes=d),n.Metadata={},void 0!==u&&(n.Metadata.Country=u),O.names.length>0&&(R.Names=O.names),n.Workbook=R,n}var TNe="e0859ff2f94f6810ab9108002b27b3d9",kNe="02d5cdd59c2e1b10939708002b2cf9ae",MNe="05d5cdd59c2e1b10939708002b2cf9ae";function PNe(e,t){var n,r,i,o;if(t||(t={}),OLe(t),LRe(),t.codepage&&ORe(t.codepage),e.FullPaths){if(QEe.find(e,"/encryption"))throw new Error("File is password-protected");n=QEe.find(e,"!CompObj"),r=QEe.find(e,"/Workbook")||QEe.find(e,"/Book")}else{switch(t.type){case"base64":e=XRe($Re(e));break;case"binary":e=XRe(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}CMe(e,0),r={content:e}}if(n&&CNe(n),t.bookProps&&!t.bookSheets)i={};else{var s=URe?"buffer":"array";if(r&&r.content)i=ENe(r.content,t);else if((o=QEe.find(e,"PerfectOffice_MAIN"))&&o.content)i=bAe.to_workbook(o.content,(t.type=s,t));else{if(!(o=QEe.find(e,"NativeContent_MAIN"))||!o.content)throw(o=QEe.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=bAe.to_workbook(o.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&QEe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=QEe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if("/"!==n.slice(-1)&&n.match(/_VBA_PROJECT_CUR/)){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");QEe.utils.cfb_add(t,i,e.FileIndex[r].content)}}),QEe.write(t)}(e))}var a={};return e.FullPaths&&function(e,t,n){var r=QEe.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=hIe(r,bPe,kNe);for(var o in i)t[o]=i[o]}catch(c){if(n.WTF)throw c}var s=QEe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var a=hIe(s,CPe,TNe);for(var l in a)null==t[l]&&(t[l]=a[l])}catch(c){if(n.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&($Pe(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}function INe(e,t){var n=t||{},r=QEe.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return QEe.utils.cfb_add(r,i,zNe(e,n)),8==n.biff&&(e.Props||e.Custprops)&&function(e,t){var n,r=[],i=[],o=[],s=0,a=nTe(bPe,"n"),l=nTe(CPe,"n");if(e.Props)for(n=tTe(e.Props),s=0;s<n.length;++s)(Object.prototype.hasOwnProperty.call(a,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?i:o).push([n[s],e.Props[n[s]]]);if(e.Custprops)for(n=tTe(e.Custprops),s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},n[s])||(Object.prototype.hasOwnProperty.call(a,n[s])?r:Object.prototype.hasOwnProperty.call(l,n[s])?i:o).push([n[s],e.Custprops[n[s]]]);var c=[];for(s=0;s<o.length;++s)cIe.indexOf(o[s][0])>-1||GPe.indexOf(o[s][0])>-1||null!=o[s][1]&&c.push(o[s]);i.length&&QEe.utils.cfb_add(t,"/\x05SummaryInformation",pIe(i,TNe,l,CPe)),(r.length||c.length)&&QEe.utils.cfb_add(t,"/\x05DocumentSummaryInformation",pIe(r,kNe,a,bPe,c.length?c:null,MNe))}(e,r),8==n.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach(function(n,r){if(0!=r){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&QEe.utils.cfb_add(e,i,t.FileIndex[r].content)}})}(r,QEe.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var ANe={0:{f:function(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,7&o&&(n.level=7&o),16&o&&(n.hidden=!0),32&o&&(n.hpt=i/20),n}},1:{f:function(e){return[QMe(e)]}},2:{f:function(e){return[QMe(e),lPe(e),"n"]}},3:{f:function(e){return[QMe(e),e.read_shift(1),"e"]}},4:{f:function(e){return[QMe(e),e.read_shift(1),"b"]}},5:{f:function(e){return[QMe(e),pPe(e),"n"]}},6:{f:function(e){return[QMe(e),$Me(e),"str"]}},7:{f:function(e){return[QMe(e),e.read_shift(4),"s"]}},8:{f:function(e,t,n){var r=e.l+t,i=QMe(e);i.r=n["!row"];var o=[i,$Me(e),"str"];if(n.cellFormula){e.l+=2;var s=IFe(e,r-e.l,n);o[3]=xFe(s,0,i,n.supbooks,n)}else e.l=r;return o}},9:{f:function(e,t,n){var r=e.l+t,i=QMe(e);i.r=n["!row"];var o=[i,pPe(e),"n"];if(n.cellFormula){e.l+=2;var s=IFe(e,r-e.l,n);o[3]=xFe(s,0,i,n.supbooks,n)}else e.l=r;return o}},10:{f:function(e,t,n){var r=e.l+t,i=QMe(e);i.r=n["!row"];var o=[i,e.read_shift(1),"b"];if(n.cellFormula){e.l+=2;var s=IFe(e,r-e.l,n);o[3]=xFe(s,0,i,n.supbooks,n)}else e.l=r;return o}},11:{f:function(e,t,n){var r=e.l+t,i=QMe(e);i.r=n["!row"];var o=[i,e.read_shift(1),"e"];if(n.cellFormula){e.l+=2;var s=IFe(e,r-e.l,n);o[3]=xFe(s,0,i,n.supbooks,n)}else e.l=r;return o}},12:{f:function(e){return[ZMe(e)]}},13:{f:function(e){return[ZMe(e),lPe(e),"n"]}},14:{f:function(e){return[ZMe(e),e.read_shift(1),"e"]}},15:{f:function(e){return[ZMe(e),e.read_shift(1),"b"]}},16:{f:mOe},17:{f:function(e){return[ZMe(e),$Me(e),"str"]}},18:{f:function(e){return[ZMe(e),e.read_shift(4),"s"]}},19:{f:YMe},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),o=oPe(e),s=AFe(e,0,n),a=rPe(e);e.l=r;var l={Name:o,Ptg:s};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}},40:{},42:{},43:{f:function(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(r.underline=o);var s=e.read_shift(1);s>0&&(r.family=s);var a=e.read_shift(1);switch(a>0&&(r.charset=a),e.l++,r.color=function(e){var t={},n=e.read_shift(1)>>>1,r=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var l=RPe[r];l&&(t.rgb=KAe(l));break;case 2:t.rgb=KAe([o,s,a]);break;case 3:t.theme=r}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=$Me(e),r}},44:{f:function(e,t){return[e.read_shift(2),$Me(e)]}},45:{f:gDe},46:{f:wDe},47:{f:function(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:cAe},62:{f:function(e){return[QMe(e),YMe(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=NMe(n);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:yMe,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var n={},r=e[e.l];return++e.l,n.above=!(64&r),n.left=!(128&r),e.l+=18,n.name=tPe(e,t-19),n}},148:{f:gOe,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?$Me(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(65536&r),n.backupFile=!!(64&r),n.checkCompatibility=!!(4096&r),n.date1904=!!(1&r),n.filterPrivacy=!!(8&r),n.hidePivotFieldList=!!(1024&r),n.promptedSolutions=!!(16&r),n.publishItems=!!(2048&r),n.refreshAllConnections=!!(262144&r),n.saveExternalLinkValues=!!(128&r),n.showBorderUnselectedTables=!!(4&r),n.showInkAnnotation=!!(32&r),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(32768&r),n.updateLinks=["userSet","never","always"][r>>8&3],n}},154:{},155:{},156:{f:function(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=sPe(e,t-8),n.name=$Me(e),n}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:dPe},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vOe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$Me(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sPe},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iAe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,n){var r=e.l+t,i=uPe(e),o=e.read_shift(1),s=[i];if(s[2]=o,n.cellFormula){var a=PFe(e,r-e.l,n);s[1]=a}else e.l=r;return s}},427:{f:function(e,t,n){var r=e.l+t,i=[dPe(e,16)];if(n.cellFormula){var o=DFe(e,r-e.l,n);i[1]=o,e.l=r}else e.l=r;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return bOe.forEach(function(n){t[n]=pPe(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var n=e.l+t,r=dPe(e,16),i=rPe(e),o=$Me(e),s=$Me(e),a=$Me(e);e.l=n;var l={rfx:r,relId:i,loc:o,display:a};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sPe},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jDe},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var n=dPe(e,16);return t.rfx=n.s,t.ref=NMe(n.s),e.l+=16,t}},636:{T:-1},637:{f:qMe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:$Me(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},DNe={6:{f:TFe},10:{f:gIe},12:{f:vIe},13:{f:vIe},14:{f:fIe},15:{f:fIe},16:{f:pPe},17:{f:fIe},18:{f:fIe},19:{f:vIe},20:{f:eAe},21:{f:eAe},23:{f:iAe},24:{f:rAe},25:{f:fIe},26:{},27:{},28:{f:function(e,t,n){return function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),a=TIe(e,0,n);return n.biff<8&&e.read_shift(1),[{r:r,c:i},a,s,o]}}(e,0,n)}},29:{},34:{f:fIe},35:{f:tAe},38:{f:pPe},39:{f:pPe},40:{f:pPe},41:{f:pPe},42:{f:fIe},43:{f:fIe},47:{f:function(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?$Ae(e,t-2,r):function(e,t,n,r){var i={key:vIe(e),verificationBytes:vIe(e)};n.password&&(i.verifier=zAe(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=GAe(n.password))}(e,n.biff,n,r),r}},49:{f:function(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=yIe(e,0,n),r}},51:{f:vIe},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:fIe},65:{f:function(){}},66:{f:vIe},77:{},80:{},81:{},82:{},85:{f:vIe},89:{},90:{},91:{},92:{f:function(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=TIe(e,0,n);return e.read_shift(t+r-e.l),i}},93:{f:function(e,t,n){if(n&&n.biff<8)return function(e,t,n){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((sAe[r]||yMe)(e,t,n)),{cmo:[i,r,o],ft:s}}(e,t,n);var r=zIe(e),i=function(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{r.push(GIe[i](e,n-e.l))}catch(o){return e.l=n,r}}return e.l!=n&&(e.l=n),r}(e,t-22,r[1]);return{cmo:r,ft:i}}},94:{},95:{f:fIe},96:{},97:{},99:{f:fIe},125:{f:cAe},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,n){var r=n&&8==n.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:vIe},131:{f:fIe},132:{f:fIe},133:{f:function(e,t,n){var r=e.read_shift(4),i=3&e.read_shift(1),o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}var s=yIe(e,0,n);return 0===s.length&&(s="Sheet1"),{pos:r,hs:i,dt:o,name:s}}},134:{},140:{f:function(e){var t,n=[0,0];return t=e.read_shift(2),n[0]=yPe[t]||t,t=e.read_shift(2),n[1]=yPe[t]||t,n}},141:{f:vIe},144:{},146:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(FIe(e));return n}},151:{},152:{},153:{},154:{},155:{},156:{f:vIe},157:{},158:{},160:{f:dAe},161:{f:function(e,t){var n={};return t<32||(e.l+=16,n.header=pPe(e),n.footer=pPe(e),e.l+=2),n}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<n;)o.push(_Ie(e));if(e.l!==n)throw new Error("MulRK read error");var s=e.read_shift(2);if(o.length!=s-i+1)throw new Error("MulRK length mismatch");return{r:r,c:i,C:s,rkrec:o}}},190:{f:function(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<n;)o.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var s=e.read_shift(2);if(o.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r:r,c:i,C:s,ixfe:o}}},193:{f:gIe},197:{},198:{},199:{},200:{},201:{},202:{f:fIe},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vIe},220:{},221:{f:fIe},222:{},224:{f:function(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,t,n,r){var i={},o=e.read_shift(4),s=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return i.patternType=SPe[a>>26],r.cellStyles?(i.alc=7&o,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=15&s,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=127&a,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}(e,0,r.fStyle,n),r}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:gIe},227:{},229:{f:function(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(HIe(e));return n}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var n=e.l+t,r=e.read_shift(4),i=e.read_shift(4),o=[],s=0;s!=i&&e.l<n;++s)o.push(SIe(e));return o.Count=r,o.Unique=i,o}},253:{f:function(e){var t=OIe(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:bIe},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:fIe},353:{f:gIe},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,n){var r=e.l+t,i=e.read_shift(2),o=e.read_shift(2);if(n.sbcch=o,1025==o||14849==o)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=RIe(e,o),a=[];r>e.l;)a.push(EIe(e));return[o,i,s,a]}},431:{f:fIe},432:{},433:{},434:{},437:{},438:{f:function(e,t,n){var r=e.l,i="";try{e.l+=4;var o=(n.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(o)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}(e);var s=e.read_shift(2);e.read_shift(2),vIe(e);var a=e.read_shift(2);e.l+=a;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((i+=RIe(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?s:2*s))break}if(i.length!==s&&i.length!==2*s)throw new Error("cchText: "+s+" != "+i.length);return e.l=r+t,{t:i}}catch(u){return e.l=r+t,{t:i}}}},439:{f:fIe},440:{f:function(e,t){var n=HIe(e);e.l+=16;var r=function(e,t){var n=e.l+t,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var o,s,a,l,c,u,d="";16&i&&(o=PIe(e,e.l)),128&i&&(s=PIe(e,e.l)),257===(257&i)&&(a=PIe(e,e.l)),1===(257&i)&&(l=MIe(e,e.l)),8&i&&(d=PIe(e,e.l)),32&i&&(c=e.read_shift(16)),64&i&&(u=JPe(e)),e.l=n;var h=s||a||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),2&i&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var p={Target:h};return c&&(p.guid=c),u&&(p.time=u),o&&(p.Tooltip=o),p}(e,t-24);return[n,r]}},441:{},442:{f:EIe},443:{},444:{f:vIe},445:{},446:{},448:{f:gIe},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:gIe},512:{f:QIe},513:{f:uAe},515:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5);var r=OIe(e),i=pPe(e);return r.val=i,r}},516:{f:function(e,t,n){n.biffguess&&2==n.biff&&(n.biff=5),e.l;var r=OIe(e);2==n.biff&&e.l++;var i=EIe(e,e.l,n);return r.val=i,r}},517:{f:ZIe},519:{f:hAe},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(t.level=7&r),32&r&&(t.hidden=!0),64&r&&(t.hpt=n/20),t}},523:{},545:{f:oAe},549:{f:YIe},566:{},574:{f:function(e,t,n){return n&&n.biff>=2&&n.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=_Ie(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,t,n){return[e.read_shift(2),TIe(e,0,n)]}},1084:{},1212:{f:function(e,t,n){var r=BIe(e);e.l++;var i=e.read_shift(1);return[EFe(e,t-=8,n),i,r]}},2048:{f:function(e,t){e.read_shift(2);var n=HIe(e),r=e.read_shift((t-10)/2,"dbcs-cont");return[n,r=r.replace(tEe,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:$Ie},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gIe},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var n=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),i=[];r-- >0;)i.push(ODe(e,e.l));return{ixfe:n,ext:i}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:fIe,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2);return[RIe(e,r,n),RIe(e,i,n)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,n){var r=e.l+t;if(124226!==e.read_shift(4))if(n.cellStyles){var i,o=e.slice(e.l);e.l=r;try{i=FTe(o,{type:"array"})}catch(a){return}var s=MTe(i,"theme/theme/theme1.xml",!0);if(s)return ADe(s,n)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:gIe},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vIe},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,n){var r={area:!1};if(5!=n.biff)return e.l+=t,r;var i=e.read_shift(1);return e.l+=3,16&i&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(FIe(e));return n}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:QIe},1:{},2:{f:function(e){var t=OIe(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}},3:{f:function(e){var t=OIe(e);++e.l;var n=pPe(e);return t.t="n",t.val=n,t}},4:{f:function(e,t,n){n.biffguess&&5==n.biff&&(n.biff=2);var r=OIe(e);++e.l;var i=TIe(e,0,n);return r.t="str",r.val=i,r}},5:{f:ZIe},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:$Ie},11:{},22:{f:vIe},30:{f:XIe},31:{},32:{},33:{f:oAe},36:{},37:{f:YIe},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:vIe},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,n){var r=e.l+t,i=OIe(e),o=e.read_shift(2),s=RIe(e,o,n);return e.l=r,i.t="str",i.val=s,i}},223:{},234:{},354:{},421:{},518:{f:TFe},521:{f:$Ie},536:{f:rAe},547:{f:tAe},561:{},579:{},1030:{f:TFe},1033:{f:$Ie},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function FNe(e,t,n,r){var i=t;if(!isNaN(i)){var o=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,o),o>0&&sMe(n)&&e.push(n)}}function ONe(e,t,n){return e||(e=SMe(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function NNe(e,t,n,r){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?sTe(fTe(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?FNe(e,2,function(e,t,n){var r=SMe(9);return ONe(r,e,t),r.write_shift(2,n),r}(n,r,i)):FNe(e,3,function(e,t,n){var r=SMe(15);return ONe(r,e,t),r.write_shift(8,n,"f"),r}(n,r,i)));case"b":case"e":return void FNe(e,5,function(e,t,n,r){var i=SMe(9);return ONe(i,e,t),CIe(n,r||"b",i),i}(n,r,t.v,t.t));case"s":case"str":return void FNe(e,4,function(e,t,n){var r=SMe(8+2*n.length);return ONe(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(n,r,(t.v||"").slice(0,255)))}FNe(e,1,ONe(null,n,r))}function LNe(e,t){var n=t||{};for(var r=RMe(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==n.sheet&&(i=o);if(0==i&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return FNe(r,4==n.biff?1033:3==n.biff?521:9,UIe(0,16,n)),function(e,t,n,r){var i,o=Array.isArray(t),s=HMe(t["!ref"]||"A1"),a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=_Me(s)}for(var c=s.s.r;c<=s.e.r;++c){a=AMe(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=FMe(u)),i=l[u]+a;var d=o?(t[c]||[])[u]:t[i];d&&NNe(e,d,c,u)}}}(r,e.Sheets[e.SheetNames[i]],0,n),FNe(r,10),r.end()}function _Ne(e,t,n){FNe(e,49,function(e,t){var n=e.name||"Arial",r=t&&5==t.biff,i=SMe(r?15+n.length:16+2*n.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,n.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function HNe(e,t){if(t){var n=0;t.forEach(function(t,r){++n<=256&&t&&FNe(e,125,function(e,t){var n=SMe(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,256*e.width),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}(GFe(r,t),r))})}}function VNe(e,t,n,r,i){var o=16+UFe(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)FNe(e,6,kFe(t,n,r,0,o));else switch(t.t){case"d":case"n":FNe(e,515,function(e,t,n,r){var i=SMe(14);return NIe(e,t,r,i),gPe(n,i),i}(n,r,"d"==t.t?sTe(fTe(t.v)):t.v,o));break;case"b":case"e":FNe(e,517,function(e,t,n,r,i,o){var s=SMe(8);return NIe(e,t,r,s),CIe(n,o,s),s}(n,r,t.v,o,0,t.t));break;case"s":case"str":if(i.bookSST)FNe(e,253,function(e,t,n,r){var i=SMe(10);return NIe(e,t,r,i),i.write_shift(4,n),i}(n,r,jFe(i.Strings,t.v,i.revStrings),o));else FNe(e,516,function(e,t,n,r,i){var o=!i||8==i.biff,s=SMe(+o+8+(1+o)*n.length);return NIe(e,t,r,s),s.write_shift(2,n.length),o&&s.write_shift(1,1),s.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),s}(n,r,(t.v||"").slice(0,255),o,i));break;default:FNe(e,513,NIe(n,r,o))}else FNe(e,513,NIe(n,r,o))}function BNe(e,t,n){var r,i=RMe(),o=n.SheetNames[e],s=n.Sheets[o]||{},a=(n||{}).Workbook||{},l=(a.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,d="",h=[],p=HMe(s["!ref"]||"A1"),g=u?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}FNe(i,2057,UIe(0,16,t)),FNe(i,13,wIe(1)),FNe(i,12,wIe(100)),FNe(i,15,mIe(!0)),FNe(i,17,mIe(!1)),FNe(i,16,gPe(.001)),FNe(i,95,mIe(!0)),FNe(i,42,mIe(!1)),FNe(i,43,mIe(!1)),FNe(i,130,wIe(1)),FNe(i,128,function(e){var t=SMe(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),FNe(i,131,mIe(!1)),FNe(i,132,mIe(!1)),u&&HNe(i,s["!cols"]),FNe(i,512,function(e,t){var n=8!=t.biff&&t.biff?2:4,r=SMe(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(p,t)),u&&(s["!links"]=[]);for(var f=p.s.r;f<=p.e.r;++f){d=AMe(f);for(var m=p.s.c;m<=p.e.c;++m){f===p.s.r&&(h[m]=FMe(m)),r=h[m]+d;var v=c?(s[f]||[])[m]:s[r];v&&(VNe(i,v,f,m,t),u&&v.l&&s["!links"].push([r,v.l]))}}var w=l.CodeName||l.name||o;return u&&FNe(i,574,function(e){var t=SMe(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&FNe(i,229,function(e){var t=SMe(2+8*e.length);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)VIe(e[n],t);return t}(s["!merges"])),u&&function(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];FNe(e,440,aAe(r)),r[1].Tooltip&&FNe(e,2048,lAe(r))}delete t["!links"]}(i,s),FNe(i,442,kIe(w)),u&&function(e,t){var n=SMe(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),FNe(e,2151,n),(n=SMe(39)).write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),VIe(HMe(t["!ref"]||"A1"),n),n.write_shift(4,4),FNe(e,2152,n)}(i,s),FNe(i,10),i.end()}function WNe(e,t,n){var r=RMe(),i=(e||{}).Workbook||{},o=i.Sheets||[],s=i.WBProps||{},a=8==n.biff,l=5==n.biff;(FNe(r,2057,UIe(0,5,n)),"xla"==n.bookType&&FNe(r,135),FNe(r,225,a?wIe(1200):null),FNe(r,193,function(e,t){t||(t=SMe(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}(2)),l&&FNe(r,191),l&&FNe(r,192),FNe(r,226),FNe(r,92,function(e,t){var n=!t||8==t.biff,r=SMe(n?112:54);for(r.write_shift(8==t.biff?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}(0,n)),FNe(r,66,wIe(a?1200:1252)),a&&FNe(r,353,wIe(0)),a&&FNe(r,448),FNe(r,317,function(e){for(var t=SMe(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}(e.SheetNames.length)),a&&e.vbaraw&&FNe(r,211),a&&e.vbaraw)&&FNe(r,442,kIe(s.CodeName||"ThisWorkbook"));FNe(r,156,wIe(17)),FNe(r,25,mIe(!1)),FNe(r,18,mIe(!1)),FNe(r,19,wIe(0)),a&&FNe(r,431,mIe(!1)),a&&FNe(r,444,wIe(0)),FNe(r,61,function(){var e=SMe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),FNe(r,64,mIe(!1)),FNe(r,141,wIe(0)),FNe(r,34,mIe("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&ZTe(e.Workbook.WBProps.date1904)?"true":"false"}(e))),FNe(r,14,mIe(!0)),a&&FNe(r,439,mIe(!1)),FNe(r,218,wIe(0)),_Ne(r,0,n),function(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)null!=t[i]&&FNe(e,1054,qIe(i,t[i],n))})}(r,e.SSF,n),function(e,t){for(var n=0;n<16;++n)FNe(e,224,JIe({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){FNe(e,224,JIe(n,0,t))})}(r,n),a&&FNe(r,352,mIe(!1));var c,u=r.end(),d=RMe();a&&FNe(d,140,(c||(c=SMe(4)),c.write_shift(2,1),c.write_shift(2,1),c)),a&&n.Strings&&function(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return FNe(e,t,n,i);var o=t;if(!isNaN(o)){for(var s=n.parts||[],a=0,l=0,c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<i;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=SMe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],r=0;r<e.length;++r)n[r]=xIe(e[r]);var i=eEe([t].concat(n));return i.parts=[t.length].concat(n.map(function(e){return e.length})),i}(n.Strings)),FNe(d,10);var h=d.end(),p=RMe(),g=0,f=0;for(f=0;f<e.SheetNames.length;++f)g+=(a?12:11)+(a?2:1)*e.SheetNames[f].length;var m=u.length+g+h.length;for(f=0;f<e.SheetNames.length;++f){FNe(p,133,KIe({pos:m,hs:(o[f]||{}).Hidden||0,dt:0,name:e.SheetNames[f]},n)),m+=t[f].length}var v=p.end();if(g!=v.length)throw new Error("BS8 "+g+" != "+v.length);var w=[];return u.length&&w.push(u),v.length&&w.push(v),h.length&&w.push(h),eEe(w)}function zNe(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(r&&r["!ref"])LMe(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:return function(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=vTe(hEe)),e&&e.SSF&&(KEe(),UEe(e.SSF),n.revssf=iTe(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,NLe(n),n.cellXfs=[],UFe(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=BNe(i,n,e);return r.unshift(WNe(e,r,n)),eEe(r)}(e,t);case 4:case 3:case 2:return LNe(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function jNe(e,t){var n=t||{};var r=n.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),s=i.index,a=o&&o.index||e.length,l=STe(e.slice(s,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<l.length;++s){var f=l[s].trim(),m=f.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=f.split(/<\/t[dh]>/i);for(a=0;a<v.length;++a){var w=v[a].trim();if(w.match(/<t[dh]/i)){for(var b=w,C=0;"<"==b.charAt(0)&&(C=b.indexOf(">"))>-1;)b=b.slice(C+1);for(var y=0;y<g.length;++y){var S=g[y];S.s.c==u&&S.s.r<c&&c<=S.e.r&&(u=S.e.c+1,y=-1)}var x=WTe(w.slice(0,w.indexOf(">")));h=x.colspan?+x.colspan:1,((d=+x.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var R=x.t||x["data-t"]||"";if(b.length)if(b=ake(b),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),b.length){var E={t:"s",v:b};n.raw||!b.trim().length||"s"==R||("TRUE"===b?E={t:"b",v:!0}:"FALSE"===b?E={t:"b",v:!1}:isNaN(bTe(b))?isNaN(yTe(b).getDate())||(E={t:"d",v:fTe(b)},n.cellDates||(E={t:"n",v:sTe(E.v)}),E.z=n.dateNF||hEe[14]):E={t:"n",v:bTe(b)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=E):r[NMe({r:c,c:u})]=E,u+=h}else u+=h;else u+=h}}}}else{if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0}}return r["!ref"]=_Me(p),g.length&&(r["!merges"]=g),r}function GNe(e,t,n,r){for(var i=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>s)&&!(i[c].e.r<n||i[c].e.c<s)){if(i[c].s.r<n||i[c].s.c<s){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=NMe({r:n,c:s}),d=r.dense?(e[n]||[])[s]:e[u],h=d&&null!=d.v&&(d.h||QTe(d.w||(BMe(d),d.w)||""))||"",p={};a>1&&(p.rowspan=a),l>1&&(p.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",null!=d.v&&(p["data-v"]=d.v),null!=d.z&&(p["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(r.id||"sjs")+"-"+u,o.push(fke("td",h,p))}}return"<tr>"+o.join("")+"</tr>"}var $Ne='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',UNe="</body></html>";function KNe(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function YNe(e,t){var n=t||{},r=null!=n.header?n.header:$Ne,i=null!=n.footer?n.footer:UNe,o=[r],s=LMe(e["!ref"]);n.dense=Array.isArray(e),o.push(KNe(0,0,n));for(var a=s.s.r;a<=s.e.r;++a)o.push(GNe(e,s,a,n));return o.push("</table>"+i),o.join("")}function qNe(e,t,n){var r=n||{};var i=0,o=0;if(null!=r.origin)if("number"==typeof r.origin)i=r.origin;else{var s="string"==typeof r.origin?OMe(r.origin):r.origin;i=s.r,o=s.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var u=LMe(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==i&&(c.e.r=i=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,f=0,m=0,v=0,w=0,b=0;for(e["!cols"]||(e["!cols"]=[]);g<a.length&&f<l;++g){var C=a[g];if(QNe(C)){if(r.display)continue;p[f]={hidden:!0}}var y=C.children;for(m=v=0;m<y.length;++m){var S=y[m];if(!r.display||!QNe(S)){var x=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):ake(S.innerHTML),R=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var E=d[h];E.s.c==v+o&&E.s.r<f+i&&f+i<=E.e.r&&(v=E.e.c+1-o,h=-1)}b=+S.getAttribute("colspan")||1,((w=+S.getAttribute("rowspan")||1)>1||b>1)&&d.push({s:{r:f+i,c:v+o},e:{r:f+i+(w||1)-1,c:v+o+(b||1)-1}});var T={t:"s",v:x},k=S.getAttribute("data-t")||S.getAttribute("t")||"";null!=x&&(0==x.length?T.t=k||"z":r.raw||0==x.trim().length||"s"==k||("TRUE"===x?T={t:"b",v:!0}:"FALSE"===x?T={t:"b",v:!1}:isNaN(bTe(x))?isNaN(yTe(x).getDate())||(T={t:"d",v:fTe(x)},r.cellDates||(T={t:"n",v:sTe(T.v)}),T.z=r.dateNF||hEe[14]):T={t:"n",v:bTe(x)})),void 0===T.z&&null!=R&&(T.z=R);var M="",P=S.getElementsByTagName("A");if(P&&P.length)for(var I=0;I<P.length&&(!P[I].hasAttribute("href")||"#"==(M=P[I].getAttribute("href")).charAt(0));++I);M&&"#"!=M.charAt(0)&&(T.l={Target:M}),r.dense?(e[f+i]||(e[f+i]=[]),e[f+i][v+o]=T):e[NMe({c:v+o,r:f+i})]=T,c.e.c<v+o&&(c.e.c=v+o),v+=b}}++f}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,f-1+i),e["!ref"]=_Me(c),f>=l&&(e["!fullref"]=_Me((c.e.r=a.length-g+f-1+i,c))),e}function XNe(e,t){return qNe((t||{}).dense?[]:{},e,t)}function QNe(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function JNe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[$Te(t.replace(/<[^>]*>/g,""))]}var ZNe={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function eLe(e,t){var n=t||{};var r,i,o,s,a,l,c=vke(e),u=[],d={name:""},h="",p=0,g={},f=[],m=n.dense?[]:{},v={value:""},w="",b=0,C=[],y=-1,S=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,E={},T=[],k={},M=[],P=1,I=1,A=[],D={Names:[]},F={},O=["",""],N=[],L={},_="",H=0,V=!1,B=!1,W=0;for(wke.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");a=wke.exec(c);)switch(a[3]=a[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===a[1]?(x.e.c>=x.s.c&&x.e.r>=x.s.r?m["!ref"]=_Me(x):m["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=x.e.r&&(m["!fullref"]=m["!ref"],x.e.r=n.sheetRows-1,m["!ref"]=_Me(x)),T.length&&(m["!merges"]=T),M.length&&(m["!rows"]=M),o.name=o["\u540d\u79f0"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),f.push(o.name),g[o.name]=m,B=!1):"/"!==a[0].charAt(a[0].length-2)&&(o=WTe(a[0],!1),y=S=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,m=n.dense?[]:{},T=[],M=[],B=!0);break;case"table-row-group":"/"===a[1]?--R:++R;break;case"table-row":case"\u884c":if("/"===a[1]){y+=P,P=1;break}if((s=WTe(a[0],!1))["\u884c\u53f7"]?y=s["\u884c\u53f7"]-1:-1==y&&(y=0),(P=+s["number-rows-repeated"]||1)<10)for(W=0;W<P;++W)R>0&&(M[y+W]={level:R});S=-1;break;case"covered-table-cell":"/"!==a[1]&&++S,n.sheetStubs&&(n.dense?(m[y]||(m[y]=[]),m[y][S]={t:"z"}):m[NMe({r:y,c:S})]={t:"z"}),w="",C=[];break;case"table-cell":case"\u6570\u636e":if("/"===a[0].charAt(a[0].length-2))++S,v=WTe(a[0],!1),I=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=n.cellFormula&&(l.f=LFe($Te(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=$Te(v["string-value"]||""),n.dense?(m[y]||(m[y]=[]),m[y][S]=l):m[NMe({r:y,c:S})]=l),S+=I-1;else if("/"!==a[1]){w="",b=0,C=[],I=1;var z=P?y+P-1:y;if(++S>x.e.c&&(x.e.c=S),S<x.s.c&&(x.s.c=S),y<x.s.r&&(x.s.r=y),z>x.e.r&&(x.e.r=z),N=[],L={},l={t:(v=WTe(a[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},n.cellFormula)if(v.formula&&(v.formula=$Te(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(k={s:{r:y,c:S},e:{r:y+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=_Me(k),A.push([k,l.F])),v.formula)l.f=LFe(v.formula);else for(W=0;W<A.length;++W)y>=A[W][0].s.r&&y<=A[W][0].e.r&&S>=A[W][0].s.c&&S<=A[W][0].e.c&&(l.F=A[W][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(k={s:{r:y,c:S},e:{r:y+(parseInt(v["number-rows-spanned"],10)||0)-1,c:S+(parseInt(v["number-columns-spanned"],10)||0)-1}},T.push(k)),v["number-columns-repeated"]&&(I=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=ZTe(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=fTe(v["date-value"]),n.cellDates||(l.t="n",l.v=sTe(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=dTe(v["time-value"])/86400,n.cellDates&&(l.t="d",l.v=uTe(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(w=$Te(v["string-value"]),C=[])}}else{if(V=!1,"s"===l.t&&(l.v=w||"",C.length&&(l.R=C),V=0==b),F.Target&&(l.l=F),N.length>0&&(l.c=N,N=[]),w&&!1!==n.cellText&&(l.w=w),V&&(l.t="z",delete l.v),(!V||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=y))for(var j=0;j<P;++j){if(I=parseInt(v["number-columns-repeated"]||"1",10),n.dense)for(m[y+j]||(m[y+j]=[]),m[y+j][S]=0==j?l:vTe(l);--I>0;)m[y+j][S+I]=vTe(l);else for(m[NMe({r:y+j,c:S})]=l;--I>0;)m[NMe({r:y+j,c:S+I})]=vTe(l);x.e.c<=S&&(x.e.c=S)}S+=(I=parseInt(v["number-columns-repeated"]||"1",10))-1,I=0,l={},w="",C=[]}F={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===a[1]){if((r=u.pop())[0]!==a[3])throw"Bad state: "+r}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!0]);break;case"annotation":if("/"===a[1]){if((r=u.pop())[0]!==a[3])throw"Bad state: "+r;L.t=w,C.length&&(L.R=C),L.a=_,N.push(L)}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!1]);_="",H=0,w="",b=0,C=[];break;case"creator":"/"===a[1]?_=c.slice(H,a.index):H=a.index+a[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===a[1]){if((r=u.pop())[0]!==a[3])throw"Bad state: "+r}else"/"!==a[0].charAt(a[0].length-2)&&u.push([a[3],!1]);w="",b=0,C=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===a[1]){if(E[d.name]=h,(r=u.pop())[0]!==a[3])throw"Bad state: "+r}else"/"!==a[0].charAt(a[0].length-2)&&(h="",d=WTe(a[0],!1),u.push([a[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":i=WTe(a[0],!1),h+=ZNe[a[3]]["long"===i.style?1:0]}break;case"text":if("/>"===a[0].slice(-2))break;if("/"===a[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(p,a.index)}else p=a.index+a[0].length;break;case"named-range":O=HFe((i=WTe(a[0],!1))["cell-range-address"]);var G={Name:i.name,Ref:O[0]+"!"+O[1]};B&&(G.Sheet=f.length),D.Names.push(G);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==a[1]||v&&v["string-value"])WTe(a[0],!1),b=a.index+a[0].length;else{var $=JNe(c.slice(b,a.index));w=(w.length>0?w+"\n":"")+$[0]}break;case"database-range":if("/"===a[1])break;try{g[(O=HFe(WTe(a[0])["target-range-address"]))[0]]["!autofilter"]={ref:O[1]}}catch(K){}break;case"a":if("/"!==a[1]){if(!(F=WTe(a[0],!1)).href)break;F.Target=$Te(F.href),delete F.href,"#"==F.Target.charAt(0)&&F.Target.indexOf(".")>-1?(O=HFe(F.Target.slice(1)),F.Target="#"+O[0]+"!"+O[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;default:switch(a[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(a)}}var U={Sheets:g,SheetNames:f,Workbook:D};return n.bookSheets&&delete U.Sheets,U}function tLe(e,t){t=t||{},ETe(e,"META-INF/manifest.xml")&&function(e,t){for(var n,r,i=vke(e);n=wke.exec(i);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(r=WTe(n[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}(kTe(e,"META-INF/manifest.xml"),t);var n=MTe(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=eLe(ike(n),t);return ETe(e,"meta.xml")&&(r.Props=BPe(kTe(e,"meta.xml"))),r}function nLe(e,t){return eLe(e,t)}var rLe=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+gke({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return NTe+t}}(),iLe=function(){var e=function(e){return YTe(e).replace(/  +/g,function(e){return'<text:s text:c="'+e.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t="          <table:table-cell />\n",n=function(n,r,i){var o=[];o.push('      <table:table table:name="'+YTe(r.SheetNames[i])+'" table:style-name="ta1">\n');var s=0,a=0,l=LMe(n["!ref"]||"A1"),c=n["!merges"]||[],u=0,d=Array.isArray(n);if(n["!cols"])for(a=0;a<=l.e.c;++a)o.push("        <table:table-column"+(n["!cols"][a]?' table:style-name="co'+n["!cols"][a].ods+'"':"")+"></table:table-column>\n");var h="",p=n["!rows"]||[];for(s=0;s<l.s.r;++s)h=p[s]?' table:style-name="ro'+p[s].ods+'"':"",o.push("        <table:table-row"+h+"></table:table-row>\n");for(;s<=l.e.r;++s){for(h=p[s]?' table:style-name="ro'+p[s].ods+'"':"",o.push("        <table:table-row"+h+">\n"),a=0;a<l.s.c;++a)o.push(t);for(;a<=l.e.c;++a){var g=!1,f={},m="";for(u=0;u!=c.length;++u)if(!(c[u].s.c>a)&&!(c[u].s.r>s)&&!(c[u].e.c<a)&&!(c[u].e.r<s)){c[u].s.c==a&&c[u].s.r==s||(g=!0),f["table:number-columns-spanned"]=c[u].e.c-c[u].s.c+1,f["table:number-rows-spanned"]=c[u].e.r-c[u].s.r+1;break}if(g)o.push("          <table:covered-table-cell/>\n");else{var v=NMe({r:s,c:a}),w=d?(n[s]||[])[a]:n[v];if(w&&w.f&&(f["table:formula"]=YTe(_Fe(w.f)),w.F&&w.F.slice(0,v.length)==v)){var b=LMe(w.F);f["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,f["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(w){switch(w.t){case"b":m=w.v?"TRUE":"FALSE",f["office:value-type"]="boolean",f["office:boolean-value"]=w.v?"true":"false";break;case"n":m=w.w||String(w.v||0),f["office:value-type"]="float",f["office:value"]=w.v||0;break;case"s":case"str":m=null==w.v?"":w.v,f["office:value-type"]="string";break;case"d":m=w.w||fTe(w.v).toISOString(),f["office:value-type"]="date",f["office:date-value"]=fTe(w.v).toISOString(),f["table:style-name"]="ce1";break;default:o.push(t);continue}var C=e(m);if(w.l&&w.l.Target){var y=w.l.Target;"#"==(y="#"==y.charAt(0)?"#"+VFe(y.slice(1)):y).charAt(0)||y.match(/^\w+:/)||(y="../"+y),C=fke("text:a",C,{"xlink:href":y.replace(/&/g,"&amp;")})}o.push("          "+fke("table:table-cell",fke("text:p",C,{}),f)+"\n")}else o.push(t)}}o.push("        </table:table-row>\n")}return o.push("      </table:table>\n"),o.join("")};return function(e,t){var r=[NTe],i=gke({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),o=gke({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==t.bookType?(r.push("<office:document"+i+o+">\n"),r.push(_Pe().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+i+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var n=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var i=t["!cols"][r];if(null==i.width&&null==i.wpx&&null==i.wch)continue;tDe(i),i.ods=n;var o=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+n+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+'"/>\n'),e.push("  </style:style>\n"),++n}});var r=0;t.SheetNames.map(function(e){return t.Sheets[e]}).forEach(function(t){if(t&&t["!rows"])for(var n=0;n<t["!rows"].length;++n)if(t["!rows"][n]){t["!rows"][n].ods=r;var i=t["!rows"][n].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++r}}),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(n(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==t.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function oLe(e,t){if("fods"==t.bookType)return iLe(e,t);var n=DTe(),r="",i=[],o=[];return ATe(n,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),ATe(n,r="content.xml",iLe(e,t)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),ATe(n,r="styles.xml",rLe(e,t)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),ATe(n,r="meta.xml",NTe+_Pe()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),ATe(n,r="manifest.rdf",function(e){var t=[NTe];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)t.push(NPe(e[n][0],e[n][1])),t.push(LPe("",e[n][0]));return t.push(NPe("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(o)),i.push([r,"application/rdf+xml"]),ATe(n,r="META-INF/manifest.xml",function(e){var t=[NTe];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),n}function sLe(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function aLe(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):ike(JRe(e))}function lLe(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):XRe(oke(e))}function cLe(e){var t=e.reduce(function(e,t){return e+t.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(e){n.set(e,r),r+=e.length}),n}function uLe(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function dLe(e,t){var n=t?t[0]:0,r=127&e[n];e:if(e[n++]>=128){if(r|=(127&e[n])<<7,e[n++]<128)break e;if(r|=(127&e[n])<<14,e[n++]<128)break e;if(r|=(127&e[n])<<21,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,28),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,35),++n,e[n++]<128)break e;if(r+=(127&e[n])*Math.pow(2,42),++n,e[n++]<128)break e}return t&&(t[0]=n),r}function hLe(e){var t=new Uint8Array(7);t[0]=127&e;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383)break e;if(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)break e;if(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)break e;if(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)break e;if(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103)break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function pLe(e){var t=0,n=127&e[t];e:if(e[t++]>=128){if(n|=(127&e[t])<<7,e[t++]<128)break e;if(n|=(127&e[t])<<14,e[t++]<128)break e;if(n|=(127&e[t])<<21,e[t++]<128)break e;n|=(127&e[t])<<28}return n}function gLe(e){for(var t=[],n=[0];n[0]<e.length;){var r,i=n[0],o=dLe(e,n),s=7&o,a=0;if(0==(o=Math.floor(o/8)))break;switch(s){case 0:for(var l=n[0];e[n[0]++]>=128;);r=e.slice(l,n[0]);break;case 5:a=4,r=e.slice(n[0],n[0]+a),n[0]+=a;break;case 1:a=8,r=e.slice(n[0],n[0]+a),n[0]+=a;break;case 2:a=dLe(e,n),r=e.slice(n[0],n[0]+a),n[0]+=a;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(o," at offset ").concat(i))}var c={data:r,type:s};null==t[o]?t[o]=[c]:t[o].push(c)}return t}function fLe(e){var t=[];return e.forEach(function(e,n){e.forEach(function(e){e.data&&(t.push(hLe(8*n+e.type)),2==e.type&&t.push(hLe(e.data.length)),t.push(e.data))})}),cLe(t)}function mLe(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function vLe(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=dLe(e,r),o=gLe(e.slice(r[0],r[0]+i));r[0]+=i;var s={id:pLe(o[1][0].data),messages:[]};o[2].forEach(function(t){var n=gLe(t.data),i=pLe(n[3][0].data);s.messages.push({meta:n,data:e.slice(r[0],r[0]+i)}),r[0]+=i}),(null==(t=o[3])?void 0:t[0])&&(s.merge=pLe(o[3][0].data)>>>0>0),n.push(s)}return n}function wLe(e){var t=[];return e.forEach(function(e){var n=[];n[1]=[{data:hLe(e.id),type:0}],n[2]=[],null!=e.merge&&(n[3]=[{data:hLe(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(e){r.push(e.data),e.meta[3]=[{type:0,data:hLe(e.data.length)}],n[2].push({data:fLe(e.meta),type:2})});var i=fLe(n);t.push(hLe(i.length)),t.push(i),r.forEach(function(e){return t.push(e)})}),cLe(t)}function bLe(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=dLe(t,n),i=[];n[0]<t.length;){var o=3&t[n[0]];if(0!=o){var s=0,a=0;if(1==o?(a=4+(t[n[0]]>>2&7),s=(224&t[n[0]++])<<3,s|=t[n[0]++]):(a=1+(t[n[0]++]>>2),2==o?(s=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(s=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[cLe(i)],0==s)throw new Error("Invalid offset 0");if(s>i[0].length)throw new Error("Invalid offset beyond length");if(a>=s)for(i.push(i[0].slice(-s)),a-=s;a>=i[i.length-1].length;)i.push(i[i.length-1]),a-=i[i.length-1].length;i.push(i[0].slice(-s,-s+a))}else{var l=t[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[n[0]],c>1&&(l|=t[n[0]+1]<<8),c>2&&(l|=t[n[0]+2]<<16),c>3&&(l|=t[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}i.push(t.slice(n[0],n[0]+l)),n[0]+=l}}var u=cLe(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function CLe(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(bLe(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return cLe(t)}function yLe(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var o=hLe(r),s=o.length;t.push(o),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,i[0]=0,i[1]=255&s,i[2]=s>>8&255,i[3]=s>>16&255,n+=r}return cLe(t)}function SLe(e,t,n){var r,i=sLe(e),o=i.getUint32(8,!0),s=12,a=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);switch(1&o&&(c=function(e,t){for(var n=(127&e[t+15])<<7|e[t+14]>>1,r=1&e[t+14],i=t+13;i>=t;--i)r=256*r+e[i];return(128&e[t+15]?-r:r)*Math.pow(10,n-6176)}(e,s),s+=16),2&o&&(u=i.getFloat64(s,!0),s+=8),4&o&&(d.setTime(d.getTime()+1e3*i.getFloat64(s,!0)),s+=8),8&o&&(l=i.getUint32(s,!0),s+=4),16&o&&(a=i.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:t[l]};break;case 5:r={t:"d",v:d};break;case 6:r={t:"b",v:u>0};break;case 7:r={t:"n",v:u/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(a>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)));r={t:"s",v:n[a]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)))}return r}function xLe(e,t){var n=new Uint8Array(32),r=sLe(n),i=12,o=0;switch(n[0]=5,e.t){case"n":n[1]=2,function(e,t,n){var r=Math.floor(0==n?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var o=0;i>=1;++o,i/=256)e[t+o]=255&i;e[t+15]|=n>=0?0:128}(n,i,e.v),o|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),n.slice(0,i)}function RLe(e,t){var n=new Uint8Array(32),r=sLe(n),i=12,o=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),n.slice(0,i)}function ELe(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,n,r){var i,o=sLe(e),s=o.getUint32(4,!0),a=(r>1?12:8)+4*uLe(s&(r>1?3470:398)),l=-1,c=-1,u=NaN,d=new Date(2001,0,1);switch(512&s&&(l=o.getUint32(a,!0),a+=4),a+=4*uLe(s&(r>1?12288:4096)),16&s&&(c=o.getUint32(a,!0),a+=4),32&s&&(u=o.getFloat64(a,!0),a+=8),64&s&&(d.setTime(d.getTime()+1e3*o.getFloat64(a,!0)),a+=8),e[2]){case 0:break;case 2:i={t:"n",v:u};break;case 3:i={t:"s",v:t[c]};break;case 5:i={t:"d",v:d};break;case 6:i={t:"b",v:u>0};break;case 7:i={t:"n",v:u/86400};break;case 8:i={t:"e",v:0};break;case 9:if(l>-1)i={t:"s",v:n[l]};else if(c>-1)i={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));i={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return i}(e,t,n,e[0]);case 5:return SLe(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function TLe(e){return dLe(gLe(e)[1][0].data)}function kLe(e,t){var n=gLe(t.data),r=pLe(n[1][0].data),i=n[3],o=[];return(i||[]).forEach(function(t){var n=gLe(t.data),i=pLe(n[1][0].data)>>>0;switch(r){case 1:o[i]=aLe(n[3][0].data);break;case 8:var s=gLe(e[TLe(n[9][0].data)][0].data),a=e[TLe(s[1][0].data)][0],l=pLe(a.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=gLe(a.data);o[i]=c[3].map(function(e){return aLe(e.data)}).join("")}}),o}function MLe(e,t){var n,r=gLe(t.data),i=(null==(n=null==r?void 0:r[7])?void 0:n[0])?pLe(r[7][0].data)>>>0>0?1:0:-1,o=mLe(r[5],function(e){return function(e,t){var n,r,i,o,s,a,l,c,u,d,h,p,g,f,m,v,w=gLe(e),b=pLe(w[1][0].data)>>>0,C=pLe(w[2][0].data)>>>0,y=(null==(r=null==(n=w[8])?void 0:n[0])?void 0:r.data)&&pLe(w[8][0].data)>0||!1;if((null==(o=null==(i=w[7])?void 0:i[0])?void 0:o.data)&&0!=t)m=null==(a=null==(s=w[7])?void 0:s[0])?void 0:a.data,v=null==(c=null==(l=w[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(d=null==(u=w[4])?void 0:u[0])?void 0:d.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(p=null==(h=w[4])?void 0:h[0])?void 0:p.data,v=null==(f=null==(g=w[3])?void 0:g[0])?void 0:f.data}for(var S=y?4:1,x=sLe(m),R=[],E=0;E<m.length/2;++E){var T=x.getUint16(2*E,!0);T<65535&&R.push([E,T])}if(R.length!=C)throw"Expected ".concat(C," cells, found ").concat(R.length);var k=[];for(E=0;E<R.length-1;++E)k[R[E][0]]=v.subarray(R[E][1]*S,R[E+1][1]*S);return R.length>=1&&(k[R[R.length-1][0]]=v.subarray(R[R.length-1][1]*S)),{R:b,cells:k}}(e,i)});return{nrows:pLe(r[4][0].data)>>>0,data:o.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(n,r){if(e[t.R][r])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(r));e[t.R][r]=n}),e},[])}}function PLe(e,t){var n={"!ref":"A1"},r=e[TLe(gLe(t.data)[2][0].data)],i=pLe(r[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return function(e,t,n){var r,i=gLe(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(pLe(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(pLe(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=_Me(o);var s=gLe(i[4][0].data),a=kLe(e,e[TLe(s[4][0].data)][0]),l=(null==(r=s[17])?void 0:r[0])?kLe(e,e[TLe(s[17][0].data)][0]):[],c=gLe(s[3][0].data),u=0;c[1].forEach(function(t){var r=gLe(t.data),i=e[TLe(r[2][0].data)][0],o=pLe(i.meta[1][0].data);if(6002!=o)throw new Error("6001 unexpected reference to ".concat(o));var s=MLe(0,i);s.data.forEach(function(e,t){e.forEach(function(e,r){var i=NMe({r:u+t,c:r}),o=ELe(e,a,l);o&&(n[i]=o)})}),u+=s.nrows})}(e,r[0],n),n}function ILe(e,t){var n={SheetNames:[],Sheets:{}};if(mLe(gLe(t.data)[1],TLe).forEach(function(t){e[t].forEach(function(t){if(2==pLe(t.meta[1][0].data)){var r=function(e,t){var n,r=gLe(t.data),i={name:(null==(n=r[1])?void 0:n[0])?aLe(r[1][0].data):"",sheets:[]};return mLe(r[2],TLe).forEach(function(t){e[t].forEach(function(t){6e3==pLe(t.meta[1][0].data)&&i.sheets.push(PLe(e,t))})}),i}(e,t);r.sheets.forEach(function(e,t){a_e(n,e,0==t?r.name:r.name+"_"+t,!0)})}})}),0==n.SheetNames.length)throw new Error("Empty NUMBERS file");return n}function ALe(e){var t,n,r,i,o={},s=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,n;try{t=CLe(e.content)}catch(r){return console.log("?? "+e.content.length+" "+(r.message||r))}try{n=vLe(t)}catch(r){return console.log("## "+(r.message||r))}n.forEach(function(e){o[e.id]=e.messages,s.push(e.id)})}}),!s.length)throw new Error("File has no messages");var a=(null==(i=null==(r=null==(n=null==(t=null==o?void 0:o[1])?void 0:t[0])?void 0:n.meta)?void 0:r[1])?void 0:i[0].data)&&1==pLe(o[1][0].meta[1][0].data)&&o[1][0];if(a||s.forEach(function(e){o[e].forEach(function(e){if(1==pLe(e.meta[1][0].data)>>>0){if(a)throw new Error("Document has multiple roots");a=e}})}),!a)throw new Error("Cannot find Document root");return ILe(o,a)}function DLe(e,t,n){var r,i,o,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(i=e[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(o=e[8])?void 0:o[0])?void 0:s.data)&&pLe(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var a=0,l=sLe(e[7][0].data),c=0,u=[],d=sLe(e[4][0].data),h=0,p=[],g=0;g<t.length;++g)if(null!=t[g]){var f,m;switch(l.setUint16(2*g,c,!0),d.setUint16(2*g,h,!0),typeof t[g]){case"string":f=xLe({t:"s",v:t[g]},n),m=RLe({t:"s",v:t[g]},n);break;case"number":f=xLe({t:"n",v:t[g]},n),m=RLe({t:"n",v:t[g]},n);break;case"boolean":f=xLe({t:"b",v:t[g]},n),m=RLe({t:"b",v:t[g]},n);break;default:throw new Error("Unsupported value "+t[g])}u.push(f),c+=f.length,p.push(m),h+=m.length,++a}else l.setUint16(2*g,65535,!0),d.setUint16(2*g,65535);for(e[2][0].data=hLe(a);g<e[7][0].data.length/2;++g)l.setUint16(2*g,65535,!0),d.setUint16(2*g,65535,!0);return e[6][0].data=cLe(u),e[3][0].data=cLe(p),a}function FLe(e){return function(t){for(var n=0;n!=e.length;++n){var r=e[n];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function OLe(e){FLe([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function NLe(e){FLe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function LLe(e,t,n,r,i,o,s,a,l,c,u,d){try{o[r]=DPe(MTe(e,n,!0),t);var h,p=kTe(e,t);switch(a){case"sheet":h=UOe(p,t,i,l,o[r],c,u,d);break;case"chart":if(!(h=KOe(p,t,i,l,o[r],c))||!h["!drawel"])break;var g=OTe(h["!drawel"].Target,t),f=APe(g),m=function(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}(MTe(e,g,!0),DPe(MTe(e,f,!0),g)),v=OTe(m,g),w=APe(v);h=MOe(MTe(e,v,!0),0,0,DPe(MTe(e,w,!0),v),0,h);break;case"macro":h=function(e,t){return t.slice(-4),{"!type":"macro"}}(0,t,0,0,o[r]);break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,o[r]);break;default:throw new Error("Unrecognized sheet type "+a)}s[r]=h;var b=[];o&&o[r]&&tTe(o[r]).forEach(function(n){var i="";if(o[r][n].Type==IPe.CMNT){i=OTe(o[r][n].Target,t);var s=XOe(kTe(e,i,!0),i,l);if(!s||!s.length)return;BDe(h,s,!1)}o[r][n].Type==IPe.TCMNT&&(i=OTe(o[r][n].Target,t),b=b.concat(function(e,t){var n=[],r=!1,i={},o=0;return e.replace(HTe,function(s,a){var l=WTe(s);switch(zTe(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=i.t&&n.push(i);break;case"<text>":case"<text":o=a+s.length;break;case"</text>":i.t=e.slice(o,a).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),n}(kTe(e,i,!0),l)))}),b&&b.length&&BDe(h,b,!0,l.people||[])}catch(C){if(l.WTF)throw C}}function _Le(e){return"/"==e.charAt(0)?e.slice(1):e}function HLe(e,t){if(KEe(),OLe(t=t||{}),ETe(e,"META-INF/manifest.xml"))return tLe(e,t);if(ETe(e,"objectdata.xml"))return tLe(e,t);if(ETe(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return ALe(e);var n=QEe.utils.cfb_new();return ITe(e).forEach(function(t){ATe(n,t,PTe(e,t))}),ALe(n)}if(!ETe(e,"[Content_Types].xml")){if(ETe(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(ETe(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,i,o=ITe(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var n={};if((e.match(HTe)||[]).forEach(function(e){var r=WTe(e);switch(r[0].replace(VTe,"<")){case"<?xml":break;case"<Types":t.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[r.Extension]=r.ContentType;break;case"<Override":void 0!==t[kPe[r.ContentType]]&&t[kPe[r.ContentType]].push(r.PartName)}}),t.xmlns!==Ske)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}(MTe(e,"[Content_Types].xml")),a=!1;if(0===s.workbooks.length&&kTe(e,i="xl/workbook.xml",!0)&&s.workbooks.push(i),0===s.workbooks.length){if(!kTe(e,i="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(i),a=!0}"bin"==s.workbooks[0].slice(-3)&&(a=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(BFe=[],s.sst)try{BFe=qOe(kTe(e,_Le(s.sst)),s.sst,t)}catch(I){if(t.WTF)throw I}t.cellStyles&&s.themes.length&&(l=function(e,t,n){return ADe(e,n)}(MTe(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=YOe(kTe(e,_Le(s.style)),s.style,l,t))}s.links.map(function(n){try{DPe(MTe(e,APe(_Le(n))),n);return JOe(kTe(e,_Le(n)),0,n,t)}catch(I){}});var u=$Oe(kTe(e,_Le(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&((h=kTe(e,_Le(s.coreprops[0]),!0))&&(d=BPe(h)),0!==s.extprops.length&&(h=kTe(e,_Le(s.extprops[0]),!0))&&function(e,t,n){var r={};t||(t={}),e=ike(e),jPe.forEach(function(n){var i=(e.match(ske(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=$Te(i));break;case"bool":t[n[1]]="true"===i;break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(r[n[1]]=o[1])}}),r.HeadingPairs&&r.TitlesOfParts&&$Pe(r.HeadingPairs,r.TitlesOfParts,t,n)}(h,d,t));var p={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(h=MTe(e,_Le(s.custprops[0]),!0))&&(p=function(e,t){var n={},r="",i=e.match(KPe);if(i)for(var o=0;o!=i.length;++o){var s=i[o],a=WTe(s);switch(a[0]){case"<?xml":case"<Properties":break;case"<property":r=$Te(a.name);break;case"</property>":r=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":n[r]=$Te(u);break;case"bool":n[r]=ZTe(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=fTe(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return n}(h,t));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?r=u.Sheets.map(function(e){return e.name}):d.Worksheets&&d.SheetNames.length>0&&(r=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&"undefined"!==typeof r&&(g.SheetNames=r),t.bookSheets?g.SheetNames:t.bookProps))return g;r={};var f={};t.bookDeps&&s.calcchain&&(f=QOe(kTe(e,_Le(s.calcchain)),s.calcchain));var m,v,w=0,b={},C=u.Sheets;d.Worksheets=C.length,d.SheetNames=[];for(var y=0;y!=C.length;++y)d.SheetNames[y]=C[y].name;var S=a?"bin":"xml",x=s.workbooks[0].lastIndexOf("/"),R=(s.workbooks[0].slice(0,x+1)+"_rels/"+s.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");ETe(e,R)||(R="xl/_rels/workbook."+S+".rels");var E=DPe(MTe(e,R,!0),R.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=ZOe(kTe(e,_Le(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var n=[],r=!1;return e.replace(HTe,function(e){var i=WTe(e);switch(zTe(i[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":n.push({name:i.displayname,id:i.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return e}),n}(kTe(e,_Le(s.people[0])),t)),E&&(E=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(n=e["!id"][t.id].Type,IPe.WS.indexOf(n)>-1?"sheet":IPe.CS&&n==IPe.CS?"chart":IPe.DS&&n==IPe.DS?"dialog":IPe.MS&&n==IPe.MS?"macro":n&&n.length?n:"sheet")];var n})}catch(I){return null}return e&&0!==e.length?e:null}(E,u.Sheets));var T=kTe(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=d.Worksheets;++w){var k="sheet";if(E&&E[w]?(m="xl/"+E[w][1].replace(/[\/]?xl\//,""),ETe(e,m)||(m=E[w][1]),ETe(e,m)||(m=R.replace(/_rels\/.*$/,"")+E[w][1]),k=E[w][2]):m=(m="xl/worksheets/sheet"+(w+1-T)+"."+S).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(d.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var M=!1,P=0;P!=t.sheets.length;++P)"number"==typeof t.sheets[P]&&t.sheets[P]==w&&(M=1),"string"==typeof t.sheets[P]&&t.sheets[P].toLowerCase()==d.SheetNames[w].toLowerCase()&&(M=1);if(!M)continue e}}LLe(e,m,v,d.SheetNames[w],w,b,r,k,t,u,l,c)}return g={Directory:s,Workbook:u,Props:d,Custprops:p,Deps:f,Sheets:r,SheetNames:d.SheetNames,Strings:BFe,Styles:c,Themes:l,SSF:vTe(hEe)},t&&t.bookFiles&&(e.files?(g.keys=o,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(t,n){t=t.replace(/^Root Entry[\/]/,""),g.keys.push(t),g.files[t]=e.FileIndex[n]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=kTe(e,_Le(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(g.vbaraw=kTe(e,"xl/vbaProject.bin",!0))),g}function VLe(e,t){var n=t||{},r="Workbook",i=QEe.find(e,r);try{if(r="/!DataSpaces/Version",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=OAe(e,4),t.U=OAe(e,4),t.W=OAe(e,4)}(i.content),r="/!DataSpaces/DataSpaceMap",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(NAe(e));return t}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=function(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);LAe(i.content)}catch(l){}if(r="/EncryptionInfo",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=function(e){var t=OAe(e);switch(t.Minor){case 2:return[t.Minor,VAe(e)];case 3:return[t.Minor,BAe()];case 4:return[t.Minor,WAe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(r="/EncryptedPackage",!(i=QEe.find(e,r))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(4==a[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(a[1],i.content,n.password||"",n);if(2==a[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(a[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function BLe(e,t){return"ods"==t.bookType?oLe(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=LMe(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(_Me(r)));var o=ZLe(n,{range:r,header:1}),s=["~Sh33tJ5~"];o.forEach(function(e){return e.forEach(function(e){"string"==typeof e&&s.push(e)})});var a={},l=[],c=QEe.read(t.numbers,{type:"base64"});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0],n=e[1];2==t.type&&t.name.match(/\.iwa/)&&vLe(CLe(t.content)).forEach(function(e){l.push(e.id),a[e.id]={deps:[],location:n,type:pLe(e.messages[0].meta[1][0].data)}})}),l.sort(function(e,t){return e-t});var u=l.filter(function(e){return e>1}).map(function(e){return[e,hLe(e)]});c.FileIndex.map(function(e,t){return[e,c.FullPaths[t]]}).forEach(function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&vLe(CLe(t.content)).forEach(function(e){e.messages.forEach(function(t){u.forEach(function(t){e.messages.some(function(e){return 11006!=pLe(e.meta[1][0].data)&&function(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])})&&a[t[0]].deps.push(e.id)})})})});for(var d,h=QEe.find(c,a[1].location),p=vLe(CLe(h.content)),g=0;g<p.length;++g){var f=p[g];1==f.id&&(d=f)}var m=TLe(gLe(d.messages[0].data)[1][0].data);for(p=vLe(CLe((h=QEe.find(c,a[m].location)).content)),g=0;g<p.length;++g)(f=p[g]).id==m&&(d=f);for(m=TLe(gLe(d.messages[0].data)[2][0].data),p=vLe(CLe((h=QEe.find(c,a[m].location)).content)),g=0;g<p.length;++g)(f=p[g]).id==m&&(d=f);for(m=TLe(gLe(d.messages[0].data)[2][0].data),p=vLe(CLe((h=QEe.find(c,a[m].location)).content)),g=0;g<p.length;++g)(f=p[g]).id==m&&(d=f);var v=gLe(d.messages[0].data);v[6][0].data=hLe(r.e.r+1),v[7][0].data=hLe(r.e.c+1);for(var w=TLe(v[46][0].data),b=QEe.find(c,a[w].location),C=vLe(CLe(b.content)),y=0;y<C.length&&C[y].id!=w;++y);if(C[y].id!=w)throw"Bad ColumnRowUIDMapArchive";var S=gLe(C[y].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var x=0;x<=r.e.c;++x){var R=[];R[1]=R[2]=[{type:0,data:hLe(x+420690)}],S[1].push({type:2,data:fLe(R)}),S[2].push({type:0,data:hLe(x)}),S[3].push({type:0,data:hLe(x)})}S[4]=[],S[5]=[],S[6]=[];for(var E=0;E<=r.e.r;++E)(R=[])[1]=R[2]=[{type:0,data:hLe(E+726270)}],S[4].push({type:2,data:fLe(R)}),S[5].push({type:0,data:hLe(E)}),S[6].push({type:0,data:hLe(E)});C[y].messages[0].data=fLe(S),b.content=yLe(wLe(C)),b.size=b.content.length,delete v[46];var T=gLe(v[4][0].data);T[7][0].data=hLe(r.e.r+1);var k=TLe(gLe(T[1][0].data)[2][0].data);if((C=vLe(CLe((b=QEe.find(c,a[k].location)).content)))[0].id!=k)throw"Bad HeaderStorageBucket";var M=gLe(C[0].messages[0].data);for(E=0;E<o.length;++E){var P=gLe(M[2][0].data);P[1][0].data=hLe(E),P[4][0].data=hLe(o[E].length),M[2][E]={type:M[2][0].type,data:fLe(P)}}C[0].messages[0].data=fLe(M),b.content=yLe(wLe(C)),b.size=b.content.length;var I=TLe(T[2][0].data);if((C=vLe(CLe((b=QEe.find(c,a[I].location)).content)))[0].id!=I)throw"Bad HeaderStorageBucket";for(M=gLe(C[0].messages[0].data),x=0;x<=r.e.c;++x)(P=gLe(M[2][0].data))[1][0].data=hLe(x),P[4][0].data=hLe(r.e.r+1),M[2][x]={type:M[2][0].type,data:fLe(P)};C[0].messages[0].data=fLe(M),b.content=yLe(wLe(C)),b.size=b.content.length;var A=TLe(T[4][0].data);!function(){for(var e,t=QEe.find(c,a[A].location),n=vLe(CLe(t.content)),r=0;r<n.length;++r){var i=n[r];i.id==A&&(e=i)}var o=gLe(e.messages[0].data);o[3]=[];var l=[];s.forEach(function(e,t){l[1]=[{type:0,data:hLe(t)}],l[2]=[{type:0,data:hLe(1)}],l[3]=[{type:2,data:lLe(e)}],o[3].push({type:2,data:fLe(l)})}),e.messages[0].data=fLe(o);var u=yLe(wLe(n));t.content=u,t.size=t.content.length}();var D=gLe(T[3][0].data),F=D[1][0];delete D[2];var O=gLe(F.data),N=TLe(O[2][0].data);!function(){for(var e,t=QEe.find(c,a[N].location),n=vLe(CLe(t.content)),i=0;i<n.length;++i){var l=n[i];l.id==N&&(e=l)}var u=gLe(e.messages[0].data);delete u[6],delete D[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,p=0;p<=r.e.r;++p){var g=gLe(d);h+=DLe(g,o[p],s),g[1][0].data=hLe(p),u[5].push({data:fLe(g),type:2})}u[1]=[{type:0,data:hLe(r.e.c+1)}],u[2]=[{type:0,data:hLe(r.e.r+1)}],u[3]=[{type:0,data:hLe(h)}],u[4]=[{type:0,data:hLe(r.e.r+1)}],e.messages[0].data=fLe(u);var f=yLe(wLe(n));t.content=f,t.size=t.content.length}(),F.data=fLe(O),T[3][0].data=fLe(D),v[4][0].data=fLe(T),d.messages[0].data=fLe(v);var L=yLe(wLe(p));return h.content=L,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){HDe=1024,e&&!e.SSF&&(e.SSF=vTe(hEe));e&&e.SSF&&(KEe(),UEe(e.SSF),t.revssf=iTe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,zFe?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xlsb"==t.bookType?"bin":"xml",r=$De.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};NLe(t=t||{});var o=DTe(),s="",a=0;t.cellXfs=[],UFe(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(ATe(o,s="docProps/core.xml",zPe(e.Props,t)),i.coreprops.push(s),OPe(t.rels,2,s,IPe.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ATe(o,s,UPe(e.Props)),i.extprops.push(s),OPe(t.rels,3,s,IPe.EXT_PROPS),e.Custprops!==e.Props&&tTe(e.Custprops||{}).length>0&&(ATe(o,s="docProps/custom.xml",YPe(e.Custprops)),i.custprops.push(s),OPe(t.rels,4,s,IPe.CUST_PROPS));for(a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},d=e.Sheets[e.SheetNames[a-1]];(d||{})["!type"];if(ATe(o,s="xl/worksheets/sheet"+a+"."+n,eNe(a-1,s,t,e,u)),i.sheets.push(s),OPe(t.wbrels,-1,"worksheets/sheet"+a+"."+n,IPe.WS[0]),d){var h=d["!comments"],p=!1,g="";h&&h.length>0&&(ATe(o,g="xl/comments"+a+"."+n,tNe(h,g,t)),i.comments.push(g),OPe(u,-1,"../comments"+a+"."+n,IPe.CMNT),p=!0),d["!legacy"]&&p&&ATe(o,"xl/drawings/vmlDrawing"+a+".vml",VDe(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&ATe(o,APe(s),FPe(u))}null!=t.Strings&&t.Strings.length>0&&(ATe(o,s="xl/sharedStrings."+n,function(e,t,n){return(".bin"===t.slice(-4)?DAe:IAe)(e,n)}(t.Strings,s,t)),i.strs.push(s),OPe(t.wbrels,-1,"sharedStrings."+n,IPe.SST));ATe(o,s="xl/workbook."+n,function(e,t,n){return(".bin"===t.slice(-4)?GOe:BOe)(e,n)}(e,s,t)),i.workbooks.push(s),OPe(t.rels,1,s,IPe.WB),ATe(o,s="xl/theme/theme1.xml",DDe(e.Themes,t)),i.themes.push(s),OPe(t.wbrels,-1,"theme/theme1.xml",IPe.THEME),ATe(o,s="xl/styles."+n,function(e,t,n){return(".bin"===t.slice(-4)?SDe:cDe)(e,n)}(e,s,t)),i.styles.push(s),OPe(t.wbrels,-1,"styles."+n,IPe.STY),e.vbaraw&&r&&(ATe(o,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),OPe(t.wbrels,-1,"vbaProject.bin",IPe.VBA));return ATe(o,s="xl/metadata."+n,function(e){return(".bin"===e.slice(-4)?LDe:_De)()}(s)),i.metadata.push(s),OPe(t.wbrels,-1,"metadata."+n,IPe.XLMETA),ATe(o,"[Content_Types].xml",PPe(i,t)),ATe(o,"_rels/.rels",FPe(t.rels)),ATe(o,"xl/_rels/workbook."+n+".rels",FPe(t.wbrels)),delete t.revssf,delete t.ssf,o}(e,t):WLe(e,t)}function WLe(e,t){HDe=1024,e&&!e.SSF&&(e.SSF=vTe(hEe)),e&&e.SSF&&(KEe(),UEe(e.SSF),t.revssf=iTe(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,zFe?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=$De.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};NLe(t=t||{});var o=DTe(),s="",a=0;if(t.cellXfs=[],UFe(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ATe(o,s="docProps/core.xml",zPe(e.Props,t)),i.coreprops.push(s),OPe(t.rels,2,s,IPe.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ATe(o,s,UPe(e.Props)),i.extprops.push(s),OPe(t.rels,3,s,IPe.EXT_PROPS),e.Custprops!==e.Props&&tTe(e.Custprops||{}).length>0&&(ATe(o,s="docProps/custom.xml",YPe(e.Custprops)),i.custprops.push(s),OPe(t.rels,4,s,IPe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},h=e.Sheets[e.SheetNames[a-1]];(h||{})["!type"];if(ATe(o,s="xl/worksheets/sheet"+a+"."+n,hOe(a-1,t,e,d)),i.sheets.push(s),OPe(t.wbrels,-1,"worksheets/sheet"+a+"."+n,IPe.WS[0]),h){var p=h["!comments"],g=!1,f="";if(p&&p.length>0){var m=!1;p.forEach(function(e){e[1].forEach(function(e){1==e.T&&(m=!0)})}),m&&(ATe(o,f="xl/threadedComments/threadedComment"+a+"."+n,zDe(p,u,t)),i.threadedcomments.push(f),OPe(d,-1,"../threadedComments/threadedComment"+a+"."+n,IPe.TCMNT)),ATe(o,f="xl/comments"+a+"."+n,WDe(p)),i.comments.push(f),OPe(d,-1,"../comments"+a+"."+n,IPe.CMNT),g=!0}h["!legacy"]&&g&&ATe(o,"xl/drawings/vmlDrawing"+a+".vml",VDe(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&ATe(o,APe(s),FPe(d))}return null!=t.Strings&&t.Strings.length>0&&(ATe(o,s="xl/sharedStrings."+n,IAe(t.Strings,t)),i.strs.push(s),OPe(t.wbrels,-1,"sharedStrings."+n,IPe.SST)),ATe(o,s="xl/workbook."+n,BOe(e)),i.workbooks.push(s),OPe(t.rels,1,s,IPe.WB),ATe(o,s="xl/theme/theme1.xml",DDe(e.Themes,t)),i.themes.push(s),OPe(t.wbrels,-1,"theme/theme1.xml",IPe.THEME),ATe(o,s="xl/styles."+n,cDe(e,t)),i.styles.push(s),OPe(t.wbrels,-1,"styles."+n,IPe.STY),e.vbaraw&&r&&(ATe(o,s="xl/vbaProject.bin",e.vbaraw),i.vba.push(s),OPe(t.wbrels,-1,"vbaProject.bin",IPe.VBA)),ATe(o,s="xl/metadata."+n,_De()),i.metadata.push(s),OPe(t.wbrels,-1,"metadata."+n,IPe.XLMETA),u.length>1&&(ATe(o,s="xl/persons/person.xml",function(e){var t=[NTe,fke("personList",null,{xmlns:Rke,"xmlns:x":Dke[0]}).replace(/[\/]>/,">")];return e.forEach(function(e,n){t.push(fke("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}(u)),i.people.push(s),OPe(t.wbrels,-1,"persons/person.xml",IPe.PEOPLE)),ATe(o,"[Content_Types].xml",PPe(i,t)),ATe(o,"_rels/.rels",FPe(t.rels)),ATe(o,"xl/_rels/workbook.xml.rels",FPe(t.wbrels)),delete t.revssf,delete t.ssf,o}function zLe(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=$Re(e.slice(0,12));break;case"binary":n=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function jLe(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return pNe(e.slice(n),t);default:break e}return wAe.to_workbook(e,t)}function GLe(e,t,n,r){return r?(n.type="string",wAe.to_workbook(e,n)):wAe.to_workbook(t,n)}function $Le(e,t){LRe();var n=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return $Le(new Uint8Array(e),((n=vTe(n)).type="array",n));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!n.type&&(n.type="undefined"!==typeof Deno?"buffer":"array");var r,i=e,o=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),WFe={},n.dateNF&&(WFe.dateNF=n.dateNF),n.type||(n.type=URe&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==n.type&&(n.type=URe?"buffer":"binary",i=function(e){if("undefined"!==typeof JEe)return JEe.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||URe||(n.type="array")),"string"==n.type&&(o=!0,n.type="binary",n.codepage=65001,i=function(e){return e.match(/[^\x00-\x7F]/)?oke(e):e}(e)),"array"==n.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var s=new ArrayBuffer(3),a=new Uint8Array(s);if(a.foo="bar",!a.foo)return(n=vTe(n)).type="array",$Le(ZRe(i),n)}switch((r=zLe(i,n))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,t){return QEe.find(e,"EncryptedPackage")?VLe(e,t):PNe(e,t)}(QEe.read(i,n),n);break;case 9:if(r[1]<=8)return PNe(i,n);break;case 60:return pNe(i,n);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=fAe.to_workbook(e,n);return n.WTF=r,i}catch(o){if(n.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return wAe.to_workbook(e,t)}}(i,n);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return mAe.to_workbook(i,n);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,t){var n=e,r=t||{};return r.type||(r.type=URe&&Buffer.isBuffer(e)?"buffer":"base64"),HLe(FTe(n,r),r)}(i,n):GLe(e,i,n,o);case 239:return 60===r[3]?pNe(i,n):GLe(e,i,n,o);case 255:if(254===r[1])return function(e,t){var n=e;return"base64"==t.type&&(n=$Re(n)),n=VRe.utils.decode(1200,n.slice(2),"str"),t.type="binary",jLe(n,t)}(i,n);if(0===r[1]&&2===r[2]&&0===r[3])return bAe.to_workbook(i,n);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return bAe.to_workbook(i,n);if(0===r[2]&&(8===r[3]||9===r[3]))return bAe.to_workbook(i,n)}break;case 3:case 131:case 139:case 140:return gAe.to_workbook(i,n);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return UAe.to_workbook(i,n);break;case 10:case 13:case 32:return function(e,t){var n="",r=zLe(e,t);switch(t.type){case"base64":n=$Re(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=mTe(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(n=ike(n)),t.type="binary",jLe(n,t)}(i,n);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return pAe.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?gAe.to_workbook(i,n):GLe(e,i,n,o)}function ULe(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return eTe(t.file,QEe.write(e,{type:URe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return QEe.write(e,t)}function KLe(e,t){var n={},r=URe?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?QEe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!==typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(QRe(i))}return t.password&&"undefined"!==typeof encrypt_agile?ULe(encrypt_agile(i,t.password),t):"file"===t.type?eTe(t.file,i):"string"==t.type?ike(i):i}function YLe(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return GRe(oke(r));case"binary":return oke(r);case"string":return e;case"file":return eTe(t.file,r,"utf8");case"buffer":return URe?KRe(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):YLe(r,{type:"binary"}).split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qLe(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return"base64"==t.type?GRe(n):"string"==t.type?ike(n):n;case"file":return eTe(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XLe(e,t){LRe(),HOe(e);var n=vTe(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=XLe(e,n);return n.type="array",QRe(r)}var i=0;if(n.sheet&&(i="number"==typeof n.sheet?n.sheet:e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return YLe(bNe(e,n),n);case"slk":case"sylk":return YLe(fAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return YLe(YNe(e.Sheets[e.SheetNames[i]],n),n);case"txt":return function(e,t){switch(t.type){case"base64":return GRe(e);case"binary":case"string":return e;case"file":return eTe(t.file,e,"binary");case"buffer":return URe?KRe(e,"binary"):e.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}(r_e(e.Sheets[e.SheetNames[i]],n),n);case"csv":return YLe(n_e(e.Sheets[e.SheetNames[i]],n),n,"\ufeff");case"dif":return YLe(mAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return qLe(gAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return YLe(wAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return YLe(UAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return YLe(vAe.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return YLe(oLe(e,n),n);case"wk1":return qLe(bAe.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return qLe(bAe.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),qLe(zNe(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),function(e,t){var n=t||{};return ULe(INe(e,n),n)}(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var n=vTe(t||{});return KLe(BLe(e,n),n)}(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function QLe(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function JLe(e,t,n,r,i,o,s,a){var l=AMe(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch(m){h.__rowNum__=n}else h.__rowNum__=n;if(!s||e[n])for(var p=t.s.c;p<=t.e.c;++p){var g=s?e[n][p]:e[r[p]+l];if(void 0!==g&&void 0!==g.t){var f=g.v;switch(g.t){case"z":if(null==f)break;continue;case"e":f=0==f?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(null!=o[p]){if(null==f)if("e"==g.t&&null===f)h[o[p]]=null;else if(void 0!==c)h[o[p]]=c;else{if(!u||null!==f)continue;h[o[p]]=null}else h[o[p]]=u&&("n"!==g.t||"n"===g.t&&!1!==a.rawNumbers)?f:BMe(g,f,a);null!=f&&(d=!1)}}else{if(void 0===c)continue;null!=o[p]&&(h[o[p]]=c)}}return{row:h,isempty:d}}function ZLe(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,o=[],s=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=HMe(u);break;case"number":(l=HMe(e["!ref"])).s.r=u;break;default:l=u}r>0&&(i=0);var d=AMe(l.s.r),h=[],p=[],g=0,f=0,m=Array.isArray(e),v=l.s.r,w=0,b={};m&&!e[v]&&(e[v]=[]);var C=c.skipHidden&&e["!cols"]||[],y=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(C[w]||{}).hidden)switch(h[w]=FMe(w),n=m?e[v][w]:e[h[w]+d],r){case 1:o[w]=w-l.s.c;break;case 2:o[w]=h[w];break;case 3:o[w]=c.header[w-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),a=s=BMe(n,null,c),f=b[s]||0){do{a=s+"_"+f++}while(b[a]);b[s]=f,b[a]=1}else b[s]=1;o[w]=a}for(v=l.s.r+i;v<=l.e.r;++v)if(!(y[v]||{}).hidden){var S=JLe(e,l,v,h,r,o,m,c);(!1===S.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(p[g++]=S.row)}return p.length=g,p}var e_e=/"/g;function t_e(e,t,n,r,i,o,s,a){for(var l=!0,c=[],u="",d=AMe(n),h=t.s.c;h<=t.e.c;++h)if(r[h]){var p=a.dense?(e[n]||[])[h]:e[r[h]+d];if(null==p)u="";else if(null!=p.v){l=!1,u=""+(a.rawNumbers&&"n"==p.t?p.v:BMe(p,null,a));for(var g=0,f=0;g!==u.length;++g)if((f=u.charCodeAt(g))===i||f===o||34===f||a.forceQuotes){u='"'+u.replace(e_e,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==p.f||p.F?u="":(l=!1,(u="="+p.f).indexOf(",")>=0&&(u='"'+u.replace(e_e,'""')+'"'));c.push(u)}return!1===a.blankrows&&l?null:c.join(s)}function n_e(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=HMe(e["!ref"]),o=void 0!==r.FS?r.FS:",",s=o.charCodeAt(0),a=void 0!==r.RS?r.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],p=r.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(h[g]||{}).hidden||(d[g]=FMe(g));for(var f=0,m=i.s.r;m<=i.e.r;++m)(p[m]||{}).hidden||null!=(u=t_e(e,i,m,d,s,l,o,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((f++?a:"")+u));return delete r.dense,n.join("")}function r_e(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=n_e(e,t);if("undefined"==typeof VRe||"string"==t.type)return n;var r=VRe.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function i_e(e,t,n){var r,i=n||{},o=+!i.skipHeader,s=e||{},a=0,l=0;if(s&&null!=i.origin)if("number"==typeof i.origin)a=i.origin;else{var c="string"==typeof i.origin?OMe(i.origin):i.origin;a=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:a+t.length-1+o}};if(s["!ref"]){var d=HMe(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==a&&(a=d.e.r+1,u.e.r=a+t.length-1+o)}else-1==a&&(a=0,u.e.r=t.length-1+o);var h=i.header||[],p=0;t.forEach(function(e,t){tTe(e).forEach(function(n){-1==(p=h.indexOf(n))&&(h[p=h.length]=n);var c=e[n],u="z",d="",g=NMe({c:l+p,r:a+t+o});r=o_e(s,g),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",i.cellDates||(u="n",c=sTe(c)),d=i.dateNF||hEe[14]):null===c&&i.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):s[g]=r={t:u,v:c},d&&(r.z=d)):s[g]=c})}),u.e.c=Math.max(u.e.c,l+h.length-1);var g=AMe(a);if(o)for(p=0;p<h.length;++p)s[FMe(p+l)+g]={t:"s",v:h[p]};return s["!ref"]=_Me(u),s}function o_e(e,t,n){if("string"==typeof t){if(Array.isArray(e)){var r=OMe(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return o_e(e,NMe("number"!=typeof t?t:{r:t,c:n||0}))}function s_e(){return{SheetNames:[],Sheets:{}}}function a_e(e,t,n,r){var i=1;if(!n)for(;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||n;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(n=s+i);++i);}if(_Oe(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function l_e(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var c_e={encode_col:FMe,encode_row:AMe,encode_cell:NMe,encode_range:_Me,decode_col:DMe,decode_row:IMe,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:OMe,decode_range:LMe,format_cell:BMe,sheet_add_aoa:zMe,sheet_add_json:i_e,sheet_add_dom:qNe,aoa_to_sheet:jMe,json_to_sheet:function(e,t){return i_e(null,e,t)},table_to_sheet:XNe,table_to_book:function(e,t){return WMe(XNe(e,t),t)},sheet_to_csv:n_e,sheet_to_txt:r_e,sheet_to_json:ZLe,sheet_to_html:YNe,sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,o=HMe(e["!ref"]),s="",a=[],l=[],c=Array.isArray(e);for(i=o.s.c;i<=o.e.c;++i)a[i]=FMe(i);for(var u=o.s.r;u<=o.e.r;++u)for(s=AMe(u),i=o.s.c;i<=o.e.c;++i)if(n=a[i]+s,r="",void 0!==(t=c?(e[u]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:ZLe,sheet_get_cell:o_e,book_new:s_e,book_append_sheet:a_e,book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:l_e,cell_set_internal_link:function(e,t,n){return l_e(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t:t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var i="string"!=typeof t?t:HMe(t),o="string"==typeof t?t:_Me(t),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var l=o_e(e,s,a);l.t="n",l.F=o,delete l.v,s==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};PRe.version;const u_e=e=>{let{onDataImport:n,data:r}=e;const[i,o]=(0,t.useState)(""),s=e=>{const t=new FileReader;t.onload=e=>{try{var t;const r=null===(t=e.target)||void 0===t?void 0:t.result,i=e=>{const t=e.split(/\r?\n/).filter(e=>e.trim());if(0===t.length)return[];const n=[];for(const r of t){const e=[];let t="",i=!1;for(let n=0;n<r.length;n++){const o=r[n];'"'===o?i=!i:","!==o||i?t+=o:(e.push(t.trim()),t="")}e.push(t.trim()),n.push(e)}return n},s=i(r).map(e=>{const t={};return e.forEach((e,n)=>{t[n]=e}),t});n(s),o("CSV file imported successfully"),setTimeout(()=>o(""),3e3)}catch(Wn){console.error("Error importing CSV:",Wn),o("Error importing CSV file"),setTimeout(()=>o(""),3e3)}},t.readAsText(e)},a=e=>{const t=new FileReader;t.onload=e=>{try{var t;const r=$Le(null===(t=e.target)||void 0===t?void 0:t.result,{type:"binary"}),i=r.SheetNames[0],s=r.Sheets[i],a=c_e.sheet_to_json(s,{header:1}).map(e=>{const t={};return e.forEach((e,n)=>{t[n]=e}),t});n(a),o("Excel file imported successfully"),setTimeout(()=>o(""),3e3)}catch(Wn){console.error("Error importing Excel:",Wn),o("Error importing Excel file"),setTimeout(()=>o(""),3e3)}},t.readAsBinaryString(e)},l=e=>{const t=new FileReader;t.onload=e=>{try{var t;const r=JSON.parse(null===(t=e.target)||void 0===t?void 0:t.result);n(r),o("JSON file imported successfully"),setTimeout(()=>o(""),3e3)}catch(Wn){console.error("Error importing JSON:",Wn),o("Error importing JSON file"),setTimeout(()=>o(""),3e3)}},t.readAsText(e)},c=e=>{if(r&&0!==r.length)try{if("xlsx"===e){const e=r.map(e=>{const t=[];return Object.keys(e).forEach(n=>{t[parseInt(n)]=e[n]}),t}),t=c_e.aoa_to_sheet(e),n=c_e.book_new();c_e.book_append_sheet(n,t,"Data"),function(e,t,n){var r=n||{};r.type="file",r.file=t,QLe(r),XLe(e,r)}(n,"spreadsheet-data.xlsx")}else if("csv"===e){const e=r.map(e=>{const t=[];return Object.keys(e).forEach(n=>{t[parseInt(n)]=e[n]}),t.map(e=>`"${e||""}"`).join(",")}).join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="spreadsheet-data.csv",n.click()}else if("json"===e){const e=JSON.stringify(r,null,2),t=new Blob([e],{type:"application/json"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download="spreadsheet-data.json",n.click()}}catch(Wn){console.error("Error exporting file:",Wn),alert("Error exporting file")}else alert("No data to export")};return(0,MH.jsxs)("div",{className:"file-handler",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcc1 File Management"}),i&&(0,MH.jsx)("div",{className:"import-status "+(i.includes("Error")?"error":"success"),children:i}),(0,MH.jsxs)("div",{className:"file-controls",children:[(0,MH.jsxs)("div",{className:"control-group",children:[(0,MH.jsx)("label",{htmlFor:"fileImport",children:"\ud83d\udce4 Import File:"}),(0,MH.jsx)("input",{type:"file",id:"fileImport",accept:".xlsx,.xls,.csv,.json",onChange:e=>{var t,n;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;o("Importing file...");const i=null===(n=r.name.split(".").pop())||void 0===n?void 0:n.toLowerCase();"csv"===i?s(r):["xlsx","xls"].includes(i||"")?a(r):"json"===i?l(r):(o("Unsupported file format"),setTimeout(()=>o(""),3e3))}}),(0,MH.jsx)("small",{children:"Supported formats: Excel (.xlsx, .xls), CSV, JSON"})]}),(0,MH.jsxs)("div",{className:"control-group",children:[(0,MH.jsx)("label",{children:"\ud83d\udce5 Export as:"}),(0,MH.jsxs)("div",{className:"export-buttons",children:[(0,MH.jsx)("button",{onClick:()=>c("xlsx"),className:"export-btn excel",children:"\ud83d\udcca Excel"}),(0,MH.jsx)("button",{onClick:()=>c("csv"),className:"export-btn csv",children:"\ud83d\udcc4 CSV"}),(0,MH.jsx)("button",{onClick:()=>c("json"),className:"export-btn json",children:"\ud83d\udd27 JSON"})]})]}),(0,MH.jsx)("div",{className:"control-group",children:(0,MH.jsx)("button",{onClick:()=>{n([{0:"Month",1:"Sales",2:"Expenses",3:"Profit"},{0:"January",1:1e3,2:600,3:400},{0:"February",1:1200,2:700,3:500},{0:"March",1:1100,2:650,3:450},{0:"April",1:1400,2:800,3:600},{0:"May",1:1300,2:750,3:550},{0:"June",1:1600,2:900,3:700}])},className:"sample-btn",children:"\ud83d\udccb Load Sample Data"})})]})]})},d_e=e=>{let{data:n}=e;const[r,i]=(0,t.useState)(!1),[o,s]=(0,t.useState)("formatted"),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return JSON.stringify(e,null,t)},l=(()=>{if(!n||0===n.length)return null;const e=n.length,t=new Set;n.forEach(e=>{Object.keys(e).forEach(e=>t.add(e))});const r=t.size,i={};return t.forEach(e=>{const t=n.map(t=>t[e]).filter(e=>void 0!==e);if(t.length>0){const n=t[0];i[e]="number"===typeof n?"number":"string"===typeof n?"string":typeof n}}),{totalRows:e,totalColumns:r,dataTypes:i}})();return(0,MH.jsxs)("div",{className:"json-viewer",children:[(0,MH.jsxs)("div",{className:"json-viewer-header",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcc4 JSON Viewer"}),(0,MH.jsxs)("div",{className:"json-controls",children:[(0,MH.jsxs)("div",{className:"view-mode-selector",children:[(0,MH.jsx)("label",{children:"View:"}),(0,MH.jsxs)("select",{value:o,onChange:e=>s(e.target.value),children:[(0,MH.jsx)("option",{value:"formatted",children:"Formatted"}),(0,MH.jsx)("option",{value:"raw",children:"Raw JSON"}),(0,MH.jsx)("option",{value:"table",children:"Table"})]})]}),(0,MH.jsx)("button",{className:"expand-btn",onClick:()=>i(!r),children:r?"\ud83d\udce6 Collapse":"\ud83d\udcc2 Expand"})]})]}),l&&(0,MH.jsxs)("div",{className:"data-stats",children:[(0,MH.jsxs)("div",{className:"stat-item",children:[(0,MH.jsx)("span",{className:"stat-label",children:"Rows:"}),(0,MH.jsx)("span",{className:"stat-value",children:l.totalRows})]}),(0,MH.jsxs)("div",{className:"stat-item",children:[(0,MH.jsx)("span",{className:"stat-label",children:"Columns:"}),(0,MH.jsx)("span",{className:"stat-value",children:l.totalColumns})]}),(0,MH.jsxs)("div",{className:"stat-item",children:[(0,MH.jsx)("span",{className:"stat-label",children:"Size:"}),(0,MH.jsxs)("span",{className:"stat-value",children:[JSON.stringify(n).length," bytes"]})]})]}),(0,MH.jsx)("div",{className:"json-content "+(r?"expanded":"collapsed"),children:0===n.length?(0,MH.jsxs)("div",{className:"no-data",children:[(0,MH.jsx)("p",{children:"\ud83d\udcdd No data to display"}),(0,MH.jsx)("p",{children:"Load sample data or import a file to see the JSON"})]}):(0,MH.jsxs)(MH.Fragment,{children:["raw"===o&&(0,MH.jsx)("pre",{className:"json-raw",children:a(n)}),"formatted"===o&&(0,MH.jsx)("div",{className:"json-formatted",children:n.map((e,t)=>(0,MH.jsxs)("div",{className:"json-row",children:[(0,MH.jsxs)("span",{className:"json-row-number",children:[t,":"]}),(0,MH.jsx)("span",{className:"json-row-content",children:a(e,2)})]},t))}),"table"===o&&(()=>{const e=(()=>{if(!n||0===n.length)return[];const e=new Set;n.forEach(t=>{Object.keys(t).forEach(t=>e.add(t))});const t=Array.from(e).sort((e,t)=>parseInt(e)-parseInt(t));return n.map((e,n)=>{const r={row:n};return t.forEach(t=>{r[t]=e[t]||""}),r})})(),t=Object.keys(e[0]||{}).filter(e=>"row"!==e);return(0,MH.jsx)("div",{className:"json-table-container",children:(0,MH.jsxs)("table",{className:"json-table",children:[(0,MH.jsx)("thead",{children:(0,MH.jsxs)("tr",{children:[(0,MH.jsx)("th",{children:"Row"}),t.map(e=>(0,MH.jsxs)("th",{children:["Col ",e]},e))]})}),(0,MH.jsx)("tbody",{children:e.map((e,n)=>(0,MH.jsxs)("tr",{children:[(0,MH.jsx)("td",{className:"row-number",children:e.row}),t.map(t=>(0,MH.jsx)("td",{className:"cell-value",children:e[t]},t))]},n))})]})})})()]})}),n.length>0&&(0,MH.jsxs)("div",{className:"json-actions",children:[(0,MH.jsx)("button",{className:"copy-btn",onClick:()=>{navigator.clipboard.writeText(a(n))},children:"\ud83d\udccb Copy JSON"}),(0,MH.jsx)("button",{className:"download-btn",onClick:()=>{const e=new Blob([a(n)],{type:"application/json"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="spreadsheet-data.json",r.click(),URL.revokeObjectURL(t)},children:"\ud83d\udcbe Download JSON"})]})]})},h_e=[{id:"comparison",name:"\ud83d\udcca Library Comparison",description:"Compare all four spreadsheet libraries side by side",pros:[],cons:[],version:"Latest",website:"#"},{id:"handsontable-chartjs",name:"Handsontable + Chart.js",description:"Professional spreadsheet with Chart.js integration",pros:["Professional spreadsheet interface with Excel-like features","Real-time data editing with instant chart updates","Comprehensive API with extensive customization options","Built-in data validation and formatting","Excellent performance with large datasets","Mobile-responsive design","Rich set of built-in features (sorting, filtering, etc.)"],cons:["Commercial license required for advanced features","Larger bundle size (~500KB)","Steeper learning curve for complex configurations","Limited free features in community version"],version:"15.3.0",website:"https://handsontable.com/"},{id:"ag-grid-chartjs",name:"AG Grid + Chart.js",description:"Enterprise-grade grid with Chart.js charts",pros:["Enterprise-level performance and features","Advanced filtering and grouping capabilities","Excellent TypeScript support","Rich ecosystem of plugins and extensions","Built-in chart integration","Virtual scrolling for large datasets","Comprehensive documentation"],cons:["Commercial license for advanced features","Complex setup and configuration","Large bundle size","Overkill for simple use cases"],version:"34.0.0",website:"https://ag-grid.com/"},{id:"react-table-chartjs",name:"React Table + Chart.js",description:"Lightweight table with Chart.js integration",pros:["Lightweight and flexible","Headless design for maximum customization","Excellent TypeScript support","No external dependencies","Easy to integrate with any UI library","Great for custom implementations"],cons:["Requires more manual setup","No built-in editing features","Limited built-in functionality","More code required for advanced features"],version:"Latest",website:"https://react-table.tanstack.com/"},{id:"mui-datagrid-chartjs",name:"MUI DataGrid + Chart.js",description:"Material-UI grid with Chart.js charts",pros:["Beautiful Material Design interface","Built-in editing and filtering","Excellent accessibility","Consistent with Material Design system","Good TypeScript support","Responsive design out of the box"],cons:["Tied to Material-UI ecosystem","Limited customization compared to headless solutions","Bundle size includes Material-UI dependencies","May not fit all design systems"],version:"Latest",website:"https://mui.com/x/react-data-grid/"}],p_e=e=>{let{selectedLibrary:t,onLibraryChange:n}=e;const r=h_e.find(e=>e.id===t);return(0,MH.jsxs)("div",{className:"library-tabs",children:[(0,MH.jsxs)("div",{className:"tabs-header",children:[(0,MH.jsx)("h2",{children:"\ud83d\udcda Library Comparison"}),(0,MH.jsx)("div",{className:"tabs-container",children:h_e.map(e=>(0,MH.jsx)("button",{className:"tab-button "+(t===e.id?"active":""),onClick:()=>n(e.id),children:e.name},e.id))})]}),r&&(0,MH.jsxs)("div",{className:"library-info",children:[(0,MH.jsxs)("div",{className:"library-header",children:[(0,MH.jsx)("h3",{children:r.name}),(0,MH.jsxs)("div",{className:"library-meta",children:[(0,MH.jsxs)("span",{className:"version",children:["v",r.version]}),(0,MH.jsx)("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",className:"website-link",children:"\ud83c\udf10 Website"})]})]}),(0,MH.jsx)("p",{className:"library-description",children:r.description}),r.pros.length>0&&r.cons.length>0&&(0,MH.jsxs)("div",{className:"pros-cons",children:[(0,MH.jsxs)("div",{className:"pros",children:[(0,MH.jsx)("h4",{children:"\u2705 Pros"}),(0,MH.jsx)("ul",{children:r.pros.map((e,t)=>(0,MH.jsx)("li",{children:e},t))})]}),(0,MH.jsxs)("div",{className:"cons",children:[(0,MH.jsx)("h4",{children:"\u274c Cons"}),(0,MH.jsx)("ul",{children:r.cons.map((e,t)=>(0,MH.jsx)("li",{children:e},t))})]})]})]})]})},g_e=()=>(0,MH.jsxs)("div",{className:"library-comparison",children:[(0,MH.jsxs)("div",{className:"comparison-header",children:[(0,MH.jsx)("h2",{children:"\ud83d\udd0d Library Comparison"}),(0,MH.jsx)("p",{children:"See the key differences between all four spreadsheet library implementations"})]}),(0,MH.jsx)("div",{className:"comparison-table-container",children:(0,MH.jsxs)("table",{className:"comparison-table",children:[(0,MH.jsx)("thead",{children:(0,MH.jsxs)("tr",{children:[(0,MH.jsx)("th",{className:"feature-header",children:"Feature"}),(0,MH.jsx)("th",{className:"handsontable-header",children:(0,MH.jsxs)("div",{className:"library-header",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83d\udcca"}),(0,MH.jsx)("span",{className:"library-name",children:"Handsontable"}),(0,MH.jsx)("span",{className:"library-status implemented",children:"\u2705 Implemented"})]})}),(0,MH.jsx)("th",{className:"ag-grid-header",children:(0,MH.jsxs)("div",{className:"library-header",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83c\udfe2"}),(0,MH.jsx)("span",{className:"library-name",children:"AG Grid"}),(0,MH.jsx)("span",{className:"library-status implemented",children:"\u2705 Implemented"})]})}),(0,MH.jsx)("th",{className:"react-table-header",children:(0,MH.jsxs)("div",{className:"library-header",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\u26a1"}),(0,MH.jsx)("span",{className:"library-name",children:"React Table"}),(0,MH.jsx)("span",{className:"library-status implemented",children:"\u2705 Implemented"})]})}),(0,MH.jsx)("th",{className:"mui-datagrid-header",children:(0,MH.jsxs)("div",{className:"library-header",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83c\udfa8"}),(0,MH.jsx)("span",{className:"library-name",children:"MUI DataGrid"}),(0,MH.jsx)("span",{className:"library-status implemented",children:"\u2705 Implemented"})]})})]})}),(0,MH.jsx)("tbody",{children:[{feature:"Editing Experience",handsontable:"Excel-like inline editing with keyboard navigation",agGrid:"Cell editing with focus management and validation",reactTable:"Custom inline editing with full control",muiDataGrid:"Material Design inline editing with validation"},{feature:"Performance",handsontable:"Good for medium datasets, optimized for editing",agGrid:"Enterprise-grade performance, virtual scrolling for large datasets",reactTable:"Lightweight, optimized for custom implementations",muiDataGrid:"Good performance with Material Design optimizations"},{feature:"Filtering",handsontable:"Basic column filters",agGrid:"Advanced filtering with multiple filter types and custom filters",reactTable:"Custom filtering implementation required",muiDataGrid:"Built-in filtering with Material Design components"},{feature:"Sorting",handsontable:"Multi-column sorting with visual indicators",agGrid:"Advanced sorting with custom comparators and multi-sort",reactTable:"Built-in sorting with custom indicators",muiDataGrid:"Built-in sorting with Material Design styling"},{feature:"Selection",handsontable:"Cell and range selection with Excel-like behavior",agGrid:"Row, cell, and range selection with keyboard navigation",reactTable:"Custom selection implementation required",muiDataGrid:"Built-in row selection with checkboxes"},{feature:"Column Management",handsontable:"Resize, reorder, hide/show columns",agGrid:"Resize, reorder, hide/show, pin columns with advanced options",reactTable:"Custom column management required",muiDataGrid:"Built-in column resizing and reordering"},{feature:"Styling",handsontable:"Customizable themes and cell styling",agGrid:"Extensive theming with CSS variables and custom cell renderers",reactTable:"Complete styling control - headless design",muiDataGrid:"Material Design theming with CSS variables"},{feature:"Bundle Size",handsontable:"~500KB (with features)",agGrid:"~300KB (core) + additional modules",reactTable:"~15KB (core) + your custom code",muiDataGrid:"~200KB (includes Material-UI dependencies)"},{feature:"Learning Curve",handsontable:"Moderate - Excel-like interface",agGrid:"Steeper - More configuration options",reactTable:"Variable - Depends on your implementation",muiDataGrid:"Moderate - Material Design patterns"},{feature:"Use Case",handsontable:"Spreadsheet applications, data entry",agGrid:"Enterprise applications, data grids, dashboards",reactTable:"Custom applications, maximum flexibility",muiDataGrid:"Material Design applications, consistent UI"}].map((e,t)=>(0,MH.jsxs)("tr",{className:t%2===0?"even-row":"odd-row",children:[(0,MH.jsx)("td",{className:"feature-name",children:(0,MH.jsx)("strong",{children:e.feature})}),(0,MH.jsx)("td",{className:"handsontable-value",children:e.handsontable}),(0,MH.jsx)("td",{className:"ag-grid-value",children:e.agGrid}),(0,MH.jsx)("td",{className:"react-table-value",children:e.reactTable}),(0,MH.jsx)("td",{className:"mui-datagrid-value",children:e.muiDataGrid})]},t))})]})}),(0,MH.jsxs)("div",{className:"comparison-summary",children:[(0,MH.jsxs)("div",{className:"summary-section",children:[(0,MH.jsx)("h3",{children:"\ud83c\udfaf When to Use Handsontable"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Building spreadsheet-like applications"}),(0,MH.jsx)("li",{children:"Users expect Excel-like behavior"}),(0,MH.jsx)("li",{children:"Focus on data entry and editing"}),(0,MH.jsx)("li",{children:"Medium-sized datasets"}),(0,MH.jsx)("li",{children:"Need quick implementation"})]})]}),(0,MH.jsxs)("div",{className:"summary-section",children:[(0,MH.jsx)("h3",{children:"\ud83c\udfaf When to Use AG Grid"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Building enterprise data applications"}),(0,MH.jsx)("li",{children:"Large datasets with performance requirements"}),(0,MH.jsx)("li",{children:"Need advanced filtering and sorting"}),(0,MH.jsx)("li",{children:"Complex data visualization requirements"}),(0,MH.jsx)("li",{children:"Custom cell renderers and editors"})]})]}),(0,MH.jsxs)("div",{className:"summary-section",children:[(0,MH.jsx)("h3",{children:"\ud83c\udfaf When to Use React Table"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Building custom table implementations"}),(0,MH.jsx)("li",{children:"Need maximum flexibility and control"}),(0,MH.jsx)("li",{children:"Want minimal bundle size"}),(0,MH.jsx)("li",{children:"Have specific design requirements"}),(0,MH.jsx)("li",{children:"Prefer headless architecture"})]})]}),(0,MH.jsxs)("div",{className:"summary-section",children:[(0,MH.jsx)("h3",{children:"\ud83c\udfaf When to Use MUI DataGrid"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Building Material Design applications"}),(0,MH.jsx)("li",{children:"Need consistent UI/UX patterns"}),(0,MH.jsx)("li",{children:"Want built-in accessibility features"}),(0,MH.jsx)("li",{children:"Prefer opinionated design system"}),(0,MH.jsx)("li",{children:"Need responsive design out of the box"})]})]})]}),(0,MH.jsxs)("div",{className:"library-pros-cons",children:[(0,MH.jsx)("h3",{children:"\ud83d\udcca Detailed Pros & Cons"}),(0,MH.jsxs)("div",{className:"pros-cons-grid",children:[(0,MH.jsxs)("div",{className:"library-pros-cons-card",children:[(0,MH.jsxs)("div",{className:"card-header handsontable",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83d\udcca"}),(0,MH.jsx)("h4",{children:"Handsontable"})]}),(0,MH.jsxs)("div",{className:"card-content",children:[(0,MH.jsxs)("div",{className:"pros-section",children:[(0,MH.jsx)("h5",{children:"\u2705 Pros"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Professional spreadsheet interface with Excel-like features"}),(0,MH.jsx)("li",{children:"Real-time data editing with instant chart updates"}),(0,MH.jsx)("li",{children:"Comprehensive API with extensive customization options"}),(0,MH.jsx)("li",{children:"Built-in data validation and formatting"}),(0,MH.jsx)("li",{children:"Excellent performance with large datasets"}),(0,MH.jsx)("li",{children:"Mobile-responsive design"}),(0,MH.jsx)("li",{children:"Rich set of built-in features (sorting, filtering, etc.)"})]})]}),(0,MH.jsxs)("div",{className:"cons-section",children:[(0,MH.jsx)("h5",{children:"\u274c Cons"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Commercial license required for advanced features"}),(0,MH.jsx)("li",{children:"Larger bundle size (~500KB)"}),(0,MH.jsx)("li",{children:"Steeper learning curve for complex configurations"}),(0,MH.jsx)("li",{children:"Limited free features in community version"})]})]})]})]}),(0,MH.jsxs)("div",{className:"library-pros-cons-card",children:[(0,MH.jsxs)("div",{className:"card-header ag-grid",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83c\udfe2"}),(0,MH.jsx)("h4",{children:"AG Grid"})]}),(0,MH.jsxs)("div",{className:"card-content",children:[(0,MH.jsxs)("div",{className:"pros-section",children:[(0,MH.jsx)("h5",{children:"\u2705 Pros"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Enterprise-level performance and features"}),(0,MH.jsx)("li",{children:"Advanced filtering and grouping capabilities"}),(0,MH.jsx)("li",{children:"Excellent TypeScript support"}),(0,MH.jsx)("li",{children:"Rich ecosystem of plugins and extensions"}),(0,MH.jsx)("li",{children:"Built-in chart integration"}),(0,MH.jsx)("li",{children:"Virtual scrolling for large datasets"}),(0,MH.jsx)("li",{children:"Comprehensive documentation"})]})]}),(0,MH.jsxs)("div",{className:"cons-section",children:[(0,MH.jsx)("h5",{children:"\u274c Cons"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Commercial license for advanced features"}),(0,MH.jsx)("li",{children:"Complex setup and configuration"}),(0,MH.jsx)("li",{children:"Large bundle size"}),(0,MH.jsx)("li",{children:"Overkill for simple use cases"})]})]})]})]}),(0,MH.jsxs)("div",{className:"library-pros-cons-card",children:[(0,MH.jsxs)("div",{className:"card-header react-table",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\u26a1"}),(0,MH.jsx)("h4",{children:"React Table"})]}),(0,MH.jsxs)("div",{className:"card-content",children:[(0,MH.jsxs)("div",{className:"pros-section",children:[(0,MH.jsx)("h5",{children:"\u2705 Pros"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Lightweight and flexible"}),(0,MH.jsx)("li",{children:"Headless design for maximum customization"}),(0,MH.jsx)("li",{children:"Excellent TypeScript support"}),(0,MH.jsx)("li",{children:"No external dependencies"}),(0,MH.jsx)("li",{children:"Easy to integrate with any UI library"}),(0,MH.jsx)("li",{children:"Great for custom implementations"}),(0,MH.jsx)("li",{children:"Minimal bundle size (~15KB)"})]})]}),(0,MH.jsxs)("div",{className:"cons-section",children:[(0,MH.jsx)("h5",{children:"\u274c Cons"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Requires more manual setup"}),(0,MH.jsx)("li",{children:"No built-in editing features"}),(0,MH.jsx)("li",{children:"Limited built-in functionality"}),(0,MH.jsx)("li",{children:"More code required for advanced features"})]})]})]})]}),(0,MH.jsxs)("div",{className:"library-pros-cons-card",children:[(0,MH.jsxs)("div",{className:"card-header mui-datagrid",children:[(0,MH.jsx)("span",{className:"library-icon",children:"\ud83c\udfa8"}),(0,MH.jsx)("h4",{children:"MUI DataGrid"})]}),(0,MH.jsxs)("div",{className:"card-content",children:[(0,MH.jsxs)("div",{className:"pros-section",children:[(0,MH.jsx)("h5",{children:"\u2705 Pros"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Beautiful Material Design interface"}),(0,MH.jsx)("li",{children:"Built-in editing and filtering"}),(0,MH.jsx)("li",{children:"Excellent accessibility"}),(0,MH.jsx)("li",{children:"Consistent with Material Design system"}),(0,MH.jsx)("li",{children:"Good TypeScript support"}),(0,MH.jsx)("li",{children:"Responsive design out of the box"}),(0,MH.jsx)("li",{children:"Built-in validation and error handling"})]})]}),(0,MH.jsxs)("div",{className:"cons-section",children:[(0,MH.jsx)("h5",{children:"\u274c Cons"}),(0,MH.jsxs)("ul",{children:[(0,MH.jsx)("li",{children:"Tied to Material-UI ecosystem"}),(0,MH.jsx)("li",{children:"Limited customization compared to headless solutions"}),(0,MH.jsx)("li",{children:"Bundle size includes Material-UI dependencies"}),(0,MH.jsx)("li",{children:"May not fit all design systems"})]})]})]})]})]})]}),(0,MH.jsxs)("div",{className:"comparison-note",children:[(0,MH.jsx)("h4",{children:"\ud83d\udca1 Pro Tip"}),(0,MH.jsx)("p",{children:"All four libraries integrate seamlessly with Chart.js for data visualization. Try switching between them using the tabs above to see the differences in user experience and functionality!"})]})]}),f_e=e=>{let{libraryName:t,libraryId:n}=e;const r=(e=>{switch(e){case"ag-grid-chartjs":return["Install AG Grid: npm install ag-grid-react ag-grid-community","Import AG Grid components and styles","Replace Handsontable with AG Grid in Spreadsheet component","Configure AG Grid with editing capabilities","Integrate with existing Chart.js implementation","Add AG Grid specific features like filtering and sorting"];case"react-table-chartjs":return["Install React Table: npm install @tanstack/react-table","Create a custom table component with React Table","Add inline editing functionality","Integrate with existing Chart.js implementation","Implement data synchronization between table and charts","Add custom styling and interactions"];case"mui-datagrid-chartjs":return["Install MUI DataGrid: npm install @mui/x-data-grid @mui/material @emotion/react @emotion/styled","Import MUI DataGrid components and theme","Replace current spreadsheet with MUI DataGrid","Configure editing and filtering capabilities","Integrate with existing Chart.js implementation","Apply Material Design styling"];default:return["Install required dependencies","Create spreadsheet component with selected library","Integrate with Chart.js for visualization","Implement data synchronization","Add custom styling and interactions"]}})(n),i=(e=>{switch(e){case"ag-grid-chartjs":return"https://ag-grid.com/";case"react-table-chartjs":return"https://react-table.tanstack.com/";case"mui-datagrid-chartjs":return"https://mui.com/x/react-data-grid/";default:return"#"}})(n);return(0,MH.jsxs)("div",{className:"placeholder-implementation",children:[(0,MH.jsxs)("div",{className:"placeholder-header",children:[(0,MH.jsx)("h2",{children:"\ud83d\udea7 Implementation Coming Soon"}),(0,MH.jsxs)("p",{children:["The ",(0,MH.jsx)("strong",{children:t})," integration is not yet implemented."]})]}),(0,MH.jsxs)("div",{className:"placeholder-content",children:[(0,MH.jsxs)("div",{className:"implementation-info",children:[(0,MH.jsx)("h3",{children:"\ud83d\udccb Implementation Plan"}),(0,MH.jsx)("p",{children:"This library will be integrated following these steps:"}),(0,MH.jsx)("ol",{className:"implementation-steps",children:r.map((e,t)=>(0,MH.jsx)("li",{children:e},t))}),(0,MH.jsxs)("div",{className:"implementation-actions",children:[(0,MH.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"docs-link",children:"\ud83d\udcd6 View Documentation"}),(0,MH.jsx)("div",{className:"current-status",children:(0,MH.jsx)("span",{className:"status-badge pending",children:"\u23f3 Pending Implementation"})})]})]}),(0,MH.jsxs)("div",{className:"demo-note",children:[(0,MH.jsx)("h4",{children:"\ud83d\udca1 Demo Note"}),(0,MH.jsxs)("p",{children:["Currently, this demo uses ",(0,MH.jsx)("strong",{children:"Handsontable + Chart.js"})," as the reference implementation. You can see how the integration works by switching back to that tab."]})]})]})]})};function m_e(){const[e,n]=(0,t.useState)([]),[r,i]=(0,t.useState)("line"),[o,s]=(0,t.useState)({x:"",y:""}),[a,l]=(0,t.useState)({}),[c,u]=(0,t.useState)("comparison");(0,t.useEffect)(()=>{const t=(()=>{if(!e||0===e.length)return[];const t=new Set;return e.forEach(e=>{Object.keys(e).forEach(e=>t.add(e))}),Array.from(t).sort((e,t)=>parseInt(e)-parseInt(t))})();o.x&&!t.includes(o.x)&&s(e=>({...e,x:""})),o.y&&!t.includes(o.y)&&s(e=>({...e,y:""}))},[e,o.x,o.y]);const d=e=>{console.log("\ud83d\udd0d App handleDataChange called - data length:",e.length),console.log("\ud83d\udd0d App handleDataChange - data sample:",e.slice(0,2));let t=[...e];0===t.length&&(console.log("\ud83d\udd0d App - No data, creating default row"),t=[{0:""}]),t=t.map(e=>0===Object.keys(e).length?(console.log("\ud83d\udd0d App - Empty row found, adding default column"),{0:""}):e),console.log("\ud83d\udd0d App - Final validated data length:",t.length),n(t)},h=e=>{i(e)},p=(e,t)=>{s(n=>({...n,[e]:t}))};return(0,MH.jsxs)("div",{className:"App",children:[(0,MH.jsxs)("header",{className:"app-header",children:[(0,MH.jsx)("h1",{children:"\ud83d\udcca Spreadsheet & Charts Demo"}),(0,MH.jsx)("p",{children:"Edit data in the spreadsheet and see changes reflected in real-time charts"})]}),(0,MH.jsx)("div",{className:"library-tabs-container",children:(0,MH.jsx)(p_e,{selectedLibrary:c,onLibraryChange:e=>{u(e)}})}),(0,MH.jsx)("main",{className:"app-main",children:(()=>{if("comparison"===c)return(0,MH.jsx)("div",{className:"comparison-section",children:(0,MH.jsx)(g_e,{})});if("handsontable-chartjs"===c)return(0,MH.jsxs)(MH.Fragment,{children:[(0,MH.jsxs)("div",{className:"main-content",children:[(0,MH.jsx)("div",{className:"spreadsheet-section",children:(0,MH.jsx)(PH,{data:e,onDataChange:d})}),(0,MH.jsx)("div",{className:"chart-section",children:(0,MH.jsx)(MRe,{data:e,chartType:r,selectedColumns:o,chartColors:a,onChartTypeChange:h,onColumnChange:p})})]}),(0,MH.jsxs)("div",{className:"sidebar",children:[(0,MH.jsx)(u_e,{onDataImport:d,data:e}),(0,MH.jsx)(d_e,{data:e})]})]});if("ag-grid-chartjs"===c)return(0,MH.jsxs)(MH.Fragment,{children:[(0,MH.jsxs)("div",{className:"main-content",children:[(0,MH.jsx)("div",{className:"spreadsheet-section",children:(0,MH.jsx)(zX,{data:e,onDataChange:d})}),(0,MH.jsx)("div",{className:"chart-section",children:(0,MH.jsx)(MRe,{data:e,chartType:r,selectedColumns:o,chartColors:a,onChartTypeChange:h,onColumnChange:p})})]}),(0,MH.jsxs)("div",{className:"sidebar",children:[(0,MH.jsx)(u_e,{onDataImport:d,data:e}),(0,MH.jsx)(d_e,{data:e})]})]});if("react-table-chartjs"===c)return(0,MH.jsxs)(MH.Fragment,{children:[(0,MH.jsxs)("div",{className:"main-content",children:[(0,MH.jsx)("div",{className:"spreadsheet-section",children:(0,MH.jsx)(GQ,{data:e,onDataChange:d})}),(0,MH.jsx)("div",{className:"chart-section",children:(0,MH.jsx)(MRe,{data:e,chartType:r,selectedColumns:o,chartColors:a,onChartTypeChange:h,onColumnChange:p})})]}),(0,MH.jsxs)("div",{className:"sidebar",children:[(0,MH.jsx)(u_e,{onDataImport:d,data:e}),(0,MH.jsx)(d_e,{data:e})]})]});if("mui-datagrid-chartjs"===c)return(0,MH.jsxs)(MH.Fragment,{children:[(0,MH.jsxs)("div",{className:"main-content",children:[(0,MH.jsx)("div",{className:"spreadsheet-section",children:(0,MH.jsx)(vve,{data:e,onDataChange:d})}),(0,MH.jsx)("div",{className:"chart-section",children:(0,MH.jsx)(MRe,{data:e,chartType:r,selectedColumns:o,chartColors:a,onChartTypeChange:h,onColumnChange:p})})]}),(0,MH.jsxs)("div",{className:"sidebar",children:[(0,MH.jsx)(u_e,{onDataImport:d,data:e}),(0,MH.jsx)(d_e,{data:e})]})]});{const e={};return(0,MH.jsx)(f_e,{libraryName:e[c]||"Selected Library",libraryId:c})}})()})]})}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));const v_e=e=>{e&&e instanceof Function&&n.e(723).then(n.bind(n,723)).then(t=>{let{onCLS:n,onFCP:r,onINP:i,onLCP:o,onTTFB:s}=t;n(e),r(e),i(e),o(e),s(e)})};i.createRoot(document.getElementById("root")).render((0,MH.jsx)(t.StrictMode,{children:(0,MH.jsx)(m_e,{})})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)}),v_e()})()})();
//# sourceMappingURL=main.77dc57e7.js.map